Reinforced Imitation Learning by Free Energy Principle
Ryoya Ogishima1 Izumi Karino1 Yasuo Kuniyoshi1
Abstract
Reinforcement Learning (RL) requires a large
amount of exploration especially in sparse-reward
settings. Imitation Learning (IL) can learn from
expert demonstrations without exploration, but it
never exceeds the expert’s performance and is also
vulnerable to distributional shift between demon-
stration and execution. In this paper, we radically
unify RL and IL based on Free Energy Principle
(FEP). FEP is a uniﬁed Bayesian theory of the
brain that explains perception, action and model
learning by a common fundamental principle. We
present a theoretical extension of FEP and derive
an algorithm in which an agent learns the world
model that internalizes expert demonstrations and
at the same time uses the model to infer the cur-
rent and future states and actions that maximize
rewards. The algorithm thus reduces exploration
costs by partially imitating experts as well as max-
imizing its return in a seamless way, resulting in
a higher performance than the suboptimal expert.
Our experimental results show that this approach
is promising in visual control tasks especially in
sparse-reward environments.
1. Introduction
Reinforcement Learning (RL) autonomously explores to
maximize rewards, even achieving super-human perfor-
mances in certain tasks(Sutton et al., 1998; Silver et al.,
2016). It can also transfer the acquired policy to new
tasks/environments with additional explorations. However,
in realistic tasks, RL often requires an excess amount of
explorations especially in sparse-reward settings, and even
when it succeeds in reward maximization, the acquired pol-
icy sometimes severely deviates from the intention of the
reward designer.
Imitation Learning (IL) learns a policy to mimic the trajecto-
ries demonstrated by an expert(Pomerleau, 1991). Therefore
1Graduate School of Information Science and Technology, The
University of Tokyo, Tokyo, Japan. Correspondence to: Ryoya
Ogishima <ogishima@isi.imi.i.u-tokyo.ac.jp>.
it does not require explorations nor a careful design of a
reward function. However, the policy acquired by IL never
exhibits the performance exceeding that of the suboptimal
expert, and it is also vulnerable to realistic setting with dis-
tributional shift between the demonstration and execution
environments or perturbation and noise.
Since the pros and cons of RL and IL are mutually compen-
sating, a natural consequence would be to combine the two
methods. Several work have been reported along this idea
(Verma et al., 2019; Pfeiffer et al., 2018; Sun et al., 2018b;
Rhinehart et al., 2018). However, there still remains an im-
portant problem. That is, a truly seamless uniﬁcation of IL
and RL on a common theoretical ground to make the best
out of mutual leverages, and dealing with another realistic
setting which is partial observability as in POMDP (Par-
tially Observable Markov Decision Process), particularly
with high-dimensional image inputs. It is widely assumed
that introducing a generative model of the world in terms of
latent variables is a promising approach to POMDP.
Recent work in model-based RL succeeds in latent planning
from high-dimensional image inputs by incorporating la-
tent dynamics models. Behaviors can be derived either by
imagined-reward maximization (Ha & Schmidhuber, 2018;
Hafner et al., 2019a) or by online planning (Hafner et al.,
2019b). Although solving high dimensional visual control
tasks with model-based methods is becoming feasible, prior
methods have not been combined with IL.
Free Energy Principle (FEP), a uniﬁed brain theory in com-
putational neuroscience explains perception, action and
model learning in a Bayesian probabilistic way (Friston
et al., 2006; Friston, 2010). In FEP, the brain has a gen-
erative model of the world and computes a mathematical
amount called Free Energy using the model prediction and
sensory inputs to the brain. By minimizing the Free Energy,
the brain achieves model learning and behavior learning.
Therefore it has a potential to fundamentally unify IL and
RL on the common theoretical ground. However, prior work
on FEP dealt with limited situations where a part of the gen-
erative model is given and the task is very low dimensional.
As there are a lot in common between FEP and variational
inference in machine learning, recent advancements in deep
learning and latent variable models could be applied to scale
up FEP agents to be compatible with high dimensional tasks.
arXiv:2107.11811v1  [cs.LG]  25 Jul 2021
Reinforced Imitation Learning by Free Energy Principle
In this paper, we propose Deep Free Energy Network
(FENet), an agent that combines the advantages of IL and
RL so that the initial policy is learned from suboptimal ex-
pert data without the need of exploration or detailed reward
crafting, then it is further improved from sparsely speciﬁed
reward functions to exceed the suboptimal expert perfor-
mance.
The key contributions of this work are summarized as fol-
lows:
• Extension of Free Energy Principle:
We theoretically extend Free Energy Principle, intro-
ducing policy prior and policy posterior to combine IL
and RL. We implement the proposed method on top
of Recurrent State Space Model (Hafner et al., 2019b),
a latent dynamics model with both deterministic and
stochastic components.
• Visual control tasks in realistic problem settings:
We solve Cheetah-run, Walker-walk, and Quadruped-
walk tasks from DeepMind Control Suite (Tassa et al.,
2018). We do not only use the default problem set-
tings, but we also set up problems with sparse rewards
and with suboptimal experts. We demonstrate that our
agent outperforms model-based RL using Recurrent
State Space Model in sparse-reward settings. We also
show that our agent can achieve higher returns than
Behavioral Cloning (IL) with suboptimal experts.
2. Backgrounds on Free Energy Principle
2.1. Problem setups
We formulate visual control as a partially observable Markov
decision process (POMDP) with discrete time steps t, ob-
servations ot, hidden states st, continuous action vectors at,
and scalar rewards rt. The goal is to develop an agent that
maximizes expected return E[∑T
t=1 rt].
2.2. Free Energy Principle
Perception, action and model learning are all achieved by
minimizing the same objective function, Free Energy (Fris-
ton et al., 2006; Friston, 2010). In FEP, the agent is equipped
with a generative model of the world, using a prior p(st)
and a likelihood p(ot|st).
p(ot,st) =p(ot|st)p(st) (1)
Perceptual Inference Under the generative model, the
posterior probability of hidden states given observations is
calculated with Bayes’ theorem as follows.
p(st|ot) =p(ot|st)p(st)
p(ot) , p (ot) =
∫
p(ot|st)p(st)ds
(2)
Since we cannot compute p(ot) due to the integral, we think
of approximating p(st|ot) with a variational posterior q(st)
by minimizing KL divergence KL(q(st)||p(st|ot)).
KL(q(st)||p(st|ot)) = lnp(ot) +KL(q(st)||p(ot,st))
(3)
Ft = KL(q(st)||p(ot,st)) (4)
The Free Energy is deﬁned as (eq.4). Since p(ot) does not
depend on st, we can minimize (eq.3) w.r.t. the parameters
of the variational posterior by minimizing the Free Energy.
Thus, the agent can infer the hidden states of the observa-
tions by minimizing Ft. This process is called ’perceptual
inference’ in FEP.
Perceptual Learning Free Energy is the same amount
as negative Evidence Lower Bound (ELBO) in variational
inference often seen in machine learning as follows.
ln p(ot) ≥−Ft (5)
By minimizing Ft w.r.t. the parameters of the prior and the
likelihood, the generative model learns to best explain the
observations. This process is called ’perceptual learning’ in
FEP.
Active Inference We can assume that the prior is condi-
tioned on the hidden states and actions at the previous time
step as follows.
p(st) := p(st|st−1,at−1) (6)
The agent can change the future by choosing actions. Sup-
pose the agent chooses at when it is at st, the prior can
predict the next hidden state st+1. Thus, we can think of
the Expected Free Energy Gt+1 at the next time step t+ 1
as follows (Friston et al., 2015).
Gt+1 = Ep(ot+1|st+1)[KL(q(st+1)||p(ot+1,st+1))]
= Eq(st+1)p(ot+1|st+1)[ln q(st+1) −ln p(ot+1,st+1)]
(7)
= Eq(st+1)p(ot+1|st+1)[ln q(st+1) −ln p(st+1|ot+1)
−ln p(ot+1)]
≈Eq(ot+1,st+1)[ln q(st+1) −ln q(st+1|ot+1)
−ln p(ot+1)] (8)
= Eq(ot+1)[−KL(q(st+1|ot+1)||q(st+1))
−ln p(ot+1)] (9)
Since the agent has not experienced time step t+ 1yet and
has not received observationsot+1, we take expectation over
ot+1 using the likelihood p(ot+1|st+1) as (eq.7). In (eq.8),
we deﬁne the likelihood q(ot+1|st+1) =p(ot+1|st+1) and
approximate the posterior p(st+1|ot+1) as the variational
posterior q(st+1|ot+1). According to the complete class
Reinforced Imitation Learning by Free Energy Principle
theorem (Friston et al., 2012), any scalar rewards can be
encoded as observation priors using p(o) ∝exp r(o) and
the second term in (eq.9) becomes a goal-directed value.
This observation prior p(ot+1) can also be regarded as
the probability of optimality variable p(Ot+1 = 1|ot+1),
where the binary optimality variable Ot+1 = 1 denotes
that time step t+ 1is optimal and Ot+1 = 0denotes that
it is not optimal as introduced in the context of control
as probabilistic inference(Levine, 2018). The ﬁrst term
in (eq.9) is called epistemic value that works as intrinsic
motivation to further explore the world. Minimization of
−KL(q(st+1|ot+1)||q(st+1)) means that the agent tries to
experience as different states st+1 as possible given some
imagined observations ot+1. By minimizing the Expected
Free Energy, the agent can infer the actions that explores the
world and maximize rewards. This process is called ’active
inference’.
3. Deep Free Energy Network (FENet)
Perceptual learning deals with learning the generative model
to best explain the agent’s sensory inputs. If we think of
not only observations but also actions demonstrated by the
expert as a part of the sensory inputs, we can explain IL by
using the concept of perceptual learning. In other words,
this is a process of learning the world model that internalizes
expert demonstrations as passive dynamics. Active infer-
ence deals with exploration and reward maximization, so it
is compatible with reinforcement learning. By minimizing
the same objective function, the Free Energy, we can deal
with both IL and RL.
In this section, we ﬁrst extend the Free Energy so that ac-
tions are a part of the sensory inputs to accommodate both
IL and RL. For this purpose, we introduce a policy prior
for IL and a policy posterior for RL. Second, we use the ex-
tended Free Energy to derive and extend the Expected Free
Energy in two ways. One is for calculation with given expert
data for IL, and the other is for calculation with collected
agent data for RL. Finally, we explain a detailed network
design to implement the proposed method for solving image
control tasks.
3.1. Introducing a policy prior and a policy posterior
Free Energy We extend the Free Energy from (eq.4)
so that actions are a part of the sensory inputs that the
generative model tries to explain.
Ft = KL(q(st)||p(ot,st,at)) (10)
= KL(q(st)||p(ot|st)p(at|st)p(st|st−1,at−1)) (11)
= Eq(st)[ln q(st)
p(ot|st)p(at|st)p(st|st−1,at−1)] (12)
= Eq(st)[−ln p(ot|st) −ln p(at|st) + lnq(st)
−ln p(st|st−1,at−1)] (13)
= Eq(st)[−ln p(ot|st) −ln p(at|st)]
+ KL(q(st)||p(st|st−1,at−1)) (14)
We deﬁne p(at|st) as a policy prior. When the agent ob-
serves expert trajectories, by minimizing Ft w.r.t. the policy
prior parameters, the policy prior will be learned so that
it can best explain the experts. By minizing Ft w.r.t. the
parameters of the state prior p(st|st−1,at−1) and the ob-
servation likelihood p(ot|st), the world model is learned
as explained as perceptual learning in Section 2.2. Besides
the policy prior, we introduce and deﬁne a policy posterior
q(at|st), which is the very policy that the agent samples
actions from when interacting with its environments and
that the agent uses to imagine the future observations and
rewards. We explain how to learn the policy posterior in the
following.
Expected Free Energy for Imitation Learning (IL)In
a similar manner to active inference in Section 2.2, we think
of the Expected Free EnergyGt+1 at the next time stept+1,
but this time we take expectation over the policy posterior
q(at|st) because Gt+1 is a value expected under the next
actions. Note that in Section 2.2 at was given as a certain
value input, but here at is sampled from the policy posterior.
We calculate the expected state at time stept+ 1as follows.
q(st+1) =Eq(st)q(at|st)[p(st+1|st,at)] (15)
q(ot+1,st+1,at+1) =p(ot+1|st+1)q(at+1|st+1)q(st+1)
(16)
We derive the Expected Free Energy from (eq.13) as follows.
GIL
t+1 = Eq(ot+1,st+1,at+1)[−ln p(ot+1|st+1)
−ln p(at+1|st+1) + lnq(st+1) −ln p(st+1|st,at)]
(17)
= Eq(ot+1,st+1,at+1)[−ln p(ot+1|st+1)
−ln p(at+1|st+1) + 0] (18)
= Eq(ot+1,st+1)[−ln p(ot+1|st+1)
+ Eq(at+1|st+1)[−ln p(at+1|st+1)]] (19)
= Eq(st+1)[H[p(ot+1|st+1)]
+ Eq(at+1|st+1)[−ln p(at+1|st+1)]] (20)
In (eq.18), q(st+1) and p(st+1|st,at) are both state prior
prediction at future time step t+ 1, and they are regarded
as the same value. In (eq.20), the ﬁrst term is the entropy
of the observation likelihood, and the second term is the
negative likelihood of the policy prior expected under the
policy posterior. By minimizing GIL
t+1, the agent learns the
policy posterior so that it matches the policy prior which has
been learned through minimizing Ft to encode the experts’
behavior.
Expected Free Energy for RLWe can get the Expected
Free Energy in a different way that has a reward component
Reinforced Imitation Learning by Free Energy Principle
r(ot+1) leading to the policy posterior maximizing rewards.
We derive the Expected Free Energy from (eq.17) as follows.
GRL
t+1 = Eq(ot+1,st+1,at+1)[−ln p(ot+1,st+1)
−ln p(at+1|st+1) + lnq(st+1)] (21)
= Eq(ot+1,st+1,at+1)[−ln p(st+1|ot+1))
−ln p(at+1|st+1) + lnq(st+1) −ln p(ot+1)]
(22)
≈Eq(ot+1,st+1,at+1)[−ln q(st+1|ot+1))
−ln p(at+1|st+1) + lnq(st+1) −ln p(ot+1)]
(23)
= Eq(ot+1,st+1)[−ln q(st+1|ot+1) −ln p(ot+1)
+ Eq(at+1|st+1)[−ln p(at+1|st+1)] + lnq(st+1)]
(24)
= Eq(ot+1)[−KL(q(st+1|ot+1)||q(st+1)) −ln p(ot+1)]
+ Eq(st+1)[Eq(at+1|st+1)[−ln p(at+1|st+1)]]
(25)
≈Eq(ot+1)[−KL(q(st+1|ot+1)||q(st+1)) −r(ot+1)]
+ Eq(st+1)[Eq(at+1|st+1)[−ln p(at+1|st+1)]]
(26)
In (eq.23), we approximate p(st+1|ot+1) as q(st+1|ot+1)
similarly to (eq.8). This is to approximate true state posterior
as variational state posterior. In (eq.26), as is explained in
active inference in Section 2.2, we use p(o) ∝exp r(o) for
the approximation. The ﬁrst KL term is the epistemic value
that lets the agent explore the world, the second term is the
expected reward under the action sampled from the policy
posterior, and the last term is the likelihood of the policy
prior expected under the policy posterior. Note that q(ot+1)
in (eq.26) can be calculated as follows.
q(ot+1) =Eq(st+1)[p(ot+1|st+1)] (27)
By minimizing GRL
t+1, the agent learns the policy posterior
so that it explores the world and maximizes the reward as
long as it does not deviate too much from the policy prior
which has encoded experts’ behavior through minimizing
Ft.
In summary, GIL
t+1 and GRL
t+1 are both derived from the same
Free Energy Ft, but they are different kinds of derivations
to accommodate the data inputs required for IL and RL
respectively.
3.2. IL and RL objectives
To realize IL and RL at the same time, we propose that the
agent calculate Free Energy-based losses for given expert
data and collected agent data. The overall loss function of
Deep Free Energy Network should minimize is as follows.
FIL + FRL (28)
Expert data(given)
State posterior
Go tot +2
<latexit sha1_base64="mfVvsTk2fKgDCpRjynE5oj1hy4U=">AAAB6nicbVBNS8NAEJ3Ur1q/qh69LBZBEEpSBD0WvXisaD+gDWWz3bRLN5uwOxFK6E/w4kERr/4ib/4bt20O2vpg4PHeDDPzgkQKg6777RTW1jc2t4rbpZ3dvf2D8uFRy8SpZrzJYhnrTkANl0LxJgqUvJNoTqNA8nYwvp357SeujYjVI04S7kd0qEQoGEUrPeBFrV+uuFV3DrJKvJxUIEejX/7qDWKWRlwhk9SYrucm6GdUo2CST0u91PCEsjEd8q6likbc+Nn81Ck5s8qAhLG2pZDM1d8TGY2MmUSB7YwojsyyNxP/87ophtd+JlSSIldssShMJcGYzP4mA6E5QzmxhDIt7K2EjaimDG06JRuCt/zyKmnVqp5b9e4vK/WbPI4inMApnIMHV1CHO2hAExgM4Rle4c2Rzovz7nwsWgtOPnMMf+B8/gC4CY1p</latexit><latexit sha1_base64="mfVvsTk2fKgDCpRjynE5oj1hy4U=">AAAB6nicbVBNS8NAEJ3Ur1q/qh69LBZBEEpSBD0WvXisaD+gDWWz3bRLN5uwOxFK6E/w4kERr/4ib/4bt20O2vpg4PHeDDPzgkQKg6777RTW1jc2t4rbpZ3dvf2D8uFRy8SpZrzJYhnrTkANl0LxJgqUvJNoTqNA8nYwvp357SeujYjVI04S7kd0qEQoGEUrPeBFrV+uuFV3DrJKvJxUIEejX/7qDWKWRlwhk9SYrucm6GdUo2CST0u91PCEsjEd8q6likbc+Nn81Ck5s8qAhLG2pZDM1d8TGY2MmUSB7YwojsyyNxP/87ophtd+JlSSIldssShMJcGYzP4mA6E5QzmxhDIt7K2EjaimDG06JRuCt/zyKmnVqp5b9e4vK/WbPI4inMApnIMHV1CHO2hAExgM4Rle4c2Rzovz7nwsWgtOPnMMf+B8/gC4CY1p</latexit><latexit sha1_base64="mfVvsTk2fKgDCpRjynE5oj1hy4U=">AAAB6nicbVBNS8NAEJ3Ur1q/qh69LBZBEEpSBD0WvXisaD+gDWWz3bRLN5uwOxFK6E/w4kERr/4ib/4bt20O2vpg4PHeDDPzgkQKg6777RTW1jc2t4rbpZ3dvf2D8uFRy8SpZrzJYhnrTkANl0LxJgqUvJNoTqNA8nYwvp357SeujYjVI04S7kd0qEQoGEUrPeBFrV+uuFV3DrJKvJxUIEejX/7qDWKWRlwhk9SYrucm6GdUo2CST0u91PCEsjEd8q6likbc+Nn81Ck5s8qAhLG2pZDM1d8TGY2MmUSB7YwojsyyNxP/87ophtd+JlSSIldssShMJcGYzP4mA6E5QzmxhDIt7K2EjaimDG06JRuCt/zyKmnVqp5b9e4vK/WbPI4inMApnIMHV1CHO2hAExgM4Rle4c2Rzovz7nwsWgtOPnMMf+B8/gC4CY1p</latexit><latexit sha1_base64="mfVvsTk2fKgDCpRjynE5oj1hy4U=">AAAB6nicbVBNS8NAEJ3Ur1q/qh69LBZBEEpSBD0WvXisaD+gDWWz3bRLN5uwOxFK6E/w4kERr/4ib/4bt20O2vpg4PHeDDPzgkQKg6777RTW1jc2t4rbpZ3dvf2D8uFRy8SpZrzJYhnrTkANl0LxJgqUvJNoTqNA8nYwvp357SeujYjVI04S7kd0qEQoGEUrPeBFrV+uuFV3DrJKvJxUIEejX/7qDWKWRlwhk9SYrucm6GdUo2CST0u91PCEsjEd8q6likbc+Nn81Ck5s8qAhLG2pZDM1d8TGY2MmUSB7YwojsyyNxP/87ophtd+JlSSIldssShMJcGYzP4mA6E5QzmxhDIt7K2EjaimDG06JRuCt/zyKmnVqp5b9e4vK/WbPI4inMApnIMHV1CHO2hAExgM4Rle4c2Rzovz7nwsWgtOPnMMf+B8/gC4CY1p</latexit>
s t +1
<latexit sha1_base64="ScCu8WZixoFvlWxDlnIdRy5VZ8I=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTPI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPHwfej1o=</latexit><latexit sha1_base64="ScCu8WZixoFvlWxDlnIdRy5VZ8I=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTPI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPHwfej1o=</latexit><latexit sha1_base64="ScCu8WZixoFvlWxDlnIdRy5VZ8I=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTPI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPHwfej1o=</latexit><latexit sha1_base64="ScCu8WZixoFvlWxDlnIdRy5VZ8I=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTPI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPHwfej1o=</latexit>
a t +1
<latexit sha1_base64="djQ9v+9DazsGJp0kdrM2GLD5C48=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTrI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPH+wbj0g=</latexit><latexit sha1_base64="djQ9v+9DazsGJp0kdrM2GLD5C48=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTrI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPH+wbj0g=</latexit><latexit sha1_base64="djQ9v+9DazsGJp0kdrM2GLD5C48=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTrI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPH+wbj0g=</latexit><latexit sha1_base64="djQ9v+9DazsGJp0kdrM2GLD5C48=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTrI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPH+wbj0g=</latexit>
a t +1
<latexit sha1_base64="djQ9v+9DazsGJp0kdrM2GLD5C48=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTrI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPH+wbj0g=</latexit><latexit sha1_base64="djQ9v+9DazsGJp0kdrM2GLD5C48=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTrI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPH+wbj0g=</latexit><latexit sha1_base64="djQ9v+9DazsGJp0kdrM2GLD5C48=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTrI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPH+wbj0g=</latexit><latexit sha1_base64="djQ9v+9DazsGJp0kdrM2GLD5C48=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTrI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPH+wbj0g=</latexit>
o t +1
<latexit sha1_base64="X1pEAXTYHbGJRxJqEjstwtSrvfc=">AAAB7nicbVDLSgNBEOyNrxhfUY9eBoMgCGFXBD0GvXiMYB6QLGF2MkmGzM4sM71CWPIRXjwo4tXv8ebfOEn2oIkFDUVVN91dUSKFRd//9gpr6xubW8Xt0s7u3v5B+fCoaXVqGG8wLbVpR9RyKRRvoEDJ24nhNI4kb0Xju5nfeuLGCq0ecZLwMKZDJQaCUXRSS/cyvAimvXLFr/pzkFUS5KQCOeq98le3r1kac4VMUms7gZ9gmFGDgkk+LXVTyxPKxnTIO44qGnMbZvNzp+TMKX0y0MaVQjJXf09kNLZ2EkeuM6Y4ssveTPzP66Q4uAkzoZIUuWKLRYNUEtRk9jvpC8MZyokjlBnhbiVsRA1l6BIquRCC5ZdXSfOyGvjV4OGqUrvN4yjCCZzCOQRwDTW4hzo0gMEYnuEV3rzEe/HevY9Fa8HLZ47hD7zPHwG2j1Y=</latexit><latexit sha1_base64="X1pEAXTYHbGJRxJqEjstwtSrvfc=">AAAB7nicbVDLSgNBEOyNrxhfUY9eBoMgCGFXBD0GvXiMYB6QLGF2MkmGzM4sM71CWPIRXjwo4tXv8ebfOEn2oIkFDUVVN91dUSKFRd//9gpr6xubW8Xt0s7u3v5B+fCoaXVqGG8wLbVpR9RyKRRvoEDJ24nhNI4kb0Xju5nfeuLGCq0ecZLwMKZDJQaCUXRSS/cyvAimvXLFr/pzkFUS5KQCOeq98le3r1kac4VMUms7gZ9gmFGDgkk+LXVTyxPKxnTIO44qGnMbZvNzp+TMKX0y0MaVQjJXf09kNLZ2EkeuM6Y4ssveTPzP66Q4uAkzoZIUuWKLRYNUEtRk9jvpC8MZyokjlBnhbiVsRA1l6BIquRCC5ZdXSfOyGvjV4OGqUrvN4yjCCZzCOQRwDTW4hzo0gMEYnuEV3rzEe/HevY9Fa8HLZ47hD7zPHwG2j1Y=</latexit><latexit sha1_base64="X1pEAXTYHbGJRxJqEjstwtSrvfc=">AAAB7nicbVDLSgNBEOyNrxhfUY9eBoMgCGFXBD0GvXiMYB6QLGF2MkmGzM4sM71CWPIRXjwo4tXv8ebfOEn2oIkFDUVVN91dUSKFRd//9gpr6xubW8Xt0s7u3v5B+fCoaXVqGG8wLbVpR9RyKRRvoEDJ24nhNI4kb0Xju5nfeuLGCq0ecZLwMKZDJQaCUXRSS/cyvAimvXLFr/pzkFUS5KQCOeq98le3r1kac4VMUms7gZ9gmFGDgkk+LXVTyxPKxnTIO44qGnMbZvNzp+TMKX0y0MaVQjJXf09kNLZ2EkeuM6Y4ssveTPzP66Q4uAkzoZIUuWKLRYNUEtRk9jvpC8MZyokjlBnhbiVsRA1l6BIquRCC5ZdXSfOyGvjV4OGqUrvN4yjCCZzCOQRwDTW4hzo0gMEYnuEV3rzEe/HevY9Fa8HLZ47hD7zPHwG2j1Y=</latexit><latexit sha1_base64="X1pEAXTYHbGJRxJqEjstwtSrvfc=">AAAB7nicbVDLSgNBEOyNrxhfUY9eBoMgCGFXBD0GvXiMYB6QLGF2MkmGzM4sM71CWPIRXjwo4tXv8ebfOEn2oIkFDUVVN91dUSKFRd//9gpr6xubW8Xt0s7u3v5B+fCoaXVqGG8wLbVpR9RyKRRvoEDJ24nhNI4kb0Xju5nfeuLGCq0ecZLwMKZDJQaCUXRSS/cyvAimvXLFr/pzkFUS5KQCOeq98le3r1kac4VMUms7gZ9gmFGDgkk+LXVTyxPKxnTIO44qGnMbZvNzp+TMKX0y0MaVQjJXf09kNLZ2EkeuM6Y4ssveTPzP66Q4uAkzoZIUuWKLRYNUEtRk9jvpC8MZyokjlBnhbiVsRA1l6BIquRCC5ZdXSfOyGvjV4OGqUrvN4yjCCZzCOQRwDTW4hzo0gMEYnuEV3rzEe/HevY9Fa8HLZ47hD7zPHwG2j1Y=</latexit>
Policy posterior
Policy priorq ( a t +1 | s t +1 )
<latexit sha1_base64="xof7cE7q/XM4A1UVVPJmyZTZnMA=">AAAB+3icbVDLSsNAFL2pr1pfsS7dDBahIpREBF0W3bisYB/QhjCZTtuhk0mcmYgl5lfcuFDErT/izr9x2mahrQcu93DOvcydE8ScKe0431ZhZXVtfaO4Wdra3tnds/fLLRUlktAmiXgkOwFWlDNBm5ppTjuxpDgMOG0H4+up336gUrFI3OlJTL0QDwUbMIK1kXy7fF/FfqpP3exJzfuJb1ecmjMDWiZuTiqQo+HbX71+RJKQCk04VqrrOrH2Uiw1I5xmpV6iaIzJGA9p11CBQ6q8dHZ7ho6N0keDSJoSGs3U3xspDpWahIGZDLEeqUVvKv7ndRM9uPRSJuJEU0HmDw0SjnSEpkGgPpOUaD4xBBPJzK2IjLDERJu4SiYEd/HLy6R1VnOdmnt7Xqlf5XEU4RCOoAouXEAdbqABTSDwCM/wCm9WZr1Y79bHfLRg5TsH8AfW5w/+YpO/</latexit><latexit sha1_base64="xof7cE7q/XM4A1UVVPJmyZTZnMA=">AAAB+3icbVDLSsNAFL2pr1pfsS7dDBahIpREBF0W3bisYB/QhjCZTtuhk0mcmYgl5lfcuFDErT/izr9x2mahrQcu93DOvcydE8ScKe0431ZhZXVtfaO4Wdra3tnds/fLLRUlktAmiXgkOwFWlDNBm5ppTjuxpDgMOG0H4+up336gUrFI3OlJTL0QDwUbMIK1kXy7fF/FfqpP3exJzfuJb1ecmjMDWiZuTiqQo+HbX71+RJKQCk04VqrrOrH2Uiw1I5xmpV6iaIzJGA9p11CBQ6q8dHZ7ho6N0keDSJoSGs3U3xspDpWahIGZDLEeqUVvKv7ndRM9uPRSJuJEU0HmDw0SjnSEpkGgPpOUaD4xBBPJzK2IjLDERJu4SiYEd/HLy6R1VnOdmnt7Xqlf5XEU4RCOoAouXEAdbqABTSDwCM/wCm9WZr1Y79bHfLRg5TsH8AfW5w/+YpO/</latexit><latexit sha1_base64="xof7cE7q/XM4A1UVVPJmyZTZnMA=">AAAB+3icbVDLSsNAFL2pr1pfsS7dDBahIpREBF0W3bisYB/QhjCZTtuhk0mcmYgl5lfcuFDErT/izr9x2mahrQcu93DOvcydE8ScKe0431ZhZXVtfaO4Wdra3tnds/fLLRUlktAmiXgkOwFWlDNBm5ppTjuxpDgMOG0H4+up336gUrFI3OlJTL0QDwUbMIK1kXy7fF/FfqpP3exJzfuJb1ecmjMDWiZuTiqQo+HbX71+RJKQCk04VqrrOrH2Uiw1I5xmpV6iaIzJGA9p11CBQ6q8dHZ7ho6N0keDSJoSGs3U3xspDpWahIGZDLEeqUVvKv7ndRM9uPRSJuJEU0HmDw0SjnSEpkGgPpOUaD4xBBPJzK2IjLDERJu4SiYEd/HLy6R1VnOdmnt7Xqlf5XEU4RCOoAouXEAdbqABTSDwCM/wCm9WZr1Y79bHfLRg5TsH8AfW5w/+YpO/</latexit><latexit sha1_base64="xof7cE7q/XM4A1UVVPJmyZTZnMA=">AAAB+3icbVDLSsNAFL2pr1pfsS7dDBahIpREBF0W3bisYB/QhjCZTtuhk0mcmYgl5lfcuFDErT/izr9x2mahrQcu93DOvcydE8ScKe0431ZhZXVtfaO4Wdra3tnds/fLLRUlktAmiXgkOwFWlDNBm5ppTjuxpDgMOG0H4+up336gUrFI3OlJTL0QDwUbMIK1kXy7fF/FfqpP3exJzfuJb1ecmjMDWiZuTiqQo+HbX71+RJKQCk04VqrrOrH2Uiw1I5xmpV6iaIzJGA9p11CBQ6q8dHZ7ho6N0keDSJoSGs3U3xspDpWahIGZDLEeqUVvKv7ndRM9uPRSJuJEU0HmDw0SjnSEpkGgPpOUaD4xBBPJzK2IjLDERJu4SiYEd/HLy6R1VnOdmnt7Xqlf5XEU4RCOoAouXEAdbqABTSDwCM/wCm9WZr1Y79bHfLRg5TsH8AfW5w/+YpO/</latexit>
State prior
Free Energy CalculationExpected Free Energy Calculation
( o t ,a t )
<latexit sha1_base64="Za4K+hvlOK4F6lqnn6B4r3z0Z9s=">AAAB8HicbVDLSgNBEJz1GeMr6tHLYBAiSNgVQY9BLx4jmIckyzI7mU2GzGOZ6RVCyFd48aCIVz/Hm3/jJNmDJhY0FFXddHfFqeAWfP/bW1ldW9/YLGwVt3d29/ZLB4dNqzNDWYNqoU07JpYJrlgDOAjWTg0jMhasFQ9vp37riRnLtXqAUcpCSfqKJ5wScNJjRUdwTiI4i0plv+rPgJdJkJMyylGPSl/dnqaZZAqoINZ2Aj+FcEwMcCrYpNjNLEsJHZI+6ziqiGQ2HM8OnuBTp/Rwoo0rBXim/p4YE2ntSMauUxIY2EVvKv7ndTJIrsMxV2kGTNH5oiQTGDSefo973DAKYuQIoYa7WzEdEEMouIyKLoRg8eVl0ryoBn41uL8s127yOAroGJ2gCgrQFaqhO1RHDUSRRM/oFb15xnvx3r2PeeuKl88coT/wPn8A3BSPxw==</latexit><latexit sha1_base64="Za4K+hvlOK4F6lqnn6B4r3z0Z9s=">AAAB8HicbVDLSgNBEJz1GeMr6tHLYBAiSNgVQY9BLx4jmIckyzI7mU2GzGOZ6RVCyFd48aCIVz/Hm3/jJNmDJhY0FFXddHfFqeAWfP/bW1ldW9/YLGwVt3d29/ZLB4dNqzNDWYNqoU07JpYJrlgDOAjWTg0jMhasFQ9vp37riRnLtXqAUcpCSfqKJ5wScNJjRUdwTiI4i0plv+rPgJdJkJMyylGPSl/dnqaZZAqoINZ2Aj+FcEwMcCrYpNjNLEsJHZI+6ziqiGQ2HM8OnuBTp/Rwoo0rBXim/p4YE2ntSMauUxIY2EVvKv7ndTJIrsMxV2kGTNH5oiQTGDSefo973DAKYuQIoYa7WzEdEEMouIyKLoRg8eVl0ryoBn41uL8s127yOAroGJ2gCgrQFaqhO1RHDUSRRM/oFb15xnvx3r2PeeuKl88coT/wPn8A3BSPxw==</latexit><latexit sha1_base64="Za4K+hvlOK4F6lqnn6B4r3z0Z9s=">AAAB8HicbVDLSgNBEJz1GeMr6tHLYBAiSNgVQY9BLx4jmIckyzI7mU2GzGOZ6RVCyFd48aCIVz/Hm3/jJNmDJhY0FFXddHfFqeAWfP/bW1ldW9/YLGwVt3d29/ZLB4dNqzNDWYNqoU07JpYJrlgDOAjWTg0jMhasFQ9vp37riRnLtXqAUcpCSfqKJ5wScNJjRUdwTiI4i0plv+rPgJdJkJMyylGPSl/dnqaZZAqoINZ2Aj+FcEwMcCrYpNjNLEsJHZI+6ziqiGQ2HM8OnuBTp/Rwoo0rBXim/p4YE2ntSMauUxIY2EVvKv7ndTJIrsMxV2kGTNH5oiQTGDSefo973DAKYuQIoYa7WzEdEEMouIyKLoRg8eVl0ryoBn41uL8s127yOAroGJ2gCgrQFaqhO1RHDUSRRM/oFb15xnvx3r2PeeuKl88coT/wPn8A3BSPxw==</latexit><latexit sha1_base64="Za4K+hvlOK4F6lqnn6B4r3z0Z9s=">AAAB8HicbVDLSgNBEJz1GeMr6tHLYBAiSNgVQY9BLx4jmIckyzI7mU2GzGOZ6RVCyFd48aCIVz/Hm3/jJNmDJhY0FFXddHfFqeAWfP/bW1ldW9/YLGwVt3d29/ZLB4dNqzNDWYNqoU07JpYJrlgDOAjWTg0jMhasFQ9vp37riRnLtXqAUcpCSfqKJ5wScNJjRUdwTiI4i0plv+rPgJdJkJMyylGPSl/dnqaZZAqoINZ2Aj+FcEwMcCrYpNjNLEsJHZI+6ziqiGQ2HM8OnuBTp/Rwoo0rBXim/p4YE2ntSMauUxIY2EVvKv7ndTJIrsMxV2kGTNH5oiQTGDSefo973DAKYuQIoYa7WzEdEEMouIyKLoRg8eVl0ryoBn41uL8s127yOAroGJ2gCgrQFaqhO1RHDUSRRM/oFb15xnvx3r2PeeuKl88coT/wPn8A3BSPxw==</latexit>
s t
<latexit sha1_base64="NO/AVq0yYsPdpG3K5Q5U13QK4ss=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpwfSx71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AGmejd4=</latexit><latexit sha1_base64="NO/AVq0yYsPdpG3K5Q5U13QK4ss=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpwfSx71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AGmejd4=</latexit><latexit sha1_base64="NO/AVq0yYsPdpG3K5Q5U13QK4ss=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpwfSx71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AGmejd4=</latexit><latexit sha1_base64="NO/AVq0yYsPdpG3K5Q5U13QK4ss=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpwfSx71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AGmejd4=</latexit>
o t
<latexit sha1_base64="GWEncDH/xrS/rO0m41QTiTRN2pU=">AAAB6nicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzQOSJcxOZpMhszPLTK8QQj7BiwdFvPpF3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUjjlMeJnSgRCwYRSc96B72yhW/6s9BVkmQkwrkqPfKX92+ZlnCFTJJre0EforhhBoUTPJpqZtZnlI2ogPecVTRhNtwMj91Ss6c0iexNq4Ukrn6e2JCE2vHSeQ6E4pDu+zNxP+8TobxdTgRKs2QK7ZYFGeSoCazv0lfGM5Qjh2hzAh3K2FDaihDl07JhRAsv7xKmhfVwK8G95eV2k0eRxFO4BTOIYArqMEd1KEBDAbwDK/w5knvxXv3PhatBS+fOYY/8D5/AGOGjdo=</latexit><latexit sha1_base64="GWEncDH/xrS/rO0m41QTiTRN2pU=">AAAB6nicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzQOSJcxOZpMhszPLTK8QQj7BiwdFvPpF3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUjjlMeJnSgRCwYRSc96B72yhW/6s9BVkmQkwrkqPfKX92+ZlnCFTJJre0EforhhBoUTPJpqZtZnlI2ogPecVTRhNtwMj91Ss6c0iexNq4Ukrn6e2JCE2vHSeQ6E4pDu+zNxP+8TobxdTgRKs2QK7ZYFGeSoCazv0lfGM5Qjh2hzAh3K2FDaihDl07JhRAsv7xKmhfVwK8G95eV2k0eRxFO4BTOIYArqMEd1KEBDAbwDK/w5knvxXv3PhatBS+fOYY/8D5/AGOGjdo=</latexit><latexit sha1_base64="GWEncDH/xrS/rO0m41QTiTRN2pU=">AAAB6nicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzQOSJcxOZpMhszPLTK8QQj7BiwdFvPpF3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUjjlMeJnSgRCwYRSc96B72yhW/6s9BVkmQkwrkqPfKX92+ZlnCFTJJre0EforhhBoUTPJpqZtZnlI2ogPecVTRhNtwMj91Ss6c0iexNq4Ukrn6e2JCE2vHSeQ6E4pDu+zNxP+8TobxdTgRKs2QK7ZYFGeSoCazv0lfGM5Qjh2hzAh3K2FDaihDl07JhRAsv7xKmhfVwK8G95eV2k0eRxFO4BTOIYArqMEd1KEBDAbwDK/w5knvxXv3PhatBS+fOYY/8D5/AGOGjdo=</latexit><latexit sha1_base64="GWEncDH/xrS/rO0m41QTiTRN2pU=">AAAB6nicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzQOSJcxOZpMhszPLTK8QQj7BiwdFvPpF3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUjjlMeJnSgRCwYRSc96B72yhW/6s9BVkmQkwrkqPfKX92+ZlnCFTJJre0EforhhBoUTPJpqZtZnlI2ogPecVTRhNtwMj91Ss6c0iexNq4Ukrn6e2JCE2vHSeQ6E4pDu+zNxP+8TobxdTgRKs2QK7ZYFGeSoCazv0lfGM5Qjh2hzAh3K2FDaihDl07JhRAsv7xKmhfVwK8G95eV2k0eRxFO4BTOIYArqMEd1KEBDAbwDK/w5knvxXv3PhatBS+fOYY/8D5/AGOGjdo=</latexit>
a t
<latexit sha1_base64="cg9eTEqUtCZqkwCW5khYw4me7mE=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpgfax71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AE4yjcw=</latexit><latexit sha1_base64="cg9eTEqUtCZqkwCW5khYw4me7mE=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpgfax71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AE4yjcw=</latexit><latexit sha1_base64="cg9eTEqUtCZqkwCW5khYw4me7mE=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpgfax71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AE4yjcw=</latexit><latexit sha1_base64="cg9eTEqUtCZqkwCW5khYw4me7mE=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpgfax71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AE4yjcw=</latexit>
a t
<latexit sha1_base64="cg9eTEqUtCZqkwCW5khYw4me7mE=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpgfax71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AE4yjcw=</latexit><latexit sha1_base64="cg9eTEqUtCZqkwCW5khYw4me7mE=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpgfax71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AE4yjcw=</latexit><latexit sha1_base64="cg9eTEqUtCZqkwCW5khYw4me7mE=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpgfax71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AE4yjcw=</latexit><latexit sha1_base64="cg9eTEqUtCZqkwCW5khYw4me7mE=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpgfax71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AE4yjcw=</latexit>
p ( a t | s t )
<latexit sha1_base64="z6edt5KNSzS7CIwp1hJ0H6UP0S4=">AAAB8XicbVBNS8NAEJ34WetX1aOXxSLUS0lE0GPRi8cK9gPbEDbbTbt0swm7E6HU/gsvHhTx6r/x5r9x2+agrQ8GHu/NMDMvTKUw6Lrfzsrq2vrGZmGruL2zu7dfOjhsmiTTjDdYIhPdDqnhUijeQIGSt1PNaRxK3gqHN1O/9ci1EYm6x1HK/Zj2lYgEo2ilh7RCA3wyAZ4FpbJbdWcgy8TLSRly1IPSV7eXsCzmCpmkxnQ8N0V/TDUKJvmk2M0MTykb0j7vWKpozI0/nl08IadW6ZEo0bYUkpn6e2JMY2NGcWg7Y4oDs+hNxf+8TobRlT8WKs2QKzZfFGWSYEKm75Oe0JyhHFlCmRb2VsIGVFOGNqSiDcFbfHmZNM+rnlv17i7Ktes8jgIcwwlUwINLqMEt1KEBDBQ8wyu8OcZ5cd6dj3nripPPHMEfOJ8/LzqQlQ==</latexit><latexit sha1_base64="z6edt5KNSzS7CIwp1hJ0H6UP0S4=">AAAB8XicbVBNS8NAEJ34WetX1aOXxSLUS0lE0GPRi8cK9gPbEDbbTbt0swm7E6HU/gsvHhTx6r/x5r9x2+agrQ8GHu/NMDMvTKUw6Lrfzsrq2vrGZmGruL2zu7dfOjhsmiTTjDdYIhPdDqnhUijeQIGSt1PNaRxK3gqHN1O/9ci1EYm6x1HK/Zj2lYgEo2ilh7RCA3wyAZ4FpbJbdWcgy8TLSRly1IPSV7eXsCzmCpmkxnQ8N0V/TDUKJvmk2M0MTykb0j7vWKpozI0/nl08IadW6ZEo0bYUkpn6e2JMY2NGcWg7Y4oDs+hNxf+8TobRlT8WKs2QKzZfFGWSYEKm75Oe0JyhHFlCmRb2VsIGVFOGNqSiDcFbfHmZNM+rnlv17i7Ktes8jgIcwwlUwINLqMEt1KEBDBQ8wyu8OcZ5cd6dj3nripPPHMEfOJ8/LzqQlQ==</latexit><latexit sha1_base64="z6edt5KNSzS7CIwp1hJ0H6UP0S4=">AAAB8XicbVBNS8NAEJ34WetX1aOXxSLUS0lE0GPRi8cK9gPbEDbbTbt0swm7E6HU/gsvHhTx6r/x5r9x2+agrQ8GHu/NMDMvTKUw6Lrfzsrq2vrGZmGruL2zu7dfOjhsmiTTjDdYIhPdDqnhUijeQIGSt1PNaRxK3gqHN1O/9ci1EYm6x1HK/Zj2lYgEo2ilh7RCA3wyAZ4FpbJbdWcgy8TLSRly1IPSV7eXsCzmCpmkxnQ8N0V/TDUKJvmk2M0MTykb0j7vWKpozI0/nl08IadW6ZEo0bYUkpn6e2JMY2NGcWg7Y4oDs+hNxf+8TobRlT8WKs2QKzZfFGWSYEKm75Oe0JyhHFlCmRb2VsIGVFOGNqSiDcFbfHmZNM+rnlv17i7Ktes8jgIcwwlUwINLqMEt1KEBDBQ8wyu8OcZ5cd6dj3nripPPHMEfOJ8/LzqQlQ==</latexit><latexit sha1_base64="z6edt5KNSzS7CIwp1hJ0H6UP0S4=">AAAB8XicbVBNS8NAEJ34WetX1aOXxSLUS0lE0GPRi8cK9gPbEDbbTbt0swm7E6HU/gsvHhTx6r/x5r9x2+agrQ8GHu/NMDMvTKUw6Lrfzsrq2vrGZmGruL2zu7dfOjhsmiTTjDdYIhPdDqnhUijeQIGSt1PNaRxK3gqHN1O/9ci1EYm6x1HK/Zj2lYgEo2ilh7RCA3wyAZ4FpbJbdWcgy8TLSRly1IPSV7eXsCzmCpmkxnQ8N0V/TDUKJvmk2M0MTykb0j7vWKpozI0/nl08IadW6ZEo0bYUkpn6e2JMY2NGcWg7Y4oDs+hNxf+8TobRlT8WKs2QKzZfFGWSYEKm75Oe0JyhHFlCmRb2VsIGVFOGNqSiDcFbfHmZNM+rnlv17i7Ktes8jgIcwwlUwINLqMEt1KEBDBQ8wyu8OcZ5cd6dj3nripPPHMEfOJ8/LzqQlQ==</latexit>
Policy posterior
Policy priorq ( a t | s t )
<latexit sha1_base64="dXcLIQ2pQQ0m0lkaeicdQ5lHGKw=">AAAB8XicbVBNS8NAEJ3Ur1q/qh69BItQLyURQY9FLx4r2A9sQ9hsN+3SzSbuToQS+y+8eFDEq//Gm//GbZuDtj4YeLw3w8y8IBFco+N8W4WV1bX1jeJmaWt7Z3evvH/Q0nGqKGvSWMSqExDNBJesiRwF6ySKkSgQrB2Mrqd++5EpzWN5h+OEeREZSB5yStBI9w9V4uOT9vHUL1ecmjODvUzcnFQgR8Mvf/X6MU0jJpEKonXXdRL0MqKQU8EmpV6qWULoiAxY11BJIqa9bHbxxD4xSt8OY2VKoj1Tf09kJNJ6HAWmMyI41IveVPzP66YYXnoZl0mKTNL5ojAVNsb29H27zxWjKMaGEKq4udWmQ6IIRRNSyYTgLr68TFpnNdepubfnlfpVHkcRjuAYquDCBdThBhrQBAoSnuEV3ixtvVjv1se8tWDlM4fwB9bnDzDHkJY=</latexit><latexit sha1_base64="dXcLIQ2pQQ0m0lkaeicdQ5lHGKw=">AAAB8XicbVBNS8NAEJ3Ur1q/qh69BItQLyURQY9FLx4r2A9sQ9hsN+3SzSbuToQS+y+8eFDEq//Gm//GbZuDtj4YeLw3w8y8IBFco+N8W4WV1bX1jeJmaWt7Z3evvH/Q0nGqKGvSWMSqExDNBJesiRwF6ySKkSgQrB2Mrqd++5EpzWN5h+OEeREZSB5yStBI9w9V4uOT9vHUL1ecmjODvUzcnFQgR8Mvf/X6MU0jJpEKonXXdRL0MqKQU8EmpV6qWULoiAxY11BJIqa9bHbxxD4xSt8OY2VKoj1Tf09kJNJ6HAWmMyI41IveVPzP66YYXnoZl0mKTNL5ojAVNsb29H27zxWjKMaGEKq4udWmQ6IIRRNSyYTgLr68TFpnNdepubfnlfpVHkcRjuAYquDCBdThBhrQBAoSnuEV3ixtvVjv1se8tWDlM4fwB9bnDzDHkJY=</latexit><latexit sha1_base64="dXcLIQ2pQQ0m0lkaeicdQ5lHGKw=">AAAB8XicbVBNS8NAEJ3Ur1q/qh69BItQLyURQY9FLx4r2A9sQ9hsN+3SzSbuToQS+y+8eFDEq//Gm//GbZuDtj4YeLw3w8y8IBFco+N8W4WV1bX1jeJmaWt7Z3evvH/Q0nGqKGvSWMSqExDNBJesiRwF6ySKkSgQrB2Mrqd++5EpzWN5h+OEeREZSB5yStBI9w9V4uOT9vHUL1ecmjODvUzcnFQgR8Mvf/X6MU0jJpEKonXXdRL0MqKQU8EmpV6qWULoiAxY11BJIqa9bHbxxD4xSt8OY2VKoj1Tf09kJNJ6HAWmMyI41IveVPzP66YYXnoZl0mKTNL5ojAVNsb29H27zxWjKMaGEKq4udWmQ6IIRRNSyYTgLr68TFpnNdepubfnlfpVHkcRjuAYquDCBdThBhrQBAoSnuEV3ixtvVjv1se8tWDlM4fwB9bnDzDHkJY=</latexit><latexit sha1_base64="dXcLIQ2pQQ0m0lkaeicdQ5lHGKw=">AAAB8XicbVBNS8NAEJ3Ur1q/qh69BItQLyURQY9FLx4r2A9sQ9hsN+3SzSbuToQS+y+8eFDEq//Gm//GbZuDtj4YeLw3w8y8IBFco+N8W4WV1bX1jeJmaWt7Z3evvH/Q0nGqKGvSWMSqExDNBJesiRwF6ySKkSgQrB2Mrqd++5EpzWN5h+OEeREZSB5yStBI9w9V4uOT9vHUL1ecmjODvUzcnFQgR8Mvf/X6MU0jJpEKonXXdRL0MqKQU8EmpV6qWULoiAxY11BJIqa9bHbxxD4xSt8OY2VKoj1Tf09kJNJ6HAWmMyI41IveVPzP66YYXnoZl0mKTNL5ojAVNsb29H27zxWjKMaGEKq4udWmQ6IIRRNSyYTgLr68TFpnNdepubfnlfpVHkcRjuAYquDCBdThBhrQBAoSnuEV3ixtvVjv1se8tWDlM4fwB9bnDzDHkJY=</latexit>
p ( s t | s t   1 ,a t   1 )
<latexit sha1_base64="6j8EBRTuDkmkGdDc+wm4t4pBIjE=">AAAB/3icbVDLSsNAFJ3UV62vqODGzWARKmhJRNBl0Y3LCvYBbQiT6aQdnEzCzI1Q0i78FTcuFHHrb7jzb5y2WWjrgcs9nHMvc+cEieAaHOfbKiwtr6yuFddLG5tb2zv27l5Tx6mirEFjEat2QDQTXLIGcBCsnShGokCwVvBwM/Fbj0xpHst7GCbMi0hf8pBTAkby7YOkon0YaT+DM3d8Smb9xLfLTtWZAi8SNydllKPu21/dXkzTiEmggmjdcZ0EvIwo4FSwcambapYQ+kD6rGOoJBHTXja9f4yPjdLDYaxMScBT9fdGRiKth1FgJiMCAz3vTcT/vE4K4ZWXcZmkwCSdPRSmAkOMJ2HgHleMghgaQqji5lZMB0QRCiaykgnBnf/yImmeV12n6t5dlGvXeRxFdIiOUAW56BLV0C2qowaiaISe0St6s56sF+vd+piNFqx8Zx/9gfX5A+eplVw=</latexit><latexit sha1_base64="6j8EBRTuDkmkGdDc+wm4t4pBIjE=">AAAB/3icbVDLSsNAFJ3UV62vqODGzWARKmhJRNBl0Y3LCvYBbQiT6aQdnEzCzI1Q0i78FTcuFHHrb7jzb5y2WWjrgcs9nHMvc+cEieAaHOfbKiwtr6yuFddLG5tb2zv27l5Tx6mirEFjEat2QDQTXLIGcBCsnShGokCwVvBwM/Fbj0xpHst7GCbMi0hf8pBTAkby7YOkon0YaT+DM3d8Smb9xLfLTtWZAi8SNydllKPu21/dXkzTiEmggmjdcZ0EvIwo4FSwcambapYQ+kD6rGOoJBHTXja9f4yPjdLDYaxMScBT9fdGRiKth1FgJiMCAz3vTcT/vE4K4ZWXcZmkwCSdPRSmAkOMJ2HgHleMghgaQqji5lZMB0QRCiaykgnBnf/yImmeV12n6t5dlGvXeRxFdIiOUAW56BLV0C2qowaiaISe0St6s56sF+vd+piNFqx8Zx/9gfX5A+eplVw=</latexit><latexit sha1_base64="6j8EBRTuDkmkGdDc+wm4t4pBIjE=">AAAB/3icbVDLSsNAFJ3UV62vqODGzWARKmhJRNBl0Y3LCvYBbQiT6aQdnEzCzI1Q0i78FTcuFHHrb7jzb5y2WWjrgcs9nHMvc+cEieAaHOfbKiwtr6yuFddLG5tb2zv27l5Tx6mirEFjEat2QDQTXLIGcBCsnShGokCwVvBwM/Fbj0xpHst7GCbMi0hf8pBTAkby7YOkon0YaT+DM3d8Smb9xLfLTtWZAi8SNydllKPu21/dXkzTiEmggmjdcZ0EvIwo4FSwcambapYQ+kD6rGOoJBHTXja9f4yPjdLDYaxMScBT9fdGRiKth1FgJiMCAz3vTcT/vE4K4ZWXcZmkwCSdPRSmAkOMJ2HgHleMghgaQqji5lZMB0QRCiaykgnBnf/yImmeV12n6t5dlGvXeRxFdIiOUAW56BLV0C2qowaiaISe0St6s56sF+vd+piNFqx8Zx/9gfX5A+eplVw=</latexit><latexit sha1_base64="6j8EBRTuDkmkGdDc+wm4t4pBIjE=">AAAB/3icbVDLSsNAFJ3UV62vqODGzWARKmhJRNBl0Y3LCvYBbQiT6aQdnEzCzI1Q0i78FTcuFHHrb7jzb5y2WWjrgcs9nHMvc+cEieAaHOfbKiwtr6yuFddLG5tb2zv27l5Tx6mirEFjEat2QDQTXLIGcBCsnShGokCwVvBwM/Fbj0xpHst7GCbMi0hf8pBTAkby7YOkon0YaT+DM3d8Smb9xLfLTtWZAi8SNydllKPu21/dXkzTiEmggmjdcZ0EvIwo4FSwcambapYQ+kD6rGOoJBHTXja9f4yPjdLDYaxMScBT9fdGRiKth1FgJiMCAz3vTcT/vE4K4ZWXcZmkwCSdPRSmAkOMJ2HgHleMghgaQqji5lZMB0QRCiaykgnBnf/yImmeV12n6t5dlGvXeRxFdIiOUAW56BLV0C2qowaiaISe0St6s56sF+vd+piNFqx8Zx/9gfX5A+eplVw=</latexit>
State prior
①KL p ( a t +1 | s t +1 )
<latexit sha1_base64="PMzSHA+Uum0hdnUSEZDvqFYXGFQ=">AAAB+3icbVDLSsNAFJ34rPUV69LNYBEqQklE0GXRjcsK9gFtCJPppB06mYSZG7HE/IobF4q49Ufc+TdO2yy09cDlHs65l7lzgkRwDY7zba2srq1vbJa2yts7u3v79kGlreNUUdaisYhVNyCaCS5ZCzgI1k0UI1EgWCcY30z9zgNTmsfyHiYJ8yIylDzklICRfLuS1IifwZmbP+l5P/XtqlN3ZsDLxC1IFRVo+vZXfxDTNGISqCBa91wnAS8jCjgVLC/3U80SQsdkyHqGShIx7WWz23N8YpQBDmNlSgKeqb83MhJpPYkCMxkRGOlFbyr+5/VSCK+8jMskBSbp/KEwFRhiPA0CD7hiFMTEEEIVN7diOiKKUDBxlU0I7uKXl0n7vO46dffuotq4LuIooSN0jGrIRZeogW5RE7UQRY/oGb2iNyu3Xqx362M+umIVO4foD6zPH/zNk74=</latexit><latexit sha1_base64="PMzSHA+Uum0hdnUSEZDvqFYXGFQ=">AAAB+3icbVDLSsNAFJ34rPUV69LNYBEqQklE0GXRjcsK9gFtCJPppB06mYSZG7HE/IobF4q49Ufc+TdO2yy09cDlHs65l7lzgkRwDY7zba2srq1vbJa2yts7u3v79kGlreNUUdaisYhVNyCaCS5ZCzgI1k0UI1EgWCcY30z9zgNTmsfyHiYJ8yIylDzklICRfLuS1IifwZmbP+l5P/XtqlN3ZsDLxC1IFRVo+vZXfxDTNGISqCBa91wnAS8jCjgVLC/3U80SQsdkyHqGShIx7WWz23N8YpQBDmNlSgKeqb83MhJpPYkCMxkRGOlFbyr+5/VSCK+8jMskBSbp/KEwFRhiPA0CD7hiFMTEEEIVN7diOiKKUDBxlU0I7uKXl0n7vO46dffuotq4LuIooSN0jGrIRZeogW5RE7UQRY/oGb2iNyu3Xqx362M+umIVO4foD6zPH/zNk74=</latexit><latexit sha1_base64="PMzSHA+Uum0hdnUSEZDvqFYXGFQ=">AAAB+3icbVDLSsNAFJ34rPUV69LNYBEqQklE0GXRjcsK9gFtCJPppB06mYSZG7HE/IobF4q49Ufc+TdO2yy09cDlHs65l7lzgkRwDY7zba2srq1vbJa2yts7u3v79kGlreNUUdaisYhVNyCaCS5ZCzgI1k0UI1EgWCcY30z9zgNTmsfyHiYJ8yIylDzklICRfLuS1IifwZmbP+l5P/XtqlN3ZsDLxC1IFRVo+vZXfxDTNGISqCBa91wnAS8jCjgVLC/3U80SQsdkyHqGShIx7WWz23N8YpQBDmNlSgKeqb83MhJpPYkCMxkRGOlFbyr+5/VSCK+8jMskBSbp/KEwFRhiPA0CD7hiFMTEEEIVN7diOiKKUDBxlU0I7uKXl0n7vO46dffuotq4LuIooSN0jGrIRZeogW5RE7UQRY/oGb2iNyu3Xqx362M+umIVO4foD6zPH/zNk74=</latexit><latexit sha1_base64="PMzSHA+Uum0hdnUSEZDvqFYXGFQ=">AAAB+3icbVDLSsNAFJ34rPUV69LNYBEqQklE0GXRjcsK9gFtCJPppB06mYSZG7HE/IobF4q49Ufc+TdO2yy09cDlHs65l7lzgkRwDY7zba2srq1vbJa2yts7u3v79kGlreNUUdaisYhVNyCaCS5ZCzgI1k0UI1EgWCcY30z9zgNTmsfyHiYJ8yIylDzklICRfLuS1IifwZmbP+l5P/XtqlN3ZsDLxC1IFRVo+vZXfxDTNGISqCBa91wnAS8jCjgVLC/3U80SQsdkyHqGShIx7WWz23N8YpQBDmNlSgKeqb83MhJpPYkCMxkRGOlFbyr+5/VSCK+8jMskBSbp/KEwFRhiPA0CD7hiFMTEEEIVN7diOiKKUDBxlU0I7uKXl0n7vO46dffuotq4LuIooSN0jGrIRZeogW5RE7UQRY/oGb2iNyu3Xqx362M+umIVO4foD6zPH/zNk74=</latexit>
<latexit sha1_base64="ULSnIIM66Q1Q7f601OhRLk47uNY=">AAAB+3icbVDLSsNAFL2pr1pftS7dBItQEUoioi6LblxWsA9oQ5hMJ+3QyUyYmYgl5lfcuFDErT/izr9x2mahrQcu93DOvcydE8SMKu0431ZhZXVtfaO4Wdra3tndK+9X2kokEpMWFkzIboAUYZSTlqaakW4sCYoCRjrB+Gbqdx6IVFTwez2JiRehIachxUgbyS9X4prwU33qZk9q3k/8ctWpOzPYy8TNSRVyNP3yV38gcBIRrjFDSvVcJ9ZeiqSmmJGs1E8UiREeoyHpGcpRRJSXzm7P7GOjDOxQSFNc2zP190aKIqUmUWAmI6RHatGbiv95vUSHV15KeZxowvH8oTBhthb2NAh7QCXBmk0MQVhSc6uNR0girE1cJROCu/jlZdI+q7sXdefuvNq4zuMowiEcQQ1cuIQG3EITWoDhEZ7hFd6szHqx3q2P+WjByncO4A+szx8UjJPR</latexit>
p ( o t +1 | s t +1 )
<latexit sha1_base64="+xS9gOGc5H4ex9+bNPKivoJYEP4=">AAAB+3icbZDLSsNAFIYn9VbrLdalm8EiVJSSiKjLohuXFewF2hAm02k7dJIJMydiCXkVNy4UceuLuPNtnLZZaOsPAx//OYdz5g9iwTU4zrdVWFldW98obpa2tnd29+z9ckvLRFHWpFJI1QmIZoJHrAkcBOvEipEwEKwdjG+n9fYjU5rL6AEmMfNCMoz4gFMCxvLtclX6KZy62Rkmczjx7YpTc2bCy+DmUEG5Gr791etLmoQsAiqI1l3XicFLiQJOBctKvUSzmNAxGbKuwYiETHvp7PYMHxunjwdSmRcBnrm/J1ISaj0JA9MZEhjpxdrU/K/WTWBw7aU8ihNgEZ0vGiQCg8TTIHCfK0ZBTAwQqri5FdMRUYSCiatkQnAXv7wMrfOae1lz7i8q9Zs8jiI6REeoilx0heroDjVQE1H0hJ7RK3qzMuvFerc+5q0FK585QH9kff4AADGTHw==</latexit>
( o t +1 ,a t +1 )
Likelihood③H
<latexit sha1_base64="IBb5iCM/VlZJLX9E8UuOqrfFamo=">AAACHHicbVDLSgMxFM3UV62vqks3wSK0KGVGRd0IRRFcVrAPaIchk6ZtaObR5I5QxvkQN/6KGxeKuHEh+Ddm2i60eiBwcs69JOe4oeAKTPPLyMzNLywuZZdzK6tr6xv5za26CiJJWY0GIpBNlygmuM9qwEGwZigZ8VzBGu7gMvUbd0wqHvi3MAqZ7ZGez7ucEtCSkz86x22PQN9146vEiYdF5UBpWCQO3KcsaYVaiWHfStL7gdZLtpMvmGVzDPyXWFNSQFNUnfxHuxPQyGM+UEGUallmCHZMJHAqWJJrR4qFhA5Ij7U09YnHlB2PwyV4Tysd3A2kPj7gsfpzIyaeUiPP1ZNpEDXrpeJ/XiuC7pkdcz+MgPl08lA3EhgCnDaFO1wyCmKkCaGS679i2ieSUNB95nQJ1mzkv6R+WLZOyubNcaFyMa0ji3bQLioiC52iCrpGVVRDFD2gJ/SCXo1H49l4M94noxljurONfsH4/AYUnaFe</latexit>
= E q ( s t ) q ( a t | s t ) [ p ( s t +1 | s t ,a t )]
<latexit sha1_base64="mKuv6EBl6EbRPPDsO8OkiN7qcKw=">AAAB8XicbVDLSgNBEOz1GeMr6tHLYBAiQtgVUY9BLx4jmAcmIcxOZpMhs7PrTK8QlvyFFw+KePVvvPk3TpI9aGJBQ1HVTXeXH0th0HW/naXlldW19dxGfnNre2e3sLdfN1GiGa+xSEa66VPDpVC8hgIlb8aa09CXvOEPbyZ+44lrIyJ1j6OYd0LaVyIQjKKVHh5LppviqTc+6RaKbtmdgiwSLyNFyFDtFr7avYglIVfIJDWm5bkxdlKqUTDJx/l2YnhM2ZD2ectSRUNuOun04jE5tkqPBJG2pZBM1d8TKQ2NGYW+7QwpDsy8NxH/81oJBledVKg4Qa7YbFGQSIIRmbxPekJzhnJkCWVa2FsJG1BNGdqQ8jYEb/7lRVI/K3sXZffuvFi5zuLIwSEcQQk8uIQK3EIVasBAwTO8wptjnBfn3fmYtS452cwB/IHz+QOmRJA/</latexit>
q ( s t +1 )
①+ ②
<latexit sha1_base64="ZdXXPW8ediC6M1jvvJi92ZUxICw=">AAAB63icbVBNS8NAEJ3Ur1q/qh69BIvgqSQi6kUoCuKxgv2ANpTNdtsu3d2E3YlQQv+CFw+KePUPefPfuGlz0NYHA4/3ZpiZF8aCG/S8b6ewsrq2vlHcLG1t7+zulfcPmiZKNGUNGolIt0NimOCKNZCjYO1YMyJDwVrh+DbzW09MGx6pR5zELJBkqPiAU4KZdNfD61654lW9Gdxl4uekAjnqvfJXtx/RRDKFVBBjOr4XY5ASjZwKNi11E8NiQsdkyDqWKiKZCdLZrVP3xCp9dxBpWwrdmfp7IiXSmIkMbackODKLXib+53USHFwFKVdxgkzR+aJBIlyM3Oxxt881oygmlhCqub3VpSOiCUUbT8mG4C++vEyaZ1X/ouo9nFdqN3kcRTiCYzgFHy6hBvdQhwZQGMEzvMKbI50X5935mLcWnHzmEP7A+fwBqSuN/Q==</latexit>
F t =
<latexit sha1_base64="gkbd8z/mGS/EG+bPhZOUn2Xtbl8=">AAAB9HicbVBNS8NAEN3Ur1q/qh69LBZBEEoiol6EogcVPFSwH9DGstlu2qWbTdydFErI7/DiQRGv/hhv/hu3bQ7a+mDg8d4MM/O8SHANtv1t5RYWl5ZX8quFtfWNza3i9k5dh7GirEZDEaqmRzQTXLIacBCsGSlGAk+whje4GvuNIVOah/IBRhFzA9KT3OeUgJHc604CR076mNzepRedYsku2xPgeeJkpIQyVDvFr3Y3pHHAJFBBtG45dgRuQhRwKlhaaMeaRYQOSI+1DJUkYNpNJken+MAoXeyHypQEPFF/TyQk0HoUeKYzINDXs95Y/M9rxeCfuwmXUQxM0ukiPxYYQjxOAHe5YhTEyBBCFTe3YtonilAwORVMCM7sy/Okflx2Tsv2/UmpcpnFkUd7aB8dIgedoQq6QVVUQxQ9oWf0it6sofVivVsf09aclc3soj+wPn8A/J2Rlw==</latexit>
G
IL
t +1
= ③+ ④
Imagined data②-Log Likelihood ④-Log Likelihood
<latexit sha1_base64="gfOlF2ICVnafBLaQPRfgTw1WZ4Q=">AAAB7XicbVDLSgNBEOyNrxhfUY9eBoMQL2FXRD0GvXiMYB6QhDA7mU3GzO6sM71CWPIPXjwo4tX/8ebfOEn2oIkFDUVVN91dfiyFQdf9dnIrq2vrG/nNwtb2zu5ecf+gYVSiGa8zJZVu+dRwKSJeR4GSt2LNaehL3vRHN1O/+cS1ESq6x3HMuyEdRCIQjKKVGo9l08PTXrHkVtwZyDLxMlKCDLVe8avTVywJeYRMUmPanhtjN6UaBZN8UugkhseUjeiAty2NaMhNN51dOyEnVumTQGlbEZKZ+nsipaEx49C3nSHFoVn0puJ/XjvB4KqbiihOkEdsvihIJEFFpq+TvtCcoRxbQpkW9lbChlRThjaggg3BW3x5mTTOKt5Fxb07L1WvszjycATHUAYPLqEKt1CDOjB4gGd4hTdHOS/Ou/Mxb8052cwh/IHz+QMEQ47D</latexit>
q ( s t )
Likelihoodp ( o t | s t )
<latexit sha1_base64="K5nsz0lAGVYCovxc3OyjbKApN1M=">AAAB8XicbVBNS8NAEJ34WetX1aOXxSLUS0lE0GPRi8cK9gPbEDbbTbt0swm7E6HU/gsvHhTx6r/x5r9x2+agrQ8GHu/NMDMvTKUw6Lrfzsrq2vrGZmGruL2zu7dfOjhsmiTTjDdYIhPdDqnhUijeQIGSt1PNaRxK3gqHN1O/9ci1EYm6x1HK/Zj2lYgEo2ilh7SSBPhkAjwLSmW36s5AlomXkzLkqAelr24vYVnMFTJJjel4bor+mGoUTPJJsZsZnlI2pH3esVTRmBt/PLt4Qk6t0iNRom0pJDP198SYxsaM4tB2xhQHZtGbiv95nQyjK38sVJohV2y+KMokwYRM3yc9oTlDObKEMi3srYQNqKYMbUhFG4K3+PIyaZ5XPbfq3V2Ua9d5HAU4hhOogAeXUINbqEMDGCh4hld4c4zz4rw7H/PWFSefOYI/cD5/AETUkKM=</latexit><latexit sha1_base64="K5nsz0lAGVYCovxc3OyjbKApN1M=">AAAB8XicbVBNS8NAEJ34WetX1aOXxSLUS0lE0GPRi8cK9gPbEDbbTbt0swm7E6HU/gsvHhTx6r/x5r9x2+agrQ8GHu/NMDMvTKUw6Lrfzsrq2vrGZmGruL2zu7dfOjhsmiTTjDdYIhPdDqnhUijeQIGSt1PNaRxK3gqHN1O/9ci1EYm6x1HK/Zj2lYgEo2ilh7SSBPhkAjwLSmW36s5AlomXkzLkqAelr24vYVnMFTJJjel4bor+mGoUTPJJsZsZnlI2pH3esVTRmBt/PLt4Qk6t0iNRom0pJDP198SYxsaM4tB2xhQHZtGbiv95nQyjK38sVJohV2y+KMokwYRM3yc9oTlDObKEMi3srYQNqKYMbUhFG4K3+PIyaZ5XPbfq3V2Ua9d5HAU4hhOogAeXUINbqEMDGCh4hld4c4zz4rw7H/PWFSefOYI/cD5/AETUkKM=</latexit><latexit sha1_base64="K5nsz0lAGVYCovxc3OyjbKApN1M=">AAAB8XicbVBNS8NAEJ34WetX1aOXxSLUS0lE0GPRi8cK9gPbEDbbTbt0swm7E6HU/gsvHhTx6r/x5r9x2+agrQ8GHu/NMDMvTKUw6Lrfzsrq2vrGZmGruL2zu7dfOjhsmiTTjDdYIhPdDqnhUijeQIGSt1PNaRxK3gqHN1O/9ci1EYm6x1HK/Zj2lYgEo2ilh7SSBPhkAjwLSmW36s5AlomXkzLkqAelr24vYVnMFTJJjel4bor+mGoUTPJJsZsZnlI2pH3esVTRmBt/PLt4Qk6t0iNRom0pJDP198SYxsaM4tB2xhQHZtGbiv95nQyjK38sVJohV2y+KMokwYRM3yc9oTlDObKEMi3srYQNqKYMbUhFG4K3+PIyaZ5XPbfq3V2Ua9d5HAU4hhOogAeXUINbqEMDGCh4hld4c4zz4rw7H/PWFSefOYI/cD5/AETUkKM=</latexit><latexit sha1_base64="K5nsz0lAGVYCovxc3OyjbKApN1M=">AAAB8XicbVBNS8NAEJ34WetX1aOXxSLUS0lE0GPRi8cK9gPbEDbbTbt0swm7E6HU/gsvHhTx6r/x5r9x2+agrQ8GHu/NMDMvTKUw6Lrfzsrq2vrGZmGruL2zu7dfOjhsmiTTjDdYIhPdDqnhUijeQIGSt1PNaRxK3gqHN1O/9ci1EYm6x1HK/Zj2lYgEo2ilh7SSBPhkAjwLSmW36s5AlomXkzLkqAelr24vYVnMFTJJjel4bor+mGoUTPJJsZsZnlI2pH3esVTRmBt/PLt4Qk6t0iNRom0pJDP198SYxsaM4tB2xhQHZtGbiv95nQyjK38sVJohV2y+KMokwYRM3yc9oTlDObKEMi3srYQNqKYMbUhFG4K3+PIyaZ5XPbfq3V2Ua9d5HAU4hhOogAeXUINbqEMDGCh4hld4c4zz4rw7H/PWFSefOYI/cD5/AETUkKM=</latexit>
Figure 1.Deep Free Energy Network (FENet) calculation process
for IL phase.
Agent data(collected)
Go tot +2
<latexit sha1_base64="mfVvsTk2fKgDCpRjynE5oj1hy4U=">AAAB6nicbVBNS8NAEJ3Ur1q/qh69LBZBEEpSBD0WvXisaD+gDWWz3bRLN5uwOxFK6E/w4kERr/4ib/4bt20O2vpg4PHeDDPzgkQKg6777RTW1jc2t4rbpZ3dvf2D8uFRy8SpZrzJYhnrTkANl0LxJgqUvJNoTqNA8nYwvp357SeujYjVI04S7kd0qEQoGEUrPeBFrV+uuFV3DrJKvJxUIEejX/7qDWKWRlwhk9SYrucm6GdUo2CST0u91PCEsjEd8q6likbc+Nn81Ck5s8qAhLG2pZDM1d8TGY2MmUSB7YwojsyyNxP/87ophtd+JlSSIldssShMJcGYzP4mA6E5QzmxhDIt7K2EjaimDG06JRuCt/zyKmnVqp5b9e4vK/WbPI4inMApnIMHV1CHO2hAExgM4Rle4c2Rzovz7nwsWgtOPnMMf+B8/gC4CY1p</latexit><latexit sha1_base64="mfVvsTk2fKgDCpRjynE5oj1hy4U=">AAAB6nicbVBNS8NAEJ3Ur1q/qh69LBZBEEpSBD0WvXisaD+gDWWz3bRLN5uwOxFK6E/w4kERr/4ib/4bt20O2vpg4PHeDDPzgkQKg6777RTW1jc2t4rbpZ3dvf2D8uFRy8SpZrzJYhnrTkANl0LxJgqUvJNoTqNA8nYwvp357SeujYjVI04S7kd0qEQoGEUrPeBFrV+uuFV3DrJKvJxUIEejX/7qDWKWRlwhk9SYrucm6GdUo2CST0u91PCEsjEd8q6likbc+Nn81Ck5s8qAhLG2pZDM1d8TGY2MmUSB7YwojsyyNxP/87ophtd+JlSSIldssShMJcGYzP4mA6E5QzmxhDIt7K2EjaimDG06JRuCt/zyKmnVqp5b9e4vK/WbPI4inMApnIMHV1CHO2hAExgM4Rle4c2Rzovz7nwsWgtOPnMMf+B8/gC4CY1p</latexit><latexit sha1_base64="mfVvsTk2fKgDCpRjynE5oj1hy4U=">AAAB6nicbVBNS8NAEJ3Ur1q/qh69LBZBEEpSBD0WvXisaD+gDWWz3bRLN5uwOxFK6E/w4kERr/4ib/4bt20O2vpg4PHeDDPzgkQKg6777RTW1jc2t4rbpZ3dvf2D8uFRy8SpZrzJYhnrTkANl0LxJgqUvJNoTqNA8nYwvp357SeujYjVI04S7kd0qEQoGEUrPeBFrV+uuFV3DrJKvJxUIEejX/7qDWKWRlwhk9SYrucm6GdUo2CST0u91PCEsjEd8q6likbc+Nn81Ck5s8qAhLG2pZDM1d8TGY2MmUSB7YwojsyyNxP/87ophtd+JlSSIldssShMJcGYzP4mA6E5QzmxhDIt7K2EjaimDG06JRuCt/zyKmnVqp5b9e4vK/WbPI4inMApnIMHV1CHO2hAExgM4Rle4c2Rzovz7nwsWgtOPnMMf+B8/gC4CY1p</latexit><latexit sha1_base64="mfVvsTk2fKgDCpRjynE5oj1hy4U=">AAAB6nicbVBNS8NAEJ3Ur1q/qh69LBZBEEpSBD0WvXisaD+gDWWz3bRLN5uwOxFK6E/w4kERr/4ib/4bt20O2vpg4PHeDDPzgkQKg6777RTW1jc2t4rbpZ3dvf2D8uFRy8SpZrzJYhnrTkANl0LxJgqUvJNoTqNA8nYwvp357SeujYjVI04S7kd0qEQoGEUrPeBFrV+uuFV3DrJKvJxUIEejX/7qDWKWRlwhk9SYrucm6GdUo2CST0u91PCEsjEd8q6likbc+Nn81Ck5s8qAhLG2pZDM1d8TGY2MmUSB7YwojsyyNxP/87ophtd+JlSSIldssShMJcGYzP4mA6E5QzmxhDIt7K2EjaimDG06JRuCt/zyKmnVqp5b9e4vK/WbPI4inMApnIMHV1CHO2hAExgM4Rle4c2Rzovz7nwsWgtOPnMMf+B8/gC4CY1p</latexit>
s t +1
<latexit sha1_base64="ScCu8WZixoFvlWxDlnIdRy5VZ8I=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTPI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPHwfej1o=</latexit><latexit sha1_base64="ScCu8WZixoFvlWxDlnIdRy5VZ8I=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTPI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPHwfej1o=</latexit><latexit sha1_base64="ScCu8WZixoFvlWxDlnIdRy5VZ8I=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTPI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPHwfej1o=</latexit><latexit sha1_base64="ScCu8WZixoFvlWxDlnIdRy5VZ8I=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTPI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPHwfej1o=</latexit>
a t +1
<latexit sha1_base64="djQ9v+9DazsGJp0kdrM2GLD5C48=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTrI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPH+wbj0g=</latexit><latexit sha1_base64="djQ9v+9DazsGJp0kdrM2GLD5C48=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTrI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPH+wbj0g=</latexit><latexit sha1_base64="djQ9v+9DazsGJp0kdrM2GLD5C48=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTrI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPH+wbj0g=</latexit><latexit sha1_base64="djQ9v+9DazsGJp0kdrM2GLD5C48=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTrI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPH+wbj0g=</latexit>
a t +1
<latexit sha1_base64="djQ9v+9DazsGJp0kdrM2GLD5C48=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTrI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPH+wbj0g=</latexit><latexit sha1_base64="djQ9v+9DazsGJp0kdrM2GLD5C48=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTrI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPH+wbj0g=</latexit><latexit sha1_base64="djQ9v+9DazsGJp0kdrM2GLD5C48=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTrI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPH+wbj0g=</latexit><latexit sha1_base64="djQ9v+9DazsGJp0kdrM2GLD5C48=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBZBEEoigh6LXjxWsB/QhrLZbtqlm03YnQgl9Ed48aCIV3+PN/+NmzYHbX0w8Hhvhpl5QSKFQdf9dkpr6xubW+Xtys7u3v5B9fCobeJUM95isYx1N6CGS6F4CwVK3k00p1EgeSeY3OV+54lrI2L1iNOE+xEdKREKRtFKHTrI8MKbDao1t+7OQVaJV5AaFGgOql/9YczSiCtkkhrT89wE/YxqFEzyWaWfGp5QNqEj3rNU0YgbP5ufOyNnVhmSMNa2FJK5+nsio5Ex0yiwnRHFsVn2cvE/r5dieONnQiUpcsUWi8JUEoxJ/jsZCs0ZyqkllGlhbyVsTDVlaBOq2BC85ZdXSfuy7rl17+Gq1rgt4ijDCZzCOXhwDQ24hya0gMEEnuEV3pzEeXHenY9Fa8kpZo7hD5zPH+wbj0g=</latexit>
Policy posterior
Policy priorq ( a t +1 | s t +1 )
<latexit sha1_base64="xof7cE7q/XM4A1UVVPJmyZTZnMA=">AAAB+3icbVDLSsNAFL2pr1pfsS7dDBahIpREBF0W3bisYB/QhjCZTtuhk0mcmYgl5lfcuFDErT/izr9x2mahrQcu93DOvcydE8ScKe0431ZhZXVtfaO4Wdra3tnds/fLLRUlktAmiXgkOwFWlDNBm5ppTjuxpDgMOG0H4+up336gUrFI3OlJTL0QDwUbMIK1kXy7fF/FfqpP3exJzfuJb1ecmjMDWiZuTiqQo+HbX71+RJKQCk04VqrrOrH2Uiw1I5xmpV6iaIzJGA9p11CBQ6q8dHZ7ho6N0keDSJoSGs3U3xspDpWahIGZDLEeqUVvKv7ndRM9uPRSJuJEU0HmDw0SjnSEpkGgPpOUaD4xBBPJzK2IjLDERJu4SiYEd/HLy6R1VnOdmnt7Xqlf5XEU4RCOoAouXEAdbqABTSDwCM/wCm9WZr1Y79bHfLRg5TsH8AfW5w/+YpO/</latexit><latexit sha1_base64="xof7cE7q/XM4A1UVVPJmyZTZnMA=">AAAB+3icbVDLSsNAFL2pr1pfsS7dDBahIpREBF0W3bisYB/QhjCZTtuhk0mcmYgl5lfcuFDErT/izr9x2mahrQcu93DOvcydE8ScKe0431ZhZXVtfaO4Wdra3tnds/fLLRUlktAmiXgkOwFWlDNBm5ppTjuxpDgMOG0H4+up336gUrFI3OlJTL0QDwUbMIK1kXy7fF/FfqpP3exJzfuJb1ecmjMDWiZuTiqQo+HbX71+RJKQCk04VqrrOrH2Uiw1I5xmpV6iaIzJGA9p11CBQ6q8dHZ7ho6N0keDSJoSGs3U3xspDpWahIGZDLEeqUVvKv7ndRM9uPRSJuJEU0HmDw0SjnSEpkGgPpOUaD4xBBPJzK2IjLDERJu4SiYEd/HLy6R1VnOdmnt7Xqlf5XEU4RCOoAouXEAdbqABTSDwCM/wCm9WZr1Y79bHfLRg5TsH8AfW5w/+YpO/</latexit><latexit sha1_base64="xof7cE7q/XM4A1UVVPJmyZTZnMA=">AAAB+3icbVDLSsNAFL2pr1pfsS7dDBahIpREBF0W3bisYB/QhjCZTtuhk0mcmYgl5lfcuFDErT/izr9x2mahrQcu93DOvcydE8ScKe0431ZhZXVtfaO4Wdra3tnds/fLLRUlktAmiXgkOwFWlDNBm5ppTjuxpDgMOG0H4+up336gUrFI3OlJTL0QDwUbMIK1kXy7fF/FfqpP3exJzfuJb1ecmjMDWiZuTiqQo+HbX71+RJKQCk04VqrrOrH2Uiw1I5xmpV6iaIzJGA9p11CBQ6q8dHZ7ho6N0keDSJoSGs3U3xspDpWahIGZDLEeqUVvKv7ndRM9uPRSJuJEU0HmDw0SjnSEpkGgPpOUaD4xBBPJzK2IjLDERJu4SiYEd/HLy6R1VnOdmnt7Xqlf5XEU4RCOoAouXEAdbqABTSDwCM/wCm9WZr1Y79bHfLRg5TsH8AfW5w/+YpO/</latexit><latexit sha1_base64="xof7cE7q/XM4A1UVVPJmyZTZnMA=">AAAB+3icbVDLSsNAFL2pr1pfsS7dDBahIpREBF0W3bisYB/QhjCZTtuhk0mcmYgl5lfcuFDErT/izr9x2mahrQcu93DOvcydE8ScKe0431ZhZXVtfaO4Wdra3tnds/fLLRUlktAmiXgkOwFWlDNBm5ppTjuxpDgMOG0H4+up336gUrFI3OlJTL0QDwUbMIK1kXy7fF/FfqpP3exJzfuJb1ecmjMDWiZuTiqQo+HbX71+RJKQCk04VqrrOrH2Uiw1I5xmpV6iaIzJGA9p11CBQ6q8dHZ7ho6N0keDSJoSGs3U3xspDpWahIGZDLEeqUVvKv7ndRM9uPRSJuJEU0HmDw0SjnSEpkGgPpOUaD4xBBPJzK2IjLDERJu4SiYEd/HLy6R1VnOdmnt7Xqlf5XEU4RCOoAouXEAdbqABTSDwCM/wCm9WZr1Y79bHfLRg5TsH8AfW5w/+YpO/</latexit>
State prior
Free Energy CalculationExpected Free Energy Calculation
s t
<latexit sha1_base64="NO/AVq0yYsPdpG3K5Q5U13QK4ss=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpwfSx71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AGmejd4=</latexit><latexit sha1_base64="NO/AVq0yYsPdpG3K5Q5U13QK4ss=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpwfSx71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AGmejd4=</latexit><latexit sha1_base64="NO/AVq0yYsPdpG3K5Q5U13QK4ss=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpwfSx71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AGmejd4=</latexit><latexit sha1_base64="NO/AVq0yYsPdpG3K5Q5U13QK4ss=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpwfSx71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AGmejd4=</latexit>
a t
<latexit sha1_base64="cg9eTEqUtCZqkwCW5khYw4me7mE=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpgfax71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AE4yjcw=</latexit><latexit sha1_base64="cg9eTEqUtCZqkwCW5khYw4me7mE=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpgfax71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AE4yjcw=</latexit><latexit sha1_base64="cg9eTEqUtCZqkwCW5khYw4me7mE=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpgfax71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AE4yjcw=</latexit><latexit sha1_base64="cg9eTEqUtCZqkwCW5khYw4me7mE=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpgfax71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AE4yjcw=</latexit>
a t
<latexit sha1_base64="cg9eTEqUtCZqkwCW5khYw4me7mE=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpgfax71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AE4yjcw=</latexit><latexit sha1_base64="cg9eTEqUtCZqkwCW5khYw4me7mE=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpgfax71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AE4yjcw=</latexit><latexit sha1_base64="cg9eTEqUtCZqkwCW5khYw4me7mE=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpgfax71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AE4yjcw=</latexit><latexit sha1_base64="cg9eTEqUtCZqkwCW5khYw4me7mE=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpgfax71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AE4yjcw=</latexit>
Likelihoodp ( o t | s t )
<latexit sha1_base64="K5nsz0lAGVYCovxc3OyjbKApN1M=">AAAB8XicbVBNS8NAEJ34WetX1aOXxSLUS0lE0GPRi8cK9gPbEDbbTbt0swm7E6HU/gsvHhTx6r/x5r9x2+agrQ8GHu/NMDMvTKUw6Lrfzsrq2vrGZmGruL2zu7dfOjhsmiTTjDdYIhPdDqnhUijeQIGSt1PNaRxK3gqHN1O/9ci1EYm6x1HK/Zj2lYgEo2ilh7SSBPhkAjwLSmW36s5AlomXkzLkqAelr24vYVnMFTJJjel4bor+mGoUTPJJsZsZnlI2pH3esVTRmBt/PLt4Qk6t0iNRom0pJDP198SYxsaM4tB2xhQHZtGbiv95nQyjK38sVJohV2y+KMokwYRM3yc9oTlDObKEMi3srYQNqKYMbUhFG4K3+PIyaZ5XPbfq3V2Ua9d5HAU4hhOogAeXUINbqEMDGCh4hld4c4zz4rw7H/PWFSefOYI/cD5/AETUkKM=</latexit><latexit sha1_base64="K5nsz0lAGVYCovxc3OyjbKApN1M=">AAAB8XicbVBNS8NAEJ34WetX1aOXxSLUS0lE0GPRi8cK9gPbEDbbTbt0swm7E6HU/gsvHhTx6r/x5r9x2+agrQ8GHu/NMDMvTKUw6Lrfzsrq2vrGZmGruL2zu7dfOjhsmiTTjDdYIhPdDqnhUijeQIGSt1PNaRxK3gqHN1O/9ci1EYm6x1HK/Zj2lYgEo2ilh7SSBPhkAjwLSmW36s5AlomXkzLkqAelr24vYVnMFTJJjel4bor+mGoUTPJJsZsZnlI2pH3esVTRmBt/PLt4Qk6t0iNRom0pJDP198SYxsaM4tB2xhQHZtGbiv95nQyjK38sVJohV2y+KMokwYRM3yc9oTlDObKEMi3srYQNqKYMbUhFG4K3+PIyaZ5XPbfq3V2Ua9d5HAU4hhOogAeXUINbqEMDGCh4hld4c4zz4rw7H/PWFSefOYI/cD5/AETUkKM=</latexit><latexit sha1_base64="K5nsz0lAGVYCovxc3OyjbKApN1M=">AAAB8XicbVBNS8NAEJ34WetX1aOXxSLUS0lE0GPRi8cK9gPbEDbbTbt0swm7E6HU/gsvHhTx6r/x5r9x2+agrQ8GHu/NMDMvTKUw6Lrfzsrq2vrGZmGruL2zu7dfOjhsmiTTjDdYIhPdDqnhUijeQIGSt1PNaRxK3gqHN1O/9ci1EYm6x1HK/Zj2lYgEo2ilh7SSBPhkAjwLSmW36s5AlomXkzLkqAelr24vYVnMFTJJjel4bor+mGoUTPJJsZsZnlI2pH3esVTRmBt/PLt4Qk6t0iNRom0pJDP198SYxsaM4tB2xhQHZtGbiv95nQyjK38sVJohV2y+KMokwYRM3yc9oTlDObKEMi3srYQNqKYMbUhFG4K3+PIyaZ5XPbfq3V2Ua9d5HAU4hhOogAeXUINbqEMDGCh4hld4c4zz4rw7H/PWFSefOYI/cD5/AETUkKM=</latexit><latexit sha1_base64="K5nsz0lAGVYCovxc3OyjbKApN1M=">AAAB8XicbVBNS8NAEJ34WetX1aOXxSLUS0lE0GPRi8cK9gPbEDbbTbt0swm7E6HU/gsvHhTx6r/x5r9x2+agrQ8GHu/NMDMvTKUw6Lrfzsrq2vrGZmGruL2zu7dfOjhsmiTTjDdYIhPdDqnhUijeQIGSt1PNaRxK3gqHN1O/9ci1EYm6x1HK/Zj2lYgEo2ilh7SSBPhkAjwLSmW36s5AlomXkzLkqAelr24vYVnMFTJJjel4bor+mGoUTPJJsZsZnlI2pH3esVTRmBt/PLt4Qk6t0iNRom0pJDP198SYxsaM4tB2xhQHZtGbiv95nQyjK38sVJohV2y+KMokwYRM3yc9oTlDObKEMi3srYQNqKYMbUhFG4K3+PIyaZ5XPbfq3V2Ua9d5HAU4hhOogAeXUINbqEMDGCh4hld4c4zz4rw7H/PWFSefOYI/cD5/AETUkKM=</latexit>
p ( a t | s t )
<latexit sha1_base64="z6edt5KNSzS7CIwp1hJ0H6UP0S4=">AAAB8XicbVBNS8NAEJ34WetX1aOXxSLUS0lE0GPRi8cK9gPbEDbbTbt0swm7E6HU/gsvHhTx6r/x5r9x2+agrQ8GHu/NMDMvTKUw6Lrfzsrq2vrGZmGruL2zu7dfOjhsmiTTjDdYIhPdDqnhUijeQIGSt1PNaRxK3gqHN1O/9ci1EYm6x1HK/Zj2lYgEo2ilh7RCA3wyAZ4FpbJbdWcgy8TLSRly1IPSV7eXsCzmCpmkxnQ8N0V/TDUKJvmk2M0MTykb0j7vWKpozI0/nl08IadW6ZEo0bYUkpn6e2JMY2NGcWg7Y4oDs+hNxf+8TobRlT8WKs2QKzZfFGWSYEKm75Oe0JyhHFlCmRb2VsIGVFOGNqSiDcFbfHmZNM+rnlv17i7Ktes8jgIcwwlUwINLqMEt1KEBDBQ8wyu8OcZ5cd6dj3nripPPHMEfOJ8/LzqQlQ==</latexit><latexit sha1_base64="z6edt5KNSzS7CIwp1hJ0H6UP0S4=">AAAB8XicbVBNS8NAEJ34WetX1aOXxSLUS0lE0GPRi8cK9gPbEDbbTbt0swm7E6HU/gsvHhTx6r/x5r9x2+agrQ8GHu/NMDMvTKUw6Lrfzsrq2vrGZmGruL2zu7dfOjhsmiTTjDdYIhPdDqnhUijeQIGSt1PNaRxK3gqHN1O/9ci1EYm6x1HK/Zj2lYgEo2ilh7RCA3wyAZ4FpbJbdWcgy8TLSRly1IPSV7eXsCzmCpmkxnQ8N0V/TDUKJvmk2M0MTykb0j7vWKpozI0/nl08IadW6ZEo0bYUkpn6e2JMY2NGcWg7Y4oDs+hNxf+8TobRlT8WKs2QKzZfFGWSYEKm75Oe0JyhHFlCmRb2VsIGVFOGNqSiDcFbfHmZNM+rnlv17i7Ktes8jgIcwwlUwINLqMEt1KEBDBQ8wyu8OcZ5cd6dj3nripPPHMEfOJ8/LzqQlQ==</latexit><latexit sha1_base64="z6edt5KNSzS7CIwp1hJ0H6UP0S4=">AAAB8XicbVBNS8NAEJ34WetX1aOXxSLUS0lE0GPRi8cK9gPbEDbbTbt0swm7E6HU/gsvHhTx6r/x5r9x2+agrQ8GHu/NMDMvTKUw6Lrfzsrq2vrGZmGruL2zu7dfOjhsmiTTjDdYIhPdDqnhUijeQIGSt1PNaRxK3gqHN1O/9ci1EYm6x1HK/Zj2lYgEo2ilh7RCA3wyAZ4FpbJbdWcgy8TLSRly1IPSV7eXsCzmCpmkxnQ8N0V/TDUKJvmk2M0MTykb0j7vWKpozI0/nl08IadW6ZEo0bYUkpn6e2JMY2NGcWg7Y4oDs+hNxf+8TobRlT8WKs2QKzZfFGWSYEKm75Oe0JyhHFlCmRb2VsIGVFOGNqSiDcFbfHmZNM+rnlv17i7Ktes8jgIcwwlUwINLqMEt1KEBDBQ8wyu8OcZ5cd6dj3nripPPHMEfOJ8/LzqQlQ==</latexit><latexit sha1_base64="z6edt5KNSzS7CIwp1hJ0H6UP0S4=">AAAB8XicbVBNS8NAEJ34WetX1aOXxSLUS0lE0GPRi8cK9gPbEDbbTbt0swm7E6HU/gsvHhTx6r/x5r9x2+agrQ8GHu/NMDMvTKUw6Lrfzsrq2vrGZmGruL2zu7dfOjhsmiTTjDdYIhPdDqnhUijeQIGSt1PNaRxK3gqHN1O/9ci1EYm6x1HK/Zj2lYgEo2ilh7RCA3wyAZ4FpbJbdWcgy8TLSRly1IPSV7eXsCzmCpmkxnQ8N0V/TDUKJvmk2M0MTykb0j7vWKpozI0/nl08IadW6ZEo0bYUkpn6e2JMY2NGcWg7Y4oDs+hNxf+8TobRlT8WKs2QKzZfFGWSYEKm75Oe0JyhHFlCmRb2VsIGVFOGNqSiDcFbfHmZNM+rnlv17i7Ktes8jgIcwwlUwINLqMEt1KEBDBQ8wyu8OcZ5cd6dj3nripPPHMEfOJ8/LzqQlQ==</latexit>
Policy posterior
Policy priorq ( a t | s t )
<latexit sha1_base64="dXcLIQ2pQQ0m0lkaeicdQ5lHGKw=">AAAB8XicbVBNS8NAEJ3Ur1q/qh69BItQLyURQY9FLx4r2A9sQ9hsN+3SzSbuToQS+y+8eFDEq//Gm//GbZuDtj4YeLw3w8y8IBFco+N8W4WV1bX1jeJmaWt7Z3evvH/Q0nGqKGvSWMSqExDNBJesiRwF6ySKkSgQrB2Mrqd++5EpzWN5h+OEeREZSB5yStBI9w9V4uOT9vHUL1ecmjODvUzcnFQgR8Mvf/X6MU0jJpEKonXXdRL0MqKQU8EmpV6qWULoiAxY11BJIqa9bHbxxD4xSt8OY2VKoj1Tf09kJNJ6HAWmMyI41IveVPzP66YYXnoZl0mKTNL5ojAVNsb29H27zxWjKMaGEKq4udWmQ6IIRRNSyYTgLr68TFpnNdepubfnlfpVHkcRjuAYquDCBdThBhrQBAoSnuEV3ixtvVjv1se8tWDlM4fwB9bnDzDHkJY=</latexit><latexit sha1_base64="dXcLIQ2pQQ0m0lkaeicdQ5lHGKw=">AAAB8XicbVBNS8NAEJ3Ur1q/qh69BItQLyURQY9FLx4r2A9sQ9hsN+3SzSbuToQS+y+8eFDEq//Gm//GbZuDtj4YeLw3w8y8IBFco+N8W4WV1bX1jeJmaWt7Z3evvH/Q0nGqKGvSWMSqExDNBJesiRwF6ySKkSgQrB2Mrqd++5EpzWN5h+OEeREZSB5yStBI9w9V4uOT9vHUL1ecmjODvUzcnFQgR8Mvf/X6MU0jJpEKonXXdRL0MqKQU8EmpV6qWULoiAxY11BJIqa9bHbxxD4xSt8OY2VKoj1Tf09kJNJ6HAWmMyI41IveVPzP66YYXnoZl0mKTNL5ojAVNsb29H27zxWjKMaGEKq4udWmQ6IIRRNSyYTgLr68TFpnNdepubfnlfpVHkcRjuAYquDCBdThBhrQBAoSnuEV3ixtvVjv1se8tWDlM4fwB9bnDzDHkJY=</latexit><latexit sha1_base64="dXcLIQ2pQQ0m0lkaeicdQ5lHGKw=">AAAB8XicbVBNS8NAEJ3Ur1q/qh69BItQLyURQY9FLx4r2A9sQ9hsN+3SzSbuToQS+y+8eFDEq//Gm//GbZuDtj4YeLw3w8y8IBFco+N8W4WV1bX1jeJmaWt7Z3evvH/Q0nGqKGvSWMSqExDNBJesiRwF6ySKkSgQrB2Mrqd++5EpzWN5h+OEeREZSB5yStBI9w9V4uOT9vHUL1ecmjODvUzcnFQgR8Mvf/X6MU0jJpEKonXXdRL0MqKQU8EmpV6qWULoiAxY11BJIqa9bHbxxD4xSt8OY2VKoj1Tf09kJNJ6HAWmMyI41IveVPzP66YYXnoZl0mKTNL5ojAVNsb29H27zxWjKMaGEKq4udWmQ6IIRRNSyYTgLr68TFpnNdepubfnlfpVHkcRjuAYquDCBdThBhrQBAoSnuEV3ixtvVjv1se8tWDlM4fwB9bnDzDHkJY=</latexit><latexit sha1_base64="dXcLIQ2pQQ0m0lkaeicdQ5lHGKw=">AAAB8XicbVBNS8NAEJ3Ur1q/qh69BItQLyURQY9FLx4r2A9sQ9hsN+3SzSbuToQS+y+8eFDEq//Gm//GbZuDtj4YeLw3w8y8IBFco+N8W4WV1bX1jeJmaWt7Z3evvH/Q0nGqKGvSWMSqExDNBJesiRwF6ySKkSgQrB2Mrqd++5EpzWN5h+OEeREZSB5yStBI9w9V4uOT9vHUL1ecmjODvUzcnFQgR8Mvf/X6MU0jJpEKonXXdRL0MqKQU8EmpV6qWULoiAxY11BJIqa9bHbxxD4xSt8OY2VKoj1Tf09kJNJ6HAWmMyI41IveVPzP66YYXnoZl0mKTNL5ojAVNsb29H27zxWjKMaGEKq4udWmQ6IIRRNSyYTgLr68TFpnNdepubfnlfpVHkcRjuAYquDCBdThBhrQBAoSnuEV3ixtvVjv1se8tWDlM4fwB9bnDzDHkJY=</latexit>
p ( s t | s t   1 ,a t   1 )
<latexit sha1_base64="6j8EBRTuDkmkGdDc+wm4t4pBIjE=">AAAB/3icbVDLSsNAFJ3UV62vqODGzWARKmhJRNBl0Y3LCvYBbQiT6aQdnEzCzI1Q0i78FTcuFHHrb7jzb5y2WWjrgcs9nHMvc+cEieAaHOfbKiwtr6yuFddLG5tb2zv27l5Tx6mirEFjEat2QDQTXLIGcBCsnShGokCwVvBwM/Fbj0xpHst7GCbMi0hf8pBTAkby7YOkon0YaT+DM3d8Smb9xLfLTtWZAi8SNydllKPu21/dXkzTiEmggmjdcZ0EvIwo4FSwcambapYQ+kD6rGOoJBHTXja9f4yPjdLDYaxMScBT9fdGRiKth1FgJiMCAz3vTcT/vE4K4ZWXcZmkwCSdPRSmAkOMJ2HgHleMghgaQqji5lZMB0QRCiaykgnBnf/yImmeV12n6t5dlGvXeRxFdIiOUAW56BLV0C2qowaiaISe0St6s56sF+vd+piNFqx8Zx/9gfX5A+eplVw=</latexit><latexit sha1_base64="6j8EBRTuDkmkGdDc+wm4t4pBIjE=">AAAB/3icbVDLSsNAFJ3UV62vqODGzWARKmhJRNBl0Y3LCvYBbQiT6aQdnEzCzI1Q0i78FTcuFHHrb7jzb5y2WWjrgcs9nHMvc+cEieAaHOfbKiwtr6yuFddLG5tb2zv27l5Tx6mirEFjEat2QDQTXLIGcBCsnShGokCwVvBwM/Fbj0xpHst7GCbMi0hf8pBTAkby7YOkon0YaT+DM3d8Smb9xLfLTtWZAi8SNydllKPu21/dXkzTiEmggmjdcZ0EvIwo4FSwcambapYQ+kD6rGOoJBHTXja9f4yPjdLDYaxMScBT9fdGRiKth1FgJiMCAz3vTcT/vE4K4ZWXcZmkwCSdPRSmAkOMJ2HgHleMghgaQqji5lZMB0QRCiaykgnBnf/yImmeV12n6t5dlGvXeRxFdIiOUAW56BLV0C2qowaiaISe0St6s56sF+vd+piNFqx8Zx/9gfX5A+eplVw=</latexit><latexit sha1_base64="6j8EBRTuDkmkGdDc+wm4t4pBIjE=">AAAB/3icbVDLSsNAFJ3UV62vqODGzWARKmhJRNBl0Y3LCvYBbQiT6aQdnEzCzI1Q0i78FTcuFHHrb7jzb5y2WWjrgcs9nHMvc+cEieAaHOfbKiwtr6yuFddLG5tb2zv27l5Tx6mirEFjEat2QDQTXLIGcBCsnShGokCwVvBwM/Fbj0xpHst7GCbMi0hf8pBTAkby7YOkon0YaT+DM3d8Smb9xLfLTtWZAi8SNydllKPu21/dXkzTiEmggmjdcZ0EvIwo4FSwcambapYQ+kD6rGOoJBHTXja9f4yPjdLDYaxMScBT9fdGRiKth1FgJiMCAz3vTcT/vE4K4ZWXcZmkwCSdPRSmAkOMJ2HgHleMghgaQqji5lZMB0QRCiaykgnBnf/yImmeV12n6t5dlGvXeRxFdIiOUAW56BLV0C2qowaiaISe0St6s56sF+vd+piNFqx8Zx/9gfX5A+eplVw=</latexit><latexit sha1_base64="6j8EBRTuDkmkGdDc+wm4t4pBIjE=">AAAB/3icbVDLSsNAFJ3UV62vqODGzWARKmhJRNBl0Y3LCvYBbQiT6aQdnEzCzI1Q0i78FTcuFHHrb7jzb5y2WWjrgcs9nHMvc+cEieAaHOfbKiwtr6yuFddLG5tb2zv27l5Tx6mirEFjEat2QDQTXLIGcBCsnShGokCwVvBwM/Fbj0xpHst7GCbMi0hf8pBTAkby7YOkon0YaT+DM3d8Smb9xLfLTtWZAi8SNydllKPu21/dXkzTiEmggmjdcZ0EvIwo4FSwcambapYQ+kD6rGOoJBHTXja9f4yPjdLDYaxMScBT9fdGRiKth1FgJiMCAz3vTcT/vE4K4ZWXcZmkwCSdPRSmAkOMJ2HgHleMghgaQqji5lZMB0QRCiaykgnBnf/yImmeV12n6t5dlGvXeRxFdIiOUAW56BLV0C2qowaiaISe0St6s56sF+vd+piNFqx8Zx/9gfX5A+eplVw=</latexit>
State prior
②-Log Likelihood
p ( a t +1 | s t +1 )
<latexit sha1_base64="PMzSHA+Uum0hdnUSEZDvqFYXGFQ=">AAAB+3icbVDLSsNAFJ34rPUV69LNYBEqQklE0GXRjcsK9gFtCJPppB06mYSZG7HE/IobF4q49Ufc+TdO2yy09cDlHs65l7lzgkRwDY7zba2srq1vbJa2yts7u3v79kGlreNUUdaisYhVNyCaCS5ZCzgI1k0UI1EgWCcY30z9zgNTmsfyHiYJ8yIylDzklICRfLuS1IifwZmbP+l5P/XtqlN3ZsDLxC1IFRVo+vZXfxDTNGISqCBa91wnAS8jCjgVLC/3U80SQsdkyHqGShIx7WWz23N8YpQBDmNlSgKeqb83MhJpPYkCMxkRGOlFbyr+5/VSCK+8jMskBSbp/KEwFRhiPA0CD7hiFMTEEEIVN7diOiKKUDBxlU0I7uKXl0n7vO46dffuotq4LuIooSN0jGrIRZeogW5RE7UQRY/oGb2iNyu3Xqx362M+umIVO4foD6zPH/zNk74=</latexit><latexit sha1_base64="PMzSHA+Uum0hdnUSEZDvqFYXGFQ=">AAAB+3icbVDLSsNAFJ34rPUV69LNYBEqQklE0GXRjcsK9gFtCJPppB06mYSZG7HE/IobF4q49Ufc+TdO2yy09cDlHs65l7lzgkRwDY7zba2srq1vbJa2yts7u3v79kGlreNUUdaisYhVNyCaCS5ZCzgI1k0UI1EgWCcY30z9zgNTmsfyHiYJ8yIylDzklICRfLuS1IifwZmbP+l5P/XtqlN3ZsDLxC1IFRVo+vZXfxDTNGISqCBa91wnAS8jCjgVLC/3U80SQsdkyHqGShIx7WWz23N8YpQBDmNlSgKeqb83MhJpPYkCMxkRGOlFbyr+5/VSCK+8jMskBSbp/KEwFRhiPA0CD7hiFMTEEEIVN7diOiKKUDBxlU0I7uKXl0n7vO46dffuotq4LuIooSN0jGrIRZeogW5RE7UQRY/oGb2iNyu3Xqx362M+umIVO4foD6zPH/zNk74=</latexit><latexit sha1_base64="PMzSHA+Uum0hdnUSEZDvqFYXGFQ=">AAAB+3icbVDLSsNAFJ34rPUV69LNYBEqQklE0GXRjcsK9gFtCJPppB06mYSZG7HE/IobF4q49Ufc+TdO2yy09cDlHs65l7lzgkRwDY7zba2srq1vbJa2yts7u3v79kGlreNUUdaisYhVNyCaCS5ZCzgI1k0UI1EgWCcY30z9zgNTmsfyHiYJ8yIylDzklICRfLuS1IifwZmbP+l5P/XtqlN3ZsDLxC1IFRVo+vZXfxDTNGISqCBa91wnAS8jCjgVLC/3U80SQsdkyHqGShIx7WWz23N8YpQBDmNlSgKeqb83MhJpPYkCMxkRGOlFbyr+5/VSCK+8jMskBSbp/KEwFRhiPA0CD7hiFMTEEEIVN7diOiKKUDBxlU0I7uKXl0n7vO46dffuotq4LuIooSN0jGrIRZeogW5RE7UQRY/oGb2iNyu3Xqx362M+umIVO4foD6zPH/zNk74=</latexit><latexit sha1_base64="PMzSHA+Uum0hdnUSEZDvqFYXGFQ=">AAAB+3icbVDLSsNAFJ34rPUV69LNYBEqQklE0GXRjcsK9gFtCJPppB06mYSZG7HE/IobF4q49Ufc+TdO2yy09cDlHs65l7lzgkRwDY7zba2srq1vbJa2yts7u3v79kGlreNUUdaisYhVNyCaCS5ZCzgI1k0UI1EgWCcY30z9zgNTmsfyHiYJ8yIylDzklICRfLuS1IifwZmbP+l5P/XtqlN3ZsDLxC1IFRVo+vZXfxDTNGISqCBa91wnAS8jCjgVLC/3U80SQsdkyHqGShIx7WWz23N8YpQBDmNlSgKeqb83MhJpPYkCMxkRGOlFbyr+5/VSCK+8jMskBSbp/KEwFRhiPA0CD7hiFMTEEEIVN7diOiKKUDBxlU0I7uKXl0n7vO46dffuotq4LuIooSN0jGrIRZeogW5RE7UQRY/oGb2iNyu3Xqx362M+umIVO4foD6zPH/zNk74=</latexit>
<latexit sha1_base64="ULSnIIM66Q1Q7f601OhRLk47uNY=">AAAB+3icbVDLSsNAFL2pr1pftS7dBItQEUoioi6LblxWsA9oQ5hMJ+3QyUyYmYgl5lfcuFDErT/izr9x2mahrQcu93DOvcydE8SMKu0431ZhZXVtfaO4Wdra3tndK+9X2kokEpMWFkzIboAUYZSTlqaakW4sCYoCRjrB+Gbqdx6IVFTwez2JiRehIachxUgbyS9X4prwU33qZk9q3k/8ctWpOzPYy8TNSRVyNP3yV38gcBIRrjFDSvVcJ9ZeiqSmmJGs1E8UiREeoyHpGcpRRJSXzm7P7GOjDOxQSFNc2zP190aKIqUmUWAmI6RHatGbiv95vUSHV15KeZxowvH8oTBhthb2NAh7QCXBmk0MQVhSc6uNR0girE1cJROCu/jlZdI+q7sXdefuvNq4zuMowiEcQQ1cuIQG3EITWoDhEZ7hFd6szHqx3q2P+WjByncO4A+szx8UjJPR</latexit>
p ( o t +1 | s t +1 )
Imagined data
Likelihood
<latexit sha1_base64="IBb5iCM/VlZJLX9E8UuOqrfFamo=">AAACHHicbVDLSgMxFM3UV62vqks3wSK0KGVGRd0IRRFcVrAPaIchk6ZtaObR5I5QxvkQN/6KGxeKuHEh+Ddm2i60eiBwcs69JOe4oeAKTPPLyMzNLywuZZdzK6tr6xv5za26CiJJWY0GIpBNlygmuM9qwEGwZigZ8VzBGu7gMvUbd0wqHvi3MAqZ7ZGez7ucEtCSkz86x22PQN9146vEiYdF5UBpWCQO3KcsaYVaiWHfStL7gdZLtpMvmGVzDPyXWFNSQFNUnfxHuxPQyGM+UEGUallmCHZMJHAqWJJrR4qFhA5Ij7U09YnHlB2PwyV4Tysd3A2kPj7gsfpzIyaeUiPP1ZNpEDXrpeJ/XiuC7pkdcz+MgPl08lA3EhgCnDaFO1wyCmKkCaGS679i2ieSUNB95nQJ1mzkv6R+WLZOyubNcaFyMa0ji3bQLioiC52iCrpGVVRDFD2gJ/SCXo1H49l4M94noxljurONfsH4/AYUnaFe</latexit>
= E q ( s t ) q ( a t | s t ) [ p ( s t +1 | s t ,a t )]
<latexit sha1_base64="mKuv6EBl6EbRPPDsO8OkiN7qcKw=">AAAB8XicbVDLSgNBEOz1GeMr6tHLYBAiQtgVUY9BLx4jmAcmIcxOZpMhs7PrTK8QlvyFFw+KePVvvPk3TpI9aGJBQ1HVTXeXH0th0HW/naXlldW19dxGfnNre2e3sLdfN1GiGa+xSEa66VPDpVC8hgIlb8aa09CXvOEPbyZ+44lrIyJ1j6OYd0LaVyIQjKKVHh5LppviqTc+6RaKbtmdgiwSLyNFyFDtFr7avYglIVfIJDWm5bkxdlKqUTDJx/l2YnhM2ZD2ectSRUNuOun04jE5tkqPBJG2pZBM1d8TKQ2NGYW+7QwpDsy8NxH/81oJBledVKg4Qa7YbFGQSIIRmbxPekJzhnJkCWVa2FsJG1BNGdqQ8jYEb/7lRVI/K3sXZffuvFi5zuLIwSEcQQk8uIQK3EIVasBAwTO8wptjnBfn3fmYtS452cwB/IHz+QOmRJA/</latexit>
q ( s t +1 )
①+ ②
<latexit sha1_base64="ZdXXPW8ediC6M1jvvJi92ZUxICw=">AAAB63icbVBNS8NAEJ3Ur1q/qh69BIvgqSQi6kUoCuKxgv2ANpTNdtsu3d2E3YlQQv+CFw+KePUPefPfuGlz0NYHA4/3ZpiZF8aCG/S8b6ewsrq2vlHcLG1t7+zulfcPmiZKNGUNGolIt0NimOCKNZCjYO1YMyJDwVrh+DbzW09MGx6pR5zELJBkqPiAU4KZdNfD61654lW9Gdxl4uekAjnqvfJXtx/RRDKFVBBjOr4XY5ASjZwKNi11E8NiQsdkyDqWKiKZCdLZrVP3xCp9dxBpWwrdmfp7IiXSmIkMbackODKLXib+53USHFwFKVdxgkzR+aJBIlyM3Oxxt881oygmlhCqub3VpSOiCUUbT8mG4C++vEyaZ1X/ouo9nFdqN3kcRTiCYzgFHy6hBvdQhwZQGMEzvMKbI50X5935mLcWnHzmEP7A+fwBqSuN/Q==</latexit>
F t = ③+ ④+ ⑤
o t
<latexit sha1_base64="GWEncDH/xrS/rO0m41QTiTRN2pU=">AAAB6nicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzQOSJcxOZpMhszPLTK8QQj7BiwdFvPpF3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUjjlMeJnSgRCwYRSc96B72yhW/6s9BVkmQkwrkqPfKX92+ZlnCFTJJre0EforhhBoUTPJpqZtZnlI2ogPecVTRhNtwMj91Ss6c0iexNq4Ukrn6e2JCE2vHSeQ6E4pDu+zNxP+8TobxdTgRKs2QK7ZYFGeSoCazv0lfGM5Qjh2hzAh3K2FDaihDl07JhRAsv7xKmhfVwK8G95eV2k0eRxFO4BTOIYArqMEd1KEBDAbwDK/w5knvxXv3PhatBS+fOYY/8D5/AGOGjdo=</latexit><latexit sha1_base64="GWEncDH/xrS/rO0m41QTiTRN2pU=">AAAB6nicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzQOSJcxOZpMhszPLTK8QQj7BiwdFvPpF3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUjjlMeJnSgRCwYRSc96B72yhW/6s9BVkmQkwrkqPfKX92+ZlnCFTJJre0EforhhBoUTPJpqZtZnlI2ogPecVTRhNtwMj91Ss6c0iexNq4Ukrn6e2JCE2vHSeQ6E4pDu+zNxP+8TobxdTgRKs2QK7ZYFGeSoCazv0lfGM5Qjh2hzAh3K2FDaihDl07JhRAsv7xKmhfVwK8G95eV2k0eRxFO4BTOIYArqMEd1KEBDAbwDK/w5knvxXv3PhatBS+fOYY/8D5/AGOGjdo=</latexit><latexit sha1_base64="GWEncDH/xrS/rO0m41QTiTRN2pU=">AAAB6nicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzQOSJcxOZpMhszPLTK8QQj7BiwdFvPpF3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUjjlMeJnSgRCwYRSc96B72yhW/6s9BVkmQkwrkqPfKX92+ZlnCFTJJre0EforhhBoUTPJpqZtZnlI2ogPecVTRhNtwMj91Ss6c0iexNq4Ukrn6e2JCE2vHSeQ6E4pDu+zNxP+8TobxdTgRKs2QK7ZYFGeSoCazv0lfGM5Qjh2hzAh3K2FDaihDl07JhRAsv7xKmhfVwK8G95eV2k0eRxFO4BTOIYArqMEd1KEBDAbwDK/w5knvxXv3PhatBS+fOYY/8D5/AGOGjdo=</latexit><latexit sha1_base64="GWEncDH/xrS/rO0m41QTiTRN2pU=">AAAB6nicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzQOSJcxOZpMhszPLTK8QQj7BiwdFvPpF3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUjjlMeJnSgRCwYRSc96B72yhW/6s9BVkmQkwrkqPfKX92+ZlnCFTJJre0EforhhBoUTPJpqZtZnlI2ogPecVTRhNtwMj91Ss6c0iexNq4Ukrn6e2JCE2vHSeQ6E4pDu+zNxP+8TobxdTgRKs2QK7ZYFGeSoCazv0lfGM5Qjh2hzAh3K2FDaihDl07JhRAsv7xKmhfVwK8G95eV2k0eRxFO4BTOIYArqMEd1KEBDAbwDK/w5knvxXv3PhatBS+fOYY/8D5/AGOGjdo=</latexit>
r t   1
<latexit sha1_base64="tMTAZJ4kJ5YndbdPnFvRNsbNtFs=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBbBiyURQY9FLx4r2A9oQ9lsN+3SzSbsToQS+iO8eFDEq7/Hm//GTZuDtj4YeLw3w8y8IJHCoOt+O6W19Y3NrfJ2ZWd3b/+genjUNnGqGW+xWMa6G1DDpVC8hQIl7yaa0yiQvBNM7nK/88S1EbF6xGnC/YiOlAgFo2iljh5keOHNBtWaW3fnIKvEK0gNCjQH1a/+MGZpxBUySY3peW6CfkY1Cib5rNJPDU8om9AR71mqaMSNn83PnZEzqwxJGGtbCslc/T2R0ciYaRTYzoji2Cx7ufif10sxvPEzoZIUuWKLRWEqCcYk/50MheYM5dQSyrSwtxI2ppoytAlVbAje8surpH1Z99y693BVa9wWcZThBE7hHDy4hgbcQxNawGACz/AKb07ivDjvzseiteQUM8fwB87nDwlgj1s=</latexit><latexit sha1_base64="tMTAZJ4kJ5YndbdPnFvRNsbNtFs=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBbBiyURQY9FLx4r2A9oQ9lsN+3SzSbsToQS+iO8eFDEq7/Hm//GTZuDtj4YeLw3w8y8IJHCoOt+O6W19Y3NrfJ2ZWd3b/+genjUNnGqGW+xWMa6G1DDpVC8hQIl7yaa0yiQvBNM7nK/88S1EbF6xGnC/YiOlAgFo2iljh5keOHNBtWaW3fnIKvEK0gNCjQH1a/+MGZpxBUySY3peW6CfkY1Cib5rNJPDU8om9AR71mqaMSNn83PnZEzqwxJGGtbCslc/T2R0ciYaRTYzoji2Cx7ufif10sxvPEzoZIUuWKLRWEqCcYk/50MheYM5dQSyrSwtxI2ppoytAlVbAje8surpH1Z99y693BVa9wWcZThBE7hHDy4hgbcQxNawGACz/AKb07ivDjvzseiteQUM8fwB87nDwlgj1s=</latexit><latexit sha1_base64="tMTAZJ4kJ5YndbdPnFvRNsbNtFs=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBbBiyURQY9FLx4r2A9oQ9lsN+3SzSbsToQS+iO8eFDEq7/Hm//GTZuDtj4YeLw3w8y8IJHCoOt+O6W19Y3NrfJ2ZWd3b/+genjUNnGqGW+xWMa6G1DDpVC8hQIl7yaa0yiQvBNM7nK/88S1EbF6xGnC/YiOlAgFo2iljh5keOHNBtWaW3fnIKvEK0gNCjQH1a/+MGZpxBUySY3peW6CfkY1Cib5rNJPDU8om9AR71mqaMSNn83PnZEzqwxJGGtbCslc/T2R0ciYaRTYzoji2Cx7ufif10sxvPEzoZIUuWKLRWEqCcYk/50MheYM5dQSyrSwtxI2ppoytAlVbAje8surpH1Z99y693BVa9wWcZThBE7hHDy4hgbcQxNawGACz/AKb07ivDjvzseiteQUM8fwB87nDwlgj1s=</latexit><latexit sha1_base64="tMTAZJ4kJ5YndbdPnFvRNsbNtFs=">AAAB7nicbVBNS8NAEJ3Ur1q/qh69LBbBiyURQY9FLx4r2A9oQ9lsN+3SzSbsToQS+iO8eFDEq7/Hm//GTZuDtj4YeLw3w8y8IJHCoOt+O6W19Y3NrfJ2ZWd3b/+genjUNnGqGW+xWMa6G1DDpVC8hQIl7yaa0yiQvBNM7nK/88S1EbF6xGnC/YiOlAgFo2iljh5keOHNBtWaW3fnIKvEK0gNCjQH1a/+MGZpxBUySY3peW6CfkY1Cib5rNJPDU8om9AR71mqaMSNn83PnZEzqwxJGGtbCslc/T2R0ciYaRTYzoji2Cx7ufif10sxvPEzoZIUuWKLRWEqCcYk/50MheYM5dQSyrSwtxI2ppoytAlVbAje8surpH1Z99y693BVa9wWcZThBE7hHDy4hgbcQxNawGACz/AKb07ivDjvzseiteQUM8fwB87nDwlgj1s=</latexit>
o t +1
<latexit sha1_base64="X1pEAXTYHbGJRxJqEjstwtSrvfc=">AAAB7nicbVDLSgNBEOyNrxhfUY9eBoMgCGFXBD0GvXiMYB6QLGF2MkmGzM4sM71CWPIRXjwo4tXv8ebfOEn2oIkFDUVVN91dUSKFRd//9gpr6xubW8Xt0s7u3v5B+fCoaXVqGG8wLbVpR9RyKRRvoEDJ24nhNI4kb0Xju5nfeuLGCq0ecZLwMKZDJQaCUXRSS/cyvAimvXLFr/pzkFUS5KQCOeq98le3r1kac4VMUms7gZ9gmFGDgkk+LXVTyxPKxnTIO44qGnMbZvNzp+TMKX0y0MaVQjJXf09kNLZ2EkeuM6Y4ssveTPzP66Q4uAkzoZIUuWKLRYNUEtRk9jvpC8MZyokjlBnhbiVsRA1l6BIquRCC5ZdXSfOyGvjV4OGqUrvN4yjCCZzCOQRwDTW4hzo0gMEYnuEV3rzEe/HevY9Fa8HLZ47hD7zPHwG2j1Y=</latexit><latexit sha1_base64="X1pEAXTYHbGJRxJqEjstwtSrvfc=">AAAB7nicbVDLSgNBEOyNrxhfUY9eBoMgCGFXBD0GvXiMYB6QLGF2MkmGzM4sM71CWPIRXjwo4tXv8ebfOEn2oIkFDUVVN91dUSKFRd//9gpr6xubW8Xt0s7u3v5B+fCoaXVqGG8wLbVpR9RyKRRvoEDJ24nhNI4kb0Xju5nfeuLGCq0ecZLwMKZDJQaCUXRSS/cyvAimvXLFr/pzkFUS5KQCOeq98le3r1kac4VMUms7gZ9gmFGDgkk+LXVTyxPKxnTIO44qGnMbZvNzp+TMKX0y0MaVQjJXf09kNLZ2EkeuM6Y4ssveTPzP66Q4uAkzoZIUuWKLRYNUEtRk9jvpC8MZyokjlBnhbiVsRA1l6BIquRCC5ZdXSfOyGvjV4OGqUrvN4yjCCZzCOQRwDTW4hzo0gMEYnuEV3rzEe/HevY9Fa8HLZ47hD7zPHwG2j1Y=</latexit><latexit sha1_base64="X1pEAXTYHbGJRxJqEjstwtSrvfc=">AAAB7nicbVDLSgNBEOyNrxhfUY9eBoMgCGFXBD0GvXiMYB6QLGF2MkmGzM4sM71CWPIRXjwo4tXv8ebfOEn2oIkFDUVVN91dUSKFRd//9gpr6xubW8Xt0s7u3v5B+fCoaXVqGG8wLbVpR9RyKRRvoEDJ24nhNI4kb0Xju5nfeuLGCq0ecZLwMKZDJQaCUXRSS/cyvAimvXLFr/pzkFUS5KQCOeq98le3r1kac4VMUms7gZ9gmFGDgkk+LXVTyxPKxnTIO44qGnMbZvNzp+TMKX0y0MaVQjJXf09kNLZ2EkeuM6Y4ssveTPzP66Q4uAkzoZIUuWKLRYNUEtRk9jvpC8MZyokjlBnhbiVsRA1l6BIquRCC5ZdXSfOyGvjV4OGqUrvN4yjCCZzCOQRwDTW4hzo0gMEYnuEV3rzEe/HevY9Fa8HLZ47hD7zPHwG2j1Y=</latexit><latexit sha1_base64="X1pEAXTYHbGJRxJqEjstwtSrvfc=">AAAB7nicbVDLSgNBEOyNrxhfUY9eBoMgCGFXBD0GvXiMYB6QLGF2MkmGzM4sM71CWPIRXjwo4tXv8ebfOEn2oIkFDUVVN91dUSKFRd//9gpr6xubW8Xt0s7u3v5B+fCoaXVqGG8wLbVpR9RyKRRvoEDJ24nhNI4kb0Xju5nfeuLGCq0ecZLwMKZDJQaCUXRSS/cyvAimvXLFr/pzkFUS5KQCOeq98le3r1kac4VMUms7gZ9gmFGDgkk+LXVTyxPKxnTIO44qGnMbZvNzp+TMKX0y0MaVQjJXf09kNLZ2EkeuM6Y4ssveTPzP66Q4uAkzoZIUuWKLRYNUEtRk9jvpC8MZyokjlBnhbiVsRA1l6BIquRCC5ZdXSfOyGvjV4OGqUrvN4yjCCZzCOQRwDTW4hzo0gMEYnuEV3rzEe/HevY9Fa8HLZ47hD7zPHwG2j1Y=</latexit>
r t
<latexit sha1_base64="Bmobwtq6d1VdnrQp0oh1JwbYUlg=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpQfex71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AGgYjd0=</latexit><latexit sha1_base64="Bmobwtq6d1VdnrQp0oh1JwbYUlg=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpQfex71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AGgYjd0=</latexit><latexit sha1_base64="Bmobwtq6d1VdnrQp0oh1JwbYUlg=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpQfex71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AGgYjd0=</latexit><latexit sha1_base64="Bmobwtq6d1VdnrQp0oh1JwbYUlg=">AAAB6nicbVBNS8NAEJ3Ur1q/oh69LBbBU0lE0GPRi8eK9gPaUDbbTbt0swm7E6GE/gQvHhTx6i/y5r9x2+agrQ8GHu/NMDMvTKUw6HnfTmltfWNzq7xd2dnd2z9wD49aJsk0402WyER3Qmq4FIo3UaDknVRzGoeSt8Px7cxvP3FtRKIecZLyIKZDJSLBKFrpQfex71a9mjcHWSV+QapQoNF3v3qDhGUxV8gkNabreykGOdUomOTTSi8zPKVsTIe8a6miMTdBPj91Ss6sMiBRom0pJHP190ROY2MmcWg7Y4ojs+zNxP+8bobRdZALlWbIFVssijJJMCGzv8lAaM5QTiyhTAt7K2EjqilDm07FhuAvv7xKWhc136v595fV+k0RRxlO4BTOwYcrqMMdNKAJDIbwDK/w5kjnxXl3PhatJaeYOYY/cD5/AGgYjd0=</latexit>
⑤-Expected rewardState posteriorq ( s t +1 | o t +1 )
<latexit sha1_base64="QjogK14NYBAQpFCuRJjDAVWsc6E=">AAAB+3icbVDLSsNAFJ3UV62vWJdugkWoCCURQZdFNy4r2Ae0IUym03boZCbO3Igl5lfcuFDErT/izr9x2mahrQcu93DOvcydE8acaXDdb6uwsrq2vlHcLG1t7+zu2fvllpaJIrRJJJeqE2JNORO0CQw47cSK4ijktB2Or6d++4EqzaS4g0lM/QgPBRswgsFIgV2+r+oghVMve5LzfhLYFbfmzuAsEy8nFZSjEdhfvb4kSUQFEI617npuDH6KFTDCaVbqJZrGmIzxkHYNFTii2k9nt2fOsVH6zkAqUwKcmfp7I8WR1pMoNJMRhpFe9Kbif143gcGlnzIRJ0AFmT80SLgD0pkG4fSZogT4xBBMFDO3OmSEFSZg4iqZELzFLy+T1lnNc2ve7XmlfpXHUUSH6AhVkYcuUB3doAZqIoIe0TN6RW9WZr1Y79bHfLRg5TsH6A+szx8Um5PN</latexit><latexit sha1_base64="QjogK14NYBAQpFCuRJjDAVWsc6E=">AAAB+3icbVDLSsNAFJ3UV62vWJdugkWoCCURQZdFNy4r2Ae0IUym03boZCbO3Igl5lfcuFDErT/izr9x2mahrQcu93DOvcydE8acaXDdb6uwsrq2vlHcLG1t7+zu2fvllpaJIrRJJJeqE2JNORO0CQw47cSK4ijktB2Or6d++4EqzaS4g0lM/QgPBRswgsFIgV2+r+oghVMve5LzfhLYFbfmzuAsEy8nFZSjEdhfvb4kSUQFEI617npuDH6KFTDCaVbqJZrGmIzxkHYNFTii2k9nt2fOsVH6zkAqUwKcmfp7I8WR1pMoNJMRhpFe9Kbif143gcGlnzIRJ0AFmT80SLgD0pkG4fSZogT4xBBMFDO3OmSEFSZg4iqZELzFLy+T1lnNc2ve7XmlfpXHUUSH6AhVkYcuUB3doAZqIoIe0TN6RW9WZr1Y79bHfLRg5TsH6A+szx8Um5PN</latexit><latexit sha1_base64="QjogK14NYBAQpFCuRJjDAVWsc6E=">AAAB+3icbVDLSsNAFJ3UV62vWJdugkWoCCURQZdFNy4r2Ae0IUym03boZCbO3Igl5lfcuFDErT/izr9x2mahrQcu93DOvcydE8acaXDdb6uwsrq2vlHcLG1t7+zu2fvllpaJIrRJJJeqE2JNORO0CQw47cSK4ijktB2Or6d++4EqzaS4g0lM/QgPBRswgsFIgV2+r+oghVMve5LzfhLYFbfmzuAsEy8nFZSjEdhfvb4kSUQFEI617npuDH6KFTDCaVbqJZrGmIzxkHYNFTii2k9nt2fOsVH6zkAqUwKcmfp7I8WR1pMoNJMRhpFe9Kbif143gcGlnzIRJ0AFmT80SLgD0pkG4fSZogT4xBBMFDO3OmSEFSZg4iqZELzFLy+T1lnNc2ve7XmlfpXHUUSH6AhVkYcuUB3doAZqIoIe0TN6RW9WZr1Y79bHfLRg5TsH6A+szx8Um5PN</latexit><latexit sha1_base64="QjogK14NYBAQpFCuRJjDAVWsc6E=">AAAB+3icbVDLSsNAFJ3UV62vWJdugkWoCCURQZdFNy4r2Ae0IUym03boZCbO3Igl5lfcuFDErT/izr9x2mahrQcu93DOvcydE8acaXDdb6uwsrq2vlHcLG1t7+zu2fvllpaJIrRJJJeqE2JNORO0CQw47cSK4ijktB2Or6d++4EqzaS4g0lM/QgPBRswgsFIgV2+r+oghVMve5LzfhLYFbfmzuAsEy8nFZSjEdhfvb4kSUQFEI617npuDH6KFTDCaVbqJZrGmIzxkHYNFTii2k9nt2fOsVH6zkAqUwKcmfp7I8WR1pMoNJMRhpFe9Kbif143gcGlnzIRJ0AFmT80SLgD0pkG4fSZogT4xBBMFDO3OmSEFSZg4iqZELzFLy+T1lnNc2ve7XmlfpXHUUSH6AhVkYcuUB3doAZqIoIe0TN6RW9WZr1Y79bHfLRg5TsH6A+szx8Um5PN</latexit>
③-KL
<latexit sha1_base64="KYnLCmkS4XlRROahe1hvGHXgd58=">AAAB/HicbVBNS8NAEN34WetXtEcvi0WoUEsioh6LXjxWsB/QhrDZbtulm03YnQgh1L/ixYMiXv0h3vw3btsctPXBwOO9GWbmBbHgGhzn21pZXVvf2CxsFbd3dvf27YPDlo4SRVmTRiJSnYBoJrhkTeAgWCdWjISBYO1gfDv1249MaR7JB0hj5oVkKPmAUwJG8u1SJfKhipWfwZk7qWLiw6lvl52aMwNeJm5OyihHw7e/ev2IJiGTQAXRuus6MXgZUcCpYJNiL9EsJnRMhqxrqCQh0142O36CT4zSx4NImZKAZ+rviYyEWqdhYDpDAiO96E3F/7xuAoNrL+MyToBJOl80SASGCE+TwH2uGAWRGkKo4uZWTEdEEQomr6IJwV18eZm0zmvuZc25vyjXb/I4CugIHaMKctEVqqM71EBNRFGKntErerOerBfr3fqYt65Y+UwJ/YH1+QOJppNo</latexit>
( o t ,r t   1 ,a t )
<latexit sha1_base64="JczJgwYH8dSKfDFj1arIVxNWzGo=">AAACAHicbVDLSsNAFJ3UV62vqAsXbgaLULGURERdFt24rGAf0IYwmU7boZNMmLkRSsjGX3HjQhG3foY7/8Zpm4VWD1w4c869zL0niAXX4DhfVmFpeWV1rbhe2tjc2t6xd/daWiaKsiaVQqpOQDQTPGJN4CBYJ1aMhIFg7WB8M/XbD0xpLqN7mMTMC8kw4gNOCRjJtw8q0k/h1M2qWPlQxWT+OvHtslNzZsB/iZuTMsrR8O3PXl/SJGQRUEG07rpODF5KFHAqWFbqJZrFhI7JkHUNjUjItJfODsjwsVH6eCCVqQjwTP05kZJQ60kYmM6QwEgvelPxP6+bwODKS3kUJ8AiOv9okAgMEk/TwH2uGAUxMYRQxc2umI6IIhRMZiUTgrt48l/SOqu5FzXn7rxcv87jKKJDdIQqyEWXqI5uUQM1EUUZekIv6NV6tJ6tN+t93lqw8pl99AvWxzc5opTi</latexit>
( o t +1 ,r t ,a t +1 )
<latexit sha1_base64="l++pOK/5PHUnSx4VIQhcXzjHDIg=">AAAB9HicbVBNS8NAEN3Ur1q/qh69LBZBEEoiol6Eogc9eKhiP6CNZbPdtEs3m7g7KZSQ3+HFgyJe/THe/Ddu2xy09cHA470ZZuZ5keAabPvbyi0sLi2v5FcLa+sbm1vF7Z26DmNFWY2GIlRNj2gmuGQ14CBYM1KMBJ5gDW9wNfYbQ6Y0D+UDjCLmBqQnuc8pASO5150Ejpz0Mbm/TS86xZJdtifA88TJSAllqHaKX+1uSOOASaCCaN1y7AjchCjgVLC00I41iwgdkB5rGSpJwLSbTI5O8YFRutgPlSkJeKL+nkhIoPUo8ExnQKCvZ72x+J/XisE/dxMuoxiYpNNFfiwwhHicAO5yxSiIkSGEKm5uxbRPFKFgciqYEJzZl+dJ/bjsnJbtu5NS5TKLI4/20D46RA46QxV0g6qohih6Qs/oFb1ZQ+vFerc+pq05K5vZRX9gff4ACmuRoA==</latexit>
G
RL
t +1
=
④-Log Likelihood
<latexit sha1_base64="6DxX+LswYcR9w+Hk42WFiUz/Hk4=">AAAB9XicbVDLSgNBEOyNrxhfUY9eBoMQEcKuiHoMevEYwTwgWZfZySQZMvtgplcJa/7DiwdFvPov3vwbJ8keNLGgoajqprvLj6XQaNvfVm5peWV1Lb9e2Njc2t4p7u41dJQoxusskpFq+VRzKUJeR4GSt2LFaeBL3vSH1xO/+cCVFlF4h6OYuwHth6InGEUj3cdl5eGT9lI8ccbHXrFkV+wpyCJxMlKCDDWv+NXpRiwJeIhMUq3bjh2jm1KFgkk+LnQSzWPKhrTP24aGNODaTadXj8mRUbqkFylTIZKp+nsipYHWo8A3nQHFgZ73JuJ/XjvB3qWbijBOkIdstqiXSIIRmURAukJxhnJkCGVKmFsJG1BFGZqgCiYEZ/7lRdI4rTjnFfv2rFS9yuLIwwEcQhkcuIAq3EAN6sBAwTO8wpv1aL1Y79bHrDVnZTP78AfW5w/0PJIn</latexit>
p ( r t | s t +1 )
<latexit sha1_base64="7rpWRey4loWFX9gbMf1FIkL7qNQ=">AAAB9XicbVDLSgNBEOyNrxhfUY9eBoMQD4ZdEfUY9OIxgnlAsi6zk0kyZPbBTK8S1vyHFw+KePVfvPk3TpI9aGJBQ1HVTXeXH0uh0ba/rdzS8srqWn69sLG5tb1T3N1r6ChRjNdZJCPV8qnmUoS8jgIlb8WK08CXvOkPryd+84ErLaLwDkcxdwPaD0VPMIpGuo/LykvxxBk/aQ+PvWLJrthTkEXiZKQEGWpe8avTjVgS8BCZpFq3HTtGN6UKBZN8XOgkmseUDWmftw0NacC1m06vHpMjo3RJL1KmQiRT9fdESgOtR4FvOgOKAz3vTcT/vHaCvUs3FWGcIA/ZbFEvkQQjMomAdIXiDOXIEMqUMLcSNqCKMjRBFUwIzvzLi6RxWnHOK/btWal6lcWRhwM4hDI4cAFVuIEa1IGBgmd4hTfr0Xqx3q2PWWvOymb24Q+szx/1mpIp</latexit>
p ( r t   1 | s t )
State posterior
<latexit sha1_base64="gfOlF2ICVnafBLaQPRfgTw1WZ4Q=">AAAB7XicbVDLSgNBEOyNrxhfUY9eBoMQL2FXRD0GvXiMYB6QhDA7mU3GzO6sM71CWPIPXjwo4tX/8ebfOEn2oIkFDUVVN91dfiyFQdf9dnIrq2vrG/nNwtb2zu5ecf+gYVSiGa8zJZVu+dRwKSJeR4GSt2LNaehL3vRHN1O/+cS1ESq6x3HMuyEdRCIQjKKVGo9l08PTXrHkVtwZyDLxMlKCDLVe8avTVywJeYRMUmPanhtjN6UaBZN8UugkhseUjeiAty2NaMhNN51dOyEnVumTQGlbEZKZ+nsipaEx49C3nSHFoVn0puJ/XjvB4KqbiihOkEdsvihIJEFFpq+TvtCcoRxbQpkW9lbChlRThjaggg3BW3x5mTTOKt5Fxb07L1WvszjycATHUAYPLqEKt1CDOjB4gGd4hTdHOS/Ou/Mxb8052cwh/IHz+QMEQ47D</latexit>
q ( s t )
①KL
Figure 2.Deep Free Energy Network (FENet) calculation process
for RL phase.
when, for given expert data,
FIL = Ft +
∞∑
τ=t+1
γτ−t−1GIL
τ (29)
for collected agent data,
FRL = Ft +
∞∑
τ=t+1
γτ−t−1GRL
τ (30)
Note that the Expected Free Energy at t+ 1to ∞are cal-
culated to account for the long term future and that γ is a
discount factor as in the case of general RL algorithms. The
overall Free Energy calculation process is shown in Figure 1
and Figure 2.
3.3. Network Design for Implementation
Value function As it is impossible to sum over inﬁnity
time steps, we introduce an Expected Free Energy Value
function V(st+1) to estimate the cumulative Expected Free
Energy. Similarly to the case of Temporal Difference learn-
ing of Deep Q Network (Mnih et al., 2013), we use a target
Reinforced Imitation Learning by Free Energy Principle
network Vtarg(st+2) to stabilize the learning process and
deﬁne the loss for learning the value function as follows.
L= ||Gt+1 + γVtarg(st+2) −V(st+1)||2 (31)
To reduce the number of parameters of the networks, we
made a design choice that the agent uses the value function
only for RL, and not for IL. In IL, we use only the value
of the Expected Free Energy Gt+1 at the next time step
t+ 1and ignore the time steps from t+ 2to inﬁnity. Note
that we use a notation that the origin of time step tis set at
the time of the expert data the agent learns from in every
iteration of learning. This means that the time steps from
t+ 1to inﬁnity are all imagined time because the agent has
not observed the time yet. Therefore, IL from Ft + GIL
t+1
without t+ 2to inﬁnity still handles all time series data of
expert demonstrations. It just does not predict more than 1
time step ahead. While IL can be achieved without long term
prediction, RL needs the value function to predict rewards
in the long-term future to avoid a local minimum behavior
and achieve the desired goal.
Recurrent State Space Model We made a design choice
for the network implementation to use Recurrent State Space
Model (Hafner et al., 2019b), a latent dynamics model with
both deterministic and stochastic components. In this model,
the hidden statesstare split into two parts: stochastic hidden
states ut and deterministic hidden states ht. The determin-
istic transition of ht is modeled using Recurrent Neural
Networks (RNN) f as follows.
ht = f(ht−1,ut−1,at−1) (32)
We model the probabilities in Deep Free Energy Networks
as follows.
State prior pθ(ut|ht) (33)
Observation likelihood pθ(ot|ut,ht) (34)
Reward likelihood pθ(rt−1|ut,ht) (35)
State posterior qφ(ut|ht,ot) (36)
Policy prior pθ(at|ut,ht) (37)
Policy posterior qψ(at|ut,ht) (38)
Value network Vω(ut) (39)
Target Value Network Vωtarg(ut) (40)
We model these probabilities as feedforward Neural Net-
works that output the mean and standard deviation of the
random variables according to the Gaussian distribution.
For example, the policy posterior is modeled as a network
that takes ut and ht as inputs and calculates through several
hidden layers and outputs the Gaussian distribution of at.
Note that θ,φ,ψ,ω are a group or set of network parameters
to be learned such as network weights. For example, theta
is a group or set of all parameters consisting the probabilities
of state prior, observation/reward likelihood and policy prior.
Using the network parameters, the objective loss functions
can be written as follows.
FIL = Ft + GIL
t+1 (41)
FRL = Ft + GRL
t+1 + γVωtarg(ut+2) (42)
L= ||GRL
t+1 + γVωtarg(ut+2) −Vω(ut+1)||2 (43)
when
Ft = Eqφ(ut|ht,ot)[−ln pθ(ot|ut,ht) −ln pθ(at|ut,ht)]
+ KL(qφ(ut|ht,ot)||pθ(ut|ht)) (44)
GIL
t+1 = Eq(ut+1)[H[pθ(ot+1|ut+1,ht+1)]
+ KL(qψ(at+1|ut+1,ht+1)||pθ(at+1|ut+1,ht+1))]
(45)
GRL
t+1 = Eq(ot+1)[−KL(qφ(ut+1|ht+1,ot+1)||q(ut+1))
−pθ(rt|ut+1,ht+1)] +Eq(ut+1)[
KL(qψ(at+1|ut+1,ht+1)||pθ(at+1|ut+1,ht+1))]
+ γVωtarg(ut+2) (46)
q(ut+1) =Eqφ(ut|ht,ot)qψ(at|ut,ht)[pθ(ut+1|ht+1)] (47)
q(ot+1) =Eq(ut+1)[pθ(ot+1|ut+1,ht+1)] (48)
Algorithm 1 shows overall calculations using these losses.
The agent minimizes FIL for expert data DE and the agent
minimizes FRL for agent data DA that the agent collects on
its own.
4. Experiments
We evaluate FENet on three continuous control tasks from
images. We compare our model with model-based RL and
model-based RL with demonstrations in dense and sparse
reward setting when optimal expert is available. Then we
compare our model with IL methods when only suboptimal
experts are available. Finally, we investigate the merits of
combining IL and RL as an ablation study.
(a) Cheetah-run
 (b) Walker-walk
 (c) Quadruped-walk
Figure 3.Image-based control tasks used in our experiments.
Control tasks We used Cheetah-run, Walker-walk, and
Quadruped-walk tasks, image-based continuous control
tasks of DeepMind Control Suite (Tassa et al., 2018) shown
in Figure 3. The agent gets rewards ranging from 0 to 1.
Quadruped-walk is the most difﬁcult as it has more action
Reinforced Imitation Learning by Free Energy Principle
dimensions than the others. Walker-walk is more challeng-
ing than Cheehtah-run because an agent ﬁrst has to stand up
and then walk, meaning that the agent easily falls down on
the ground, which is difﬁcult to predict. The episode length
is 1000 steps starting from randomized initial states. We use
action repeat R = 4for the Cheetah-run task, and R = 2
for the Walker-walk task and the Quadruped-walk task.
4.1. Performance in standard visual control tasks
We compare the performance of FENet to PlaNet (Hafner
et al., 2019b) and ”PlaNet with demonstrations” in standard
visual control tasks mentioned above. We use PlaNet as
a baseline method because PlaNet is one of the most ba-
sic model-based RL methods using Recurrent State Space
Model, on top of which we build our model. As FENet
uses expert data, we create ”PlaNet with demonstrations”
for fair comparison. This variant of PlaNet has an additional
experience replay pre-populated with expert trajectories and
minimize a loss calculated from the expert data in addition
to PlaNet’s original loss. Figure 4 shows that ”PlaNet with
demonstrations” is always better than PlaNet and that FENet
is ranked higher as the difﬁculty of tasks gets higher. In
Cheetah-run, FENet gives competitive performance with
PlaNet. In Walker-walk, FENet and ”PlaNet with demon-
strations” are almost competitive, both of which are substan-
tially better than PlaNet thanks to expert knowledge being
leveraged to increase sample efﬁciency. In Quadruped-walk,
FENet is slightly better than the other two baselines.
4.2. Performance in sparse-reward visual control tasks
In real-world robot learning, it is demanding to craft a dense
reward function to lead robots to desired behaviors. It would
be helpful if an agent could acquire desired behaviors sim-
ply by giving sparse signals. We compare the performance
of FENet to PlaNet and ”PlaNet with demonstrations” in
sparse-reward settings, where agents do not get rewards less
than 0.5 per time step (Note that in the original implemen-
tation of Cheetah-run, Walker-walk and Quadruped-walk,
agents get rewards ranging from 0 to 1 per time step). Fig-
ure 5 shows that FENet outperforms PlaNet and ”PlaNet
with demonstrations” in all three tasks. In Cheetah-run,
PlaNet and ”PlaNet with demonstrations” are not able to get
even a single reward.
4.3. Performance with suboptimal experts
In real-world robot learning, expert trajectories are often
given by human experts. It is natural to assume that ex-
pert trajectories are suboptimal and that there remains much
room for improvement. We compare the performance of
FENet to Behavioral Cloning IL methods. We use two
types of networks for behavioral cloning methods: recurrent
policy and recurrent decoder policy. The recurrent policy
πR(at|ot) is neural networks with one gated recurrent unit
cell and three dense layers. The recurrent decoder policy
πR(at,ot+1|ot) is neural networks with one gated recurrent
unit cell and four dense layers and deconvolution layers
as in the decoder of PlaNet. Both networks does not get
raw pixel observations but take observations encoded by the
same convolutional encoder as PlaNet’s. Figure 7 shows
that while IL methods overﬁt to the expert and cannot sur-
pass the suboptimal expert performance, FENet is able to
substantially surpass the suboptimal expert’s performance.
Algorithm 1Deep Free Energy Network (FENet)
Input:
Seed episodes S Collect interval C
Batch size B Chunk length L
Expert episodes N Target smoothing rate ρ
Learning rate α
State prior pθ(ut|ht) State posterior qφ(ut|ht,ot)
Policy prior pθ(at|ut,ht) Policy posterior qψ(at|ut,ht)
Likelihood pθ(ot|ut,ht), pθ(rt−1|ut,ht)
Value functionVω(ut) Target value functionVωtarg(ut)
Initialize expert dataset DE with N expert trajectories
Initialize agent dataset DA with Srandom episodes
Initialize neural network parameters θ,φ,ψ,ω randomly
while not converged do
for update step c= 1..Cdo
// Imitation Learning (IL)
Draw expert data {(ot,at,ot+1)k+L
t=k }B
i=1 ∼DE
Compute Free Energy FIL from equation 41
// Reinforcement Learning (RL)
Draw agent data {(ot,at,rt,ot+1)k+L
t=k }B
i=1 ∼DA
Compute Free Energy FRL from equation 42
Compute V function’s LossLfrom equation 43
// Update parameters
θ←θ−α∇θ(FIL + FRL)
φ←φ−α∇φ(FIL + FRL)
ψ←ψ−α∇ψ(FIL + FRL)
ω←ω−α∇ωL
ωtarg ←ρωtarg + (1−ρ)ω
end for
// Environment interaction
o1 ←env.reset()
for time step t= 1..T do
Infer hidden states ut ←qφ(ut|ht,ot)
Calculate actions at ←qψ(at|ut,ht)
Add exploration noise to actions
rt,ot+1 ←env.step (at)
end for
DA ←DA ∪{(ot,at,rt,ot+1)T
t=1}
end while
Reinforced Imitation Learning by Free Energy Principle
0 200 400 600 800 1000
0
200
400
600
800
Iteration
Return
0 200 400 600 800 1000
0
200
400
600
800
1000
Iteration
Return
0 200 400 600 800 1000
0
200
400
600
800
Iteration
Return
(a)cheetah-run (b) walker-walk (c) quadruped-walk
Expert
PlaNet w/demo
PlaNet
FENet(ours)
Figure 4.Comparison of FENet to PlaNet and ”PlaNet with demonstrations”. Plots show test performance over learning iterations. The
lines show means and the areas show standard deviations over 10 trajectories.
(a)cheetah-run (b) walker-walk (c) quadruped-walk
0 200 400 600 800 1000
−100
0
100
200
300
400
500
600
700
Iteration
Return
0 200 400 600 800 1000
0
200
400
600
800
1000
Iteration
Return
0 200 400 600 800 1000
0
100
200
300
400
Iteration
Return
PlaNet w/demo
PlaNet
FENet(ours)
Figure 5.Comparison of FENet to PlaNet and ”PlaNet with demonstrations” in sparse-reward settings, where agents do not get rewards
less than 0.5. Plots show test performance over learning iterations. FENet substantially outperforms PlaNet. The lines show means and
the areas show standard deviations over 10 trajectories.
4.4. Ablation Study
Figure 6 compares FENet with other types of agents partially
using FENet’s loss in Cheetah-run and Walker-walk (abla-
tion study). ’Imitation RL’ is the proposed FENet agent that
does IL and RL at the same time, minimizing FIL + FRL.
’Imitation-pretrained RL’ is an agent that ﬁrst learns the
model only with imitation (minimizing FIL) and then does
RL using the pre-trained model (minimizing FRL). ’RL
only’ is an agent that does RL only, minimizingFRL. ’Imi-
tation only’ is an agent that does IL only, minimizingFIL.
While ’Imitation only’ gives the best performance and ’Imi-
tation RL’ gives the second best in Cheetah-run, ’Imitation
RL’ gives the best performance and ’Imitation only’ gives
the worst performance in Walker-walk. We could say ’Imi-
tation RL’ is the most robust to the properties of tasks.
5. Related Work
Active Inference Friston, who ﬁrst proposed Active In-
ference, has evaluated the performance in simple control
tasks and a low-dimensional maze (Friston et al., 2012;
2015). Ueltzhoffer implemented Active Inference with Deep
Neural Networks and evaluated the performance in a sim-
ple control task (Ueltzh ¨offer, 2018). Millidge proposed a
Deep Active Inference framework with value functions to
estimate the correct Free Energy and succeeded in solving
Gym environments (Millidge, 2019). Our approach extends
Deep Active Inference to combine IL and RL, solving more
challenging tasks.
RL from demonstration Reinforced Imitation Learning
succeeds in reducing sample complexity by using imitation
as pre-training before RL (Pfeiffer et al., 2018). Adding
demonstrations into a replay buffer of off policy RL meth-
ods also demonstrates high sample efﬁciency (Vecerik et al.,
2017; Nair et al., 2018; Paine et al., 2019). Demo Aug-
mented Policy Gradient mixes the policy gradient with
a behavioral cloning gradient (Rajeswaran* et al., 2018).
Deep Q-learning from Demonstrations (DQfD) not only use
demonstrations for pre-training but also calculates gradients
from demonstrations and environment interaction data (Hes-
ter et al., 2018). Truncated HORizon Policy Search uses
demonstrations to shape rewards so that subsequent plan-
Reinforced Imitation Learning by Free Energy Principle
(a)cheetah-run (b) walker-walk
0 200 400 600 800 1000
0
200
400
600
800
Iteration
Return
0 200 400 600 800 1000
0
200
400
600
800
1000
Iteration
Return
Expert
Imitation RL
Imitation pretrained RL
RLOnly
ImitationOnly
Figure 6.Comparison of FENet (imitation RL) to partial FENet (as ablation studies: Imitation-pretrained RL, RL only, and Imitation only).
Plots show test performance over learning iterations. The lines show means and the areas show standard deviations over 10 trajectories.
0 200 400 600 800 1000
0
100
200
300
400
500
Iteration
Return
Expert
BC(recurrent decoder)
BC(recurrent policy)
FENet(ours)
Figure 7.Comparison of FENet to IL methods when only sub-
optimal experts are available in Cheetah-run. Plots show test
performance over learning iterations. Behavioral Cloning IL meth-
ods cannot surpass the suboptimal expert’s return which FENet
successfully surpasses. The lines show means and the areas show
standard deviations over 10 trajectories.
ning can achieve superior performance to RL even when
experts are suboptimal (Sun et al., 2018a). Soft Q Imitation
Learning gives rewards that encourage the agent to return
to demonstrated states in order to avoid policy collapse
(Reddy et al., 2019). Our approach is similar to DQfD in
terms of mixing gradients calculated from demonstrations
and from environment interaction data. One key difference
is that FENet concurrently learns the generative model of
the world so that it can be robust to wider environment
properties.
Control with latent dynamics modelWorld Models ac-
quire latent spaces and dynamics over the spaces separately,
and evolve simple linear controllers to solve visual control
tasks (Ha & Schmidhuber, 2018). PlaNet learns Recurrent
State Space Model and does planning with Model Predic-
tive Control at test phase (Hafner et al., 2019b). Dreamer,
which is recently built upon PlaNet, has a policy for latent
imagination and achieved higher performance than PlaNet
(Hafner et al., 2019a). Our approach also uses Recurrent
State Space Model to describe variational inference, and we
are the ﬁrst to unify IL and RL over latent dynamics models
to the best of our knowledge.
6. Conclusion
We present FENet, an agent that uniﬁes Imitation Learning
(IL) and Reinforcement Learning (RL) using Free Energy
objectives. For this, we theoretically extend the Free Energy
Principle and introduce a policy prior that encodes experts’
behaviors and a policy posterior that learns to maximize
expected rewards without deviating too much from the pol-
icy prior. FENet outperforms model-based RL and RL with
demonstrations especially in visual control tasks with sparse
rewards and FENet also outperforms suboptimal experts’
performance unlike Behavioral cloning. Strong potentials in
sparse environment with suboptimal experts are important
factors for real-world robot learning.
Directions for future work include learning the balance be-
tween IL and RL, i.e. Free Energy and Expected Free En-
ergy so that the agent can select the best approach to solve
its confronting tasks by monitoring the value of Free Energy.
It is also important to evaluate FENet in real-world robotic
tasks to fully manifest its effectiveness and reveal demands
for further improvements.
References
Friston, K. The free-energy principle: a uniﬁed brain theory?
Nature reviews neuroscience, 11(2):127–138, 2010.
Friston, K., Kilner, J., and Harrison, L. A free energy
principle for the brain. Journal of Physiology-Paris, 100
(1-3):70–87, 2006.
Friston, K., Samothrakis, S., and Montague, R. Active infer-
Reinforced Imitation Learning by Free Energy Principle
ence and agency: optimal control without cost functions.
Biological cybernetics, 106(8-9):523–541, 2012.
Friston, K., Rigoli, F., Ognibene, D., Mathys, C., Fitzgerald,
T., and Pezzulo, G. Active inference and epistemic value.
Cognitive neuroscience, 6(4):187–214, 2015.
Ha, D. and Schmidhuber, J. World models. arXiv preprint
arXiv:1803.10122, 2018.
Haarnoja, T., Zhou, A., Abbeel, P., and Levine, S. Soft
actor-critic: Off-policy maximum entropy deep reinforce-
ment learning with a stochastic actor. In International
conference on machine learning, pp. 1861–1870. PMLR,
2018.
Hafner, D., Lillicrap, T., Ba, J., and Norouzi, M. Dream to
control: Learning behaviors by latent imagination. arXiv
preprint arXiv:1912.01603, 2019a.
Hafner, D., Lillicrap, T., Fischer, I., Villegas, R., Ha, D., Lee,
H., and Davidson, J. Learning latent dynamics for plan-
ning from pixels. In Chaudhuri, K. and Salakhutdinov, R.
(eds.), Proceedings of the 36th International Conference
on Machine Learning, volume 97, pp. 2555–2565, Long
Beach, California, USA, 2019b. PMLR.
Hester, T., Vecerik, M., Pietquin, O., Lanctot, M., Schaul,
T., Piot, B., Horgan, D., Quan, J., Sendonaris, A., Osband,
I., et al. Deep q-learning from demonstrations. In Thirty-
Second AAAI Conference on Artiﬁcial Intelligence, 2018.
Kapturowski, S., Ostrovski, G., Dabney, W., Quan, J., and
Munos, R. Recurrent experience replay in distributed
reinforcement learning. In International Conference on
Learning Representations, 2019.
Kingma, D. P. and Ba, J. Adam: A method for stochastic
optimization. arXiv preprint arXiv:1412.6980, 2014.
Levine, S. Reinforcement learning and control as proba-
bilistic inference: Tutorial and review. arXiv preprint
arXiv:1805.00909, 2018.
Millidge, B. Deep active inference as variational policy
gradients. arXiv preprint arXiv:1907.03876, 2019.
Mnih, V ., Kavukcuoglu, K., Silver, D., Graves, A.,
Antonoglou, I., Wierstra, D., and Riedmiller, M. Playing
atari with deep reinforcement learning. arXiv preprint
arXiv:1312.5602, 2013.
Nair, A., McGrew, B., Andrychowicz, M., Zaremba, W.,
and Abbeel, P. Overcoming exploration in reinforcement
learning with demonstrations. In 2018 IEEE Interna-
tional Conference on Robotics and Automation (ICRA),
pp. 6292–6299. IEEE, 2018.
Nair, V . and Hinton, G. E. Rectiﬁed linear units improve
restricted boltzmann machines. InProceedings of the 27th
international conference on machine learning (ICML-10),
pp. 807–814, 2010.
Paine, T. L., Gulcehre, C., Shahriari, B., Denil, M., Hoffman,
M., Soyer, H., Tanburn, R., Kapturowski, S., Rabinowitz,
N., Williams, D., et al. Making efﬁcient use of demonstra-
tions to solve hard exploration problems. arXiv preprint
arXiv:1909.01387, 2019.
Paszke, A., Gross, S., Chintala, S., Chanan, G., Yang, E.,
DeVito, Z., Lin, Z., Desmaison, A., Antiga, L., and Lerer,
A. Automatic differentiation in pytorch. 2017.
Pfeiffer, M., Shukla, S., Turchetta, M., Cadena, C., Krause,
A., Siegwart, R., and Nieto, J. Reinforced imitation:
Sample efﬁcient deep reinforcement learning for mapless
navigation by leveraging prior demonstrations. IEEE
Robotics and Automation Letters, 3(4):4423–4430, 2018.
Pomerleau, D. A. Efﬁcient training of artiﬁcial neural net-
works for autonomous navigation. Neural computation,
3(1):88–97, 1991.
Rajeswaran*, A., Kumar*, V ., Gupta, A., Vezzani, G., Schul-
man, J., Todorov, E., and Levine, S. Learning Complex
Dexterous Manipulation with Deep Reinforcement Learn-
ing and Demonstrations. In Proceedings of Robotics:
Science and Systems (RSS), 2018.
Reddy, S., Dragan, A. D., and Levine, S. Sqil: imita-
tion learning via regularized behavioral cloning. arXiv
preprint arXiv:1905.11108, 2019.
Rhinehart, N., McAllister, R., and Levine, S. Deep imitative
models for ﬂexible inference, planning, and control.arXiv
preprint arXiv:1810.06544, 2018.
Silver, D., Huang, A., Maddison, C. J., Guez, A., Sifre, L.,
Van Den Driessche, G., Schrittwieser, J., Antonoglou, I.,
Panneershelvam, V ., Lanctot, M., et al. Mastering the
game of go with deep neural networks and tree search.
nature, 529(7587):484–489, 2016.
Sun, W., Bagnell, J. A., and Boots, B. Truncated horizon
policy search: Combining reinforcement learning & imi-
tation learning. In International Conference on Learning
Representations, 2018a.
Sun, W., Gordon, G. J., Boots, B., and Bagnell, J. Dual
policy iteration. In Advances in Neural Information Pro-
cessing Systems, pp. 7059–7069, 2018b.
Sutton, R. S., Barto, A. G., et al. Introduction to reinforce-
ment learning, volume 135. MIT press Cambridge, 1998.
Reinforced Imitation Learning by Free Energy Principle
Tassa, Y ., Doron, Y ., Muldal, A., Erez, T., Li, Y ., Casas, D.
d. L., Budden, D., Abdolmaleki, A., Merel, J., Lefrancq,
A., et al. Deepmind control suite. arXiv preprint
arXiv:1801.00690, 2018.
Ueltzh¨offer, K. Deep active inference. Biological cybernet-
ics, 112(6):547–573, 2018.
Vecerik, M., Hester, T., Scholz, J., Wang, F., Pietquin, O.,
Piot, B., Heess, N., Roth¨orl, T., Lampe, T., and Riedmiller,
M. Leveraging demonstrations for deep reinforcement
learning on robotics problems with sparse rewards. arXiv
preprint arXiv:1707.08817, 2017.
Verma, A., Le, H., Yue, Y ., and Chaudhuri, S. Imitation-
projected programmatic reinforcement learning. In Ad-
vances in Neural Information Processing Systems , pp.
15726–15737, 2019.
A. Implementation
To stabilize the learning process, we adopt burn-in, a tech-
nique to recover initial states of RNN’s hidden variablesht
(Kapturowski et al., 2019). As shown in Algorithm 1, the
agent calculates the Free Energy with mini batches sampled
from the expert or agent dataset D, which means that ht is
initialized randomly in every mini batch calculation. Since
the Free Energy heavily depends on the value of ht, it is
crucial to estimate the accurate hidden states every iteration.
We set a burn-in period when a portion of the mini batch
data sequence is used for unrolling the networks to produce
initial states of ht. After the burn-in period, we update the
networks using the remaining part of the data sequence.
We use PyTorch (Paszke et al., 2017) to write neural net-
works and run experiments using NVIDIA GeForce GTX
1080 Ti / RTX 2080 Ti / Tesla V100 GPU (1 GPU per ex-
periment). The training time for our FENet implementation
is about 24 hours on the DeepMind Control Suite environ-
ment. As for the hyper parameters, we use the convolutional
encoder and decoder networks from (Ha & Schmidhuber,
2018) and Recurrent State Space Model from (Hafner et al.,
2019b) and implement all other functions as three dense
layers of size 200 with ReLU activations (Nair & Hinton,
2010). We made a design choice to make the policy prior,
the policy posterior, the observation likelihood, and the re-
ward likelihood deterministic functions while we make the
state prior and the state posterior stochastic functions. We
use the batch size B = 25for ’Imitation RL’ with FENet,
and B = 50 for other types and baseline methods. We
use the chunk length L = 50, the burn-in period 20. We
use seed episodes S = 40, expert episodes N = 10000
trained with PlaNet (Hafner et al., 2019b), collect interval
C = 100and action exploration noise Normal(0, 0.3). We
use the discount factor γ = 0.99 and the target smoothing
rate ρ = 0.01. We use Adam (Kingma & Ba, 2014) with
learning rates α = 10−3 and scale down gradient norms
that exceed 1000. We scale the reward-related loss by 100,
the policy-prior-related loss by 10. We clip KL loss between
the hidden states below 3 free nats and clip KL loss between
the policies below 0.6.
B. Expert data collection process
We ﬁrst trained PlaNet for Cheetah-run and Walker-walk.
We used Soft Actor-Critic (SAC) (Haarnoja et al., 2018) for
Quadruped-walk because PlaNet cannot solve Quadruped-
walk very much as shown in Figure 4. Then we saved the
model parameters when PlaNet or SAC achieved asymptotic
performance for each task. After this, we generated 10,000
expert trajectories for each task using the saved model pa-
rameters. The suboptimal expert dataset is what we col-
lected by using the model parameters of fewer learning
iterations before reaching to asymptotic performance. For
example as shown in Figure 7, the suboptimal expert in
Cheetah-run is PlaNet agent that was trained halfway to
reach the return of 200.