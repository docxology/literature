Particular ﬂows and attracting sets
A comment on "How particular is the physics of the
Free Energy Principle?" by Aguilera, Millidge, Tschantz
and Buckley
Conor Heins∗1-4
1Department of Collective Behaviour, Max Planck Institute
of Animal Behavior, 78464 Konstanz, Germany
2Department of Biology, University of Konstanz, 78464 Konstanz, Germany
3Centre for the Advanced Study of Collective Behaviour,
University of Konstanz, 78464 Konstanz, Germany
4VERSES Research Labs, Los Angeles, California, USA
May 20, 2022
Abstract
In this commentary, I expand on the analysis of the recent article "How particular
is the physics of the Free Energy Principle?" by Aguilera et al. by studying the ﬂow
ﬁelds of linear diﬀusions, and particularly the rotation of their attracting sets in the
presence of diﬀerent types of solenoidal coupling. This analysis sheds new light on
previous claims made in the FEP literature (and contested in the target article) that
the internal dynamics of stochastic systems can be cast performing a gradient ﬂow on
variational free energy, and thus endowed with an inferential interpretation, i.e., as if
internal states are performing inference about states external to the system. I express
general agreement with the target article’s statement that the marginal ﬂow of internal
states does not point along variational free energy gradients evaluated at the most likely
internal state (i.e., the conditional mode). However, in this commentary I focus on the
ﬂow of particular states (internal and blanket states) and their variational free energy
gradients, and show that for a wide but restricted class of solenoidal couplings, the
average ﬂow of these systems do indeed point along variational free energy gradients.
This licenses a diﬀerent but perhaps stronger re-description of the ﬂow of particular
states as performing inference, which importantly holds at arbitrary points in state
space, not just at the conditional modes.
∗cheins@ab.mpg.de
1
arXiv:2205.09595v1  [q-bio.NC]  19 May 2022
1 Introduction
The target article, "How particular is the physics of the Free Energy Principle" [1], investi-
gates the Free Energy Principle (hereafter: FEP) in the context of linear diﬀusion processes,
i.e., Ornstein-Uhlenbeck processes [2, 3]. Using this class of systems as a testbed for the
FEP’s claims, the authors carefully deconstruct various assumptions and their consequences,
which they claim are made (implicitly or explicitly) in the existing FEP literature, specif-
ically in works such as [4–6]. In this commentary, I oﬀer an additional perspective on the
claims of the target article regarding the marginal ﬂows of the conditional modes [1, Sec-
tion 3.2], which aﬀord the inferential interpretation of the FEP described in [4, 5]. Here I
study system-level ﬂows by focusing on the average ﬂow of so-called ‘particular states’, and
speciﬁcally analyze the conditions under which they license an inferential interpretation of
the FEP, particularly the case when particular states can be described as ﬂowing along the
gradients of the variatonal free energy.
Considerasystemwhosestate xiscomposedofinternal µ, blanketb, andexternalηstates
x= (η,b,µ ) and whose evolution is described by an Itô stochastic diﬀerential equation


˙η
˙b
˙µ

 =


fη(x)
fb(x)
fµ(x)

 +


ωη
ωb
ωµ

, (1)
where ωη,ωb,ωµ are independent Wiener processes. Let us assume the existence of a steady-
state distributionp such thatb is a Markov blanket between external and internal states
η⊥µ|b ⇐⇒p(µ,η|b) =p(µ|b)p(η|b).
Henceforth, the conditional modes refer to the most likely internal (respectively external)
states, conditioned on blanket states, assuming they exist [7]
µ(b) ≜ arg maxp(µ|b), η(b) ≜ arg maxp(η|b). (2)
The marginal ﬂow of the system given a blanket state refers to the ﬂow averaged over
external and internal states given blanket states [1, Equation 15]
˙µ(b) ≜ Ep(η,µ|b)[fµ(µ,b,η )], ˙η(b) ≜ Ep(η,µ|b)[fη(µ,b,η )]. (3)
The authors analyze the marginal ﬂows of linear systems and contest what they claim is
a central tenet of the FEP: namely, that the marginal ﬂows of internal states˙µpoint down
the gradients of the free energyF [1, Equation 22],
˙µ(b) ∝−∇µ(b)F(µ(b),b), (4)
where the variational free energyF allows one to relate the dynamics of random systems
with approximate Bayesian inference in [4, 5].
Here I will expand on the target article’s discussion about the relationship between vari-
ational free energy gradients and the marginal ﬂow of internal states˙µ(b) in linear systems,
2
oﬀering a slightly diﬀerent perspective in terms of particular states. Speciﬁcally, I use the
ﬂows of particular states fµ,b(µ,b,η ) to demonstrate the space of ﬂows that operate on
particular states — including, importantly, the ﬂow at the conditional mode µ(b). This
analysis reveals a complex relationship between solenoidal ﬂow, the particular ﬂows and
the variational free energy gradients. This analysis also ﬁnds agreement with target arti-
cle’s overarching result that the dynamics of the conditional modes are not representative of
system-wide behaviour1.
However, these results also supplement the discussion about marginal ﬂows, and suggest
that the relationship between solenoidal ﬂows and the gradient ﬂows of internal states is
more nuanced than either the target article or previous FEP literature suggests. I show
that the ﬂow ofparticular states fµ,b(µ,b,η ) under diﬀerent external conditions is always
pulled to a linear attracting set, but importantly, this attracting set is only aligned with
the line of conditional modesµ(b) in special cases. These cases depend on the nature of
solenoidal couplings. Thus, the ﬂow of internal states (and thus the marginal ﬂow) does not
generally point along variational free energy gradients, consistent with the demonstrations of
the target article [1]. I thus express general agreement with the target article in questioning
the generality of statements made in earlier FEP literature (e.g., [4, Equation 8.26] and [5,
Equation 3.3]).
However, the conditions under which internal states ﬂow along free energy gradients
are also not as restrictive as the target article suggests. Indeed, I show in the context of
simple linear diﬀusions with a Markov blanket between internal and external states that
the presence of solenoidal couplings do notalways misalign the attracting sets of particular
states with the line of the conditional modeµ(b). This implies that the ﬂow of the particular
states (which crucially includes the internal states and their conditional mode) can still point
along variational free energy gradients even in the presence of solenoidal coupling. Indeed,
our results suggest that the attracting set of particular states is identical to the line of
the conditional modes for a large class of solenoidal couplings. For instance, I show that
solenoidal coupling between external and blanket states rotates the linear attracting set of
particular states relative to the line of the conditional modes, but in doing so also contracts
the eﬀective volume of state space that particular states visit. This solenoidal coupling
helps particular states accelerate their ﬂow towards (and maintain their proximity to) the
free energy minimum. This is in line with investigations into the importance of solenoidal
coupling in augmenting the speed of convergence of diﬀusions to their steady-state [8–11],
and hints at the importance of the ‘canonical’ or ‘normal’ form of the ﬂow introduced in
previous FEP literature [4, 6, 12, 13].
2 Solenoidal rotation of attracting sets
Recallthe3-dimensionallineardiﬀusiondescribedinEquation(1), whosestate xiscomposed
of internal µ, blanket b, and externalη states, i.e., x = (η,b,µ ). The system’s stochastic
1However, note that this does not conﬂict with the central claims of the FEP.
3
evolution is described using the following (Itô) stochastic diﬀerential equation


˙µ
˙b
˙η

 =


Jµµ Jµb Jµη
Jbµ Jbb Jbη
Jηµ Jηb Jηη




µ
b
η


  
=f(x)
+


ωη
ωb
ωµ

, (5)
where J is the Jacobian of the ﬂowf in Equation (1). Assuming that the spectrum of
the Jacobian has negative real parts, we have the existence of a Gaussian (non-equilibrium)
steady-state p(x) =N(x; 0,Π−1) with precision matrixΠ [3]. Thus, the ﬂow can be rewrit-
ten via the Helmholtz decomposition [7, Appendix B] as
Jx= −(Γ + Q)∇xln p(x), (6)
into a dissipative, curl-free componentΓ∇xln p(x) and a conservative, divergence-free com-
ponent Q∇xln p(x), where each component depends on the gradients of the stationary den-
sity p(x). The diﬀusion tensor Γ is a positive-deﬁnite matrix that determines the ampli-
tude and covariance of random ﬂuctuationsΓ ≜ E[ωω⊤]/2. The skew-symmetric matrix
Q= −Q⊤ mediates conservative, rotational dynamics in the system’s ﬂow.
I begin by analyzing linear systems that allow for non-zero solenoidal coupling between
internal and blanket states, and between blanket states and external states. As in the earlier
FEP literature [4–6, 12–14], and consistent with one of the ‘canonical ﬂow constraints’ also
entertained in the target article and mentioned in a FEP literature [4, p. 12.11], I assume
there is no solenoidal coupling between internal and external statesQηµ = −Q⊤
µη = 0. Given
these constraints, one can parameterize the solenoidal matrixQas follows
Q(γ,λ) =


0 γ 0
−γ 0 −λ
0 λ 0

 =


0 Qηb 0
−Qηb 0 Qbµ
0 −Qbµ 0

. (7)
Under this simple parameterisation, γ determines the strength of solenoidal coupling
betweenband η, andλthe strength of solenoidal coupling betweenband µ. For all numerical
demonstrations, I ﬁx the inverse of the stationary covariance—also known as the precision
matrix Π—and the diﬀusion tensor Γ to the following values
Σ−1 ≜ Π =


2 1 0
1 2 1
0 1 2

, Γ =


2 0 0
0 2 0
0 0 2

. (8)
Note thatΠµη = Πηµ = 0is equivalent to the existence of a Markov blanket between internal
and external states [7, Equation 2.2] (note that this holds independently of solenoidal ﬂow).
In the case of Gaussian distributions, the product of the precision matrix with the state
of the systemxis a vector whose entries contain the gradients of the log probability density
4
Πx= ∇xln p(x). This aﬀords a simpler expression for the ﬂowf(x)
f(x) =Jx=


−2 −γ 0
γ −2 λ
0 −λ −2


  
=−(Γ+Q)


2 1 0
1 2 1
0 1 2




µ
b
η


  
=∇x ln p(x)
(9)
Note that this construction means that although there is a Markov blanket between
internal and external states (because ofΠµη = Πηµ = 0), in the presence of any solenoidal
coupling(either γorλisnon-zero), thentherewillbeatleastunidirectionalcouplingbetween
internal and external states (Jηµ ̸= 0 or Jµη ̸= 0, or both). Note that according to recent
work [12, 13], ‘sparse coupling’ entails either absentor unidirectional coupling, so a system
where Jηµ = 0,Jηµ ̸= 0still technically satisﬁes sparse coupling.
In Figure 1 I explore howγ and λ determine the attracting set of the particular ﬂow,
deﬁned as
{(µ,b) s.t. fµ,b(x) = 0for some external stateη}.
In the top row of Figure 1, one can see that particular states are attracted to a line that is
misaligned with the line{(b,µ(b))}—the set at which the free energy is minimised [7]. In
particular, the angle between the attracting set of particular states and the line{(b,µ(b))}
grows with increasingγ. When γ = 0, both are aligned and the ﬂows ofµ,b are attracted
towards {(b,µ(b))}. However, as soon asγ ̸= 0, the particular states are pulled towards an
attracting set that is misaligned with{(b,µ(b))}and thus does not point along variational
free energy gradients, i.e.,
fµ(µ,b,η ) ̸∝−∇µ(b)F(µ(b),b)
̸∝−∇µF(µ,b). (10)
Note that in this expression I include both the gradients of the free energy evaluated at
the conditional modeF(µ(b),b) as well as that deﬁned over the space of particular states
F(µ,b). Although statements concerning the gradients of the second quantityF(µ,b) are not
central to the claims of the target article or the previous FEP literature, I include it as an
interesting case to examine, because as we will see below, there indeed are parameterizations
of systems where such gradientsdo align with the ﬂow of particular states. I also remark that
the gradients of the variational free energy evaluated at the conditional mode, with respect
to the conditional mode∇µF(µ,b) are trivially0, so that quantity isn’t of particular interest
when we are trying to compare it to the marginal ﬂows of internal states. Assuming any
non-zero marginal ﬂows in diﬀerent parts of state-space, then the equality of these marginal
ﬂows with the variational free energy gradients (evaluated at the conditional mode, and with
respect to the conditional mode) will trivially not hold. This is why expanding our analysis to
the free energy gradients of the particular states, with respect to arbitrary internal states (not
just the most likely ones)∇µF(µ,b) is both a stronger and more interesting interpretation,
because those gradients can be non-zero.
5
Figure 1:Relationship between solenoidal coupling and the rotation of attracting sets.Top row:Solenoidal
coupling between external and blanket statesγ = Qηb = −Q⊤
bη rotates the attracting set of particular states
away from the line of the conditional modeµ(b). The left panel shows the attracting set of the particular
ﬂow fµ,b(x), computed by evaluating the ﬂow ofµ,b over a ﬁxed range of external statesη ∈[−15,+15],
for increasing values of solenoidal coupling strengthγ, withλ= −Qbµ ﬁxed to1.0. The attracting sets are
plotted on top of the variational free energy of particular statesF(µ,b). The free energy attains its minimum
along the line(b,µ(b)), meaning the ﬂow of the internal states points towards the conditional mode (and
hence down free energy gradients) whenγ = 0. The right panel shows the angle (in radians) between the
attracting set offµ,b(µ,b,η ) and the line ofµ(b) for increasing solenoidal coupling strengthγ. The attracting
setoftheparticularstatesisdeﬁnedas thesolutionsetof µ,b atwhichtheﬂowofparticularstates fµ,b(µ,b,η )
vanishes. Bottom row: identical analysis as the top row but with varying the solenoidal coupling between
internal and blanket statesλ= −Qbµ = Qµb. Here, solenoidal coupling between external and blanket states
γ = Qηb was ﬁxed to0.0. The attracting set of particular states does not change as a function ofλ, but
they are shown vertically oﬀset from one another for visibility. The alignment between the attracting set
and the line of the conditional mode persists despite changes in solenoidal coupling, demonstrating how such
dynamics do not preclude an inferential interpretation of such systems.
Alignment of the ﬂow of internal states (including that of the conditional modeµ(b))
with the line{(b,µ(b))}does not require an absence of solenoidal coupling. In the current
example, all that is required for alignment is the absence of certain solenoidal couplings, in
6
particular that between external and blanket statesQηb = 0. In general, arbitrary solenoidal
coupling between internal and blanket states will not ‘misalign’ the attracting set with the
line {(b,µ(b))}, provided there is no solenoidal coupling between external and blanket states.
That means that in such systems, internal and blanket statesdo ﬂow along the gradients of
the variational free energyF(µ,b), towards their attracting set which lies along(b,µ(b)).
It is clear from the top row of Figure 1 thatγ rotates the attracting set of particular
states. Interestingly, this rotation goes hand-in-hand with a simultaneous contraction of the
attracting set’s eﬀective volume, which is evident from inspecting the change in length of
the colored lines in Figure 1, which span the attracting points offµ,b(x) evaluated over the
same range of external states. The bottom row of Figure 1 shows the same attracting sets
while varying the solenoidal coupling between blanket and internal states. In this case, the
attracting set of particular states remains aligned with the line of conditional modes, and
the volume of this attracting set does not change. This alignment persists for all strengths of
the coupling parameterλ between internal and blanket states, provided solenoidal coupling
between external and blanket states is constrained to be absent (i.e.γ = 0).
These simple demonstrations show how solenoidal coupling relates to the alignment of
ﬂow ﬁelds with the variational free energy gradients and the line of the conditional modes
(the point at which the variational free energy gradients vanish). For instance, our results call
into question the claim of the target article that only systems with block diagonal solenoidal
coupling sustain marginal ﬂows of internal states that minimize free energy. Indeed, in the
linear diﬀusions I examined here, the only constraint that is needed for the attracting sets to
align and hence for internal states to minimize free energy is an absence of solenoidal coupling
between external and blanket states (γ = 0). In the other cases whereλ is unconstrained,
the particular ﬂows ﬁnd their conditional minima along the line of the conditional modes for
diﬀerent settings ofη, and hence point along variational free energy gradients.
I suspect (and this is intimated in more recent FEP literature such as [12, 13]) that
this result generalises to the setting of particular partitions, where the state space is fur-
ther partitioned into autonomous states (internal and active) and non-autonomous states
(external and sensory). In general, I speculate that such alignment would persist in systems
where solenoidal coupling is absent between autonomous and non-autonomous states, but
unconstrained within either subset.
Additional information
Acknowledgements
I would like to express many thanks to Lancelot Da Costa for helpful discussions and edits
that substantially contributed to the notation, presentation and overall quality of the com-
mentary. I would also like to thank Thomas Parr and Karl Friston for helpful feedback and
discussions that improved the commentary.
7
Funding statement
CH is supported by the U.S. Oﬃce of Naval Research (N00014-19-1-2556), and acknowledges
the support of a grant from the John Templeton Foundation (61780). The opinions expressed
in this publication are those of the author(s) and do not necessarily reﬂect the views of the
John Templeton Foundation.
References
[1] Miguel Aguilera, Beren Millidge, Alexander Tschantz, and Christopher L Buckley.
“How particular is the physics of the free energy principle?” In:Physics of Life Reviews
(this issue 2021).
[2] Grigorios A. Pavliotis. Stochastic Processes and Applications: Diﬀusion Processes, the
Fokker-Planck and Langevin Equations. Texts in Applied Mathematics volume 60. New
York: Springer, 2014.isbn: 978-1-4939-1322-0.
[3] Claude Godrèche and Jean-Marc Luck. “Characterising the Nonequilibrium Stationary
States of Ornstein-Uhlenbeck Processes”. In:Journal of Physics A: Mathematical and
Theoretical 52.3 (Jan. 2019), p. 035002.issn: 1751-8113, 1751-8121.doi: 10.1088/
1751-8121/aaf190. arXiv:1807.00694.
[4] Karl Friston. “A free energy principle for a particular physics”. In: arXiv preprint
arXiv:1906.10184 (2019).
[5] Thomas Parr, Lancelot Da Costa, and Karl Friston. “Markov blankets, information
geometry and stochastic thermodynamics”. In:Philosophical Transactions of the Royal
Society A378.2164 (2020), p. 20190159.
[6] Karl J Friston, Lancelot Da Costa, and Thomas Parr. “Some interesting observations
on the free energy principle”. In:Entropy 23.8 (2021), p. 1076.
[7] Lancelot Da Costa, Karl Friston, Conor Heins, and Grigorios A Pavliotis. “Bayesian
mechanics for stationary processes”. In:Proceedings of the Royal Society A477.2256
(2021), p. 20210518.
[8] Chii-Ruey Hwang, Shu-Yin Hwang-Ma, and Shuenn-Jyi Sheu. “Accelerating Diﬀu-
sions”. In:The Annals of Applied Probability15.2 (May 2005), pp. 1433–1444.issn:
1050-5164, 2168-8737.doi: 10.1214/105051605000000025.
[9] Arnaud Guillin and Pierre Monmarché. “Optimal linear drift for the speed of conver-
gence of an hypoelliptic diﬀusion”. In:Electronic Communications in Probability21
(2016), pp. 1–14.
[10] Alessandro Barp, Lancelot Da Costa, Guilherme França, Karl Friston, Mark Girolami,
Michael I. Jordan, and Grigorios A. Pavliotis. “Geometric Methods for Sampling, Opti-
misation, Inference and Adaptive Agents”. In:arXiv:2203.10592 [cs, math, stat](Mar.
2022). arXiv:2203.10592 [cs, math, stat].
8
[11] Tony Lelièvre, Francis Nier, and Grigorios A. Pavliotis. “Optimal Non-Reversible Lin-
ear Drift for the Convergence to Equilibrium of a Diﬀusion”. In:Journal of Statistical
Physics 152.2 (July 2013), pp. 237–274.issn: 0022-4715, 1572-9613.doi: 10.1007/
s10955-013-0769-x. arXiv:1212.0876.
[12] Karl Friston, Conor Heins, Kai Ueltzhöﬀer, Lancelot Da Costa, and Thomas Parr.
“Stochastic chaos and markov blankets”. In:Entropy 23.9 (2021), p. 1220.
[13] Karl Friston, Lancelot Da Costa, Noor Sajid, Conor Heins, Kai Ueltzhöﬀer, Grigorios
A Pavliotis, and Thomas Parr. “The free energy principle made simpler but not too
simple”. In:arXiv preprint arXiv:2201.06387(2022).
[14] Martin Biehl, Felix A Pollock, and Ryota Kanai. “A technical critique of some parts
of the free energy principle”. In:Entropy 23.3 (2021), p. 293.
9