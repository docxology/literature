Towards hybrid primary intersubjectivity:
a neural robotics library for human science
Hendry F Chame† · Ahmadreza Ahmadi† · Jun Tani†
Abstract Human-robot interaction is becoming an in-
teresting area of research in cognitive science, notably,
for the study of social cognition. Interaction theo-
rists consider primary intersubjectivity a non-mentalist,
pre-theoretical, non-conceptual sort of processes that
ground a certain level of communication and under-
standing, and provide support to higher-level cogni-
tive skills. We argue this sort of low level cognitive
interaction, where control is shared in dyadic encoun-
ters, is susceptible of study with neural robots. Hence,
in this work we pursue three main objectives. Firstly,
from the concept of active inference we study primary
intersubjectivity as a second person perspective expe-
rience characterized by predictive engagement, where
perception, cognition, and action are accounted for
an hermeneutic circle in dyadic interaction. Secondly,
we propose an open-source methodology named neural
robotics library (NRL) for experimental human-robot
interaction, and a demonstration program for interact-
ing in real-time with a virtual Cartesian robot (VCBot).
Lastly, through a study case, we discuss some ways
human-robot (hybrid) intersubjectivity can contribute
to human science research, such as to the ﬁelds of devel-
opmental psychology, educational technology, and cog-
nitive rehabilitation.
Keywords Social cognition ·Interaction theory ·
Neural robotics ·Human-robot interaction ·Predictive
engagement ·Free energy principle ·Developmental
psychology ·Educational technology ·Cognitive
rehabilitation
†Cognitive Neurorobotics Research Unit (CNRU).Okinawa In-
stitute of Science and Technology Graduate University (OIST).
1919-1 Tancha, Onna-son, Okinawa, Japan 904-0495.
E-mail: {hendryfchame,ar.ahmadi62,tani1216jp}@gmail.com
1 Introduction
At present, technology has permeated distinct spheres
of human society, which has fundamental implications
for the research of cognition. Considering the ﬁeld of
robotics, in order to cope with challenges of our times,
it is important to study how the inclusion of robots can
transform the economic and social organization of our
society (Granulo et al. [1]), and possible ways of dealing
with those changes. It is also crucial to explore how
human-robot interaction research can serve beneﬁcial
purposes, such as helping in advancing the state of the
art in several ﬁelds of cognitive science.
In this evolving context, several research communi-
ties with distinct purposes have dedicated themselves
to study human-robot interaction in recent years. Per-
haps myriads of nominal categories could be proposed
to organize contributions in the ﬁeld, some examples
are the kind of robot involved (e.g. humanoids, pets,
exoskeletons) and the goals of interaction (e.g. educa-
tional, assistance, collaboration). In view of such diver-
sity, a convenient point to start from is structuring our
discussion around a key element of analysis that can be
systematically revisited. Hence, we propose to deal with
an important question evoked during interdisciplinary
conferences and encounters in our ﬁeld, which is simply
stated as: who is the subject in the interaction?
1.1 The human subject
Continent upon the quality of subjectivity is placed on
the human partner side, synthetic agents have served
methodological purposes for varied ends, such as diag-
nosing, assisting, and learning. Hence, by providing as-
sistance therapy, robots can help humans recover from
sensory-motor deﬁcits in some neuro-psychological con-
ditions (Gassert & Dietz [2]). Interaction has also served
to study neural development in autistic spectrum disor-
arXiv:2006.15948v1  [cs.RO]  29 Jun 2020
2 Hendry F Chame†et al.
der (ASD, Robins et al. [3], Scassellati et al. [4], Ismail
et al. [5]). Furthermore, robotics has contributed to the
acquisition of computational thinking skills (Atmatzi-
dou & Demetriadis [6]), improving executive functions
of planning and control (Di Lieto et al. [7]), sensory-
motor gaming (Kose-Bagci [8]), and metacognitive and
problem solving (Atmatzidou el al. [9]).
An important aspect to point out is that diverse ap-
proaches can be adopted for providing the robot with
control and interaction capabilities. Since the focus is
placed on the human subject, the internal structure of
the artiﬁcial partner is considered of secondary impor-
tance to the analysis of experimental protocols, which
include mostly observations on the human side. Fre-
quently, the robot is included as a black-box system,
providing some degree of standardization to ground
conclusions. Although this sort of studies is relevant
for advancing several ﬁelds in human science, we are
interested in considering artiﬁcial subjectivity in the
research hypotheses design, which is described next.
1.2 The robot subject
Focusing on the robot as a subject originates from the
interest in studying human cognition. Initiatives under
this perspective share the expectation that plausible
theories in cognitive science can be constructed through
modeling and implementing cognitive control schemes
in robots. Here, the human partner acts by stimulat-
ing the robot during interaction. Thus, observations on
the human side are considered in terms of evaluating
experimental hypotheses on the synthetic prototype.
In order to extend the result of robotics research to
human science, some authors have followed, from an
interdisciplinary perspective, a behavior-centered ap-
proach, so focusing on robotics research results that
could be directly mapped to analogous studies and
tasks with human infants and children (Cangelosi &
Schlesinger [10]). According to Asada et al. [11], since
the knowledge available in developmental cognitive
robotics is insuﬃcient, several implementations are pro-
posed to investigate cognitive functions from the de-
signers’ limited understanding of them (e.g. to study
foundations of communication, Kuniyoshi et al. [12]).
The research conducted in our lab has focused
on composable continuous state space neuro-dynamic
structures for the study of cognition (Tani [13]). Tak-
ing inspiration from brain sciences, several recurrent
neural network architectures (e.g. Tani [14] and Mu-
rata et al. [15]) have been proposed for learning spatial-
temporal relations in behavior sequences. These mod-
els have been used to investigate diverse skills, such
as goal-directed planning (Jung et al. [16]) and imita-
tion (Hwang et al. [17], Ohata & Tani [18]). Within
the neural robotics conception adopted in our lab, cog-
nition is studied as an emergent phenomenon that re-
sults from the interaction between a top-down process,
that characterizes subjective deliberation and agency,
and a bottom-up information process, that accounts for
the perceptual reality. Next, we argue neural robots are
valuable means to study human-robot non-verbal com-
munication, where both partners are included as sub-
jects in the research hypotheses design.
1.3 Hybrid primary intersubjectivity
Intersubjectivity is a concept that carries deep philo-
sophical roots. It is fundamental to Hursserl’s founda-
tions on phenomenology [19], and received important
contributions from Heidegger (with the notion of being-
in-the-world [20]), Merleau-Ponty (through the study
of perception and embodiment [21]), and Habermas (in
the theory of communicative action [22]), among several
other sources. Dealing with the philosophical complex-
ities of the concept would certainly surpass our current
scope. Thus, our focus is rather placed on the much
more circumscribed sphere of social psychology.
A conceptual distinction in social cognition research
has been established to deﬁne the sort of access a per-
son uses in understanding another person. According
to Fuchs [23], from an experiential level of analysis,
the access possibilities to oneself and others conform
the triad: ﬁrst (1PP), second (2PP), and third (3PP)
person perspective. Hence, subjective experiences are
accessible from 1PP, co-experiences or intersubjective
experiences (reciprocal interaction, forms of mutual re-
latedness) are accessible from 2PP, and one-way, vicar-
ious, or remote observations are accessible from 3PP.
An intense debate has been established among theo-
rists concerning the experiential level of analysis from
which studying intersubjectivity. This is reviewed next
in order to delimit the theoretical scope of this work.
Several authors (e.g. Gallagher [24], Fuchs [23],
Newen [25]) have pointed out that studies in social
cognition have traditionally explained how individuals
understand and interrelate with each other from the
perspective of theory of mind. Notably, under the ap-
proaches of theory theory (TT) and simulation theory
(ST). In essence, from a 3PP experiential level of anal-
ysis, TT theorists investigate intersubjective relations
as specialized cognitive abilities for explaining and pre-
dicting behavior, based on the employment of folk psy-
chological theories about how behavior is informed by
mental states (e.g. Premack & Woodruﬀ [26], Welman
[27], Gopnik & Schulz [28], Leslie [29]). ST theorists
Towards hybrid primary intersubjectivity: a neural robotics library for human science 3
study intersubjectivity from a 1PP experiential level of
analysis, as how mental experience becomes an internal
model for understating the other’s mind, so thoughts or
feelings of the other person are simulated as the subject
would be in the other’s situation (e.g. Gallese & Gold-
man [30], Rizzolatti & Fogassi [31], Davies & Stone [32],
Goldman [33]).
Developmental psychology research has challenged
theory of mind accounts of social cognition, and de-
scribed primary and secondary intersubjectivity stages
of development (Gallagher [34], Spaulding [35]). Thus,
primary intersubjectivity , originally described by Tre-
varthen [36], consists in a voluntary interpersonal com-
munication process characterized by intentionality and
adaptation, which is founded in innate, embodied, pre-
theoretical, non-conceptual fundamental capacities for
self-expression and understanding others (e.g. facial
gesticulation; proprioceptive sensation, automatic at-
tunement, detection of intentional behavior, eyes mo-
tion tracking, noticing emotions in gestural intonation
and expression, among others). Secondary intersubjec-
tivity is theorized to be constituted later, transcend-
ing the face-to-face sort of interactions to a context
of shared attention, mediated by communication about
objects and events in the environment. Conforming to
Rochat & Passos-Ferreira [37], the stage of tertiary in-
tersubjectivity is characterized by processes of nego-
tiation with others about the values of objects, from
shared and self representations. Our work is interested
in studying social interaction, as characterised by pri-
mary intersubjectivity.
Interdisciplinary eﬀorts from developmental psy-
chology, phenomenology, and philosophy of mind, have
constituted, in the last decades, a diverse ﬁeld of re-
search that investigate four central features of cogni-
tion. Thus, according to Newen et al. [38], 4E cognition
is considered to be embodied, embedded, extended, and
enactive. Theorist in 4E cognition research cognitive
phenomena as dependent on the body characteristics
(on its physiology, biology, and morphology), on the
particular structure of the environment (e.g. natural,
technological, social), and on the active embodied in-
teraction of the agent with the environment.
When considering the study of 4E properties of so-
cial cognition, the critical movement against theory of
mind approaches was very much inﬂuenced by the pro-
posal of interaction theory (IT, Gallagher [24], also
named embodied social cognition Gallagher [34]). For
IT, experiencing the feelings and intentions of another
person is mostly accounted for by a 2PP access to im-
mediate perception of embodied interaction with oth-
ers, which constitutes a simpler, non-mentalistic, on-
line capacity. Hence, mind-reading skills (as studied in
TT and ST) consists in specialized forms of intellectual
activity less regularly used when basic embodied pro-
cesses fail to account for a given situation. Although IT
is not an uniform theoretical ﬁeld, according to Newel
[38] theorist share the two following ideas: a) under-
standing others does not involve observing others on the
regular basis, but interacting with them, and b) the ex-
periential access in understanding through interaction
is immediate or direct perception. We study primary
intersubjectivity in the context of IT.
When analysing diﬀerences between IT theorists, it
is fundamental to observe the peculiarities or sort of
interaction that constitute a particular research scope.
For enactivist theorists (e.g. De Jaegher & Di Paolo
[39]), social interaction is characterized by coupling,
which maintains an identity in the relational domain,
and by individual autonomy. An example would be
walking in the opposite direction in a narrow corridor,
where individuals are attempting to stop interacting
but the interaction self-sustains notwithstanding their
will. Conforming to Reddy [40], it is not the structure
of the situation that determines a 2PP level access ex-
perience in the interaction, but the fact of mutual ac-
knowledgment, emotional involvement, or engagement
(e.g. sharing a smile, attraction, interest, surprise).
Our research scope is concerned with engaged inter-
actions as described by Reddy. A distinguishable aspect
of our work is the interest in direct interaction expe-
riences characterized by intention and purpose. That
is, along with possessing means for adaptation or ﬁt-
ness to other’s actions, individuals are also capable of
employing volitional resources to express their inten-
tion. Consequently, dynamic control is shared within
the dyad. We believe that this sort of exchange is pos-
sible when both agents are capable of, among several
skills, processing feedback and formulating proactive
expectations on how the situation would look like while
enacting in the dyad (Tani [13]).
In the study of intersubjectivity, IT theorists have
disagreed on the importance of knowledge represen-
tation and prediction. Conforming to Schlicht [41],
some theorists have radically departed in a non-
representational approach and studied emergent inter-
action from dynamic system theory, whereas moderate
theorists have retained mental representation in the-
orizing social cognition. Examples of the former are
studies of minimalistic interaction (Auvray et al. [42],
Froese & Ziemke [43], Lenay & Stewart [44], Froese et
al. [45]). Concerning moderate views, according to Gal-
lagher & Allen [46], some interpretations of the gen-
eral framework of the predictive model are consistent
with methodological individualism (e.g. Hohwy [47]),
whereas others are consistent with autopoietic enac-
4 Hendry F Chame†et al.
tivist theories (e.g. Kirchhoﬀ [48] [49]). Notably, free
energy principle (FEP) theory (Friston [50]).
This work investigates primary intersubjectivity
from the perspective of FEP theory, within the scope
of 4E social cognition. In agreement with Allen & Fris-
ton [51], we study FEP theory as a synthetic account
to explain the constitutive coupling of the brain to the
body and the environment. Thus, internal representa-
tion and prediction, in the generative sense, are consid-
ered to emerge from the organismic autopoietic1 self-
organization. Given the assumption ofergodic2 dynami-
cal interchange between the agent and the environment,
we investigate perception, cognition, and action as ex-
plained by an enactive hermeneutic circle taking place
in dyadic encounters (Gallagher & Allen [46]). For this,
we study interaction as a process where deliberative
control and automatic adjustment coexist.
A ﬁnal aspect to discuss, when deconstructing the
title semantics, is the meaning of the term hybrid. It ac-
counts for the study of social interaction between two
partners distinct in nature. In this sense, an impor-
tant issue investigated in human-robot interaction has
been human engagement, where the uncanny valley ef-
fect (i.e. emotional response in subjects from perceived
human resemblance of synthetic objects, Mathur & Re-
ichling [52]) has been reported. Diﬀerently from this
line of research, we focus on the inclusion of robots as
they are to study interaction, and not on how the robot
could substitute the human partner. As elaborated in
the next sections, we propose a methodology to model
artiﬁcial agents for social interaction. Through the pre-
sentation of a case study experiment, we discuss some
perspectives for the research in human science.
2 Human/neural-robot interaction
Neural robotic agents are inspired in brain science re-
search. It is generally considered that understanding
brain functions requires the integration of knowledge
at multiple levels of abstraction (Hawkins & Blakeslee
[53], Freeman [54], Ishii et al. [55]). Thus, several works
have researched synaptic molecular protein synthesis,
how neuromechanical signals are transmitted, how spik-
ing activity in a single neuron unfolds, local cell assem-
bly circuits, and the whole brain network. Each of these
levels of abstraction are the subject matter of particu-
1 Understood as the persistence of self-organization of an or-
ganism given its characteristic dynamical structure, while in-
teracting with the environment.
2 Ergodicity implies that the average probability of a system
being in a given state is equivalent to the probability of being
in such state when observed randomly.
lar disciplines in cognitive science, such as neuroscience,
psychology, and artiﬁcial intelligence, among others.
We are interested in the study of relational and
organizational aspects of cognition by taking a syn-
thetic approach. Particularly, we use recurrent neural
networks (RNN), which are highly adaptable nonlin-
ear dynamical systems able to deal with both tempo-
ral and spatial information structures. Several architec-
tures have been investigated in our lab (e.g. continuous
time recurrent neural network CTRNN, Beer [56], and
multiple timescale recurrent neural network MTRNN,
Yamashita & Tani [57]). More recently, a variational
framework inspired by FEP theory named predictive-
coding-inspired recurrent neural network (PV-RNN,
Ahmadi & Tani [58]) was proposed. This framework
is selected as a case study in this work.
Previous research has studied social cognition from
FEP theory. Thus, several works (e.g. Van de Cruys
et al. [59], Hohwy & Palmer [60], and Lawson et al.
[61]) have attempted to explain social behavior in ASD
through the predictive model account. Commonly, a
theory of mind stance has been adopted. This has been
also the case for the research of intersubjectivity and
communication (e.g. Friston & Frith [62]). In general,
studying social cognition is tremendously challenging
from the methodological point of view. Regularly, re-
searchers have resorted to oﬀ-line computer simulations
(e.g. Friston & Frith [63]), or to on-line indirect inter-
action mediated by virtual systems, as a means to exert
control over extraneous experimental variables (e.g. the
technique hyperscanning, Babiloni & Astolﬁ [64]).
A peculiarity that emerges in dyadic direct interac-
tion is that actions depend on both partners’ interven-
tions. Moreover, several sensory and motor organs are
simultaneously involved and not only voluntary control,
but spontaneous or covered reactions are produced and
regulated by the central and peripheral nervous sys-
tems. Noticing this has been particularly important for
the study of neural development in ADS (Torres et al.
[65]). Under such complex scenario, we investigate in-
tentional human-robot interaction as a second person
perspective access experience.
Human-robot interaction dynamics and the theoret-
ical assumptions adopted in this work are represented in
Fig. 1. The neural robot is dotted with the capacities
of agency (or deliberation) and compliance (reactive-
ness, adjustment) in relation to the human partner’s
actions. In agreement with FEP theory (Friston [66]),
the robot’s deliberative control is studied as a varia-
tional optimization process that involves a hierarchical
dynamical representation, in which a top-down infor-
mation ﬂow (developed by a generative process) char-
acterizes the agency of purposeful actions (or intention
Towards hybrid primary intersubjectivity: a neural robotics library for human science 5
to behave) in the interaction context, and a bottom-
up information ﬂow (an inference process) accounts for
their consequences; so conﬂicts possibly appearing be-
tween these two processes are attempted to be reduced
through minimizing free energy as a statistical quantity.
Interaction dynamics
Agency (deliberation)
NowShort-term memory... time
Slow dynamics
RNN
Fast dynamics
Generative
process
Inference
process
Feedback
Surprise
Perception
Enactment
agency + compliance
Physical
interaction
Fig. 1: Control is shared in the interaction based on the
individuals’ capacities of enacting agency and compli-
ance. The capacity of agency is studied through the op-
timization of free energy (surprise) in short-term mem-
ory of direct perception. Hence, from the robot’s unique
past, an intended future is reinterpreted in the hierar-
chical RNN for deliberation control and projected in the
perceptual space. The capacity of compliance is mod-
ulated as a proportional integral (PI) control scheme
for automatic adjustment of the body to the actions
induced by the partner.
Compliance is a fundamental capacity for social in-
teraction which is based on the awareness of others in-
tentions and knowing what those intentions refer to.
This capacity has been studied from a developmental
perspective at its early emergence (Reddy [67], Reddy
et al. [68]). When contextualizing our work in the IT
literature, we start from the assumption that automatic
processes are available to the person, so the body reacts
by adjusting to some extend to the partner’s actions.
Here, we do not study nor evaluate this assumption,
this is an aspect that remains for a further examina-
tion. Thereby, we focus on understanding deliberation
in the dyad from our interpretation of FEP principle
theory, taking automatic adjustment as granted.
Our previous research (Chame & Tani [69]) has
shown in on-line human-robot interaction a possible
way in which compliance, as a cognitive (volitional) dy-
namic process, can relate to reactive motor adjustment.
Hence, cognitive compliance was studied as a dynami-
cal integrative optimization process that characterizes
how deliberation is inﬂuenced by sensory stimulation
induced by the partner’s actions in the dyad. Thus, it
was shown how an agent with strong belief tends to act
egocentrically to the environment without changing its
internal state or intention, whereas an agent with weak
belief tends to act adaptively to the environment by
easily changing its internal state or intention, while the
capacity of adjustment was kept constant.
We consider that the perspective adopted here for
studying primary intersubjectivity is consistent with
the characterization provided by Trevarthen [36], who
views this construct as a deliberative-compliant pro-
cess. Therefore, we propose to investigate enactivist so-
cial cognition in human-robot interaction as a relevant
methodological approach for several ﬁelds of human sci-
ence research, which is discussed in Sec. 5. Next, within
the context of interdisciplinarity, fundamental concepts
in our ﬁeld are introduced with minimal mathemati-
cal formulation, under the modality of a questions &
answers panel section.
2.1 What is free energy?
Free energy principle theory was initially proposed as a
unifying framework in brain science (Friston [70]). More
recently, the theory has been extended and related to
the ﬁelds of theoretical biology, statistical thermody-
namics, and information theory (Friston. [50]). A core
assumption in FEP theory is that living organisms are
driven by the tendency to resist the second law of ther-
modynamics, so to maintain their internal structure or
dynamics in a constantly changing environment.
Conforming to Allen & Friston [51], from this funda-
mental drive for existence, biological system are char-
acterized by the following properties: ergodicity (an or-
ganism occupies or revisits some characteristic states
more than others over time in order to live), Markov
blanket (a mathematical description of the boundaries
between the organism and the environment, such de-
scription is undertaken at multiple levels of analysis),
active inference (perception and action are locked in a
circular causality relation), and autopoiesis (emergent
and self-organized maintenance of organismic dynamic
structure while interacting with the environment).
6 Hendry F Chame†et al.
FEP theory consists in a predictive account of the
mind. It considers that an agent proactively antici-
pates sensation from empirical priors (in a generative
sense), and minimizes free energy as a measure (an up-
per bound) of surprise. As a consequence, the internal
state of the agent is maintained within characteristic
or habituated regions. Thus, less/more sensory surprise
means lower/higher free energy, with more/less likeli-
hood of internal dynamics unfolding in a given region.
2.2 How is free energy minimized?
Generally, free energy is considered to be minimized in
two fundamental ways: through predictive coding, for
vicarious perception, and through active inference, for
goal directed action (Friston et al. [66]). In predictive
coding, surprise is minimized in a bottom-up pathway,
so the internal state is modiﬁed to generate more consis-
tent predictions with respect to sensory evidence. This
principle has been explored in theory of mind studies
of social cognition (e.g. Van de Cruys et al. [59], Kilner
et al. [71], Koster-Hale & Saxe [72]). Diﬀerently, in ac-
tive inference sensory predictions are attempted to be
fulﬁlled in a top-down pathway, by taking purposeful
actions in the environment (Friston et al. [73]).
Regardless of the way surprise is minimized, in FEP
theory it is assumed that sensation prediction is accom-
panied with an estimate of precision. Hence, surprise is
considered to be minimized in relation to (divided by)
precision, which means that free energy is minimized
more when associated with a high precision estimate
(i.e. a strong belief). A practical implication of the pre-
vious statement is that an agent with strong belief tends
to act egocentrically to the environment without chang-
ing its internal state or intention, whereas an agent with
weak belief tends to act adaptively to the environment,
by easily changing its internal state or intention.
This work focuses on the study of enactivist social
cognition based on active inference. As pointed out by
Friston et al. [66], in active inference no distinction is
established in terms of sensory or motor representa-
tions, since motor control signals are considered to be
directly generated by proprioceptive predictions, so the
individual perceives relevant action aﬀordances in the
interaction context. This is going to be discussed in
more details when considering the matter of perception
as a direct experience. In the appendix sections, active
inference is described within the scope of our case study,
which includes the PV-RNN framework. The minimiza-
tion of free energy is equivalent to the maximization of
the sensory evidence lower bound (ELBO), which is dis-
cussed in the next question.
2.3 What is the evidence lower bound?
The ELBO is a quantity introduced in the variational
Bayesian (VB) optimization literature. In FEP the-
ory, this quantity corresponds to the summation of
two terms, namely the accuracy term, representing the
prediction error, or surprise; and the complexity term,
representing the complexity of the internal represen-
tation. Mathematically, accuracy is the expected loga-
rithm likelihood of the model with respect to the ap-
proximated posterior distributions, and complexity is
the Kullback-Leibler divergence (KL divergence) be-
tween the approximated posterior and the prior hidden
distributions. Therefore, by deﬁnition ELBO ≤0 is an
upper limit for the logarithm of the marginal likelihood
in the anticipation of the sensory state by the generative
process (see the mathematical details in the Appendix
section). For human-robot interaction experiments it is
perhaps more intuitive to relate surprise to the nega-
tive evidence lower bound (N-ELBO), since increases in
N-ELBO correlate with situations where mismatch in-
creases between the anticipation and actual sensation.
2.4 Is perception a direct experience ?
In the study of perception-action, two schools have con-
trasted, namely, thecontructivist and the ecologicalthe-
ory of perception. These theories have developed over
several years. Here, only their basic characterization is
presented. Thus, constructivist theorists are very much
inﬂuenced by Helmholtz’s notion ofunconscious conclu-
sion (Helmholtz [74]). It is generally assumed that stim-
ulation reaching the sensory apparatus is not suﬃcient
for perception, so intermediate processes (e.g. memory,
perceptive schemes, previous experience) intervene be-
tween sensation and perception, which characterizes an
inferential and indirect process. Contrarily, the ecolog-
ical school, under the inﬂuence of Gibson’s studies of
visual perception (Gibson [75]), consider that informa-
tion available in the ambient suﬃces, since what is per-
ceived are changes over time and space (an informa-
tion ﬂow). Accordingly, individuals perceiveaﬀordances
(i.e. functional utilities with respect to themselves and
their action capabilities) of objects or the environment.
Consequently, perception is studied under the ecologi-
cal school as a direct or immediate process.
Constructivist theories of perception have been as-
sociated with cognitivism, when attributing a predomi-
nant role to the brain in the top-down information pro-
cessing of sensory data (e.g. Gregory [76]), which largely
neglects the richness of information available at the sen-
sory level. However, although neurophysiological, neu-
ropsychological, and psychophysical scientiﬁc evidence
Towards hybrid primary intersubjectivity: a neural robotics library for human science 7
has supported the coexistence of constructivist and eco-
logical perceptive processes in the brain (Norman [77]),
according to De Wit & Withagen [78], ecological psy-
chologists have been criticized for ignoring the brain in
their theoretical formulations.
More recently, Linson et al. [79] have argued that
when replacing traditional inferential explanations,
based on the notion of passive input, with the notion
of active input, ecological theorists still maintain an
input-output account of perception. According to the
authors, active inference is characterized in FEP theory
as direct engagement (in the thermodynamic sense) be-
tween the agent’s sensory system and the environment.
Thus, sensation is considered to be anticipated from a
generative process, which does not constitute an infer-
ential process in the input-output sense. As pointed out
by Bruineberg & Rietveld [80], perception and action
from anticipatory dynamics and free-energy minimiza-
tion ensure the agent with the capability of maintaining
adaptive sensibility to relevant aﬀordances in a given
context. This would not be about reconstructing the
structural hidden causes of the environment.
This debate has been certainly inspiring for artiﬁcial
intelligence and robotics research. It could be relevant
bringing up to discussion inﬂuential works by Brooks in
behavioral robotics (e.g. Brooks [81][82]). The ﬁeld was
also inﬂuenced by Braitenberg [83]. In behavior robotic
agents, sensory input has been directly mapped to mo-
tor output. This idea would arguably conform to prin-
ciples of the ecological theory of perception (Tani [13]).
Although interesting behavior can result from minimal
control schemes, this sort of robots are only capable of
reacting to the environment. Lacking of intention, they
behave in stereotyped ways and exhibit low capacity of
generalization, even to slightly diﬀerent situations.
In the approach adopted in our research, robots are
capable of active inference, so they perceive action aﬀor-
dances directly as a vector ﬂow in the perceptual space
(i.e. no distinction is established in terms of sensory or
motor representations). Hence, such neural robots try
to fulﬁll their intention in the interaction by directly
performing aﬀorded actions making sense in a given
context. Next, we propose a methodological resource
for designing these sort of neural agents for conducting
human-robot interaction experiments.
3 An open-source library
The neural robotics library (NRL) is a project designed
to serve as an open-source tool for interdisciplinary re-
search in human social cognition. NRL is structured
according to the four-step methodology proposed in
Fig. 2. The project focuses on providing neural robots
with the capability of deliberation control for interac-
tion (see Fig. 1). The software is released at the github
repository3 under the terms of the 3-Clause BSD Li-
cense. NRL considered recommendations for systems
and software engineering developments by the standard
ISO/IEC 25010 [84].
Neural robotics methodology
Improvements
Modeling Training Experiment Analysis
Data-set Data-storage
Fig. 2: The researcher develops a prototype of the neu-
ral agent by setting the model’s parameters, collecting
the behavior dataset, and training the model. In the ex-
perimental phase, data from interaction with the sub-
jects is registered, and lately analyzed with the help of
graphical and statistical tools.
Prototyping robotic experiments is a challenge en-
deavor. Provided that robots actuate on the environ-
ment, it is fundamental to consider safety, for this, run-
time errors must be carefully anticipated and handled.
Human-robot interaction presents the supplementary
diﬃculty of requiring computation eﬃciency for real-
time performance. By considering previous experiences
with diverse robot tasks (e.g. manipulation in Chame
& Martinet [85], human inspired locomotion and ob-
ject approach in Chame & Chevallereau [86], walk with
top-down and bottom up visual attention in Chame et
al. [87]), the C++ programming language (Stroustrup
[88]) was selected for developing the NRL project.
In terms of abstraction from the hardware platform
resources, C++ is considered an intermediate level lan-
guage, which is adequate for situations where the pro-
grammer intends to control how low level machine re-
sources are used, such as how memory is allocated and
information is retrieved. Conveniently, the language
syntax conforms to the Object Oriented software engi-
neering paradigm (Meyer [89]), which favors the quality
of software maintainability.
Figure 3 presents the Object Oriented software de-
sign. As noticed, in NRL network and layer behav-
iors are abstracted, respectively, in the INetwork and
the ILayer interfaces. In this manner, new functionali-
ties can be added without interfering signiﬁcantly with
3 Project repository: https://github.com/oist-cnru/NRL
8 Hendry F Chame†et al.
available implementations. The network and layers ex-
change information through the IContext interface. Ex-
tended classes would act as data buﬀers, so information
can be shared among other levels of the layered hierar-
chy. An extended description of the software design is
provided in the project’s repository.
Simpliﬁed class diagram
1
1
1
1
1
1
1 1
1..*
1
1..*
1
1 1
11
NRL
Attributes
Training methods
Experiment methods
Oﬄine methods
Utils
Attributes
Methods
IRobot
Methods
INetwork
Methods
IContext
Methods
ILayer
Methods
Dataset
Attributes
Methods
Cartesian
Attributes
Methods
Npvrnn
Attributes
Methods
Cpvrnn
Attributes
Lpvrnn
Attributes
Methods
Fig. 3: Abstract classes are shown in white background.
In order to ensure compatibility, portability, and re-
ducing the chances of run-time errors, NRL relies on
free software platforms developed and maintained inde-
pendently by third parties. Such resources are largely
used in the scientiﬁc domain. Hence, since the mathe-
matical modeling of artiﬁcial neural networks involves
a fair amount of linear algebra, the project considered
the Eigen template headers for linear algebra version
3.3 developed at INRIA by Jacob & Guennebaud [90].
Also, NRL includes the C++ Standard Library, which
are available under multiple platforms.
NRL is a general framework that can be extended
to include diverse recurrent neural network architec-
tures. In this work the network type PV-RNN is taken
as a case study. The reader interested in consulting the
mathematical formalism of PV-RNN is referred to Ah-
madi & Tani [58]. For self-containment, the Appendix
sections summarize the mathematical model. In the
next section, it is proposed a front-end program that
implements a virtual robot, for illustrating NRL oper-
ation in on-line interaction. The library has been used
in real experiments, as reported in the study by Chame
& Tani [69], which included the humanoid Torobo.
4 Interacting with VCBot
The virtual Cartesian robot, shortly named VCBot, is a
program designed for interaction with an artiﬁcial neu-
ral agent through the computer mouse. The program is
released at the github repository 4 under the terms of
the 3-Clause BSD License. VCBot is modeled as a two
degrees of freedom robot articulated by prismatic joints
(Khalil & Dombre [91]). The software is implemented
as a client application in the python programming lan-
guage (Van Rossum [92]), which runs on the top of the
NRL back-end. The project is documented in details,
with descriptions on the operation modes available. Tu-
torial videos for installation and operation are proposed
in the project’s repository. The graphical user interface
(GUI) is designed following a notebook layout (see Fig.
4). It includes in dedicated tabs the four methodological
steps shown in Fig. 2, which is discussed below.
The graphical user interface
Fig. 4: VCBot in experiment mode ready for interac-
tion. The training dataset (in watermark color for ref-
erence) includes behavior primitives globally shaping a
macaw cub. The end-eﬀector is represented by the red
circle. Recent behavior is shown in light blue (the robot
is reproducing the shape of the head).
4.1 Modeling
Agent modeling starts by the selection of the network
features. The PV-RNN parameters shape important
qualities such as compliance in the deliberation style
of the agent. Unfortunately, the selection of parameters
cannot be done analytically, so the method of trial-and-
error should be employed. Table 1 provides a qualita-
4 Project repository: https://github.com/oist-cnru/VCBot
Towards hybrid primary intersubjectivity: a neural robotics library for human science 9
tive description of the role of the parameters and some
hints on their selection. An important aspect to con-
sider is that computational complexity is conditioned
to the number of intermediate layers and the amount
of neurons within layers. Therefore, it is recommended
to start by proﬁling a reduced structure and gradually
increasing its complexity until it is able to handle the
task. This iterative process is represented in Fig. 2 as
the cyclic ﬂow labeled improvements. For reference, the
models included for demonstration in VCBot comprise
two layers: the Low layer is composed of 40 d units, 4 z
units, and the time constant set to 2; whereas the High
layer is composed of 10 d units, 1 z unit, and the time
constant set to 10.
Table 1: PV-RNN parameters selection
Parameter Description
z units Represent the stochastic latent state in the
prior and posterior distributions (see Eqs. (4)
and (11)). In PV-RNN these units encode
a Gaussian distribution parameterized by a
mean (or expectation) µ and a standard de-
viation σ, so z= µ+σ∗ϵwith ϵsampled from
N(0,1).
d units Represent the deterministic latent state (see
Eq. (6)). As a rule of thumb they are set ten
times more numerous than z units.
Regulation
w
Is a meta-parameter which inﬂuences the
learning of the posterior and the prior distribu-
tions (see Eq. (17)). In general, the higher the
parameter is set, the more similar the hidden
prior and posterior distributions would be, so
the internal representation would be less sensi-
tive to stochasticity during interaction (when
deliberating, the agent would comply less to
the partner’s intentions). On the other hand,
if w is set too low, the agent’s generative pro-
cess (based on the prior distribution) would be
poor, so deliberation will tend to be erratic.
Timescale
constant
The timescale conditions the temporal dynam-
ics of the layers. The constant should be se-
lected increasing proportionally between adja-
cent layers from the lowest to the highest, so
low layers present faster dynamics than higher
layers. For example, assuming a conﬁguration
of three layers, in case ιmiddle = 5ιlow (see Eq.
(6)), then ιhigh = 5ιmiddle.
4.2 Training
The objective of constituting training sets is to capture
fundamental behavior on the robot side for studying
during interaction. Thus, depending on the theoreti-
cal aspect under consideration, such basic skills could
be assumed to be either innate to the agent, or ac-
quired through developmental sensory-motor processes
(e.g. through motor babbling, imitation).
A convenient method used for registering behavior
primitives is kinesthetic demonstration, where the hu-
man directly moves the robot body to show the be-
haviors. For the case study, a two-dimension motion
primitive set was constituted, inspired by the body
shape of a macaw cub (perhaps on the species ara
ararauna). A total number of seven primitives were
included, registered at 100 millisecond sampling pe-
riod, during 72 time steps, conforming limit cycles in
a clockwise sense. These trajectories represented dis-
tinct anatomic regions of the bird (i.e. the left eye, the
head, the beak, the neck, the right wing, the belly, and
the left wing). Only individual primitives were included
in the dataset, so the robot did not learn how to relate
one primitive to another. Hence, an important aspect to
observe is whether possible relations between previous
knowledge emerge during interaction.
The model was trained during 50,000 epochs (see
Fig. 5), following the Adam method for stochastic op-
timization (Kingma & Ba [93]). As noticed on the top
row, the network optimized faster the reconstruction er-
ror (the accuracy component of the ELBO) related to
the posterior distribution, and gradually improved the
results for the prior distribution, which can be noticed
in the way the signal corresponding to the regulation
error (at the bottom-left) decreases. This means a grad-
ual increase of complexity in the model, since the prior
and the posterior distributions are becoming more sim-
ilar. Thus, as seen in the plot on the bottom-right, the
negative ELBO is minimized over the training epochs.
After training, the primitives were generated from
the prior distribution to evaluate the quality of behav-
ior achieved. As seen at the top of Fig. 6, the generation
process could reproduce in overall the body shape of the
macaw cub, as compared with the training set trajec-
tory shown in watermark color in Fig. 4. For observing
the internal representation self-organized by the net-
work, two principal component analysis (PCA) from the
activity of d units at the High layer (slowest dynamics)
were plotted at the bottom of the ﬁgure. An important
aspect to be noticed is the connectivity between regions
in the internal representation. Hence, some primitives
are represented inter-connected whereas others are not.
The absence of connectivity should imply higher diﬃ-
culty in switching between those attractor regions, this
is going to be discussed in more details when analyz-
ing the interaction results. It is also important noticing
that although there may be overlap in the regions, the
ﬂow of activity could be in the opposite sense. Since
all the primitives were captured clockwise, their inter-
10 Hendry F Chame†et al.
0 15000 30000 45000
epochs
0
150
300
450
Poster ior  r econstr uction er r or
0 15000 30000 45000
epochs
0
300
600
900
Pr ior  r econstr uction er r or
0 15000 30000 45000
epochs
0
10
20
30
Regulation er r or
0 15000 30000 45000
epochs
0
80
160
240
Loss (N egative ELBO)
Time evolution of training
Fig. 5: Training was optimized during 50,000 epochs.
The parameter selected for the Adam method were
α = 0 .001, β1 = 0 .9, β2 = 0 .999. The posterior and
prior reconstruction errors are calculated by taking the
softmax transformation on training data along every
degree of freedom of the robot, and computing the sum
of the Kullbach-Leiber divergence between the training
reference and the output generated by the network from
the posterior and the prior distribution respectively.
nal representation also preserved those spatial-temporal
relations.
4.3 Experiment
The goal of the human-robot interaction experiment
was to observe mutual interaction and inﬂuence be-
tween the partners. For this, the human was instructed
to reproduce with the robot the body part of the macaw
cub. In the experiment it is not important that all prim-
itives are covered, but how mutual interaction in both
directions could develop. Thus, the robot was set to
start generating one of the primitives, and the human
was instructed to try for each primitive by turn to cover
the behavior repertory as much as possible, within a
given time. The human was also instructed to proceed
at will, so no predetermined order was recommended in
trying to accomplish the primitives. After the experi-
ment, the human was requested to verbally report on
the primitives attempted with the robot.
A simple proportional controller was designed to en-
dorse the robot with the capacity of enacting deliber-
ation and adjustment (motor compliance) in relation
to the human’s actions (see Fig. 1). Thus, the posi-
tion of the robot’s end-eﬀector emerging from the in-
teraction was determined from the linear interpolation
of the human and the robot desired actions, such that
Motion primitives in the workspace
Two-PCA d states (High Layer)
Eye
Head
Beak
Neck
Belly
Right-wing
Left-wing
Fig. 6: On the top, the seven behavior primitives rep-
resenting globally the body shape of a macaw cub were
successfully learned by the prior generation process. On
the bottom, the resulting internal representation self-
organized by the network form training. It is important
noticing the connectivity between regions, and the sense
of information ﬂow in the attractors developed, which
is indicated by the orange arrows.
position= γhuman−(1 −γ)robot. For the study case
γ = 0.9, which means the human exerted much more
inﬂuence over the position of the end-eﬀector than the
robot did. In order to avoid brusque changes in the
motion trajectory, the position rate of change was sat-
urated by a constant factor.
In the experiment, the human interacted with
VCBot during approximately 6 minutes and 20 seconds.
Data was captured during 2,000 time steps, at every 100
milliseconds. The human desired actions were registered
as the coordinates of the mouse cursor. In VCBot the
human chooses when to enable interaction by pressing
and holding the control key from the computer key-
board while moving the mouse. Therefore, both the
Towards hybrid primary intersubjectivity: a neural robotics library for human science 11
position of the mouse cursor and the key press event
were recorded. The robot desired actions were gener-
ated by the neural network. The negative ELBO was
also recorded as a measure for real-time minimization of
free energy. Several repetitions of the experiment were
performed, Fig. 7 shows the time evolution of data cap-
tured for the most interesting trial. A total of eight
human intervention events were produced during the
experiment. Table 2 presents the human self-reported
intention on the events. These results are analyzed next.
Em er g en t
b eh avi or
Rob ot
I n t en t i on
H u m an
I n t en t i on
N -EL B O
0 250 500 750 1000 1250 1500 1750 2000
Tim e in m s
H u m an -Rob ot
 I n t er act i on
1 2 3 4 5 6 7 8
Eye Head Beak Neck Right
wing
Belly Left
wing
Time evolution of interaction
Fig. 7: In the plots the axes and labels are not shown
for clarity. The vertical component of the signals cor-
respond for the top three plots to the width and the
depth coordinates of the robot’s end-eﬀector. The N-
ELBO is shown in the two lower plots. For the plot
Human-Robot Intention, a scaled binary signal repre-
senting the control key pressing event by the human is
also shown. Temporal contiguous human interventions
were grouped and numbered. The horizontal compo-
nent corresponds for all cases to the time dimension.
4.4 Analysis
A quantitative measure of intentionality congruence is
proposed based on an automatic regression observer.
The objective is classifying the robot and the human
Table 2: Human intention self-report
E Description
1 The robot was doing Head, the human intended to
do Beak, so the robot could switch accordingly.
2 The robot was doing Beak, the human tried to do
Head, which the robot accomplished.
3 The robot was doing Head, the human successfully
induced a change to Eye.
4 The robot was doing Eye, the human tried Neck for
a while, however the robot switched to Left-wing.
5 The robot was doing Left-wing, the human tried
again Neck, so the robot could follow up this time.
6 The robot was doing Neck, the human induced a
switch to Belly.
7 The robot was doing Belly, the human made it
change to Right-wing.
8 The robot was doing Right-wing, the human tried in
vain switching to Left-wing.
intention from the observer’s evaluation, which receives
as input the intended behavior signal, buﬀered in a lim-
ited temporal window, and outputs the attribution of
the signal to a behavior category (i.e. a represented
body part of the macaw cub). This problem is anal-
ogous to some extent to the comparison of time series
for speech recognition (e.g. Sakoe & Chiba [94]). Thus,
two conditions are assumed in the comparison: a) pat-
terns are time-sampled with a common and constant
sampling period, and b) there is no a priori knowledge
about which parts of the patterns contain important
information.
The automatic regression observer designed corre-
sponded to a feed-forward model with the following
layered structure: 10 input units (2 degrees of freedom
x 5 time steps buﬀer window), 150 units in the ﬁrst
hidden layer, 100 units in the second hidden layer, 7
output units (representing the macaw cub body parts
categories). The hyperbolic tangent activation function
was selected for the hidden layers, and the sigmoid ac-
tivation was selected for the output layer.
For constituting the training set, the PV-RNN
model generated during 200 time steps each behavior
primitive from the prior distribution. Since the initial
position was the same for all generations (the center of
the workspace), the ﬁrst 20 generation steps were dis-
carded, in order to ensure the eﬀector position entered
the limit cycle attractor of each primitive, consequently,
the training sequences had 180 time steps.
The test set was constituted with data captured
from the human. The subject was instructed to manip-
ulate the mouse to generate in VCBot the primitives,
provided a visual guide on the dataset (data was plotted
in watermark color in the workspace). The confusion
12 Hendry F Chame†et al.
matrix is presented in Table 3. As noticed, classiﬁca-
tions were reasonably accurate for the test set.
0 500 1000 1500 2000
Tim e in m s
Beak
Head
Eye
Neck
Right-wing
Belly
Left-wing
Body-part
Actor
Hum an
Robot
Observer classiﬁcation
Fig. 8: The scatter plot presents the intended action
from the human and the robot actors, as evaluated by
the observer. The human intervened a total of 8 times
to inﬂuence the robot behavior, which is also illustrated
in Fig. 7 and self-reported in Table 2.
Table 3: Testing set confusion matrix
Eye Head Beak Neck Rwing Belly Lwing
Eye 1.000 0.000 0.000 0.000 0.000 0.000 0.000
Head 0.000 1.000 0.000 0.000 0.000 0.000 0.000
Beak 0.000 0.000 1.000 0.000 0.000 0.000 0.000
Neck 0.000 0.000 0.000 0.976 0.000 0.000 0.024
Rwing 0.000 0.000 0.000 0.000 1.000 0.000 0.000
Belly 0.000 0.000 0.000 0.000 0.000 1.000 0.000
Lwing 0.000 0.000 0.000 0.000 0.000 0.006 0.994
Figure 8 presents the automatic regression ob-
server’s performance for the experimental data. A ﬁrst
aspect to be noticed is that classiﬁcation for the human
intention is available only during the events illustrated
in Fig. 1 and self-reported in Table 2, whereas data
is available from the robot throughout the whole ex-
periment (except for the ﬁrst 5 time steps, given the
size of the temporal buﬀer window). Although the in-
teraction was subject to stochasticity from the human
motions and possible incongruence between the human
and the robot intentions, temporally correlated clas-
siﬁcations for the human actions are observed around
a main category and adjacent neighbors, which sug-
gests the human likely focused on particular parts of
the bird’s body during the interaction events.
In order to estimate the probability of intention con-
gruence for an interaction episode i, the binomial vari-
able ct ∈[0,1] is deﬁned from the human ψhuman and
the robot ψrobot intended actions in the time interval
[s−ti,ti], so that
ct = f
(
ψhuman
[s−ti,ti],ψrobot
[s−ti,ti]
)
, (1)
where ti is the last time step of the episode, and
f
(
ψhuman
[s−t,t] ,ψrobot
[s−t,t]
)
=
{
1 if O
(
ψhuman
[s−t,t]
)
= O
(
ψrobot
[s−t,t]
)
,
0 otherwise
(2)
given the observer’s classiﬁcation functionO
(
ψ∗
[s−t,t]
)
.
The probability of intentional congruence for the
event i at time t is deﬁned such that
P
(
Ci
t|ψhuman,ψrobot)
= 1
Y
j=t∑
j=Y −t
ct, (3)
where Y acts as a low pass ﬁlter to reduce classiﬁcation
errors due to instantaneous observation noise.
Figure 9 presents the time evolution of the proba-
bility of intention congruence, grouped by interaction
events. As noticed, for some events congruence was ob-
served earlier in the interaction (e.g. the events 1,3,6,7),
so the human was perhaps not too sensitive to feedback
from the robot and persisted longer than required to
induce intention switching. On the other hand, in the
5th event, although the probability of intention congru-
ence was not very high by end of the event (it was esti-
mated to be 0.5), once the human ceased to intervene
around the time step 1200 (see Fig 8), it is clear that
the robot switched to the human-self reported intention
(see Table 2), so the human was perhaps more sensitive
to feedback from the robot in this event. Finally, the
events 4 and 8 were mostly characterized by intention
incongruence.
5 Perspectives for human science
The previous sections have presented the foundations
and the proposal of a methodological resource for study-
ing human-robot interaction, through the modeling of
neural cognitive control, from artiﬁcial recurrent neural
networks. An experiment was described where a human
subject interacted with a virtual Cartesian robot via the
Towards hybrid primary intersubjectivity: a neural robotics library for human science 13
0
1Event 8
0
1Event 7
0
1Event 6
0
1Event 5
0
1Event 4
0
1Event 3
0
1Event 2
0.0 0.2 0.4 0.6 0.8 1.0
Normalized time
0
1Event 1
Time evolution of P
(
Ci
t|ψhuman,ψrobot)
Fig. 9: The time dimension (horizontal axis) is normal-
ized for the interaction events for comparisons. The ver-
tical axis shows the probability of intentional congru-
ence (see Eq. 3), with Y = 10 time steps.
computer mouse, in order to illustrate the potentiali-
ties of our approach. In this section, we argue on pos-
sible implications and perspectives for human science
research. Notably, we focus on the ﬁelds of develop-
mental psychology, education technology, and cognitive
rehabilitation.
5.1 Developmental psychology
The introduction section has contextualized our re-
search interests in the domain of enactivist social cogni-
tion. Notably, in the study of primary intersubjectivity.
Thus, we have been inspired by Trevarthen’s inﬂuential
work where maternal-infant interactions were recorded
and analyzed (Trevarthen [36]). The work constituted
a fundamental criticism to theory of a mind accounts
of social cognition. It described intuitive communica-
tion in dyadic interactions as a shared control situation,
where individuals reciprocally inﬂuence each other.
Although interaction theories of social cognition are
not consensual, there is a shared interest in studying
dyadic interaction as a second person perspective level
of experience, which corresponds to forms of mutual re-
latedness, co-experiencing or intersubjective experienc-
ing through reciprocal interaction. Our research is con-
sistent with such agenda. Hence, as shown in the case
study experiment, the considered scenario is character-
ized by direct interaction, where the human modiﬁed
the body posture of the virtual robot and received vi-
sual feedback on the robot’s motion. Hence, the human
tried to communicate with the robot through corporal
patterns or gestures. We have shown in related studies
with real robots (Chame & Tani [69]) that this relation
can be studied both ways in the physical dimension,
so the human and the robot are able to modify each
other’s body posture.
We have described interaction enactment as the
agent’s capability of taking deliberative action while
conforming or adjusting to the actions induced by the
partner. Consequently, behavior emerges only partly
under the volitional control of the agent. We have pro-
posed to study such dynamics from an interpretation
of FEP theory which is consistent with autopoietic en-
activist social cognition. Consequently, we investigate
perception, cognition, and action as explained by an
hermeneutic circle in dyadic encounters.
Given the context where IT emerged (i.e. oppos-
ing a cognitivist view of social cognition), assumptions
based on knowledge representation and inference have
been criticized when studying primary intersubjectiv-
ity. This is pointed out by Reddy [67] when analyzing
assumptions about the nature and availability of mind
that views early human communication as a process
where the infant infers other’s hidden mental states.
Grounded in FEP theory, our work does not study pri-
mary intersubjectivity as a theory of mind skill. We
have argued that internal representation and predic-
tion are considered in the generative sense, from the or-
ganismic autopoietic self-organization. As pointed out
by Bruineberg & Rietveld [80], perception and action
from anticipatory dynamics and free-energy minimiza-
tion ensure the agent with the capability of maintaining
adaptive sensibility to relevant aﬀordances in a given
context, which would not be about reconstructing the
structural hidden causes of the other’s mind. Hence, the
agent perceives action aﬀordances characterized by in-
tention, and tries to fulﬁll them to make sense in the
interaction by taking motor action.
When analysing Fig. 9, it is possible to notice that
occasionally the human and the robot intentions were
easily synchronized (e.g. in the events 1, 6, and 7 their
intentions became similar early in the interaction inter-
val). Other times, the human persisted for a while be-
fore human-to-robot alternations could take place (e.g.
in the events 2, 3 and 5 the robot changed its inten-
tion according to the human’s intentions). Finally, at
times the human had to adapt to the robot’s intentions,
so robot-to-human alternations were produced (e.g. the
events 4 and 8). These results present some similarities
with respect to situations described in mother-infant in-
teractions (Trevarthen [36]). We believe that, through
the design of human robot experiments of this sort,
14 Hendry F Chame†et al.
it is possible to study diverse aspects of social cogni-
tion, such as the emergence of consensus in intuitive
non-verbal communication. As it was explained in the
methodological description, the robot was not trained
to learn how to shift from the generation of one behav-
ior to another. Such changes resulted from the human
actions on its body, and from its capacity of perceiv-
ing action aﬀordances that make sense in the context
of interaction.
Perhaps an interesting direction of research would
also be studying the developmental aspect of human
primary intersubjectivity skills in human-robot inter-
action with subjective robots. As pointed out by Tor-
res et al. [65], studying interaction is certainly subject
to considerable methodological diﬃculties, so behavior
measures of physical movements are rarely included.
We believe that behavior measures could be comple-
mented with the inclusion of the subjective dimension
of the robot partner, so building more informed psycho-
metric observations on real-time interaction skills. This
can be a relevant perspective for developmental psy-
chology, since most psychometric instruments evaluate
interaction with static objects.
Through the proposal of NRL, our work with neu-
ral agents has described in detail the dynamics of ac-
tion deliberation. It could be argued that our proposal
could have invested some eﬀorts in detailing the dy-
namics of action compliance. This aspect was left out
of scope mainly due to the fact that robotic platforms
are diverse. Furthermore, commonly aﬀordable robots
are designed under classical engineering modeling ap-
proach, including conventional control schemes and ar-
chitectures. Since real-time responsiveness is a funda-
mental aspect, it is somehow problematic proposing a
control model that would run over a virtual abstrac-
tion of the host native platform. Hopefully, in the near
future more bio-inspired robotic structures, capable of
evolving in the phylogenetic sense, would be available
for most research labs.
A ﬁnal aspect to be discussed is that developmen-
tal psychology studies in mother-infant interaction have
reported early behavior patterns as rudimentary, much
distinct from the stylized motions proposed in the case
study outlining the body shape of a macaw cub, which
the artiﬁcial neural model learned. Although it is pos-
sible to model rudimentary behavior in neural agents,
the inclusion of an artistic scenario is perhaps more re-
lated to research perspectives on other ﬁelds in human
science, which is discussed below.
5.2 Dynamics, consensus, and educational technology
According to Ackermann [95], societal convictions on
the meanings of being knowledgeable or intelligent, and
what it takes to become so, drive attitudes and practices
in education. Hence, several theories of learning (e.g.
behaviorism, cognitivism, constructivism, connectivism,
constructionism) have reﬂected those convictions, and
have been central to the contributions of theorists in
education (e.g. Bloom [96], Freire [97], Siemens [98]).
In education theory, we contextualize our work
within the view of constructionism, which consists in a
philosophy of learning through building artifacts in the
world that reﬂect one’s ideas. Undoubtedly, a key inﬂu-
ential initiative in approaching technology to education
took place in the late sixties, and consisted in the inven-
tion of the LOGO programming language in the Mas-
sachusetts Institute of Technology (Papert [99]). The
idea was to include computers in education processes,
so that children learn to communicate with computers
through a mathematical-logical language, in order to
build their own tools and mediations to support their
interest within a given context.
Constructionism has transcended the virtual world
to ground the prototyping of physical agents through
the Lego Mindstorm technology (Martin et al. [100]).
This platform has been extensively used in the interna-
tional educational robotics competition RoboCup, no-
tably, in the Junior league5, which is dedicated to young
scientists mostly enrolled in secondary high-school. The
Mindstorm technology has stimulated an explosion of
other proposals in assemblage robotics kits.
Interesting questions are raised once new technolo-
gies are incorporated into education, in particular, in-
quiring the actual beneﬁts those technologies provide
to distinct academic outcomes. Thus, the aspect of how
educational robotics generalizes to areas which are not
closely related to the ﬁeld of robotics itself has been re-
viewed by Benitti [101]. The review found that most of
the studies (around 80%) explored physics, logic, and
mathematics related topics, which may suggest a low
capacity of absorption to other ﬁelds. Moreover, in the
light of the increasing availability of machine learning
technology (e.g. software libraries, and computational
gadgets), one might question the extent to which the
complexity of such technology is actually realized by
the children. So in practice sophisticated automation
prototypes are not simply the result of putting together
a set of components which are not really understood by
the student (i.e. at the modest cognitive cost of con-
necting black-box modules).
5 https://www.robocup.org
Towards hybrid primary intersubjectivity: a neural robotics library for human science 15
Our research tries to face the above criticism in-
spired by eﬀorts in describing the development of cog-
nition and action from a dynamic system theory per-
spective (e.g. in Thelen & Smith [102]). Hence, by fo-
cusing not only in observing how a given behavior is
manifested, but on describing it as a pattern of change
over time, and how such change can result from the in-
teraction of multiple subsystems within the individual,
the task, and the environment; we hope to be contribut-
ing to a reﬂection on phenomenon which transcends a
linear logical causality understanding, to an hermeneu-
tical description of causality that takes place with the
self immersion in a feedback loop, so bringing to the
foreground the notions of time, intention, stochasticity,
and interaction, to a regularly perceived static world.
Perhaps the view of a non-interactive world is still
deeply rooted in our society. Arts has provided us with
a criticism on the static world view, though forms of ex-
pressions such as the abstract expressionist movement.
Hence, the painting technique known as action painting
(Rosenberg [103]) reﬂects the physical act of painting
itself, so the work is more the unfolding of an event that
a picture. Here, artists employ the forces and momen-
tum generated by their body to paint (an inﬂuential
exponent in this current is Jackson Pollock, some of his
works are Mural and Lucifer).
Returning to constructionism, we believe the mod-
eling of subjective robots, with which communication
takes place through negotiation in shared behavior con-
trol, would enrich and extend the interaction scenario
envisaged by Papert’s seminal ideas. Hence, by keeping
in mind the principles of roboethics (Tzafestas [104]),
robots could be conceived as systems capable of inten-
tion. We hope this sort of synthetic agent would become
relevant to other ﬁelds of knowledge, beyond educa-
tional technology, an example is rehabilitation learning
which is discussed next.
5.3 Cognitive rehabilitation and motivation
According to Sohlberg & Mateer [105], the term cog-
nitive rehabilitation follows short when focusing on the
aspect of remediation or compensation for decreased
cognitive abilities, so the term rehabilitation of individ-
uals with cognitive impairment would emphasize more
precisely injured individuals (i.e. acquired brain injury,
and traumatic brain injury) that are and will continue
to be the target of cognitive rehabilitation. In this sense,
although a fundamental goal for treatment is improv-
ing and compensating cognitive abilities, a larger scope
including consequences for the personal, emotional, mo-
tivational, and social dimensions of the brain injury, has
been incorporated into treatment plans.
Several evidence-based reviews have been conducted
with post-stroke cognitive rehabilitation treatment for
speciﬁc cognitive impairments, and concluded that al-
though there are some evidence in support, the eﬀec-
tiveness of treatments has yet to be established (e.g.
memory deﬁcits in das Nair [106], executive dysfunc-
tion in Chung et al. [107], and attention deﬁcits in
Loetscher et al. [108]). Recently, a work by Maier et al.
[109] has proposed virtual reality as a methodology for
designing a rehabilitation program in several cognitive
domains conjointly, as an alternative to treating cog-
nitive domains in isolation. Along this line, we believe
an interesting perspective to follow consists in explor-
ing rehabilitation tasks based on shared control. Our
results with VCBot have illustrated the methodological
possibility of such integration.
Regarding real robots, the study of Gassert & Di-
etz [2], proposes a classiﬁcation for robotic rehabili-
tation platforms into: grounded exoskeletons, grounded
end-eﬀector devices , and wearable exoskeletons. These
devices are torque-controlled which allows design-
ing diverse interaction tasks involving passive, active-
assisted, and active-resisted movements, depending on
the treatment goals and the patient’s level of impair-
ment. As discussed in Chame & Tani [69], when con-
sidering simultaneous deliberation and adjustment, it
is also possible to proﬁle interaction styles from the
robot’s capacity of taking purposeful actions, while ac-
commodating to the human’s intentions. These charac-
teristics could enrich the availability of task repertories.
In this way, neural cognitive control could become an
interesting resource for rehabilitation treatments.
A study by Gorˇ siˇ c et al. [110] has explored the ben-
eﬁts of treatments based on interaction, and suggested
that playing competitive games with a non-impaired
partner has the potential of leading to functional im-
provement, when compared to conventional exercising,
through an increase in motivation and exercising in-
tensity. The study found a less pronounced eﬀect in
cooperative games but a positive eﬀect on motivation.
Although it is likely that the presence of a human part-
ner plays a role in motivation, in the study it is re-
ported that some subjects preferred to exercise alone.
Perhaps a promising line of research would be explor-
ing whether the fact of intersubjective interaction with
a robotic partner would lead to higher life quality of
subjects, notably, for participants that opted for not
interacting with human partners.
Diverse additional studies could be discussed for
analysing possible ways neural robotics, capable of ac-
tive inference, could play a role in rehabilitation. By
linking this section with the previous one, we would
like to argue the relevance of constructionism as po-
16 Hendry F Chame†et al.
tentially contributing to intrinsically motivated engage-
ment of patients in planning, designing tools, and se-
lecting goals. The treatment could also beneﬁt from ob-
serving patient’s motivation dynamics (e.g. Chame et
al. [111]), so a conjoint planning of the treatment be-
tween the patient and the therapist is done.
6 Conclusions
This work started from the interest in exploring pos-
sible ways neural robots can contribute to advancing
the state of the art in human science. For this, our re-
search was contextualized within the ﬁeld of enactivist
social cognition, notably, in the study of control shar-
ing in dyadic interaction, taking place in primary in-
tersubjective communication. We proposed a method-
ological tool for prototyping robotics agents, modeled
from free energy principle theory. Through the proposal
of a demonstration program for interacting, we have
shown the potentialities of our methodology for real-
time human-robot interaction experiments. Finally, we
discussed three main perspectives for human science.
Firstly, we have argued for the inclusion of neural
robotics as a resource for investigating embodied so-
cial cognition in developmental psychology. Secondly,
we have discussed how our proposal is related to the
theory of constructionism in education, by contributing
to move from the learning of linear logical causality, to
a circular understanding of causality that takes place in
the subject immersion in a feedback loop when build-
ing and interacting with neural robots. Finally, we have
argued on the relevance of neural robots for the ﬁeld of
cognitive rehabilitation, and how shared control inter-
active tasks could complement both treatment method-
ologies based on physical and virtual environments.
Acknowledgments
This project was fully funded by the Okinawa Insti-
tute of Science and Technology Graduate University
(OIST), and developed in the Cognitive Neurorobotics
Research Unit (CNRU), which is located in 1919-1,
Tancha, Onna, Kunigami District, Okinawa 904-0495.
Appendixes
The following sections provide the mathematical details of PV-
RNN architectures for the sake of self containment. The reader
is invited to consult the work by Ahmadi & Tani [58] for more
details. In PV-RNN two information processes are involved.
The generative process follows a top-down information ﬂow.
It is in charge of anticipating the sensory state xt at time t
from prior hidden latent representations Pφ within the network
context ct. On the other side, the inference process involves
latent posterior distributions Qπ. It consists in a bottom-up
computation ﬂow, where the surprise signal is back propagated
through time (BPTT) in the network hierarchy, within a sliding
temporal window st. Algorithm 1 describes how deliberation
control is achieved in the neural robot. The minimization of free
energy is equivalent to the maximization of sensory evidence
lower bound (ELBO).
Algorithm 1Deliberation control
procedure doInteraction
t← 0
ct,xt,st ← initialize()
while t≤Texperiment do
t← t+ 1
xt ← doGeneration(Pφ, ct)
doMotorControl(xt)
if t>S size then
st ← [s2:Ssize ,xt]
ct+1 ← doInference
(
Qπ,st,ct−Ssize ,Ssize)
else
st ← [s1:t,xt]
procedure doInference(Qπ,sy,c,n )
ELBO ← initialize()
for e← 1,Nepochs do
sx,sc ← doGeneration(Qπ, c,n)
ELBO ← doBPTT(sx,sy,sc)
← sc
t
The generative model
Layer 2
(slow context layer)
Layer 1
(fast context layer)
Output
xt−1 xt xt+1
d1
t−1 d1
t d1
t+1
z1
t−1 z1
t z1
t+1
d2
t−1 d2
t d2
t+1
z2
t−1 z2
t z2
t+1
Fig. 10: Graph representation for the generative model
of the PV-RNN framework (Ahmadi & Tani [58]) in a
MTRNN setting (Yamashita & Tani [57]). A two-level
layer hierarchy is shown for illustration.
Towards hybrid primary intersubjectivity: a neural robotics library for human science 17
The Generative model
Let6 the generative model Pφ be deﬁned from the parameters
φ, distributed among the components: generated prediction x,
stochastic z and the deterministic d latent states. Given the
generative model of PV-RNN (see Fig. 10), for a prediction
x1:T = (x1,x2,...,xT), and considering the parameters φx, φz,
and φd, Pφ factorizes such that:
Pφ(x1:T,z1:T,d1:T|z0,d0) =
T∏
t=1
Pφx (xt|dt) Pφz (zt|dt−1) Pφd (dt|dt−1,zt) (4)
Let the deterministic states be deﬁned according to a
MTRNN structure (Yamashita & Tani [57]). For the kth con-
text layer at time t, with timescale ιk, the internal dynamics
are represented such that
hk
t =
(
1 − 1
ιk
)
hk
t−1 + 1
ιk
(
Wkk
dh dk
t−1 + Wkk−1
dh dk−1
t−1 +
Wkk+1
dh dk+1
t−1 + Wkk
zh zk
t + bk
h
)
,
(5)
dk
t = tanh
(
hk
t
)
. (6)
The prior distribution Pφz (zt|dt−1) is modeled as a Gaus-
sian with diagonal covariance matrix, such that
Pφz (zt|dt−1) = N(zt; µp
t,σp
t) , (7)
where µp
t and σp
t are, respectively, the mean and standard de-
viation of zt = µp
t + σp
t ∗ϵ, with ϵsampled from N(0,1). The
variables [µp
t,log ( σp
t)] = fφz(dt−1) are obtained with fφz(.)
the one layer feed-forward neural network, such that
up,k
t = Wp,kk
dµ dk
t−1 + bp,k
µ , (8)
µp,k
t = tanh
(
up,k
t
)
, (9)
log
(
σp,k
t
)
= Wp,kk
dσ dk
t−1 + bp,k
σ . (10)
The inference model
Let the inference model Qπ (the approximate posterior) be de-
ﬁned from the parameters π, such that
Qπ(zt|dt−1,et:T) = N(zt; µq
t,σq
t) , (11)
6 Notation: layer’s latent states are denoted bold low-case,
biases are denoted b, weight connections are denoted W with
subscripts indicating the origin and destination of the connec-
tion (e.g., Wzd are the weights connecting z to d units). Super-
scripts k∈{1,...,K}indicate from low to high, the layer’s level
in the MTRNN hierarchy. Finally, the superscripts p and q are
used to distinguish between variables that belong to the prior
and posterior distributions, respectively.
where µq
t and σq
t are, respectively, the mean and standard de-
viation of zt = µq
t + σq
t ∗ϵ, with ϵsampled from N(0,1). The
variables [µq
t,log (σq
t)] = fπz(dt−1,a¯ x) are obtained withfπz(.)
the one layer feed-forward neural network, such that
uq,k
t = Wq,kk
dµ dk
t−1 + a¯ x,k
µ,t + bq,k
µ , (12)
µq,k
t = tanh
(
uq,k
t
)
, (13)
log
(
σq,k
t
)
= Wq,kk
dσ dk
t−1 + a¯ x,k
σ,t + bq,k
σ . (14)
The parameters a¯ x,k
1:T are introduced to provide the net-
work with information about the prediction error in relation
to a given pattern ¯x. Thus, a¯ x,k
1:T is changed back propagating
through time the prediction error et:T, so information about
the future steps of ¯ xt:T, and existing dependencies with the
current time step t, are captured such that
a¯ x,k
µ,t = a¯ x,k
µ,t + α ∂L
∂a¯ x,k
µ,t
, (15)
a¯ x,k
σ,t = a¯ x,k
σ,t + α ∂L
∂a¯ x,k
σ,t
, (16)
with α denoting the learning rate.
Let the Variational Evidence Lower Bound (ELBO)L(φ,π)
be deﬁned by
L(φ,π) =
T∑
t=1
(1
nx
Eqπ
[
log
(
xt|˜dt,zt
)]
−
w
nz
KL
[
Qπ
(
zt|˜dt−1,et:T
)
∥Pφz
(
zt|˜dt−1
)])
.
(17)
Here, nx is the number of degrees of freedom of the robot,
and nz is the total number of z units considering all layers.
Since dt is deterministic given dt−1 and zt, ˜dt denotes the
center of a Dirac distribution. The ﬁrst term at the right of
the equation is a reconstruction component, it corresponds to
the expected log-likelihood under the posterior distribution Qπ.
The second therm is a regulation component, it corresponds to
the Kullback-Leibler (KL) divergence between the prior and
the posterior distributions of the latent variables. The meta-
parameter w adjusts the optimization weight in learning the
posterior and the prior distributions. Given that the prior and
posterior distributions are Gaussian and after dropping the ran-
dom variable notation to improve readability, the KL compo-
nent can be expressed as
KL [Qπ∥Pφz] = log
(σp
σq
)
+ (µp −µq)2 + (σq)2
2 (σp)2 −1
2. (18)
Finally, the ith output dimension of the cognitive control
space is obtained from the one layer feed-forward propagation
of the di,t units, such that
oi,t = Wdxid1
t + bxi. (19)
18 Hendry F Chame†et al.
Unlike in Ahmadi & Tani [58], in this work it is not included
in oi,t connections from the stochastic latent distributions at
the Low level, in order to reduce the computational complexity.
Hence, the output xi,t is such that
xi,t = softmax (oi,t) . (20)
Free energy is optimized for distinct purposes during the
phases training and experiment (see Fig. 2). The agent is
trained for behavior acquisition in a supervised manner on the
behavior primitives. Data can be obtained analytically from
mathematically modeling behavior, or captured from direct in-
teraction (e.g. by kinesthetic teaching). Variational models are
better at generalizing when compared to deterministic frame-
works, so it is not necessary to collect numerous samples on the
desired behavior. During the modeling phase, the model’s meta-
parameters are selected to modulate stochasticity (see Table 1),
resulting in a higher capability of generalization. Free energy
optimization in the training phase involves the oﬀ-line modi-
ﬁcation of parameters including synaptic weights, biases, and
state variables. Contrarily, the experiment phase is character-
ized by on-line inference, where only state variables within the
temporal sliding window are optimized (see Fig. 1). The objec-
tive of free-energy optimization during experiment is to allow
the agent to perceive action aﬀordances in intentional interac-
tion, through changes in the overall PV-RNN latent state. Next,
the model gradients for the BPTT algorithm are provided.
BPTT gradients
In this section the back propagation trough time gradients are
provided. The variable change ρ = log( σ) is proposed to im-
prove readability. By applying the derivation chain rule, the
gradients are computed from Eq. (17), such as:
∂Li,t
∂oi,t
= 1
nx
(xi,t −¯xi,t) , (21)
∂Lt
∂dk
i,t−1
=
∑
s
∂Lt
∂os,t−1
∂os,t−1
∂dk
i,t−1
+
∑
j
∂Lt
∂hk
j,t
∂hk
j,t
∂dk
i,t−1
+
∑
y
∂Lt
∂hk−1
y,t
∂hk−1
y,t
∂dk
i,t−1
+
∑
r
∂Li,t
∂hk+1
r,t
∂hk+1
r,t
∂dk
i,t−1
+
∑
m
∂Lt
∂µp,k
m,t
∂µp,k
m,t
∂dk
i,t−1
+
∑
m
∂Lt
∂ρp,k
m,t
∂ρp,k
m,t
∂dk
i,t−1
+
∑
m
∂Lt
∂µq,k
m,t
∂µq,k
m,t
∂dk
i,t−1
+
∑
m
∂Lt
∂ρq,k
m,t
∂ρq,k
m,t
∂dk
i,t−1
. (22)
The terms involving other levels of the hierarchy are set
to zero when not deﬁned (i.e. in the case of level k+ 1 in the
highest layer or the level k−1 in the lowest layer). Likewise,
the gradient below is only deﬁned for k= 1
∂os,t−1
∂dk
i,t−1
= Wkk
dxs,i, (23)
∂Lt
∂hk
i,t−1
= ∂Lt
∂dk
i,t−1
∂dk
i,t−1
∂hk
i,t−1
+ ∂Lt
∂hk
i,t
∂hk
i,t
∂hk
i,t−1
, (24)
∂dk
i,t−1
∂hk
i,t−1
= 1 −tanh2(hk
i,t), (25)
∂hk
i,t
∂hk
i,t−1
= 1 − 1
ιk, (26)
∂hk
j,t
∂dk
i,t−1
= 1
ιkWkk
hdj,i, (27)
∂hk−1
y,t
∂dk
i,t−1
= 1
ιk−1 Wkk−1
dhy,i
, (28)
∂hk+1
r,t
∂dk
i,t−1
= 1
ιk+1 Wkk+1
dhr,i
, (29)
∂Lt
∂µp,k
m,t
= wk
nz
(
µp,k
m,t −µq,k
m,t
(σp,k
m,t)2
)
, (30)
∂µ
p,k
m,t
∂dk
i,t−1
=
(
1 −tanh2 (
up,k
m,t
))
Wkk
µpdm,i, (31)
∂Lt
∂ρp,k
m,t
= wk
nz

1 −
((
µq,k
m,t −µp,k
m,t
)2
+
(
σq,k
m,t
)2
)
(
σp,k
m,t
)2
(
, (32)
∂ρp,k
m,t
∂dk
i,t−1
= Wkk
σpdm,i, (33)
∂Lt
∂µq,k
m,t
= ∂Lt
∂zq,k
m,t
+ 1
nz
µq,k
m,t −µp,k
i,t
(
σp,k
m,t
)2 , (34)
∂Lt
∂zq,k
m,t
=
∑
j
∂Lt
∂hk
m,t
(1
ιkWkk
zhm,i
)
, (35)
∂µ
q,k
m,t
∂dk
i,t−1
=
(
1 −tanh2 (
uq,k
m,t
))
Wkk
µqdm,i, (36)
∂Lt
∂ρq,k
m,t
= ∂Lt
∂zq,k
m,t
ϵq,k
m,tσq,k
m,t + wk
nz
(
−1 +
(σq,k
m,t)2
(σp,k
m,t)2
)
, (37)
∂ρq,k
m,t
∂dk
i,t−1
= Wkk
σqdm,i, (38)
∂Lt
a¯ x,k
µi,t
=
(
1 −tanh2 (
uq,k
i,t
))∂Lt
∂µq,k
i,t
, (39)
Towards hybrid primary intersubjectivity: a neural robotics library for human science 19
∂Lt
a¯ x,k
σi,t
= ∂Lt
∂ρq,k
i,t
. (40)
The synaptic weights and biases are updated such that
∂Lt
∂Wkk
dhi,j
=
∑
t
1
ιkdk
j,t−1
∂Lt
∂hk
i,t
(41)
∂Lt
∂bk
hi
=
∑
t
1
ιk
∂Lt
∂hk
i,t
(42)
∂Lt
∂Wkk−1
dhi,j
=
∑
t
1
ιkdk−1
j,t−1
∂Lt
∂hk
i,t
(43)
∂Lt
∂Wkk+1
dhi,j
=
∑
t
1
ιkdk+1
j,t−1
∂Lt
∂hk
i,t
(44)
∂Lt
∂Wp,kk
zhi,j
=
∑
t
1
ιkzk
j,t
∂Lt
∂hk
i,t
(45)
∂Lt
∂Wkk
dµpi,j
=
∑
t
(
1 −tanh2 (
up,k
i,t
))
dk
j,t−1
∂Lt
∂µp,k
i,t
(46)
∂Lt
∂bp,k
µi
=
∑
t
(
1 −tanh2 (
up,k
i,t
))∂Lt
∂µp,k
i,t
, (47)
∂Lt
∂Wp,kk
dσpi,j
=
∑
t
dk
j,t−1
∂Lt
∂ρp,k
i,t
, (48)
∂Lt
∂bp,k
σi
=
∑
t
∂Lt
∂ρp,k
i,t
. (49)
The gradients ∂Lt
∂Wp,kk
dµi,j
, ∂Lt
∂bq,k
µi
, ∂Lt
∂Wq,kk
dσi,j
, and ∂Lt
∂bq,k
σi
are com-
puted, analogous to Eqs. (46), (47), (48), and (49).
References
1. A. Granulo, C. Fuchs, and S. Puntoni, “Psychological re-
actions to human versus robotic job replacement,” Nature
human behaviour, vol. 3, no. 10, pp. 1062–1069, 2019.
2. R. Gassert and V. Dietz, “Rehabilitation robots for the
treatment of sensorimotor deﬁcits: a neurophysiological
perspective,” Journal of neuroengineering and rehabilita-
tion, vol. 15, no. 1, p. 46, 2018.
3. B. Robins, K. Dautenhahn, R. Te Boekhorst, and A. Bil-
lard, “Robotic assistants in therapy and education of chil-
dren with autism: can a small humanoid robot help en-
courage social interaction skills?,” Universal Access in the
Information Society, vol. 4, no. 2, pp. 105–120, 2005.
4. B. Scassellati, H. Admoni, and M. Matari´ c, “Robots for
use in autism research,” Annual review of biomedical en-
gineering, vol. 14, pp. 275–294, 2012.
5. L. I. Ismail, T. Verhoeven, J. Dambre, and F. Wyﬀels,
“Leveraging robotics research for children with autism: a
review,” International Journal of Social Robotics , vol. 11,
no. 3, pp. 389–410, 2019.
6. S. Atmatzidou and S. Demetriadis, “Advancing stu-
dents’ computational thinking skills through educational
robotics: A study on age and gender relevant diﬀerences,”
Robotics and Autonomous Systems , vol. 75, pp. 661–670,
2016.
7. M. C. Di Lieto, E. Castro, C. Pecini, E. Inguaggiato,
F. Cecchi, P. Dario, G. Cioni, and G. Sgandurra Fron-
tiers in Psychology , vol. 10, p. 2813, 2020.
8. H. Kose-Bagci, E. Ferrari, K. Dautenhahn, D. S. Syrdal,
and C. L. Nehaniv, “Eﬀects of embodiment and gestures
on social interaction in drumming games with a humanoid
robot,” Advanced Robotics, vol. 23, no. 14, pp. 1951–1996,
2009.
9. S. Atmatzidou, S. Demetriadis, and P. Nika, “How does
the degree of guidance support students’ metacognitive
and problem solving skills in educational robotics?,”Jour-
nal of Science Education and Technology , vol. 27, no. 1,
pp. 70–85, 2018.
10. A. Cangelosi and M. Schlesinger, Developmental robotics:
From babies to robots. MIT press, 2015.
11. M. Asada, K. Hosoda, Y. Kuniyoshi, H. Ishiguro, T. Inui,
Y. Yoshikawa, M. Ogino, and C. Yoshida, “Cognitive de-
velopmental robotics: A survey,” IEEE transactions on
autonomous mental development , vol. 1, no. 1, pp. 12–34,
2009.
12. Y. Kuniyoshi, Y. Yorozu, Y. Ohmura, K. Terada,
T. Otani, A. Nagakubo, and T. Yamamoto, “From hu-
manoid embodiment to theory of mind,” in Embodied ar-
tiﬁcial intelligence , pp. 202–218, Springer, 2004.
13. J. Tani, Exploring robotic minds: actions, symbols, and
consciousness as self-organizing dynamic phenomena. Ox-
ford University Press, 2016.
14. J. Tani, “Learning to generate articulated behavior
through the bottom-up and the top-down interaction pro-
cesses,” Neural Networks, vol. 16, no. 1, pp. 11–23, 2003.
15. S. Murata, J. Namikawa, H. Arie, S. Sugano, and J. Tani,
“Learning to reproduce ﬂuctuating time series by inferring
their time-dependent stochastic properties: Application in
robot learning via tutoring,” IEEE Transactions on Au-
tonomous Mental Development, vol. 5, no. 4, pp. 298–310,
2013.
16. M. Jung, T. Matsumoto, and J. Tani, “Goal-directed be-
havior under variational predictive coding: Dynamic orga-
nization of visual attention and working memory,” arXiv
preprint arXiv:1903.04932, 2019.
17. J. Hwang, J. Kim, A. Ahmadi, M. Choi, and J. Tani,
“Dealing with large-scale spatio-temporal patterns in im-
itative interaction between a robot and a human by using
the predictive coding framework,” IEEE Transactions on
Systems, Man, and Cybernetics: Systems , 2018.
18. W. Ohata and J. Tani, “Investigation of multimodal and
agential interactions in human-robot imitation, based on
frameworks of predictive coding and active inference,”
arXiv preprint arXiv:2002.01632 , 2020.
19. E. Husserl, Cartesian meditations: An introduction to phe-
nomenology. Springer Science & Business Media, 2013.
20. M. Heidegger, J. Macquarrie, and E. Robinson, “Being
and time,” 1962.
21. M. Merleau-Ponty, Phenomenology of perception. Motilal
Banarsidass Publishe, 1996.
22. J. Habermas and T. McCarthy, The theory of communica-
tive action, vol. 1. Beacon Press, 1984.
20 Hendry F Chame†et al.
23. T. Fuchs, “The phenomenology and development of social
perspectives,” Phenomenology and the Cognitive Sciences,
vol. 12, no. 4, pp. 655–683, 2013.
24. S. Gallagher, “The practice of mind. theory, simulation or
primary interaction?,” Journal of Consciousness Studies ,
vol. 8, no. 5-6, pp. 83–108, 2001.
25. A. Newen, The Oxford Handbook of 4E Cognition, ch. The
Person Model Theory and the Question of Situatedness of
Social Understanding. Oxford University Press, 2018.
26. D. Premack and G. Woodruﬀ, “Does the chimpanzee have
a theory of mind?,” p. 515–526, 1978.
27. H. M. Wellman, The child’s theory of mind. The MIT
Press, 1992.
28. A. Gopnik and L. Schulz, “Mechanisms of theory for-
mation in young children,” Trends in cognitive sciences ,
vol. 8, no. 8, pp. 371–377, 2004.
29. A. M. Leslie, “Pretense and representation: The origins
of” theory of mind. ”,”Psychological review, vol. 94, no. 4,
p. 412, 1987.
30. V. Gallese and A. Goldman, “Mirror neurons and the sim-
ulation theory of mind-reading,” Trends in cognitive sci-
ences, vol. 2, no. 12, pp. 493–501, 1998.
31. G. Rizzolatti and L. Fogassi, “The mirror mechanism:
recent ﬁndings and perspectives,” Philosophical Transac-
tions of the Royal Society B: Biological Sciences , vol. 369,
no. 1644, p. 20130420, 2014.
32. M. Davies and T. Stone, Mental Simulation: Evaluations
and Applications-Reading in Mind and Language. Oxford:
Blackwell, 1995.
33. A. I. Goldman, Simulating minds: The philosophy, psy-
chology, and neuroscience of mindreading . Oxford Uni-
versity Press, 2006.
34. S. Gallagher, “Understanding others: embodied social cog-
nition,” in Handbook of cognitive science, pp. 437–452, El-
sevier, 2008.
35. S. Spaulding, “Introduction to debates on embodied social
cognition,” Phenomenology and the Cognitive Sciences ,
vol. 11, no. 4, pp. 431–448, 2012.
36. C. Trevarthen, “Communication and cooperation in early
infancy: A description of primary intersubjectivity,” Be-
fore speech: The beginning of interpersonal communica-
tion, vol. 1, pp. 530–571, 1979.
37. P. Rochat and C. Passos-Ferreira, From Imitation to Re-
ciprocation and Mutual Recognition, pp. 191–212. Totowa,
NJ: Humana Press, 2009.
38. A. Newen, L. Bruin, and S. Gallagher, The Oxford Hand-
book of 4E Cognition, ch. 4E Cognition: Historical Roots,
Key Concepts and Central Issues. Oxford University
Press, 2018.
39. H. De Jaegher and E. Di Paolo, “Participatory sense-
making,” Phenomenology and the cognitive sciences ,
vol. 6, no. 4, pp. 485–507, 2007.
40. V. Reddy, How infants know minds . Harvard University
Press, 2010.
41. T. Schlicht, The Oxford Handbook of 4E Cognition ,
ch. Critical Note: Cognitive Systems and the Dynamics
of Representing-in-the-World. Oxford University Press,
2018.
42. M. Auvray, C. Lenay, and J. Stewart, “Perceptual inter-
actions in a minimalist virtual environment,” New ideas
in psychology, vol. 27, no. 1, pp. 32–47, 2009.
43. T. Froese and T. Ziemke, “Enactive artiﬁcial intelligence:
Investigating the systemic organization of life and mind,”
Artiﬁcial Intelligence, vol. 173, no. 3-4, pp. 466–500, 2009.
44. C. Lenay and J. Stewart, “Minimalist approach to per-
ceptual interactions,” Frontiers in Human Neuroscience ,
vol. 6, p. 98, 2012.
45. T. Froese, H. Iizuka, and T. Ikegami, “Embodied social in-
teraction constitutes social cognition in pairs of humans: a
minimalist virtual reality experiment,” Scientiﬁc reports,
vol. 4, p. 3672, 2014.
46. S. Gallagher and M. Allen, “Active inference, enac-
tivism and the hermeneutics of social cognition,” Syn-
these, vol. 195, no. 6, pp. 2627–2648, 2018.
47. J. Hohwy, The predictive mind. Oxford University Press,
2013.
48. M. D. Kirchhoﬀ, “Autopoiesis, free energy, and the
life–mind continuity thesis,” Synthese, vol. 195, no. 6,
pp. 2519–2540, 2018.
49. M. D. Kirchhoﬀ, The Oxford Handbook of 4E Cognition ,
ch. The Body in Action: Predictive Processing and the
Embodiment Thesis. Oxford University Press, 2018.
50. K. Friston, P. Schwartenbeck, T. FitzGerald, M. Moutous-
sis, T. Behrens, and R. J. Dolan, “The anatomy of choice:
active inference and agency,” Frontiers in human neuro-
science, vol. 7, p. 598, 2013.
51. M. Allen and K. J. Friston, “From cognitivism to au-
topoiesis: towards a computational framework for the em-
bodied mind,” Synthese, vol. 195, no. 6, pp. 2459–2482,
2018.
52. M. B. Mathur and D. B. Reichling, “Navigating a social
world with robot partners: A quantitative cartography of
the uncanny valley,”Cognition, vol. 146, pp. 22–32, 2016.
53. J. Hawkins and S. Blakeslee, On intelligence: How a new
understanding of the brain will lead to the creation of truly
intelligent machines . Macmillan, 2007.
54. W. J. Freeman, Societies of brains: A study in the neuro-
science of love and hate . Psychology Press, 2014.
55. S. Ishii, M. Diesmann, and K. Doya, “Multi-scale, multi-
modal neural modeling and simulation,” Neural networks,
vol. 24, no. 9, 2011.
56. R. D. Beer, “On the dynamics of small continuous-time re-
current neural networks,”Adaptive Behavior, vol. 3, no. 4,
pp. 469–509, 1995.
57. Y. Yamashita and J. Tani, “Emergence of functional hi-
erarchy in a multiple timescale neural network model: a
humanoid robot experiment,” PLoS computational biol-
ogy, vol. 4, no. 11, 2008.
58. A. Ahmadi and J. Tani, “A novel predictive-coding-
inspired variational rnn model for online prediction
and recognition,” Neural computation , vol. 31, no. 11,
pp. 2025–2074, 2019.
59. S. Van de Cruys, K. Evers, R. Van der Hallen,
L. Van Eylen, B. Boets, L. de Wit, and J. Wagemans,
“Precise minds in uncertain worlds: Predictive coding in
autism.,” Psychological review , vol. 121, no. 4, p. 649,
2014.
60. J. Hohwy and C. Palmer, “Social cognition as causal in-
ference: Implications for common knowledge and autism,”
in Perspectives on social ontology and social cognition ,
pp. 167–189, Springer, 2014.
61. R. P. Lawson, G. Rees, and K. J. Friston, “An aberrant
precision account of autism,” Frontiers in human neuro-
science, vol. 8, p. 302, 2014.
62. K. Friston and C. Frith, “A duet for one,” Consciousness
and cognition, vol. 36, pp. 390–405, 2015.
63. K. J. Friston and C. D. Frith, “Active inference, commu-
nication and hermeneutics,” cortex, vol. 68, pp. 129–143,
2015.
64. F. Babiloni and L. Astolﬁ, “Social neuroscience and hy-
perscanning techniques: past, present and future,” Neuro-
science & Biobehavioral Reviews, vol. 44, pp. 76–93, 2014.
65. E. B. Torres, M. Brincker, R. W. Isenhower III,
P. Yanovich, K. A. Stigler, J. I. Nurnberger Jr, D. N.
Towards hybrid primary intersubjectivity: a neural robotics library for human science 21
Metaxas, and J. V. Jos´ e, “Autism: the micro-movement
perspective,” Frontiers in integrative neuroscience, vol. 7,
p. 32, 2013.
66. K. Friston, J. Mattout, and J. Kilner, “Action understand-
ing and active inference,” Biological cybernetics, vol. 104,
no. 1-2, pp. 137–160, 2011.
67. V. Reddy, The Oxford Handbook of 4E Cognition, ch. Why
Engagement? Oxford University Press, 2018.
68. V. Reddy, K. Liebal, K. Hicks, S. Jonnalagadda, and
B. Chintalapuri, “The emergent practice of infant com-
pliance: An exploration in two cultures.,” Developmental
Psychology, vol. 49, no. 9, p. 1754, 2013.
69. H. F. Chame and J. Tani, “Cognitive and motor com-
pliance in intentional human-robot interaction,” arXiv
preprint arXiv:1911.01753v3, 2019.
70. K. Friston, “The free-energy principle: a uniﬁed brain the-
ory?,” Nature reviews neuroscience, vol. 11, no. 2, p. 127,
2010.
71. J. M. Kilner, K. J. Friston, and C. D. Frith, “Predictive
coding: an account of the mirror neuron system,” Cogni-
tive processing, vol. 8, no. 3, pp. 159–166, 2007.
72. J. Koster-Hale and R. Saxe, “Theory of mind: a neural
prediction problem,” Neuron, vol. 79, no. 5, pp. 836–848,
2013.
73. K. J. Friston, J. Daunizeau, J. Kilner, and S. J. Kiebel,
“Action and behavior: a free-energy formulation,” Biolog-
ical cybernetics, vol. 102, no. 3, pp. 227–260, 2010.
74. H. von Helmholtz, Treatise on physiological optics, vol. 3.
Courier Corporation, 2013.
75. J. J. Gibson, The ecological approach to visual perception:
classic edition. Psychology Press, 2014.
76. R. L. Gregory, Concepts and mechanisms of perception.
Charles Scribner’s Sons, 1974.
77. J. Norman, “Two visual systems and two theories of
perception: An attempt to reconcile the constructivist
and ecological approaches,”Behavioral and brain sciences,
vol. 25, no. 1, pp. 73–96, 2002.
78. M. M. de Wit and R. Withagen, “What should a “gibso-
nian neuroscience” look like? introduction to the special,”
Ecological Psychology, vol. 31, no. 3, pp. 147–151, 2019.
79. A. Linson, A. Clark, S. Ramamoorthy, and K. Friston,
“The active inference approach to ecological perception:
general information dynamics for natural and artiﬁcial
embodied cognition,” Frontiers in Robotics and AI, vol. 5,
p. 21, 2018.
80. J. Bruineberg and E. Rietveld, “What’s inside your head
once you’ve ﬁgured out what your head’s inside of,”Eco-
logical Psychology, vol. 31, no. 3, pp. 198–217, 2019.
81. R. A. Brooks, “Elephants don’t play chess,” Robotics and
autonomous systems, vol. 6, no. 1-2, pp. 3–15, 1990.
82. R. A. Brooks, “Intelligence without representation,” Arti-
ﬁcial intelligence , vol. 47, no. 1-3, pp. 139–159, 1991.
83. V. Braitenberg, Vehicles: Experiments in synthetic psy-
chology. MIT press, 1986.
84. I. Iso, “Iec25010: 2011 systems and software engineering–
systems and software quality requirements and evaluation
(square)–system and software quality models,” Interna-
tional Organization for Standardization , vol. 34, p. 2910,
2011.
85. H. F. Chame and P. Martinet, “Cognitive modeling for au-
tomating learning in visually-guided manipulative tasks,”
in Informatics in Control, Automation and Robotics ,
pp. 37–53, Springer, 2015.
86. H. F. Chame and C. Chevallereau, “Grounding hu-
manoid visually guided walking: From action-independent
to action-oriented knowledge,” Information Sciences ,
vol. 352, pp. 79–97, 2016.
87. H. F. Chame and C. Chevallereau, “A top-down and
bottom-up visual attention model for humanoid object
approaching and obstacle avoidance,” in 2016 XIII Latin
American Robotics Symposium and IV Brazilian Robotics
Symposium (LARS/SBR), pp. 25–30, IEEE, 2016.
88. B. Stroustrup, The C++ programming language. Pearson
Education India, 2000.
89. B. Meyer, Object-oriented software construction , vol. 2.
Prentice hall New York, second ed., 1997.
90. G. Guennebaud and B. Jacob, “Eigen: a c++ linear alge-
bra library,” URL http://eigen. tuxfamily. org . Accessed
March 3rd 2020.
91. W. Khalil and E. Dombre, Modeling, Identiﬁcation and
Control of Robots . Bristol, PA, USA: Taylor & Francis,
Inc., 3rd ed., 2002.
92. G. Van Rossum and F. Drake, An Introduction to Python.
A Python manual, Network Theory Limited, 2011.
93. D. P. Kingma and J. Ba, “Adam: A method for stochastic
optimization,” arXiv preprint arXiv:1412.6980 , 2014.
94. H. Sakoe and S. Chiba, “Dynamic programming algorithm
optimization for spoken word recognition,”IEEE Transac-
tions on Acoustics, Speech, and Signal Processing, vol. 26,
no. 1, pp. 43–49, 1978.
95. E. Ackermann, “Piaget’s constructivism, papert’s con-
structionism: What’s the diﬀerence,” Future of learning
group publication, vol. 5, no. 3, p. 438, 2001.
96. B. S. Bloom, “Taxonomy of educational objectives: The
classiﬁcation of educational goals,” Cognitive domain ,
1956.
97. P. Freire, Pedagogy of the oppressed. Bloomsbury publish-
ing USA, 2018.
98. G. Siemens, “Connectivism: Learning as network-
creation,” ASTD Learning News, vol. 10, no. 1, pp. 1–28,
2005.
99. P. Seymour, “Mindstorms; children, computers and pow-
erful ideas,” New York: Basic Book , 1980.
100. F. Martin, B. Mikhak, M. Resnick, B. Silverman, and
R. Berg, “To mindstorms and beyond: Evolution of a con-
struction kit for magical machines,” in Robots for kids:
Exploring new technologies for learning , pp. 9–33, 2000.
101. F. B. V. Benitti, “Exploring the educational potential of
robotics in schools: A systematic review,” Computers &
Education, vol. 58, no. 3, pp. 978–988, 2012.
102. E. Thelen and L. Smith, A dynamic systems approach to
the development of cognition and action. MIT Press/Brad-
ford book series in cognitive psychology, The MIT Press,
1994.
103. H. Rosenberg, “The american action painters,” Art news,
vol. 51, no. 8, p. 22, 1952.
104. S. G. Tzafestas, “Roboethics,” A navigating overview.
Heilberg: Springer, 2016.
105. M. M. Sohlberg and C. A. Mateer, Cognitive rehabilita-
tion: An integrative neuropsychological approach. Guilford
Publications, 2017.
106. R. das Nair, K.-J. Martin, and N. B. Lincoln, “Memory re-
habilitation for people with multiple sclerosis,” Cochrane
Database of Systematic Reviews , no. 3, 2016.
107. C. S. Chung, A. Pollock, T. Campbell, B. R. Durward, and
S. Hagen, “Cognitive rehabilitation for executive dysfunc-
tion in adults with stroke or other adult non-progressive
acquired brain damage,”Cochrane Database of Systematic
Reviews, no. 4, 2013.
108. T. Loetscher, K.-J. Potter, D. Wong, and R. das Nair,
“Cognitive rehabilitation for attention deﬁcits following
stroke,”Cochrane Database of Systematic Reviews, no. 11,
2019.
22 Hendry F Chame†et al.
109. M. Maier, B. R. Ballester, N. L. Ba˜ nuelos, E. D. Oller, and
P. F. Verschure, “Adaptive conjunctive cognitive training
(acct) in virtual reality for chronic stroke patients: a ran-
domized controlled pilot trial,” Journal of neuroengineer-
ing and rehabilitation , vol. 17, no. 1, pp. 1–20, 2020.
110. M. Gorˇ siˇ c, I. Cikajlo, and D. Novak, “Competitive and
cooperative arm rehabilitation games played by a patient
and unimpaired person: eﬀects on motivation and exercise
intensity,”Journal of neuroengineering and rehabilitation,
vol. 14, no. 1, p. 23, 2017.
111. H. F. Chame, F. P. Mota, and S. S. da Costa Botelho, “A
dynamic computational model of motivation based on self-
determination theory and CANN,” Information Sciences,
vol. 476, pp. 319–336, 2019.