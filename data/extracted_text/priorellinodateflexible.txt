bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
Flexible Intentions in the Posterior
1
Parietal Cortex: An Active Inference
2
Theory
3
MatteoPriorelli1 andIvilinPeevStoianov1*
4
*Forcorrespondence:
ivilinpeev.stoianov@cnr.it(IPS) 1InstituteofCognitiveSciencesandTechnologies(ISTC),NationalResearchCouncilof
5
Italy(CNR),Padova,Italy
6
7
8 Abstract WepresentanormativecomputationaltheoryofhowneuralcircuitryintheDorsal
9 VisualStream(DVS)andthePosteriorParietalCortex(PPC)supportvisuallyguidedgoal-directed
10 actionsinadynamicalenvironmentthroughflexiblegoal-encodingintentions.ItbuildsonActive
11 Inference,inwhichperceptionandmotorcontrolsignalsareinferredthroughdynamic
12 minimizationofgeneralizedpredictionerror.ThePPCisproposedtomaintainexpectations,or
13 beliefsoverenvironmentandbodystate,andbymanipulatingthemitisinvolvedalongwith
14 visual,frontal,andmotorareasindynamicallygeneratinggoal-directedactions.Specifically,the
15 PPCisviewedasadynamicsystemcomputingflexiblemotorintentionsanddirectingbeliefover
16 thelatentbodystatetowardsthedynamicfuturegoals,whiletheDVSandproprioceptive
17 pathwaysimplementgenerativemodelstranslatingbeliefintosensory-levelpredictionsinorder
18 toinfertargets,posture,andmotorcommands.Aproof-of-conceptagentembodyinganactuated
19 upperlimb,visualandproprioceptivesensorsandcontrolledbyActiveInferenceextendedwith
20 flexibleintentionswastestedontargetreachingtasks.Theagentbehavedcorrectlyunder
21 variousconditions,includingstaticanddynamictargets,differentsensoryfeedbacks,sensory
22 precisions,intentiongains,andmovementpolicies;limitconditionswereindividuated,too.Active
23 Inferencedrivenbyflexibleintentionscanthussupportgoal-directedbehaviorindynamically
24 changingenvironmentsandthePPCcanhostitscoreintentionmechanism.Morebroadly,the
25 studyprovidesnormativebasisforresearchongoal-directedbehaviorinend-to-endsettingsand
26 furtheradvancesArtificialIntelligencemethodsforsensorimotorcontrol.
27
INTRODUCTION
28
29 Inprimates,thedorsomedialvisualstreamprovidescriticalsupportforcontinuouslymonitoring
30 thespatiallocationofobjectsandposturetospecifyandguideactions,andperformsvisuomotor
31 transformationsinthecourseofevolvingactions(Fattorietal.,2017;GallettiandFattori,2018;
32 CisekandKalaska,2010).ThePPC,locatedattheapexofthedorsalstream,isalsobidirectionally
33 connectedtofrontalareas,motorandsomatosensorycortex,placingitinaprivilegedpositionto
34 setgoal-directedactionsandcontinuouslyadjustingmotorplansbytrackingmovingtargetsand
35 bodyposture(Andersen,1995;Gamberinietal.,2021)inacommonreferenceframe(Cohenand
36 Andersen,2002). Undoubtedly,thePPCplaysacrucialroleinvisuallyguidedmotorcontrol(Filip-
37 pinietal.,2018;Gamberinietal.,2021;Desmurgetetal.,1999),butitsspecificroleandmechanism
38 arestilldisputed.ThemostconsistentviewisthatthePPCestimatesthestateofthebodyandthe
39 environmentandoptimizesthebody-environmentinteractions(MedendorpandHeed,2019).Oth-
40 ersseethePPCasataskestimator(HaarandDonchin,2020),andevenmoreclassically,thatitis
1of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
41 involvedinendogenousattentionandtasksetting(CorbettaandShulman,2002). Itsunderlying
42 computationalmechanismisnotfullyunderstood,especiallyasregardsthedefinitionofgoalsin
43 motorplanningandtheirintegrationwithinthecontrolprocess(ShadmehrandKrakauer,2008).
44 For example, the prevailing Optimal Feedback Control theory defines motor goals through task-
45 specific cost functions (Todorov, 2004). Neural-level details of motor-goal coding are becoming
46 increasinglymoreimportantinlightofthegrowingdemandforneuralinterfacestargetingbrain
47 areasprovidinginformationaboutthemotorintent(Gallegoetal.,2022)insupportofintelligent
48 assistivedevices(Vellisteetal.,2008;Srinivasanetal.,2021).
49 Intentionsencodemotorgoalssetbeforethebeginningofmotoractsthemselvesandarethere-
50 foreviewedasmemoryholdersofvoluntaryactions(Andersen,1995;Snyderetal.,1997;Fogassi
51 et al., 2005; Lau et al., 2004). Several cortical areas handle different aspects of intentions: the
52 premotor cortex (PM) encodes structuring while the Supplementary Motor Area (SMA) controls
53 phasing (Gallego et al., 2022). In turn, PPC plays a role in dynamic action tuning, different PPC
54 neuronsbeingsensitivetodifferentintentions(Snyderetal.,2000).Notably,intentionneuronsre-
55 spondnotonlywhenperformingagivenactionbutalsoduringitsobservation,allowingobservers
56 toÂ«predictthegoaloftheobservedactionand,thus,toâ€œreadâ€theintentionoftheactingindivid-
57 ualÂ»(Fogassietal.,2005).Motorgoalshavealsobeenobserveddownthemotorhierarchy,which
58 isanexpressionofhierarchicalpredictivecodinginthemotordomain(Fristonetal.,2011).
59 ToinvestigatehowthePPCsupportssensoryguidedactionsthroughmotorintentionsfroma
60 computationalpointofview,weadoptedtheActiveInferencetheoryofcognitiveandmotorcontrol
61 ofbehavior,whichprovideswithincreasingappealfundamentalinsightsaboutthecomputational
62 role and principles of the nervous system, especially with regard to the perception-action loop
63 (FristonandKiebel,2009;Fristonetal.,2010;Bogacz,2017;Parretal.,2021).ActiveInferencepro-
64 videsaformalizationoftwomaincomputationaltasksofthecortex,namelytheinterpretationof
65 sensoryinformation,i.e.,perceptionandcontrol,bothofwhichareviewedasaimingtoresolvethe
66 criticalgoaloftheorganisms:tosurviveinuncertainenvironmentsbyoperatingwithinpreferred
67 states(e.g.,maintainingaconstanttemperature). Accordingly,boththesetasksareimplemented
68 by dynamic minimization of a quantity called free energy, whose process generally corresponds
69 totheminimizationofhigh-andlow-levelpredictionerrors,thatis,satisfactionofpriorandsen-
70 soryexpectations. TherearetwobranchesofActiveInferencethatareappropriatetotackletwo
71 differentlevelsofcontrol. Thediscretebranchcanexplainhigh-levelcognitivecontrolprocesses
72 suchasplanninganddecisionmaking;itevaluatesexpectedoutcomestoselectactionsindiscrete
73 entities(Pezzuloetal.,2018). Inturn,continuousadjustmentofactionplansinthePPCconsider-
74 ingthevisualstreammatchesbyfunctionalitydynamicActiveInferenceincontinuousstatespace,
75 which formalizes perception and sensorimotor control by casting them in terms of reduction of
76 prediction errors at both internal and sensory levels (Friston et al., 2011, 2012). Therefore, this
77 frameworkdepartsfromtheclassicalviewofperception,planning,andmotorcontrol,consider-
78 ingthemasadynamicprobabilisticinferenceproblem(KaplanandFriston,2018;Toussaintand
79 Storkey,2006;Millidgeetal.,2020;Levine,2018). Thebiologicallyimplausiblecostfunctionstyp-
80 icalofoptimalcontrolarereplacedbyhigh-levelpriorsdefinedinextrinsicstate-space,allowing
81 complexmovementssuchashandwriting(Friston,2011;Adamsetal.,2013).
82 Inthefollowing,wefirstoutlinethebackgroundcomputationalframeworkandthenelaborate
83 onintentionalityindynamicActiveInference.Ourmostcriticalcontributionsregardtheformaliza-
84 tionofgoal-directedbehaviorandtheprocesseslinkingflexiblegoals(e.g.,dynamicvisualtargets)
85 withmotorplansthroughthedefinitionofintentionfunctions. Wealsoinvestigateamoreparsi-
86 moniousapproachtomotorcontrolbasedsolelyonproprioceptivepredictions.Wethenprovide
87 implementationdetailsandapracticaldemonstrationofthetheoreticalcontributionintermsofa
88 simulatedActiveInferenceagent,whichweshowiscapableofdetectingandreachingstaticvisual
89 goalsandtrackingmovingtargets.Wealsoprovidedetailedperformancestatisticsandinvestigate
90 theeffectsofkeysystemparameterswhosebalanceiscriticaltomovementstability.Additionally,
91 gradientanalysisprovidescriticalinsightintothecausesofthemovementsperformed.Finally,we
2of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
92 discusshowintentionscouldbeselectedtoperformaseriesofgoal-directedsteps,e.g.,amulti-
93 phaseaction,andillustrateconditionsforneurologicaldisorders.
COMPUTATIONALBACKGROUND
94
95 Wefirstoutlinethecomputationalprinciplesoftheunderlyingprobabilisticandpredictivecoding
96 approachandprovidebackgroundonvariationalinference,freeenergyminimization,ActiveInfe-
97 fence,andvariationalautoencodersnecessarytocomprehendthefollowingmaincontribution.
BayesianBrain
98
99 Inrecentyears,therehasbeenincreasingattentiontoaradicallynewtheoryofthemindcalledthe
100 Bayesianbrain,accordingtowhichthebrainisasophisticatedmachinethatconstantlymakesuse
101 ofBayesianreasoningtocapturecausalrelationshipsintheworldanddeliveroptimalbehavior
102 in an uncertain environment (Hohwy, 2013; Doya, 2007; Pezzulo et al., 2017). At the core of the
103 theoryisinfacttheBayestheorem, whoseapplicationhereimpliesthatposteriorbeliefsabout
104 the world are updated according to the product of prior beliefs and the likelihood of observing
105 sensoryinput.Priorsplayafundamentalroleindrivingthedynamicsofperceptualexperience,as
106 evidentinvisualphenomenasuchasillusionsorbinocularrivalry. Perceptionisthenmoreofa
107 simplebottom-upfeedforwardmechanismthatdetectsfeaturesandobjectsfromthesensorium
108 and computes latent states; rather, it comprises a predictive top-down generative model which
109 continuouslyanticipatesthesensoryinputinordertotesthypothesesandexplainawayambigui-
110 ties.
111 AccordingtoBayesianbraintheory,thisapparentlycomplextaskisaccomplishedthroughpre-
112 dictivecoding,implementedbymeansofmessagepassingoftop-downpredictionsandbottom-up
113 predictionerrorsbetweenadjacentlayersinthecorticalhierarchy(RaoandBallard,1999).Thefor-
114 meraregeneratedfromlatentstatesmaintainedatthehighestlevels,representingbeliefsabout
115 thecausesoftheenvironment,whilethelatterarecomputedbycomparingsensory-levelpredic-
116 tions with the actual observations. Each prediction will then act as a cause for the layer below,
117 while the prediction error will convey information to the layer above. It is thanks to this hierar-
118 chicalorganizationandthrougherrorminimizationateverylayerthatthecortexisabletomimic
119 andcapturetheinherentlyhierarchicalrelationshipsthatmodeltheworld.Inthisview,sensations
120 areonlyneededinthattheyprovide,throughthecomputationofpredictionerrors,ameasureof
121 howgoodthemodelisandacuetocorrectfuturepredictions.Thus,ascendingprojectionsdonot
122 encodethefeaturesofastimulus,butratherhowmuchthebrainissurprisedaboutit,considering
123 thestrictcorrelationbetweensurpriseandmodeluncertainty.
VariationalBayes
124
125 Organismsaresupposedtoimplementmodelfitorerrorminimizationbysomeformofvariational
126 inference,abroadfamilyoftechniquesbasedonthecalculusofvariationsandusedtoapproximate
127 intractableposteriorsthatwouldotherwisebeinfeasibletocomputeanalyticallyorevenwithclas-
128 sicalsamplingmethodssuchasMonteCarlo(Bishop,2006).
129 Nervoussystemscomputecontrolsignalsunderuncertaintyaboutthereal,yetunknown,state
130 oftheworld,includingthestateoftheorganismsperse,whichcouldjointlybedenotedbyalatent
131
variableğ’›. Iforganismsareendowedwithsensorsthatprovidepartialevidenceğ‘(ğ’”)onthestate
132
ofthedynamicworldandhavepriorknowledgeğ‘(ğ’›),theycouldusesensoryevidenceandapply
133 Bayesianinferencetoimprovetheirknowledge(Maetal.,2006). Todoso,giventheobservation
134
ğ’”,thenervoussystemneedstoevaluatetheposteriorğ‘(ğ’›|ğ’”):
ğ‘(ğ’›,ğ’”)
ğ‘(ğ’›|ğ’”)= (1)
ğ‘(ğ’”)
135 However, evaluating this posterior is infeasible due to the intractability of the marginal ğ‘(ğ’”) =
136
âˆ« ğ‘(ğ’›,ğ’”)ğ‘‘ğ’›,whichinvolvesintegrationoverthejointdensityğ‘(ğ’›,ğ’”).
3of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
137 The variational approach approximates the posterior with a simpler to compute recognition
138 distributionğ‘(ğ’›) â‰ˆ ğ‘(ğ’›|ğ’”), assumingfurthermorethat aneuralprocess, e.g., perceptuallearning,
139 makesthosedistributionssimilarbyminimizingtheKullback-Leibler(KL)divergencebetweenthem:
140
ğ‘(ğ’›)
ğ·
ğ¾ğ¿
[ğ‘(ğ’›)||ğ‘(ğ’›|ğ’”)]=
âˆ«
ğ’›
ğ‘(ğ’›)ln
ğ‘(ğ’›|ğ’”)
ğ‘‘ğ’› (2)
141
TheKLdivergencecanberewrittenasthedifferencebetweenlog-evidencelnğ‘(ğ’”)andaquantity
142
îˆ¸(ğ‘)knownasevidencelowerbound,orELBO(Bishop,2006):
ğ‘(ğ’›,ğ’”)
ğ·
ğ¾ğ¿
[ğ‘(ğ’›)||ğ‘(ğ’›|ğ’”)]=lnğ‘(ğ’”)âˆ’
âˆ«
ğ‘(ğ’›)ln
ğ‘(ğ’›)
ğ‘‘ğ’›=lnğ‘(ğ’”)âˆ’îˆ¸(ğ‘) (3)
ğ’›
143 SincetheKLdivergenceisalwaysnonnegative,theELBOprovidesalowerboundonlog-evidence,
144
thatis,îˆ¸(ğ‘)â‰¤lnğ‘(ğ’”). Therefore,minimizingtheKLdivergencewithrespecttoğ‘(ğ’›)isequivalentto
145
maximizingîˆ¸(ğ‘),whichatitsmaximumcorrespondstoanapproximatedensitythatisclosestthe
146 mosttotheposterior,dependingontheparticularchoiceoftheformofğ‘(ğ’›). Ingeneral,veryfew
147 assumptionsaremadeabouttheformthatthisdistributioncantake(amultivariateGaussianisa
148 typicalchoice),withatrade-offbetweenhavingatractableoptimizationprocesswhilestillleading
149 toagoodapproximateposterior.
FreeEnergy
150
151 Why has the cortex evolved in such a way as to realize Bayesian inference? And how can it be
152 implementedthroughsimplemessagepassingofpredictionerrors?Friston(2002;2005)proposed
153 anelegantsolutionbasedontheso-calledfreeenergy,aconceptborrowedfromthermodynamics
154 anddefinedasthenegativeELBO.Accordingly,Equation(3)canberewrittenas:
ğ‘(ğ’›)
ğ¹(ğ’›,ğ’”)=âˆ’îˆ¸(ğ‘)=ğ·
ğ¾ğ¿
[ğ‘(ğ’›)||ğ‘(ğ’›|ğ’”)]âˆ’lnğ‘(ğ’”)=
âˆ«
ğ‘(ğ’›)ln
ğ‘(ğ’›,ğ’”)
ğ‘‘ğ’› (4)
ğ’›
155 MinimizingfreeenergyisthenequivalenttomaximizationofELBOandprovidesanupperbound
156 onsurprise,aprocesscalledperceptualinference:
ğ’›=argminğ¹(ğ’›,ğ’”) (5)
ğ’›
157 Inthisway, theorganismindirectlyminimizessurprise(hencemodeluncertainty)andisableto
158 learnthecausalrelationsbetweenunknownstatesandsensoryinput,andgeneratepredictions
159 basedonitscurrentinternalrepresentationoftheenvironment.
160 FreeenergyminimizationissimplerthandealingwiththeKLdivergencebetweentheapproxi-
161 mateandtrueposteriorbecausetheformerdependsonquantitiesthattheorganismhasaccess
162 to,namelytheapproximateposteriorandthegenerativemodel.
163 Assuming (i) under the mean-field approximation that the recognition density can be parti-
âˆ
164 tioned into independent distributions: ğ‘(ğ’›) = ğ‘– ğ‘(ğ’› ğ‘– ), and (ii) under the Laplace approximation
165 thateachofthesepartitionsisGaussian: ğ‘(ğ’› ğ‘– ) = îˆº(ğ ğ‘– ,ğš·âˆ’ ğ‘– 1), whereğ ğ‘– representsthemostplau-
166 sible hypothesis (also called belief about the hidden state ğ’› ğ‘– ), and ğš· ğ‘– is its precision matrix that
167 couldbetreatedasaparameterorlearnedonline(Fristonetal.,2007),thefreeenergybecomes
168
independentofğ’›andsimplifiesasfollows:
ğ¹(ğ,ğ’”)=âˆ’lnğ‘(ğ,ğ’”)+ğ¶ =âˆ’lnğ‘(ğ’”|ğ)âˆ’lnğ‘(ğ)+ğ¶ (6)
Thedynamicenvironmentalprocesscanbemodeledwiththefollowingnonlinearstochastic
system:
ğ’”=ğ’ˆ(ğ’›)+ğ’˜
ğ‘ 
(7)
ğ’›Ì‡ =ğ’‡(ğ’›)+ğ’˜
ğ‘§
169 where ğ’ˆ is a function that converts latent states or causes ğ’› into observed states or sensations
170 ğ’”, and the function ğ’‡ encodes the dynamics of the system, that is, the change in latent states
4of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
171 ğ’›Ì‡. In turn, ğ’˜ ğ‘  and ğ’˜ ğ‘§ are noise terms that describe system uncertainty, assumed to belong to
172 multivariatenormaldistributionswithzeromeanandrespectiveprecisionsğš· ğ‘  andğš· ğ‘§ .
Asexplainedabove, underthevariationalapproach, onecanassumethatğ’›isdrawnfroma
Gaussiandistributionwithmeanğsothatthefunctionsğ’ˆandğ’‡correspondtothelikelihoodğ‘(ğ’”|ğ)
andthedensityğ‘(ğâ€² |ğ)respectively,whereğâ€²isabeliefoverthe1st-orderdynamics.Wecanhave
amoreprecisedescriptionoftheunknownenvironmentaldynamicsbyconsideringnotonlythe
1st-orderofEquation(7),butalsohighertemporalorders,usingrespectiveapproximationsofthe
higherorderstates: ğÌƒ = {ğ,ğâ€²,ğâ€²â€²,...}-calledgeneralizedcoordinates(Friston,2008;Fristonetal.,
2008).Thisallowstobetterrepresenttheenvironmentaldynamicswiththefollowinggeneralized
model:
ğ’”Ìƒ=ğ’ˆÌƒ(ğÌƒ)+ğ’˜
ğ‘ 
(8)
ğ·ğÌƒ =ğ’‡Ìƒ(ğÌƒ)+ğ’˜
ğœ‡
whereğ·isthedifferential(shift)operatormatrixsuchthatğ·ğÌƒ ={ğâ€²,ğâ€²â€²,...},ğ’”Ìƒdenotesthegeneral-
izedsensors,whileğ’ˆÌƒandğ’‡Ìƒdenotethegeneralizedmodelfunctionsforeachtemporalorder.Note
thatinthissystem,thesensorydataataparticulardynamicalorderğ’”[ğ‘‘] -where[ğ‘‘]istheorder-
engageonlywiththesameorderofbeliefğ[ğ‘‘],whilethegeneralizedequationofmotion,orsystem
dynamics,specifiesthecouplingbetweenadjacentorders. Wecanapproximatethegeneralized
environmentalmodelwithjointdensitiesofalldynamicalordersandexpandthemasfollows:
âˆ
ğ‘(ğ’”Ìƒ|ğÌƒ)= ğ‘(ğ’”[ğ‘‘] |ğ[ğ‘‘])
ğ‘‘
(9)
âˆ
ğ‘(ğÌƒ)= ğ‘(ğ[ğ‘‘+1] |ğ[ğ‘‘])
ğ‘‘
Asdefinedabove,thesevariationalprobabilitydistributionsareassumedtobeGaussian:
ğ‘(ğ’”[ğ‘‘] |ğ[ğ‘‘])=
âˆš (
ğš·
2ğ…
ğ‘ 
)ğ¿
exp ( âˆ’ 1
2
ğ’†[
ğ‘ 
ğ‘‘]ğ‘‡ ğš·
ğ‘ 
ğ’†[
ğ‘ 
ğ‘‘] )
(10)
ğ‘(ğ[ğ‘‘+1] |ğ[ğ‘‘])=
âˆš (
ğš·
2ğ…
ğœ‡
)ğ‘€
exp ( âˆ’ 1
2
ğ’†[
ğœ‡
ğ‘‘]ğ‘‡ ğš·
ğœ‡
ğ’†[
ğœ‡
ğ‘‘] )
whereğ¿andğ‘€arethedimensionsofsensationsandbelief,respectively.Notethattheprobability
distributionsareexpressedintermsofsensoryandbeliefdynamicspredictionerrors:
ğ’†[ğ‘‘]=ğ’”[ğ‘‘]âˆ’ğ’ˆ[ğ‘‘](ğ[ğ‘‘]) (11)
ğ‘ 
ğ’†[ğ‘‘]=ğ[ğ‘‘+1]âˆ’ğ’‡[ğ‘‘](ğ[ğ‘‘]) (12)
ğœ‡
173 The factorized probabilistic approximation of the dynamic model allows easy generalized state
174 (belief)estimationbasedonfreeenergyminimizationperformedbyiterativegradientdescentover
175
generalizedcoordinates,thatis,bychangingthebeliefğÌƒaboutallordersofthehiddenstates:
ğÌƒÌ‡ âˆ’ğ·ğÌƒ =âˆ’ğœ• ğ¹(ğ’”Ìƒ,ğÌƒ) (13)
ğÌƒ
176 GradientdescentistractablebecausetheGaussianvariationalfunctionsaresmoothanddifferen-
177 tiableandthederivativesareeasilycomputedintermsofgeneralizedpredictionerrors,sincethe
178 logarithmofEquation(6)vanishestheexponentoftheGaussian.Thebeliefupdatethusturnsto:
ğœ•ğ’ˆÌƒğ‘‡ ğœ•ğ’‡Ìƒğ‘‡
ğÌƒÌ‡ =ğ·ğÌƒ+ ğš·Ìƒ ğ’†Ìƒ + ğš·Ìƒ ğ’†Ìƒ âˆ’ğ·ğ‘‡ğš·Ìƒ ğ’†Ìƒ (14)
ğœ•ğÌƒ ğ‘  ğ‘  ğœ•ğÌƒ ğœ‡ ğœ‡ ğœ‡ ğœ‡
179 whichismadeupofthreemainterms:alikelihooderrorcomputedatthesensory-level,abackward
180 errorcomingfromthenexttemporalorder,andaforwarderrorfromthepreviousorder. These
181 terms represent the free energy gradients relative to the belief terms ğ[ğ‘‘] of Equation (11), and
182
ğ[ğ‘‘+1]andğ[ğ‘‘]ofEquation(12),respectively.
5of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
183 Inconclusion,bymakingsomeplausiblesimplifyingassumptions,thecomplexityoffreeenergy
184 minimizationhasbeenreducedtothecomputationofpredictions,whichareconstantlycompared
185 with the sensory observations so to determine a prediction error signal. This error then flows
186 backthroughthecorticalhierarchytoadjustthedistributionparametersaccordinglyandminimize
187 sensorysurprise,whichisequivalenttomaximizingevidence,inthelongrun.
ActiveInference
188
189 Learningthecausalrelationshipsofsomeobserveddata(e.g.,whatcausesanincreaseinbodytem-
190 perature)isnotsufficienttokeeporganismsalive(e.g.,maintainingtemperatureinavitalrange).
191 Critically,anorganismcanalsomodifysensorystatesbyinteractingwiththeenvironment. Ithas
192 beennotedthattheBayesianbrainhypothesiscanbeseenasacorollaryofamoregeneralfree
193 energyprinciple(FEP),whichstatesthat,inorderforanorganismtomaintainastateofhomeostasis
194 andsurvive,itmustconstantlyandactivelyrestrictthesetoflatentstatesinwhichitlivestoanar-
195 rowrangeoflife-compatiblepossibilities,counteractingthenaturaltendencyfordisorder(Friston,
196 2012)-hencetherelationshipwiththermodynamics.Ifthesestatesaredefinedbythephenotype,
197 fromthepointofviewoftheorganismâ€™sinternalmodeltheyareexactlythestatesthatitexpects
198 tobelesssurprising. Thus, whileperceptualinferencetriestooptimizethebeliefabouthidden
199 causesinordertoexplainawaysensations,ontheotherhand,iftheassumptionsdefinedbythe
200 phenotypeareconsideredtobethetruecausesoftheworld,byinteractingwiththeexternalen-
201 vironmenttheagentwilltrytosamplethosesensationsthatmaketheassumptionstrue,fulfilling
202 itsneedsandbeliefs:activeinferencethenbecomesaself-fulfillingprophecy.Inthisview,thereis
203 nodifferencebetweenadesireorabelief: wesimplyseekthestatesinwhichweexpecttofind
204 ourselves(Fristonetal.,2010;Buckleyetal.,2017).
205 Toperformgoal-directedbehavior,itisthensufficienttoapplyfreeenergyminimizationalso
206 withrespecttotheaction(seeEquation6):
ğ’‚=argminğ¹(ğ,ğ’”) (15)
ğ’‚
207 Giventhatitdependsonlyonthesensoryinformation,weobtain:
ğ’‚Ì‡ =âˆ’ğœ• ğ¹(ğ’”Ìƒ,ğÌƒ)=âˆ’
ğœ•ğ¹ ğœ•ğ’”Ìƒ
=âˆ’
ğœ•ğ’”Ìƒğ‘‡
ğš·Ìƒ ğ’†Ìƒ (16)
ğ’‚ ğœ•ğ’”Ìƒ ğœ•ğ’‚ ğœ•ğ’‚ ğ‘  ğ‘ 
208 Computingtheactionbyminimizingthefreeenergyofallsensationsiscertainlyuseful, sinceit
209 makes use of every contribution of the likelihood that drives the belief update; however, it re-
210 quires the knowledge of an inverse mapping from exteroceptive sensations to actions (Baltieri
211 andBuckley,2019),whichisgenerallyconsidereda"hardproblem"becausethemappingishighly
212 non-linearandnotunivocal(Fristonetal.,2010).
213 In a more realistic scenario, only proprioception drives the minimization of free energy with
214 respect to action, which is simpler to compute since the corresponding sensory information is
215 alreadyintheintrinsicproprioceptivedomain. Controlsignalssentfromthemotorcortex,there-
216 fore,arenotmotorcommandsasintheclassicalviewofoptimalcontrol;instead,theyconsistof
217 predictionsthatspecifythedesiredtrajectory. Inthisscenario, proprioceptivepredictionerrors
218 computedlocallyatthespinalcordservetwopurposesthatonlydifferinhowthesesignalsare
219 suppressed:theydrivethecurrentbelieftowardssensoryobservations(happeningtorealizeper-
220 ception, as with exteroceptive signals) and they drive sensory observations towards the current
221 belief(happeningtorealizemovement),furthersuppressingthesameerrorsbymeansofsimple
222 reflex arcs that activate the corresponding muscles (Adams et al., 2013; Parr and Friston, 2018;
223 Versteegetal.,2021).
224 Inconclusion,perceptionandactioncanbeseenastwosidesofthesamecoinimplementing
225 thecommonvitalgoalofminimizingentropyoraveragesurprise. Inthisview,whatweperceive
226 nevertriestoperfectlymatchtherealstateofaffairsoftheworld,butisconstantlybiasedtowards
227 ourpreferredstates.Inturn,actiononlyindirectlyfulfillsfuturegoals;instead,itcontinuouslytries
228 tofillthegapbetweensensationsandpredictionsgeneratedfromourbiasedbelief.
6of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
VariationalAutoencoder
229
Variational Autoencoders (VAEs) belong to the family of generative models, since they learn the
jointdistributionğ‘(ğ’›,ğ’”)andcangeneratesyntheticdatasimilartotheinput,givenapriordistribu-
tionğ‘(ğ’›)overthelatentspace. VAEsusethevariationalBayesapproachtocapturetheposterior
distributionğ‘(ğ’›|ğ’”)ofthelatentrepresentationoftheinputswhenthecomputationofthemarginal
isintractable(Goodfellowetal.,2016). AVAEiscomposedoftwoprobabilitydistributions,both
of which are assumed to be Gaussian: a probabilistic encoder corresponding to the recognition
distribution ğ‘(ğ’›|ğ’”) producing a distribution over the latent space ğ’› given input ğ’”, and a genera-
tivefunctionğ‘(ğ’”|ğ’›)calledprobabilisticdecoderwhichcomputesadistributionovertheinputspace
givenalatentrepresentationğ’›(Figure3c):
ğ‘(ğ’›|ğ’”)=îˆº(ğ’›|ğ
ğœ™
,ğšº
ğœ™
)
(17)
ğ‘(ğ’”|ğ’›)=îˆº(ğ’”|ğ
ğœƒ
,ğšº
ğœƒ
)
230 AlthoughVAEshavemanysimilaritieswithtraditionalautoencoders,theyareactuallyaderivation
231 oftheAEVBalgorithmwhenaneuralnetworkisusedfortherecognitiondistribution(Kingmaand
232 Welling,2014).
233 Unlikeothervariationaltechniques,theapproximateposteriorisgenerallynotassumedtobe
234 factorial,butsincethecalculationofâˆ‡ ğœ™ îˆ¸ ğœƒ,ğœ™ (ğ’”)isbiased,amethodcalledreparametrizationtrickis
235
usedtorewritethegradientsothatitisindependentoftheparametersğ“.
236
Thismethodworksbyexpressingthelatentvariableğ’›byafunction:
ğ’›=ğ‘Ÿ(ğ,ğ“,ğ’”) (18)
237 whereğisanauxiliaryvariableindependentofğ“andğ’”. TheELBOforasingledatapointcanthus
238 beexpressedas:
ğ¿
îˆ¸Ìƒ
ğœƒ,ğœ™
(ğ’”)=âˆ’ğ·
ğ¾ğ¿
[ğ‘(ğ’›|ğ’”)||ğ‘(ğ’›)]+
ğ¿
1 âˆ‘ logğ‘(ğ’”|ğ’›
ğ‘™
) (19)
239 whichcanbeminimizedthroughbackpropagation. Here,theKLdivergencecanbeseenasareg-
240 ularizer,andthesecondRHStermisanexpectednegativereconstructionterm.
RESULT
241
242 Inwhatfollows,wedevelopandpreliminaryassessacomputationaltheoryofthecircuitryinthe
243 PPC and related areas controlling goal-directed actions in a dynamically changing environment
244 throughflexibleintentions.WefirstelaborateonintentionalityinActiveInference,thenprovidea
245 proof-of-conceptagentendowedwithvisualinput,andfinallydescribeandanalyzeseveralsimula-
246 tionsofvisuallyguidedbehavior.Thetheoreticalworkismotivatedbybasicresearchshowingthe
247 criticalroleofPPCingoal-directedsensorimotorcontrolthroughintentioncoding(Andersen,1995;
248 Desmurgetetal.,1999;GallettiandFattori,2018)andextendsprevioustheoreticalandapplied
249 researchonActiveInference(Fristonetal.,2009;Pio-Lopezetal.,2016;LimanowskiandFriston,
250 2020)andVAE-basedvisionsupport(LanillosandCheng,2018;Sancaktaretal.,2020;Roodetal.,
251 2020).Inturn,thesimulationswereinspiredbyamonkeyreachingtask(Breveglierietal.,2014).
Intentions
252
253 State-of-the-artimplementationsofdynamicActiveInferencedefineactiongoalsintermsofanat-
254 tractorembeddedinthesystemdynamics(Friston,2011).Theattractorcanbealow-level(sensory)
255 predictionthatiscomparedwiththecurrentobservationandbackpropagatedtoobtainabelief
256 updatedirection(Sancaktaretal.,2020;Oliveretal.,2019;Pio-Lopezetal.,2016), oradesired
257 latentstatespecifiedinthefullequationsofmotionthattheagentexpectstoperceive(Baioumy
258 et al., 2020). However, since these states or sensations are usually static or defined externally,
259 theagentisnotabletodealwithcontinuouslychangingenvironments(e.g.,reachingorgrasping
260 movingtargets)expectingthattheworldwillalwaysevolveinthesameway.
7of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
Figure1.Functionalarchitectureandcorticaloverlayofthegoal-directedActiveInferenceagent.Theprocess
startswiththecomputationoffutureintentionsğ’‰inthePPCunderthecoordinationoffrontalandmotor
areas.Inthemiddleofthesensorimotorhierarchy,atthePPC,thedynamicActiveInferenceprocess
maintainsbeliefsğoverthelatentcausesofthecurrentsensoryobservationsğ’” andğ’” ,andcomputes
ğ‘ ğ‘£
proprioceptiveandvisualpredictionsthroughthesomatosensoryanddorsalvisualpathways(forsimplicity
wehaveomittedthesomatomotorpathwayandconsideredasinglemechanismforbothmotorcontroland
beliefinference).Inturn,thelowerlayersofthehierarchycomputesensorypredictionerrorsğ’† andğ’† while
ğ‘ ğ‘£
thehigherlayerscomputeintentionpredictionerrorsğ’†(ğ‘–);botharepropagatedbacktowardsthePPC,which
thusintegratesinformationfrommultiplesensorymodalitiesandintentions.Freeenergyisminimized
throughoutthecorticalhierarchybychangingthebeliefaboutthecausesofthecurrentobservation
(perception)andbysendingproprioceptivepredictionsfromthemotorcortextothereflexarcs(action).An
essentialelementofthisprocessisthecomputationofgradientsğœ•ğ’ˆ andğœ•ğ’ˆ byinversemappingsfromthe
ğ‘ ğ‘£
sensationstowardsthedeepestlatentstates.Inthisprocess,intentionsactashigh-levelattractorsandthe
beliefpropagateddowntocomputesensorimotorpredictionsembedsacomponentdirectingthebodystate
towardsthegoals.
261 Instead, the agent could maintain a dynamically estimated belief over moving objects in the
262 scene - potential or current targets - or be given a desired latent state to reach (Friston et al.,
263 2010);inthebrain,goal-encodingsignalscoulddescendfromhigher-levelcorticalstructures(e.g.,
264 PFC, (Stoianov et al., 2016)). An intention can be computed by exploiting this belief in order to
265 computeafutureactiongoal,orbodyposture,sothattheattractor-specifiedeitherinthebelief
266 domainoratthesensory-level-isnotfixedbutdependsonthecurrentperceptualandinternal
267 representationoftheworld,orrepresentationsmemorizedinpastexperiences. Inotherwords,
268 theagentcanconstructandmaintainatahighlevelaplausibledynamichypothesisforthecauses
269 thatproducewhatitisperceiving;bymanipulatingtheseandeventuallyothermemorizedcauses,
270 theagentcandynamicallycomputearepresentationofthefuturebodystate,i.e.,intention,which
271 inturncanactasaprioroverthecurrentbelief.
272 As shown in Figure 1, the belief is located at an intermediate level between generative mod-
8of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
273 els that produce sensory predictions and a system dynamics model that specifies its evolution
274 overtime. Weproposetodecomposethebeliefdynamicsmodelintoasetofintentionfunctions
275 thatflexiblygeneratefuturebeliefs,eachintentionprovidinganindependentexpectationthatthe
276 agentwillfinditselfinaparticularstate(Fristonetal.,2011).Thebeliefisthenconstantlysubject
277 totwoforces: onefrombelow(correspondingtosensorypredictionerrors)thatpullsthebeliefto
278 whattheagentiscurrentlyperceiving,andonefromhigherhierarchicallevels(whichwecancall
279 intentionpredictionerrors)thatpullsthebelieftowhattheagentexpectstoperceiveinthefuture.
280 From a neural perspective, the PPC is the ideal candidate for a cortical structure computing
281 beliefs and flexible intentions, being at the apex of the DVS hierarchy and other exteroceptive
282 domains producing sensory predictions on the one hand, and on the other, linked with motor
283 andfrontalareasproducingcontinuoustrajectoriesintheproprioceptivedomainandhigher-level
284 planscomposedofaseriesofdiscreteactionchunks.Infact,itisknownthatthePPCisanassocia-
285 tiveregionthatintegratesinformationfrommultiplesensorymodalitiesandencodesvisuomotor
286 transformations;forexample,areaV6Aencodesobjectaffordancesduringreachingandgrasping
287 tasks (Filippini et al., 2017; Fattori et al., 2017). Thus, if the job of sensory pathways, or gener-
288 ativemodels,istocomputesensory-levelpredictions,ourhypothesisisthathigherlevelsofthe
289 sensorimotorcontrolhierarchyintegrateinthePPCpreviousstatesofbeliefwithflexiblepriors
290 computing(high-level)intentions.
291 Tobegindescribingamoreformaldefinition,weassumethattheneuralsystemperceivesthe
292 environment and receives feedback on the effects of motor control through ğ¿ noisy sensors ğ’”.
293 Here,ğ’”enclosessensorsfrommultipledomains,mostcritically,proprioceptiveandvisual. Under
294 theVBandGaussianapproximationoftherecognitiondensity,wealsoassumethatthenervous
295 systemoperatesonbeliefsğ âˆˆ â„ğ‘€ thatdefineanabstractinternalrepresentationoftheworld.
296 Furthermore, we assumethat the agent maintains generalized coordinates up to the 2nd-order
297
resultingfromfreeenergyminimizationinthegeneralizedbeliefspaceğÌƒ ={ğ,ğâ€²,ğâ€²â€²}.
298
Wethendefineintentionsğ’‰aspredictionsoftargetgoalstatesoftheworldovercurrentbeliefs
299 ğcomputedwiththehelpofğ¾ intentionfunctionsğ’Š(ğ‘–)(ğ) âˆˆ â„ğ•„ buildingintentionrepresentations
300 ğ’‰(ğ‘–) foreachgoaloftheagent. Althoughboththebeliefandtheintentionscouldbeveryabstract
301 representationsoftheworld(comprisingstatesinextrinsicandintrinsiccoordinates),weassume
302 asimplerscenarioinwhichtheintentionsoperateonbeliefsinacommonintrinsicmotor-related
303 domain,e.g.,thejointanglespace.Wealsoassumethattherearetwoconceptuallydifferentcom-
304
ponentsinboththebelief(domain)ğandtheoutput(codomain)oftheintentionfunctionsğ’Š(ğ‘–).The
305 firstcomponentcouldrepresentthebodilystatesandservetodriveactions,whilethesecondone
306 could represent the state of other objects, most importantly targets to interact with, which can
307 beinternallyencodedinthejointanglespaceaswell. Thesetargetscouldbeobserved,butthey
308 couldalsobeimaginedorsetbyhigherlevelcognitivecontrolfrontalareassuchasPFCorPMd
309 (Genovesioetal.,2012;Stoianovetal.,2016).
310
Forthesakeofnotationalsimplicity,wegroupallintentionsintoasinglematrixğ‘¯ âˆˆâ„ğ‘€ğ‘¥ğ¾:
[ ] [ ]
ğ‘¯ =ğ’Š(ğ)= ğ’Š(0)(ğ) â€¦ ğ’Š(ğ¾)(ğ) = ğ’‰(0) â€¦ ğ’‰(ğ¾) (20)
311 Intentionpredictionerrorsğ’†(ğ‘–) arethendefinedasthedifferencebetweenthecurrentbeliefand
312 everyintention: [ ]
ğ‘¬(ğ‘–)=ğ‘¯âˆ’ğ= ğ’†(0) â€¦ ğ’†(ğ¾) (21)
313 Inturn,sensorypredictionsareproducedbyasetofgenerativemodelsğ’ˆ ğ‘— ,oneforeachsensory
314
modality.Wegroupthepredictionsintoapredictionvectorğ’‘:
â¡ğ’ˆ (ğ)â¤ â¡ğ’‘ â¤
0 0
â¢ â¥ â¢ â¥
ğ’‘=ğ’ˆ(ğ)= â‹® = â‹® (22)
â¢ â¥ â¢ â¥
â¢ğ’ˆ (ğ)â¥ â¢ğ’‘ â¥
â£ ğ¿ â¦ â£ ğ¿â¦
9of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
315 Note that each term ğ’‘ ğ‘— is a multidimensional sensory-level representation that provides predic-
316 tions for a particular sensory domain, with its own dimensionality, and grouping, for notational
317 simplicity,allpredictedbitsfromthisdomainintoasingleterm.
318 Sensory prediction errors ğ’† ğ‘— are then computed as the difference between sensations from
319 eachdomainandthecorrespondingsensory-levelpredictions:
â¡ğ’† â¤
0
â¢ â¥
ğ’† =ğ’”âˆ’ğ’‘= â‹® (23)
ğ‘  â¢ â¥
â¢ğ’† â¥
â£ ğ¿â¦
320
whereğ’”encompassesthecurrentsensoryobservationsofallsensorymodality,mostimportantly
321 visualandproprioceptive. Intheabovenotationandhereafter,thesuperscriptsindexintentions,
322 andthesubscriptsindexsensorydomains.
Goal-directedActiveInference
323
324 Under the assumption of independence among intentions and sensations, we can factorize the
325 jointprobabilityofthegenerativemodelintoaproductofdistributionsforeachsensorymodality
326 andintention,whichexpandsasfollows:
ğ¾ ğ¿
âˆ âˆ
ğ‘(ğ,ğ’”)= ğ‘(ğ(ğ‘–)â€² |ğ)â‹… ğ‘(ğ’” ğ‘—|ğ) (24)
ğ‘– ğ‘—
TheprobabilitydistributionsareassumedtobeGaussian:
ğ‘(ğ(ğ‘–)â€² |ğ)=îˆº(ğ(ğ‘–)â€² |ğ’‡(ğ‘–)(ğ),ğ›¾(ğ‘–))
(25)
ğ‘(ğ’” ğ‘—|ğ)=îˆº(ğ’” ğ‘—|ğ’ˆ
ğ‘—
(ğ),ğœ‹
ğ‘—
)
327 where ğ›¾(ğ‘–) and ğœ‹ ğ‘— are, respectively, the precisions of intention ğ‘– and sensor ğ‘—. Here, ğ(ğ‘–)â€² and ğ’‡(ğ‘–)
328 correspondtothei-thcomponentofthegeneralizeddynamicsfunction:
ğ’‡(ğ‘–)(ğ)=ğ‘˜ğ’†(ğ‘–)+ğ’˜(ğ‘–) (26)
ğœ‡
329
whereğ‘˜isthegainofintentionpredictionerrorsğ‘¬(ğ‘–).Notethatthegoalstatesareembeddedinto
330 the 1st-order dynamics functions, acting as belief-level attractors for each intention, so that the
331 agentexpectsthatitwillbepulledtowardstargetstateswithavelocityproportionaltotheerror.
332 Importantly,althoughthegeneralizedbeliefallowsencodingsomeinformationaboutdynamics
333 ofthetruegenerativeprocess,inthiscasetheagentdoesnothaveanyprioroverit.Forexample,
334 theagentdoesnotknowthetrajectoryofamovingtargetinadvance(whoseprior,inamorerealis-
335 ticscenario,wouldbecertainlypresentandacquiredthroughlearningfrompastexperiences),and
336 willupdatethebeliefonlyrelyingontheincomingsensoryinformation. Nevertheless,theagent
337 maintains(false)expectationsabouttargetdynamics,anditisindeedthediscrepancybetweenthe
338 evolutionofthe(real)generativeprocessandthatofthe(internalandbiased)generativemodel
339 thatmakestheagentabletoimplementintention-drivenbehavior.
340 Thepredictionerrorsofthedynamicsfunctionscanbegroupedinasinglematrix:
ğ‘¬(ğ‘“)=ğâ€²âˆ’ğ‘˜ğ‘¬(ğ‘–) (27)
341 Thus,thederivativeoffreeenergywithrespecttothebeliefisgivenby(alsoseeEquation14):
[ ]
ğâ€²+ğ‘®ğ‘‡(ğ…âŠ™ğ’† )+(ğ‘­ âŠ™ğ‘¬(ğ‘“))ğœ¸ğ‘‡
ğÌƒÌ‡ =ğ·ğÌƒâˆ’ğœ• ğ¹ = ğ‘  (28)
ğÌƒ ğâ€²â€²âˆ’ğ‘¬(ğ‘“)ğœ¸ğ‘‡
HereâŠ™istheelement-wiseproduct,ğ‘®andğ‘­ enclosethegradientsofallsensorygenerativemodels
anddynamicsfunctions,whileğ…andğœ¸compriseallsensoryandintentionprecisions:
â¡ğœ•ğ’ˆ â¤ â¡ğœ‹ â¤
ğœ•ğ’ˆ â¢ 0 â¥ â¢ 0 â¥ ğœ•ğ’‡ [ ] [ ]
ğ‘®= = â‹® ğ…= â‹® ğ‘­ = = ğœ•ğ’‡(0) â€¦ ğœ•ğ’‡(ğ¾) ğœ¸= ğ›¾(0) â€¦ ğ›¾(ğ¾) (29)
ğœ•ğ â¢ â¥ â¢ â¥ ğœ•ğ
â¢ğœ•ğ’ˆ â¥ â¢ğœ‹ â¥
â£ ğ¿â¦ â£ ğ¿â¦
10of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
342 Inthefollowingwewillneglectthebackwarderrorinthe0th-orderofEquation(28)sinceithasa
343 muchsmallerimpactontheoveralldynamics,andtreatastheactualattractorforcetheforward
344 erroratthe1st-order: [ ] [ ]
ğâ€²+ğ‘®ğ‘‡(ğ…âŠ™ğ’† ) ğâ€²+ğ
ğÌƒÌ‡ â‰ˆ ğ‘  = ğ‘  (30)
ğâ€²â€²âˆ’ğ‘¬(ğ‘“)ğœ¸ğ‘‡ ğâ€²â€²âˆ’ğ(ğ‘–)
345
whereğ
ğ‘ 
andğ(ğ‘–)respectivelystandforthecontributionsofprecision-weightedsensoryandinten-
346 tion prediction errors. We can interpret ğ›¾(ğ‘–) as a quantity that determines the attractor gain of
347
intentionğ‘–,sothatintentionswithgreaterstrengthhaveagreaterimpactontheupdatedirection;
348 thesegainscouldbemodulatedbyprojectionsfromhigherlevelsorfrontalareasapplyingcog-
349 nitivecontrol,suchasPFCorPMd. Inturn,ğœ‹ ğ‘— correspondstotheconfidencethattheagenthas
350
abouteachsensorymodalityğ‘—,sothattheagentreliesmoreonsensorswithhigherstrength.
Similarly,wecanspecifycontrolsignalsbyminimizingfreeenergywithrespecttoactions,ex-
pressingthemappingfromsensationstoactionsby:
ğœ•ğ’” ğœ•ğ
= â‹…ğ‘®
ğœ•ğ’‚ ğœ•ğ’‚ (31)
ğ’‚Ì‡ =âˆ’ğœ• ğ¹ =âˆ’ğœ• ğğ‘‡ğ
ğ‘ ğ‘ ğ‘ 
351
whereğœ•
ğ‘
ğisaninversemodelfrombelieftoactions.Ifmotoractionsarespecifiedasjointvelocities,
352 wecandecomposeandapproximatetheinversemodelasfollows:
ğœ• ğ=
ğœ•ğ’’
â‹…
ğœ•ğ
=
ğœ•ğ’ˆ
ğ‘ â‹…
ğœ•ğ
=Î”ğ‘®âˆ’1 (32)
ğ‘ ğœ•ğ’‚ ğœ•ğ’’ ğœ•ğ’‚ ğœ•ğ’ˆ ğ‘¡ ğ‘
ğ‘
353 where the subscript ğ‘ indicates the proprioceptive contribution and we approximated ğœ• ğ‘ ğ’ˆ ğ‘ by a
354 timeconstantÎ” ğ‘¡ (Oliveretal.,2019).
355 Ifweassumethatthebeliefoverhiddenstatesisencodedinjointanglecoordinates,thecom-
356 putationoftheinversemodelmaybeassimpleasfindingthepseudoinverseofamatrix;however,
357 ifthebeliefisspecifiedinamoregenericframeofreferenceandtheproprioceptivegenerative
358 model is a nonlinear function, it could be much harder to compute the corresponding gradient,
359 introducingothercontrolproblemssuchastemporaldelaysonsensorysignals(Friston,2011).
Algorithm1Goal-directedActiveInference
Input:ğ’Š,ğ’ˆ,ğœ•ğ,ğœ¸,ğ…,ğ‘˜,Î”
ğ‘¡
1: ğ,ğâ€²,ğâ€²â€²,â†ğ¼ğ‘›ğ‘–ğ‘¡ğ‘–ğ‘ğ‘™ğ‘–ğ‘§ğ‘’ğµğ‘’ğ‘™ğ‘–ğ‘’ğ‘“()
2: whileğ‘¡<ğ‘‡ do
3: ğ‘¯ â†ğ’Š(ğ) âŠ³Goal-directedintentions
4: ğ‘¬(ğ‘“)â†ğâ€²âˆ’ğ‘˜(ğ‘¯âˆ’ğ)
5: ğ(ğ‘–)â†ğ‘¬(ğ‘“)ğœ¸ğ‘‡ âŠ³Precision-weightedintentionerrors
6: ğ’‘â†ğ’ˆ(ğ) âŠ³Sensorypredictions
7: ğ’† ğ‘  â†ğ’”âˆ’ğ’‘
8: ğ ğ‘  â†ğ‘®ğ‘‡(ğ…âŠ™ğ’† ğ‘  ) âŠ³Precision-weightedsensoryerrors
9: ğÌ‡ â†ğâ€²+ğ ğ‘  âŠ³Beliefupdate
10: ğÌ‡â€²â†ğâ€²â€²âˆ’ğ(ğ‘–)
11: ğ’‚Ì‡ â†âˆ’ğœ•ğâ‹…ğ ğ‘  âŠ³Actionupdate
12: ğÌƒ â†ğÌƒ+Î” ğ‘¡ ğÌƒÌ‡ âŠ³Freeenergyminimization
13: ğ’‚â†ğ’‚+Î” ğ‘¡ ğ’‚Ì‡
14: endwhile
360 Alternatively,wecanconsidermotorcontroldrivenonlybyproprioceptivepredictionsandsen-
361 sations,sothatthecontrolsignalisalreadyinthecorrectdomainandmaybeachievedthrough
362 simplereflexarcpathways(Adamsetal.,2013;Versteegetal.,2021).Inthiscase,allthatisneeded
363 isamappingfromproprioceptivepredictionstoactions:
ğ’‚Ì‡ =âˆ’ğœ• ğ¹ =âˆ’Î” â‹…ğœ‹ ğ’† (33)
ğ‘ ğ‘ ğ‘¡ ğ‘ ğ‘
11of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
Figure2.Neuronalrepresentationofintention-mediatedfreeenergyminimizationimplementingActive
Inference.Smallsquaresstandforinhibitoryconnections.
364 Algorithm1outlinesaschematicdescriptionoftheflowofdynamiccomputations.
NeuralImplementation
365
366 Figure2showsaschematicneuronalimplementationofintention-mediatedfreeenergyminimiza-
367 tion,whichfurtherextendsearlierperceptualinferenceschemes(Bogacz,2017)tofull-blownActive
368 Inference. Forsimplicity,theintentionsconsistonlyofasinglelayerwithaneuronforeachfunc-
369 tion,buttheymaybeeasilyimplementedwithdeeperneuralnetworks. Notethatintentionsğ’‰(ğ‘–)
370 andsensorygenerativemodelsğ’ˆ ğ‘— areallpartofthesamearchitecture,theonlydifferencebeing
371 thelocationinthecorticalhierarchy.
372 Low-levelpredictionerrorsforeachsensorymodalityarerepresentedbyneuronswhosedy-
373 namicsdependsonboththeobservationsandthepredictionsofthesensorygenerativemodels:
374 ğ’†
ğ’†Ì‡ =ğ’” âˆ’ğ’ˆ (ğ)âˆ’ ğ‘— (34)
ğ‘— ğ‘— ğ‘— ğœ‹
ğ‘—
375 Uponconvergenceoftheneuralactivity,thatis,ğ’†Ì‡ ğ‘— =0,weobtainthepredictionerrorcomputation
376 derivedabove.Inturn,theinternalactivityofneuronscorrespondingtohigh-levelpredictionerrors
377 isobtainedbysubtractingthegeneratedintentionfromthe1st-orderbelief:
ğ’†(ğ‘–)
ğ’†Ì‡(ğ‘–)=ğâ€²âˆ’ğ’‡(ğ‘–)(ğ)âˆ’ (35)
ğ›¾(ğ‘–)
Havingcomputedtheinformationcomingfromthetopandbottomofthehierarchy,thebeliefis
updatedbyintegratingeverysignal:
âˆ‘ âˆ‘
ğÌ‡ = ğœ•ğ’ˆ ğ’† + ğœ•ğ’‡(ğ‘–)ğ’†(ğ‘–) (36)
ğ‘— ğ‘—
ğ‘— ğ‘–
378 whichparallelstheupdateformuladerivedabove(Equation30).
379 Correspondingly,the1st-ordercomponentofthebeliefisupdatedasfollows:
âˆ‘
ğÌ‡â€²=âˆ’ ğ’†(ğ‘–) (37)
ğ‘–
380 Thebeliefisthusconstantlypushedtowardsadirectionthatmatchessensationsononeside
381 andintentionsontheother. Sinceprecisionsareencodedinsynapticstrengths,theycanbedy-
382 namicallyoptimizedduringinferenceinadirectionthatminimizesfreeenergy(e.g., ifasensory
383 modalityisnotusefultopredictsensations,itsweightwilldecrease). Inthisway,bydynamically
12of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
384 changingduringthetask,theintentionweightscanactasmodulatorysignalsthatselectthebest
385 intentiontorealizeateverymoment.
SimulatedAgent
386
387 Todemonstratethefeasibilityoftheapproach,wesimulatedanagentconsistingofanactuated
388 upperlimbwithvisualandproprioceptivesensorsthatallowittoperceiveandreachstaticand
389 movingtargetswithinitsreach.Figure3ashowsthesizeandpositionofthetargets,aswellaslimb
390 sizeandasampleposture. Sincethefocusherewasonthetheoreticalapproach, wesimulated
391 justacoarse3-DoFlimbmodelmovingona2Dplane. However,theapproacheasilygeneralizes
toamoreelaboratedlimbmodeland3Dmovements.
(a)Simulationsetupwithalltargetsvisible. (b)Referencemonkeyexperiment.
(c)Architectureofthevariationalautoencoderusedinthesimulation.
Figure3.Outline.(a)Simulatedexperimentwithanagentreachingforaredcircletargetasinthereference
monkeyexperiment(Breveglierietal.,2014)outlinedin(b).(c)Variationalautoencoderimplementing(top)
aninversevisualmodel,orencoder,and(bottom)aforwardgenerativemodel,ordecoderğ’ˆ .
ğ‘£
392
393 Inthefollowing,wefirstdescribetheagentandthespecificimplementationofthetheoretical
394 approach.Then,weprovideanassessmentoftheagentâ€™sperceptualandmotorcontrolcapabilities
395 in static and dynamic conditions. The static condition simulated a typical monkey reaching task
396 of peripersonal targets as in Figure 3b (Breveglieri et al., 2014). In turn, the dynamic condition
397 involvedamovingtargetthattheagenthadtotrackcontinuously.
Body
398
399 The body consists of a simulated monkey upper limb that includes a moving torso attached to
400 an anchored neck, an upper arm, and a lower arm, as shown in Figure 3a. The three moving
13of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
401 segments are schematized as rectangles, each with unit mass, and the joints (shoulder, elbow)
402 andthetips(neck,hand)ascircles.Theproportionsofthelimbsegmentandtheoperatingrange
403 ofthejointangleswerederivedfrommonkeydataMacacamulatta(KikuchiandHamada,2009).
404 The parameters of the limb model, including the rotation limits, are described in Supplementary
405 Material,Table1. Thestateofthelimbanditsdynamicsaredescribedbythejointanglesğœ½and
406 theirfirstmomentğœ½Ì‡. Weassumenoisyvelocity-levelmotorcontrol,wherebythemotorefferents
407
ğ’‚noisilycontrolsthefirstmomentofjointangleswithzero-centeredGaussiannoise:
ğœ½Ì‡ =ğ’‚+ğ’˜ (38)
ğ‘
Sensors
408
409 Theagentreceivesinformationaboutitsproprioceptivestateandvisualcontext.Simplifiedperiper-
410 sonalvisualinputğ’” ğ‘£ wasprovidedbyavirtualcamerathatincludedthree2Dcolorplanes,each
411 128x96 pixels in size. The location and orientation of the camera were fixed so that the input
412 providedfullvisionoftheentirelimbinanypossiblelimbstatewithinitsoperatingrangeandof
413 peripersonaltargets.Thelimbcouldoccludethetargetinsomeconfigurations.
414 Asinthesimulatedlimb,themotorcontrolsystemalsoreceivesproprioceptivefeedbackthrough
415 sensorsğ’” ğ‘ ,providingnoisyinformationonthetruestateofthelimb(TuthillandAzim,2018;Ver-
416 steegetal.,2021). Wemadeafurthersimplificationthatğ’” ğ‘ providesanoisyreadingofthestate
417 ofalljointsonlyintermsofjointangles,ignoringotherproprioceptivesignalssuchasforceand
418 stretch(Srinivasanetal.,2021),whichtheActiveInferenceframeworkcannativelyincorporate.
Belief
419
420
Weassumeinternalrepresentations-beliefğ-approximatingthelatentcausesğ’›oftheenviron-
421
ment,includingherethreecomponents:(i)beliefsğ
ğ‘
overarmjointangles,orposture(ii)beliefsğ
ğ‘¡
422 overthetargetlocationrepresentedagaininjointanglespace,i.e.,theposturecorrespondingto
423 thearmtouchingthetarget,and(iii)beliefsğ â„ overamemorizedhomebutton(HB)position;thus,
424 ğ=[ğ ğ‘ ,ğ ğ‘¡ ,ğ â„ ].Notethatthelasttwocomponentscanbeinterpretedasaffordances,allowingthe
425 agenttoimplementinteractionsintermsofbodilyconfigurations(PezzuloandCisek,2016).
IntentionsandIntentionFunctions
426
427 Werecallthatintentionsencodedesiredfuturestatesofbelief,producedfromthecurrentbelief
428 throughintentionfunctions.Steppingontheproposedformalization(Equation20),wecandefine
429 twospecificintentionfunctions(Figure4)asfollows:
â¡ğ ğ â¤
[ ] [ ] ğ‘¡ â„
â¢ â¥
ğ‘¯ = ğ’Š(ğ‘¡)(ğ) ğ’Š(â„)(ğ) = ğ‘°(ğ‘¡)ğ ğ‘°(â„)ğ = ğ ğ (39)
â¢ ğ‘¡ ğ‘¡â¥
â¢ğ ğ â¥
â£ â„ â„â¦
Hereğ’‰(ğ‘¡) = ğ’Š(ğ‘¡)(ğ)definestheagentâ€™sexpectationthatthebeliefoverarmjointanglesisequalto
thejointangleconfigurationcorrespondingtothetargettobereached,anditisimplementedas
asimplemappingğ‘°(ğ‘¡)thatmakesthefirstbeliefcomponentequaltothesecondone. Inturn,the
intentionğ’‰(â„)=ğ’Š(â„)(ğ)encodesthefuturebeliefoftheagentthatthearmwillbeintheHBposition.
Thetwointentionmappingsaredefinedby:
â¡ ğŸ ğ‘° ğŸ â¤ â¡ ğŸ ğ‘° ğŸ â¤
3 3
ğ‘°(ğ‘¡)= â¢ ğŸ ğ‘° ğŸ â¥ ğ‘°(â„)= â¢ ğŸ ğŸ ğ‘° â¥ (40)
â¢ 3 â¥ â¢ 3 â¥
â¢ ğŸ ğŸ ğ‘° â¥ â¢ ğŸ ğŸ ğ‘° â¥
â£ 3 â¦ â£ 3 â¦
430 whereğŸandğ‘° 3 are3x3zeroandidentitymatrices.
431 Theintentionpredictionerrorsforthesetwospecificintentionsarethen:
â¡ğ âˆ’ğ ğ âˆ’ğ â¤
[ ] [ ] ğ‘¡ ğ‘ â„ ğ‘
ğ‘¬(ğ‘–)= ğ’†(ğ‘¡) ğ’†(â„) = ğ’‰(ğ‘¡)âˆ’ğ ğ’‰(â„)âˆ’ğ = â¢ ğŸ ğŸ â¥ (41)
â¢ â¥
â¢ ğŸ ğŸ â¥
â£ â¦
14of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
(a)Reachingaction. (b)Returnaction.
Figure4.Multipleintentions(arrows)andrelativestrength(arrowwidth)withdifferentattractorscontrolled
byintentionprecisions.(a)Strongerattractionoftheredcircleimplementsthereachaction.(b)Stronger
attractionoftheinvisiblebutpreviouslymemorizedHBimplementsthereturn-to-homeaction.
432 sotoprovidetotheagentanupdatedirectiontowardsboththetargetjointanglesandHBposition.
433 As there is no intention to move the target or the HB, the second and third components of the
434 prediction errors will be zero. Importantly, this attractor is dynamically generated at each time
435 step, so that the agent can also follow moving targets and interact with a constantly changing
436 environment.
SensoryPredictions
437
438 Thesensorygenerativedensityhastwocomponents,oneforeachsensorymodality: asimplified
439
proprioceptivemodelğ’ˆ
ğ‘
(ğ)andafull-blownvisualperceptualmodelğ’ˆ
ğ‘£
(ğ):
[ ]
ğ’ˆ (ğ)
ğ’ˆ(ğ)= ğ‘ (42)
ğ’ˆ (ğ)
ğ‘£
440 Sinceherethebeliefisalreadyinthejointangledomain,weimplementedasimpleproprioceptive
441 generativemodelğ’ˆ ğ‘ (ğ) = ğ‘® ğ‘ ğ = ğ ğ‘ ,whereğ‘® ğ‘ isamappingthatonlyextractsthebeliefoverarm
442 jointanglesfromtheoverallbeliefspace:
[ ]
ğ‘® = ğ‘° ğŸ ğŸ (43)
ğ‘ 3
443
Notethatğ’ˆ
ğ‘
(ğ)couldbeeasilyextendedtoamorecomplexproprioceptivemappingifthebody
444 and/orjointsensorshaveamorecomplexstructureandthebeliefhasaricherandmoreabstract
445 representation.
446 Inturn,thevisualgenerativemodelğ’ˆ ğ‘£ isthedecodercomponentofaVAE(seeFigure3c)that
447 producesavisualrepresentationofbothtargetandbodyconfigurationgiventheoverallbeliefin
448 joint angles (example in Figure 15a). The decoder consists of one feedforward layer, two trans-
449 posed convolutional layers, and two other standard convolutional layers needed to smooth the
450 output.AllVAEparametersaredescribedinSupplementaryMaterial,Table2.
Thegradientofthefullgenerativemodelğ‘®isthefollowing:
[ ]
ğœ•ğ’ˆ
ğ‘®= ğ‘ (44)
ğœ•ğ’ˆ
ğ‘£
451 Here,theproprioceptivegradientsimplifiestotheproprioceptivemappingğ‘® ğ‘ itself,whilethevisual
452 componentisthegradientofthedecodercomputedbybackpropagation.
Thus,thepredictionğ’‘andthepredictionerrorğ’† taketheform:
ğ‘ 
[ ] [ ]
ğ ğ’” âˆ’ğ
ğ’‘= ğ‘ ğ’† = ğ‘ ğ‘ (45)
ğ’ˆ (ğ) ğ‘  ğ’” âˆ’ğ’ˆ (ğ)
ğ‘£ ğ‘£ ğ‘£
453 Note that defining the sensory predictions on both proprioceptive and visual sensory domains
454 allowstheagenttoperformefficientgoal-directedbehavioralsoinconditionsofvisualuncertainty,
15of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
455 e.g.,duetolowvisibility. Indeed,sincethebeliefismaintainedovertimeuntilupdate,theagent
456 maintainsthelastknowntargetpositionandcanthusaccomplishreachingtasksalsoincaseof
457 temporarilyoccludedtargets.
Precisions
458
459 Free energy minimization and predictive coding in general heavily depends on precisions. We
460 adoptedtheideathattheslow-varyingprecisionsareencodedassynapticstrengths(Bogacz,2017);
461 Figure2.Alternativeideasseethemasgainsofsuperficialpyramidalneurons(Bastosetal.,2012).
Toinvestigatetheirrole,weparameterizedtherelativeprecisionofeachintentionandsensory
domainwithparametersğ›¼andğ›½asfollows:
[ ]
1âˆ’ğ›¼ [ ]
ğ…= ğœ¸= 1âˆ’ğ›½ ğ›½ (46)
ğ›¼
Theparameterğ›¼controlstherelativestrengthoftheerrorupdateduetoproprioceptionandvision,
whiletheparameterğ›½controlstherelativeattractionoverthebeliefbyeachintention.Withthese
parameters,thesensoryandintentionpredictionerrorsareunpackedasfollows:
ğ =(1âˆ’ğ›¼)â‹…ğ‘®ğ‘‡ğ’† +ğ›¼â‹…ğœ•ğ’ˆğ‘‡ğ’† (47)
ğ‘  ğ‘ ğ‘ ğ‘£ ğ‘£
ğ(ğ‘–)=ğâ€²âˆ’ğ‘˜[(1âˆ’ğ›½)â‹…ğ’†(ğ‘¡)+ğ›½â‹…ğ’†(â„)] (48)
462 Equation(47)showsthebalancebetweenvisualandproprioceptiveinformation. Forexample,if
463 ğ›¼ = 0, theagentwillonlyuseproprioceptivefeedback, whileifğ›¼ = 1, thebeliefwillbeupdated
464 only relying on visual feedback. Note that these are extreme conditions (e.g., the former may
465 correspondtonullvisibility),andtypicalsensorysystemsprovidebalancedfeedback.
466 Inturn,Equation(48)spellsoutthecontrolofbeliefattraction. Whenğ›½ = 0,theagentwillfol-
467 lowthefirstintention,whileitwillfollowthesecondintentionwhenğ›½ =1(Figure4).Intermediate
468
attractorstrengths(ğ›½values)willleadtoanattractorconflict,thusweassumethatbiasedcompet-
469
itiveinhibitionimplementsthecontrolofintentionselection.Finally,theparameterğ‘˜controlsthe
470 overallattractormagnitude(seealsoEquation26).
471
Wecanalsousetheprecisionparameterğ›¼tomanipulatethestrengthofthederivativeoffree
472 energywithrespecttoaction(i.e.,motorcontrol)asfollows:
ğ’‚Ì‡ =âˆ’Î”(1âˆ’ğ›¼)â‹…ğ’† (49)
ğ‘¡ ğ‘
473
Notethatbyincreasingğ›¼(i.e.,morereliabilityonvision),themagnitudeofbeliefupdateremains
474 constant,whileactionupdatesdecreasebecausetheagentbecomeslessconfidentaboutitspro-
475 prioceptiveinformation. Also,onecoulddifferentiallyinvestigatetheeffectofprecisionstrength
476 onbeliefandactionbydirectlymanipulatingspecificprecisions;e.g.,visualprecisionsğ… ğ‘£ mayin-
477 cludecomponentsfollowingthebeliefstructure(SupplementaryMaterial,Table3):
ğ… =[ğ›¼,ğœ‹ ,ğœ‹ ] (50)
ğ‘£ ğ‘£ğ‘¡ ğ‘£â„
478 Forexample,whenğ›¼ = 0andğœ‹ ğ‘£ğ‘¡ > 0,beliefonthetargetisupdatedusingvisualinputwhilethe
479 armmovesonlyusingproprioception,ascenariothatemulatesmovementindarknesswithalit
480 target.
ComputationalAnalysis
481
482 Inthefollowing,wedescribeanassessmentofthecapacityoftheintention-drivenActiveInference
483 agenttoperceiveandperformgoal-directedactionsinreachingtaskswithstaticanddynamicvi-
484 sualtargets.Themaintestbedtaskwasdelayedreaching,butwealsoassessedotherconditions.
485 Sensorimotor control that implements goal-directed actions was investigated in various sen-
486 soryfeedbackconditions,includingpureproprioceptive,alsoknownasopenloop,andmixedvi-
487 sualandproprioceptive,orclosedloop(Todorov,2004),inwhichtheVAEdecoderprovidedsup-
488 port for dynamic estimation of belief over visual targets and bodily states and generated visual
16of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
(a)t=0 (b)t=20 (c)t=70
(d)t=105 (e)t=120 (f)t=150
Figure5.Delayedreaching.Attrialonset(t=0),visualtarget(redcircle)appears,arm(inblue)islocatedon
theHBposition,andbeliefoverarm(ingreen)issetatthetruearmstate.Duringthedelayperiodthe
iterativeperceptualinferenceprocessgraduallydrivestargetbelief(purplecircle)towardsthetarget(t=20
andt=70).Duringthisphasetheintentiongainğ‘˜issetto0,somovementisinhibitedandarmbeliefdoesnot
changegiventheunchangedproprioceptiveevidence(t=70).Uponmovementdeliberation,thearmfreely
followsarmbelief(t=105andt=120)untiltheybotharriveatdestination(t=150).
489 sensations. Inanadditionalbaseline(BL)condition,thetargetwasestimatedbythedecoder,but
490 movementwasperformedwithoutvisualfeedbackorproprioceptivenoise,inordertoallowcom-
491 parison with the typical approach in previous dynamic Active Inference studies, e.g., (Pio-Lopez
492 etal.,2016). Wealsoinvestigatedtheeffectsofsensoryandintentionprecisions,motorcontrol
493 type,andmovementonsetpolicy. Finally,weanalyzedthevisualmodelandthenatureofitsgra-
494 dientstoprovidecriticalinformationaboutthecausesoftheobservedmotorbehavior.
495 Actionperformancewasassessedwiththehelpofseveralmeasures:(i)reachaccuracy:success
496 inapproachingthetargetwithin10pixelsofitscenter, thatis, thehandtouchingthetarget; (ii)
497 reacherror: ğ¿2 hand-targetdistanceattheendofthetrial;(iii)reachstability: standarddeviation
498
ofğ¿2hand-targetdistanceduringtheperiodfromtargetreachtotheendofthetrial,insuccessful
499 trials;(iv)reachtime:numberoftimestepsneededtoreachthetargetinsuccessfultrials.
500 We also assessed target perception through analog measures based on the ğ¿2 distance be-
501 tween the target location and its estimate transformed from joint angle coordinates into visual
502 position by applying the geometric (forward) model. Specifically, we defined the following mea-
503 sures: (v)perceptionaccuracy: successinestimatingthetruetargetlocationwithin10pixels; (vi)
504
perceptionerror:ğ¿2distancebetweenthetrueandestimatedtargetpositionattheendofthetrial;
505
(vii)perceptionstability:standarddeviationoftheğ¿2distancebetweenthetargetpositionanditses-
506 timationduringtheperiodstartingfromsuccessfulestimationuntiltrialend;(viii)perceptiontime:
507 numberoftimestepsneededtosuccessfullyestimatethetargetposition.
DelayedReachingTask
508
509 The primary testbed task is a simplified version of a delayed reaching monkey task in which a
510 statictargetmustbereachedwithamovementthatcanonlystartafteradelayperiod(Breveglieri
511 etal.,2014).Delayedactionsareusedtoseparatelyinvestigateneuralprocessesrelatedtoaction
512 preparation(e.g.,perceptionandplanning)andexecutioningoal-directedbehavior.Here,thetask
513 allowsfortheseparateinvestigationofthetwomaincomputationalcomponentsoffreeenergy
514 minimization,namely,perceptualandactiveinference,whichotherwiseworkinparallel.Delayed
17of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
515 reachingcouldbeimplementedusingvariousapproaches:theupdateoftheposturecomponent
516 ofbeliefdynamicscouldbeblockedbysettingduringinferencethecorrespondingintentiongain
517 ğ‘˜to0(implementedhere): inthiswaytherearenoactiveintentionsandthebeliefonlyfollows
518 sensoryinformation;alternatively,actionexecutioncouldbetemporarilysuspendedbysettingthe
519
parameterğ›¼to1,sothattheagentstillproduceproprioceptivepredictionsbutdoesnottrustthe
520 correspondingpredictionerror: inthisscenario,thebeliefdynamicsincludeasmallcomponent
521 directedtowardstheintention,butthediscrepancyproducedisnotminimizedthroughmovement.
(a)Finalpositionswithvisualfeedback.
(b)Finalpositionswithoutvisualfeedback.
Figure6.Spatialdistributionofhandpositions(left)andcorrespondingbelief(right)pertargetattheendof
reachmovements,with(a)andwithout(b)visualfeedback.Eachpointrepresentsatrial(100trialspertarget).
522 ReachtasktrialsstartwiththehandplacedonanHBlocatedinfrontofthebodycenter(i.e.,
523 the"neck")andbeliefisinitializedwiththisconfiguration.Thenoneof9possibletargetssimilarto
524 thoseofthereferenceexperiment(Figure3b)islitred. Followsadelayperiodof100timesteps
525 duringwhichtheagentisonlyallowedtoperceivethevisibletargetandthelimb,i.e.,theinference
526 processcanonlychangebelief.Afterthat,thelimbisallowedtomove,thatis,thejointanglesare
527 updatedaccordingto(38).Asinthereferencetask,uponreachingthetarget,theagentmaintains
528 thehandonthetargetforasufficientlylongperiod, foratotalof300timestepspertrial. After
529 that,theagentreachesbacktheHB(notanalyzedhere). Thesimulationincluded100repetitions
530 pertarget,thatis,900trialsintotal.
531 As describedbefore, we assumethat the HB positionis encoded and memorizedas a belief
532 during previous experience, and therefore used to compute the (competing) reaching intention.
533 However,thiscreatesaconflictamongintentionsaimingtofulfilopposinggoals,whiletheagent
534 canphysicallyrealizeonlyoneofthematatime(Figure 4). Tofulfilonecompetingintentionat
535 atime(e.g.,reachfirstatargetandthentheHB),wecouldassumethatintentionprecisionsare
536 dynamicallymodulatedthroughhigh-level(e.g.,prefrontal)biasandmutualinhibition. Weimple-
18of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
(a)Reachandbelieferrorovertimewithvisualfeedback.
(b)Reachandbelieferrorovertimewithoutvisualfeedback.
Figure7.Performanceonthedelayedreachingtaskwith(a)andwithout(b)visualfeedback(100trialsper
condition;bandsrepresentC.I.).Thereachcriterionofhand-targetdistancelessthan10pixelsisvisualizedas
adottedline.Reachingwithvisualfeedbackresultedinamorestablehandbelief.ğ¿2normforhandbeliefis
computedbythedifferencebetweenrealandestimatedhandposition.
537 mentedthiswiththeparameterğ›½ (Equation48),whichwassettothemorerealisticvaluesof0.1
538 toactivatethereachingintentionand0.9toimplementtheintentiontoreturntotheHB.
539 Figure5illustratestheoveralldynamicActiveInferenceprocessofperceptionandmotorcon-
540 trol that implements the delayed reaching task. Following target presentation (panel a), during
541 the delay period (panels b-c), posture (blue arm) does not change since joint angles only follow
542 the belief over arm (in green), which is now kept fixed, while belief over target (purple circle) is
543 attractedbythesensoryevidence(redcircle)andgraduallyshiftstowardsit. Asexplainedabove,
544 inournovelintention-mediatedmodel,actionsaredrivenbyanattractorthatcombinesthejoint
545
effectofallintentionfunctionsselectivelyactivatedbytheğ›½parameter.Thus,whenmovementis
546 allowed(panelsd-f), bysettingğ›½ = 0.1, thecombinedattractorproducesaforcethatmovesthe
547 arm belief toward the target, which in turn generates proprioceptive predictions and therefore
548 motorcommandsthatpullthearmtowardthetarget.
549 Figures 6a and 6b show spatial statistics of the final hand location and hand belief for each
550 target,separatelyforreachingwithproprioceptiononly(openloop)orproprioceptiveandvisual
551 (closedloop)sensoryfeedbacks.Descriptivestatisticsrevealedanimportantbenefitofvisualfeed-
552 back:reachaccuracywashigher(with:88.28%;without:83.72%)andbothreachstabilityandarm
553 belief error were considerably better with visual feedback as well (stability: 1.35; error: 1.98px)
554 comparedtotheconditionwithonlyproprioception(stability: 1.78; error: 2.87px). Therefore,in
555 ourmodel,closedloopcontrolofreachingresultedinamoreprecisebehavior(Figure7),which
556 parallelsbehavioraldata(KeeleandPosner,1968).
PrecisionBalance
557
558 Theeffectofsensoryfeedbackledtoafurthermoresystematicassessmentoftheeffectsofsen-
559 soryandintentionprecisions,denotedbyğ›¼,ğœ‹ ğ‘£ğ‘¡ andğ‘˜(seeEquations46and50). Theassessment
19of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
Figure8.Effectsofprecisionbalanceonreachaccuracy(1strow),reacherror(2ndrow),i.e.,ğ¿2hand-target
distance,reachtime(3rdrow),andreachstability(4throw);fordefinitions,seetext.Reachperformanceis
shownasafunctionofarmsensoryprecisionğ›¼(left)andattractorstrengthğ‘˜(middle).Inturn,perception
performanceisshownasafunctionofsensoryprecisionovertargetğœ‹ (right).VerticalbarsrepresentC.I.
ğ‘£ğ‘¡
560 wascarriedoutonataskthatfollowedthestructureofthemaindelayedreachingtask.Wevaried
561 theaboveprecisionsoneatatime,usinglevelsshownontheabscissasinFigure8,whilekeeping
562
thenon-variedprecisionsattheirdefaultvalues.Notethatthearmprecisionofğ›¼=0corresponds
563 toreachingwithoutvisualfeedback, whiletheconditionsğ›¼ > 0correspondtoreachingwithdif-
564 ferentlevelsofarmvisibility.Werecallthatthebaselinecondition(BL)performsreachingwithout
565 visualfeedbackandproprioceptivenoise,thatis,ğ›¼ =0andğ‘¤ ğ‘ =0. Toobtainasystematicevalua-
566 tion,eachprecisionconditionwasrunonarichsetof1000randomlyselectedtargetsthatcovered
567 theentireoperationaljointanglespace. Finally,weonlyconsideredthetargetreachingintention,
568 i.e.,ğ›½ =0;everythingelsewasthesameasinthemaintask.
569 TheresultsareshowninFigure8.Thepanelsintheleftcolumnshowtheeffectofarmprecision
570
ğ›¼comparedtotheBLagentwithnoiselessproprioception.ActiveInferencewithonlypropriocep-
571
tion(i.e.,ğ›¼=0)hasalowerreachaccuracyandhighererror,incorroborationwiththeobservations
572 inthebasicdelayedreachingtask;thebestperformanceisobtainedwithbalancedproprioceptive
573 and visual input, which is the typical condition of movement with visual feedback and generally
574 allowsoptimalbehavior(KeeleandPosner,1968).Indeed,inthatcase,themotorcontrolcircuitry
20of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
Figure9.Belieferrorandstability(representingthedifferencebetweenrealandestimatedhandposition)for
differentvaluesofğ›¼.VerticalbarsrepresentC.I.
575 continuouslyintegratesallavailablesensorysourcestoimplementvisuallyguidedbehavior(Saun-
576 dersandKnill,2003).However,accuracyandstabilityrapidlydecreaseforexcessivelyhighvalues
577
ofğ›¼,duetothediscrepancyinupdatedirectionsbetweenbelief,whichmakesuseofallavailable
578 sensoryinformation,includingincreasinglymoreprecisevisualfeedback,andaction,whichinthis
579 casereliesonexcessivelynoisyproprioception.
580 Furthermore,asinthemaindelayedreachingexperiment,theeffectofvisualprecisionmanip-
581 ulationisalsoevidentinthestabilityofarmbelief,whichgraduallyimproveswiththeincreasein
582 visualinputprecision(Figure9):Inadditiontothereliabilityofthevisualinput,thiseffectisalsoa
583 consequenceofthesmalleractionupdatesduetothereducedproprioceptiveprecision.
584
Inturn,thepanelsinthemiddlecolumnofFigure8revealtheeffectofattractorgainğ‘˜;tore-
585 mindthereader,thegreaterthegain,thegreaterthecontributionofintentionpredictionerrorsto
586
thebeliefupdates.Theresultsshowthatastheintentiongainğ‘˜increases,reachaccuracygenerally
587 improvesandthenumberoftimestepsneededtoreachthetargetdecreases.However,beyonda
588 certainlevel,theaccuracytendstodecreasesincethetrajectorydynamicsbecomesunstable;thus,
589 excessivelystrongactiondragiscounterproductivetotheimplementationofsmoothmovements.
590 Finally,thepanelsintherightcolumnofFigure8showtheeffectoftargetprecisionğœ‹ ğ‘£ğ‘¡ ,which
591 directlyaffectsthequalityoftargetperception. Notethatcontrarytotheeffectofarmvisualpre-
592 cision,betterperformanceisgenerallyobtainedintermsofaccuracy,error,andperceptiontime
593 forhighervaluesofğœ‹ ğ‘£ğ‘¡ ,whichcorrespondstoaclassicaleffectofcontrastonperception,butalso
594 meansherethatarmandtargetbeliefupdatesfollowdifferentdynamics.Importantly,perception
595 stabilitydecreasesastargetprecisionlevelsincrease,whichdeservesfurtherexploration.
MotorControl
596
597 As explained earlier, motor control in Active Inference could be realized in two different ways:
598 by making use of either all sensory information, thus, the total sensory prediction error includ-
599 ingproprioceptionandexteroception(here,vision),oronlytheproprioceptivedomain. Thefirst
600 methodrequiressignificantlymorecomputationssincetheagentneedstoknowtheinversemap-
601 pingfromeverysensorydomain(generativemodel)inordertocomputethecontrolsignals;how-
602 ever,consideringtheassumptionswemade,thisapproachismorestablebecauseitupdatesboth
603 belief(stateestimation)andactionwiththesameinformation. Ontheotherhand,inthesecond
604 proprioception-basedcontrolmechanism,theproprioceptivepredictionsarecomparedwiththe
605 noisyproprioceptiveobservations,whichproducepotentiallyincorrectmovements.
606 Figure10showsacomparisonoftheperformanceofthetwomotorcontrolmethodsandthe
607 BLagentevaluatedunderthetestconditionusedtoinvestigateprecisionbalance,including1000
608 randomtargets. Weheremeasuredbeliefandreachstabilityandreachaccuracy. Theresultsre-
609 veal,first,thatthedecreasedbeliefstabilityofthefullmodelwithrespecttotheBLagent(theright
610 panel)doesnotaffecthandstabilityappreciably(themiddlepanel),althoughtheproprioceptive
611 noiseapparentlycontributestodecreasedreachaccuracy(seetheleftpanel). Moreimportantly,
612 theresultsrevealthattheproprioceptionmodelhasconsiderablylowerreachstability,whichwas
21of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
Figure10.Motorcontrolmethods.Reachaccuracy(leftpanel),reachstability(middlepanel)andbelief
stability(rightpanel)foraBLagentandthetwodifferentimplementationsofmotorcontrol,basedeitheron
allsensoryinformation(fullcontrol)oronproprioceptiononly(proprioceptivecontrol).
Figure11.Effectofmovementonsetpolicyonerror(left),stability(middle)andreachtime(right)across
severalpolicies(immediate,dynamic,fixeddelay).VerticalbarsrepresentC.I.
613 causedbyincorrectupdatedirectionsofthemotorcontrolsignalsandwhichfurthercontributes
614 todecreasingreachaccuracywithrespecttothefullmodel.
MovementOnsetPolicy
615
616 Furthermore, we investigated the effect of movement onset using several policies, which differ
617 bythedurationoftheperiodofpureperceptionprecedingfullActiveInference, i.e., perception
618 andaction. Notethatarelativelylongpureperceptionperiodisinherentinthedelayedreaching
619 task that we used so far, which differs from a typical movement-onset regimen. One such pol-
620 icythatweinvestigatehereischaracteristicofactionsperformedundertimepressure,inwhich
621 movementstartsalongwithperception,thatis,actionisimmediate. Anotherpolicythatcouldbe
622 consideredtypicalforactingundernormalconditionshasmovementbeginningwiththesatisfac-
623 tionofacertainperceptioncriterion. Thispolicydynamically deliberatestheonsetofmovement;
624 various perception criterion could be used: here, we used one according to which the norm of
625 targetbeliefğÌ‡ ğ‘¡ remainedbelowagiventhreshold(i.e.,0.01)foracertainperiodoftime(i.e.,5time
626 steps). Theseparameterswerearbitrarilychoseninconsiderationofexploratorydelayedreach-
627 ingsimulations. Finally,weincludethepreviouslyuseddelayedactionpolicyinwhichmovement
628 onsetisdelayedbyafixedtimeperiod(here,100timesteps,sufficienttoobtainaprecisetarget
629 estimation). Toobtainsystematicobservations, eachpolicywasrunon1000randomlyselected
630 reachtargetsalsointhesesimulations. Measurementsincludedreachandperceptionaccuracy,
631 motorcontrolstabilityafterreach,andtargetperceptionstability,aswellasreachtimesincethe
632 beginningofthetrialormovementonset.
633 Figure11showstheresultoftheassessmentinthethreedifferentpolicies.Althoughthereach
634 error is approximately the same in all tested conditions, the agent controlled by the immediate
635 motion-startpolicyreachedthetargetwithinthelowesttotalnumberoftimesteps:targetpercep-
636 tionandintentionsettingweredynamicallycomputedalongwithmovementonset. However, if
637 weconsiderthetotaltasktimeasamovementtime,thenumberoftimestepsisthehighestinthis
22of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
Figure12.Dynamictargets:Reach(left)andperception(right)errorovertimefor10randomtrials.
638 condition,sincearmbeliefandthearmitselfmovealongwiththeslowvisualtargetestimation.
639 Inturn,iftheagentstartsthemovementwhentheuncertaintyaboutthetargetpositionisal-
640 readyminimized(eitherinthedynamicorfixedcondition),themovementtimedecreases,although
641 themovementtimeaddedontopoftheperceptiontime(ordelayperiod)resultsinsloweractions
642 relativetotheimmediatemovementcondition. Finally,wenotethattarget(perception)stability
643 somewhatdecreasesfordynamicandfixedpolicies;thissomewhatunexpectedresultisencour-
644 agingfordynamictargettrackingtasksinwhichimmediatemovementonsetismandatory.
TrackingDynamicTargets
645
646 In a second testbed task, the agent was required to track a smooth moving target whose initial
647 locationwasrandomlychosenfromtheentireoperationaljointanglespace. Ineachtrial,thetar-
648 getsreceivedaninitialvelocityof0.1pxperstepindirectionuniformlyspanningthe0-360degree
649 range. Whenthetargetreachedaborder,itsmovementwasreflected. Asintheprevioussimula-
650 tions,thebeliefwasinitializedattheHBconfigurationandthetrialtimelimitwas300timesteps.
651 However,inorderfortheagenttocorrectlyfollowthetargets,beliefandactionweredynamically
652 andcontinuouslyinferredinparallel,thatis,withoutaperceptionperiod.
653 Figure 12 shows the reach trajectory in dynamic target tracking in 10 random trials, where
654 each line is a trial. The left panel (a) shows the evolution over time of ğ¿2 hand-target distance
655 (reacherror), whiletherightpanel(b)representstheerrorbetweentheestimatedandthetrue
656 position of the target (perception error). The results suggest that the agent is generally able to
657 correctlyestimateanddynamicallykeepupdatedthebeliefoverbothtargetandarmconfiguration
658 foralmosteverytrial,alsointhecaseofmovingtargets. Insomecases,though,mainlywhenthe
659 targetisoutofreach,itistemporarilyorpermanently"lost"intermsofitsbelief,whichalsohas
660 the consequences of losing the target in terms of reach. Further analysis with a more realistic
661 bodilyconfigurationandvisualsensorysystemandcomparisonwithactualkinematicdatashould
662 providefurtherinsightsonthecapabilitiesofActiveInferencetoperformdynamicreaching.
FreeEnergyMinimization
663
664 Figure13showsthetrajectoryofthefreeenergyderivativeswithrespecttothearmcomponentof
665 generalizedbelief(uppertworows,correspondingtothesensoryandintentionpredictionerrors,
666 respectively)andtargetbelief(bottomrow)indelayedreachingofastatictarget.Thetwocolumns
667 correspondinglyshowthetrendsforthelasttwojoints(thearmandforearmsegments)thatmost
668 stronglyarticulatethereachaction.
669 Notethatthegradientsofthefreeenergywithrespecttothetargetcomponentsofthebelief
670 arerapidlyminimizedduringtheinitialperceptualphasewhilethearmgradientsremainstill.Upon
671 actionexecution,alsothearmgradientsrapidlychange,computingnewproprioceptivepredictions
672 thatproducearmmovements, andunexpectedlycausingperceptualdisturbanceandincreased
673 freeenergyontargetbelief,whichisrapidlyminimizedagain.
23of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
Figure13.Freeenergyderivativewithrespecttothe0th-and1st-orderofgeneralizedbelief.Trialsdatais
smoothedwitha30time-stepmovingaverage.Theleft/rightcolumnsrefertoarm/forearm.
674 Hereweillustratethedynamicsoffreeenergyminimizationinreaching,whichisattheheartof
675 dynamicActiveInference.Tothataim,werunnewreachingtrialswithstaticanddynamictargets
676 andrecordedthederivativesoffreeenergywithrespecttogeneralizedbeliefandaction.
677
Figure14goesevendeeper,showingadirectcomparisonbetweenğÌ‡,ğâ€²,andğÌ‡âˆ’ğâ€²onasample
678 staticanddynamictargetreachingtrial. Werecallthatfreeenergyminimizationimpliesthatthe
679
twoframesofreference(thepathofthemodeğÌ‡ andthemodeofthepathğâ€²)shouldoverlapat
680 somepointintime,whentheagenthasinferredthecorrecttrajectory(i.e.,belief)ofthegeneralized
681 hidden states. This is crucial especially in dynamic reaching, in which the aim is to capture the
682 instantaneous trajectory of every object in the scene through encoding in terms of generalized
683 beliefcoordinates. Thedecreasingfreeenergygradients(bluelines)showthatthisaimisindeed
684 successfullyachievedinbothstaticanddynamictasks.
VisualModelAnalysis
685
686 Here, we provide an assessment of the visual sensory model whose performance is critical for
687 accurate visually guided motor control. To recall, the visual model is implemented with a VAE
688 trainedofflinetoreconstructimagesofarm-targetconfigurationssuchastheoneinFigure15a,
689 left.AcriticalVAEparameteristhevarianceoftherecognition(encoder)densityÎ£ ğœ™ (seeEquati17),
690 therefore,weevaluateditseffectonperceptionandactionbytrainingseveralVAEswithdifferent
691 variancelevels.VAEsweretrainedfor100epochsonadatasetcomprising20.000randomlydrawn
692 body-targetconfigurationsthatuniformlyspannedtheentireoperationalspace. Thetargetsize
693 varied,witharadiusrangingfrom5to12pixels. VAEperformancewasassessedonother10.000
694 randomly selected configurations that uniformly sampled the space, with target size of 5 pixels
24of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
(a)Statictargets.
(b)Dynamictargets.
Figure14.Comparisonbetweenframesofreferenceofbeliefforsamplestatic(a)anddynamic(b)trials.The
left/rightcolumnsrefertothearm/forearmsegments.
695 (thedefaultconditionfortheActiveInferencetests).
696 ThemostcriticalwastheVAEcapacitytogenerateadequateimagesofjointarm-targetconfig-
697 urations, whichwemeasuredwiththehelpoftheğ¿2 norminthevisualdomainbetweenvisual
698 observationsandVAE-generatedimages. ToprovidemoreinsightsonthetwoVAEprocesses,de-
699 codingandencoding,weproceededasfollows:first,decodingwasassessedbygeneratingimages
700 forgivenbody-targetstatessuchasthatinthemiddleofFigure15a. Thedecodedimageswere
701 comparedwiththegroundtruthimagesproducedbyapplyingthegeometricmodelforthesame
702 stateofthebodytarget(Figure15a,left).Second,fullVAEperformancewasassessedbycomputing
703
theaverageğ¿2normbetweenobservedimagesandtheirfullVAEreconstruction,i.e.,firstencoding
704 andthendecoding(Figure15a,right).Third,weassessedtheeffectofrecognitiondensityvariance
705 onactiveinferenceusingasameasuretheperformanceintheBaselineconditionofthedelayed
706 target-reachingtask.
707
Figure15b,left,representstheresultsoftheperceptualassessmenttests,showingtheğ¿2norm
708 betweentheoriginalandgeneratedimagesasafunctionofrecognitiondensityvariance. Asex-
709 pected,lowervariancegenerallyresultedinlowererrorwithrespecttobothpuredecodingandfull
710 encoding-decoding(reconstruction). Surprisingly,theaccuracyofactiveinferenceinthereaching
711 taskbehaveddifferently:thebestaccuracywasobtainednotforpredictionswithlowvariance,but
712 forintermediatevariancelevels(Figure15b,right). Thiscouldbeexplainedwiththefactthatlow-
713 varianceimagesimplyhighlynonlineargradientsthatpreventcorrectgradientdescentonfreeen-
714 ergy,whileasthevarianceincreases,thereconstructedimagebecomessomewhatblurred,which
715 helpstoobtainasmoothergradientthatcorrectlydrivesfreeenergyminimizationandtherefore
716 improvesmovementaccuracy.However,asthevariancecontinuestoincrease,thereconstructed
717 imagesbecometooblurry,degradingbeliefinferenceandmotorcontrol.
25of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
(a)Samplevisualobservationğ’” ğ‘£(left);imagedecodedfromjointangles(middle);reconstructedimage(right).
(b)ğ¿2-normbetweenobservedandreconstructedimage(left),andaccuracyofactiveinferencesimulation(right).
Figure15.Analysisoftheperceptualmodel.(a)Sampleimageanditsdecodingfromjointanglesandthrough
completeencoding-decodingprocess.(b)Qualityofperception(left)andactiveinference(right)asafunction
ofrecognitiondensityvarianceÎ£ .
ğœ™
VisualGradientAnalysis
718
719 Tofurtherinvestigatethecauseoftheunexpectedlowvarianceissue,weanalyzedtheconsistency
720 ofthevisualgradientğœ•ğ’ˆ ğ‘£ ofthedecoderforseveralencodervariancelevels. Tothisaim,wecom-
721 putedthegradientsfordifferentreference(belief)statesovertheentireoperationalspace.
722 First,Figure16arevealsthatadecoderwithmediumvariancelevels(greenline)causessmaller
723 butsmoothergradients, whiletoolowvariance(orangeline)causessharppeaksneartherefer-
724 encepointandevenincorrectgradientdirectionsinsomecases. Itthusseemsthattoolowen-
725 coder variance makes the decoder prone to overfitting, while higher variance levels help to ex-
726 tractasmootherrelationbetweenirregularmultidimensionalsensorydomainsandregularlow-
727 dimensioncauses.
728 Figure16bfurtherillustratesthearmandtargetgradientsrelativetoasamplereferencepos-
729 tureandtargetlocation(theresultissimilarforotherconfigurations),inbothCartesianandpolar
730 (jointangle)coordinates;thepolarplotshowsthetwojointsmostrelevanttothereachaction.
731 Theplotsrevealgreaterarmgradients(upperpanels)inthevicinityofthereferencelocation;
732 inthatsubspacethedecoderhaslessuncertaintyaboutwhichdirectiontochoosesotominimize
733 theerror. Notably,thesetofgradientstendstocomposenotlinearbutcurveddirections,which
734 is characteristic of biological motion. The polar plot provides critical insights into the cause of
735 the circular pattern: the gradients are mostly parallel to the horizontal axis, which corresponds
736 to a movement consisting essentially of pure shoulder rotation. Thus, the gradients provide a
737 strongdrivingforceontheshoulderalmostthroughouttheoperationalspace,whiletheareain
738 whichtheelbowiscontrolledislimitedtothevicinityofthereferencepoint(e.g.,targetlocation).
739 Thesegradientsresultinatwo-phasereachingofstatictargetsinwhichtheagentfirstrotatesthe
740 shoulder(implementingahorizontalpositioning)andthenstartstorotatetheelbowassoonasthe
741 latterentersitsareaofattraction(regulatingthedistancebetweentheanchorpointandthetipof
742 thearm).Thesamegradientscanexplainthelinearmotionpatternofanarmtrackingdynamically
26of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
(a)Marginalgradientsforeachjoint(separatepanels)andtwolevelsofrecognitiondensityvarianceÎ£ ğœ™(green/orange
line)computedbybackpropagatingtheerrorbetweenimageswithdifferentarmconfigurations(jointangle:abscissa)
andtheimageofareferencearmconfiguration(referenceangle:reddot).
(b)Gradientsforarm(top)andtarget(bottom)inbothCartesian(left)andjoint(right)space.
Figure16.Visualgradientanalysis.[ğœƒ ,ğœƒ ,ğœƒ ]refertothestateofneck/shoulder/elbowjoints.
0 1 2
743 movingtargets,whenthearmisclosetothetarget(orreferencebelief):inthatcase,allgradients
744 providemotionforceasexplainedabove.
745 Ontheotherhand,thegradientsrelativetothetargetbelief(bottompanels)behavesomewhat
746 differently:sincethisbeliefisunconstrainedandcanfreelymoveintheenvironment,updatedirec-
747 tionsmoredirectlyapproachthetargetinallangularcoordinates(seethepolarplottotheright).
748 Yet,linearbeliefupdatesinthepolarspacestilltranslatetocurvedirectionsintheCartesianspace.
DISCUSSION
749
750 WepresentedanormativecomputationaltheorybasedonActiveInferenceofhowneuralcircuitry
751 inthePPCandDVSsupportsvisuallyguidedgoal-directedactionsinadynamicallychangingenvi-
752 ronment.OurfocuswasonthecomputationalbasisofencodingdynamicactiongoalsinthePPC
753 throughflexiblemotorintentions. Thetheoryisbasedonpredictivecoding(Doya,2007;Hohwy,
754 2013)andActiveInference(Friston,2010)andevidencesuggestingthatthePPCperformsvisuo-
755 motortransformations(Fattorietal.,2017;GallettiandFattori,2018;CisekandKalaska,2010)
27of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
756 andencodesmotorplans(Andersen,1995).Accordingly,thePPCisproposedtomaintaindynamic
757 expectationsofboththecurrentanddesiredfuturelatentstatesofboththebodyandtheenvi-
758 ronmentandusethemtogenerateproprioceptivepredictionsthroughahierarchicalprocessat
759 themotorcortexandsubcorticalstructuresthatdescendviaefferentsdowntothemotorreflex
760 arcs that ultimately generate movements (Adams et al., 2013; Versteeg et al., 2021). On the ex-
761 teroceptive side, the DVS is proposed to encode a generative model that translates latent-state
762 expectationsintovisualpredictions; discrepanciesbetweensensory-levelpredictionsandactual
763 sensationsproducepredictionerrorsthataresentbackthroughthecorticalhierarchytoimprove
764 the latent-state expectations. The theory unifies research on intention coding in the PPC (Sny-
765 deretal.,1997)andcurrentviewsthatthePPCestimatesthebodyandtheenvironmentalstate
766 (MedendorpandHeed,2019),providingspecificcomputationaldetailsregardingtheinvolvement
767 ofthePPCingoal-directedbehaviorwhichextendsomeperception-boundpredictivecodinginter-
768 pretationsofthePPCdynamics(FitzGeraldetal.,2015).
769 ActiveInferenceunifiespredictivecodingandmotorcontrolthroughdynamicBayesianinfer-
770 ence; itlearnsajointrepresentationofthelatentdynamicsoftheenvironmentandthebodyto
771 interpretthesensoryinformationandissuecontrolsignalsthroughiterativeminimizationoffree
772 energy (Friston, 2010, 2011; Friston et al., 2010). Variational free energy minimization approxi-
773 matelysolvesthehighlycomplexsensoryinterpretationproblemthatallbiologicalsystemsfacein
774 ordertoactefficiently,bymaintainingageneralizedbeliefovercurrentlatentstatesoftheworld
775 anditsdynamics,anditerativelyupdatingittoaccommodatenoisysensoryobservations.Assum-
776 ingamultivariateGaussianformforthegenerativemodelstryingtopredicttheseobservations,
777 inference reduces to the minimization of generalized prediction errors, so that the belief most
778 closelycorrespondstobothpriorexpectationsandsensoryobservations.ActiveInferencefurther
779 minimizespredictionerrorsthroughactionsaimingtofulfilprior-biasedsensory-levelpredictions,
780 thusrealizingtheseexpectations: indeed, foranagenttorestrictitselfwithinasetofpreferred
781 statesdefinedbyitsphenotypeandsurvive,itsgoalisnotonlytoinferabeliefoverthecausalrela-
782 tionshipoftheexternalworld,butalsotoactandsamplethosestatesthatmakethebelieftrue.In
783 thisview,anagentcontrolledbyActiveInferencedoesnotpursuespecificpoliciesbymaximizing
784 externalrewardsasinclassicalcontroltheories,butbyrealizationofgeneralpriorbeliefs.
785 In fact, a goal could be set in Active Inference as a prior over the dynamics function (which
786 specifiestheevolutionofhiddenstatesovertime), eitherbyasensory-levelprediction, whichis
787 comparedwiththeactualsensoryobservationtogenerateanerrordrivingbeliefupdate(Sancak-
788 taretal.,2020;Oliveretal.,2019;Pio-Lopezetal.,2016),ordirectlyasatargetinthebeliefspace
789 (Baioumyetal.,2020). WeproposethatthePPCimplementsamoreflexiblesolution,whichuses
790 latent-stateestimates,thatis,beliefovertheenvironment,toformalizeflexiblegoalsatthelatent
791 state-levelintermsofasetofintentionsandintentionfunctions,eachencodingandcomputing
792 adesiredfuturebelief(seeEquation39).Aspecificintentionisselectedamongothercompetitive
793 intentionspossiblyunderthecontrolofthePFCandPMd(Stoianovetal.,2016)andfulfilledby
794 settingitasapredominantbelieftrajectoryinthegeneralizedformofbelief,i.e.,asabeliefattrac-
795 torwithstronggain(seeEquations41and26andFigure4).Forexample,inatypicalreachingtask,
796 thegoalofreachingaspecificvisualtarget(amongothercompetitivetargets)correspondstothe
797 futureexpectationthattheagentâ€™sarmwillbeoverthattarget;thus,iftheagentmaintainsabe-
798 liefoverthetargetâ€™sposition,thecorrespondingintentionlinkstheexpectedbeliefoverthefuture
799 bodyposturewiththebeliefoverthecurrentlyinferredtarget,expressedinjointanglecoordinates,
800 whichthusencodesaspecificinteractiontorealize,dependingonobjectaffordances.
801 WethereforeproposethatthePPCimplementsacomputationalcircuitryinwhichgeneralized
802 belief encodes trajectories of bodily states and objects in the environment and uses that belief
803 tocomputeanattractorencodingintentions,e.g.,tointeractwithaparticularobject. Duringfree
804 energy minimization, the intention is compared with the current belief to produce an intention
805 predictionerrordrivingtheagenttowardsthestateitexpectstoperceiveinthefuture,bothmen-
806 tally,intermsofbeliefsoverbodily(proprioceptive)state,andphysically,throughactionsfulfilling
28of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
807 proprioceptivepredictionsthatcorrespondtothedesiredbeliefs. Theattractor(intention)could
808 beestimateduponappearanceofatargetandkeptfixed,thusactingasamemoryholder-such
809 astheHBinourtests-(Snyderetal.,1997;AndersenandCui,2009)oritcouldbedynamicallyup-
810 dated(e.g.,incaseofamovingtarget),thusimplementingflexibleintentions. Staticanddynamic
811 targetscouldbesetandacteduponundervariousconditionsofvisibility(e.g.,illumination,sensory
812 noise,temporalocclusion,etc.)andfeedback(openvs.closedloopsensorimotorcontrol,Todorov
813 (2004)). Finally, as mentioned above, the PFC could mediate intention-setting and moreover set
814 andmanageaseriesofintentionsimplementingcomplexmulti-steptasks.
815 Beyondperceptualaccounts(FitzGeraldetal.,2015), faithfulbody-stateencodingproposals,
816 and flexible sensory-action linking (Medendorp and Heed, 2019), our theory postulates that the
817 PPC encodes belief over the body state that is biased towards desired future (intended) states
818 anddoesnotexactlyencodeitstruestate. Infact,future-orientedbiasinbelief-whichdepends
819 on the magnitude of the intention precisions and gains - is the principal generator of action in
820 continuousActiveInference:inthisframework,faithfulbodystateestimatewithoutintentionbias
821 willdrivenoaction. Moreover,thetheorypostulatesthatthePPCmaintainsbeliefoverpotential
822 environmentaltargets,andmostcritically,thatthebeliefoveraselectedtargetisdynamicallyset,
823 orlinkedasactiongoal,thatis,motorintention. Thisaspectisclosetoanotherviewaccordingto
824 whichthePPCencodestaskswhilebodilystatesareencodedelsewhere,i.e.,inthesomatosensory
825 andmotorcortices(HaarandDonchin,2020). Thatlatteraspectisinherentinpredictivecoding
826 undertheassumptionthattheseareasencodehierarchicalgenerativemodelsofbodystateand
827 motorcontrol,whichweabstractedaltogetherwithasimpleproprioceptivegenerativemodel.
828 Inlightofthesetheoreticalconsiderations,thetheorypredictsseveraldifferenttypesofcorre-
829 latesinthePPCrelatedtoenvironment,task,andbodystates. Theformertwoincludecorrelates
830 ofpotentialspatialtargetsandoftheselectedgoalpositions,thatis,intentions,ormotorgoal,and
831 thoseindeedhavebeenconsistentlyfoundinthePPC(Andersen,1995;Snyderetal.,1997;Filip-
832 pinietal.,2018).Thelatterincludescorrelatesofintention-biasedbodilystateestimatewhichthus
833 arenotpreciserepresentationofthetruestatebutarestillmuchclosertoitthantotheintended
834 position(seemoreonthisinsectionPrecisionBalanceandConditionsforDisorders).Furthermore,
835 theuseofgeneralizedbeliefinActiveInferencepredictsthatthePPCencodesnotonlystaticstates
836 anderrors,butalsoadetailedestimateofbodydynamics,uptoafewtemporalorders.Indeed,a
837 bodyofliteraturereportmotion-sensitive,orVision-for-ActionactivityintheDVPandthePPC(Gal-
838 lettiandFattori,2018),towhichActiveInferencegivesadetailedcomputationalaccount. Finally,
839 anothersetofcorrelationsregardspredictionerrors.Infact,sinceinActiveInferencebeliefisesti-
840 matedthroughdynamicpredictionerrorminimization,body-environmentaltransitionsinvolving
841 changeofstatesandtaskswillresultintransientburstsofactivityinerror-conveyingcellsuntilthe
842 errorisminimized. Predictionerrorsconveyingupstreaminformationareputativelyencodedby
843 pyramidal cortical cells in superficial layers while downstream predictions are encoded by deep
844 pyramidalneurons(Parretal.,2022).
845 Wetestedthecomputationalfeasibilityofthetheoryonaclassicalinelectrophysiologydelayed
846 reaching task in which a monkey is required to reach with its hand a visually presented spatial
847 target,startingmovementfromaHB(Breveglierietal.(2014),Figure3b).Todothis,wesimulated
848 an agent consisting of a coarse 3-DoF limb model and noisy visual and proprioceptive sensors
849 (Figure 3a). Simplified proprioceptive sensors provided a noisy reading of the state of the limb
850 injointanglecoordinates,whilevisualinputwasprovidedbyafixedcameraandconsistedofan
851 image of the target and the limb. Predictive visual sensory processing simulating the DVS was
852 implementedwithavariationalautoencodertrainedtoinferbodystateandtargetlocation,both
853 inthejointangledomain(Figure3c,15a).Thelimbswereanimatedatthevelocity-levelwithmotor
854 controlsignalscomputedbythevisuallyguidedActiveInferencecontroller.
855 Thecomputationalanalysisshowed,firstandmostimportantly,thatthecontrollercouldcor-
856 rectlyinferthepositionofthevisualtargets(Figure5a-c),useittocomputeandsetmotorgoalsin
857 termsofpriorbeliefsonthefuturebodystatethroughintentionfunctions,andperformadequate
29of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
858 andsmoothreachmovements(Figure5d-f)underbothclosedandopenloopconditions,thatis,
859 withandwithoutvisualfeedbackofcurrentpostureduringreachmovement(Figure6).
860 Wethensystematicallyinvestigatedtheeffectofnoise(orprecision)onvariousfunctionalcom-
861 ponentsinthecurrentimplementation(Figure8),startingwiththebalanceofself-perceptionpre-
862 cision between proprioceptive and visual sensory model: a noiseless Active Inference agent (BL
863 condition)resultedinthebestperformance,withastablefinalapproachandaccuracyonlylimited
864 bythequalityofvisualtargetestimation.Amongthenoisyconditions,pureproprioceptivecontrol
865 resultedinthelowestperformance,asexpected.Motorcontroldrivenbybothproprioceptiveand
866 visualfeedbackwithbalancedprecisionbetweenthetwodomainsresultedinimprovedreachac-
867 curacyandgreatlyimprovedarmbeliefstability(Figure9).Theeffectonaccuracywasmainlydue
868 totheinclusionofvisualinformationinbeliefinference,butalsototheslowerupdatesofmotor
869 controlsignalsduetothedecreasedconfidenceinproprioceptiveinput.
870 The increased stability of arm belief did not improve movement stability as increasing confi-
871 denceinvisualinputalsoincreasedthediscrepancybetweenbeliefandactionupdate,sincethe
872 latteronlyreliesonnoisyproprioceptiveobservations. Infact,weshowedthatifweremovethe
873 plausibilityconstraintthatmotorcontrolisdrivenonlybyproprioceptivepredictionsandthuslet
874 actionsminimizepredictionerrorsfromallsensorydomains,reachperformanceandarmbelief
875 stabilitygreatlyincrease(Figure10). Inparticular, anycombinationofvisualandproprioceptive
876 feedbackimprovedperformancerelativetocontroldrivenbyfeedbackfromasinglesensorydo-
877 main.
878 Ontheotherhand,theinstabilityduetothedifferenceinupdatedirectionsbetweenbeliefand
879 actioncouldbebalancedbyothermechanismsthatwehavenotconsideredhere. Forexample,
880 weassumedthatthesamepathwayisusedforbothcontrolandbeliefinference,butitseemsthat
881 themotorcortexgeneratesdifferentpredictionsdependingonthebrainareaswhichitinteracts
882 with: purely proprioceptive predictions for motor control, whose prediction error is suppressed
883 atthelowestlevelofthehierarchy,andrichsomatosensorypredictionsforlatentstateinference,
884 whichintegratessomaticsensationsatdifferenthierarchicallevels(Adamsetal.,2013).
885 Intention precisions or attractor gains affected performance, too. First, they affected reach
886 time:asexpected,thegreaterthegain,thefasterthemovement.However,fastmovementscome
887 at a cost: increased gains generally resulted in less precise movements and decreased stability
888 during the final reach period. Finally, higher visual target precisions decreased perception time
889 andimprovedperceptionaccuracy,butdecreasedperceptionstability.
890 Wealsoinvestigatedtheeffectsofmovementonsetpolicy:responsedelayallowsinvestigating
891 perceptualandmotorpreparatoryprocessesseparatelyfrommotorcontrolandactionexecution.
892 Wefoundthatdelayedresponsedecreasedmovementtimewithrespecttoapolicythatrequires
893 immediate response (Figure 11), which fits the behavioral pattern (Shenoy et al., 2013). Appar-
894 ently,thisisduetotheneedofestimating,inthelattercondition,thetargetposition"onthefly",
895 andconstantlyadaptingtheintention(body-stateattractor)accordingtotheupdatedestimateof
896 thetargetbelief. Theadvantageofallowingsomepreparatorytimebecomesclearinananecdo-
897 talfly-catchingtask: thiswillresultinfastermovement,thus,increasedchancesofsuccess. This
898 comeswiththecriticalcontributionof PPCneuronswhichsystematicallymodulatetheiractivity
899 duringthepreparatoryperiod(Shenoyetal.,2013),andhereprovidedspecificpredictionsforthe
900 computationsperformedinthePPC.
901 Notably,theimmediate-responsepolicyallowedtheActiveInferencecontrollertoperformac-
902 tionsunderdynamicenvironmentalconditions,suchastrackingmovingobjects.Freeenergymin-
903 imizationresultedinrapidtargetdetectionalsointhiscase,andmaintainedsubthresholdpercep-
904 tionerroronmovingtargets(Figure12),thatallowedprecisetargettrackingafteraninitialtarget-
905 reachperiod. Thus,theagentwasabletomaintaincorrectbeliefestimatesoverbothadynamic
906 targetandbodyposture(thearmconfiguration)anddynamicallyupdatetheintentionsaccording
907 tothecurrenttargetposition.
908 Free energy minimization over generalized belief is at the heart of the performance of goal-
30of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
909 directed Active Inference. That is, achieving dynamic goals (here, reaching a visual target) was
910 possiblebydynamicallysettingcontinuouslychangingattractorsderivedfromthecurrentbelief
911 on the latent state of the environment (i.e., target configuration) and minimizing the difference
912 betweentheattractorsandthebelief. Infact,weshowedthattheagentwasabletoquicklyinfer
913 andmaintaintheinstantaneoustrajectoryofthelatentstates,underbothstaticanddynamictarget
914 conditions(Figure14).
(a)Normal:strongsensorygain,unambiguoustarget. (b)Abnormal:excessivelystrongintentiongain.
(c)Abnormal:ambiguoustarget.
Figure17.Normalandabnormalintentiongainsandprecisions.Arrowwidthrepresentsstrengthof
predictionerrors.(a)Innormalconditions,thesensorycontributiontofreeenergyminimizationisbiggerthan
thatoftheintentionsandthereisaclearintentiontofulfil.(b)Abnormallystrongintentiongainğ‘˜drivesbelief
awayfromthetruejointstate.(c)Too-closeprecisionlevelsğœ¸hinderimplementinganycompetingintention.
PrecisionBalanceandConditionsforDisorders
915
916 Basedonourcomputationalanalysis,itbecomesclearthatsomemotorandbehavioraldisorders
917 couldbeduetothelackofpropersensoryandintentionprecisions(Adamsetal.,2021).Here,we
918 illustratethenormalconditionandtwotypesofpotentiallyimproperprecisionbalancethatcould
919 becomeacausalconditionforneurologicaldisorders.
920 Tobeginwith,Figure17aillustratestheconditionfornormalfunctioning,whichissuchthatthe
921 contributionofasingleintentiontobeliefupdate(which,asremindertothereader,isproportional
922
tothegainofintentionsğ‘˜)issufficientlysmallwithrespecttothesensorycontribution.Inthiscase,
923 during free energy minimization, the system dynamics smoothly moves the belief towards the
924 strongestgoal,alongwithprecisetrackingofthetruelatentstateandsensorysignalofthelimbs,
925 allowingthustocomputecorrectmotorcontrolerrorsandperformsmoothactionexecution.
926 A critical abnormal condition is one in which the intention gain ğ‘˜ is too strong, as illustrated
927 in Figure 17b. In this case, the belief moves too rapidly towards the goal without being able to
928 matchtheproprioceptiveobservations,whichresultincomputingincorrectmotorcontrolsignals.
929
Anotherabnormalconditioniscausedbytoocloseprecisionsğœ¸ofcompetitiveintentions,whichis
31of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
930 likelytoresultinopposingbeliefupdatesandthuspreventthefulfillmentofanyofthecompeting
931 goals (as in Figure 17c). This situation might manifest itself in terms of motor onset failure or
932 oscillatorybehavior.
LimitationsandFutureDirections
933
934 Our focus here was on lower-level intention coding in the PPC, which directly deals with motor
935 plansandmotorcontrol. Furtherelaborationswillextendthetheorywithhigher-levelaspectsof
936 cognitivecontrol,includingintentionstructuring(dealtbyPM),phasing(SMA)(Gallegoetal.,2022),
937 planning,andgoalselection(HC,PFC)(Stoianovetal.,2016;Pezzuloetal.,2019).
938 Motorcontroloperatedhereinaninnerbeliefspacebelongingtothejointangledomain,which
939 isgenerallysuboptimalintheexternalCartesianspace.Infact,weassumedthatneuralactivityin
940 thePPCencodesgeneralizedbeliefsovertargetsandbodyinamotor-relateddomain; however,
941 neuraldatasuggestthatneuronsinthemotorcortexencodemotortrajectoriesalsoinextrinsic
942 coordinates(Adamsetal.,2013;CohenandAndersen,2002), andamorerealisticmodelshould
943 includerepresentationsencodingstatesinbothintrinsicandextrinsicframesofreference.Afunc-
944 tionalcorrelateofthemotorcortexshouldrepresentfuturestates-whichweredefinedhereimplic-
945 itlyintheintentionpredictionerrorsanddynamicsfunctions-andtransformdesiredtrajectories
946 fromCartesiancoordinatestoproprioceptivepredictionsinintrinsicstate-space.Thistransforma-
947 tionisdifferentfromoptimalcontrolplanningsincetheoptimizationofaclassicalinversemodel
948 reducestoamoremanageableinferenceproblem.Finally,althoughfreeenergyminimizationina
949 singlebeliefdomainisfasterandmoreparsimonious,moreprecisevisuallyguidedmotorcontrol
950 shouldincludecontinuousactivationofvisualhand-targetattractorsatacertain"neuralenergy"
951 cost,sincemotorareasinteractwithandgeneratepredictionsinmultiplesensorydomains(e.g.,
952 somatosensory).
953 Thecurrentimplementationjustpartiallycoversthethreemaindomainsofsensorimotorlearn-
954 ing through fitting a predictive forward control; for example, it does not fully include reactive,
955 stimuli-driven control such as obstacle avoidance, although we show that it can perform static
956 anddynamictasks(targetreaching/tracking).
957 Since our focus was on the theoretical introduction of intentionality in Active Inference, per-
958 ceptual inference, visually guided sensorimotor control, and motor behavior of the specific im-
959 plementationwereonlypartiallycharacterizedinasimplereachingtask. However,fundamental
960 properties of the physical model, including geometry, mass, and friction, strongly influence the
961 resultingmotiondynamics,andthustheentireinferentialprocess.Thisimplementationdoesnot
962 adoptotherimportantneuralandbiomechanicalspecificitiessuchassignaldelayandjointfriction
963 (WolpertandFlanagan,2016);also,itonlyincludesproprioceptiveandvisualfeedback.However,it
964 couldbeeasilyextendedtoaccommodateothersensorymodalities(e.g.,tactilesensations)witha
965 richgenerativemodelsuchasthevisualonehereimplemented.Therefore,furtherplannedcom-
966 putational analysis will use a more realistic physical arm model, additional actuators, extended
967 beliefspace, andextendthecomplexityoftheintentionfunctionsinordertoinvestigatetheca-
968 pacityofthetheorytoexplainin-depthneural-level,cognitive,andkinematicphenomenarelated
969 tomotorlearning,motionperception,motorplanning,andsoon.
970 AlthoughweconsideredActiveInferencewithjustasinglelayerofintentions,thestructurerep-
971 resentedinFigure2couldbescaledhierarchicallybyconsideringintermediategoalsbetweenhigh-
972 levelintentionsandlow-levelsensorygenerativemodels,forexample,bycombiningdiscreteand
973 continuousActiveInferenceforplanningandmovementexecution(Fristonetal.,2017a,b;Parr
974 etal.,2020;Sajidetal.,2021). Accordingtothefreeenergyprinciple,theagentwillthenchoose
975 goalsandsubgoalsandrelyonspecificsensorymodalitiessuchthatfreeenergyisminimizedat
976 everylevelofthehierarchybasedonthepredictionerrorcomingfromthelevelbelow.Thishierar-
977 chicalformalizationwillprovideanexplicitbasisformotorplanning,includingtaskssuchasobject
978 manipulation.Indeed,althoughthecurrentimplementationperformswellonspatialtaskssuchas
979 reachinginadynamicallychangingenvironment,itcannotimplementcompositegoalswhichthe
32of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
980 brainneverthelessneedstohandle,wherethecurrentmodelwillfailtoprovideacorrectdirection
981 ofbeliefandactionupdate. Therefore,thedesiredbeliefshouldbesufficientlysimple,e.g.,con-
982 sistingofplainspatialtargets,inorderforthesensorygenerativemodelstofindacorrectgradient
983 (indeed,allthehardworkofmotorplanningisessentiallyassignedtothem). Ontheotherhand,
984 anagentwithanenhancedhierarchicalstructureofbeliefthathasthepossibilitytoencodehigher
985 level intentions in a discrete domain and infer policies based on the expected free energy will be
986 abletodynamicallymodifyitsbehaviorinordertoreacttoenvironmentalchanges. Anextended
987 implementation of this kind will be an interesting and more biologically plausible alternative to
988 standardreinforcementlearning(Stoianovetal.,2018).
ACKNOWLEDGEMENTS
989
990 ThisresearchreceivedfundingfromtheEuropeanUnionâ€™sHorizon2020FrameworkProgramme
991 forResearchandInnovationunderH2020-EIC-FETPROACT-2019GrantAgreement951910(MAIA)
992 toIS,GrantAgreementNo945539(HumanBrainProjectSGA3), theEuropeanResearchCouncil
993 underGrantAgreementNo.820213(ThinkAhead),andfromtheItalianMinistryforResearchMIUR
994 underGrantAgreementPRIN2017KZNZLN(PACE)toIS.
References
995
996 AdamsRA,ShippS,FristonKJ. Predictionsnotcommands:Activeinferenceinthemotorsystem. BrainStruc-
997 tureandFunction.2013;218(3):611â€“643.doi:10.1007/s00429-012-0475-5.
998 AdamsRA,VincentP,BenrimohD,FristonKJ,ParrT. Everythingisconnected: Inferenceandattractorsin
999 delusions.SchizophreniaResearch.2021;(March).doi:10.1016/j.schres.2021.07.032.
1000 AndersenRA.Encodingofintentionandspatiallocationintheposteriorparietalcortex.CerebralCortex.1995;
1001 5(5):457â€“469.doi:10.1093/cercor/5.5.457.
1002 AndersenRA,CuiH.Intention,ActionPlanning,andDecisionMakinginParietal-FrontalCircuits.Neuron.2009;
1003 63(5):568â€“583.http://dx.doi.org/10.1016/j.neuron.2009.08.028,doi:10.1016/j.neuron.2009.08.028.
1004 BaioumyM,DuckworthP,LacerdaB,HawesN. Activeinferenceforintegratedstate-estimation,control,and
1005 learning.arXiv.2020;.
1006 BaltieriM,BuckleyCL. PIDcontrolasaprocessofactiveinferencewithlineargenerativemodels. Entropy.
1007 2019;21(3).doi:10.3390/e21030257.
1008 Bastos AM, Usrey WM, Adams RA, Mangun GR, Fries P, Friston KJ. Canonical Microcircuits for Pre-
1009 dictive Coding. Neuron. 2012; 76(4):695â€“711. http://dx.doi.org/10.1016/j.neuron.2012.10.038, doi:
1010 10.1016/j.neuron.2012.10.038.
1011 BishopCM.PatternRecognition&MachineLearning.NewYork,NewYork,USA:Springer;2006.
1012 BogaczR. Atutorialonthefree-energyframeworkformodellingperceptionandlearning. JournalofMathe-
1013 maticalPsychology.2017;76:198â€“211.doi:10.1016/j.jmp.2015.11.003.
1014 BreveglieriR,GallettiC,DalBÃ²G,HadjidimitrakisK,FattoriP.MultipleAspectsofNeuralActivityduringReach-
1015 ingPreparationintheMedialPosteriorParietalAreaV6A.Journalofcognitiveneuroscience.2014;26(4):879â€“
1016 895.doi:10.1162/jocn_a_00510.
1017 BuckleyCL,KimCS,McGregorS,SethAK.Thefreeenergyprincipleforactionandperception:Amathematical
1018 review.JournalofMathematicalPsychology.2017;81:55â€“79.doi:10.1016/j.jmp.2017.09.004.
1019 CisekP,KalaskaJF. NeuralMechanismsforInteractingwithaWorldFullofActionChoices. AnnualReviewof
1020 Neuroscience.2010;33:269â€“298.doi:10.1146/annurev.neuro.051508.135409.
1021 CohenYE,AndersenRA. Acommonreferenceframeformovementplansintheposteriorparietalcortex.
1022 NatureReviewsNeuroscience.2002;3(7):553â€“562.doi:10.1038/nrn873.
1023 CorbettaM,ShulmanGL.Controlofgoal-directedandstimulus-drivenattentioninthebrain.NatureReviews
1024 Neuroscience.2002;3(3):201â€“215.doi:10.1038/nrn755.
33of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
1025 DesmurgetM,EpsteinCM,TurnerRS,PrablancC,AlexanderGE,GraftonST.PPCandvisuallydirectingreaching
1026 totargets.NatureNe.1999;2(6):563â€“567.doi:doi.org/10.1038/9219.
1027 DoyaK.BayesianBrain:ProbabilisticApproachestoNeuralCoding.PressM,editor;2007.
1028 FattoriP,BreveglieriR,BoscoA,GamberiniM,GallettiC. VisionforPrehensionintheMedialParietalCor-
1029 tex.CerebralCortex.2017;27(February):1149â€“1163.http://cercor.oxfordjournals.org/cgi/doi/10.1093/cercor/
1030 bhv302,doi:10.1093/cercor/bhv302.
1031 Filippini M, Breveglieri R, Ali Akhras M, Bosco A, Chinellato E, Fattori P. Decoding information for grasp-
1032 ingfromthemacaquedorsomedialvisualstream. JournalofNeuroscience.2017;37(16):4311â€“4322. doi:
1033 10.1523/JNEUROSCI.3077-16.2017.
1034 FilippiniM,BreveglieriR,HadjidimitrakisK,BoscoA,FattoriP.PredictionofReachGoalsinDepthandDirection
1035 fromtheParietalCortex.CellReports.2018;23(3):725â€“732.https://doi.org/10.1016/j.celrep.2018.03.090,doi:
1036 10.1016/j.celrep.2018.03.090.
1037 FitzGerald THB, Moran RJ, Friston KJ, Dolan RJ. Precision and neuronal dynamics in the human
1038 posterior parietal cortex during evidence accumulation. NeuroImage. 2015; 107:219â€“228. doi:
1039 10.1016/j.neuroimage.2014.12.015.
1040 FogassiL,FerrariPF,GesierichB,RozziS,ChersiF,RizzolottiG. Parietallobe: Fromactionorganizationto
1041 intentionunderstanding.Science.2005;308(5722):662â€“667.doi:10.1126/science.1106138.
1042 FristonKJ,Trujillo-BarretoN,DaunizeauJ. DEM:Avariationaltreatmentofdynamicsystems. NeuroImage.
1043 2008;41(3):849â€“885.doi:10.1016/j.neuroimage.2008.02.054.
1044 Friston K. Hierarchical models in the brain. PLoS Computational Biology. 2008; 4(11). doi: 10.1371/jour-
1045 nal.pcbi.1000211.
1046 FristonK. Thefree-energyprinciple:Aunifiedbraintheory? NatureReviewsNeuroscience.2010;11(2):127â€“
1047 138.http://dx.doi.org/10.1038/nrn2787,doi:10.1038/nrn2787.
1048 FristonK. Whatisoptimalaboutmotorcontrol? Neuron.2011;72(3):488â€“498. http://dx.doi.org/10.1016/j.
1049 neuron.2011.10.018,doi:10.1016/j.neuron.2011.10.018.
1050 FristonK. ThehistoryofthefutureoftheBayesianbrain. NeuroImage.2012;62(2):1230â€“1233. http://dx.doi.
1051 org/10.1016/j.neuroimage.2011.10.004,doi:10.1016/j.neuroimage.2011.10.004.
1052 FristonK,KiebelS.Predictivecodingunderthefree-energyprinciple.PhilosophicalTransactionsoftheRoyal
1053 SocietyB:BiologicalSciences.2009;364(1521):1211â€“1221.doi:10.1098/rstb.2008.0300.
1054 FristonK,MattoutJ,Trujillo-BarretoN,AshburnerJ,PennyW.VariationalfreeenergyandtheLaplaceapprox-
1055 imation.NeuroImage.2007;34(1):220â€“234.doi:10.1016/j.neuroimage.2006.08.035.
1056 FristonKJ.Functionalintegrationandinferenceinthebrain.Progressinneurobiology.2002oct;68(2):113â€“43.
1057 http://www.ncbi.nlm.nih.gov/pubmed/12450490.
1058 FristonKJ. Atheoryofcorticalresponses. PhilosophicaltransactionsoftheRoyalSocietyofLondonSeriesB,
1059 Biologicalsciences.2005apr;360(1456):815â€“36.http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=
1060 1569488{&}tool=pmcentrez{&}rendertype=abstract,doi:10.1098/rstb.2005.1622.
1061 FristonKJ,DaunizeauJ,KiebelSJ. Reinforcementlearningoractiveinference? PLoSONE.2009; 4(7). doi:
1062 10.1371/journal.pone.0006421.
1063 FristonKJ,DaunizeauJ,KilnerJ,KiebelSJ.Actionandbehavior:Afree-energyformulation.BiologicalCybernet-
1064 ics.2010;102(3):227â€“260.doi:10.1007/s00422-010-0364-z.
1065 FristonKJ,MattoutJ,KilnerJ. Actionunderstandingandactiveinference. Biologicalcybernetics.2011feb;
1066 104(1-2):137â€“60.doi:10.1007/s00422-011-0424-z.
1067 FristonKJ,ParrT,deVriesB.Thegraphicalbrain:Beliefpropagationandactiveinference..2017;1(4):381â€“414.
1068 http://dx.doi.org/10.1162/NETN_a_00018,doi:10.1162/NETN.
1069 FristonKJ,RoschR,ParrT,PriceC,BowmanH.Deeptemporalmodelsandactiveinference.Neuroscienceand
1070 BiobehavioralReviews.2017;77(November2016):388â€“402.http://dx.doi.org/10.1016/j.neubiorev.2017.04.009,
1071 doi:10.1016/j.neubiorev.2017.04.009.
34of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
1072 FristonKJ,SamothrakisS,MontagueR. Activeinferenceandagency: optimalcontrolwithoutcostfunctions.
1073 Biologicalcybernetics.2012;(106):523â€“541.doi:10.1007/s00422-012-0512-8.
1074 Gallego JA, Makin TR, McDougle SD. Going beyond primary motor cortex to improve brainâ€“computer in-
1075 terfaces. Trends in Neurosciences. 2022; 45(3):176â€“183. https://doi.org/10.1016/j.tins.2021.12.006, doi:
1076 10.1016/j.tins.2021.12.006.
1077 GallettiC,FattoriP. Thedorsalvisualstreamrevisited: Stablecircuitsordynamicpathways? Cortex.2018;
1078 98:203â€“217.https://doi.org/10.1016/j.cortex.2017.01.009,doi:10.1016/j.cortex.2017.01.009.
1079 GamberiniM,PassarelliL,FilippiniM,FattoriP,GallettiC.Visionforaction:thalamicandcorticalinputstothe
1080 macaquesuperiorparietallobule.BrainStructureandFunction.2021;226(9):2951â€“2966.https://doi.org/10.
1081 1007/s00429-021-02377-7,doi:10.1007/s00429-021-02377-7.
1082 GenovesioA,TsujimotoS,WiseSP.Encodinggoalsbutnotabstractmagnitudeintheprimateprefrontalcortex.
1083 Neuron.2012may;74(4):656â€“62.http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3400847&tool=
1084 pmcentrez&rendertype=abstract,doi:10.1016/j.neuron.2012.02.023.
1085 GoodfellowIJ,BengioY,CourvilleA. DeepLearning. Cambridge, MA,USA:MITPress; 2016. http://www.
1086 deeplearningbook.org.
1087 HaarS,DonchinO. Arevisedcomputationalneuroanatomyformotorcontrol. JournalofCognitiveNeuro-
1088 science.2020;32(10):1823â€“1836.doi:10.1162/jocn_a_01602.
1089 HohwyJ.ThePredictiveMind.OxfordUniversityPressUK;2013.
1090 KaplanR,FristonKJ.Planningandnavigationasactiveinference.BiologicalCybernetics.2018;112(4):323â€“343.
1091 https://doi.org/10.1007/s00422-018-0753-2,doi:10.1007/s00422-018-0753-2.
1092 KeeleSW,PosnerMI.ProcessingofVisualFeedbackinRapidMovements.JournalofExperimentalPsychology.
1093 1968;77(1):155â€“158.doi:10.1037/h0025754.
1094 KikuchiY,HamadaY.GeometriccharactersoftheradiusandtibiainMacacamulattaandMacacafascicularis.
1095 Primates.2009;50(2):169â€“183.doi:10.1007/s10329-008-0120-3.
1096 KingmaDP,WellingM.Auto-encodingvariationalbayes.2ndInternationalConferenceonLearningRepresen-
1097 tations,ICLR2014-ConferenceTrackProceedings.2014;p.1â€“14.
1098 LanillosP,ChengG. AdaptiveRobotBodyLearningandEstimationThroughPredictiveCoding. IEEEInterna-
1099 tionalConferenceonIntelligentRobotsandSystems.2018;p.4083â€“4090.doi:10.1109/IROS.2018.8593684.
1100 LauHC,RogersRD,HaggardP,PassinghamRE. AttentiontoIntention. Sicence.2004;303(5661):1208â€“1210.
1101 doi:10.1126/science.1090973.
1102 LevineS. ReinforcementLearningandControlasProbabilisticInference: TutorialandReview. .2018;http:
1103 //arxiv.org/abs/1805.00909.
1104 LimanowskiJ,FristonK.Activeinferenceundervisuo-proprioceptiveconflict:Simulationandempiricalresults.
1105 ScientificReports.2020;10(1):1â€“14.http://dx.doi.org/10.1038/s41598-020-61097-w,doi:10.1038/s41598-020-
1106 61097-w.
1107 MaWJ,BeckJM,LathamPE,PougetA. Bayesianinferencewithprobabilisticpopulationcodes. NatureNeuro-
1108 science.2006;9(11):1432â€“1438.doi:10.1038/nn1790.
1109 MedendorpWP,HeedT. Stateestimationinposteriorparietalcortex: Distinctpolesofenvironmentaland
1110 bodilystates.ProgressinNeurobiology.2019;183(April):101691.doi:10.1016/j.pneurobio.2019.101691.
1111 Millidge B, Tschantz A, Seth AK, Buckley CL. On the relationship between active inference and control as
1112 inference. CommunicationsinComputerandInformationScience.2020; 1326:3â€“11. doi: 10.1007/978-3-
1113 030-64919-7_1.
1114 Oliver G, Lanillos P, Cheng G. Active inference body perception and action for humanoid robots. . 2019;
1115 http://arxiv.org/abs/1906.03022.
1116 ParrT,FristonKJ. Theanatomyofinference: Generativemodelsandbrainstructure. FrontiersinComputa-
1117 tionalNeuroscience.2018;12(November).doi:10.3389/fncom.2018.00090.
35of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
1118 ParrT,PezzuloG,FristonKJ.Activeinference:thefreeenergyprincipleinmind,brain,andbehavior.Cambridge,
1119 MA:MITPress;2021.
1120 ParrT,PezzuloG,FristonKJ.ActiveInference:TheFreeEnergyPrincipleinMind,Brain,andBehavior.TheMIT
1121 Press;2022.https://doi.org/10.7551/mitpress/12441.001.0001,doi:10.7551/mitpress/12441.001.0001.
1122 ParrT,RikhyeRV,HalassaMM,FristonKJ. PrefrontalComputationasActiveInference. CerebralCortex.2020;
1123 30(2):682â€“695.doi:10.1093/cercor/bhz118.
1124 PezzuloG,CisekP. NavigatingtheAffordanceLandscape: FeedbackControlasaProcessModelofBehavior
1125 andCognition.TrendsinCognitiveSciences.2016;20(6):414â€“424.http://dx.doi.org/10.1016/j.tics.2016.03.013,
1126 doi:10.1016/j.tics.2016.03.013.
1127 PezzuloG,DonnarummaF,DindoH,Dâ€™AusilioA,KonvalinkaI,CastelfranchiC. Thebodytalks:Sensorimotor
1128 communicationanditsbrainandkinematicsignatures. PhysicsofLifeReviews.2019;28:1â€“21. https://doi.
1129 org/10.1016/j.plrev.2018.06.014,doi:10.1016/j.plrev.2018.06.014.
1130 PezzuloG,DonnarummaF,IodiceP,MaistoD,StoianovI. Model-basedapproachestoactiveperceptionand
1131 control.Entropy.2017;19(6).doi:10.3390/e19060266.
1132 PezzuloG,RigoliF,FristonKJ.HierarchicalActiveInference:ATheoryofMotivatedControl.TrendsinCognitive
1133 Sciences.2018;22(4):294â€“306.http://dx.doi.org/10.1016/j.tics.2018.01.009,doi:10.1016/j.tics.2018.01.009.
1134 Pio-LopezL,NizardA,FristonK,PezzuloG. Activeinferenceandrobotcontrol: Acasestudy. Journalofthe
1135 RoyalSocietyInterface.2016;13(122).doi:10.1098/rsif.2016.0616.
1136 RaoRPN,BallardDH.Predictivecodinginthevisualcortex:Afunctionalinterpretationofsomeextra-classical
1137 receptive-fieldeffects.NatureNeuroscience.1999;2(1):79â€“87.doi:10.1038/4580.
1138 RoodT,vanGervenM,LanillosP. Adeepactiveinferencemodeloftherubber-handillusion. .2020; http:
1139 //arxiv.org/abs/2008.07408.
1140 SajidN,BallPJ,ParrT,FristonKJ. Activeinference: demystifiedandcompared. NeuralComputation.2021;
1141 33(3):674â€“712.doi:10.1162/neco_a_01357.
1142 SancaktarC,vanGervenMAJ,LanillosP.End-to-EndPixel-BasedDeepActiveInferenceforBodyPerceptionand
1143 Action. In:2020JointIEEE10thInternationalConferenceonDevelopmentandLearningandEpigeneticRobotics
1144 (ICDL-EpiRob);2020.p.1â€“8.doi:10.1109/icdl-epirob48136.2020.9278105.
1145 SaundersJA,KnillDC. Humansusecontinuousvisualfeedbackfromthehandtocontrolfastreachingmove-
1146 ments.ExperimentalBrainResearch.2003;152(3):341â€“352.doi:10.1007/s00221-003-1525-2.
1147 ShadmehrR,KrakauerJW. Acomputationalneuroanatomyformotorcontrol. ExperimentalBrainResearch.
1148 2008;185(3):359â€“381.doi:10.1007/s00221-008-1280-5.
1149 ShenoyKV,SahaniM,ChurchlandMM.CorticalControlofArmMovements:ADynamicalSystemsPerspective.
1150 AnnualReviewofNeuroscience.2013;36(1):337â€“359.doi:10.1146/annurev-neuro-062111-150509.
1151 Snyder LH, Batista AP, Andersen RA. Coding of intention in the posterior parietal cortex. Nature. 1997;
1152 386(6621):167â€“170.doi:10.1038/386167a0.
1153 SnyderLH,BatistaAP,AndersenRA.Intention-relatedactivityintheposteriorparietalcortex:Areview.Vision
1154 Research.2000;40(10-12):1433â€“1441.doi:10.1016/S0042-6989(00)00052-3.
1155 SrinivasanSS,Gutierrez-ArangoS,TengACE,IsraelE,SongH,BaileyZK,CartyMJ,FreedLE,HerrHM. Neu-
1156 ral interfacing architecture enables enhanced motor control and residual limb functionality postamputa-
1157 tion. ProceedingsoftheNationalAcademyofSciencesoftheUnitedStatesofAmerica.2021;118(9). doi:
1158 10.1073/pnas.2019555118.
1159 StoianovI,PennartzC,LansinkC,PezzuloG.Model-basedspatialnavigationinthehippocampus-ventralstria-
1160 tumcircuit: acomputationalanalysis. PlosComputationalBiology.2018;14(9):1â€“28. doi: 10.1371/journal.
1161 pcbi.1006316.
1162 StoianovI,GenovesioA,PezzuloG.Prefrontalgoalcodesemergeaslatentstatesinprobabilisticvaluelearning.
1163 JournalofCognitiveNeuroscience.2016;28(1):140â€“157.http://www.mitpressjournals.org/doi/10.1162/jocn_
1164 a_00886,doi:10.1162/jocn_a_00886.
36of37
bioRxiv preprint doi: https://doi.org/10.1101/2022.04.08.487597; this version posted June 13, 2022. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
1165 Todorov E. Optimality principles in sensorimotor control. Nature Neuroscience. 2004; 7:907â€“915. doi:
1166 10.1038/nn1309.
1167 Toussaint M, Storkey A. Probabilistic inference for solving discrete and continuous state Markov
1168 Decision Processes. ACM International Conference Proceeding Series. 2006; 148:945â€“952. doi:
1169 10.1145/1143844.1143963.
1170 TuthillJC,AzimE.Proprioception.CurrentBiology.2018;28(5):R194â€“R203.doi:10.1016/j.cub.2018.01.064.
1171 VellisteM,PerelS,SpaldingMC,WhitfordAS,SchwartzAB.Corticalcontrolofaprostheticarmforself-feeding.
1172 Nature.2008;453(7198):1098â€“1101.doi:10.1038/nature06996.
1173 Versteeg C, Rosenow JM, Bensmaia SJ, Miller LE. Encoding of limb state by single neurons in the cuneate
1174 nucleusofawakemonkeys.JournalofNeurophysiology.2021;126(2):693â€“706.doi:10.1152/jn.00568.2020.
1175 WolpertDM,FlanaganJR.Computationsunderlyingsensorimotorlearning.CurrentOpinioninNeurobiology.
1176 2016;37:7â€“11.http://dx.doi.org/10.1016/j.conb.2015.12.003,doi:10.1016/j.conb.2015.12.003.
SUPPLEMENTARYMATERIAL
1177
Parameter Value
Î” 0.6
ğ‘¡
Parameter Value ğ›¼ 0.4
trunk_length 17 ğœ‹ 0.5
Parameter Value ğ‘
trunk_width 16 ğœ‹ 2e-5
n_datapoints 20000 ğ‘£ğ‘
trunk_limits (0,10) ğœ‹ 4e-4
n_epochs 100 ğ‘£ğ‘¡
shoulder_length 27 ğœ‹ 1.0
n_batch 32 ğ‘£â„
shoulder_width 14 ğ›½ 0.1
learning_rate 0.001
shoulder_limits (0,130) ğ‘˜ 0.1
variance 0.02
elbow_length 38 ğ‘¤ 2e-3
Table2.Variationalautoencoder ğ‘
elbow_width 12 ğ‘¤ 0.0
parameters. ğ‘
elbow_limits (0,130) n_steps 300
Table1.Armmodelparameters. n_trials 1000
Table3.ActiveInference
parameters.
37of37