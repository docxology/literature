1
Active Anomaly Detection with Switching Cost
Fengfan Qin, Da Chen, Hui Feng, Member, IEEE, Qing Zhao, Fellow, IEEE, Tao Yang, Member, IEEE,
and Bo Hu, Member, IEEE
Abstract
Theproblemofdetectingasingleanomalousprocessamongmultipleindependentprocessesisconsidered.Underaconstraint
onthenumberofprocessesthatcanbeprobedsimultaneously,thedecisionmakershoulddecidewhichprocessestoprobeateach
timeandwhentoterminatetheprobing.Comparedwithpreviousworkconsideringonlytheobservationcosts,theswitchingcosts
ofswitchingsacrossprocessesalsoneedtobetakenintoaccountinmanypracticalscenarios.Theobjectiveisanactiveinference
strategythatminimizestheBayesianrisktakingintoaccountofthesamplecomplexity,switchingcost,aswellasdetectionerrors.
Based on the framework of sequential design of experiments, we propose a low-complexity, low-switching deterministic policy
for two scenarios where the total switching cost is negligible and the total switching cost is comparable to the total observation
cost. We show that the proposed algorithm is asymptotically optimal in the former scenario and is order optimal in the latter
scenario. Simulation results demonstrate strong performance in the finite regime for both scenarios.
Index Terms
Active hypothesis testing, anomaly detection, switching cost.
I. INTRODUCTION
C
ONSIDER the problem of detecting anomalous processes among multiple processes. At each time, only one process
can be probed and a noisy observation is obtained from the process. The objective is to find an optimal inference
strategy consisting of a selection rule indicating which process to probe at each time, a stopping rule on when to terminate the
detection, and a decision rule on the final result. The performance measure is the Bayesian risk that takes into account various
costs during procedure, such as the detection error, the sampling delay or switching cost, etc.
F.Qin,D.Chen,H.Feng,T.YangandB.HuarewiththeResearchCenterofSmartNetworksandSystems,SchoolofInformationScienceandEngineering,
Fudan University, Shanghai 200433, China. e-mail: ({ffqin18, dachen16, hfeng, taoyang, bohu}@fudan.edu.cn,). A priliminary result was presented in the
ICASSP2019-2019IEEEInternationalConferenceonAcoustics,SpeechandSignalProcessing(ICASSP)[1].
Q.ZhaoiswithSchoolofElectricalandComputerEngineering,CornellUniversity.e-mail:qz16@cornell.edu
1202
naJ
41
]PS.ssee[
3v00811.0181:viXra
2
The anomaly detection problem studied in this paper relates to the sequential design of experiments problem first studied by
Chernoff in 1959 [2] named as the Active Hypothesis Testing (AHT) problem. Differ from the classic sequential hypothesis
testing pioneered by Wald in [3] where the observation action under each hypothesis is fixed, active hypothesis testing allows
the decision maker to choose different experiments to be conducted at each time and infer the state of the probed process. The
test developed by Chernoff (referred to as Chernoff test) is a randomized test that generates random actions based on historical
observations. The actions, consequently the test statistics of log likelihood ratio, thus become independent and identically
distributed over time, allowing asymptotic analysis of the stopping time on the test statistic.
Chernoff’s work has been extended in various directions. Bessler [4] generalized Chernoff’s work to general multiple
hypothesistestingin1960.NaghshvarandJavidiin[5]–[9]studiedthissequentialproblemfromtheperspectiveofminimizing
Bayesian risk considering the detection error and detection delay. In [10]–[12], more general models which considered
Markovian observations and non-uniform costs on actions were proposed. Recently, K. Cohen and Q. Zhao et al. studied
AHTforanomalydetectionin[13]–[19].Incontrasttotherandompoliciesadvocatedinotherworks,theyintroducedasimple
deterministic model which offers the same asymptotic optimality yet with significant performance gain in the finite regime and
considerable reduction in implementation complexity. More recent studies and applications of general active hypothesis testing
problem can be found in [20]–[23].
However, Chernoff test and subsequent studies do not consider switching cost. Incorporating switching cost into Bayesian
risk is motivated by a number of applications. For example, in many searching tasks, relocating the searching agent (eg.
rescuing ships or air-crafts) incurs considerable cost in terms of energy or delay. Another example is medical diagnostics,
where frequent and fast switching across drugs and medical procedures may carry high risk and side effects.
There are few studies considering the switching cost in AHT. Vaidhiyan developed a modified Chernoff test (referred to as
Sluggish policy) in [24] and introduced a switching parameter η which determines the switching probability, which can be
seen as an ε-greedy strategy. They claimed that Sluggish policy approaches the asymptotic performance of Chernoff test as
η →0. But this policy results in a higher observation cost in the finite regime as demonstrated in their simulations.
In this paper, we propose a low-complexity deterministic test for the above active hypothesis testing problem with switching
cost, referred to the Deterministic Bounded Switching (DBS) policy, which was first formulated and studied in our prior
work [1]. The proposed policy explicitly specifies the probing action at each time based on the history of observations, which
integrates all parameters affecting the Bayesian risk: the number of processes M, the single-switching cost s, the single-
observation cost c, and the corresponding Kullback-Liebler (KL) divergences between the observation distributions of normal
and anomalous processes. DBS policy partitions the problem space into two cases. In the first case, the process that are most
3
likelytobeabnormalwillbeprobed.Intheothercase,DBSpolicyprobesprocessesthatarelikelytobenormalandeliminates
them one by one to reduce the number of switchings. In addition to the scenario studied in [1] where the single-switching cost
is of no greater order than the single-observation cost in the asymptotic regime of c→0, we further analyze the performance
of the DBS policy in the scenario where the total switching cost is negligible and the total switching cost is comparable to
the total observation cost. Then, we show that the DBS policy enjoys asymptotic optimality when the total switching cost is
negligible to the observation cost, i.e., s = o(−clogc) as c approaches 0, and strong performance in the finite regime are
demonstrated in simulation part of this paper. In addition, we also analyze the performance of the DBS policy when total
switching cost is comparable to the total observation cost, i.e., s=Ω(−clogc) as c approches 0, and draw the conclusion that
the DBS policy is order optimal in this scenario.
In this paper, Sec. II describes the system model for single anomaly detection problems. DBS policy is proposed to solve
it, and its optimality is proved in Sec. IV-A. In Sec. IV-B and Sec. IV-C we compare DBS with the deterministic DGF policy
in [13] and the Random Sequential Probability Ratio Test (R-SPRT) policy and analyze the impact of switching cost. In Sec.
V we provide numerical examples to illustrate the performance of the proposed policy compared with other algorithms. Sec.
VI concludes the paper.
II. SYSTEMMODELANDPROBLEMFORMULATION
A. System Model
Consider the problem of detecting an anomalous process among a finite number (denoted by M) of processes. Each process
maybeinanormalstateoranabnormalstatealternatively.LetH denotethehypothesisthattheprocessmisinanabnormal
m
state. Let π be the priori probability that H is true, where
(cid:80)M
π =1, and 0<π <1 for all m. At each given time,
m m m=1 m m
only one process can be probed. When process m is probed at time n, an observation y (n) is obtained and is independent
m
over time. If process m is in a normal state, y (n) follows distribution f(y); if process m is in an abnormal state, y (n)
m m
follows distribution g(y). We focus on the case where the distributions f(y) and g(y) are known.
LetP betheprobabilitymeasureunderhypothesisH andE betheoperatorofexpectationconcerningthemeasureP .
m m m m
Letφ(n)∈1,2,...,M beaselectionruleindicatingwhichprocessisprobedattimen.Thevectorofselectionrulesisdenoted
by φ=(φ(n),n≥1). Let τ be a stopping time (or a stopping rule), which is the time when the decision maker finishes the
detecting procedure. Let τ and τ be the numbers of observations and switchings by the stopping time τ, respectively, we
c s
have τ = τ +τ . Let δ ∈ {1,2,...,M} be a decision rule, where δ = m if the decision maker declares that H is true at
c s m
time τ.
4
An admissible policy for the sequential anomaly detection problem is denoted by
Γ=(τ,δ,φ). (1)
B. Objective
Let P (Γ)(cid:44)(cid:80)M π α (Γ) be the probability of error under policy Γ, where α (Γ)(cid:44)P (δ (cid:54)=m|Γ) is the probability
e m=1 m m m m
of declaring δ (cid:54)= m when H is true. Let E(τ|Γ) (cid:44) (cid:80)M π E (τ|Γ) be the expected detection time under Γ, while
m m=1 m m
E(τ
|Γ)(cid:44)(cid:80)M
π E (τ |Γ)istheexpectedvalueofthetotalnumberofobservationsτ andE(τ
|Γ)(cid:44)(cid:80)M
π E (τ |Γ)
c m=1 m m c c s m=1 m m s
is the expected value of the total number of switchings τ respectively.
s
We adopt a Bayesian-like approach as in Chernoff’s original study [2] by assigning a cost of c for each observation, a unit
loss for a wrong declaration, and s be the switching cost for a single position switching.
The Bayesian risk of Γ under hypothesis H is given by
m
R (Γ)(cid:44)α (Γ)+cE (τ|Γ)+sE (τ |Γ). (2)
m m m m s
The average Bayesian risk is
M
(cid:88)
R(Γ)(cid:44) π R (Γ)=P (Γ)+cE(τ|Γ)+sE(τ |Γ). (3)
m m e s
m=1
The objective is finding a policy that minimizes the Bayesian risk:
infR(Γ). (4)
Γ
C. Statistics
Since only one process can be probed at a time, let 1 (n) be the indicator function of whether process m is probed at time
m
n. 1 (n)=1 if process m is probed at time n, and 1 (n)=0 otherwise.
m m
The log-likelihood ratio (LLR) of each process m is denoted as
g(y (n))
l (n)(cid:44)log m , (5)
m f(y (n))
m
which reflects the goodness-of-fit of which distribution a certain region belongs to. E (l (n)) (cid:44) D(g||f) > 0 if the
m m
observations of region m follows distribution g(y), and E (l (n)) (cid:44) −D(f||g) < 0 if the observations of process m
m m
follows distribution f(y), where D(·||·) is the KL divergence between two distributions.
The sum log-likelihood ratio (SLLRs) of process m at time n is given by
5
n
(cid:88)
S (n)(cid:44) l (t)1 (t), (6)
m m m
t=1
which combines the observations of the process m at multiple times, and can be regarded as the score of whether the process
is in an abnormal state. After a period of observations, the sum-LLRs of different processes may be different. Under H ,
m
S (n) is a random walk with positive expected increment E (l (n)) = D(g||f) > 0, while S (n), for j (cid:54)= m is a random
m m m j
walk with negative expected increment E (l (n))=−D(f||g)<0.
m j
III. THEDBSPOLICY
A. The DBS Policy
In this section, we propose a deterministic policy for the above active hypothesis testing problem, referred to as the DBS
policy.Ourgoalistodetecttheonlyoneanomalousprocessamongmultipleprocesses.Intuitively,therearetwowaystosolve
the detection problem. In one way, we can probe the processes that are more likely to be abnormal and confirm them one by
one; In another way, we can probe the processes that are more likely to be normal and eliminate them one by one. Thus, the
proposed DBS policy partitions the problem space into two cases by comparing D(f||g)/(M−1) and D(g||f)+(cid:52)(M), i.e.,
D(f||g)
Case I: D(g||f)+(cid:52)(M)≥ ,
M −1
D(f||g)
Case II: D(g||f)+(cid:52)(M)< ,
M −1
where
s(M −2)(M +1)D(g||f)D(f||g)
(cid:52)(M)(cid:44) (7)
−clogc(M −1)
istheoffsetvaluecausedbytheswitchingcostwhichwewillexplainlater.ItshouldbenotedthatD(g||f)andD(f||g)/(M−1)
determine the rates at which the state of abnormal process m and normal processes j (cid:54)=m can be accurately inferred, where
D(g||f)representstheincreasingslopeoftheteststatisticS (n)ofthenormalprocessmandD(f||g)representsthedecreasing
m
slope of the test statistics S of normal processes j (cid:54)= m respectively. While the observation cost is mainly determined by
j
D(g||f), D(f||g)/(M −1) and c, the switching cost is mainly affected by M.
InCaseI,DBSpolicyprobestheprocesswhichismostlikelytobeabnormal.Theselectionrule,stoppingruleanddecision
rule are as follows:
φ(n)=m1(n), (8)
(cid:8) (cid:9)
τ =min n:S (n)>−logc , (9)
m1(n)
δ =m1(τ), (10)
6
wherem1(n)=argmax S (n)istheindexoftheprocessowingthehighestsum-LLRs(processeswiththesamesum-LLRs
m m
can be ordered arbitrarily) among all the processes.
In Case II, DBS policy probes the process which is most likely to be normal and eliminates the normal processes one by
one. Specifically, let B(n) denote the set of processes that can be declared as normal at time n, i.e.,
B(n)={m:S (n)<logc}. (11)
m
The selection rule, stopping rule, and decision rules of DBS policy in Case II are given by
φ(n)=m−1(n), (12)
τ =min{n:|B(n)|=M −1}, (13)
δ =M\B(τ), (14)
wherem−1(n)=argmin S (n)istheindexoftheprocesswiththelowestobservationsum-LLRsamongallprocesses
m∈/B(n) m
that have not been declared as normal at time n, and M={1,2,...,M} is the set of all processes.
B. Explanation
In our policy, we define stage as the time when a certain process is determined as abnormal or normal. There are only 1
stage in Case I, however, the observation process will be divided into M −1 stages in Case II. Assume that process m is in
an abnormal state, i.e., H is true. The deterministic selection rule of the DBS policy can be intuitively explained as follows.
m
Since the observations y (n) of process m follow the distribution g(y), the expectation of the test statistic l is E (l )=
m m m m
D(g||f) > 0. Therefore, as the number of observations increases, the sum-LLRs of process m increases gradually with high
probability. However, since the observations y (n) of process j (cid:54)=m follows the distribution f(y), the expectation of the test
j
statistics l is E (l )=−D(f||g)<0, which means the sum-LLRs of process j decreases gradually with high probability as
j m j
the number of observations increases. At the beginning of the detection procedure, the sum-LLRs of all processes are zero and
the decision maker randomly selects a process to probe. Subsequently, the decision maker sorts all the processes according to
the sum-LLRs at each given time n and selects the process m1(n) with the highest sum-LLRs. As a result, the sum-LLRs of
process m will gradually increases and become m1(n) with high probability.
In Case I of DBS policy, the decision maker probes the process with the highest sum-LLRs at each given time. The test
is finalized once sufficient information is gathered from the process, when the highest sum-LLRs exceeds the threshold of
−logc. Therefore, the asymptotic detection time approaches −logc/D(g||f) since the abnormal process can be probed with
higher probability than other processes at each time. In this case, the number of switching is bounded because the abnormal
7
process will quickly become the m1(n) process with high probability. In addition, the probability of switching decreases as
the time n increases, since the gap between m1(n) and m2(n) increases as n increases.
In Case II, the decision maker eliminates normal processes one by one and identifies the abnormal process finally. As a
result, the detection procedure will be divided into M −1 stages. At each stage, the process m−1(n) which is most likely to
be normal is probed at each time and the asymptotic observation time of each stage approaches −logc . The test is finalized
D(f||g)
once |B(n)|=M −1. Thus the asymptotic observation time of entire detection procedure approaches −(M−1)logc.
D(f||g)
With the goal of minimizing the objective function (4), the selection rules of Case I and Case II are established as (7).
Considering the impact of switching on the strategy, we introduced an offset (cid:52)(M) since there will be more switchings in
Case II which has M −2 more stages than Case I. It is worthy noting that the value of (cid:52)(M) changes as the sample cost
c, the single-switching cost s or the number of processes M changes. On the one hand, (cid:52)(M) increases as s increases
−clogc
when M is fixed, which means that as s increases, the decision maker is more inclined to choose Case I. The reason
−clogc
is that the effect of switching cost on the objective function increases as s increases, which leads the decision maker to
−clogc
choose Case I with fewer switching times. On the other hand, (cid:52)(M) increases as M increases when s is fixed, which
−clogc
means that it’s more inclined to choose Case I as M increases, since there will be more stages in Case II as M increases, and
switching will occur at each stage which leads to an increase in switching cost.
C. Example
We illustrate the two cases of DBS policy in Fig. 1 with an example that find the only abnormal process among M = 5
processes to clarify our idea.
Fig. 1 simulates the specifics of the DBS policy for Case I and Case II, respectively, when process 3 is an anomalous
process.ForCaseI,thedecisionmakerprobestheprocessm1(n)withthehighestsum-LLR.Atthebeginningofthedetection
procedure, since sum-LLRs of all processes are zero, a process is randomly selected to probe at t=1. Suppose the decision
maker selects process 1. Since process 1 is in a normal state, the sum-LLR of process 1 will decreases, so at t=2, the order
of sum-LLRs of all processes becomes {2,3,4,5,1}. Select process 2 to probe. In the same way, the sum-LLR of process 2
will also decrease, and the order of sum-LLRs of all processes may become {3,4,5,1,2}. Assume that the decision maker
selectsprocess3toprobeatt=3.Sinceprocess3isinanabnormalstate,thesum-LLRofprocess3increasesandranksfirst,
i.e., m1(n)=3 and S (n)>0. From then on, the decision maker will continue to probe process 3 with high probability
m1(n)
untilS (τ)≥−logc.Thenthedecisionmakerwillstopthedetectionprocedureanddeclaresprocess3tobeananomaly.
m1(n)
For Case II, the decision maker probes process m−1(n) at each given time. Suppose the process 5 is randomly selected
to probe at the beginning of the detection procedure. Since process 5 is in a normal state, the sum-LLR of process 5 will
8
Fig.1. IllustrationthetwocasesofDBSPolicy(M =5).
decreases and be ranked last. Thereafter, the decision maker will continue to probe process 5 until S (n) < logc, and
m−1(n)
then stop taking observations from process 5 and declare it as normal. Repeat this operation until all processes in normal state
are declared as normal.
IV. PERFORMANCEANALYSISANDCOMPARISON
In this section, we will analyze the performance of the DBS policy and compare DBS policy with DBS policy and R-SPRT
policy.
A. Performance Analysis
In this section, we analyze the performance of the DBS policy with different s and c. Theorem 1 and Theorem 2 are
presented to prove that the DBS policy is optimal in terms of minimizing the objective function as the observation cost c
approaches zero.
9
It is obvious that the order difference between s and c will affect the choice of strategy and the performance of the
corresponding policy. Considering the order relationship between the observation cost and switching cost, the problem is
divided into the following two scenarios:
Scenario 1: the single-switching cost s becomes insignificant relative to −clogc in the asymptotic regime of c → 0, i.e.,
lim s =0.
c→0 −clogc
Scenario2:thesingle-switchingcostsisboundedbelowby−clogcintheasymptoticregimeofc→0,i.e.,lim s >
c→0 −clogc
0.
According to the subsequent analysis, it is clear that the observation time E(τ ) of DBS policy satisfies E(τ )= −logc as
c c I∗(M)
c→0. Thus, the observation cost can be denoted as cE(τ )= −clogc, which is a function related to −clogc. Meanwhile, the
c I∗(M)
number of switchings is limited and the total switching cost can be denoted as a function related to s. Therefore, in order to
better analyze the performance of the DBS policy under the objective function in the form of Bayesian risk, the discussion is
based on the order of s and −clogc. Scenario 1 means that the total switching cost is much smaller than the total observation
cost and is negligible compared with the total observation cost. In Scenario 2 the total switching cost and total observation
cost are comparable.
WewillanalyzeandprovetheoptimalityoftheDBSpolicyintwoscenariosasc→0,respectively.Thefollowingtheorems
showthat DBSpolicy isasymptotically optimalor orderoptimal regardingminimizing theBayesian riskas c approacheszero.
Theorem 1 will show that the Bayesian risk of DBS policy will be infinitely close to the lower bound of Bayesian risk if
s = o(−clogc) as c → 0. Theorem 2 will show that the Bayesian risk of the DBS policy is higher than the lower bound of
the Bayesian risk, but the ratio of the two is bounded.
Theorem 1 (Asymptotic Optimality of DBS Policy). Let R(DBS) and R(Γ) be the Bayesian risks under the DBS policy and
any other policy Γ, respectively. If s=o(−clogc), then,
−clogc
R(DBS)∼ ∼infR(Γ) as c→0, (15)
I∗(M) Γ
where,


D(g||f), if Case I,
I∗(M)=
D(f||g)/(M
−1), if Case II.
Proof: For a detailed proof see Appendix A. We provide here a sketch. In the first step, we prove that the objective
function based on Bayesian risk has an asymptotic lower bound inf R(Γ) and give the form of the asymptotic lower bound.
Γ
Then, we show that the Bayesian risk R under DBS policy approaches the asymptotic lower bound as c→0.
10
Based on the three perspectives of error probability, sampling cost and switching cost, the asymptotic behavior of Bayesian
(cid:80)
risk is established. In Lemma 1, we show that the asymptotic lower bound on the total switching cost is (k−1)π , the
k k
asymptotic lower bound on the sampling cost is −clogc, and the error probability is O(c) following the same proof idea as in
I∗(M)
[13].
The basic idea of proving that the DBS policy is asymptotic optimal is to prove that the Bayesian risk of the DBS policy
approaches the asymptotic lower bound as c approaches 0. In App.1, we prove that the asymptotic expected detection time
approaches −logc while the error probability is O(c). In addition, we prove that the number of switching has an upper bound
I∗(M)
which is independent of c.
Then, we analyze the expected number of observations and expected switching times of the DBS policy. Take the proof of
Case II as an example, we need split the testing into M−1 stage. Each stage is defined according to the time when a certain
process is placed into set B. Then we analysis the three last passage times at every stage k, denote as τk, τk, τk, where τk
1 2 3 1
is the time when region m−1(n) is always normal for all n ≥ τk, τk is the time when region m−1(n) no longer changes
1 2
for all n ≥ τk, and τk is the time when the region m−1(n) is placed into B. The switching only occurs during τk and τk,
2 3 1 2
so the key point in our policy is to prove that there exist constants C > 0 and γ > 0 such that P (τk > n) ≤ Ce−γn and
m 1
P (τk > n) ≤ Ce−γn. Therefore, we can get the upper bound of the expected switching times as c → 0, and denote d as
m 2
the upper bound. In addition, combining the above conclusion and the property of SPRT, we can draw the conclusion that
E(τk)∼−logc/D(f||g) in Case II, so the asymptotic expected detection time approaches −logc/I∗(M).
3
LastbutnotLeast,wewillanalyzetheoptimalityoftheDBSpolicyascapproacheszerobasedontherelationshipbetween
s and c. Since lim s =0, which means s is much smaller than −clogc, the ratio of expected number of switching to
c→0 −clogc
the number of observations
s·D·I∗(M)
approaches zero as c→0. Thus, the ratio of asymptotic lower bound of Bayesian risk
−clogc
to the Bayesian risk of the DBS policy R(DBS) is equal to 1 as c→0, which means the DBS policy is asymptotic optimal
infΓR(Γ)
as c→0.
Theorem 2 (Order Optimality of DBS Policy). Let R(DBS) and R(Γ) be the Bayesian risks under the DBS policy and any
other policy Γ, respectively. If s=Ω(−clogc), then,
R(DBS)=O(infR(Γ)) as c→0 (16)
Γ
Proof: For a detailed proof see Appendix B. Theorem 2 can be proved in a similar way to theorem 1. Theorem 2 has the
same expected switching time and expected observation time as theorem 1. The difference between Theorem 2 and Theorem
1 is that the relationship between s and c is different. For Theorem 2, since lim s >0, the ratio of asymptotic lower
c→0 −clogc
11
bound of Bayesian risk to the Bayesian risk of the DBS policy R(DBS) is larger than 1 but bounded by positive infinity as
infΓR(Γ)
c→0 , which means the DBS policy is order optimal as c→0.
In the following, we will analyze the DGF policy and the R-SPRT policy when they are applied to the anomaly detection
problem considering switching cost. The DGF policy has been shown to be an asymptotically optimal policy that minimizes
the detection time subject to an error probability constraint. And the R-SPRT policy is an optimal policy that minimizes the
number of switchings.
B. Comparison with the DGF Policy
As DBS policy is inspired by DGF policy in [13], we would like to highlight the difference between DBS policy and DGF
policy to explain how the Bayesian risk considering switching cost is reduced in DBS policy.
1) The DGF Policy: The DGF policy is a deterministic policy. At each time, the selection rule φ(n) of the DGF policy
chooses cells according to the order of their sum-LLRs which is similar to the DBS policy. Specifically, based on the relative
order of D(g||f) and D(f||g)/(M−1), either the process with the highest sum-LLRs or the process with the second highest
sum-LLRs are chosen, i.e.,

 m1(n), if D(g||f)≥ D
M
(f
−
||
1
g),
φ(n)=
m2(n),
if D(g||f)< D(f||g).
M−1
The stopping rule and decision rule under the DGF policy are given by:
τ =inf{n:m1(n)−m2(n)≥−logc},
and,
δ =m1(n).
2) Comparison: In Case I, both the DBS policy and the DGF policy are to probe the process which is most likely to
be abnormal until the decision makers declare one process as abnormal. The selection rule of DGF policy is to probe the
m1(n) process at each time, which is the same as DBS policy. The stopping rule under DGF policy is associate with the
difference between the highest observed sum-LLRs S (n) and the second highest observed sum-LLRs S (n). Once
m1(n) m2(n)
S (n)−S (n)≥−logc,thedecisionmakerofDGFpolicyfinalizesthedetectionprocedure.Meanwhile,thedecision
m1(n) m2(n)
maker of DBS policy stops the detection procedure once the highest observed sum-LLRs S (n) is greater than −logc.
m1(n)
Sincethereisonlyoneanomalousprocess,thesecondhighestobservedsum-LLRsislessthan0withhighprobability.Because
of the setting of the selection rule and stopping rule, DGF policy has fewer excepted observation times than DGF policy while
12
it has the same expected switching times as DBS policy, which makes the Bayesian risk of DGF policy slightly lower than
DBS policy. However, the Bayesian risk gap between DGF and DBS policy caused by the number of observations is small
enough to not affect the asymptotic optimality of the DGF policy.
However, in Case II, DGF policy probes the process with the second sum-LLRs at each time, and the testing is terminated
oncethedifferencebetweenthehighestandthesecondhighestobservedsum-LLRsisgreaterthan−logc.Sincethesum-LLRs
ofprobedprocessm2(n)attimenwilldecreasewithhighprobabilityaftercurrentobservation,theprobedprocesswillalways
changes, which cause a large switching cost. In contrast, DBS policy always probe the process m−1(n) in Case II, since the
observed sum-LLRs of process m−1(n) at time n will decrease with high probability after current probing, DBS policy will
probe the same process with high probability until it has been declared. Thus, the number of switching times is reduced.
C. Comparison with the R-SPRT Policy
Inthispart,wewillcomparethedifferencebetweentheDBSpolicyandtheR-SPRTpolicy,whichhasthesmallestexpected
switching time.
1) The R-SPRT Policy: The R-SPRT policy has a random selection rule, where a series of SPRTs are performed until all
the abnormal process is tested in a random order. In other words, the decision maker selects one process to probe randomly
and performs SPRT test for the currently probed process until its state is declared. Once one process is declared as abnormal,
the detection procedure will be finished.
In R-SPRT, the stopping and decision rules are given by comparing the sum-LLRs S (n) with boundary values at each
m
time n. Thus, the R-SPRT test is carried out as follows:
• If S m (n)∈(logc,−logc), continue to take observations from process m.
• If S m (n)≤−logc, stop taking observations from process m and declare it as normal. In addition, select another process
whose state hasn’t been declared randomly to probe at the next time.
• If S m (n)≥−logc, stoptaking observations from process m and declare itas abnormal. Then, finishthe whole detection
procedure and τ =n.
Since the R-SPRT policy selects processes randomly, each process has same probability to be selected at each stage. The
expected switching time of the R-SPRT policy can be given by
M −1
E(τ |R-SPRT)= ,
s 2
while the expected observation time of the R-SPRT is
(cid:18) (cid:19)
1 M −1
E(τ |R-SPRT)=−logc + .
c D(g||f) 2D(f||g)
13
2) Comparison: In this part, we will compare the performance of the R-SPRT policy and the DBS policy on the objective
function (4). The Bayesian risks of the R-SPRT policy and the DBS policy can be given by:
R(R-SPRT)=cE(τ |R-SPRT)+sE(τ |R-SPRT)
c s
(cid:18) (cid:19)
1 M −1 M −1
=−clogc + +s ,
D(g||f) 2D(f||g) 2
R(DBS)=c·E(τ |DBS)+s·E(τ |DBS)
c s
1
=−clogc +sE(τ |DBS),
I∗(M) s
where there exist M−1 <D <∞ such that M−1 <E(τ |DBS)<D.
2 2 s
Assume that R(DBS) is lower than R(R−SRPT), i.e.,
1
R(DBS)≤−clogc +sD
I∗(M)
(cid:18) (cid:19)
1 M −1 M −1
<−clogc + +s
D(g||f) 2D(f||g) 2
=R(R-SPRT),
we can draw the conclusion as follow:
s 1 + M−1 − 1
D(g||f) 2D(f||g) I∗(M)
< .
−clogc D− M−1
2
In another words, when the order relationship between s and −clogc meets the above conditions, the DBS performs better
than the R-SPRT policy.
V. NUMERICALRESULTS
In this section, we present numerical examples to illustrate the performance of DBS policy. We consider the case where
there is only one anomalous process among M processes. The DBS policy will be compared with Chernoff test [2], DGF
policy [13], Sluggish policy [13] and R-SPRT policy.
Chernoff test is a randomized policy, which works as below for anomaly detection problem in this case. When D(g||f)≥
D(f||g)/(M −1), Chernoff policy selects the m1(n) process at each given time since there is only one abnormal process
and the m1(n) is most likely to be abnormal. When D(g||f)<D(f||g)/(M −1), the decision maker will select one process
randomly with equal probability from processes m(cid:54)=m1(n). As a result, the Chernoff test has a different selection rule with
the DBS policy.
SluggishpolicyisanextendedalgorithmbasedonChernofftest,whichintroducecostsforswitchingofactions.TheSluggish
policymerelyslowsdowntheswitchingofactionsviaanindependentandidenticallydistributedBernoullimodulationprocess,
which performs well in the active hypothesis testing problem considering switching cost.
14
We set the simulations with the following parameters. When process m is probed at time n, an observation y (n) is
m
independently drawn from a Poisson distribution f ∼ Pois(λ ) or g ∼ Pois(λ ), depending on whether the process is the
f g
target or normal. It is easy to show that
λ
D(g||f)=λ −λ +λ log( g),
f g g λ
f
(17)
λ
D(f||g)=λ −λ +λ log( f).
g f f λ
g
Let T (Γ) be the number of observations under the policy Γ, and TLB = −logc be the asymptotic lower bound on the
c c I∗(M)
observation times as c→0. Define
T(cid:48)(Γ)(cid:44)(T (Γ)−TLB)/TLB
c c c c
as the relative ratio of observations under policy Γ compared to the asymptotic lower bound of observation.
Let R(Γ) be the Bayesian risks under the policy Γ, and R = −clogc +s· (cid:80) (k−1)π be the asymptotic lower bound
LB I∗(M) k k
on the Bayesian risk as c→0. Define
L(Γ)(cid:44)(R(Γ)−R )/R (18)
LB LB
as the Bayesian relative risk under policy Γ compared to the asymptotic lower bound, which serve as performance measures
of the tests in the finite regime. Following Theorems 1,2, we expect L(DBS) to approach 0 when s = o(−clogc)as c → 0
and is bounded by positive infinity when s=Ω(−clogc).
A. s/c is fixed
First we consider the case where M =5 and s=2c, which means s =0 as c→0. In this case, the loss of a single
−clogc
switch and a single observation is comparable, while the total switching cost is much smaller than the total observation cost.
For Sluggish policy [13], the switching probability is set to p = 0.1, which means switching occurs approximately every ten
observations. We set λ =0.4, λ =0.001 and obtained D(g||f)≈0.39, D(f||g)/(M −1)≈0.50. The performance of all
f g
algorithms is presented in Fig. 2, which are the average of 1000 trials.
It is shown that Sluggish policy has the largest number of observations and DGF policy is the smallest in Fig. 2(a). In Fig.
2(b), we can find that the switching number of R-SPRT policy is less than other policies. Regardless of the relative ratio of
observation as Fig. 2(a) or the number of switching as Fig. 2(b), the performance of the DBS strategy is both sub-optimal.
The dashed rectangular area of Fig. 2(a) and Fig. 2(b) shows that the observation delay and switching number of DBS policy
change suddenly around −logc=70. The reason is that DBS policy chooses to probe the process with the largest sum-LLRs
since it is in Case I when −logc<70. However, because of the change of c, DBS policy changes to Case II and chooses to
15
7
6
5
4
3
2
1
0 20 40 60 80 100 120 140 160 180 200
snoitavresbo
fo
rebmuN
evitaleR
DGF Policy
Chernoff Policy
Sluggish Policy
DBS Policy
SPRT Policy
(a)Therelativeratioofobservations
400
350
300
250
200
150
100
50
0
0 20 40 60 80 100 120 140 160 180 200
sgnihctiwS
fo
rebmuN
DGF Policy
Chernoff Policy
Sluggish Policy
DBS Policy
SPRT Policy
(b)Switchingnumber
6
5
4
3
2
1
0
0 20 40 60 80 100 120 140 160 180 200
ksir
evitaler
naiseyaB
DGF Policy
Chernoff Policy
Sluggish Policy
DBS Policy
SPRT Policy
(c)Bayesrelativerisk
Fig.2. DBSPolicyinM =5,s=2c,λ f =0.4,λg =0.001
16
observe the M−1 normal processes when −logc>70. The transition between cases increases the number of stages, leading
to an increase in the number of switchings and a decrease in the number of observations.As a result, the Bayes relative risks
will continuously decrease and approach to 0 as c→0.
B. s=o(−clogc)
Inthissection,weconsiderthescenariowhere s =5c,whichmeans s =0asc→0.Inthiscase,totalswitching
−clogc −clogc
cost is sufficiently small in comparison with the total observation cost. In addition, (cid:52)(M) approaches 0 as c→0, so Case I
and Case II of DBS policy can be simplified to the following form,
D(f||g)
Case I:D(g||f)≥ ,
M −1
D(f||g)
Case II:D(g||f)< .
M −1
We set λ =0.001,λ =0.4 and obtained D(g||f)≈0.39,D(f||g)/(M −1)≈0.50, when DBS policy, DGF policy and
f g
Chernoff policy are all in Case II and inclined to probe the normal processes. In this case, DBS policy selects process m−1(n)
ateachgiventimen,whilethedecisionmakerofDGFpolicyselectsprocessm2(n)ateachgiventime.AndtheChernofftest
draws one process randomly with equal probability from processes {m2(n),m3(n),...,mM(n)} at each given time n. Since
the test statistics from normal processes are less than zero with high probability, the LLR of normal process will be lower and
lower. Thus, the decision maker of DBS policy will probe the same process at each given time with high probability, while
the decision maker of DGF policy switches the observed process constantly. The performance of all algorithms is presented
in Fig. 3.
C. s=Ω(−clogc)
Then we consider the case where s =2, which means the single-switching cost s is large enough that the cost caused
−clogc
by switching cannot be ignored. In addition, (cid:52)(M) does not change with the change of c. We set λ = 0.4, λ = 0.001
f g
and obtained D(g||f) ≈ 0.39, D(f||g)/(M −1) ≈ 0.50, D(g||f)+(cid:52)(M) ≥ 7, DBS policy is in Case I for all values of c
while DGF policy is in Case II. The performance of all algorithms is presented in Fig. 4. It is shown that DGF policy has less
observations, but DBS policy has less switching. Fig. 4(c) shows that DBS policy is optimal among all algorithms.
VI. CONCLUSION
The problem of detecting an anomalous process among multiple processes considering switching cost is studied. Due to the
resource constraints, only one process can be probed at each time, and the observations from each process follow two different
17
4.5
4
3.5
3
2.5
2
1.5
1
20 40 60 80 100 120 140 160 180 200
snoitavresbo
fo
rebmuN
DGF Policy
Chernoff Policy
Sluggish Policy
DBS Policy
SPRT Policy
(a)Therelativeratioofobservations
400
350
300
250
200
150
100
50
0
20 40 60 80 100 120 140 160 180 200
sgnihctiwS
fo
rebmuN
DGF Policy
Chernoff Policy
Sluggish Policy
DBS Policy
SPRT Policy
(b)Switchingnumber
3.5
3
2.5
2
1.5
1
0.5
0
20 40 60 80 100 120 140 160 180 200
ksir
evitaler
naiseyaB
DGF Policy
Chernoff Policy
Sluggish Policy
DBS Policy
SPRT Policy
(c)Bayesrelativerisk
Fig.3. DBSPolicyinM =5, −cl s ogc =5c,λ f =0.001,λg =0.4
18
7
6
5
4
3
2
1
0 20 40 60 80 100 120 140 160 180 200
snoitavresbo
fo
rebmuN
DGF Policy
Chernoff Policy
Sluggish Policy
DBS Policy
SPRT Policy
(a)Therelativeratioofobservations
400
350
300
250
200
150
100
50
0
0 20 40 60 80 100 120 140 160 180 200
sgnihctiwS
fo
rebmuN
DGF Policy
Chernoff Policy
Sluggish Policy
DBS Policy
SPRT Policy
(b)Switchingnumber
140
120
100
80
60
40
20
0
0 20 40 60 80 100 120 140 160 180 200
ksir
evitaler
naiseyaB
DGF Policy
Chernoff Policy
Sluggish Policy
DBS Policy
SPRT Policy
(c)Bayesrelativerisk
Fig.4. DBSPolicyinM =5, −cl s ogc =5c,λ f =0.001,λg =0.4
19
distributions, depending on whether the process is normal or abnormal. Each swithcing across processes incurs an additional
switching cost s and each observation incurs detection delay c, while a wrong declaration incurs a loss of 1. The objective is
tofindasearchstrategythatminimizestheexpecteddetectiontimeandtheexpectedswitchingcostsubjecttoerrorprobability
constraint. Considering the order relationship between the detection delay and switching cost, we divided the problem into
two scenarios: the total switching cost is much smaller than the detection delay(i.e., s = o(−clogc) as c → 0), or the total
switching cost is comparable with the detection delay(i.e., s=Ω(−clogc) as c→0). We propose a deterministic policy and
proved that our policy is asymptotically optimal when the total switching cost is much smaller than the total observation cost
andisorderoptimalwhenthetotalswitchingcostiscomparablewiththeobservationcostascapproacheszero.Wealsooffers
better performance in the finite regime for different scenarios respectively. Our policy can also be applied to target detection,
fraud detection and other read-world scenarios.
Deriving optimal policies for the anomaly detection problem with switching cost considered in this paper requires the
assumption that only one process is in an abnormal state and the decision maker can probe only one process at each time. In
the future, we will further extend the problem to handle the case where multiple anomalous processes are present and multiple
processes can be probed simultaneously. In this paper, we also assume that the observation distributions under both hypothesis
are completely known. In further research, we expect that the policy can be extended to the situation where the distribution of
each process is heterogeneous or the number of processes is unknown.
APPENDIX
A. The Proof of Theorem 1
Inthissection,wewillprovetheasymptoticoptimalityofDBSpolicyinthesituationwheres=o(−clogc)ascapproaches
0. In App A.1, we show that −clogc+s· (cid:80)M (k−1)π is an asymptotic lower bound on the Bayesian risk. Then, we show
I∗(M) k=1 k
in App A.2 that if s = o(−clogc), the Bayesian risk under DBS policy R(DBS) approaches the asymptotic lower bound as
c→0.
1) The Asymptotic Lower Bound of the Bayesian risk
Proposition 1. Let R(Γ) be the Bayesian risks under any policy Γ. Then,
M
−logc (cid:88)
R(Γ)≥c· +s· (k−1)π(cid:48) as c→0, (19)
I∗(M) k
k=1
where π(cid:48) denote the kth highest probability of the priori probability set {π }M and
k m m=1


D(g||f), if Case I,
I∗(M)= (20)
D(f||g)/(M
−1), if Case II.
20
Proof: We divide the discussion about the asymptotic lower bound of Bayesian risk into the following three part: the
probability of error, the expected detection cost and the expected switching cost.
In App.A.1 of DGF Policy [13], it has been proved that −clogc is an asymptotic lower bound on the Bayesian risk without
I∗(M)
switching cost, which can be regarded as the asymptotic lower bound on the summation of the probability of error and the
expected detection cost, i.e.,
−logc
P (Γ)+cE(τ |Γ)≥c· as c→0. (21)
e c I∗(M)
Then,wewillanalyzethelowerboundoftheexpectedswitchingtime.Assumethateachprocessmustbeprobedcontinuously
until its state is declared. In another words, switching across processes is allowed only when the state of the currently probed
processisdeclared,whichistheminimalnumberofswitchingsduringthedetectionprocedure.ThusatmostM−1switchings
will occur and the expected switching time can be denoted as
M−1
(cid:88)
E(τ )= tP(τ =t),
s s
t=0
(cid:80)
where P(τ =t)=1.
t s
Sorting {π }M in descending order, we get the set {π(cid:48)}M , where π(cid:48) ≥π(cid:48) ≥···≥π(cid:48) ≥···≥π(cid:48) and π(cid:48) denote the
m m=1 k k=1 1 2 k M k
k-th highest probability of the priori probability set {π }M . Let π(cid:48) be the corresponding posterior probability at the i-th
m m=1 ik
choice. Let pi be the probability that process k is selected at the i-th choice. Then the probability of selecting the abnormal
k
process at the t-th choice can be expressed as
M
(cid:88)
P(τ =t)=(1−P(τ <t)) π(cid:48) ·pt.
s s tk k
k=1
It is known that P(τ = t) can be expressed as an expression independent of t. Thus, the problem of minimizing E(τ ) can
s s
be transformed into maximizing P(τ =t) for each t.
s
Then the probability of selecting the abnormal process at the first choice, which means the number of switching is equal to
zero, is
M
(cid:88)
P(τ =0)= π(cid:48) ·p1,
s 0k k
k=1
where π(cid:48) =π(cid:48). The solution for maximizing P(τ =0) is to make p1 be 1 and the rest to be 0. Thus, P(τ =0)≤π(cid:48).
0k k s 1 s 1
Then the probablity of selecting the abnormal process at the second choice is
M
(cid:88)
P(τ =1)=(1−P(τ <1)) π(cid:48) ·pt
s s tk k
k=1
1
=(1−P(τ =0))· ·
s 1−π(cid:48)
1
(π(cid:48) ·p2+···+π(cid:48) ·p2 +···+π(cid:48) ·p2 ).
2 2 k k M M
21
The solution for maximizing P(τ =1) is to make p2 be 1 and the rest to be 0. Thus, P(τ =1)≤π(cid:48).
s 2 s 2
Concequently, we can draw the conclusion that
∞ M
(cid:88) (cid:88)
E(τ )= tP(τ =t)≥ (k−1)π(cid:48)
s s k
t=0 k=1
Combining the above conclusions, the Bayesian risk considering switching cost in our problem is
R(Γ)=P (Γ)+cE(τ|Γ)+sE(τ |Γ)
e s
(22)
M
−clogc (cid:88)
≥ +s· (k−1)π(cid:48),
I∗(M) k
k=1
where π(cid:48) denote the kth highest probability of the priori probability set {π }M .
k m m=1
2) Asymptotic Optimality of DBS Policy in Scenario 1
In the following part, firstly, Lemma 1 shows that the error probability P =O(c). Secondly, Lemma 2 to Leamma 5 shows
e
that the expected switching time of the DBS policy is upper bounded by a constant. Then, Lemma 6 shows that the expected
detection time under the DBS policy is upper bounded by −(1+o(1)) logc . Finally, We will prove that the asymptotic
I∗(M)
Bayesian risk of DBS policy approaches the asymptotic lower bound.
Lemma 1. In the asymptotic regime, the error probability of DBS policy is upper bounded by:
P ≤(M −1)c. (23)
e
Proof: Let α = P (δ = H ) is the probability of declaring δ = H for all j (cid:54)= m when H is true. Thus,
m,j m j j m
(cid:80)
α = α . Note that accepting H implies that S (n)≥−logc in Case I or S (n)≤logc for all i(cid:54)=j in Case II.
m j(cid:54)=m m,j j j i
The stopping rule of single process is the same as the stopping rule of SPRT [3]. According to the conclusion of SPRT [3],
we can show that for all H (cid:54)=H ,
j m
(cid:88)
α = α (cid:54)(M −1)c. (24)
m m,j
j(cid:54)=m
Hence, (23) follows.
Under Hypothesis H , S (n) is a random walk with positive expected increment E (l (n))=D(g||f)>0 for m, while
m m m m
S (n), is a random walk with negative expected increment E (l (n))=−D(f||g)<0 for j (cid:54)=m. As a result, in Case I, the
j m j
process m is observed with higher probability than other processes j when n is sufficiently large, and the situation is opposite
in Case II. Next, we define a random time τk. In Case I, τk is the last passage time when process m1(n) (the largest observed
1 1
sum-LLRs process) is always the abnormal process for all n ≥ τk at stage k. In Case II, τk is the last passage time when
1 1
process m−1(n) (the smallest observed sum-LLRs process) is always normal for all n ≥ τk at stage k. It should be noted
1
that τk is not a stopping time and the agent does not know whether τk has arrived. In Lemma 2 below we show that τk is
1 1 1
22
sufficiently small with high probability. We will use this result later to establish the upper bound of the actual stopping time
τ, the observations time τ and the switching time τ under DBS policy.
c s
Definition 1. In Case I, denote τk as the smallest integer such that m1(n) (cid:54)= j for all normal process j and all n ≥ τk in
1 1
stage k. In Case II, denote τk as the smallest integer such that m−1(n) (cid:54)= m for the abnormal process m and all n ≥ τk in
1 1
stage k.
Lemma 2. If the DBS policy has not been terminated, there exist finite constants D >0 and µ >0 such that
1 1
P (τk >n)≤D e−µ1n
m 1 1
for all i=1,2,...,M at the corresponding stage.
Proof:ThereisonlyonestageinCaseI,ourpolicyobservesthem1(n)processandfinalizesthestageonceS (n)≥
m1(n)
−logc. Note that
P (τk >n)≤P (maxsupS (t)−S (t)≥0)
m 1 m j m
j(cid:54)=mt≥n
(25)
∞
(cid:88)(cid:88)
≤ P (S (t)≥S (t)).
m j m
j(cid:54)=mt=n
In each stage of Case II, our policy will choose to observe the m−1(n) process and finalizes the stage once S (n)(cid:54)
m−1(n)
logc. Note that
P (τk >n)≤P (mininf(S (t)−S (t))≤0)
m 1 m m j
j(cid:54)=mt≥n
∞ (26)
(cid:88)(cid:88)
≤ P (S (t)≥S (t)).
m j m
j(cid:54)=mt=n
Therefore, it suffices to show that there exist finite constants D 1 (cid:48) >0 and µ(cid:48) 1 >0 such that P m (S j (t)≥S m (t))≤D 1 (cid:48)e−µ(cid:48) 1 n
for both Case I and Case II. The [13, Lemma 7] has proved the conclusion for Case I, because the preconditions of DBS
policy is the same as the DGF policy [13] in Case I, the conclusion is still valid in this problem. Then, we focus on Case II
and show that there exit D >0 and µ>0 such that P (S (t)≥S (t))≤De−µn.
m j m
LetN
(n)(cid:44)(cid:80)n
1 (n)bethenumberoftimesthatprocessj hasbeenobserveduptotimen.Eachterminthesummation
j t=1 j
on the RHS of (26) can be upper bounded by
P (S (n)≥S (n))
m j m
≤P (S (n)≥S (n),N (n)≥ρn)
m j m j
(27)
+P (S (n)≥S (n),N (n)≥ρn)
m j m m
+P (S (n)≥S (n),N (n)<ρn,N (n)<ρn),
m j m j m
23
whereρ= 1 and0<ρ≤1/16.Specifically,applying([13],Lemma7,(67))toourmodel,wecandrawtheconclusion
16(M−2)
that there exist finite constants γ >0 and C >0 such that
1 1
P (S (n)≥S (n))
m j m
≤2C e−γ1n+P (S (n)≥S (n),N (n)<ρn,N (n)<ρn)
1 m j m j m
(28)
≤2C e−γ1n+
1
(cid:18) (cid:19)
(cid:88) P N˜ (n)> n(1−2ρ) ,N (n)<ρn,N (n)<ρn ,
m r M −2 j m
r(cid:54)=j,m
From the second last inequality to the last inequality, what needs note is that the event (N (n) < ρn,N (n) < ρn) implies
j m
that processes j,m are not observed at least n˜ = n−N (n)−N (n) ≥ n(1−2ρ) times. Let N˜ (n) be number of times
j m r
when process r (cid:54)=j,m has been probed and process j,m have not been probed up to time n. We refer to each such time as
r -probing time. there exist a process r (cid:54)=j,m such that N˜ (n)≥ n˜ ≥ n(1−2ρ).
(cid:54)=j,m r M−2 M−2
It remains to show that the second term in the summation on the RHS of (28) decreases exponentially with n. Due to the
difference in the selection rules of DBS policy and DGF policy in Case II, it should be noted that at every r -probing
(cid:54)=j,m
time, S (n)≥S (n) and S (n)≥S (n) must occur in Case II of DBS policy because the agent always observes the process
j r m r
m−1(n). Let t˜r,t˜r,··· ,t˜r be the r (cid:54)=j,m-probing time indices and let ζ (cid:44) 1−2ρ . The event N˜ (n)≥ n(1−2ρ) implies
1 2 N˜ r(n) 2(M−2) r M−2
that at time t˜r the inequalities S (t˜r ) ≥ S (t˜r ) and S (t˜r ) ≥ S (t˜r ) must occur. Since N (n) is the total number of
ζn j ζn r ζn m ζn r ζn r
observations taken from process r up to time t, then N (t˜r ) ≥ N˜ (t˜r ) = ζn. Hence, each term in the summation on the
r ζn r ζn
RHS of (28) can be upper bounded by
(cid:18) (cid:19)
n(1−2ρ)
P N (n)> ,N (n)<ρn,N (n)<ρn
m r M −2 j m
(cid:16) (cid:17)
≤P N˜ (n)>ζn,N (n)<ρn +
m r j
(cid:16) (cid:17)
P N˜ (n)>ζn,N (n)<ρn
m r m (29)
n
≤ (cid:88) P (cid:0) S (t˜r )≥S (t˜r ),N (n)<ρn (cid:1) +
m j ζn r ζn j
N(cid:48)=ζn
r
n
(cid:88) P (cid:0) S (t˜r )≥S (t˜r ),N (n)<ρn (cid:1) .
m m ζn r ζn m
N(cid:48)=ζn
r
24
Using the i.i.d. property of the LLRs across time we have
(cid:18) (cid:19)
n(1−2ρ)
P N (n)> ,N (n)<ρn,N (n)<ρn
m r M −2 j m
 
(cid:88) n (cid:88) n (cid:88) Nj (cid:88) N r (cid:48)
≤ P m l j (i)≥ l r (i)+
N
r
(cid:48)=ζnNj=0 i=1 i=1
 
(cid:88) n (cid:88) n (cid:88) Nm (cid:88) N r (cid:48)
P m l m (i)≥ l r (i) (30)
N
r
(cid:48)=ζnNm=0 i=1 i=1
 
n−ζn ρn Nj ζn+q
(cid:88) (cid:88) (cid:88) (cid:88)
≤ P m l j (i)≥ l r (i)+
q=0 Nj=0 i=1 i=1
n
(cid:88)
−ξn
(cid:88)
ρn (cid:32)
(cid:88)
Nm ξ
(cid:88)
n+q (cid:33)
P l (i)≥ l (i) .
m m r
q=0 Nm=0 i=1 i=1
Then we need to bound each term in the summation on the RHS of (30). Note that
ζn+q Nj ζn+q Nj
(cid:88) l (i)+ (cid:88) −l (i)= (cid:88) ˜l (i)+ (cid:88) −˜l (i)−D(f||g)(ζn+q−N ), (31)
r j r j j
i=1 i=1 i=1 i=1
where


l
k
(i)−D(g||f),if k =m,
˜l (i)=
k
l
k
(i)+D(f||g),if k (cid:54)=m.
Then,
 
ζn+q Nj
(cid:88) (cid:88)
P m l r (i)≤ l j (i)
i=1 i=1
 
ξn+q n(cid:48)
≤P m (cid:88) ˜l r (i)+ (cid:88) −˜l j (i)≥D(f||g)(ζn+q−N j ) (32)
i=1 i=1
 
ξn+q n(cid:48)
≤P m (cid:88) ˜l r (i)+ (cid:88) −˜l j (i)≥C 1 (ζn+q).
i=1 i=1
Applying the Chernoff inequality and using the i.i.d. property of ˜l (i),˜l (i) across time,
r j
 
ξn+q n(cid:48)
P m (cid:88) ˜l r (i)+ (cid:88) −˜l j (i)≥C 1 (ζn+q)
i=1 i=1
≤E (cid:18) e s· (cid:16)(cid:80) i ξ = n 1 +q˜lr(i)+(cid:80)n i= (cid:48) 1 −˜lj(i) (cid:17)(cid:19) ·e−sC1(ζn+q)
m
≤
(cid:16)
E (es·˜lr(1))
(cid:17)ξn+q
·
(cid:16)
E (e−s·˜lj(1))
(cid:17)Nj
·e−sC1(ζn+q)
(33)
m m
≤
(cid:16)
E
(es·(˜lr(1)+C1))
(cid:17)ξn+q
·
(cid:16)
E
(es·(−˜lj(1)+C1))
(cid:17)Nj
m m
·e−sC1(ζn+q)·e−sC1(ζn+q+Nj)
for all s < 0 and C = D(f||g). Since E (˜l (1)+C ) = C > 0 and E (−˜l (1)+C ) = C > 0 are strictly positive,
1 m r 1 1 m j 1 1
differentiating the MGFs (Moment Generating Functions) of l (i),l (i) with respect to s yields strictly positive derivatives
j m
25
at s = 0. As a result, there exist constants s < 0 and γ
2
> 0 such that E
m
(es·(˜lr(1)+C1)) , E
m
(es·(−˜lj(1)+C1)) and esC1 are
strictly less than e−γ2 <1. Hence,
 
ζn+q Nj
(cid:88) (cid:88)
P m l r (i)≤ l j (i)
i=1 i=1
≤
(cid:16)
E
(es·(˜lr(1)+C1))
(cid:17)ξn+q
·
(cid:16)
E
(es·(−˜lj(1)+C1))
(cid:17)Nj
m m
(34)
·e−sC1(ζn+q)·e−sC1(ζn+q+Nj)
≤e−γ2(ζn+q)·e−γ2Nj ·e−γ2(ζn+q)·e−γ2(ζn+q+Nj)
=e−γ2(3ζn+3q+2Nj).
Therefore,
 
n−ζn ρn Nj ζn+q
(cid:88) (cid:88) (cid:88) (cid:88)
P m l j (i)≥ l r (i)
q=0 Nj=0 i=1 i=1
n−ζn ρn
(cid:88) (cid:88) (35)
≤ e−γ2(3ζn+3q+2Nj)
q=0 Nj=0
1 1
≤e−γ2·3ζn· · =C e−γ3n,
1−e−3γ2 1−e−2γ2 3
where C = 1 and γ =3ζγ .
3 (1−e−3γ2)(1−e−2γ2) 3 2
Following the minor modifications, we can prove that there exist finite constants C >0 and γ >0 such that
4 4
n
(cid:88)
−ξn
(cid:88)
ρn (cid:32)
(cid:88)
Nm ξ
(cid:88)
n+q (cid:33)
P l (i)≥ l (i) ≤C e−γ4n. (36)
m m r 4
q=0 Nm=0 i=1 i=1
Thus, we complete the proof.
In what follows we define the second random time τk, where τk can be viewed as the last passage time when the switching
2 2
no longer occurs at stage k. It should be noted that τk ≥τk and the agent does not know whether τk has arrived. In Lemma
2 1 2
3 we show that the total time between τk and τk is sufficiently small with high probability, which means that the number of
1 2
switching is limited.
Definition 2. In Case I, denote τk as the smallest integer such that the value of m1(n) no longer changes for all n ≥ τk in
2 2
stage k. In Case II, denote τk as the smallest integer such that the value of m−1(n) no longer changes for all n≥τk in stage
2 2
k.
Definition 3. nk (cid:44)τk−τk denotes the total amount of time between τk and τk in stage k.
2 2 1 1 2
Lemma 3. If DBS policy has not been terminated, there exist D >0 and µ >0 such that
2 2
P (nk >n)≤D e−µ2n
m 2 2
26
for all m=1,2,...,M at the corresponding stage.
Proof: In Case I, we have only one anomalous process. It is obvious that τk = τk since there is only one stage, so the
2 1
conclusion of Lemma 2 also proves that there exist constants D
2
>0 and µ
2
>0 such that P
m
(nk
2
>n)≤D
2
e−µ2n.
In Case II, it can be verified that the M−1 normal processes are observed with higher probability than anomalous process
byLemma 2.S (n) islikely to bearandom variablewithnegativeexpected incrementE(l (n))<0.It isobvious
m−1(n) m−1(n)
that S (n)≤S (n), so E(S (t)−S (t))>0.
m−1(n) m−2(n) m−2(t) m−1(t)
Note that,
P (nk >n)
m 2
≤P (supl (t+1)+S (t)−S (t)≥0)
m m−1(t) m−1(t) m−2(t)
t≥n
∞
≤ (cid:88) P m (cid:16) ˜l m−1(t) (t+1)+S m−1(t) (t)−S m−2(t) (t)≥D(f||g) (cid:17) (37)
t=n
∞
≤ (cid:88) E
m
(cid:16) es·(˜l m−1(t) (t+1)+S m−1(t) (t)−S m−2(t) (t)−(cid:15)) (cid:17)
t=n
·e−s(D(f||g)−(cid:15))
for all s>0 and 0<(cid:15)<D(f||g).
The last equality follows by applying the Chernoff bound for each term in the summation on the RHS of the equality. Since
(cid:16) (cid:17)
E (˜l (t+1)+S (t)−S (t)−(cid:15) ≤−(cid:15)<0 are strictly negative, differentiating the MGFs of ˜l (t+
m m−1(t) m−1(t) m−2(t) m−1(t)
1)+S (t)−S (t)−(cid:15) with respect to s yields strictly negative derivatives at s=0. Hence, there exist s>0 and
m−1(t) m−2(t)
(cid:16) (cid:17)
γ > 0 such that E (˜l (t+1)+S (t)−S (t)−(cid:15) and e−s(cid:15) are strictly less than e−γ < 1. Furthermore,
m m−1(t) m−1(t) m−2(t)
there exist γ(cid:48) > 0 such that each term in the summation on the RHS less or equal to e−γ(cid:48)t. Thus, there exist C > 0 and
5
γ >0 such that
5
∞
(cid:88) E
m
(cid:16) es·(˜l m−1(t) (t+1)+S m−1(t) (t)−S m−2(t) (t)−(cid:15)) (cid:17)
t=n
·e−s(D(f||g)−(cid:15)) (38)
∞
≤ (cid:88) e−γ(cid:48)t ≤C e−γ5n,
5
t=n
which completes the proof.
According to the definition 1 and definition 2, we can know that the switchings between two different processes only occur
during τk and τk. Based on this, Lemma 4 will show that the time of switchings decreases exponentially with n.
1 2
27
Lemma 4. Assume that the DBS policy is implemented indefinitely. Then, there exist finite constants D >0 and γ such that
3 3
P (τk >n)≤D e−γ3n
m s 3
for all m=1,2,...,M at the corresponding stage.
Proof: It should be noted that the switching only occurs during τk and nk, therefore the times of switchings at each stage
1 2
follow that τk ≤τk+nk. Thus, there exist constants D >0 and γ >0 such that,
s 1 2 3 3
P (τk >n)≤P (τk+nk >n)
m s m 1 2
n n
≤P (τk > )+P (nk > )
m 1 2 m 2 2
(39)
≤D e−γ1n+D e−γ2n
1 2
≤D e−γ3n,
3
which completes the proof.
Below, we difine a random time τk. In Case I, τk is the time when sufficient information for declaring process m1(n)
3 3
as abnormal process has been gathered. In Case II, denote τk as the time when sufficient information for declaring process
3
m−1(n) as normal process has been gathered.
Definition4. InCaseI,denoteτk asthesmallestintegersuchthatS (τk)≥−logc.InCaseII,denoteτk asthesmallest
3 m1(τk) 3 3
3
integer such that S (τk)≤logc.
m−1(τk) 3
3
Definition 5. nk (cid:44)τk−τk denotes the total amount of time between τk and τk in stage k.
3 3 2 3 2
Combine the above definitions and conclusions, the DBS policy does not occurs switchings during τk to τk. For each
2 3
process, we will stop observing once |S (n)| ≥ −logc, it is equivalent to doing SPRT for each process during nk. Thus,
m 3
according to the conclusion of SPRT, we can draw the conclusion that,

D
−
(
l
g
o
|
g
|f
c
)
, if Case I,
E (nk)≤ (40)
m 3

−logc , if Case II.
D(f||g)
Next, we will analyze the expected times of switchings and observations of DBS policy in the asymptotic regime.
Lemma 5. Assume that the DBS policy is implemented indefinitely. Then, there exists T ∈ (0,∞) such that the expected
s
switching time of the DBS policy E (τ |DBS) satisfies
m s
E (τ |DBS)≤T . (41)
m s s
28
Proof: We first focus on one stage in the entire detection procedure. Then,
∞
(cid:88)
E (τk)= t·P (τk =t)
m s m s
t=1
∞
(cid:88)
≤ t·P (τk >t−1)
m s
t=1 (42)
∞
(cid:88)
≤ t·D e−γ3(t−1)
3
t=1
∞
(cid:88)
=D eγ3 te−γ3t =D (1−e−γ3)2,
3 3
t=1
where 0<D <∞ and γ >0. Thus, there exist T ∈(0,∞) such that
3 3 s
(cid:88) (cid:88)
E (τ )=E ( τk)= E (τk)
m s m s m s
k k (43)
(cid:88)
≤ D (1−e−γ3)2 ≤T ,
3 s
k
which completes the proof of Lemma 5.
It remains to show that the expected number of observations of the DBS policy.
Lemma 6. In the asymptotic regime, the expected detection time τ under the DBS policy is bounded by:
c
logc
E(τ )≤−(1+o(1)) as c→0. (44)
c I∗(M)
Proof: Following the above definitions, in Case I,
E (τ )=E (τ1)
m c m 3
=E (τ1+n1)+E (n1)
m 1 2 m 3
(45)
−logc
≤T +
s D(g||f)
logc
≤−(1+o(1)) as c→0.
D(g||f)
In Case II,
(cid:32)M−1 (cid:33)
(cid:88)
E (τ )=E τk
m c m 3
k=1
M−1
= (cid:88) (cid:0) E (τk+nk)+E (nk) (cid:1)
m 1 2 m 3
k=1 (46)
M−1(cid:18) (cid:19)
(cid:88) −logc
≤ T +
s D(f||g)
k=1
(M −1)logc
≤−(1+o(1)) as c→0.
D(f||g)
Combine the definition of (20), we complete the proof.
Lemma 7. In the asymptotic regime, the Bayesian risk under the DBS policy is upper bounded by
−clogc
R (DBS)≤O(c)+(1+o(1))· +s·T (47)
m I∗(M) s
29
for all m=1,2,...,M.
Proof: Combining Lemmas 5, 6 completes the proof.
Combining Proposition 1 and Lemma 7 yields the asymptotic optimality of DBS policy, presented in Theorem 1,
R(DBS) c· − I∗ l ( o M gc ) +s·T s
lim ≤ lim
c→0inf Γ R(Γ) c→0c· − I∗ l ( o M gc ) +s· (cid:80)M k=1 (k−1)π k
s·(T − M−1)
= lim1+ s 2 (48)
c→0 c· −logc +s· (cid:80)M (k−1)π
I∗(M) k=1 k
T − M−1
= lim1+ s 2 .
c→0 −clogc · 1 + (cid:80)M (k−1)π
s I∗(M) k=1 k
Note that s=o(−clogc) as conditioned by Theorem 1, we can know that lim −clogc →∞. Then,
c→0 s
R(DBS) T − M−1
lim = lim1+ s 2
c→0inf Γ R(Γ) c→0 −cl s ogc · I∗( 1 M) + (cid:80)M k=1 (k−1)π k
(49)
T − M−1
=1+ s 2 =1,
∞· 1 + (cid:80)M (k−1)π
I∗(M) k=1 k
which completes the proof.
B. The Proof of Theorem 2
The proof follows a similar line of arguments as in the proof of Theorem 1. Since the ratio of s/−clogc does not affect
the expected number of observations and switchings, the Lemma 6 and 5 still holds for Scenario 2 of the DBS policy. Thus,
R(DBS) c· − I∗ l ( o M gc ) +s·T s
lim ≤ lim
c→0inf Γ R(Γ) c→0c· − I∗ l ( o M gc ) +s· (cid:80)M k=1 (k−1)π k
s·(T −
(cid:80)M
(k−1)π )
= lim1+ s k=1 k (50)
c→0 c· −logc +s· (cid:80)M (k−1)π
I∗(M) k=1 k
T −
(cid:80)M
(k−1)π
= lim1+ s k=1 k .
c→0 −clogc · 1 + (cid:80)M (k−1)π
s I∗(M) k=1 k
Differ from the condition that s=o(−clogc) as c→0 in Scenario 1, we assume that s=Ω(−clogc) as c approaches 0 in
Scenario 2, which means that lim −clogc ≥0. Thus,
c→0 s
R(DBS) T −
(cid:80)M
(k−1)π
lim = lim1+ s k=1 k
c→0inf Γ R(Γ) c→0 −cl s ogc · I∗( 1 M) + (cid:80)M k=1 (k−1)π k
T −
(cid:80)M
(k−1)π
≤1+ s k=1 k (51)
(cid:80)M
(k−1)π
k=1 k
T
≤ s <∞,
(cid:80)M
(k−1)π
k=1 k
which completes the proof.
30
REFERENCES
[1] D.Chen,Q.Huang,H.Feng,Q.Zhao,andB.Hu,“Activeanomalydetectionwithswitchingcost,”inICASSP2019-2019IEEEInternationalConference
onAcoustics,SpeechandSignalProcessing(ICASSP). IEEE,2019,pp.5346–5350.
[2] H.Chernoff,“Sequentialdesignofexperiments,”TheAnnalsofMathematicalStatistics,vol.30,no.3,pp.755–770,1959.
[3] A.Wald,“Sequentialanalysis.”1947.
[4] S.A.Bessler,“Theoryandapplicationsofthesequentialdesignofexperiments,k-actionsandinfinitelymanyexperiments.parti.theory,”StanfordUniv
CAAppliedMathematicsandStatisticsLabs,Tech.Rep.,1960.
[5] M.NaghshvarandT.Javidi,“Activem-arysequentialhypothesistesting,”in2010IEEEInternationalSymposiumonInformationTheory. IEEE,2010,
pp.1623–1627.
[6] M.Naghshvar,T.Javidietal.,“Activesequentialhypothesistesting,”TheAnnalsofStatistics,vol.41,no.6,pp.2703–2738,2013.
[7] M.NaghshvarandT.Javidi,“Informationutilityinactivesequentialhypothesistesting,”in201048thAnnualAllertonConferenceonCommunication,
Control,andComputing(Allerton). IEEE,2010,pp.123–129.
[8] M. Naghshvar and T. Javidi, “Performance bounds for active sequential hypothesis testing,” in 2011 IEEE International Symposium on Information
TheoryProceedings. IEEE,2011,pp.2666–2670.
[9] M. Naghshvar and T. Javidi, “Sequentiality and adaptivity gains in active hypothesis testing,” IEEE Journal of Selected Topics in Signal Processing,
vol.7,no.5,pp.768–782,2013.
[10] S.Nitinawarat,G.K.Atia,andV.V.Veeravalli,“Controlledsensingforhypothesistesting,”in2012IEEEInternationalConferenceonAcoustics,Speech
andSignalProcessing(ICASSP). IEEE,2012,pp.5277–5280.
[11] S. Nitinawarat, G. K. Atia, and V. V. Veeravalli, “Controlled sensing for multihypothesis testing,” IEEE Transactions on Automatic Control, vol. 58,
no.10,pp.2451–2464,2013.
[12] S.NitinawaratandV.V.Veeravalli,“Controlledsensingforsequentialmultihypothesistestingwithcontrolledmarkovianobservationsandnon-uniform
controlcost,”SequentialAnalysis,vol.34,no.1,pp.1–24,2015.
[13] K. Cohen and Q. Zhao, “Active hypothesis testing for anomaly detection,” IEEE Transactions on Information Theory, vol. 61, no. 3, pp. 1432–1450,
2015.
[14] K. Cohen, Q. Zhao, and A. Swami, “Optimal index policies for anomaly localization in resource-constrained cyber systems,” IEEE Transactions on
SignalProcessing,vol.62,no.16,pp.4224–4236,2014.
[15] C.Wang,K.Cohen,andQ.Zhao,“Activehypothesistestingonatree:Anomalydetectionunderhierarchicalobservations,”inInternationalSymposium
onInformationTheory(ISIT). IEEE,2017,pp.993–997.
[16] K. Cohen and Q. Zhao, “Asymptotically optimal anomaly detection via sequential testing,” IEEE Transactions on Signal Processing, vol. 63, no. 11,
pp.2929–2941,2015.
[17] B.Huang,K.Cohen,andQ.Zhao,“Activeanomalydetectioninheterogeneousprocesses,”IEEETransactionsonInformationTheory,vol.65,no.4,
pp.2284–2301,2018.
[18] A.Gurevich,K.Cohen,andQ.Zhao,“Sequentialanomalydetectionunderanonlinearsystemcost,”IEEETransactionsonSignalProcessing,vol.67,
no.14,pp.3689–3703,2019.
[19] B.Hemo,T.Gafni,K.Cohen,andQ.Zhao,“Searchingforanomaliesovercompositehypotheses,”IEEETransactionsonSignalProcessing,vol.68,
pp.1181–1196,2020.
[20] A.Tartakovsky,I.Nikiforov,andM.Basseville,Sequentialanalysis:Hypothesistestingandchangepointdetection. ChapmanandHall/CRC,2014.
31
[21] F.CecchiandN.Hegde,“Adaptiveactivehypothesistestingunderlimitedinformation,”inAdvancesinNeuralInformationProcessingSystems,2017,
pp.4035–4043.
[22] D.Kartik,A.Nayyar,andU.Mitra,“Testingforanomalies:Activestrategiesandnon-asymptoticanalysis,”arXivpreprintarXiv:2005.07696,2020.
[23] M.-C.ChangandM.R.Bloch,“Evasiveactivehypothesistesting,”in2020IEEEInternationalSymposiumonInformationTheory(ISIT). IEEE,2020,
pp.1248–1253.
[24] N.K.VaidhiyanandR.Sundaresan,“Activesearchwithacostforswitchingactions,”in2015InformationTheoryandApplicationsWorkshop(ITA).
IEEE,2015,pp.17–24.