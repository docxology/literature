Active Inference for Adaptive BCI: application to the P300
Speller
Jelena Mladenovi´c1,2, Jérémy Frey3, Emmanuel Maby2, Mateus Jofﬁly4, Fabien Lotte1,
Jérémie Mattout2
1Inria, Bordeaux, France; 2CRNL Inserm, CNRS, Lyon, France; 3Ullo, La Rochelle, France;
4GATE, CNRS, Lyon, France
Correspondence: Jelena Mladenovi´c, Inria, Bordeaux, France. E-mail: jelena.mladenovic@inria.fr
Abstract.
Adaptive Brain-Computer interfaces (BCIs) have shown to improve performance, however a general and ﬂexible
framework to implement adaptive features is still lacking. We appeal to a generic Bayesian approach, called Active
Inference (AI), to infer user’s intentions or states and act in a way that optimizes performance. In realistic P300-speller
simulations, AI outperforms traditional algorithms with an increase in bit rate between 18% and 59%, while offering
a possibility of unifying various adaptive implementations within one generic framework.
Keywords: Active Inference, BCI, P300 Speller, EEG
1 Introduction
Adaptive BCIs have shown to improve performance [Mladenovi ´c et al., 2017], however thorough adaptation is far
from being reached, and a general and ﬂexible framework to implement adaptive features is still lacking. We appeal to
a generic Bayesian approach, called Active Inference (AI), which tightly couples perception and action [Friston et al.,
2006]. Endowing the machine with AI, enables: (1) to infer user’s intentions or states by accumulating observations
(e.g. electrophysiological data) in a ﬂexible manner, as well as (2) to act adaptively in a way that optimizes perfor-
mance. We illustrate AI applied to BCI using realistic P300-speller simulations. We demonstrate it can implement
new features such as optimizing the sequence of ﬂashed letters and yield signiﬁcant bit rate increases.
2 Material, Methods and Results
Active Inference rests on an explicit probabilistic model of user and task. Key variables include observed data, user
hidden states, and machine’s action, as follows.
The observed data, here electroencephalagraphy (EEG) responses to target, non-target (P300 or not) and feedback
stimuli (Error Potentials – ErrPs or not), allow the machine to infer user’s hidden states, here the intention to spell
a letter or pause as well as the recognition of a target/non-target or a correct/incorrect feedback. Depending on the
hidden states inferred, the computer has possible actions, here to ﬂash in order to accumulate conﬁdence about the
target letter, to stop ﬂashing and to display the chosen letter, or to switch off the screen if it infers an idle state of the
user, i.e. no P300 response has been observed for some time.
Each hidden state is mapped onto observations through the data likelihood matrix which can be learned from
calibration data. Given the machine’s actions, the transitions between hidden states are modeled by a probability
(Markov) martix. We also predeﬁne the preference over all possible outcomes. Typically, the preferred outcome is to
be in the state of observing a correctly spelled letter. Finally, a parameter γ sets the exploration-exploitation tradeoff
for action selection.
We compared AI to two classical approaches:
1. P300-spelling with a ﬁxed ﬂash number (12) of repetitions and pseudo-random ﬂashing;
2. P300-spelling with pseudo-random ﬂashing but optimal stopping [Mattout et al., 2015].
To do so, we used data from 18 subjects from a previous P300-speller experiment [Perrin et al., 2011]. For each
algorithm and subject, we simulated the spelling of 12000 letters.
Furthermore, to demonstrate AI’s ﬂexibility, we implemented a "LookAway" case, in which the machine would
infer the user to be in idle state and would switch the screen off. We also simulated an ErrP classiﬁcation enabling the
7th International BCI Meeting, May 21-15, 2018 1
arXiv:1805.09109v1  [cs.HC]  22 May 2018
automated detection of a wrongly spelled letter. In case of such detection, AI picks the next most probable letter to
spell or choose to continue ﬂashing to strengthen its conﬁdence.
AI showed signiﬁcantly higher bit rate (54.12bit/min) than the second best strategy (optimal stopping, 45.70bit/min),
see Figure 1. Its performance increased even further when a perfect ErrP classiﬁer is used (73bit/min). Finally, when
idle user states are simulated, it accurately switches off the speller ≈89% of the time, after ≈24 ﬂashes.
Figure 1: Comparison in bit rate (bit/min) between various ﬂashing methods in a P300 BCI application. Data collected from the
simulated spelling of 12000 letters with 18 subjects who were recorded in a previous experiment [Perrin et al., 2011]. All methods
signiﬁcantly differ from one another (ANOVA, Tukey post-hoc, p< 0.01).
3 Discussion
Our results demonstrate a great potential for implementing adaptive BCI beyond existing approaches, showing an
increase of 18% and 59% (using ErrP classiﬁer) in bit rate.
4 Signiﬁcance
AI outperforms other algorithms while offering a possibility of unifying various adaptive implementations within
one generic framework. Thanks to such genericity, with only a few tuning of its parameters, AI can incorporate many
features, such as automated correction or accounting for an idle user state. It can adjust to signal variability by inferring
about the user, but it can also take into account the inﬂuence of its actions onto the user. This approach lays ground
for future co-adaptive systems.
References
Friston, K., Kilner, J., and Harrison, L. (2006). A free energy principle for the brain. Journal of Physiology-Paris,
100(1-3):70–87.
Mattout, J., Perrin, M., Bertrand, O., and Maby, E. (2015). Improving bci performance through co-adaptation: Appli-
cations to the p300-speller. Annals of physical and rehabilitation medicine, 58(1):23–28.
Mladenovi´c, J., Mattout, J., and Lotte, F. (2017). A generic framework for adaptive EEG-based BCI training and
operation. In Nam, C. S., Nijholt, A., and Lotte, F., editors, Brain-Computer Interfaces Handbook: Technologi-
cal and Theoretical Advances, volume 1 of Brain-Computer Interfaces Handbook: Technological and Theoretical
Advances. CRC Press: Taylor & Francis Group.
Perrin, M., Maby, E., Bouet, R., Bertrand, O., and Mattout, J. (2011). Detecting and interpreting responses to feedback
in bci. pages 116–119.
7th International BCI Meeting, May 21-15, 2018 2