Active Inference for Adaptive BCI: application to the P300
Speller
JelenaMladenovic´1,2,JérémyFrey3,EmmanuelMaby2,MateusJoffily4,FabienLotte1,
JérémieMattout2
1Inria,Bordeaux,France;2CRNLInserm,CNRS,Lyon,France;3Ullo,LaRochelle,France;
4GATE,CNRS,Lyon,France
Correspondence:JelenaMladenovic´,Inria,Bordeaux,France.E-mail:jelena.mladenovic@inria.fr
Abstract.
AdaptiveBrain-Computerinterfaces(BCIs)haveshowntoimproveperformance,howeverageneralandflexible
framework to implement adaptive features is still lacking. We appeal to a generic Bayesian approach, called Active
Inference(AI),toinferuser’sintentionsorstatesandactinawaythatoptimizesperformance.InrealisticP300-speller
simulations,AIoutperformstraditionalalgorithmswithanincreaseinbitratebetween18%and59%,whileoffering
apossibilityofunifyingvariousadaptiveimplementationswithinonegenericframework.
Keywords:ActiveInference,BCI,P300Speller,EEG
1 Introduction
Adaptive BCIs have shown to improve performance [Mladenovic´ et al., 2017], however thorough adaptation is far
frombeingreached,andageneralandflexibleframeworktoimplementadaptivefeaturesisstilllacking. Weappealto
agenericBayesianapproach,calledActiveInference(AI),whichtightlycouplesperceptionandaction[Fristonetal.,
2006]. EndowingthemachinewithAI,enables: (1)toinferuser’sintentionsorstatesbyaccumulatingobservations
(e.g. electrophysiological data) in a flexible manner, as well as (2) to act adaptively in a way that optimizes perfor-
mance. We illustrate AI applied to BCI using realistic P300-speller simulations. We demonstrate it can implement
newfeaturessuchasoptimizingthesequenceofflashedlettersandyieldsignificantbitrateincreases.
2 Material,MethodsandResults
ActiveInferencerestsonanexplicitprobabilisticmodelofuserandtask. Keyvariablesincludeobserveddata, user
hiddenstates,andmachine’saction,asfollows.
Theobserveddata,hereelectroencephalagraphy(EEG)responsestotarget,non-target(P300ornot)andfeedback
stimuli (Error Potentials – ErrPs or not), allow the machine to infer user’s hidden states, here the intention to spell
a letter or pause as well as the recognition of a target/non-target or a correct/incorrect feedback. Depending on the
hidden states inferred, the computer has possible actions, here to flash in order to accumulate confidence about the
targetletter,tostopflashingandtodisplaythechosenletter,ortoswitchoffthescreenifitinfersanidlestateofthe
user,i.e. noP300responsehasbeenobservedforsometime.
Each hidden state is mapped onto observations through the data likelihood matrix which can be learned from
calibration data. Given the machine’s actions, the transitions between hidden states are modeled by a probability
(Markov)martix. Wealsopredefinethepreferenceoverallpossibleoutcomes. Typically,thepreferredoutcomeisto
beinthestateofobservingacorrectlyspelledletter. Finally,aparameterγ setstheexploration-exploitationtradeoff
foractionselection.
WecomparedAItotwoclassicalapproaches:
1. P300-spellingwithafixedflashnumber(12)ofrepetitionsandpseudo-randomflashing;
2. P300-spellingwithpseudo-randomflashingbutoptimalstopping[Mattoutetal.,2015].
Todoso,weuseddatafrom18subjectsfromapreviousP300-spellerexperiment[Perrinetal.,2011]. Foreach
algorithmandsubject,wesimulatedthespellingof12000letters.
Furthermore, to demonstrate AI’s flexibility, we implemented a "LookAway" case, in which the machine would
infertheusertobeinidlestateandwouldswitchthescreenoff. WealsosimulatedanErrPclassificationenablingthe
7thInternationalBCIMeeting,May21-15,2018 1
8102
yaM
22
]CH.sc[
1v90190.5081:viXra
automated detection of a wrongly spelled letter. In case of such detection, AI picks the next most probable letter to
spellorchoosetocontinueflashingtostrengthenitsconfidence.
AIshowedsignificantlyhigherbitrate(54.12bit/min)thanthesecondbeststrategy(optimalstopping,45.70bit/min),
seeFigure1. ItsperformanceincreasedevenfurtherwhenaperfectErrPclassifierisused(73bit/min). Finally,when
idleuserstatesaresimulated,itaccuratelyswitchesoffthespeller≈89%ofthetime,after≈24flashes.
Figure1: Comparisoninbitrate(bit/min)betweenvariousflashingmethodsinaP300BCIapplication. Datacollectedfromthe
simulatedspellingof12000letterswith18subjectswhowererecordedinapreviousexperiment[Perrinetal.,2011].Allmethods
significantlydifferfromoneanother(ANOVA,Tukeypost-hoc,p<0.01).
3 Discussion
Our results demonstrate a great potential for implementing adaptive BCI beyond existing approaches, showing an
increaseof18%and59%(usingErrPclassifier)inbitrate.
4 Significance
AI outperforms other algorithms while offering a possibility of unifying various adaptive implementations within
onegenericframework. Thankstosuchgenericity,withonlyafewtuningofitsparameters,AIcanincorporatemany
features,suchasautomatedcorrectionoraccountingforanidleuserstate.Itcanadjusttosignalvariabilitybyinferring
abouttheuser, butitcanalsotakeintoaccounttheinfluenceofitsactionsontotheuser. Thisapproachlaysground
forfutureco-adaptivesystems.
References
Friston, K., Kilner, J., and Harrison, L. (2006). A free energy principle for the brain. Journal of Physiology-Paris,
100(1-3):70–87.
Mattout,J.,Perrin,M.,Bertrand,O.,andMaby,E.(2015). Improvingbciperformancethroughco-adaptation: Appli-
cationstothep300-speller. Annalsofphysicalandrehabilitationmedicine,58(1):23–28.
Mladenovic´, J., Mattout, J., and Lotte, F. (2017). A generic framework for adaptive EEG-based BCI training and
operation. In Nam, C. S., Nijholt, A., and Lotte, F., editors, Brain-Computer Interfaces Handbook: Technologi-
calandTheoreticalAdvances,volume1ofBrain-ComputerInterfacesHandbook: TechnologicalandTheoretical
Advances.CRCPress: Taylor&FrancisGroup.
Perrin,M.,Maby,E.,Bouet,R.,Bertrand,O.,andMattout,J.(2011).Detectingandinterpretingresponsestofeedback
inbci. pages116–119.
7thInternationalBCIMeeting,May21-15,2018 2