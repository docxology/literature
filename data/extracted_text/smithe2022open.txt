J. Master & M. Lewis (Eds.): Fifth International
Conference on Applied Category Theory (ACT 2022).
EPTCS 380, 2023, pp. 307–330, doi:10.4204/EPTCS.380.18
© T. St. Clere Smithe
This work is licensed under the Creative Commons
Attribution-Share Alike License.
Open Dynamical Systems as Coalgebras for Polynomial
Functors, with Application to Predictive Processing
Toby St. Clere Smithe
Topos Institute
toby@topos.institute
We present categories of open dynamical systems with general time evolution as categories of
coalgebras opindexed by polynomial interfaces, and show how this extends the coalgebraic framework
to capture common scientific applications such as ordinary differential equations, open Markov
processes, and random dynamical systems. We then extend Spivak’s operadOrg to this setting, and
construct associated monoidal categories whose morphisms represent hierarchical open systems; when
their interfaces are simple, these categories supply canonical comonoid structures. We exemplify these
constructions using the ‘Laplace doctrine’, which provides dynamical semantics for active inference,
and indicate some connections to Bayesian inversion and coalgebraic logic.
1 Background
1.1 Closed dynamical systems and Markov processes
In this brief section, we recall a ‘behavioural’ approach to dynamical systems originally due (we believe)
to Lawvere; for a pedagogical account, see [1]. These systems are ‘closed’ in the sense that they do not
require environmental interaction for their evolution, but they nonetheless form the starting point for our
categories of more open systems.
Definition 1.1. Let pT,`,0qbe a monoid, representing time. Let X : E be some space, called the state
space. Then a closed dynamical systemϑ with state spaceX and timeT is an action of T on X. When T
is also an object of E, then this amounts to a morphism ϑ : TˆX ÑX (or equivalently, a time-indexed
family of X-endomorphisms, ϑptq: X ÑX), such that ϑp0q“ idX and ϑps `tq“ ϑpsq˝ϑptq.
Proposition 1.2. When time is discrete, as in the case T “N, any dynamical system ϑ is entirely
determined by its action at 1 : T. That is, letting the state space be X, we have ϑptq“ ϑp1q˝t where
ϑp1q˝t means “compose ϑp1q: X ÑX with itself t times”.
Example 1.3. Suppose X : U ÑTU is a vector field on U, with a corresponding solution (integral curve)
χx : R ÑU for all x : U; that is, χ1ptq“ Xpχxptqqand χxp0q“ x. Then letting the point x vary, we obtain
a map χ : RˆU ÑU. This χ is a closed dynamical system with state space U and time R.
Proposition 1.4. Closed dynamical systems with state spaces in E and time T are the objects of the
functor category CatpBT,Eq, where BT denotes the delooping of the monoid T. Morphisms of dynamical
systems are therefore natural transformations.
We will also often be interested in dynamical systems whose evolution has ‘side-effects’, such as the
generation (or ‘mixing’) of uncertainty or randomness. We will largely model such systems as Kleisli
maps or coalgebras of monads modelling these side-effects. In the case of uncertainty, the monads will be
so-called probability monads, which we will often denote by P. Such a monad P : E ÑE can often be
thought of as taking each set or space X : E to the set (or space) PX of probability distributions over
308 Dynamical Systems via Generalized Polynomial Coalgebra
X, and each morphism to the corresponding ‘pushforwards’ map; the monad multiplication is given by
“averaging out” uncertainty, and the unit takes a point to the ‘Dirac’ distribution over it. With these ideas
in mind, we can extend the concepts above to cover Markov chains and Markov processes.
Example 1.5 (Closed Markov chains and Markov processes). A closed Markov chainis given by a map
X ÑPX, where P : E ÑE is a probability monad on E; this is equivalently a P-coalgebra with time
N, and an object in Cat
`
BN,KℓpPq
˘
. With more general time T, one obtains closed Markov processes:
objects in Cat
`
BT,KℓpPq
˘
. More explicitly, a closed Markov process is a time-indexed family of
Markov kernels; that is, a morphism ϑ : TˆX ÑPX such that, for all times s,t : T, ϑs`t “ϑs ‚ϑt
as a morphism in KℓpPq. Note that composition ‚in KℓpPqis given by the Chapman-Kolmogorov
equation, so this means that
ϑs`t py|xq“
ż
x1:X
ϑspy|x1qϑt pdx1|xq.
1.2 Polynomial functors
We will use polynomial functorsto model the interfaces of our open systems, following Spivak and Niu
[2]. We will assume these to be functors E ÑE for a locally Cartesian closed category E, but we will
typically assume that E is furthermore concrete, and often that it is in fact Set.
Definition 1.6. Let E be a locally Cartesian closed category, and denote byyA the representable copresheaf
yA :“EpA,´q: E ÑE. A polynomial functor p is a coproduct of representable functors, written
p :“ř
i:pp1qypi , where pp1q: E is the indexing object. The category of polynomial functors in E is the
full subcategory PolyE ãÑrE,Esof the E-copresheaf category spanned by coproducts of representables.
A morphism of polynomials is therefore a natural transformation.
Remark 1.7. Every polynomial functor P : E ÑE corresponds to a bundle p : E ÑB in E, for which
B “Pp1qand for each i : Pp1q, the fibre pi is Ppiq. We will henceforth elide the distinction between a
copresheaf P and its corresponding bundle p, writing pp1q:“B and pris:“pi, where E “ř
i pris. A
natural transformation f : p Ñq between copresheaves therefore corresponds to a map of bundles. In the
case of polynomials, by the Yoneda lemma, this map is given by a ‘forwards’ map f1 : pp1qÑ qp1qand a
family of ‘backwards’ maps f # : qrf1p-qsÑ pr-sindexed by pp1q, as in the left diagram below. Given
f : p Ñq and g : q Ñr, their composite g ˝f : p Ñr is as in the right diagram below.
E f ˚F F
B B C
f #
qp
f1
{
E f ˚g˚G G
B B D
pg fq#
rp
g1˝f1
{
where pg fq# is given by the pp1q-indexed family of composite maps rrg1pf1p-qqs
f ˚g#
Ý ÝÝ Ñqrf1p-qs
f #
Ý Ñpr-s.
We can interpret the type pp1qto be a set or space of ‘configurations’ or ‘positions’ of a p-shaped
system, and each pristo be the available ‘inputs’ or ‘directions’ available to the system when it is in
configuration/position i.
We now recall a handful of useful facts about polynomials and their morphisms, each of which is
explained in Spivak and Niu [2] and summarized in Spivak [3].
Proposition 1.8. Polynomial morphisms p Ñy correspond to sections pp1qÑ ř
i prisof the correspond-
ing bundle p.
T. St. Clere Smithe 309
Proposition 1.9. There is an embedding of E into PolyE given by taking objects X : E to the linear
polynomials Xy : PolyE and morphisms f : X ÑY to morphisms pf ,idX q: Xy ÑY y.
Proposition 1.10. There is a symmetric monoidal structure pb,yqon PolyE that we call tensor, and
which is given on objects by p bq :“ř
i:pp1q
ř
j:qp1qyprisˆqrjs and on morphisms f :“pf1, f #q: p Ñp1
and g :“pg1,g#q: q Ñq1by f bg :“pf1 ˆg1, f # ˆg#q.
Proposition 1.11. pPolyE ,b,yq is symmetric monoidal closed, with internal hom denoted r´,“s.
Explicitly, we have rp,qs“ ř
f :pÑq y
ř
i:pp1qqrf1piqs. Given an object A : E, we have rAy,ys– yA.
Proposition 1.12. The composition of polynomial functors q ˝p : E ÑE ÑE induces a monoidal
structure on PolyE , which we denote Ÿ, and call ‘composition’ or ‘substitution’. Its unit is again y.
Famously, Ÿ-comonoids correspond to categories and their comonoid homomorphisms are cofunctors
[4]. If T is a monoid, then the comonoid structure on yT corresponds witnesses it as the category BT.
Monomials of the form SyS can be equipped with a canonical comonoid structure witnessing the codiscrete
groupoid on S.
2 Open dynamical systems as polynomial coalgebras
2.1 Deterministic systems
Definition 2.1. A deterministic open dynamical system with interface p, state space S and time T is a
polynomial morphism β : SyS ÑrTy, pssuch that, for any section σ : p Ñy, the induced morphism
SyS β
Ý ÑrTy, ps
rTy,σs
ÝÝÝÑrTy,ys „Ý ÑyT
is a comonoid homomorphism.
To see how such a morphism β is like an ‘open’ version of the closed dynamical systems introduced
above, note that by the tensor-hom adjunction, β can equivalently be written with the type Ty bSyS Ñp.
In turn, such a morphism corresponds to a pair pβo,βuq, where βo is the component ‘on positions’ with
the type TˆS Ñpp1q, and βu is the component ‘on directions’ with the type ř
t:T
ř
s:S prβopt,sqsÑ S.
We will call the map βo the output map, as it chooses an output position for each state and moment in
time; and we will call the map βu the update map, as it takes a state s : S, a quantity of time t : T, and an
‘input’ in prβopt,sqs, and returns a new state. We might imagine the new state as being given by evolving
the system from s for time t, and the input as being given at the position corresponding to ps,tq.
But it is not sufficient to consider merely such pairs β “pβo,βuqto be our open dynamical systems,
for we need them to be like ‘open’ monoid actions: evolving for time t then for time s must be equivalent
to evolving for time t `s, given the same inputs. It is fairly easy to prove the following proposition, whose
proof we defer until after establishing the categories CoalgTppq.
Proposition 2.2. Comonoid homomorphisms SyS ÑyT correspond bijectively with closed dynamical
systems with state space S : E, in the sense given by functors BT ÑE.
This establishes that seeking such a comonoid homomorphism will give us the monoid action property
that we seek, and so it remains to show that a composite comonoid homomorphism of the formrTy,σs˝β
is a closed dynamical system with the “right inputs”. Unwinding this composite, we find that the condition
that it be a comonoid homomorphism corresponds to the requirement that, for any t : T, the closure
βσ : TˆS ÑS of β by σ given by
βσ ptq:“S
βoptq˚σ
Ý ÝÝÝÝ Ñ
ÿ
s:S
prβopt,sqs
βu
Ý ÑS
310 Dynamical Systems via Generalized Polynomial Coalgebra
constitutes a closed dynamical system on S. The idea here is that σ gives the ‘context’ in which we can
make an open system closed, thereby formalizing the “given the same inputs” requirement above.
With this conceptual framework in mind, we are in a position to render open dynamical systems on
p with time T into a category, which we will denote by CoalgTppq. Its objects will be pairs pS,βqwith
S : E and β an open dynamical on p with state space S; we will often write these pairs equivalently as
triples pS,βo,βuq, making explicit the output and update maps. Morphisms will be maps of state spaces
that commute with the dynamics:
Proposition 2.3. Open dynamical systems over p with time T form a category, denoted CoalgTppq. Its
morphisms are defined as follows. Let ϑ :“pX,ϑo,ϑuqand ψ :“pY,ψo,ψuqbe two dynamical systems
over p. A morphism f : ϑ Ñψ consists in a morphism f : X ÑY such that, for any time t : T and global
section σ : pp1qÑ ř
i:pp1q
prisof p, the following naturality squares commute:
X ř
x:X
prϑopt,xqs X
Y ř
y:Y
prψopt,yqs Y
ϑoptq˚σ ϑuptq
f f
ψoptq˚σ ψuptq
The identity morphism idϑ on the dynamical system ϑ is given by the identity morphism idX on its state
space X. Composition of morphisms of dynamical systems is given by composition of the morphisms of
the state spaces.
Proof. We need to check unitality and associativity of composition. This amounts to checking that
the composite naturality squares commute. But this follows immediately, since the composite of two
commutative diagrams along a common edge is again a commutative diagram.
We can alternatively state Proposition 2.2 as follows, noting that the polynomialy corresponds to a
trivial interface, exposing no configuration to any environment nor receiving any signals from it:
Proposition 2.4. CoalgT
idpyqis equivalent to the classical category CatpBT,Eqof closed dynamical
systems in E with time T.
Proof. The trivial interface y corresponds to the trivial bundle id1 : 1 Ñ1. Therefore, a dynamical
system over y consists of a choice of state space S along with a trivial output map ϑo “ : TˆS Ñ1
and a time-indexed update map ϑu : T ˆS ÑS. This therefore has the form of a classical closed
dynamical system, so it remains to check the monoid action. There is only one section of id1, which
is again id1. Pulling this back along the unique map ϑoptq: S Ñ1 gives ϑoptq˚id1 “idS. Therefore
the requirement that, given any section σ of y, the maps ϑu ˝ϑoptq˚σ form an action means in turn
that so does ϑu : TˆS ÑS. Since the pullback of the unique section id1 along the trivial output map
ϑoptq“ : S Ñ1 of any dynamical system in CoalgT
idpyqis the identity of the corresponding state
space idS, a morphism f : pϑp˚q,ϑu, qÑp ψp˚q,ψu, qin CoalgT
idpyqamounts precisely to a map
f : ϑp˚qÑ ψp˚qon the state spaces in E such that the naturality condition f ˝ϑuptq“ ψuptq˝ f of
Proposition 1.4 is satisfied, and every morphism in CatpBT,Eqcorresponds to a morphism in CoalgT
idpyq
in this way.
Now that we know that our concept of open dynamical system subsumes closed systems, let us
consider some more examples.
T. St. Clere Smithe 311
Example 2.5. Consider a dynamical system pS,ϑo,ϑuqwith outputs but no inputs. Such a system has a
‘linear’ interface p :“Iy for some I : E; alternatively, we can write its interfacep as the ‘bundle’ idI : I ÑI.
A section of this bundle must again be idI, and so ϑoptq˚idI “idS. Once again, the update maps collect
into to a closed dynamical system in CatpBT,Eq; just now we have outputs ϑo : T ˆS Ñpp1q“ I
exposed to the environment.
Proposition 2.6. When time is discrete, as with T “N, any open dynamical system pX,ϑo,ϑuqover p is
entirely determined by its components at 1 : T. That is, we have ϑoptq“ ϑop1q: X Ñpp1qand ϑuptq“
ϑup1q: ř
x:X prϑopxqsÑ X. A discrete-time open dynamical system is therefore a triple pX,ϑo,ϑuq,
where the two maps have types ϑo : X Ñpp1qand ϑu : ř
x:X prϑopxqsÑ X.
Proof. Suppose σ is a section of p. We require each closure ϑσ to satisfy the flow conditions, that
ϑσ p0q“ idX and ϑσ pt `sq“ ϑσ ptq˝ϑσ psq. In particular, we must have ϑσ pt `1q“ ϑσ ptq˝ϑσ p1q. By
induction, this means that we must have ϑσ ptq“ ϑσ p1q˝t (compare Proposition 1.2). Therefore we must
in general have ϑoptq“ ϑop1qand ϑuptq“ ϑup1q.
Example 2.7. Suppose 9x “f px,aqand b “gpxq, with f : X ˆA ÑT Xand g : X ÑB. Then, as for the
‘closed’ vector fields of Example 1.3, this induces an open dynamical system pX,
ş
f ,gq: CoalgRpByAq,
where
ş
f : RˆX ˆA ÑX returns the pX,Aq-indexed solutions of f .
Example 2.8. The preceding example is easily extended to the case of a general polynomial interface.
Suppose similarly that 9x “ f px,axqand b “gpxq, now with f : ř
x:X prgpxqsÑ T Xand g : X Ñpp1q.
Then we obtain an open dynamical system pX,
ş
f ,gq: CoalgR
idppq, where now
ş
f : Rˆř
x:X prgpxqsÑ X
is the ‘update’ and g : X Ñpp1qthe ‘output’ map.
It is quite straightforward to extend the construction of CoalgTppqto an opindexed category CoalgT;
we unravel this opindexing explicitly in the appendix (Proposition A.1).
Proposition 2.9. CoalgT extends to an opindexed category CoalgT : PolyE ÑCat. On objects
(polynomials), it returns the categories above. On morphisms of polynomials, we simply post-compose:
given ϕ : p Ñq and β : SyS ÑrTy, ps, obtain SyS ÑrTy, psÑr Ty,qsin the obvious way.
At this point, the reader may be wondering in what sense these open dynamical systems are coalgebras.
To see this, observe that a polynomial morphism SyS Ñq is equivalently a map S ÑqpSq: that is to say, a
q-coalgebra. By setting q “rTy, ps, we see the connection immediately; to make it clear, in Proposition
A.2, we spell it out for the case T “N.
2.2 Open Markov processes via stochastic polynomials
Just as coalgebras S ÑpS correspond to discrete-time deterministic open dynamical systems, coalgebras
S ÑpPS correspond to discrete-time stochastic dynamical systems when P is a probability monad
as introduced above. We have already seen that ‘closed’ Markov chains correspond to maps S ÑPS,
and that Markov processes in general time correspond to functors BT ÑKℓpPq. Our task in this
section is therefore to connect these two perspectives, extending the categories of deterministic coalgebras
CoalgTppq.
Working concretely, it is not hard to spot the relevant adjustment. We therefore make the following
definition.
Definition 2.10. Let M : E ÑE be a monad on the categoryE, and let p : PolyE be a polynomial inE. Let
pT,`,0qbe a monoid in E, representing time. Then a pM-coalgebra with timeT consists in a triple ϑ :“
312 Dynamical Systems via Generalized Polynomial Coalgebra
pS,ϑo,ϑuqof a state space S : E and two morphisms ϑo : TˆS Ñpp1qand ϑu : ř
t:T
ř
s:S prϑopt,sqsÑ
MS, such that, for any section σ : pp1qÑ ř
i:pp1qprisof p, the maps ϑσ : TˆS ÑMS given by
ÿ
t:T
S
ϑop´q˚σ
ÝÝÝÝÝÑ
ÿ
t:T
ÿ
s:S
prϑop´,sqs ϑu
ÝÑMS
constitute an object in the functor categoryCat
`
BT,KℓpTq
˘
, where BT is the delooping of T and KℓpTq
is the Kleisli category of T. Once more, we call the closed system ϑσ , induced by a section σ of p, the
closure of ϑ by σ.
As before, such pM-coalgebras form a category; and these categories in turn are opindexed by
polynomials.
Proposition 2.11. pM-coalgebras with time T form a category, denoted CoalgT
Mppq. Its morphisms
are defined as follows. Let ϑ :“pX,ϑo,ϑuqand ψ :“pY,ψo,ψuqbe two pM-coalgebras. A morphism
f : ϑ Ñψ consists in a morphism f : X ÑY such that, for any time t : T and global section σ : pp1qÑř
i:pp1q
prisof p, the following naturality squares commute:
X ř
x:X
prϑopt,xqs MX
Y ř
y:Y
prψopt,yqs MY
ϑoptq˚σ ϑuptq
f M f
ψoptq˚σ ψuptq
The identity morphism idϑ on the pM-coalgebra ϑ is given by the identity morphism idX on its state
space X. Composition of morphisms of pM-coalgebras is given by composition of the morphisms of the
state spaces.
Proposition 2.12. CoalgT
Mppqextends to an opindexed category, CoalgT
Mp´q: PolyE ÑCat. Suppose
ϕ : p Ñq is a morphism of polynomials. We define a corresponding functor CoalgT
Mpϕq: CoalgT
MppqÑ
CoalgT
Mpqqas follows. Suppose pX,ϑo,ϑuq: CoalgT
Mppqis an object ( pM-coalgebra) in CoalgT
Mppq.
Then CoalgT
MpϕqpX,ϑo,ϑuqis defined as the triple pX,ϕ1 ˝ϑo,ϑu ˝ϑo˚ϕ#q: CoalgT
Mpqq, where the two
maps are explicitly the following composites:
TˆX ϑo
ÝÑpp1q
ϕ1
Ý Ñqp1q,
ÿ
t:T
ÿ
x:X
qrϕ1 ˝ϑopt,xqs
ϑo˚ϕ#
Ý ÝÝÝ Ñ
ÿ
t:T
ÿ
x:X
prϑopt,xqs ϑu
ÝÑMX .
On morphisms, CoalgT
Mpϕqpf q: CoalgT
MpϕqpX,ϑo,ϑuqÑ CoalgT
MpϕqpY,ψo,ψuqis given by the same
underlying map f : X ÑY of state spaces.
The opindexed category CoalgT
Mppqclearly generalizes CoalgT, since we can always take M “idE .
Yet these concrete definitions obscure the more elegant representation of the objects of CoalgT as
morphisms SyS ÑrTy, ps. Our task is therefore to find a setting in which a similar representation
is possible; to do so, we generalize PolyE so that the backwards components of its morphisms may
incorporate ‘side-effects’ modelled by M. We will call the corresponding category PolyM, and will find
that instantiating CoalgT in PolyM recovers CoalgT
Mppq.
We begin by recalling that PolyE is equivalent to the category of Grothendieck lenses for the self-
indexing [2, 5]: PolyE –
ş
E{´op, where the opposite is taken pointwise on each E{B. We will define
T. St. Clere Smithe 313
PolyM by analogy, using the following indexed category. SupposeM is a commutative monad on E and
let ι denote the identity-on-objects inclusion E ãÑKℓpMqgiven on morphisms by post-composing with
the unit η of the monad structure. For ease of exposition in this short paper, we will assume here that
E “Set.
Definition 2.13. Define the indexed category EM{´: E op ÑCat as follows. On objects B : E, we define
EM{B to be the full subcategory of KℓpMq{B on those objects ι p : EÑ‚B which correspond to maps
E
p
Ý ÑB
ηB
Ý ÑMB in the image of ι. Now suppose f : C ÑB is a map in E. We define EM{f : EM{B ÑEM{C
as follows. The functor EM{f takes objects ι p : EÑ‚B to ιpf ˚pq: f ˚EÑ‚C where f ˚p is the pullback of p
along f in E, included into KℓpMqby ι.
To define the action of EM{f on morphisms α : pE,ι p : EÑ‚BqÑp F,ιq : FÑ‚Bq, note that since we
must have ιq ‚α “ι p, α must correspond to a family of maps αx : prxsÑ Mqrxsfor x : B. Then we can
define pEM{f qpαqpointwise as pEM{f qpαqy :“αf pyq: prf pyqsÑ Mqrf pyqsfor y : C.
Definition 2.14. We define PolyM to be the category of Grothendieck lenses for EM{´. That is, PolyM :“ş
EM{´op, where the opposite is again taken pointwise.
Unwinding this definition, we find that the objects of PolyM are the same polynomial functors as
constitute the objects of PolyE . The morphisms f : p Ñq are pairs pf1, f #q, where f1 : B ÑC is a map in
E and f # is a family of morphisms qrf1pxqsÑ‚prxsin KℓpMq, making the following diagram commute:
ř
x:B Mprxs ř
b:B qrf1pxqs ř
y:C qrys
B B C
f #
qηB˚p
f1
{
Remark 2.15. Note that the tensor bextends to PolyM: on objects, it is defined identically to the
tensor on PolyE . On morphisms f :“pf1, f #q: p Ñq and g :“pg1,g#q: p1Ñq1, we define the tensor
f bg to have forwards component f1 ˆg1 as before, and the backwards components are defined by
pf bgq#
px,x1q:“qrf1pxqsˆq1rg1px1qsÑ MprxsˆMp1rx1sÑ M
`
prxsˆp1rx1s
˘
, where the second arrow is
given by the commutativity of the monadM. On the other hand, we only get an internal hom satisfying the
adjunction PolyMpp bq,rq– PolyMpp,rq,rsqwhen the backwards components of morphisms p bq Ñr
are ‘uncorrelated’ between p and q.
Remark 2.16. For PolyM to behave faithfully like the category PolyE of polynomial functors and their
morphisms, we should want the substitution functors EM{f : EM{C ÑEM{B to have left and right adjoints.
Although we do not spell it out here, it is quite straightforward to exhibit the left adjoints. On the
other hand, writing f ˚ as shorthand for EM{f , we can see that a right adjoint only obtains in restricted
circumstances. Denote the putative right adjoint by Πf : EM{B ÑEM{C, and for ι p : EÑ‚B suppose that
pΠf Eqrysis given by the set of ‘partial sections’σ : f ´1tyuÑT Eof p over f ´1tyuas in the commutative
diagram:
f ´1tyu tyu
T E B C
f
{
ηB˚p
σ
Then we would need to exhibit a natural isomorphism EM{Bpf ˚D,Eq– EM{CpD,Πf Eq. But this will
only obtain when the ‘backwards’ components h#
y : DrysÑ MpΠf Eqrysare in the image of ι—otherwise,
it is not generally possible to pull f ´1tyuout of M.
314 Dynamical Systems via Generalized Polynomial Coalgebra
Despite these restrictions, we do have enough structure at hand to instantiate CoalgT in PolyM. The
only piece remaining is the composition product Ÿ, but for our purposes it suffices to define its action
on objects, which is identical to its action on objects in PolyE
1, and then consider Ÿ-comonoids in
PolyM. The comonoid laws force the structure maps to be deterministic (i.e., in the image of ι), and so
Ÿ-comonoids in PolyM are just Ÿ-comonoids in PolyE .
Finally, we note that we can define morphisms β : SyS ÑrTy, ps: these again just correspond to
morphisms Ty bSyS Ñp, and the condition that the backwards maps be uncorrelated between Ty and p
is satisfied because Ty has a trivial exponent. Unwinding such a β according to the definition of PolyM
indeed gives precisely a pair pβo,βuqof the requisite types; and a comonoid homomorphism SyS ÑyT
in PolyM is precisely a functor BT ÑKℓpMq, thereby establishing equivalence between the objects of
CoalgTppqestablished in PolyM and the objects of CoalgT
Mppq. The equivalence between the hom-sets is
established by a similar unwinding. All told, in this section, we have sketched the proof of the following
theorem:
Theorem 2.17. Constructing CoalgTppqin PolyM yields a category equivalent to CoalgT
Mppq.
2.3 Random dynamical systems and bundle systems
In the analysis of stochastic systems, it is often fruitful to consider two perspectives: on one side, one
considers explicitly the evolution of the distribution of the states of the system, by following (for instance)
a Markov process, or Fokker-Planck equation. On the other side, one considers the system as if it were a
deterministic system, perturbed by noisy inputs, giving rise to the frameworks of stochastic differential
equations and associated random dynamical systems.
Whereas a (closed) Markov process is typically given by the action of a ‘time’ monoid on an object
in a Kleisli category of a probability monad, a (closed) random dynamical system is given by a bundle
of closed dynamical systems, where the base system is equipped with a probability measure which it
preserves: the idea being that a random dynamical system can be thought of as a ‘random’ choice of
dynamical system on the total space at each moment in time, with the base measure-preserving system
being the source of the randomness [6].
This idea corresponds in non-dynamical settings to the notion ofrandomness pushback[7, Def. 11.19],
by which a stochastic map f : A ÑPB can be presented as a deterministic map f 5: ΩˆA ÑB where
pΩ,ωqis a probability space such that, for any a : A, pushing ω forward through f 5p-,aqgives the state
f paq; that is, ω induces a random choice of map f 5pω,-q: A ÑB. Similarly, under ‘nice’ conditions,
random dynamical systems and Markov processes do coincide, although they have different suitability in
applications.
In this section, we sketch how the generalized-coalgebraic structures developed above extend also to
random dynamical systems, though with most details deferred to the Appendix. By observing that we can
also ‘open up’ the base system of a random dynamical system, we obtain furthermore a notion of open
bundle system: a bundle of dynamical systems that is coherently ‘open’ over polynomials both in the total
space and the base space.
Definition 2.18. Suppose E is a category equipped with a probability monad P : E ÑE and a terminal
object 1 : E. A probability space in E is an object of the slice 1{KℓpPqof the Kleisli category of the
probability monad under 1.
Remark 2.19. In order to consider polynomials inE, we will later assume again that it is locally Cartesian
closed. A simple example of a locally Cartesian closed category equipped with a probability monad is
1We leave the full exposition ofŸ in PolyM to the forthcoming extended version of this paper.
T. St. Clere Smithe 315
the category Set equipped with the monad D taking each set to the set of finitely-supported probability
distributions upon it.
Proposition 2.20. There is a forgetful functor 1{KℓpPqÑ E taking probability spaces pB,βqto the
underlying spaces B and their morphisms f : pA,αqÑp B,βqto the underlying maps f : A ÑPB. We
will write B to refer to the space in E underlying a probability space pB,βq, in the image of this forgetful
functor.
Definition 2.21. Let pB,βqbe a probability space in E. A closed metric or measure-preserving dynamical
system pϑ,βqon pB,βqwith time T is a closed dynamical system ϑ with state space B : E such that, for
all t : T, Pϑptq˝β “β; that is, each ϑptqis a pB,βq-endomorphism in 1{KℓpPq.
Proposition 2.22. Closed measure-preserving dynamical systems in E with time T form the objects of a
category CatpBT,EqP whose morphisms f : pϑ,αqÑp ψ,βqare maps f : ϑp˚qÑ ψp˚qin E between
the state spaces that preserve both flow and measure, as in the following commutative diagram, which
also indicates their composition:
Pϑp˚q Pϑp˚q
1 Pψp˚q Pψp˚q 1
Pλp˚q Pλp˚q
α
β
γ
α
β
γ
Pϑptq
Pψptq
Pλptq
Pf Pf
Pg Pg
Definition 2.23. Let pϑ,βq be a closed measure-preserving dynamical system. A closed random
dynamical system over pϑ,βqis an object of the slice category CatpBT,Eq{ϑ; it is therefore a bundle of
the corresponding functors.
Example 2.24. The solutions Xpt,ω;x0q: R`ˆΩˆM ÑM to a stochastic differential equation dXt “
f pt,Xt qdt `σpt,Xt qdWt , where W : R`ˆΩ ÑM is a Wiener process in M, define a random dynamical
system R`ˆΩˆM ÑM : pt,ω,xqÞÑ Xpt,ω;x0qover the Wiener base flow θ : R`ˆΩ ÑΩ : pt,ωqÞÑ
Wps `t,ωq´Wpt,ωqfor any s : R`.
Definition 2.25. Let pθ,βqbe a closed measure-preserving dynamical system in E with time T, and let
p : PolyE be a polynomial in E. Write Ω :“θp˚qfor the state space of θ, and let π : S ÑΩ be an object
(bundle) in E{Ω. An open random dynamical system over pθ,βqon the interface p with state space
π : S ÑΩ and time T consists in a pair of morphisms ϑo : TˆS Ñpp1qand ϑu : ř
t:T
ř
s:S
prϑopt,sqsÑ S,
such that, for any global section σ : pp1qÑ ř
i:pp1q
prisof p, the maps ϑσ : TˆS ÑS defined as
ÿ
t:T
S
ϑop´q˚σ
ÝÝÝÝÝÑ
ÿ
t:T
ÿ
s:S
prϑop´,sqs ϑu
ÝÑS
form a closed random dynamical system in CatpBT,Eq{θ, in the sense that, for all t : T and sections σ,
the following diagram commutes:
S ř
s:S
prϑopt,sqs S
Ω Ω
π π
θptq
ϑoptq˚σ ϑuptq
316 Dynamical Systems via Generalized Polynomial Coalgebra
Proposition 2.26. Let pθ,βqbe a closed measure-preserving dynamical system in E with time T, and let
p : PolyE be a polynomial in E. Open random dynamical systems over pθ,βqon the interface p form the
objects of a category RDynTpp,θq. See Definition A.3 in the Appendix for details.
Proposition 2.27. The categories RDynTpp,θqcollect into a doubly-indexed category of the form
RDynT : PolyE ˆCatpBT,EqP ÑCat. See Proposition A.4 in the Appendix for details.
By allowing the base systems of open random dynamical systems instead to be arbitrary dynamical
systems, and then by opening them up similarly, one obtains notions ofopen bundle dynamical system, and
correspondingly doubly-opindexed categories over pairs of polynomials. Representing these categories
concisely, as we did for the categories CoalgT
Mppq, is the subject of on-going work, and so we defer the
details to the Appendix, in Definition A.5, and Propositions A.6, A.7, and A.8.
3 Hierarchical systems via generalized Org
In order to exhibit the main example of this paper, we will need to construct, from the opindexed categories
of pP-coalgebras introduced above, monoidal categories whose objects represent the interfaces of
hierarchical systems and whose morphisms represent the hierarchical systems themselves. Informally put,
we will think of a morphism p Ñq in such a category as “a q-shaped system with a p-shaped hole”. In
order to achieve this, we will in turn adopt and generalize the operad Org introduced by Spivak [8].
Definition 3.1 (Following Spivak [8, Def. 2.19]). We define a (category-enriched, symmetric, coloured)
operad, OrgT
M. Its objects are polynomials, and for any tuple of polynomials pp1,..., pk; p1q of at
least length 2, the hom category OrgT
Mpp1,..., pk; p1qis given by CoalgT
Mprp1 b¨¨¨b pk, p1sq. Note that
ty ÑrTy,rp, pssu–t Ty Ñrp, psu. On any given interface p, the identity coalgebra is therefore given by
the morphism Ty Ñrp, psthat constantly outputs idp and has trivial backwards component. To define
composition, we use the canonical maps rp,qsbrq,rsÑr p,rsand rp,qsbrp1,q1sÑr p bp1,q bq1s, the
pseudofunctoriality of CoalgT
Mp´q, and the laxators CoalgT
MppqˆCoalgT
MpqqÑ CoalgT
Mpp bqq; since
each of these components is associative and unital, the composition is well-defined.
Remark 3.2. Spivak’s original definition of Org corresponds to the case where M “idE and T “N.
For our present purposes, all that is required is to obtain from Org a (monoidal) (bi)category2. We
therefore restrict OrgT
M to a bicategory Hier whose objects are again polynomials and whose hom-
categories from p to q are given by OrgT
Mpp,qq; it inherits a monoidal structure from the monoidal
category associated to the symmetric operad OrgT
M. We will write Hier|E to denote the restriction of Hier
to the linear polynomials Ay.
To bring things a little down to earth, first consider a general systemβ : p Ñq in Hier. Recall that
rp,qs“ ř
f :pÑq y
ř
i:pp1qqrf1piqs. β is therefore given by a choice of state space X along with a pair of maps
βo : TˆX ÑPolyMpp,qqand βu : ř
t:T
ř
x:X
ř
i:pp1qqrβopt,sq1piqsÑ MX .
To make this a little more comprehensible again, suppose p “AyS and q “ByT . Then PolyMpp,qq“
EpA,BqˆEpAˆT,Sq, and so by the universal property of the product,βo is equivalently given by a pair of
maps: a ‘forwards’ output map βo
1 : TˆX ˆA ÑB and a ‘backwards’ output mapβo
2 : TˆX ˆAˆT ÑS;
if this reminds you of a category of lenses, then this is no surprise: the subcategory of PolyE on the
monomials AyS is indeed the category of bimorphic lenses in E. Finally, the update map simplifies to
βu : TˆX ˆAˆT ÑMX , which updates the state given ‘forwards’ inputs inA and ‘backwards’ inputs in
T. We might denote the subcategory of Hier on such linear polynomials as HiBi, to indicate ‘hierarchical
bidirectional’ systems.
2and in fact, we won’t even really need to make use of the monoidal or bicategorical structures here!
T. St. Clere Smithe 317
Taking one further step down the ladder of complexity, we briefly consider systemsβ : Ay ÑBy in
Hier|E : these are just hierarchical bidirectional systems where S “T “1. Therefore, in this case, the
backwards output map becomes trivial, leaving only a forwards output map βo : TˆX ˆA ÑB and an
update map taking inputs in A, βu : TˆX ˆA ÑMX . By filling in the A-inputs, we get a system with
B-outputs, corresponding to the informal intuition with which we opened this section: we have a B-shaped
system with an A-shaped hole. Composition of these systems corresponds to placing systems in parallel
using band plugging interfaces into holes of the matching shape.
We end this section by briefly sketching the canonical b-comonoid structure on Hier|E , making
Hier|E into a ‘semi-Markov’ [7] or ‘copy-discard’ [9] category. Note that, if a system has the trivial state
space 1, then (i) tensoring with it is a no-op, and (ii) it has a trivial update map (assuming that M1 –13).
Thus, for each object Ay, we obtain a discarding system A : Ay Ñ1y by taking the trivial state space,
trivial update map, and trivial output map. The copying system A : Ay ÑpA ˆAqy again has trivial state
space and update map, but now the output map o
A : TˆA ÑA ˆA is given by the constant copying map
pt,aqÞÑp a,aq. It is then straightforward to check the comonoid laws.
4 Dynamical Bayesian inversion
One consequence of Hier|E being a copy-discard category is that we can instantiate an abstract form
of Bayes’ rule there, giving rise to a notion of when one pP-coalgebraic system can be seen to be
‘predicting’ or ‘inverting’ another. In general, Bayes’ rule is expressed as an equality between morphisms,
but this is too strong for dynamical systems, which ‘black-box’ their state spaces: that is to say, we should
consider two morphisms (systems) ‘equal’ when they are observationally equivalent—or, more precisely,
when they are related by a (quasi-)bisimulation.
Definition 4.1. We define a family of relations „that we collectively call quasi-bisimilarity. Given
systems ϑ :“pX,ϑo,ϑuqand ψ :“pY,ψo,ψuqin CoalgT
Pppqand a section σ of p, we first define the
trace4 or trajectory of ϑ given σ as the morphism
trpθ,σq:“TˆX
ϑop-q˚σ
Ý ÝÝÝÝ Ñ
ÿ
t:T
ÿ
x:X
prϑopt,xqs
pϑuqŹT
ÝÝÝÝÑTˆPX Pϑo
Ý ÝÝ ÑPpp1q.
Supposing α : 1 ÑPX and β : 1 ÑPY to be corresponding initial states, we define ϑ
α,β
„ ψ as the
relation
ϑ
α,β
„ ψ ðñ @σ : Γppq.@t : T.trpϑ,σqptq‚α “trpψ,σqptq‚β ,
where we write g ‚f to indicate Kleisli composition g ‚f “µ ˝Pg ˝f (where µ is the multiplication of
the monad P). We write ϑ
D,D
„ψ when there exists some α,β such that ϑ
α,β
„ ψ, and likewise for ϑ
@,@
„ψ,
ϑ
@,D
„ψ, and ϑ
D,@
„ψ.
In light of this definition, we can define an appropriate notion of Bayesian inversion for Hier|E :
3This condition is satisfied when M is a probability monad like the finite-support distribution monad, for instance.
4Note that this is in analogy with the coalgebraic trace, not the trace of traced monoidal categories.
318 Dynamical Systems via Generalized Polynomial Coalgebra
Definition 4.2. We say that a system c : Xy ÑY yin Hier|E admits Bayesian inversionwith respect to
π : y ÑXy, if there exists a system c:
π : Y yÑXy satisfying the equation [9, eq. 5]:
c
π
X Y
D,D
„
c:π
π
c
X Y
We call c:
π the Bayesian inversionof c with respect to π, and call the defining relation the dynamical
Bayes’ rule.
5 The Laplace doctrine of predictive processing
In real-world systems, however, even such quasi-bisimulation is too strong. In the setting of computational
neuroscience, it is proposed [10, 11] that certain neural circuits implementapproximate Bayesian inference
by optimizing certain statistical games [12]. A statistical game consists of a Bayesian lens—a pair of a
‘forwards’ stochastic channel A ÑPB and a ‘backwards’ inversion PA ˆB ÑPA—equipped with a
loss function to evaluate the systems predictive performance. Embodied predictive systems such as brains
then realize these games as dynamical systems. Here we sketch this functorial semantics, using a category
of ‘hierarchical bidirectional Stat-systems’, following [12, 13].
We noted above that the category HiBi resembles a category of lenses, but it does not sufficiently
resemble the category of Bayesian lenses: notice that the backwards maps of the latter have codomains of
the form PA ˆT ÑPS rather than A ˆT ÑS. For this reason, HiBi makes for an inadequate semantic
category for predictive processing. However, all is not lost, for we can define a modification of HiBi
by analogy to the definition of Bayesian lenses as Grothendieck lenses for the indexed category Stat of
state-dependent maps [13].
Definition 5.1. Denote by HiBiP the following (semi-)(bi)category. Its objects are pairs of objects in E,
and its hom-categories HiBiPppA,Sq,pB,Tqqare given by OrgT
PpPAyS,ByT q. Composition is given by
the following family of composite maps:
HiBiPppA,Sq,pB,TqqˆHiBiPppB,Tq,pC,Uqq
“OrgT
PpPAyS,ByT qˆOrgT
PpPByT ,CyU q
“CoalgT
PprPAyS,ByT sqˆCoalgT
PprPByT ,CyU sq
ÑCoalgT
PprPAyS,ByT sbrPByT ,CyU sq
ÑCoalgT
PprPAyS,PByT sbrPByT ,CyU sq
ÑCoalgT
PprPAyS,CyU sq
“HiBiPppA,Sq,pC,Uqq
where the fourth line is generated from the monadic unit ηB : B ÑPB by CoalgprPyS,pηBqyT sq.
T. St. Clere Smithe 319
Remark 5.2. Note that we say ’semi-’(bi)category: this is because HiBiP does not have identities. This
is not problematic for our work here; and of course OrgT
P itself does have identities.
We are now in a position to sketch the ‘Laplace doctrine’ of dynamical semantics for approximate
inference. We first recall the notion of D-Bayesian inference game [12]:
Definition 5.3 (Bayesian inference) . Let D : KℓpPqpI,Xqˆ KℓpPqp1,XqÑ R be a measure of
divergence between states on X. Then a (simple) D-Bayesian inference game is a statistical game
pX,XqÑp Y,Yqwith fitness function φ : KℓpPqp1,XqˆKℓpPqpY,XqÑ R given by
φpπ,kq“ E
y„k‚c‚π
”
D
´
c1
πpyq,c:
πpyq
¯ı
where pc,c1qconstitutes the lens part of the game and c:
π is the exact inversion of c with respect to π.
Write DKL for the Kullback-Leibler divergence. Given a DKL-Bayesian inference game pγ,ρ,φq:
pX,XqÑp Y,Yqwhere X and Y are Euclidean spaces and whose forward and backward channels are
constrained to output Gaussian distributions, the Laplace doctrine returns a hierarchical bidirectional
Stat-system minimizing an upper bound on the divergence between each approximate posterior ρπ and
the ‘true’ posterior γ:
π, for any Gaussian state π : PX.
Remark 5.4. Note that the statistical properties of the system are not the focus of this paper: this doctrine
is merely being used to illustrate the coalgebraic framework.
The Laplace doctrine hinges on the following approximation, whose proof we defer to A.9.
Lemma 5.5 (Laplace approximation). Given a DKL-Bayesian inference game pγ,ρ,φq: pX,XqÑp Y,Yq
with forwards channel γ : X ÑPY constrained to emit Gaussian distributions, write µγpxq: R|Y|for the
mean of γpxqand Σγpxq: R|Y|ˆ|Y|for its covariance matrix, and assume that for all y : Y, the eigenvalues
of Σρπ pyqare small.
Then the loss φ : KℓpPqp1,XqˆKℓpPqpY,XqÑ R is approximately bounded from above by
φpπ,kq“ E
y„k‚γ‚π
”
D
´
ρπpyq,γ:
πpyq
¯ı
ď E
y„k‚γ‚π
”
D
´
ρπpyq,γ:
πpyq
¯
´log pγ‚πpyq
ı
“ E
y„k‚γ‚π
“
Fpyq
‰
« E
y„k‚γ‚π
“
FLpyq
‰
where F is called the free energyand where FL is its Laplace approximation,
FLpyq“ Epπ,γq
`
µρπ pyq,y
˘
´SX rρπpyqs (1)
“´log pγpy|µρπ pyqq´log pπpµρπ pyqq´SX rρπpyqs
where Sxrρπpyqs“ Ex„ρπ pyqr´log pρπ px|yqsis the Shannon entropy of ρπpyq, and pγ : Y ˆX Ñr0,1s,
pπ : X Ñr0,1s, and pρπ : X ˆY Ñr0,1sare density functions for γ, π, and ρπ respectively. The
approximation is valid when Σρπ satisfies
Σρπ pyq“
`
B2
x Epπ,γq
˘`
µρπ pyq,y
˘´1 . (2)
With this approximation in hand, and given such a statistical game pγ,ρ,φq, we will construct
a hierarchical bidirectional Stat-system Laplacepγ,ρ,φqperforming approximate stochastic gradient
320 Dynamical Systems via Generalized Polynomial Coalgebra
descent on the loss function, with respect to the statistical parameters of the inversionsρπ. We will work in
discrete time, T “N, although all of what follows can be done in continuous time, T “R`, by replacing
the discrete update steps by stochastic differential equations.
Since the entropy SX rρπpyqsdepends only on the variance Σρπ pyq, to optimize the mean µρπ pyqit
suffices to consider only the energy Epπ,γqpµρπ pyq,yq. We have
Epπ,γqpx,yq“´ log pγpy|xq´log pπpxq
“´1
2
A
εγpy,xq,Σγpxq´1εγpy,xq
E
´1
2
@
επpxq,Σπ´1επpxq
D
`log
b
p2πq|Y|detΣγpxq`log
b
p2πq|X|detΣπ
and a straightforward computation shows that
BxEpπ,γqpx,yq“´B xµγpxqT Σγpxq´1εγpy,xq`Σπ´1επpxq.
Let ηγpy,xq:“Σγpxq´1εγpy,xqand ηπpxq:“Σπ´1επpxq, so that
BxEpπ,γqpx,yq“´B xµγpxqT ηγpy,xq`ηπpxq. (3)
Note that Epπ,γq defines a function X ˆY ÑR. We will use the domain X ˆY of this function as the
state space of our system. To avoid ambiguity, we will writeÝ ÑX to indicate the space X when it is used
as an input in the ‘forwards’ direction, and Ð ÝY to indicate the space Y when it is used as an input in the
‘backwards’ direction.
Our system Laplacepγ,ρ,φqwill therefore have the type
pX ˆY, βo
1 : X ˆY ˆPÝ ÑX ÑÝ ÑY ,
βo
2 : X ˆY ˆPÝ ÑX ˆÐ ÝY ÑÐ ÝX ,
βu : X ˆY ˆPÝ ÑX ˆÐ ÝY ÑPpX ˆYqq.
We define βo
1 to be the projection of the second factor Y of the state space onto Y, and βo
2 to be the
projection of the first factor X onto X. The update map βu : X ˆY ˆPÝ ÑX ˆÐ ÝY ÑPpX ˆYqis then given
by composing the commutativity (or ‘double strength’) of the monad P, dst : PX ˆPY ÑPpX ˆYq,
after the following map (represented as a string diagram in E):
ρu
γÐ
PX
PY
Y
PX
X
Y
where p´qÐ:“µP ˝Pp´qdenotes Kleisli extension (for µP the multiplication of the monad P), so
that γÐ:“µP
Y ˝Ppγq: PX ÑPY.
In turn, the map ρu : X ˆPX ˆY ÑPX is defined by
ρu : X ˆPX ˆY ÑR|X|ˆR|X|ˆ|X|ãÑPX
px,π,yqÞÑ
´
x ´λBxEpπ,γqpx,yq,Σ˚
ρπ pyq
¯
T. St. Clere Smithe 321
where the inclusion into PX picks the Gaussian state with the given statistical parameters, where λ : R`
is some choice of “learning rate”, where Σ˚
ρπ pyqis as above and in Equation (2), and where BxEpπ,γqpx,yq
is as in Equation (3).
Observe that the factor ρu performs approximate stochastic gradient descent on the free energy: for a
given input y : Y, the mean trajectory of the system follows the update law µρ ÞÑµρ ´λBµρ Epπ,γqpµρ,yq,
and, when Σρpyq“Σ˚
ρpyq, we haveBµρ Epπ,γqpµρ,yq«Bµρ Fpyq. Note also that the update mapρu depends
on a prior, just as the inversion map ρ of the lens pγ,ρqdoes.
A full treatment of the Laplace doctrine will appear in a forthcoming sequeal to the author’s [12].
6 Conclusions; current and future work
In this work we have sketched a framework for treating open dynamical systems of a general nature
as coalgebras for certain polynomial functors or—in the case of systems with side-effects such as
randomness—certain generalizations thereof. Although we have attempted to give a wide overview of the
applicability of these structures, with a particular focus on the adaptive systems of primary interest to the
author, we are aware that we have barely scratched the surface of their use and relationships. Here, we
briefly list some avenues of current and future work.
Our current principal focus is on exploring the connections between these structures and other
compositional treatments of dynamical systems. In particular, relating our categories to the respective
frameworks of Myers [14], Libkind [15] and Baez and colleagues (e.g., [16]). Evidently, the structures
presented here are most closely in line with the approaches explored by Spivak [8, 17], and are particularly
interested in generalizing his topos-theoretic perspective: given that the category of discrete-time
deterministic systems over a polynomial p forms a topos, we suspect that so too does CoalgTppq. We are
also seeking the connections between these putative topoi and the topoi of behaviour types [17] as well
as with coalgebraic logic [18], particularly in its modal forms. We hope that we can further develop the
theory of PolyM to support some of these methods, too.
Finally, there are a number of ways in which this framework should be made more elegant. In particular,
we hope to cast a number of properties instead as structures, including the comonoid-homomorphism
property of our main definition, and the explicit definitions of random and bundle dynamical systems.
With particular respect to the latter, we expect there to be an inductive story of nested parameterization,
which appears to the author to have an opetopic shape closely connected to the Para construction [19].
7 References
[1] F. W. Lawvere and S. H. Schnauel.Conceptual Mathematics : A First Introduction to Categories.
Cambridge, UK New York: Cambridge University Press, 2009. ISBN : 978-0-511-80419-9. DOI :
10.1017/CBO9780511804199.
[2] David I Spivak and Nelson Niu. Polynomial Functors: A General Theory of Interaction. (In press),
2021. URL : https://raw.githubusercontent.com/ToposInstitute/poly/main/Book-Poly.pdf.
[3] David I. Spivak. A Reference for Categorical Structures on Poly. 02/01/2022. arXiv: 2202.00534.
preprint.
[4] Danel Ahman and Tarmo Uustalu. “Directed Containers as Categories”. In: EPTCS 207, 2016, pp.
89-98 (04/05/2016). DOI : 10.4204/EPTCS.207.5. arXiv: 1604.01187.
322 Dynamical Systems via Generalized Polynomial Coalgebra
[5] David I. Spivak.Poly: An Abundant Categorical Setting for Mode-Dependent Dynamics. 05/05/2020.
arXiv: 2005.01894. preprint.
[6] Ludwig Arnold. Random Dynamical Systems. Springer Berlin Heidelberg, 1998. 612 pp. ISBN :
978-3-540-63758-5. DOI : 10.1007/978-3-662-12878-7. URL : https://doi.org/10.1007/978-3-662-
12878-7.
[7] Tobias Fritz. “A Synthetic Approach to Markov Kernels, Conditional Independence and Theorems
on Sufficient Statistics”. In: Advances in Mathematics370.107239 (08/19/2019). DOI : 10.1016/j.
aim.2020.107239. arXiv: 1908.07021v3.
[8] David I. Spivak. “Learners’ Languages”. In: Electronic Proceedings in Theoretical Computer
Science 372 (03/01/2021), pp. 14–28. DOI : 10.4204/EPTCS.372.2. arXiv: 2103.01189.
[9] Kenta Cho and Bart Jacobs. “Disintegration and Bayesian Inversion via String Diagrams”. In:Math.
Struct. Comp. Sci. 29 (2019) 938-971(08/29/2017). DOI : 10.1017/S0960129518000488. arXiv:
1709.00322v3.
[10] K. Friston. “A Theory of Cortical Responses”. In: Philos. Trans. R. Soc. Lond., B, Biol. Sci.
360.1456 (04/2005), pp. 815–836. DOI : 10.1098/rstb.2005.1622. pmid: 15937014.
[11] Christopher L Buckley et al. “The Free Energy Principle for Action and Perception: A Mathematical
Review”. In: Journal of Mathematical Psychology81 (05/24/2017), pp. 55–79. DOI : 10.1016/j.jmp.
2017.09.004. arXiv: 1705.09156v1.
[12] Toby St Clere Smithe. Compositional Active Inference I: Bayesian Lenses. Statistical Games.
09/09/2021. arXiv: 2109.04461. preprint.
[13] Toby St Clere Smithe. Bayesian Updates Compose Optically. 05/31/2020. arXiv: 2006.01631.
preprint.
[14] David Jaz Myers. “Double Categories of Open Dynamical Systems (Extended Abstract)”. In:
Electronic Proceedings in Theoretical Computer Science333 (02/08/2021), pp. 154–167. ISSN :
2075-2180. DOI : 10.4204/EPTCS.333.11. arXiv: 2005.05956. URL : http://arxiv.org/abs/2005.05956
(visited on 11/16/2022).
[15] Sophie Libkind. An Algebra of Resource Sharing Machines. 07/28/2020. arXiv: 2007.14442.
preprint.
[16] John C. Baez, Kenny Courser, and Christina Vasilakopoulou. “Structured versus Decorated
Cospans”. In: Compositionality 4.3 (09/01/2022). DOI : 10.32408/compositionality-4-3. arXiv:
2101.09363.
[17] Patrick Schultz, David I Spivak, and Christina Vasilakopoulou. “Dynamical Systems and Sheaves”.
In: Applied Categorical Structures28 (2020), pp. 1–57. DOI : 10.1007/s10485-019-09565-x. arXiv:
1609.08086.
[18] Bart Jacobs. Introduction to Coalgebra. V ol. 59. Cambridge University Press, 2017.ISBN : 978-
1-107-17789-5. URL : https://www.cambridge.org/gb/academic/subjects/mathematics/logic-
categories-and-sets/introduction-coalgebra-towards-mathematics-states-and-observation.
[19] Matteo Capucci, Bruno Gavranovi´c, and Toby St. Clere Smithe. “Parameterized Categories and
Categories by Proxy”. In: Category Theory 2021. Category Theory. Genoa, 2021. URL : https:
//www.youtube.com/watch?v=lYs6Bs6JK9Q.
T. St. Clere Smithe 323
A Extra proofs and structures
Proposition A.1. CoalgTppq extends to a polynomially-indexed category, CoalgT : PolyE ÑCat.
Suppose ϕ : p Ñq is a morphism of polynomials. We define a corresponding functor CoalgTpϕq:
CoalgTppqÑ CoalgTpqqas follows. Suppose pX,ϑo,ϑuq: CoalgTppqis an object (dynamical system)
in CoalgTppq. Then CoalgTpϕqpX,ϑo,ϑuqis defined as the triple pX,ϕ1 ˝ϑo,ϑu ˝ϑo˚ϕ#q: CoalgTpqq,
where the two maps are explicitly the following composites:
TˆX ϑo
ÝÑpp1q
ϕ1
Ý Ñqp1q,
ÿ
t:T
ÿ
x:X
qrϕ1 ˝ϑopt,xqs
ϑo˚ϕ#
Ý ÝÝÝ Ñ
ÿ
t:T
ÿ
x:X
prϑopt,xqs ϑu
ÝÑX .
On morphisms, CoalgTpϕqpf q: CoalgTpϕqpX,ϑo,ϑuqÑ CoalgTpϕqpY,ψo,ψuqis given by the same
underlying map f : X ÑY of state spaces.
Proof. We need to check that CoalgTpϕqpX,ϑo,ϑuqsatisfies the flow conditions of Definition 2.1, that
CoalgTpϕqpf qsatisfies the naturality condition of Proposition 2.3, and that CoalgT is functorial with
respect to polynomials. We begin with the flow condition. Given a section τ : qp1qÑ ř
j:qp1q
qrjsof q, we
require the closures CoalgTpϕqpϑqτ : TˆX ÑX given by
ÿ
t:T
X
ϑop´q˚τ
ÝÝÝÝÝÑ
ÿ
t:T
ÿ
x:X
qrϕ1 ˝ϑopt,xqs
ϑo˚ϕ#
Ý ÝÝÝ Ñ
ÿ
t:T
ÿ
x:X
prϑopt,xqs ϑu
ÝÑX
to satisfy CoalgTpϕqpϑqτp0q“idX and CoalgTpϕqpϑqτps`tq“CoalgTpϕqpϑqτpsq˝CoalgTpϕqpϑqτptq.
Note that the following diagram commutes, by the definition of ϕ#,
ř
i:pp1q
pris ř
i:pp1q
qrϕ1piqs pp1q
pp1q pp1q
ϕ˚
1 q
ϕ˚
1 τϕ#
p
so that ϕ# ˝ϕ˚
1 τ is a section of p. Therefore, letting σ :“ϕ# ˝ϕ˚
1 τ, for CoalgTpϕqpϑqτ to satisfy the
flow condition for τ reduces to ϑσ satisfying the flow condition for σ. But this is given ex hypothesiby
Definition 2.1, for any such section σ, so CoalgTpϕqpϑqτ satisfies the flow condition for τ. And since τ
was any section, we see that CoalgTpϕqpϑqsatisfies the flow condition generally.
The proof that CoalgTpϕqpf qsatisfies the naturality condition of Proposition 2.3 proceeds similarly.
Supposing again that τ is any section of q, we require the following diagram to commute for any time
t : T:
X ř
x:X
qrϕ1 ˝ϑopt,xqs ř
x:X
prϑopt,xqs X
Y ř
y:Y
qrϕ1 ˝ψopt,xqs ř
y:Y
prψopt,xqs Y
f f
ϑoptq˚ϕ˚
1 τ ϑoptq˚ϕ# ϑuptq
ψoptq˚ϕ˚
1 τ ϑoptq˚ϕ# ψuptq
324 Dynamical Systems via Generalized Polynomial Coalgebra
Again letting σ :“ϕ# ˝ϕ˚
1 τ, we see that this diagram reduces exactly to the diagram in Proposition 2.3
by the functoriality of pullback, and since f makes that diagram commute, it must also make this diagram
commute.
Finally, to show that CoalgT is functorial with respect to polynomials amounts to checking that
composition and pullback are functorial; but this is a basic result of category theory.
Proposition A.2. When T “N, the category CoalgNppqof open dynamical systems over p with time N
is equivalent to the topos p-Coalg of p-coalgebras [8].
Proof. p-Coalg has as objects pairs pS,βqwhere S : E is an object in E, β : S Ñp ŸS is a morphism
of polynomials (interpreting S as the constant copresheaf on the set S), and Ÿdenotes the composition
monoidal product in PolyE (i.e., composing the corresponding copresheaves E ÑE). A straightforward
computation shows that, interpreted as an object in E, p ŸS corresponds to ř
i:pp1qS pris. By the universal
property of the dependent sum, a morphism β : S Ñř
i:pp1qS pris therefore corresponds bijectively to a
pair of maps βo : S Ñpp1qand βu : ř
s:S prβopsqsÑ X. By Proposition 2.6, such a pair is equivalently
a discrete-time open dynamical system over p with state space S: that is, the objects of p-Coalg are in
bijection with those of CoalgNppq.
Next, we show that the hom-sets p-Coalg
`
pS,βq,pS1,β1q
˘
and CoalgNppq
`
pS,βo,βuq,pS1,β1o,β1uq
˘
are in bijection. A morphism f : pS,βqÑp S1,β1qof p-coalgebras is a morphism f : S ÑS1between the
state spaces such that β1˝f “pp Ÿf q˝β. Unpacking this, we find that this means the following diagram
in E must commute for any section σ of p:
S ř
s:S
prβopsqs ř
i:pp1q
pris pp1q
S pp1q
S1 pp1q
S1 ř
s1:S1
prβ1ops1qs ř
i:pp1q
pris pp1q
f f
βo
{
β1o
{
βu
β1u σ
σ
Pulling the arbitrary section σ back along the ‘output’ maps βo and β1o means that the following
T. St. Clere Smithe 325
commutes:
S ř
s:S
prβopsqs S
S
S1
S1 ř
s1:S1
prβ1ops1qs S1
f f
βu
β1u
βo˚σ
β1o˚σ
Forgetting the vertical projections out of the pullbacks gives:
S ř
s:S
prβopsqs S
S
S1
S1 ř
s1:S1
prβ1ops1qs S1
f
βu
β1u
βo˚σ
β1o˚σ
f
Finally, by collapsing the identity maps and reflecting the diagram horizontally, we obtain
S ř
s:S
prβopsqs S
S1 ř
s1:S1
prβ1ops1qs S1
f f
βo˚σ
β1o˚σ
βu
β1u
which we recognize from Proposition 2.3 as the defining characteristic of a morphism in CoalgNppq.
Finally, we note that each of these steps is bijective, and so we have the desired bijection of hom-sets.
326 Dynamical Systems via Generalized Polynomial Coalgebra
Definition A.3 (Category of open random dynamical systems over p). Writing ϑ :“pπX ,ϑo,ϑuqand
ψ :“pπY ,ψo,ψuq, a morphism f : ϑ Ñψ is a map f : X ÑY in E making the following diagram
commute for all times t : T and sections σ of p:
X ř
x:X
prϑopt,xqs X
Ω Ω
Y ř
y:Y
prψopt,yqs Y
πX πX
θptq
ϑoptq˚σ ϑuptq
ψoptq˚σ ψuptq
πY πY
f f
Identities are given by the identity maps on state-spaces. Composition is given by pasting of diagrams.
Proposition A.4 (Opindexed category of open random dynamical systems over polynomials). By the
universal property of the product ˆin Cat, it suffices to define the actions of RDynT separately on
morphisms of polynomials and on morphisms of closed measure-preserving systems.
Suppose therefore that ϕ : p Ñq is a morphism of polynomials. Then, for each measure-preserving
system pθ,βq: CatpBT,EqP, we define the functor RDynTpϕ,θq: RDynTpp,θqÑ RDynTpq,θqas
follows. Let ϑ :“pπX : X ÑΩ,ϑo,ϑuq: RDynTpp,θqbe an object (open random dynamical system) in
RDynTpp,θq. Then RDynTpϕ,θqpϑqis defined as the triple pπX ,ϕ1 ˝ϑo,ϑu ˝ϕo˚ϕ#q: RDynTpq,θq,
where the two maps are explicitly the following composites:
TˆX ϑo
ÝÑpp1q
ϕ1
Ý Ñqp1q,
ÿ
t:T
ÿ
x:X
qrϕ1 ˝ϑopt,xqs
ϑo˚ϕ#
Ý ÝÝÝ Ñ
ÿ
t:T
ÿ
x:X
prϑopt,xqs ϑu
ÝÑX .
On morphisms f : pπX : X ÑΩ,ϑo,ϑuqÑp πY : Y ÑΩ,ψo,ψuq, the image
RDynTpϕ,θqpf q: RDynTpϕ,θqpπX ,ϑo,ϑuqÑ RDynTpϕ,θqpπY ,ψo,ψuq
is given by the same underlying map f : X ÑY of state spaces.
Next, suppose that φ : pθ,βqÑp θ1,β1qis a morphism of closed measure-preserving dynamical
systems, and let Ω1:“θ1p˚qbe the state space of the system θ1. By Proposition 2.22, the morphism φ
corresponds to a map φ : Ω ÑΩ1 on the state spaces that preserves both flow and measure. Therefore,
for each polynomial p : PolyE , we define the functor RDynTpp,φq: RDynTpp,θqÑ RDynTpp,θ1qby
post-composition. That is, suppose given open random dynamical systems and morphisms over pp,θqas
T. St. Clere Smithe 327
in the diagram of Proposition 2.26. Then RDynTpp,φqreturns the following diagram:
X ř
x:X
prϑopt,xqs X
Ω1 Ω1
Y ř
y:Y
prψopt,yqs Y
θ1ptq
ϑoptq˚σ ϑuptq
ψoptq˚σ ψuptq
f f
φ˝πY
φ˝πX
φ˝πY
φ˝πX
That is, RDynTpp,φqpϑq:“pφ ˝πX ,ϑo,ϑuqand RDynTpp,φqpf qis given by the same underlying map
f : X ÑY on state spaces.
Proof. We need to check: the naturality condition of Definition 2.25 for both RDynTpϕ,θqpϑqand
RDynTpp,φqpϑq; functoriality of RDynTpϕ,θqand RDynTpp,φq; and (pseudo)functoriality of RDynT
with respect to both morphisms of polynomials and of closed measure-preserving systems.
We begin by checking that the conditions of Definition 2.25 are satisfied by the objects
RDynTpϕ,θqpπX ,ϑo,ϑuq: RDynTpq,θq
and morphisms
RDynTpϕ,θqpf q: RDynTpϕ,θqpπX ,ϑo,ϑuqÑ RDynTpϕ,θqpπY ,ψo,ψuq
in the image of RDynTpϕ,θq. Given a section τ : qp1qÑ ř
j:qp1q
qrjsof q, we need to check that the closure
RDynTpϕ,θqpϑqτ forms a closed random dynamical system in CatpBT,Eq{θ. That is to say, for all t : T
and sections τ, we need to check that the following naturality square commutes:
X ř
x:X
qrϕ1 ˝ϑopt,xqs ř
x:X
prϑopt,xqs X
Ω Ω
ϑoptq˚τ ϑoptq˚ϕ# ϑu
πX
θptq
πX
As before, we find that ϕ# ˝ϕ˚
1 τ is a section of p, so that commutativity of the diagram above reduces to
commutativity of the diagram in Definition 2.25. Similarly, given a morphism f : pπX ,ϑo,ϑuqÑ
pπY ,ψo,ψuq, we need to check that the diagram in Proposition 2.26 induced for RDynTpϕ,θqpf q
commutes for all times t : T and sections τ of q. But given such a section τ, the diagram for
RDynTpϕ,θqpf qreduces to that for f and the section ϕ# ˝ϕ˚
1 τ of p, which commutes ex hypothesi;
and functoriality of RDynTpϕ,θqfollows immediately.
328 Dynamical Systems via Generalized Polynomial Coalgebra
Next, we check that the conditions of Definition 2.25 are satisfied in the image of RDynTpp,φq. It is
clear by the definition of the action of RDynTpp,φqthat the condition that the diagram in Proposition A.1
commutes is satisfied, from which it follows by pasting that RDynTpp,φqis functorial. We therefore just
have to check the induced diagram in Definition 2.25 commutes. Consider the following diagram:
X ř
x:X
prϑopt,xqs X
Ω Ω
Ω1 Ω1
πX
ϑoptq˚σ ϑuptq
πX
θptq
φ φ
θ1ptq
The top square commutes ex hypothesi, the bottom square commutes by the definition of morphism of
closed measure-preserving dynamical systems (Proposition 2.22), and the outer square is the induced
diagram we need to check, which therefore commutes by the pasting of commuting squares.
Finally, we check that RDynT is functorial with respect to morphisms of polynomials and morphisms
of closed measure-preserving dynamical systems. These reduce to checking that pullback and composition
are functorial, which we again leave to the dedicated reader.
Definition A.5 (Open bundle dynamical system) . Let p,b : PolyE be polynomials in E, and let θ :“
pθp˚q,θo,θuq: CoalgT
idpbqbe an open dynamical system over b. An open bundle dynamical system over
pp,b,θqis a pair pπϑθ ,ϑqwhere ϑ :“pϑp˚q,ϑo,ϑuq: CoalgT
idppqis an open dynamical system over p
and πϑθ : ϑp˚qÑ θp˚qis a bundle in E, such that, for all time t : T and sections σ of p and ς of b, the
following diagrams commute, thereby inducing a bundle of closed dynamical systems πσς
ϑθ : ϑσ Ñθς in
CatpBT,Eq:
ϑp˚q ř
w:ϑp˚q
prϑopt,wqs ϑp˚q
θp˚q ř
x:θp˚q
brθopt,xqs θp˚q
πϑθ πϑθ
ϑoptq˚σ ϑuptq
θoptq˚ς θuptq
Proposition A.6 (Category of open bundle dynamical systems overpp,bq). Let p,b : PolyE be polynomials
in E, and letθ :“pθp˚q,θo,θuq: CoalgT
idpbqbe an open dynamical system overb. Open bundle dynamical
systems over pp,b,θqform the objects of a category BunDynTpp,b,θq. Morphisms f : pπϑθ ,ϑqÑ
pπρθ ,ρqare maps f : ϑp˚qÑ ρp˚qin E making the following diagram commute for all times t : T and
T. St. Clere Smithe 329
sections σ of p and ς of b:
ϑp˚q ř
w:ϑp˚q
prϑopt,wqs ϑp˚q
θp˚q ř
x:θp˚q
brθopt,xqs θp˚q
ρp˚q ř
y:ρp˚q
prρopt,yqs ρp˚q
ϑoptq˚σ ϑuptq
θoptq˚ς θuptq
πϑθ
πρθ
πϑθ
πρθ
ρoptq˚σ ρuptq
f f
That is, f is a map on the state spaces that induces a morphismpπϑθ ,ϑσ qÑp πρθ ,ρσ qin CatpBT,Eq{θς
of bundles of the closures. Identity morphisms are the corresponding identity maps, and composition is by
pasting.
Proposition A.7 (Opindexed category of open bundle dynamical systems). Varying the polynomials p
in BunDynTpp,b,θqinduces an opindexed category BunDynTp´,b,θq: PolyE ÑCat. On polynomials
p, it returns the categories BunDynTpp,b,θq of Proposition A.6. On morphisms ϕ : p Ñq of
polynomials, define the functors BunDynTpϕ,b,θq: BunDynTpp,b,θqÑ BunDynTpq,b,θq as in
Proposition 2.27. That is, suppose pπϑθ ,ϑq: BunDynTpp,b,θqis object (open bundle dynamical system)
in BunDynTpp,b,θq, where ϑ :“pϑp˚q,ϑo,ϑuq. Then its image BunDynTpϕ,b,θqpπϑθ ,ϑqis defined
as the pair pπϑθ ,ϕϑ q, where ϕϑ :“pϑp˚q,φ1 ˝ϑo,ϑu ˝ϑo˚ϕ#q. On morphisms f : pπϑθ ,ϑqÑp πρθ ,ρq,
BunDynTpϕ,b,θqpf qis again given by the same underlying map f : ϑp˚qÑ ρp˚qof state spaces.
Proof. The proof amounts to the proof for Proposition 2.27 that RDynTpϕ,θqconstitutes an indexed
category, except that the closed base dynamical system θ of that Proposition is here replaced, for any
section ς of b, by the closure θς by ς of the open dynamical system θ : CoalgT
idpbqof the present
Proposition. The proof goes through accordingly, since the relevant diagrams are guaranteed to commute
for any such ς by the conditions in Definition A.5 and Proposition A.6.
Proposition A.8 (Doubly-opindexed category of open bundle dynamical systems) . Letting the base
system θ also vary induces a doubly-opindexed categoryBunDynTp´,b,“q: PolyE ˆCoalgT
idpbqÑ Cat.
Given a polynomial p : PolyE and morphism φ : θ Ñρ in CoalgT
idpbq, the functor BunDynTpp,b,φq:
BunDynTpp,b,θqÑ BunDynTpp,b,ρqis defined by post-composition, as in Proposition 2.27 for the
action of RDynT on morphisms of the base systems there. More explicitly, such a morphismφ corresponds
to a map φ : θp˚qÑ ρp˚q of state spaces in E. Given an object pπϑθ ,ϑq of BunDynTpp,b,θq,
we define BunDynTpp,b,φqpπϑθ ,ϑq:“pφ ˝πϑθ ,ϑq. Given a morphism f : pπϑθ ,ϑqÑp πρθ ,ρqin
BunDynTpp,b,θq, its image BunDynTpp,b,φqpf q: pφ ˝πϑθ ,ϑqÑp φ ˝πρθ ,ρqis given by the same
underlying map f : ϑp˚qÑ ρp˚qof state spaces.
Proof. As for Proposition A.7, the proof here amounts to the proof for Proposition 2.27 thatRDynTpp,φq
constitutes an indexed category, except again the closed systems are replaced by (the appropriate closures
of) open ones, and the measure-preserving structure is forgotten.
330 Dynamical Systems via Generalized Polynomial Coalgebra
Proof A.9 (Proof of the Laplace approximation). First note that the KL divergence is bounded from above
by the free energy since log pγ‚πpyqis always negative.
Next, we can write the density functions as:
log pγpy|xq“ 1
2
@
εγ,Σγ´1εγ
D
´log
b
p2πq|Y|detΣγ
log pρπ px|yq“ 1
2
@
ερπ ,Σρπ
´1ερπ
D
´log
b
p2πq|X|detΣρπ
log pπpxq“ 1
2
@
επ,Σπ´1επ
D
´log
b
p2πq|X|detΣπ
where for clarity we have omitted the dependence of Σγ on x and Σρπ on y, and where
εγ : Y ˆX ÑY : py,xqÞÑ y ´µγpxq,
ερπ : X ˆY ÑX : px,yqÞÑ x ´µρπ pyq,
επ : X ˆ1 ÑX : px,˚qÞÑ x ´µπ .
Then, note that we can write the free energy Fpyqas the difference between expected energy and entropy:
Fpyq“ E
x„ρπ pyq
„
log pρπ px|yq
pγpy|xq¨pπpxq
ȷ
“ E
x„ρπ pyq
“
´log pγpy|xq´log pπpxq
‰
´SX rρπpyqs
“ E
x„ρπ pyq
“
Epπ,γqpx,yq
‰
´SX rρπpyqs
Next, since the eigenvalues of Σρπ pyqare small for all y : Y, we can approximate the expected energy by
its second-order Taylor expansion around the mean µρπ pyq:
Fpyq« Epπ,γqpµρπ pyq,yq`1
2
@
ερπ
`
µρπ pyq,y
˘
,
`
B2
x Epπ,γq
˘`
µρπ pyq,y
˘
¨ερπ
`
µρπ pyq,y
˘D
´SX
“
ρπpyq
‰
.
where
`
B2
x Epπ,γq
˘`
µρπ pyq,y
˘
is the Hessian of Epπ,γqwith respect to x evaluated at pµρπ pyq,yq.
Note that
@
ερπ
`
µρπ pyq,y
˘
,
`
B2
x Epπ,γq
˘`
µρπ pyq,y
˘
¨ερπ
`
µρπ pyq,y
˘D
“tr
“`
B2
x Epπ,γq
˘`
µρπ pyq,y
˘
Σρπ pyq
‰
, (4)
that the entropy of a Gaussian measure depends only on its covariance,
SX
“
ρπpyq
‰
“1
2 logdet
`
2π eΣρπ pyq
˘
,
and that the energy Epπ,γqpµρπ pyq,yqdoes not depend on Σρπ pyq. We can therefore write down directly the
covariance Σ˚
ρπ pyqminimizing Fpyqas a function of y. We have
BΣρπ Fpyq« 1
2
`
B2
x Epπ,γq
˘`
µρπ pyq,y
˘
`1
2Σρπ
´1 .
Setting BΣρπ Fpyq“ 0, we find the optimum
Σ˚
ρπ pyq“
`
B2
x Epπ,γq
˘`
µρπ pyq,y
˘´1 .
Finally, on substituting Σ˚
ρπ pyqin equation (4), we obtain the desired expression
Fpyq« Epπ,γq
`
µρπ pyq,y
˘
´SX rρπpyqs“: FLpyq.