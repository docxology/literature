An AIoT-enabled Autonomous Dementia
Monitoring System
Jinyang Li and Xingyu Wu
Dept. of Electrical and Electronic Engineering
University College London
London, United Kingdom
Email: jinyang.li.21@ucl.ac.uk and x.wu.20@ucl.ac.uk
Abstract—An autonomous Artiﬁcial Internet of Things (AIoT)
system for elderly dementia patients’ monitoring in a smart home
is presented. The system mainly implements two functions based
on the activity inference of the sensor data, which are real-time
abnormal activity monitoring and trend prediction of disease
related activities. Speciﬁcally, CASAS [1] dataset is employed
to train a Random Forest (RF) model for activity inference.
Then, another RF model trained by the output data of activity
inference is used for abnormal activity monitoring. Particularly,
RF is chosen for these tasks because of its balanced trade-offs
between accuracy, time efﬁciency, ﬂexibility, and interpretability.
Moreover, Long Short-Term Memory (LSTM) is utilised to fore-
cast the disease-related activity trend of a patient. Consequently,
the accuracy of two RF classiﬁers designed for activity inference
and abnormal activity detection is greater than 99% and 94%,
respectively. Furthermore, using the duration of a patient’s sleep
as an example, the LSTM model achieves accurate and evident
future trends prediction.
Index Terms—AIoT, activity inference, activity monitoring,
trend prediction, CASAS, Random Forest, LSTM
I. I NTRODUCTION
Dementia is employed as a chronic health condition to be
monitored in our AIoT system. Generally, it is a prevalent
occurrence in older folks [2] [3]. There is a lot of concern
about the well-being of the elderly in many regions of the
world nowadays. Therefore, caregivers and healthcare centers
can beneﬁt from remote monitoring of elderly folks’ health and
well-being. [4] conducted interviews with dementia patients to
investigate their behaviors during ﬂare-ups and exacerbation.
According to the interview, memory loss, abnormal noise
during sleep, insomnia and night wandering are adopted as
symptoms to be monitored in this work. And these symptoms
could be embodied in the daily activities such as sleep, work,
personal hygiene, etc [5] [6] [7].
To monitor dementia patients’ health status intelligently
from their daily activities, the AIoT-enabled autonomous sys-
tem is deployed, achieving the ultimate goal of real-time
abnormal activity monitoring and trend prediction of disease-
related activities. Speciﬁcally, two RF models are employed
for both tasks with high interpretability.
To complete this end-to-end AIoT system, as seen in Fig-
ure 1, the edge system, connectivity and cloud must all be
considered. The edge system needs to gather patient activity
The code of this work is publicly available here: Github Link
data via sensors and send various types of reminders to
roommates or medical teams via actuators. Meanwhile, some
connection protocols (e.g., MQTT) are employed to ensure
stable connections. Particularly, NodeRED on IBM is utilized
to monitor the disease’s progression and provide an interface,
and this work will focus on the ”Python within Watson Studio”
part on the cloud, which involves the mechanisms to detect and
anticipate the disease-related activity.
MKR 1010s
MQTT Clients
Sensors
Actuators
Python within 
Watson Studio
Db2 dataset
MQTT Broker
NodeRED
Deterioration 
alarm types
MQTT
Edge
Cloud
Return alarm 
types
Activity inference
(based on trained RF model)
Classify normal/abnormal activities
(based on trained RL model)
Determine deterioration alarm type
(based on algorithms)
Input: original sensor data
(without activity labels)
Identify abnormal 
activities
Train Random Forest(RF) model
→
infer the activity types
Train Random Forest(RF) model
→
judge activity normal or abnormal
EDA and Data analysis
→
patterns and trends
Algorithms combine several 
activities for detecting different 
deterioration symptoms
For labeled historical dataset:
For future original sensor data:
Python within Watson Studio:
2. Introduction
IoT Stack:
Fig. 1. The scheme of the AIoT System.
II. M ETHODOLOGY
A. Scheme Overview
As Figure 2 shows, the main functions of the system
are real-time abnormal activity inference, and activity trends
prediction for the dementia patient, which needs the patient’s
activity data as the input. The activity data is produced by
activity inference on the raw data uploaded from the sensors
located in the patient’s living environment.
To assess our approach, the CASAS dataset, collected in a
smart home environment [1], is utilized in this project, which
contains the recordings uploaded from several sensors that
were deployed in a ﬂat with two residents, for a period of
about 3 months. Speciﬁcally, the locations of the sensors are
shown in Figure 3. The sensors deployed can be categorized
as motion sensors, kitchen item sensors, door sensors, light
arXiv:2207.00804v1  [cs.LG]  2 Jul 2022
IoTSensorData
ActivityInference
Real-timeAbnormalActivityInferenceActivityTrendsPrediction
Patient’sActivityData
Fig. 2. Scheme overview of the AIoT-enabled Dementia Monitoring System.
sensors, AD1-A for burner sensors, AD1-B for hot water
sensors, and AD1-C for cold water sensors. They monitor the
daily activities of the two residents, such as R1’s bed to toilet,
R1’s personal hygiene, meal preparation, etc.
Fig. 3. Floor plan of the smart home related to CASAS dataset.
B. Sensor-based Activity Inference
To infer the patient’s real-time activities from the corre-
sponding streaming sensor data, an ML-based activity infer-
ence approach was designed containing the steps of sensor
data windowing, weighting, data transformation and activ-
ity classiﬁcation .
1) Sensor Data Windowing: Consideration of preceding
sensor events windowing is a straightforward method for
providing context to determine what activity a single sensor
event belongs to. The windows were set up with a sensor-
based approach where data is partitioned into equal-number-
of-sensor-events windows [8].
2) Sensor Weighting: The goal of sensor data windowing
is to provide effective context information for the last sensor
event in the window. However, there may exist disruptive
sensor events that are labelled with other activities than that of
the last sensor event in the window. To deal with this problem,
a sensor weighting matrix is built with reference to the sensor
dependency weighting scheme proposed by Yala et al. [9]
based on a mutual information measure between the sensors.
Speciﬁcally, the mutual information between two sensors Si
and Sj is calculated by their frequency of occurrence in a
sequence of sensor events representing a single activity as the
following equation:
MI (Si, Sj) = 1
|Q|
|Q|∑
k=1
∂(Si, Sj) (1)
where ∂(Si,Sj) = 1if sensors Si and Sj are both activated
during the sequence of the sensor events in an activity. And
Q represents the total number of dataset activities.
3) Data Transformation: On the basis of sensor data
windowing and sensor weighting, effective information from
multiple sensor events in each window containing the weighted
occurrence times of each sensor, the end time and duration of
the window, and the last two sensor IDs will be derived and
the window will be transformed into a single aggregated data
item.
4) Activity Inference using Random Forest: Machine Learn-
ing (ML) could generate a learning-based intelligent model
that learns from the labelled training dataset output by the
previous steps to determine the activity type, which gener-
ally has better overall performance compared with rule-based
methods [10]. Among various learning-based ML models,
we chose Random Forest (RF) [11] because of its high
accuracy, ﬂexibility (suitable for different data distributions),
interpretability, and low running time complexitiy . RF is
made up of a couple of decision trees (DTs) [12] as the basic
predictors. DT is a heuristic ML technique that recursively and
greedily assesses the features of the input data. Speciﬁcally,
a decision tree splits its branch by testing for one of the
input data’s properties. And every step conducts testing based
on the divisions established in the preceding steps. Within a
tree, the divide-and-conquer approach divides the entire input
dataset into several portions that must be identiﬁed from root
to leaves. Each path from the root to a leaf node corresponds
to classifying a portion of the dataset. The core algorithm DT
uses is Gini Index. Assume the proportion of samples that
belong to the k-th class in a dataset is pk(k = 1,2,...,m ).
Then, we can measure the purity of dataset D with the Gini
value as:
Gini(D) =
m∑
k=1
∑
k′̸=k
pkpk′ (2)
RF, as illustrated in Figure 4, is a decision tree ensemble
model proposed to solve the problem of sticking in the local
optimal of a single tree. It trains a number of decision trees
using the method of randomly selecting subsets of the attribute
set based on the bagging strategy. In RF, bagging is the process
of randomly selecting multiple different subsets of the training
set and ﬁtting several decision trees individually. The results
are then obtained by major voting all trees. Generally, RF
can increase classiﬁcation accuracy and decrease over-ﬁtting
compared with a single decision tree.
5. Activity Inference Based on Sensor Dataset—Random Forest5.2RandomForestmodelforactivityinference•A decision tree generally contains a root node, a number of internal nodes, and leaf nodes. Each leaf nodecorresponds to a class determined. And each internal node corresponds to testing on one attribute.Thebranching ofadecisiontreecanbedonebycalculatingGiniIndex:
•Randomforestisimplementedbyusingensemble technique tocombine multipledecisiontreemodels for thesame task to get a better and more comprehensive model,avoidingover-fitting.•RFhastheadvantagesofhighaccuracyandgoodinterpretability.Itsquantitative decisionprocesscanbeacquired.
Age < 30
Male?
Yes No
No
Does the person a big fan of eletronic game?
Figure 1. A decision tree example
True False
True False Original Dataset
D1
D2
Dn
Datasets. . .
Trees
. . .Single Strong Classifier
Major votingRandom sampling with return
Random selection of attribute
Figure 2. Random Forest Overview
Fig. 4. The architecture of Random Forest.
C. Real-time Abnormal Activity Recognition
As Figure 2 shows, the patient’s activity data can be ac-
quired with the previous processes. Moreover, a set of related
statistical data concerning the start and end time, time span,
and happening sequence of activity on a daily basis can be
acquired. Taking this extracted activity statistical data as input,
a classiﬁer that determines if such a data item is abnormal can
be built as a necessary part of functionalities for the goal of
detecting the dementia status.
To train an ML model in a supervised way, the activity
statistical data items are supposed to label with “normal”
or “abnormal”. Z-score, a popular statistical method for ab-
normal data detection, is mainly utilized here to determine
the abnormal quantitative attributes of frequency and time
span. Furthermore, the abnormal start time and end time are
determined by setting an abnormal time range for each activity
according to Exploratory Data Analysis (EDA).
After labelling the activity dataset, an RF classiﬁer for
abnormal activity is developed and evaluated based on its
balanced trade-offs.
D. Activity Trends Prediction
As an important functionality that reminds the risk of
deterioration without future sensor data input, a time-series
prediction model needs to be built based on historical trends
of activity data.
Among the various AI models for time-series prediction,
Long Short-Term Memory (LSTM) [13] has been evaluated as
being able to deliver a general high performance in different
applications [14] [15], which is employed in this task.
LSTM uses gate control to keep the useful past states and
abandon the useless ones. As Figure 5 shows, in an LSTM
network, each unit consists three gates: input gate it, forget
gate ft, and output gate ot. The following is how the gates
work: To determine this memory’s state ct, an LSTM unit
takes the previous memory state ct−1 and performs element-
wise multiplication with the forget gate f. The prior memory
state is fully forgotten if the forget gate value is 0. Otherwise,
the current unit receives the entire previous memory state. The
calculation of the states in a unit is shown in Equation 3.
σ σ tanh σ
× +
× ×
tanh
ct−1
ht−1
xt 
ct
ht
ht
ft
it
˜Ct
ot
   long-term memory input
hidden layer input
input
short-term memory output
long-term 
memory output
������
Fig. 5. The architecture of LSTM.
ft = σ(Wfh ht−1 + Wfx xt + bf )
it = σ(Wihht−1 + Wixxt + bi)
˜Ct = tanh (W˜chht−1 + W˜cxxt + b˜c)
ct = ft · ct−1 + it · ˜Ct
ot = σ(Wohht−1 + Woxxt + bo)
ht = ot · tanh (ct)
(3)
III. R ESULTS AND DISCUSSION
A. Activity Recognition Results
The results obtained from the RF model trained on the
streaming sensor data indicate a high performance, with a
testing accuracy of 99.13%, with an 8:2 ratio of training to
the testing dataset. Besides, as seen in Table I, other metrics
of precision, recall, f1-score, and AUC all maintain a weighted
average value higher than 99%. They show the effectiveness
of RF in activity recognition.
B. Abnormal Activity Detection Results
The results obtained from the RF model trained on the
activity data indicate a relatively high testing accuracy of
94.29%. Besides, as Table I shows, other metrics of precision,
recall, and f1-score maintain a similar weighted average value
higher than 94%, and an AUC value of 0.97, as shown in
Figure 6.
0.0 0.2 0.4 0.6 0.8 1.0
False Positive Rate
0.0
0.2
0.4
0.6
0.8
1.0True Positive Rate
ROC curve (area = 0.97)
Fig. 6. ROC curve of RF model for abnormal activity identiﬁcation.
C. Activity Trends Prediction Results
An LSTM model is trained for the prediction of the patient’s
activities’ future frequencies and time duration on a weekly
basis. One example is shown in Figure 7. The model takes the
TABLE I
METRICS PERFORMANCES OF RF MODELS ON ACTIVITY RECOGNITION
AND ABNORMAL ACTIVITY IDENTIFICATION .
precision recall f1-score AUC
Activity Recognition 0.99128855 0.99129964 0.99126821 1.00
Abnormal Detection 0.94285714 0.94285714 0.94285714 0.97
historical time duration data of 21 days as input and outputs
the prediction for the future 7 days. The prediction results on
the testing data shown by the red line have proved the model’s
ability to predict future trends and generate appropriate risk
alerting of potential abnormal activities for the caregivers.
Intuitively, the progression of the patient’s condition can be
determined by comparing the expected and actual curves.
2009-02-03
2009-02-04
2009-02-05
2009-02-06
2009-02-09
2009-02-10
2009-02-11
2009-02-12
2009-02-13
2009-02-16
2009-02-17
2009-02-18
2009-02-19
2009-02-20
2009-02-21
2009-02-23
2009-02-24
2009-02-25
2009-02-26
2009-02-27
2009-02-28
2009-03-02
2009-03-03
2009-03-04
2009-03-05
2009-03-06
2009-03-09
2009-03-10
2009-03-11
2009-03-12
2009-03-13
2009-03-23
2009-03-24
2009-03-25
2009-03-26
2009-03-27
2009-03-28
2009-03-30
2009-03-31
2009-04-01
2009-04-02
2009-04-03
Date
1000
500
0
500
1000
1500
2000
2500
Duration Time (sec)
Predicted time span
Real time span
Fig. 7. LSTM prediction results on R1’s future personal hygiene duration.
D. RF Interpretability Evaluation
Different from most deep-learning-based AI models which
are black boxes, RF can provide higher interpretability to earn
more user trust and achieve high accuracy and time efﬁciency
at the same time. One of the approaches for RF enhancing
the interpretability is to quantify the importance of each data
feature for the task. Speciﬁcally, for activity inference, RF can
quantify the feature importance corresponding to the different
patient activity type. For example, Figure 8 shows the ﬁrst
7 important features for determining the input data item as
“R1 work”, in which the ending time of the window, last two
sensors’ IDs, and the triggering of the motion sensor M31
are essential signs of R1 work. Particularly, it is visible from
Figure 3’s ﬂoor plan that the motion sensor M31 is positioned
on the computer desk of the patient’s room, which can be
frequently activated when the patient is working.
Moreover, for abnormal activity detection, Figure 9 shows
the feature importance rank, with the time span of an activity
being the most important feature, followed by the activity
ending time, starting time, happening sequence in the day,
and the activity type.
IV. C ONCLUSION
This article presents an autonomous AIoT-enabled system
for elderly dementia patients’ monitoring in a smart home.
ending_timelast_sensor_idsecond_last_id
M31
time_span
M45 M32
0.00
0.05
0.10
0.15
0.20
0.25
0.30
0.35 R1_Work
Fig. 8. First 7 important features of the activity R1 work.
0.00 0.05 0.10 0.15 0.20 0.25
activity
NO. in day
start_time
end_time
time_span
Fig. 9. Feature importance in abnormal activity detection.
Speciﬁcally, sensor-based activity inference, real-time abnor-
mal recognition, activity trends prediction are mainly proposed
in this work. Listed below are the system’s beneﬁts:
(1) The system can be easily deployed without manual partic-
ipation after training the related AI models.
(2) Using the context of previous sensor events, the system can
automatically identify the type of patient activity to which a
newly arriving sensor event belongs.
(3) The system can automatically determine whether a pa-
tient’s present activity is normal based on the activity’s du-
ration and daily frequency, etc., thereby achieving real-time
healthcare monitoring.
(4) The system can forecast automatically the relevant charac-
teristics of dementia-related activities, such as sleeping time,
and alert the healthcare provider in advance.
Consequently, the system achieves an accuracy of 99.13% in
activity recognition and 94.29% in the detection of abnormal
activity on the CASAS [1] dataset.
REFERENCES
[1] D. J. Cook, A. S. Crandall, B. L. Thomas, and N. C. Krishnan, “Casas:
A smart home in a box,” Computer, vol. 46, no. 7, pp. 62–69, 2012.
[2] G. Livingston, J. Huntley, A. Sommerlad, D. Ames, C. Ballard, S. Baner-
jee, C. Brayne, A. Burns, J. Cohen-Mansﬁeld, C. Cooper et al. ,
“Dementia prevention, intervention, and care: 2020 report of the lancet
commission,” The Lancet, vol. 396, no. 10248, pp. 413–446, 2020.
[3] Q. Cao, C.-C. Tan, W. Xu, H. Hu, X.-P. Cao, Q. Dong, L. Tan, and
J.-T. Yu, “The prevalence of dementia: a systematic review and meta-
analysis,” Journal of Alzheimer’s Disease, vol. 73, no. 3, pp. 1157–1166,
2020.
[4] A. Johannessen, K. Engedal, P. K. Haugen, M. C. N. Dourado, and
K. Thorsen, ““to be, or not to be”: experiencing deterioration among
people with young-onset dementia living alone,”International Journal of
Qualitative Studies on Health and Well-being, vol. 13, no. 1, p. 1490620,
2018.
[5] S. S. Khan, B. Ye, B. Taati, and A. Mihailidis, “Detecting agitation and
aggression in people with dementia using sensors—a systematic review,”
Alzheimer’s & Dementia, vol. 14, no. 6, pp. 824–832, 2018.
[6] J. R. Thorpe, B. H. Forchhammer, and A. M. Maier, “Development of a
sensor-based behavioral monitoring solution to support dementia care,”
JMIR mHealth and uHealth , vol. 7, no. 6, p. e12013, 2019.
[7] D. Arifoglu and A. Bouchachia, “Detection of abnormal behaviour
for dementia sufferers using convolutional neural networks,” Artiﬁcial
intelligence in medicine , vol. 94, pp. 88–95, 2019.
[8] T. Gu, Z. Wu, X. Tao, H. K. Pung, and J. Lu, “epsicar: An emerging
patterns based approach to sequential, interleaved and concurrent activity
recognition,” in 2009 IEEE International Conference on Pervasive
Computing and Communications . IEEE, 2009, pp. 1–9.
[9] N. Yala, B. Fergani, and A. Fleury, “Towards improving feature ex-
traction and classiﬁcation for activity recognition on streaming data,”
Journal of Ambient Intelligence and Humanized Computing , vol. 8,
no. 2, pp. 177–189, 2017.
[10] P. Theekakul, S. Thiemjarus, E. Nantajeewarawat, T. Supnithi, and
K. Hirota, “A rule-based approach to activity recognition,” inKnowledge,
Information, and Creativity Support Systems . Springer, 2011, pp. 204–
215.
[11] G. Biau and E. Scornet, “A random forest guided tour,” Test, vol. 25,
no. 2, pp. 197–227, 2016.
[12] A. J. Myles, R. N. Feudale, Y . Liu, N. A. Woody, and S. D. Brown,
“An introduction to decision tree modeling,” Journal of Chemometrics:
A Journal of the Chemometrics Society , vol. 18, no. 6, pp. 275–285,
2004.
[13] S. Hochreiter and J. Schmidhuber, “Long short-term memory,” Neural
computation, vol. 9, no. 8, pp. 1735–1780, 1997.
[14] P. Liu, J. Wang, A. K. Sangaiah, Y . Xie, and X. Yin, “Analysis and
prediction of water quality using lstm deep neural networks in iot
environment,” Sustainability, vol. 11, no. 7, p. 2058, 2019.
[15] J. S. Rahhal and D. Abualnadi, “Iot based predictive maintenance using
lstm rnn estimator,” in 2020 International Conference on Electrical,
Communication, and Computer Engineering (ICECCE) . IEEE, 2020,
pp. 1–5.