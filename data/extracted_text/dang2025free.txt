1
Free Energy-Inspired Cognitive Risk Integration for
A V Navigation in Pedestrian-Rich Environments
Meiting Dang, Yanping Wu, Yafei Wang, Member, IEEE, Dezong Zhao, Senior Member, IEEE, David
Flynn, Senior Member, IEEE, and Chongfeng Wei*, Senior Member, IEEE
Abstract—Recent advances in autonomous vehicle (A V) behav-
ior planning have shown impressive social interaction capabilities
when interacting with other road users. However, achieving
human-like prediction and decision-making in interactions with
vulnerable road users remains a key challenge in complex
multi-agent interactive environments. Existing research focuses
primarily on crowd navigation for small mobile robots, which
cannot be directly applied to A Vs due to inherent differences
in their decision-making strategies and dynamic boundaries.
Moreover, pedestrians in these multi-agent simulations follow
fixed behavior patterns that cannot dynamically respond to A V
actions. To overcome these limitations, this paper proposes a
novel framework for modeling interactions between the A V and
multiple pedestrians. In this framework, a cognitive process
modeling approach inspired by the Free Energy Principle is
integrated into both the A V and pedestrian models to simulate
more realistic interaction dynamics. Specifically, the proposed
pedestrian Cognitive-Risk Social Force Model adjusts goal-
directed and repulsive forces using a fused measure of cognitive
uncertainty and physical risk to produce human-like trajectories.
Meanwhile, the A V leverages this fused risk to construct a
dynamic, risk-aware adjacency matrix for a Graph Convolutional
Network within a Soft Actor-Critic architecture, allowing it to
make more reasonable and informed decisions. Simulation results
indicate that our proposed framework effectively improves safety,
efficiency, and smoothness of A V navigation compared to the
state-of-the-art method.
Index Terms —A V-pedestrian interaction, Decision-making,
Cognitive modeling, Deep reinforcement learning, Urban shared
spaces
I. I NTRODUCTION
I
N recent years, rapid advancements in autonomous driving
technology have enabled autonomous vehicles (A V) to
expand beyond simple, structured highway environments and
to be increasingly deployed in more complex urban environ-
ments [1]. They are expected to become a key component
of future urban transportation systems [2]. Unlike structured
roads with clear traffic rules and physical lane separations,
shared spaces in cities such as squares, campuses, and resi-
dential areas usually lack right-of-way regulations and explicit
physical boundaries [3] between vehicles and pedestrians.
In such environments, A Vs must frequently interact with
multiple pedestrians [4] and safely complete the navigation
*Chongfeng Wei is the corresponding author.
Meiting Dang, Yanping Wu, Dezong Zhao, David Flynn and Chongfeng
Wei are with James Watt School of Engineering, University of Glasgow,
Glasgow, G12 8QQ, United Kingdom (email: m.dang.1@research.gla.ac.uk,
3066431W@student.gla.ac.uk, dezong.zhao@glasgow.ac.uk,
David.Flynn@glasgow.ac.uk, chongfeng.wei@glasgow.ac.uk)
Yafei Wang is with the School of Mechanical Engineering, Shanghai Jiao
Tong University, Shanghai 200240, China (email: wyfjlu@sjtu.edu.cn)
task despite ambiguities in road priority. The high uncertainty
and dynamic nature of human behavior [5], especially when
multiple pedestrians are moving at the same time, significantly
complicate the A V’s decision-making process. To ensure both
safety and efficiency, A Vs must make real-time decisions and
continuously adapt their strategies in response to surrounding
pedestrian behaviors. This poses a major challenge to existing
A V decision-making systems. Hence, this work focuses on
the decision-making problem of A Vs interacting with multiple
pedestrians in shared spaces, aiming to develop a safe and
efficient decision-making model capable of handling multi-
agent interactions and complex environmental uncertainties.
While numerous studies have explored crowd navigation
for small-scale mobile robots [6], [7], relatively few have
focused on A Vs operating in similar pedestrian-rich environ-
ments. Although A Vs represent a specialized class of robotic
systems, their navigation differs from that of smaller robots.
Unlike service robots, A Vs have larger physical footprints,
operate at higher speeds, and are subject to more complex
kinematic and safety constraints [8]. These distinctions make it
impractical to directly apply robot navigation strategies to A Vs.
As urban environments increasingly require A Vs to coexist
with pedestrian crowds, there is a growing need for decision-
making frameworks that support safe and efficient navigation
in such complex settings.
Accurate pedestrian modeling plays a critical role in en-
abling realistic and adaptive A V decision-making in interac-
tive environments. Many studies have adopted overly sim-
plified pedestrian models with fixed behavior patterns, such
as constant velocity assumptions [9] or pre-recorded real-
world trajectories [10], [11]. These approaches commonly treat
pedestrians as passive agents who are unable to dynamically
respond to the A V’s behavior during simulation. Consequently,
they fail to capture the bidirectional adjustment mechanisms
essential for realistic interaction modeling. This limitation
weakens the ability to model dynamic adaptive behaviors,
which are essential for capturing the nature of human-vehicle
interactions in shared environments.
To address these limitations, our work proposes a graph-
enhanced deep reinforcement learning framework for model-
ing interactions between an A V and multiple pedestrians. Fig.
1 illustrates the overall architecture of our proposed framework
in urban shared spaces. In this work, we adopt the Soft Actor-
Critic (SAC) algorithm to train the A V’s decision-making
policy. Specifically, a Graph Convolutional Network (GCN)
module is integrated into both the actor and critic networks to
capture structured multi-agent interactions. The GCN operates
arXiv:2507.20850v1  [cs.RO]  28 Jul 2025
2
Environment
 Pedestrian Cognitive-Risk Social Force Model
Environment Agent
External 
State
Internal
Belief
Minimize
Observation
Action
Cognitive Process Modeling 
based on Free Energy Principle
Cognitive process Risk calculation
Risk calculation Adjacency matrix
Critic
GCN MLP
Cognitive process
AV decision-making model
Replay buffer
Risk calculation Adjacency matrix
Actor
GCN MLP
Fig. 1: The proposed framework of A V-pedestrian interaction in the urban shared space.
on a dynamically constructed interaction graph, whose adja-
cency matrix encodes the interaction intensity between agents.
The edge weights are computed using a combined risk metric
that integrates physical risk and cognitive uncertainty, with
the latter derived from the Free Energy Principle. Further-
more, pedestrians are modeled as intelligent agents with both
interactive capabilities and cognitive awareness. Their behav-
ior is generated through the proposed Cognitive-Risk Social
Force Model (CR-SFM), which employs the same integrated
risk signal used in the GCN to modulate the contribution
of the goal-directed and repulsive forces. By incorporating
both physical and cognitive risk into the force computation,
pedestrian trajectories can be adaptively adjusted in response
to surrounding dynamics, yielding more realistic and human-
like behaviors in complex environments.
In order to better understand the interactions and resolve
navigation challenges in crowded environments, the main con-
tributions of this work are as follows: 1). A cognitive uncer-
tainty modeling approach based on the free energy principle is
introduced to characterize subjective human prediction biases
and the iterative adjustment process when reasoning about the
behaviors of other agents. 2). A pedestrian model called the
Cognitive-Risk Social Force Model (CR-SFM) is proposed,
which dynamically adjusts the weights of goal-directed and
repulsive forces based on a fused risk measure. This enables
pedestrian models to autonomously adapt their motions in
uncertain and interactive scenarios, achieving more realistic
behavior than conventional models with fixed coefficients. 3).
A risk-encoded interaction graph is constructed to improve A V
decision-making within a reinforcement learning framework.
The combined risk is used to define the adjacency matrix of a
GCN, which is embedded in both the actor and critic networks
of the SAC framework. This integration allows the policy to
better perceive interactive relationships and potential threats,
thus improving decision-making performance.
The remainder of this paper is organized as follows: Section
II provides a review of the state of the art in the relevant
domain. Section III presents the problem statement. Section
IV details the proposed methodology. The experimental results
along with an in-depth analysis are discussed in Section V .
Finally, Section VI concludes with key findings and potential
future work.
II. R ELATED WORK
A. Pedestrian Behavior Modeling
Many pedestrian modeling approaches have been proposed
to facilitate the simulation and analysis of human-vehicle
interactions in urban shared spaces. Early approaches often
rely on simplified pedestrian models with ideal behavioral
assumptions that significantly deviated from real-world sce-
narios. For instance, [9] modeled pedestrians as moving at
a constant velocity, ignoring interactions with the vehicle or
other pedestrians. More works have attempted to incorporate
interaction dynamics. The study [10] used recorded pedestrian
trajectories, which inherently captured interactions between
humans, to train A V policies. However, these trajectories
remain static during simulation and do not adapt to the
A V’s behavior in real time. Similarly, data-driven pedestrian
predictors trained solely on pedestrian datasets [12] could
learn interactions between pedestrians, but failed to account
for pedestrian reactions to A V maneuvers due to the absence
of vehicle information in their training. Although these models
are computationally efficient, they treat pedestrians as passive
agents rather than responsive actors, making it difficult to
simulate realistic and bidirectional interactions in dynamic
environments.
Pedestrian reactive models, such as the Optimal Reciprocal
Collision Avoidance (ORCA) [13], [14] or Social Force Model
(SFM) [15]–[17], incorporate agent interactions and collision
3
avoidance capabilities. However, these approaches capture
only low-level geometric interactions and overlook higher-
level cognitive processes such as risk perception and human
behavioral uncertainty, which are critical for robust decision-
making in human-centric environments. Therefore, to bridge
this gap, we propose the pedestrian Cognitive-Risk Social
Force Model (CR-SFM), integrating the joint influence of
physical risk and cognitive uncertainty on pedestrian decision-
making process.
B. AV Decision-making Model
Due to the limited research on A V navigation in dense
pedestrian environments, many insights have been drawn from
crowd navigation studies on mobile robots, whose interac-
tion modeling techniques can offer useful inspiration for A V
systems. Prior work in this domain falls into two categories:
prediction-based planning or learning-based approaches.
Prediction-based planning methods include decoupled and
coupled approaches. Decoupled methods first predict the sur-
rounding agents’ trajectories and then plan a collision-free path
in the remaining free space [18]. However, they often lead to
conservative behavior or freezing, as the predicted area may
become overly occupied with no feasible path [19]. Coupled
methods jointly plan trajectories for all agents by considering
mutual interactions [20], but they require frequent updates
when agents deviate from their planned paths, resulting in
high computational cost and limited real-time applications
[21]. Moreover, all prediction-based methods depend heavily
on accurate pedestrian trajectory forecasts, which are often
unreliable due to the unpredictability of human behavior.
Learning-based methods, particularly those based on deep
reinforcement learning (DRL), have emerged as promising
alternatives due to their ability to capture complex social
interactions and support efficient online inference. While most
DRL-based crowd navigation studies focus on small mobile
robots, only a few have explored A V navigation in dense
pedestrian environments. For instance, [10] trained an A V
using a DRL framework with a reward function designed to
promote safe and efficient behaviors in crowds. Although this
method considers prediction uncertainty, it leverages uncer-
tainty only in the reward design to guide policy learning,
without directly incorporating it into the interaction modeling
process.
To improve interaction modeling, many DRL frameworks
for robot navigation have integrated advanced network ar-
chitectures such as recurrent neural networks (RNN) [22]–
[24], graph neural networks (GNN) [25]–[27], and attention
mechanisms [28]–[30]. For example, [24] incorporated Long
Short-Term Memory into DRL to encode observations from
a variable number of surrounding agents into a fixed-length
vector. A heterogeneous relational DRL framework was in-
troduced to explicitly model diverse interaction types using a
customized GNN [26]. In [29], a spatial graph was combined
with an attention module to highlight the relative importance
of nearby agents.
While these approaches enhance interaction modeling, they
often neglect the subjective uncertainty inherent in human
cognition, such as prediction errors or biases that may arise
when an agent attempts to infer pedestrian intentions or
behaviors. To address this, our method adopts a graph-based
DRL framework that uniquely encodes a unified representation
of physical risk and cognitive uncertainty into an interaction
graph. This allows the policy to capture complex and dynamic
interactions and make more informed decision-making in
pedestrian-rich environments.
III. P ROBLEM FORMULATION
This work focuses on the A V navigation problem in environ-
ments with multiple pedestrians. The objective is to develop
a continuous decision-making strategy that ensures safe and
efficient operation amid dynamic human interactions.
We model this problem as a Markov Decision Process
(MDP), defined by the tuple: ⟨S, A, P, R, γ⟩. The state space
S captures the dynamic state of the environment at each time
step t, denoted by st ∈ S. We assign index 0 to the A V
and indices 1 to n to the surrounding pedestrians. The A V’s
state s0
t includes its current position (x, y), heading angle θ,
velocity v, acceleration α, goal position (xgoal, ygoal), distance
to the goal position dgoal, and angular deviation from the goal
direction ∆θgoal. Each pedestrian’s state si
t, for i = 1 . . . n,
consists of their position, heading angle, and walking velocity.
The whole environment state at time t is defined as st :
(s0
t , s1
t , . . . , sn
t ). The action space A represents the set of
possible actions available to the A V . Each action at ∈ A,
is defined as a tuple at = [ α, ∆θ], where α denotes the
acceleration and ∆θ denotes the change in heading direction.
The state transition probability P(st+1|st, at) defines how the
environment evolves from the current statest to next state st+1
given the action taken by the A V . Following the transition, the
A V receives a rewardrt ∈ R, indicating the immediate utility
of its chosen action.
The A V model aims to learn a policyπ(at|st) that produces
a sequence of optimal actions to maximize the expected
cumulative discounted reward over time, where the process ter-
minates upon reaching the destination. This decision-making
problem can thus be defined as follows:
max
π
E
" ∞X
t=0
γtrt(st, at) | at ∼ π
#
subject to st+1 ∼ P(st+1 | st, at),
at ∈ A, st ∈ S,
rt ∈ R, ∀t ∈ N
(1)
where γ ∈ [0, 1] is the discount factor that determines the
relative importance of future rewards.
IV. M ETHODOLOGY
A. Cognitive Uncertainty Modeling
One of the core computational tasks of the human brain
is to infer latent world states and predict future behaviors of
others or the environment based on sensory inputs and prior
knowledge, especially in uncertain and dynamic conditions
[31]. In this process, individuals often experience a lack of
full confidence in their predictions. This subjective uncertainty,
4
referred to as cognitive uncertainty [32], reflects how confident
an individual is about expected outcomes [33]. When pre-
dictions deviate from actual observations, the resulting errors
drive belief adjustments and expectation updates, leading to
more rational decisions. For example, a pedestrian intending
to cross the road may expect an approaching vehicle to slow
down and yield. If the pedestrian lacks confidence in this
expectation, it reflects a high level of cognitive uncertainty.
If the vehicle accelerates instead, the mismatch prompts the
pedestrian to re-evaluate and adjust their behavior. Capturing
such cognitive processes is vital for modeling human decision-
making under uncertainty. Integrating this cognitive mecha-
nism into intelligent agent models allows for more human-like
and interpretable behavior, thereby enhancing the realism of
human–machine interaction.
The Free Energy Principle (FEP) provides a unifying the-
oretical framework for describing this cognitive process [34],
[35]. It suggests that agents continuously generate predictions
and revise internal beliefs based on sensory feedback in order
to minimize “surprise” and maintain cognitive stability and
behavioral adaptability. In Bayesian Inference, “surprise” is
typically formalized as the negative log marginal likelihood,
−log P(o). Since the marginal likelihood P(o) =
R
p(x, o) dx
is generally intractable, direct minimization is impractical. To
overcome this, the FEP introduces variational free energy as
an optimizable upper bound [36]:
F(Q) = DKL(Q(x)∥P(x|o)) − log P(o) (2)
where Q(x) denotes the agent’s approximate posterior belief,
and P(x|o) is the true posterior given the observation o. The
Kullback-Leibler (KL) divergence quantifies the discrepancy
between the two distributions. Since the KL divergence is
always non-negative, minimizing free energy pushes the inter-
nal belief distribution toward the true posterior. This process
provides a mathematical foundation for cognitive modeling.
In practical scenarios, cognitive uncertainty, as a subjective
mental state, is inherently difficult to observe or measure
directly. Individuals often lack confidence in their judgments
when exposed to limited information or complex environ-
ments. In order to quantify this uncertainty, we propose the fol-
lowing modeling assumptions: when the discrepancy between
predicted and observed outcomes is large, the individual’s con-
fidence in their prediction is low, indicating higher cognitive
uncertainty. Accordingly, we adopt the KL divergence between
the predicted and the observed distributions as a proxy measure
of epistemic uncertainty, capturing the agent’s confidence level
in forecasting the future behavior of others.
In this work, we use velocity as the target variable and
implement a closed-loop cognitive model based on the pre-
dict–observe–update process, grounded in the Free Energy
Principle and Bayesian Inference. Each agent’s prediction of
others’ velocities is assumed to follow a Gaussian distribution.
At each time step t, the ego agent, whether an A V or a
pedestrian, generates a velocity prediction ˆvt for surrounding
agents, and combines it with the posterior from the previous
step t − 1 to obtain the current prior:
pt(v) = N(µp, σ2
p) (3)
Upon observing the actual velocity vt, an observation distri-
bution is constructed with the observed value as its mean µo
and a fixed variance σ2
o:
ot(v) = N(µo, σ2
o) (4)
The cognitive uncertainty is approximated by computing the
KL divergence between the predicted and observed distribu-
tions, expressed as:
ut = DKL(pt(v)||ot(v)) (5)
A larger KL value indicates a greater deviation, implying lower
confidence in the prediction and higher epistemic uncertainty.
The ego agent then performs Bayesian updating to obtain the
posterior [37]:
1
σ2
post
= 1
σ2p
+ 1
σ2o
(6)
µpost = σ2
post
µp
σ2p
+ µo
σ2o

(7)
This posterior represents the agent’s revised belief about
others’ behavior at the current time step and serves as the
prior for the next prediction, thus forming a recursive cognitive
inference process. The complete procedure is presented in
Algorithm 1.
Algorithm 1: Human cognitive process modeling with
cognitive uncertainty quantification
Input: Surrounding agents set N, time horizon T,
internal prediction model
Output: Cognitive uncertainty
for each time step t ∈ T do
for each surrounding agent i ∈ N do
Use internal prediction model to predict
velocity ˆvi
t;
Obtain prior distribution pi
t(v) based on
predicted velocity ˆvi
t and posterior
pi
post,t−1(v);
Observe true velocity vi
t and construct
observation distribution oi
t(v);
Compute cognitive uncertainty ui
t;
Compute posterior distribution pi
post,t(v) using
Bayesian update;
Store the updated posterior pi
post,t(v);
B. Pedestrian Cognitive-Risk Social Force Model
The social force model [38] describes pedestrian movement
as the result of a combination of virtual social forces, including
a goal force that drives individuals toward their destina-
tions, and repulsive forces from other agents or obstacles to
avoid collisions. These forces are represented as vectors and
superimposed to determine the pedestrian’s overall motion,
enabling modeling and simulation of pedestrian behavior.
In the A V–pedestrians interaction considered in this study,
each pedestrian is influenced by three primary forces: a goal
5
force guiding movement toward the destination, a vehicle-
induced repulsive force from the A V , and repulsive forces from
surrounding pedestrians.
To model efficient goal-oriented movement, the goal force
for pedestrian i is defined as:
Fgoal
i = v0
i ⃗ ei − ⃗ vi
τi
(8)
where v0
i is the desired speed, ⃗ ei is the unit vector pointing
toward the destination, ⃗ vi is the current velocity of pedestrian
i, and τi is the relaxation time representing how quickly
the pedestrian adapts to the desired velocity. The repulsive
interactions are modeled as exponentially decaying functions
of distance. The repulsive force from the A V is given by:
Fveh
i = Aveh · exp
ri,veh − di,veh
Bveh

· ⃗ ni,veh (9)
and the repulsive force from another pedestrian j is computed
as:
Fped
ij = Aij · exp
rij − dij
Bij

· ⃗ nij (10)
In both equations, A and B are constants; d is the Euclidean
distance between agents; r is the sum of physical radii; and
⃗ nis the unit vector pointing from the interacting agent to
pedestrian i. These forces are combined to yield the resultant
force acting on each pedestrian. For pedestrian i, the total force
can be formulated as [39]:
Fi = Fgoal
i + Fveh
i +
X
j∈G
j̸=i
Fped
ij (11)
where G denotes the set of all pedestrians in the current scene.
While the social force model has been widely applied in
pedestrian behavior modeling, it still shows certain limitations
in complex human-vehicle interaction scenarios. On the one
hand, the magnitude of repulsive forces is usually fixed
and based solely on spatial distance, without accounting for
the velocity and motion direction of interacting agents. For
instance, an A V may be physically close to a pedestrian but
moving away; in such cases, the risk is negligible. However,
the traditional model would still exert a strong repulsive force
purely due to proximity, leading to unrealistic or overly cau-
tious avoidance behaviors. On the other hand, the model lacks
a representation of human cognitive processes. In real-world
interactions, pedestrians continuously perceive, anticipate, and
update their beliefs about others’ behaviors. This “percep-
tion–prediction–observation–update” loop is fundamental to
human decision-making in dynamic, uncertain environments.
But it is absent in the traditional social force model.
To overcome these limitations, we propose the pedestrian
Cognitive-Risk Social Force Model (CR-SFM). The core idea
is to introduce risk weight coefficients that dynamically mod-
ulate the intensity of each force, allowing pedestrian behaviors
to adapt responsively to evolving interaction contexts. Fig.
2 provides a schematic comparison between the SFM and
CR-SFM, showing the difference in resultant force under the
same interaction scenario. The revised resultant force acting
on pedestrian i is formulated as:
Fi = wgoal
i · Fgoal
i + wveh
i · Fveh
i +
X
j∈G
j̸=i
wped
ij · Fped
ij (12)
where wgoal
i , wveh
i and wped
ij represent the risk-based weights
for the goal force, vehicle repulsion, and pedestrian repulsion,
respectively. These weights are computed by combining phys-
ical risk and cognitive uncertainty.
(a)
 (b)
Fig. 2: Comparison of the SFM and CR-SFM in pedestrian-vehicle interac-
tions. These figures show the force composition acting on the ego pedestrian
under the SFM (a) and CR-SFM (b). In the SFM, all repulsive forces are
distance-based with fixed weights. Pedestrian 1 (the rightmost pedestrian in
the figure), being closest, produces the strongest repulsion, shifting the total
force toward the A V and increasing collision risk. In CR-SFM, force weights
are adjusted based on physical features (e.g., distance, velocity, direction) and
cognitive uncertainty. Although pedestrian 1 is nearest, his motion away leads
to low perceived risk and a weaker force. The approaching A V contributes
more strongly, shifting the total force toward a safer direction.
In dynamic interaction scenarios, risk assessment methods
based solely on geometric distance often fail to accurately
capture the actual level of threat, as they overlook the critical
influence of relative motion on risk perception. For example, at
the same distance, an agent approaching at high speed poses
a greater danger than one moving slowly or moving away.
To better reflect this perceptual difference, we introduce a risk
modeling approach based on virtual distance. By incorporating
dynamic motion features such as velocity, acceleration, and
direction [40] to modulate the actual distance, the resulting
virtual distance is then used to replace the original geometric
distance for physical risk computation. The physical risk ψ is
defined as:
dvirtual = dactual · (1 + tanh (γ1 · k · (v · |cos φ| + |a|))) (13)
k =
(
1, if the agent is moving away
−1, if the agent is approaching (14)
ψ = 1
1 + γ2 · dvirtual
(15)
where dactual is the actual physical distance between the pedes-
trian and the interacting agent, v and a are the velocity and
acceleration of the interacting agent, φ is the angle between the
agent’s velocity vector and the vector pointing from the agent
to pedestrian i, and γ1 and γ2 are hyperparameters. These
formulations imply that risk increases when an approaching
agent moves towards the pedestrian with higher speed or
greater acceleration.
6
Cognitive uncertainty captures the pedestrian’s subjective
confidence in predicting others’ future behaviors. Rather than
being modeled as an independent risk component, it is treated
as a modulatory factor that amplifies physical risk under
uncertain situations. For example, when physical risk is low,
but the pedestrian is unsure of the A V’s future behavior, a
higher cognitive uncertainty increases perceived risk, enhanc-
ing repulsive forces and encouraging earlier avoidance. The
risk weight coefficients are calculated as follows:
wveh
i = ψveh
i ·
 
1 + λ1 · uveh
i

(16)
wped
ij = ψped
ij ·

1 + λ2 · uped
ij

(17)
wgoal
i = exp

−λ3 · max

wveh
i , max
j∈G,j̸=i
wped
ij

(18)
where uveh
i and uped
ij denote cognitive uncertainties. λ1, λ2,
λ3 are scaling hyperparameters. Notably, the goal force weight
is modeled using an exponential decay function to reduce
goal-oriented behavior when perceived interaction risk is high,
allowing the pedestrian to prioritize avoidance over forward
motion.
In summary, by introducing a dynamic weighting mecha-
nism that integrates both physical and cognitive factors, the
CR-SFM can make the pedestrian to modify their approach
and avoidance strategies based on perceived risk and uncer-
tainty, more closely aligning with real human decision-making
processes.
C. Graph-Enhanced DRL for AV Decision-Making
In this study, we adopt the Soft Actor-Critic (SAC) as
a basic reinforcement learning framework to guide the A V
decision-making strategies in complex, pedestrian-rich envi-
ronments. The SAC is grounded in the Maximum Entropy
Reinforcement Learning theory. While optimizing the ex-
pected cumulative return, it explicitly introduces a policy
entropy term to encourage greater stochasticity and exploration
under uncertainty. The objective is to maximize the following
expression [41]:
J(π) =
X
t
E(st,at)∼π [r(st, at) + αH(π(·|st))] (19)
where H(π(·|st)) is the entropy of the policy at state st, and
α is a temperature coefficient balancing reward and entropy.
The SAC follows an actor-critic architecture consisting
of a policy network (actor), two Q-value networks (critics),
and their corresponding target networks. The actor outputs a
Gaussian distribution over actions given a state st, from which
an action at is sampled. The Q-networks estimate the value
of the state-action pair (st, at). Using samples from a replay
buffer, the networks are updated iteratively to approximate
optimal behavior. To mitigate Q-value overestimation, SAC
employs a double Q-network structure, where the minimum
of the two Q-values is used to compute the target value. The
critic is trained to minimize the following loss:
Lcritic = E(st,at,rt,st+1)∼D
1
2 (Q(st, at) − yt)2

(20)
with the target value yt defined as:
yt = rt + γ min
i=1,2
Q′
i(st+1, at+1) − α log π(at+1 | st+1) (21)
The target Q-networks are updated softly via:
θ′ ← τθ + (1 − τ)θ′ (22)
where τ ∈ (0, 1) is a small soft update coefficient, θ denotes
the parameters of the current critic network, and θ′ denotes the
parameters of the target critic network. The actor is trained
to maximize the expected Q-value while maintaining high
entropy:
Lactor = Est∼D [α log π(at|st) − Q(st, at)] (23)
Through this maximum entropy optimization framework, the
SAC enables stable and continuous policy learning in complex
environments, allowing the A V to develop strategies that
are both efficient and exploratory in dynamic multi-agent
interactions.
However, the standard SAC architecture does not explicitly
model dynamic interactions among multiple agents, which
is critical in autonomous driving scenarios involving dense
pedestrian. To address this, we incorporate a Graph Convo-
lutional Network (GCN) into the SAC framework to extract
interaction-aware state representations from the multi-agent
graph.
At each time step, the A V and surrounding pedestrians are
modeled as graph nodes, with the adjacency matrix encoding
their interactions. Given a graph Gt = (V t, At), where V t
is a set of all agents at time t, At is the adjacency matrix,
H(l) ∈ RN×d represents the node feature at layer l, and the
GCN propagation rule is expressed as [42]:
H(l+1) = σ

eD
−1/2 eA eD
−1/2
H(l)W(l)

(24)
where ˜A = A + I is the adjacency matrix adding self-
connection, ˜D is the degree matrix, W(l) is the learnable
weight matrix, and σ is the nonlinear activation function. This
operation aggregates each agent’s state with information from
its neighbors, capturing local structural relationships and inter-
action patterns. The resulting high-order representations serve
as enhanced state features for downstream policy learning and
value estimation.
However, the adjacency matrix in conventional GCNs is
often constructed using static graph topology, making it in-
sufficient for modeling dynamic and asymmetric interaction
patterns over time. In real-world multi-agent interactions,
humans do not pay equal attention to all agents, but instead
focus on potentially high-risk individuals that are closer, faster,
or have unpredictable behaviors.
Inspired by this, we propose a risk encoded interaction
graph, where physical risk and cognitive uncertainty are com-
bined into a unified risk score. This value directly determines
the attention weights in the adjacency matrix, allowing the
model to focus more effectively on high-risk interactions
during information aggregation. Specifically, we construct a
dynamic adjacency matrix At at each time step, where each
7
element At(i, j) represents the influence of agent j on agent
i:
At(i, j) = ψt(i, j) · (1 + λ · ut(i, j)) (25)
where ψt(i, j) denotes the physical risk based on agent j’s
relative position, speed, and direction with respect to agent
i, while ut(i, j) quantifies agent i’s uncertainty about agent
j’s behavior, computed using the free-energy-based method
described in Algorithm 1. λ is a hyperparameter controlling
the influence of uncertainty.
This dynamic adjacency matrix guides GCN propagation to
focus on high-risk interactions, enabling the model to empha-
size critical agents and filter out irrelevant ones. Compared
to traditional graph modeling, our approach jointly encodes
physical structure and cognitive cues, providing the policy net-
work with more decision-relevant state representations. This
enhances the policy’s ability to identify key interactions and
make robust decisions in complex, multi-agent environments.
The overall training process is summarized in Algorithm 2.
Algorithm 2: SAC for A V Decision-Making with
Cognitive Process
Initialize critic networks Q1, Q2, actor network π,
target networks Q′
1, Q′
2, and replay buffer D;
for episode i ∈ M do
Observe initial state s0;
for each time step t ∈ T do
Compute cognitive uncertainty ut using
Algorithm 1;
Execute an action at, receive a reward rt, and
observe the next state st+1;
Store the transition (st, at, rt, st+1, ut) in
replay buffer D;
Update st ← st+1;
Sample a minibatch of transitions from D;
Compute target Q-value yt;
Update critics Q1 and Q2 by minimizing loss
Lcritic;
Update actor network π;
Soft update target critic networks Q′
1 and Q′
2;
V. E XPERIMENT
A. Experimental Setup
To evaluate the effectiveness of the proposed pedestrian CR-
SFM and the A V decision-making model, we conducted a
series of simulation experiments in a shared-space interaction
scenario.
We adopted the real-world Hamburg Bergedorf Station
(HBS) dataset [43], which captures a typical shared-space
street environment in Hamburg, Germany. This dataset con-
tains rich interactions between low-speed vehicles and multiple
crossing pedestrians in unconstrained urban settings. From
the HBS dataset, we extracted 78 representative interaction
scenarios, each involving a single A V and three pedestrians.
These scenarios were divided into a training set (77%) and
test set (23%) to support model learning and performance
evaluation, respectively. Each simulation was initialized using
the recorded initial positions and velocities of all agents.
During the interaction process, the A V generated its actions
based on the learned policy, while pedestrian behaviors were
governed by our proposed CR-SFM. A simulated episode
terminated when the A V reached its goal, collided with a
pedestrian, or the maximum time horizon was exceeded.
All experiments were conducted on a high-performance
laptop equipped with an Intel i9 processor and an NVIDIA
RTX 4090 GPU. Model training and simulation were imple-
mented using PyTorch in a custom-built environment. Due to
computational limitations on local hardware, we restricted our
simulation setup to include three pedestrians interacting with
an A V . This configuration balances training feasibility and in-
teraction complexity, while still capturing key social dynamics
observed in shared-space environments. In the simulation, the
A V’s maximum speed was set to 6 m/s, with acceleration
constrained to the range of [-2, 2] m/s 2. Pedestrians were
limited to a maximum walking speed of 2 m/s. The simulation
operated with a discrete time step of 0.5 seconds.
B. Comparative Models and Evaluation Metrics
This section describes the comparative models as well as
evaluation indicators used for both the pedestrian model and
the A V decision-making model.
For the pedestrian model, in order to assess the performance
of our proposed pedestrian CR-SFM, we conducted compar-
ative experiments with two baseline models and one ablation
variant. The compared models are detailed as follows:
Constant Velocity Model (CV) [9]: In this model, the pedes-
trian maintains a constant initial velocity toward the predefined
goal throughout the entire episode. The motion is purely goal-
driven and remains unaffected by the presence or behavior of
surrounding agents.
Social Force Model (SFM) [39]: This classical model serves
as the primary baseline. It describes the pedestrian’s motion as
the result of three interacting forces, as defined in Equation 11.
In the standard formulation, the magnitudes of these forces are
uniformly weighted using fixed coefficients (set to 1), without
any dynamic modulation in response to changes in interaction
context.
Risk-aware Social Force Model (RA-SFM) : This variant
serves as an ablation model to evaluate the specific contri-
bution of cognitive uncertainty. It extends the standard SFM
by introducing physical risk as a modulation factor for social
force magnitudes. Specifically, the strengths of the goal force,
vehicle repulsion force, and pedestrian repulsion force are
dynamically adjusted based on the estimated physical risk
from surrounding agents.
Cognitive-Risk Social Force Model (CR-SFM) : This is our
proposed model. Building upon the RA-SFM, CR-SFM incor-
porates both physical risk and cognitive uncertainty into the
modulation of force magnitudes.
To ensure a fair comparison, all models are calibrated using
the same set of real-world pedestrian trajectories extracted
from the training dataset. Bayesian Optimization is employed
8
to fit the model parameters, aiming to best replicate the real
pedestrian behaviors. All models are operated under the same
experimental conditions, using the following three metrics for
trajectory evaluation:
Average Displacement Error (ADE) : ADE measures the
average deviation between the simulated trajectory and the
ground truth trajectory across all time steps. For each episode,
we compute the mean Euclidean distance between simulated
and actual positions across every time step. The final ADE is
obtained by averaging these values over all episodes [44]:
ADE = 1
M
MX
m=1
 
1
T
TX
t=1
∥ˆxt − xt∥
!
(26)
where M is the total number of test episodes, T is the number
of time steps in each episode, ˆxt denotes the simulated position
of at time step t, and xt is the corresponding ground-truth
position.
Final Displacement Error (FDE) : FDE evaluates the final-
point accuracy by measuring the Euclidean distance between
the simulated final position and the true final position [44]:
FDE = 1
M
MX
m=1
∥ˆxT − xT ∥ (27)
Collision Rate (CR) : CR is defined as the proportion of
simulation episodes in which the simulated pedestrian model
collides with other agents. It is calculated as the ratio of
collision cases to the total number of episodes. A lower CR
value indicates better collision avoidance performance.
To evaluated our A V decision-making model, we compare
it with one strong baseline and two ablation variants:
Uncertainty-Aware Polar Collision Grid (UAW-PCG) [10]:
This state-of-the-art DRL framework integrates pedestrian tra-
jectory prediction uncertainty into A V navigation in crowded
environments. It employs a Polar Collision Grid predictor to
estimate future pedestrian positions along with their associated
uncertainty. These predictions are then incorporated into both
the input state and the design of the reward function. The
A V decision-making policy is optimized using Proximal Policy
Optimization (PPO) algorithm.
Standard SAC (S-SAC): This baseline uses a standard SAC
framework, where both the actor and critic networks con-
sist only of multilayer perceptron without GCN modules.
It does not explicitly capture interactions between the A V
and surrounding agents, and serves to evaluate the benefit of
introducing graph-based structures.
Graph-enhanced SAC without cognitive modeling (G-SAC-
NoCog): This ablation model adopts the GCN module into
the SAC framework to enhance the perception of multi-
agent interactions. However, it uses a static adjacency matrix
with uniform weights between all agent pairs, ignoring both
physical risk and cognitive uncertainty. This model is designed
to isolate the contribution of our proposed risk-encoded inter-
action representation.
Graph-enhanced SAC with cognitive modeling (G-SAC-
Cog): This is our proposed model. It integrates a GCN module
to capture structured multi-agent interactions, with the adja-
cency matrix dynamically constructed based on a fused risk
signal that combines physical risk and cognitive uncertainty.
Following the evaluation protocol used in [10], [45], we
assess each model from the perspectives of safety, efficiency
and smoothness. Specifically, safety is quantified using three
indicators: the success rate (the proportion of episodes in
which the A V reaches its destination without any collisions),
the collision rate (the frequency of collisions with surrounding
agents), and the timeout rate, which accounts for episodes
where the A V fails to reach the goal within the maximum
allowed time despite avoiding collisions. Efficiency is eval-
uated based on the average vehicle speed, which reflects the
efficiency of the A V’s navigation performance. Lastly, smooth-
ness is measured by the average jerk and average maximum
absolute acceleration/deceleration, capturing the stability and
comfort of the A V’s motion during navigation.
VI. R ESULTS AND DISCUSSION
This section presents the qualitative and quantitative valida-
tion results of both the proposed pedestrian CR-SFM and A V
decision-making model.
A. Pedestrian Cognitive-Risk Social Force Model
1) Qualitative Analysis
To demonstrate how the proposed pedestrian model per-
forms under different interaction conditions, three representa-
tive examples are presented in Figure 3.
Fig. 3a illustrates a normal case in which the A V follows its
ground-truth trajectory, while pedestrians are simulated using
the proposed CR-SFM. As shown in the figure, all pedestrians
safely reach their respective destinations without any colli-
sions. The simulated trajectories (blue triangles) show high
similarity to the ground-truth pedestrian trajectories (purple
crosses), with only minor deviations. This confirms that the
model’s ability to generate safe and goal-directed motion in
interactive scenarios.
Fig. 3b provides a scenario involving an explicit collision
risk between the simulated pedestrian and a nearby agent. In
this case, the A V and two pedestrians follow their ground-
truth trajectories, while the third pedestrian’s trajectories are
simulated by the SFM, RA-SFM, and CR-SFM. The zoomed-
in subfigure reveals that the SFM-generated trajectory leads to
a collision with another pedestrian, with collision point marked
by a red cross. In contrast, both the RA-SFM and CR-SFM
successfully avoid the hazard by slightly deviating the pedes-
trian’s path away from the surrounding agent, toward the right-
hand side of the scene. This behavioral divergence highlights
the benefit of adaptive social force modulation in RA-SFM
and CR-SFM, enabling the agent to respond effectively to
immediate physical threats. Notably, the trajectory generated
by the CR-SFM displays a more pronounced shift toward
the safer region, indicating a higher sensitivity to dynamic
interaction contexts.
Fig. 3c further investigates the model’s behavior under
ambiguous or latent risk conditions. Although no immediate
physical danger is apparent, both the SFM and RA-SFM
9
(a)
(b)
(c)
Fig. 3: Qualitative examples of pedestrian trajectory simulation under different
interaction scenarios. (a) A normal case in which all pedestrian trajectories are
simulated by the proposed CR-SFM. (b) A comparison of three trajectories
generated by the SFM, RA-SFM, and CR-SFM. The trajectory generated by
the SFM results in a collision, while the RA-SFM and CR-SFM avoid the
nearby agent. (c) The SFM and RA-SFM fail to trigger avoidance behavior,
whereas the CR-SFM proactively detours before reaching the goal.
trajectories continue directly toward the goal and result in
collisions, as shown in the zoomed-in area. In contrast, the
CR-SFM trajectory shows a markedly different pattern: the
pedestrian perceives elevated risk in the goal direction, detours
toward a low-risk zone, and resumes goal-directed motion only
after the uncertain agent has passed.
These behavioral differences stem from the models’ risk
perception capabilities. The SFM relies on fixed interaction
strengths based purely on distance, and thus cannot adapt to
changing risk profiles. RA-SFM improves on this by adjusting
repulsive forces according to observable physical cues such
as proximity and velocity. However, when these cues remain
below a critical threshold, the model fails to trigger sufficient
repulsion, and the pedestrian proceeds along a collision-prone
path without taking an evasive action.
In contrast, the CR-SFM introduces cognitive uncertainty
modeling, allowing the pedestrian to account not only for
physical risk but also for uncertainty in the predicted behaviors
of nearby agents. By quantifying the discrepancy between
the expected and observed motion, CR-SFM captures the
subjective uncertainty and then integrates it into the overall
risk assessment. This allows the model to detect latent threats
that are not evident through physical cues alone. Consequently,
even when the physical risk is low, the elevated uncertainty can
amplify the perceived danger and increase the total risk. When
this combined risk becomes significant, the pedestrian proac-
tively adjusts its trajectory, even temporarily moving away
from the destination to avoid potential collisions. Once the
perceived risk diminishes, the pedestrian returns to the original
path and safely reaches the goal. This behavior illustrates
the unique advantage of cognitive uncertainty modeling in
CR-SFM. By integrating internal uncertainty estimation with
external physical observations, the model is able to anticipate
possible conflicts and make more informed decisions. As a
result, CR-SFM generates more flexible, cautious, and human-
like behavior in complex multi-agent environments, signifi-
cantly enhancing both trajectory safety and realism.
In conclusion, the CR-SFM demonstrates strong perfor-
mance for realistic pedestrian simulation, enabling reliable
behavior modeling under diverse and challenging conditions.
2) Quantitative Analysis
Table I summarizes the quantitative performance of various
pedestrian models in terms of ADE, FDE, and CR. The CV
model yields the poorest performance, with an ADE of 1.5262
and an FDE of 2.8738, indicating large deviations from the
ground-truth trajectories. It also records the highest collision
rate, which is expected given that the CV model neglects goals,
interactions, or environmental dynamics. In contrast, the SFM
introduces interactive forces and goal attraction, significantly
lowering the ADE and FED to 0.8310 and 0.6151, respectively.
However, it still suffers from a non-negligible collision rate
(3.7%), highlighting its limitation in complex interactions due
to its reliance on fixed interaction parameters.
The RA-SFM enhances the traditional SFM by making the
repulsive force adaptive to kinematic features such as distance,
velocity and direction. This results in a slight improvement
in the simulation accuracy, but the collision rate remains un-
changed. Although RA-SFM allows for more adaptive motion
10
TABLE I: Statistic results of our pedestrian model compared with other
approaches
Pedestrian Model ADE FDE CR
CV [9] 1.5262 2.8738 0.0926
SFM [39] 0.8310 0.6151 0.0370
RA-SFM 0.8139 0.5247 0.0370
CR-SFM (Ours) 0.7842 0.4416 0.0
generation, it still lacks the capacity to account for uncer-
tainty in agent behaviors.By comparison, the proposed CR-
SFM outperforms all baselines across all metrics. It obtains
the lowest ADE (0.7842) and FDE (0.4416), reflecting its
superior trajectory simulation accuracy. Notably, it achieves
a zero collision rate, successfully avoiding all collisions in the
evaluation scenarios. This performance is primarily attributed
to the integration of cognitive risk modeling, which enables
the pedestrian to not only react to visible physical cues but
also anticipate potential conflicts arising from uncertainty in
others’ behaviors.
In summary, the quantitative results demonstrate that the
CR-SFM achieves reliable performance in both accuracy and
safety. Compared to other methods, it reduces displacement
errors while enhancing collision avoidance. These findings
indicate that combining cognitive risk reasoning with adaptive
social forces enables more flexible and robust generation of
pedestrian behavior in dynamic and interactive environments.
B. AV Decision-Making Model
1) Qualitative Analysis
To clearly demonstrate how our A V decision-making model
operates across different scenarios, two representative cases
are presented below.
Case 1 provides an example where both the A V and the
human driver decelerate early to avoid collisions with nearby
pedestrians, as shown in Fig. 4. At the beginning of the episode
(Fig. 4a and 4b, top-left), the A V is at its initial position with
three pedestrians distributed across the scene. Pedestrian 1
stands particularly close to the A V’s planned path, indicating
a higher potential collision risk. In the simulation (Fig. 4a),
the A V gradually decelerates in response to the pedestrians’
anticipated behavior, slowing sufficiently to safely pass behind
Pedestrians 1 and 2 before smoothly accelerating again once
the path is clear. During the interaction with Pedestrian 3 (Fig.
4a, bottom-left), the A V maintains a low, steady acceleration
without significant speed reduction, reflecting its assessment
of minimal risk and resulting in a smooth and continuous
motion strategy. Finally, the A V successfully navigates through
all pedestrians and reaches its goal without abrupt stops or
collisions.
The pedestrian trajectories in the simulation (Fig. 4a) are
generated by our previously proposed pedestrian CR-SFM
model, whereas those in Fig. 4b are recorded from actual
pedestrian movements. In the real-world scenario, although
Pedestrian 1 chooses to stop and yield, the human driver
also decelerates to a full stop, waiting until the pedestrian
has completely crossed before resuming movement. After
passing Pedestrians 1 and 2, the driver again reduces speed
significantly to yield when approaching Pedestrian 3. These
conservative actions lead to marked fluctuations in the vehi-
cle’s speed and acceleration profiles, as illustrated in Fig. 4d.
In contrast, our proposed model achieves smoother and more
stable driving behavior by applying sufficient deceleration
without unnecessary stops.
Case 2 illustrates a situation in which both the A V and
the driver maintain their speed to yield to pedestrians initially
positioned at a greater distance, as shown in Fig. 5. Early in
this episode, both the A V and the human driver perceive that
the pedestrians will enter their intended path. However, given
the sufficient distance, they evaluate the situation as low-risk
and opt to maintain a speed of approximately 3.5 m/s without
significant braking. This behavior contrasts with Case 1, where
the closer proximity of pedestrians required early deceleration
to ensure safety.
Once the pedestrians have safely crossed and the potential
risk is eliminated, the human driver continues at a steady speed
of around 4 m/s, whereas the A V accelerates smoothly to its
maximum velocity to efficiently reach its goal. Throughout
the interaction, both the A V and the driver exhibit similar
decision-making patterns, with consistent trends observed in
their acceleration profiles and heading angle adjustments (Fig.
5c and Fig. 5d). These results suggest that the overall behavior
of the proposed model closely mirrors that of the human
driver, while showing smoother and more stable heading angle
transitions.
In conclusion, the above results demonstrate that our pro-
posed A V decision-making model can effectively select ap-
propriate strategies based on the current scenario and state,
adjusting its behavior accordingly to achieve safe yet efficient
navigation during interactions with pedestrians.
2) Quantitative Analysis
Table II summarizes the quantitative performance of our
proposed model (G-SAC-Cog) compared to the state-of-the-
art method (UAW-PCG), two ablation variants (S-SAC and
G-SAC-NoCog) and human driving data. Overall, our method
achieves a success rate of 0.94, which is significantly higher
than the comparative models (0.78–0.83). Moreover, it attains
the lowest collision rate among the A V models at 0.06,
indicating that our approach effectively enhances safety in
pedestrian-rich environments.
In terms of driving efficiency, our model achieves an average
speed of 4.470 m/s, outperforming all comparative models
and greatly exceeding that of the human driver (2.924 m/s).
This superior efficiency can be attributed to the reinforcement
learning framework applied in training A V models, which,
under the given reward structure, incentivizes learned poli-
cies to maximize accumulated reward. Consequently, the A V
maintains high speeds whenever no immediate collision risk
is detected, enabling it to achieve higher efficiency without
compromising safety, as evidenced by its low collision rate.
Regarding driving comfort, S-SAC attains the smoothest
performance with the minimal average vehicle jerk (0.448
m/s3). However, this comes with a high collision rate (0.22),
suggesting that S-SAC tends to maintain speed even in close
proximity to pedestrians, resulting in smoother but riskier
behavior. Conversely, UAW-PCG shows the most erratic driv-
11
(1) (2)
(3) (4)
(a)
(1) (2)
(3) (4)
 (b)
(c)
 (d)
Fig. 4: Comparison of the interaction process and dynamic state evolution between the proposed model and real driving data for Case 1. (a) Interaction
simulation using the proposed model. (1) State at t = 0 s: vA V = 3.981 m/s, θ = -2.635 rad, aA V = 0 m/s 2 (2) State at t = 3.5 s: vA V = 3.144 m/s, θ = -2.630
rad, aA V = -0.057 m/s 2 (3) State at t = 9 s: vA V = 5.455 m/s, θ = -2.619 rad, aA V = 0.265 m/s 2 (4) State at t = 13.5 s: vA V = 6.0 m/s, θ = -2.601 rad, aA V
= 0 m/s 2. (b) Interaction process captured from real driving data. (1) State at t = 0 s: vveh = 3.981 m/s, θ = -2.635 rad, aveh = 0 m/s². (2) State at t = 3.5 s:
vveh = 3.578 m/s, θ = -2.601 rad, aveh = -0.903 m/s 2. (3) State at t = 9 s: vveh = 0.266 m/s, θ = -2.597 rad, aveh = -0.281 m/s 2. (4) State at t = 27 s: vveh
= 5.838 m/s, θ = -2.599 rad, aveh = 0 m/s 2. (c) Evolution of A V states predicted by the proposed model. (d) Evolution of vehicle states recorded from real
driving data.
TABLE II: Quantitative comparison results of our proposed A V model against other approaches and human driving data.
Model Success Collision Time out Average vehicle speed (m/s) Average vehicle jerk (m/s 3) Average maximum absolute
acceleration/deceleration (m/s2)
UAW-PCG [10] 0.83 0.17 0 4.137 1.249 3.737
G-SAC-NoCog 0.83 0.11 0.06 4.035 0.544 1.664
S-SAC 0.78 0.22 0 4.312 0.448 1.560
G-SAC-Cog(Ours) 0.94 0.06 0 4.470 0.524 1.621
Human driver 1 0 0 2.924 0.609 4.240
ing style, with an average vehicle jerk of 1.249 m/s 3. This
instability likely stems from directly controlling vehicle speed,
which forces the vehicle to make sudden and large acceleration
or deceleration adjustments to match target speeds, resulting
in frequent and abrupt speed variations. Our proposed model,
which employs acceleration as the control action, achieves a
well-balanced performance. Although its average jerk (0.524
m/s3) is not the lowest, it reflects necessary adjustments for
effective pedestrian avoidance and remains lower than that of
the human driver (0.609 m/s 3), successfully balancing safety
and comfort. When considering maximum absolute accelera-
tion or deceleration, all A V models display substantially lower
peaks compared to the human driver (4.240 m/s 2), indicat-
ing smoother control policies acquired through reinforcement
learning. Notably, UAW-PCG shows a significantly elevated
average maximum acceleration (3.737 m/s 2), again reflecting
instability from using velocity as the direct action variable.
In conclusion, these findings demonstrate that our proposed
model achieves a superior balance between efficiency, safety,
and driving comfort compared to existing methods.
VII. C ONCLUSION
This paper presents an innovative strategy to address A V
decision-making challenges in shared urban spaces with mul-
tiple pedestrians. A cognitive uncertainty modeling approach
inspired by the Free Energy Principle is introduced to emulate
human reasoning and quantify cognitive uncertainty during so-
cial interactions. This cognitive modeling is integrated into the
pedestrian social force model, enabling adaptive adjustment
of goal-directed and repulsive forces by combining cognitive
uncertainty with physical risk, which leads to more realis-
tic pedestrian trajectories. Additionally, the same cognitive
process guides the A V’s decision-making, where the fused
measure of cognitive uncertainty and physical risk defines a
dynamic, risk-aware adjacency matrix for the GCN within the
12
(1) (2)
(3) (4)
(a)
(1) (2)
(3) (4)
 (b)
(c)
 (d)
Fig. 5: Comparison of the interaction process and dynamic state evolution between the proposed model and real driving data for Case 2. (a) Interaction
simulation using the proposed model. (1) State at t = 0 s: vA V = 2.796 m/s, θ = 0.778 rad, aA V = 0 m/s 2 (2) State at t = 6.5 s: vA V = 3.708 m/s, θ = 0.591
rad, aA V= -0.097 m/s 2 (3) State at t = 11 s: vA V= 6.0 m/s, θ = 0.544 rad, aA V= 0 m/s 2 (4) State at t = 15 s: vA V= 5.958 m/s, θ = 0.536 rad, aA V= -0.083
m/s2. (b) Interaction process captured from real driving data. (1) State at t = 0 s: vveh = 2.796 m/s, θ = 0.778 rad, aveh = 0 m/s 2. (2) State at t = 6.5 s: vveh
= 3.802 m/s, θ = 0.564 rad, aveh = -0.024 m/s 2. (3) State at t = 11 s: vveh = 4.454 m/s, θ = 0.531 rad, aveh = -0.317 m/s 2. (4) State at t = 17.5 s: vveh =
3.972 m/s, θ = 0.557 rad, aveh = 0.181 m/s 2. (c) Evolution of A V states predicted by the proposed model. (d) Evolution of vehicle states recorded from real
driving data.
SAC architecture, allowing the A V to perceive complex social
dynamics and make human-like decisions.
Simulation results demonstrate that the proposed strategy
significantly improves A V performance compared to the ex-
isting method, achieving safer, more efficient, and smoother
behavior during interactions with pedestrians. Although the
model shows promising results, the current research is limited
to scenarios with a fixed number of pedestrians, which may not
fully capture the variability of real-world urban environments.
In the future, we plan to extend our strategy to handle scenarios
with dynamically changing numbers of pedestrians, enabling
the A V to adapt its strategy in real time as pedestrians enter
or leave the scene.
REFERENCES
[1] M. M. Rahman and J.-C. Thill, “Impacts of connected and autonomous
vehicles on urban transportation and environment: A comprehensive
review,” Sustainable Cities and Society , vol. 96, p. 104649, 2023.
[2] R. A. Khalil, Z. Safelnasr, N. Yemane, M. Kedir, A. Shafiqurrahman, and
N. Saeed, “Advanced learning technologies for intelligent transportation
systems: Prospects and challenges,” IEEE Open Journal of Vehicular
Technology, 2024.
[3] S. Rezwana and N. Lownes, “Interactions and behaviors of pedestrians
with autonomous vehicles: A synthesis,” Future Transportation, vol. 4,
no. 3, pp. 722–745, 2024.
[4] Y . Feng, Z. Xu, H. Farah, and B. Van Arem, “Does another pedestrian
matter? a virtual reality study on the interaction between multiple pedes-
trians and autonomous vehicles in shared space,” IEEE Transactions on
Intelligent Transportation Systems, 2024.
[5] K. Tian, G. Markkula, C. Wei, Y . M. Lee, R. Madigan, T. Hirose,
N. Merat, and R. Romano, “Deconstructing pedestrian crossing decisions
in interactions with continuous traffic: An anthropomorphic model,”
IEEE Transactions on Intelligent Transportation Systems, vol. 25, no. 3,
pp. 2466–2478, 2023.
[6] K. Ryu and N. Mehr, “Integrating predictive motion uncertainties with
distributionally robust risk-aware control for safe robot navigation in
crowds,” in 2024 IEEE International Conference on Robotics and
Automation (ICRA). IEEE, 2024, pp. 2410–2417.
[7] S. Samavi, J. R. Han, F. Shkurti, and A. P. Schoellig, “Sicnav: Safe and
interactive crowd navigation using model predictive control and bilevel
optimization,” IEEE Transactions on Robotics , 2024.
[8] S. Neupane, S. Mitra, I. Fernandez, S. Saha, S. Mittal, J. Chen, N. Pillai,
and S. Rahimi, “Security considerations in ai-robotics: A survey of
current methods,” Challenges, and Opportunities , 2023.
[9] C. Sch ¨oller, V . Aravantinos, F. Lay, and A. Knoll, “What the constant
velocity model can teach us about pedestrian motion prediction,” IEEE
Robotics and Automation Letters , vol. 5, no. 2, pp. 1696–1703, 2020.
[10] M. Golchoubian, M. Ghafurian, K. Dautenhahn, and N. L. Azad,
“Uncertainty-aware drl for autonomous vehicle crowd navigation in
shared space,” IEEE Transactions on Intelligent Vehicles , 2024.
[11] M. Kabtoul, A. Spalanzani, and P. Martinet, “Towards proactive naviga-
tion: A pedestrian-vehicle cooperation based behavioral model,” in 2020
IEEE International Conference on Robotics and Automation (ICRA) .
IEEE, 2020, pp. 6958–6964.
[12] K. Li, Y . Chen, M. Shan, J. Li, S. Worrall, and E. Nebot, “Game theory-
based simultaneous prediction and planning for autonomous vehicle
navigation in crowded environments,” in 2023 IEEE 26th International
Conference on Intelligent Transportation Systems (ITSC) . IEEE, 2023,
pp. 2977–2984.
[13] J. Van Den Berg, S. J. Guy, M. Lin, and D. Manocha, “Reciprocal n-
body collision avoidance,” in Robotics Research: The 14th International
Symposium ISRR. Springer, 2011, pp. 3–19.
[14] C. Chen, Y . Liu, S. Kreiss, and A. Alahi, “Crowd-robot interaction:
Crowd-aware robot navigation with attention-based deep reinforcement
13
learning,” in 2019 international conference on robotics and automation
(ICRA). IEEE, 2019, pp. 6015–6022.
[15] D. Helbing and P. Molnar, “Social force model for pedestrian dynamics,”
Physical review E , vol. 51, no. 5, p. 4282, 1995.
[16] M. M. Rashid, M. Seyedi, and S. Jung, “Simulation of pedestrian
interaction with autonomous vehicles via social force model,”Simulation
modelling practice and theory , vol. 132, p. 102901, 2024.
[17] M. Kabtoul, M. Pr ´edhumeau, A. Spalanzani, J. Dugdale, and P. Mar-
tinet, “How to evaluate the navigation of autonomous vehicles around
pedestrians?” IEEE Transactions on Intelligent Transportation Systems ,
vol. 25, no. 3, pp. 2311–2321, 2023.
[18] V . V . Unhelkar, C. P´erez-D’Arpino, L. Stirling, and J. A. Shah, “Human-
robot co-navigation using anticipatory indicators of human walking
motion,” in 2015 IEEE International Conference on Robotics and
Automation (ICRA). IEEE, 2015, pp. 6183–6190.
[19] P. Trautman, J. Ma, R. M. Murray, and A. Krause, “Robot navigation
in dense human crowds: Statistical models and experimental studies
of human–robot cooperation,” The International Journal of Robotics
Research, vol. 34, no. 3, pp. 335–356, 2015.
[20] J. Godoy, I. Karamouzas, S. J. Guy, and M. L. Gini, “Moving in a
crowd: Safe and efficient navigation among heterogeneous agents.” in
IJCAI, 2016, pp. 294–300.
[21] M. Sun, F. Baldini, P. Trautman, and T. Murphey, “Move beyond
trajectories: Distribution space coupling for crowd navigation,” arXiv
preprint arXiv:2106.13667, 2021.
[22] H. Fu, Q. Wang, and H. He, “Path-following navigation in crowds with
deep reinforcement learning,” IEEE Internet of Things Journal , 2024.
[23] T. Ma, Z. Liu, T. Liu, Y . Zhao, and Y . Chai, “A spatiotemporal graphical
attention navigation algorithm based on limited state information,” IEEE
Transactions on Computational Social Systems , 2024.
[24] M. Everett, Y . F. Chen, and J. P. How, “Motion planning among dynamic,
decision-making agents with deep reinforcement learning,” in 2018
IEEE/RSJ International Conference on Intelligent Robots and Systems
(IROS). IEEE, 2018, pp. 3052–3059.
[25] X. Lu, A. Faragasso, Y . Wang, A. Yamashita, and H. Asama, “Group-
aware robot navigation in crowds using spatio-temporal graph attention
network with deep reinforcement learning,” IEEE Robotics and Automa-
tion Letters, 2025.
[26] X. Zhou, S. Piao, W. Chi, L. Chen, and W. Li, “Her-drl: Heterogeneous
relational deep reinforcement learning for single-robot and multi-robot
crowd navigation,” IEEE Robotics and Automation Letters , 2025.
[27] Y . Cui, S. Ye, X. Xu, H. Sha, C. Wang, L. Lin, Z. Liu, R. Xiong, and
Y . Wang, “Learning hierarchical graph-based policy for goal-reaching in
unknown environments,” IEEE Robotics and Automation Letters , 2024.
[28] L. Dong, Z. He, C. Song, X. Yuan, and H. Zhang, “Multi-robot social-
aware cooperative planning in pedestrian environments using attention-
based actor-critic,” Artificial Intelligence Review, vol. 57, no. 4, p. 108,
2024.
[29] W. Shi, Y . Zhou, X. Zeng, S. Li, and M. Bennewitz, “Enhanced spatial
attention graph for motion planning in crowded, partially observable
environments,” in 2022 International Conference on Robotics and Au-
tomation (ICRA). IEEE, 2022, pp. 4750–4756.
[30] Y . Zhou and J. Garcke, “Learning crowd behaviors in navigation with
attention-based spatial-temporal graphs,” in 2024 IEEE International
Conference on Robotics and Automation (ICRA) . IEEE, 2024, pp.
5485–5491.
[31] J. Y . Angela and P. Dayan, “Uncertainty, neuromodulation, and atten-
tion,” Neuron, vol. 46, no. 4, pp. 681–692, 2005.
[32] B. Enke and T. Graeber, “Cognitive uncertainty,” The Quarterly Journal
of Economics, vol. 138, no. 4, pp. 2021–2067, 2023.
[33] A. Pouget, J. Drugowitsch, and A. Kepecs, “Confidence and certainty:
distinct probabilistic quantities for different goals,” Nature neuroscience,
vol. 19, no. 3, pp. 366–374, 2016.
[34] Z. Zhang and F. Xu, “An overview of the free energy principle and
related research,” Neural Computation , vol. 36, no. 5, pp. 963–1021,
2024.
[35] K. Friston, “The free-energy principle: a unified brain theory?” Nature
reviews neuroscience, vol. 11, no. 2, pp. 127–138, 2010.
[36] M. Walters, R. Kaufmann, J. Sefas, and T. Kopinski, “Free energy risk
metrics for systemically safe ai: Gatekeeping multi-agent study,” arXiv
preprint arXiv:2502.04249, 2025.
[37] T. Van de Maele, T. Verbelen, O. C ¸ atal, C. De Boom, and B. Dhoedt,
“Active vision for robot manipulators using the free energy principle,”
Frontiers in neurorobotics, vol. 15, p. 642780, 2021.
[38] D. Helbing and P. Molnar, “Social force model for pedestrian dynamics,”
Physical review E , vol. 51, no. 5, p. 4282, 1995.
[39] L. Crosato, H. P. Shum, E. S. Ho, and C. Wei, “Interaction-aware
decision-making for automated vehicles using social value orientation,”
IEEE Transactions on Intelligent Vehicles, vol. 8, no. 2, pp. 1339–1349,
2022.
[40] M. Dang, Y . Jin, P. Hang, L. Crosato, Y . Sun, and C. Wei, “Coupling
intention and actions of vehicle–pedestrian interaction: A virtual reality
experiment study,” Accident Analysis & Prevention, vol. 203, p. 107639,
2024.
[41] T. Haarnoja, A. Zhou, P. Abbeel, and S. Levine, “Soft actor-critic: Off-
policy maximum entropy deep reinforcement learning with a stochastic
actor,” in International conference on machine learning . Pmlr, 2018,
pp. 1861–1870.
[42] B. Jiang, Z. Zhang, D. Lin, J. Tang, and B. Luo, “Semi-supervised
learning with graph learning-convolutional networks,” in Proceedings of
the IEEE/CVF conference on computer vision and pattern recognition ,
2019, pp. 11 313–11 320.
[43] F. Pascucci, N. Rinke, C. Schiermeyer, V . Berkhahn, and B. Friedrich, “A
discrete choice model for solving conflict situations between pedestrians
and vehicles in shared space,” arXiv preprint arXiv:1709.09412 , 2017.
[44] N. Uhlemann, F. Fent, and M. Lienkamp, “Evaluating pedestrian tra-
jectory prediction methods with respect to autonomous driving,” IEEE
Transactions on Intelligent Transportation Systems , 2024.
[45] M. Dang, D. Zhao, Y . Wang, and C. Wei, “Dynamic game-theoretical
decision-making framework for vehicle-pedestrian interaction with hu-
man bounded rationality,” IEEE Transactions on Intelligent Transporta-
tion Systems, 2025.
Meiting Dang received the B.S. and the M.S.
degrees from Chang’an University, China, in 2017
and 2020, respectively. She is currently working
toward the Ph.D. degree in James Watt School of
Engineering with University of Glasgow, U.K. Her
research interests include decision-making and plan-
ning of autonomous vehicles, autonomous vehicle-
pedestrian interaction modeling based on game the-
ory, and machine learning.
Yanping Wu received her B.S. degree from South-
west Jiaotong University, Chengdu, China, in 2017,
and her M.S. degree in 2020. From 2020 to 2023, she
worked as a Machine Learning Engineer at China
Merchants Bank. She is currently pursuing a Ph.D.
degree in Electronics and Electrical Engineering at
the University of Glasgow. Her research interests in-
clude autonomous driving and artificial intelligence.
Yafei Wang (Member, IEEE) received the B.S.
degree in internal combustion engine from Jilin
University, Changchun, China, in 2005, the M.S.
degree in vehicle engineering from Shanghai Jiao
Tong University, Shanghai, China, in 2008, and the
Ph.D. degree in electrical engineering from The
University of Tokyo, Tokyo, Japan, in 2013. From
2008 to 2010, he was with automotive industry
for nearly two years. From 2013 to 2016, he was
a Postdoctoral Researcher with The University of
Tokyo. He is currently a Professor of automotive
engineering with the School of Mechanical Engineering, Shanghai Jiao Tong
University. His research interests include state estimation and control for
connected and automated vehicles.
14
Dezong Zhao (Senior Member, IEEE) received the
B.Eng. and M.S. degrees in control science and
engineering from Shandong University, Jinan, China,
in 2003 and 2006, respectively, and the Ph.D. degree
in control science and engineering from Tsinghua
University, Beijing, China, in 2010. He is currently
a Senior Lecturer in autonomous systems with the
School of Engineering,University of Glasgow, Glas-
gow, U.K. His research interests include connected
and autonomous vehicles, machine learning, and
control engineering. His work has been recognized
by being awarded an EPSRC Innovation Fellowship and a Royal SocietyNew-
ton Advanced Fellowship in 2018 and 2020, respectively.
David Flynn (Senior Member, IEEE) is a Professor
of Cyber Physical Systems (CPS) at the University
of Glasgow, and Head of Research Division (HoRD)
for Autonomous Systems and Connectivity within
the James Watt School of Engineering. He has ex-
pertise in systems engineering, data analysis, digital
twinning and digital technologies. He is an Honorary
Professor of Heriot-Watt University, Fellow of the
Royal Society of Edinburgh (FRSE), Fellow of the
Institution of Engineers in Scotland (FIES,) and
Fellow of the Royal Society for the Encouragement
of Arts, Manufactures and Commerce (FRSA). He is the co-founder of the
UKs EPSRC National Digital Twinning Hub (TransiT). His degrees include
a BEng (Hons), 1st Class in Electrical and Electronic Engineering (2002), an
MSc (Distinction) in Microsystems (2003) and a PhD in Microscale Magnetic
Components (2007), from Heriot-Watt University, Edinburgh.
Chongfeng Wei (Senior Member, IEEE) received
his Ph.D. degree in mechanical engineering from the
University of Birmingham in 2015. He is now a Se-
nior Lecturer (Associate Professor) at University of
Glasgow, UK. His current research interests include
decision-making and control of intelligent vehicles,
human-centric autonomous driving, cooperative au-
tomation, and dynamics and control of mechanical
systems. He is also serving as an Associate Editor
of IEEE TITS, IEEE TIV , IEEE TVT, and Frontier
on Robotics and AI.