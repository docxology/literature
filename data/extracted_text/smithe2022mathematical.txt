Mathematical Foundations for a
Compositional Account of the
Bayesian Brain
Toby St Clere Smithe
StEdmundHall
UniversityofOxford
Athesissubmittedforthedegreeof
DoctorofPhilosophy
Trinity2023
3202
ceD
91
]CN.oib-q[
3v83521.2122:viXra
Acknowledgements
ThisthesiswouldnotexistinanythinglikethisformwithoutthemarvellousApplied
CategoryTheory community,amorewelcomingandthoughtfulgroupofresearchers
onecouldnotwishtofind. Thiscommunitymakesaseriousandthoroughgoingeffort
tobeinclusiveandoutward-looking,anditwasinthisspiritthattheysetuptheApplied
CategoryTheoryAdjointSchool,whichIattendedin2019,andtowhichIrecommend
anycategory-theory-curiousthinkertoapply. Withoutthatexperience,andthegroup
offriendsImadethere,noneofthiswouldhavebeenpossible.
Before I attended the Adjoint School, I was trying to understand too much about
the brain, and seeking a mathematically coherent unifying framework with which
I could organize my thoughts. In Oxford, I was a member of the Department of
ExperimentalPsychology,buthadbecomeawareoftheworkbeingdoneoncognition
andlinguisticsintheQuantumGroup,intheDepartmentofComputerScience,and
soIbeganattendinglecturesandhangingaroundthere. ItwastherethatIattended
the Open Games workshop in 2018, at which I realized that predictive coding and
opengameshadthesameabstractstructure;afactthattookmelongerthanitshould
have to formalize, but about which I started telling anyone who listened. The first
individualswhotookmeseriouslywereJulesHedgesandBrendanFong,andIthank
themheartilyfortheirencouragementandassistance:itwasafterdiscussionwithJules
(andBrunoGavranović)attheSixthSymposiumonCompositionalStructures(SYCO
6, in Leicester) that I proved abstractly that “Bayesian updates compose optically”;
and it was Brendan Fong who let me know about the Adjoint School, at which we
(Brendan,Bruno,DavidSpivak,DavidJazMyers,andSophieLibkind,aswellasothers
occasionally,includingJules,ElianaLorch,anddavidad)discussedautopoiesisfroma
categoricalperspective.
Afterthesemeetings,andthroughmyQuantumGroupinteractions,Iacquiredsome
funding from the Foundational Questions Institute to concentrate on the category
theoryofpredictivecodingandapproximateinference,whichwasdistributedthrough
the Topos Institute. I thank everyone who made these interactions possible and
delightful,including(innoparticularorder)thefollowingindividualsthatIhavenot
yetnamed: SamsonAbramsky;BobCoecke;JohannesKleiner;TimHosgood;Owen
Lynch;ValeriadePaiva;EvanPatterson;SamStaton;JulietSzatko;TishTanski;Sean
Tull;andVincentWang-Maścianica.
OutsideofOxford,Ihavebeenfortunatetobepartofsomewonderfulinteractions
through the Active Inference and Strathclyde MSP (Mathematically Structured
Programming)communities. IfirstspokeaboutcategoricalactiveinferencetoKarl
Friston’s group in March 2020, shortly after my first visit to Glasgow at the end of
2019;andIfoundGlasgowsoappealingthatInowfindmyselflivingthere. Forthese
interactions,besidesthosenamedabove,Imustrecognize: DylanBraithwaite;Matteo
Capucci; LancedaCosta; NeilGhani; MaxwellRamstead; RiuRodríguezSakamoto;
andDaltonSakthivadivel.
I would not have had the opportunity to pursue this research at all had I not been
grantedapositionintheOxfordExperimentalPsychologydepartment,whereIhave
been a member of the Oxford Centre for Theoretical Neuroscience and Artificial
Intelligence(OCTNAI),underthedirectionofSimonStringer. IthankSimonforhis
patienceandlatitude,particularlywhenmyplanswerenotquiteashewouldhave
expected, and I thank my Oxford co-supervisor (and present director of graduate
studies),MarkBuckley,andmypreviousdirectorofgraduatestudies,BrianParkinson,
fortheiralwaysexcellentadvice.ThanksalsototheotherstudentmembersofOCTNAI
(particularlyDan,Hannah,Harry,James,Nas,andNiels)forbeingsowelcomingto
an oddball such as myself. And at this point, it would be remiss not to thank also
theadministrativestaffoftheDepartment,andmycollege,StEdmundHall,whoare
alwayshelpfulandwise;inparticular,RebeccaCardusandVincaBoorman,whohave
guidedmethroughmuchofOxford’sstrangebureaucracy.
Finally,andmostofall,Ithankmyfamilyandmybelovedwife,Linda,whoinparticular
hassufferedthroughthislongjourneywithmewithbeyond-infinitepatience,love,and
understanding(somuchpatience,infact,thatshehumouredthecategory-theoretic
contentofmyweddingspeech!). Thankyou,toyouall. Ittakesavillage!
3
Abstract
This dissertation reports some first steps towards a compositional account of active inference
andtheBayesianbrain. Specifically,weusethetoolsofcontemporaryappliedcategorytheory
to supply functorial semantics for approximate inference. To do so, we define on the ‘syntactic’
sidethenewnotionofBayesianlensandshowthatBayesianupdatingcomposesaccordingtothe
compositionallenspattern. UsingBayesianlenses,andinspiredbycompositionalgametheory,
wedefinefibrationsofstatisticalgames andclassifyvariousproblemsofstatisticalinferenceas
correspondingsections: thechainruleoftherelativeentropyisformalizedasastrictsection,while
maximumlikelihoodestimationandthefreeenergygivelaxsections. Intheprocess,weintroduce
anewnotionof‘copy-composition’.
On the ‘semantic’ side, we present a new formalization of general open dynamical systems
(particularly: deterministic,stochastic,andrandom;anddiscrete-andcontinuous-time)ascertain
coalgebrasofpolynomialfunctors,whichweshowcollectintomonoidalopindexedcategories(or,
alternatively,intoalgebrasformulticategoriesofgeneralizedpolynomialfunctors). Weusethese
opindexedcategoriestodefinemonoidalbicategoriesofcilia: dynamicalsystemswhichcontrol
lenses,andwhichsupplythetargetforourfunctorialsemantics. Accordingly,weconstructfunctors
whichexplainthebidirectionalcompositionalstructureofpredictivecodingneuralcircuitsunder
thefreeenergyprinciple,therebygivingaformalmathematicalunderpinningtothebidirectionality
observed in the cortex. Along the way, we explain how to compose rate-coded neural circuits
usinganalgebraforamulticategoryoflinearcircuitdiagrams,showingsubsequentlythatthisis
subsumedbylensesandpolynomialfunctors.
Because category theory is unfamiliar to many computational neuroscientists and cognitive
scientists,wehavemadeaparticularefforttogiveclear,detailed,andapproachableexpositions
of all the category-theoretic structures and results of which we make use. We hope that this
dissertationwillprovehelpfulinestablishinganew“well-typed”scienceoflifeandmind,andin
facilitatinginterdisciplinarycommunication.
Contents
1. Introduction 1
1.1. Overviewofthedissertation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
1.2. Contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
2. Basiccategorytheoryforcomputationalandcognitive(neuro)scientists 11
2.1. Categories,graphs,andnetworks . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
2.1.1. Threeexamples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
2.1.1.1. Neuralcircuits: dynamicalnetworksofneurons . . . . . . . . . 12
2.1.1.2. Bayesiannetworks: beliefanddependence . . . . . . . . . . . . 12
2.1.1.3. Computations: setsandfunctions . . . . . . . . . . . . . . . . . 13
2.1.2. Fromgraphstocategories . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
2.1.2.1. Diagramsinacategory,functorially . . . . . . . . . . . . . . . . 19
2.2. Connectingtheconnections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
2.2.1. Enrichedcategories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
2.2.2. 2-categories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
2.2.3. Onfunctorialsemantics . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
2.2.4. Adjunctionandequivalence . . . . . . . . . . . . . . . . . . . . . . . . . . 34
2.3. Universalconstructions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
2.3.1. Theuniversalityofcommonpatterns . . . . . . . . . . . . . . . . . . . . . 41
2.3.1.1. Disjunctions,orcoproducts . . . . . . . . . . . . . . . . . . . . 41
2.3.1.2. Conjunctions,products,andsections . . . . . . . . . . . . . . . 43
2.3.1.3. Subobjectsandequalizers. . . . . . . . . . . . . . . . . . . . . . 45
2.3.1.4. Coequalizersandquotients . . . . . . . . . . . . . . . . . . . . . 47
2.3.2. Thepatternofuniversality. . . . . . . . . . . . . . . . . . . . . . . . . . . 47
2.3.3. Limitsandcolimits: mappingintoandoutofdiagrams . . . . . . . . . . . 51
2.3.3.1. Functorialityoftakinglimits . . . . . . . . . . . . . . . . . . . . 54
2.3.3.2. (Co)limitsasadjoints . . . . . . . . . . . . . . . . . . . . . . . . 55
i
2.3.3.3. Hompreserveslimits . . . . . . . . . . . . . . . . . . . . . . . . 56
2.3.4. Closedcategoriesandexponentialobjects . . . . . . . . . . . . . . . . . . 59
2.3.4.1. Dependentproducts . . . . . . . . . . . . . . . . . . . . . . . . . 62
2.4. TheYonedaLemma: ahumanperspective. . . . . . . . . . . . . . . . . . . . . . . 63
2.4.1. FormalizingcategoricalreasoningviatheYonedaembedding . . . . . . . 64
2.4.2. Knowingathingbyitsrelationships . . . . . . . . . . . . . . . . . . . . . 65
3. Algebraicconnectomics 73
3.1. Categoriesandcalculiforprocesstheories . . . . . . . . . . . . . . . . . . . . . . 74
3.1.1. Stringdiagrams . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74
3.1.2. Monoidalcategories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77
3.1.3. Closedmonoidalcategories . . . . . . . . . . . . . . . . . . . . . . . . . . 82
3.1.4. Bicategories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84
3.2. Parameterizedsystems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87
3.2.1. Internalparameterization . . . . . . . . . . . . . . . . . . . . . . . . . . . 87
3.2.2. Externalparameterization . . . . . . . . . . . . . . . . . . . . . . . . . . . 90
3.3. Systemsfromcircuits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92
3.3.1. Multicategoricalalgebraforhierarchicalsystems . . . . . . . . . . . . . . 94
3.3.2. Linearcircuitdiagrams . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96
3.3.3. Analgebraofrate-codedneuralcircuits . . . . . . . . . . . . . . . . . . . 98
3.4. Frommonoidstomonads . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107
3.4.1. Comonoids . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114
3.5. Polynomialfunctors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117
4. ThecompositionalstructureofBayesianinference 122
4.1. Compositionalprobability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123
4.1.1. Discreteprobability,algebraically . . . . . . . . . . . . . . . . . . . . . . . 125
4.1.1.1. Stochasticmatrices . . . . . . . . . . . . . . . . . . . . . . . . . 129
4.1.1.2. Monoidalstructure . . . . . . . . . . . . . . . . . . . . . . . . . 130
4.1.1.3. Copy-discardstructure . . . . . . . . . . . . . . . . . . . . . . . 131
4.1.1.4. Bayesianinversion . . . . . . . . . . . . . . . . . . . . . . . . . 132
4.1.2. AbstractBayesianinversion . . . . . . . . . . . . . . . . . . . . . . . . . . 133
4.1.3. Densityfunctions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134
ii
4.1.4. S-finitekernels . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139
4.1.5. Onprobabilitymonads . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141
4.2. Dependentdataandbidirectionalprocesses . . . . . . . . . . . . . . . . . . . . . . 144
4.2.1. IndexedcategoriesandtheGrothendieckconstruction . . . . . . . . . . . 144
4.2.1.1. ThemonoidalGrothendieckconstruction . . . . . . . . . . . . . 151
4.2.2. Grothendiecklenses . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153
4.2.2.1. Monoidalcategoriesoflenses . . . . . . . . . . . . . . . . . . . 158
4.3. ThebidirectionalstructureofBayesianupdating . . . . . . . . . . . . . . . . . . . 159
4.3.1. State-dependentchannels . . . . . . . . . . . . . . . . . . . . . . . . . . . 160
4.3.2. Bayesianlenses . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 162
4.3.3. Bayesianupdatescomposeoptically . . . . . . . . . . . . . . . . . . . . . 164
4.3.4. LawfulnessofBayesianlenses . . . . . . . . . . . . . . . . . . . . . . . . . 167
5. Statisticalgames 171
5.1. Compositionalapproximateinference,viathechainruleforrelativeentropy . . . 171
5.2. ‘Copy-composite’Bayesianlenses . . . . . . . . . . . . . . . . . . . . . . . . . . . 173
5.2.1. Copy-compositionbycoparameterization . . . . . . . . . . . . . . . . . . 173
5.2.2. Laxfunctors,pseudofunctors,theirtransformations,andindexedbicategories181
5.2.3. CoparameterizedBayesianlenses . . . . . . . . . . . . . . . . . . . . . . . 184
5.2.4. CoparameterizedBayesianupdatescomposeoptically . . . . . . . . . . . 187
5.3. Statisticalgamesforlocalapproximateinference . . . . . . . . . . . . . . . . . . . 191
5.3.1. Attachinglossestolenses . . . . . . . . . . . . . . . . . . . . . . . . . . . 191
5.3.2. Inferencesystemsandlossmodels . . . . . . . . . . . . . . . . . . . . . . 197
5.3.3. Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 199
5.3.3.1. RelativeentropyandBayesianinference . . . . . . . . . . . . . 199
5.3.3.2. Maximumlikelihoodestimation . . . . . . . . . . . . . . . . . . 201
5.3.3.3. Autoencodersviathefreeenergy . . . . . . . . . . . . . . . . . 202
5.3.3.4. TheLaplaceapproximation . . . . . . . . . . . . . . . . . . . . . 204
5.4. Monoidalstatisticalgames . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 210
5.4.1. Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 217
5.4.1.1. Relativeentropy . . . . . . . . . . . . . . . . . . . . . . . . . . . 218
5.4.1.2. Maximumlikelihoodestimation . . . . . . . . . . . . . . . . . . 220
5.4.1.3. Freeenergy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 221
iii
5.4.1.4. Laplacianfreeenergy . . . . . . . . . . . . . . . . . . . . . . . . 221
5.5. Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 225
6. Opendynamicalsystems,coalgebraically 227
6.1. Categoricalbackgroundondynamicsandcoalgebra . . . . . . . . . . . . . . . . . 228
6.1.1. DynamicalsystemsandMarkovchains . . . . . . . . . . . . . . . . . . . . 228
6.1.2. Coalgebra . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 230
6.2. Opendynamicalsystemsonpolynomialinterfaces . . . . . . . . . . . . . . . . . . 232
6.2.1. Deterministicsystemsingeneraltime . . . . . . . . . . . . . . . . . . . . 232
6.2.2. Polynomialswith‘effectful’feedback,andopenMarkovprocesses . . . . 239
6.2.3. Openrandomdynamicalsystems . . . . . . . . . . . . . . . . . . . . . . . 242
6.3. Cilia: monoidalbicategoriesofcyberneticsystems . . . . . . . . . . . . . . . . . . 247
6.3.1. Hierarchicalbidirectionaldynamicalsystems . . . . . . . . . . . . . . . . 247
6.3.2. Differentialsystems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 254
7. Approximateinferencedoctrinesforpredictivecoding 261
7.1. ChannelswithGaussiannoise . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 262
7.2. ExternallyparameterizedBayesianlensesandstatisticalgames . . . . . . . . . . . 265
7.3. Approximateinferencedoctrines . . . . . . . . . . . . . . . . . . . . . . . . . . . . 272
7.3.1. PredictivecodingcircuitsandtheLaplacedoctrine . . . . . . . . . . . . . 274
7.3.2. SynapticplasticitywiththeHebb-Laplacedoctrine . . . . . . . . . . . . . 281
8. Futuredirections 284
8.1. Structuredworlds . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 285
8.1.1. Bayesiansensorfusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 285
8.1.2. Learningstructureandstructuredlearning. . . . . . . . . . . . . . . . . . 287
8.1.3. Compositionalcognitivecartography . . . . . . . . . . . . . . . . . . . . . 288
8.2. Societiesofsystems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 289
8.2.1. Activeinference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 290
8.2.2. Whatisthetypeofaplan? . . . . . . . . . . . . . . . . . . . . . . . . . . 291
8.2.3. Reinforcementlearning,opengames,andecosystems . . . . . . . . . . . 292
8.3. Themathematicsoflife . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 294
8.3.1. Bayesianmechanicsandthefreeenergyprinciple . . . . . . . . . . . . . . 294
8.3.2. Biosemiotics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 295
iv
8.4. Fundamentaltheory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 296
8.4.1. Geometricmethodsfor(structured)beliefupdating . . . . . . . . . . . . . 296
8.4.2. Dynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 297
8.4.3. Computation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 298
A. Auxiliarymaterial 299
A.1. Frommonadstomulticategories . . . . . . . . . . . . . . . . . . . . . . . . . . . . 299
B. Bibliography 304
v
1. Introduction
Theworkofwhichthisdissertationisareportbeganasaprojecttounderstandthebrain’s“cognitive
map”,itsinternalrepresentationofthestructureoftheworld. Littleofthatworkisreportedhere,
foritrapidlybecameclearattheoutsetthattherewasnocoherentframeworkinwhichsucha
projectshouldmostprofitablybeundertaken. Thisisnottosaythatnoprogressonunderstanding
thecognitivemapcanbemade,aclaimwhichwouldbeeasilycontradictedbytheevidence. Rather,
each research group has its own language and its own research questions, and it is not always
evident how to translate concepts from one group, or even one moment in time, faithfully to
another;whattranslationisdoneisperformedatbesthighlyinformally.
Iftheaimofscience1 istotelljust-sostories,oriftheaimisonlytoanswerone’sownresearch
questionsinisolation,thenthisstateofaffairsmaybeperfectlysatisfactory. Butthebrainandthe
behavioursthatbrainsproducearesomarvellousandsocomplex,andtheimplicationsofafiner
understandingsomonumental,thatonecannotbuthopethatsciencecoulddobetter. Ofcourse,of
late,sciencehasnotbeendoingbetter,withdisciplinesassociallyimportantaspsychology[201]
and medicine [23, 135, 188] and machine learning [134, 149] struck by crises of reproducibility.
Atthesametime,asbroadbandinternethasspreadacrosstheglobe,thesheeramountofoutput
producedbyscientistsandotherresearchershasballooned,contributingtotheimpossibilityof
verificationandtheaforementionedtranslationaldifficulties,atleastifonedesirestodootherthan
simplyfollowingtheherd. Insomesense,althoughscientistsallnowspeakEnglish,sciencestill
lacksalinguafranca,oratleastasufficientlypreciseone.
As luck would have it, while mainstream science has been suffering from this loss of faith,
thefirstphrasesofapotentiallyadequateprecisenewlanguagehavebeguntospread,withthe
coalescenceofanewcommunityofresearchersinappliedcategorytheory 2. Onepartofthepresent
1Orindeed,“iftheaimofscientists”,asscienceitselfmaynothavevolitionofitsown.
2Thefirstmajorinterdisciplinarymeetingofappliedcategorytheorists(oratleastthefirstmeetingsufficientlyconfident
totakeAppliedCategoryTheoryasitsname)washeldin2018inLeiden,althoughcategoricalmethodshavefor
sometimebeenusedincomputerscience[210]andphysics[16],andespeciallyattheirnexus[2,68,69]. More
sporadically,categorytheoryhadshownupelsewhere,suchasinbiology[86,220],networktheory[93–95],game
theory[3,89,119],cognitivescience[37,85,183,209]andlinguistics[67,70,130],andin2014aworkshopwasheld
atDagstuhlbringingtogethersomeoftheseresearchers[4],inwhatwastobeaprecursortotheAppliedCategory
1
difficultyofscientifictranslationisthateachresearchgrouphasnotonlyitsownlanguage,but
alsoitsownperspective;andanotherpartofthedifficultyisthattheselanguagesandperspectives
arenotwellconnected,withtheEnglishlanguageaverylossymediumthroughwhichtomake
theseconnections. Fortunately,thelanguageofcategorytheory—beingamathematicalratherthan
anaturallanguage—resolvesbothofthesedifficulties.
Categorytheoryisthemathematics ofpattern, composition, connection, andinteraction; its
conceptsareascrispandclearasthewaterofamountainpool;itssimplicitylendsitgreatpower.
Categoriesdescribehowobjectscanbeconstructedfromparts,andsuchcompositionaldescriptions
extendtocategoriesthemselves: asaresult,thelanguageofcategorytheoryis‘homoiconic’,and
canbeusedtotranslateconstructionsbetweencontexts.Oneisabletoabstractawayfromirrelevant
details,andshowpreciselyhowstructuresgiverisetophenomena;andbychoosingtheabstractions
carefully,itbecomespossibletoseethat,sometimes,importantconstructionsare‘universal’,able
tobeperformedinanyrelevantcontext. Asaresult,categorytheoryresolvesbothproblemsof
scientifictranslationindicatedabove: conceptsexpressedcategoricallyareinevitablyexpressedin
context,andnotinisolation;andthesecontextsarenaturallyinterconnectedasifbyacategorical
web(withtheconnectionsalsoexpressedcategorically). Moreover,notbeingEnglish,categorical
definitionstendtobeextremelyconciseandinformation-dense;andsincethebasicconceptsof
category theory are themselves simple, concepts so expressed are not biased by geography or
geopolitics.
Fromthemiddleofthe20thcentury,theconceptsofcategorytheorybegantorevolutionizemuch
ofmathematics3,andappliedcategorytheoristssuchasthepresentauthorbelievethatthetimeis
nighforthisrevolutiontospreadthroughoutthesciencesandalleviatesomeoftheirstruggles.
Just as the internet constitutes physical infrastructure that fundamentally accelerates human
communications, we expect category theory to constitute conceptual infrastructure of similar
catalyticconsequence. Thisthesisisacontributiontobuildingthisinfrastructure,inthespecific
domainofcomputationalneuroscienceandthegeneraldomainof(whatwasonce,andwillbeagain,
called)cybernetics4. Inparticular,weshowthataprominenttheoryofbrainfunction—predictive
Theorymeetings;manyofthoseresearchersstillworkinthisnewinterdisciplinaryfield.
3ThebasicconceptsofcategorytheorywereoriginallywrittendownbyEilenbergandMacLaneinordertoformalize
processesoftranslation,andsoclarifystructuresinthewaysindicatedinthemaintextabove,inthefieldofalgebraic
topology.Thisoccurredattheendofthefirsthalfofthe20thcentury,in1945[87].Theideassoonspreadbeyond
algebraictopology,gatheringmomentumrapidlyfromthe1950s,inwhichCartandefinedtheconceptofsheaf[56,
57]andGrothendieckreconceivedthefoundationsofalgebraicgeometry[121].Bythemid-1960s,andespecially
throughtheworkofLawvereonlogic[165]andsettheory[166],itwasclearthatcategorytheorywouldbeableto
supplysupplebutsturdynewfoundationsforallofmathematics.
4Owingtoitsaffinityforpatternandabstraction,itishardtodointerestingdomain-specificworkincategorytheory
withouttherebeingatleastsomemoregeneralresultstobefound,andindeedthisisthecasehere:whatbeganas
2
coding—hasaclearcompositionalstructure,thatexplainsthebidirectionalcircuitryobservedin
the brain [21], and that renders precise connections to the structure of statistical and machine
learningsystems[187,221,278],aswellastothestructureofmuchlargerscaleadaptivesystems
traditionallymodelledbyeconomicgametheory[119].
Predictive coding models were originally developed in the neuroscience of vision to explain
observationsthatneuralactivitymightdecreaseassignalsbecamelesssurprising[216](rather
thanincreaseassignalsbecamemore‘preferred’),aswellastoexplaintherobustnessofsensory
processingtonoise[246]andasasourceofmetabolicefficiency[32]5. Thetypicalformofthese
modelsinvolvesaneuronorneuralensemblerepresentingthesystem’scurrentpredictionof(or
expectationabout)itsinput, alongsideanotherneuronorensemblerepresentingthedifference
betweenthispredictionandtheactualinput(i.e.,representingthepredictionerror). Wecanthink
oftheformerensembleasdirectedfromwithinthebraintowardsthesensoryinterface(suchas
theretina),andthelatterensembleascarryinginformationfromtheworldintothebrain: thisis
theaforementionedbidirectionality.
Anotherimportantobservationaboutvisualprocessinginthebrainisthatitscircuitryseems
toberoughlyhierarchical[179],withregionsofcortexfurtherfromtheretinabeinginvolvedin
increasinglyabstractrepresentation[212]. Givenamodelofpredictivecodingatthelevelofasingle
circuit, accompanied by models of how sensory circuits are coupled (and their representations
transformed),anaturalnextstepistoconstructhierarchicalpredictivecodingmodels,inanattempt
toextendthebenefitsofthesinglecircuittoawholesystem;andindeedsuchhierarchicalcircuits
wereprominentlyproposedintheliterature[104,216].
This hierarchical structure is a hint of compositionality, and thus a sign that a categorical
approachmaybehelpfulandenlightening. Thisimpressionisstrengthenedwhenoneconsiders
a particularly influential class of predictive coding models, obtained in the context of the “free
energy principle” [100, 104, 107], where the underlying equations themselves exhibit a form of
compositionalitywhichis(moreorlessexplicitly)usedtoobtainthehierarchicalmodels6. Despite
thishintofcompositionality,theequationsofmotionforthesehierarchicalsystemsaretypically
derivedfromscratcheachtime[21,48,76,108,148,264,265],aredundanteffortthatwouldnotbe
aprojectintheoreticalneuroscienceswiftlybecameastudyofadaptiveandcyberneticsystemsmorebroadly,of
whichthebrainisofcoursetheprimeexemplar.
5Ifthepredictionisgood,thencommunicatingthedifferencebetweenpredictionandactualitycanbedonemuchmore
efficientlythantransmittingthewholeincomingsignal,whichwouldcontainmuchredundantinformation.Thisis
theprincipleunderlyingmostdatacompressionalgorithms.
6Thatistosay,thedynamicsofeachlevelofhierarchyiaregovernedbyaquantityF ,andthedynamicsoftwo
i
adjacentlevelsiandi`1aregovernedbyF i`F
i`1
;seeBuckleyetal.[48,Eq.72].
3
requiredhadacompositionalformalismsuchascategorytheorybeenusedfromthestart. This
thesissuppliessuchacategoricalformalismandexemplifiesitwithhierarchicalpredictivecoding
underthefreeenergyprinciple.
The“freeenergy”frameworknotonlyunderpinsamodernunderstandingofpredictivecoding,
buthasmorebroadlybeenproposedasaunifiedtheoryofbrainfunction[100],andlatterlyofall
adaptiveorlivingsystems[38,102,159,204]. Intheneuroscientificcontext,itconstitutesatheory
of the Bayesian brain, by which most or all brain function can be understood as implementing
approximate Bayesian inference [160]; in the more broadly biological (or even metaphysical)
contexts, this claim is generalized to state that all life can be understood in this way. However,
despitetheseclaimstouniversality,theseproposalshavetodatebeenquiteinformallyspecified,
leadingtoconfusion[28,103]andchargesofunfalsifiability[38,71,281]. Aswewillsee,category
theoryhasarichformalvocabularyforpreciselydescribinguniversalconstructions,andsonot
onlydoesacategoricalformulationofthefreeenergyframeworkpromisetoclarifythecurrent
confusions,butitmaybeexpectedalsotoshedlightonitspotentialuniversality. Inparticular,as
wediscussinChapter8,wewillbeabletomakeprecisethequestionsofwhetheranydynamical
systemoftheappropriatetypecanuniversallybeseenasperformingapproximateinference(inour
language,“playingastatisticalgame”),andofwhetheranycyberneticsystem(suchasaneconomic
gameplayer)canbeexpressedasanactiveinferencesystem.
Thenotionofactiveinferenceiscloselyrelatedtothefreeenergyframework: anactiveinference
model of a system describes both the processes by which it updates its internal states on the
basisofincomingsignals,andtheprocessesbywhichitchooseshowtoact,usingapproximate
Bayesianinference. Inthisthesis,wedonotgetasfarasacompletelygeneralformulationofactive
inference,butwehopethatourdevelopmentofstatisticalgamesandtheir“dynamicalsemantics”in
approximateinferencedoctrineswillprovideausefulstartingpointforsuchaformulation,andinour
finalchapter(8)wesketchhowwemightexpectthisformulationtogo. Becauseactiveinference
models,andthefreeenergyframeworkmorebroadly,aredescriptionsofsystemsthatare‘open’
toanenvironment,interactingwithit,andthereforesituated“incontext”,theyareparticularly
suitedtoacategory-theoreticreformulation. Likewise,Bayesianismandthefreeenergyframework
lend themselves to a subjectivist metaphysics [102, 114, 115], which is itself in alignment with
the unavoidable perspective-taking of categorical models, and which is not dissimilar from the
emerging‘biosemiotic’reconceptualizationofbiologicalinformation-processing[20]. Aswehave
indicated,categoricaltoolshelpustodrawconnectionsbetweenconcepts,andweseeourefforts
4
asacontributiontothisendeavour.
Itisthroughtheseconnectionsthatwehopeeventuallytomakecontactagainwiththecognitive
map. Asnotedabove, thestateoftheartisfragmented, butthereexistcurrentmodelsthatare
expressedinthelanguageofapproximate(variational)inference[279],modelsexpressedinthe
languageofreinforcementlearning[257],andmodelsthatattempttocombinethetwo[185]. We
willseethroughoutthethesisthatreinforcementlearning(anditscousin,gametheory)isclosely
related to approximate inference, and so we expect that the foundations developed here, along
withtheextensionsproposedin§8.1.3,willhelpusunifytheseaccounts. Thekeyobservationthat
we expect to drive such a development is that learning a cognitive map (alternatively, learning
a“worldmodel”)meansinternalizingarepresentationofthestructureoftheenvironment;and
comparingandtranslatingstructuresiscategorytheory’sforte.
Of course, even if the theory that we develop is sufficient to unify these computational-
phenomenological models, this is not to say it will satisfy all neuroscientists, many of which
maybeexpectedtodesiremorebiologicallydetailedmodels. Inthecontemporaryundergraduate
neurosciencecurriculum,oneistaughtinformallytorelatemodelsatahigh‘computational’level
tolowerlevelmodelsconcernedwithbiological‘implementation’,followingMarr’s“threelevels
of explanation” [179]. As we discuss in §2.2.3, this story is a shadow of the categorical notion
offunctorialsemantics,bywhichstructuresaretranslatedpreciselybetweencontextsformalized
ascategories. Althoughweconcentrateonthemoreabstractcomputationallevelinthisthesis,
ourdiscussionoffunctorialsemanticsforeshadowstheintroductionofformalalgebraictoolsfor
buildingbiologicallyplausibleneuralcircuitmodels(§3.3).
Our treatment of cognitive and neural systems is not the first to adopt categorical methods,
butwedobelievethatitisthefirsttodosoinacomprehensivelyintegratedandwide-ranging
way,takingfunctorialsemanticsseriously. Categoricalconceptshavebeenvariouslyproposedin
biologyasearlyas1958[220],andincognitivescience(withoneeyetowardthebrain)sinceat
least1987[84,85];morerecently,categorytheoryhasbeenusedtostudyclassiccognitive-science
conceptssuchassystematicity[209]. Whileinspirational,thesestudiesdonotmakethemostof
thetranslationalpowerofcategories,usingonlysomeconceptsormethodsinisolation. Moreover,
byworkingalmostpurelycategorically,theseworkswereinvariablyratherabstract,anddidnot
makedirectcontactwiththetoolsandconceptsofmainstreammathematicalscience. Asaresult,
theydidnothavetheunifyingimpactoradoptionthatwehopethenewwaveofappliedcategory
theoreticaldevelopmentstohave.
5
Ourprimarymotivationinwritingthisthesisistolaythegroundworkforwell-typed cognitive
scienceandcomputationalneuroscience. ‘Types’arewhatrendercategoricalconceptssoprecise,
and what allow categorical models to be so cleanly compositional: two systems can only “plug
together”iftheirinterfacetypesmatch. Becauseeveryconceptincategorytheoryhasatype(i.e.,
everyobjectisanobjectofsomecategory),categoricalthinkingisforcedtobeveryclear. Aswe
willsketchin§2.3.4,the“typetheories”(or“internallanguages”)ofcategoriescanbeveryrichly
structured,butstilltherequirementtoexpressconceptswithtypesisnecessarilyburdensome. But
thisburdenisonlytheburdenofthinkingclearly: ifoneisnotabletosupplyadetailedtype,one
canresorttoabstraction. And,toavoidtheviolenceofdeclaringsomeobjecttobeidentifiedasof
sometype7,itisnecessarytounderstandtherelationshipsbetweentypes;fortunately,aswewill
soonmakeclear,andaswehaveattemptedtoemphasize,categorytheoryisfundamentallythe
mathematicsofrelationship.
Contemporaryscienceisunavoidablycomputational,andthenotionof‘type’thatweinvoke
hereis closelyrelatedto (thoughnotidenticalwith) theinformalnotionof typethatisused in
computerprogramming. Justasoneofthestrategiesadoptedtoovercomethecrisesofmodern
sciencethatweinvokedattheopeningofthisintroductionisthemakingavailableofthecodeand
datathatunderliescientificstudies,wecanenvisageanearfutureinwhichaccompanyingtheseis
aformalspecificationofthetypesoftheconceptsthateachstudyisabout8. Someworkalongthese
lineshasalreadybegun,particularlywiththedevelopmentoftheAlgebraicJuliaecosystem[122].
Thefreeenergyframework,likethestructurallyadjacentframeworkofcompositionalgame
theory,hasastrongflavourofteleology(thatfollowsdirectlyfromitsmathematics): systemsactin
ordertomaketheirpredictionscometrue. Wethereforehopethat,althoughwedonotquitegetas
farasafullcompositionaltheoryofactiveinference,thecontributionsreportedinthisdissertation
may in some small way help to make this particular prediction (of a well-typed science) come
true,andtherebyhelptoovercomesomeoftheaforenotedcrisesofscientificfaith—aswellasto
shedlightnotonlyontheformandfunctionof‘Bayesian’brains,butalsoothercomplexadaptive
systems,suchasthewholescientificcommunityitself.
7AperspectiveforwhichwemustthankBrendanFong.
8Onemightthinkofthisspecificationasakintoascientificallyelaboratedversionofthenotionofheaderfile in
programminglanguagessuchasCorC++:thesefilesspecifythetypesoffunctionsanddatastructures,typically
withoutinstantiatingthesetypeswithdetailedimplementations.Wecanthusthinkofcategorytheoryasaveryrich
metaprogramminglanguageforthemathematicalsciences(andthisanalogygoesquitefar,ascategoricalproofsare
typically‘constructive’andhencecorrespondtocomputablefunctions,aswealsosketchin§2.3.4).
6
1.1. Overview of the dissertation
Category theory being quite alien to most researchers in computational neuroscience (and the
cognitive sciences more broadly), we begin the work of this dissertation in Chapter 2 with
a comprehensive review of the concepts and results needed to understand our mathematical
contributions. Usingthreehopefullyfamiliarexamples,weintroducecategoriesascontrapuntal
tographs,whicharemorefamiliartoscientists,butwhichlackimportantfeaturesofcategories
suchascompositionand,somehow,dynamism. Wethenexplainhowenrichedcategoriesallowus
to“connecttheconnections”ofcategories,andattachextradatatothem,andweexemplifythese
conceptswiththe2-categoryofcategories,functors,andnaturaltransformations—aswellasamore
formaldiscussionoffunctorial‘translation’andsemantics. TheremainderofChapter2isdedicated
tointroducingtheremainingkeyconceptsofbasiccategorytheory: universalconstructions,and
theYonedaLemma(categories’fundamentaltheorem). Alloftheseideasareverywellknownto
categorytheorists.
In Chapter 3, we begin to reapproach neural modelling, and more generally the ‘algebraic’
modellingofthestructureofinteractingsystems. Weexplainhow‘monoidal’categoriesallowusto
considerprocesses“inparallel”(aswellasjustsequentially),andhowthisgivesusaformalaccount
oftheconceptof‘parameterized’system. Wethenchangetheperspectivealittle,andintroduce
our first piece of original work: an account of how to connect neural circuits into larger-scale
systems,using‘multicategorical’algebra. Theremainderofthechapterisdedicatedtodeveloping
thetheoryofsuchalgebratothepointneededlaterinthethesis, endingwiththeintroduction
ofpolynomialfunctorswhichwillsupplyarichsyntaxfortheinteractionofsystems,aswellasa
languageinwhichtoexpresstheirdynamicalsemantics.
Chapter 4 presents our first main result, that Bayesian updating composes according to the
categorical‘lens’pattern. Thisresultisabstractlystated,andsoappliestowhichevercompositional
modelofprobabilityonemightbeinterestedin—butbecausewearelaterinterestedinconcrete
models,wespendmuchofthechapterrecapitulatingcompositionalprobabilitytheoryusingthe
toolsintroducedinChapters2and3andinstantiatingitindiscreteandcontinuoussettings. We
alsointroduceandcontextualizethelenspattern,inordertodefineournewnotionofBayesianlens,
whichprovidesamathematicalformalizationofthebidirectionalityofpredictivecodingcircuits.
Ourmainaiminthisthesisistoformalizepredictivecodingthroughfunctorialsemantics,and
Bayesianlenseswillprovideanimportantpartofthe‘syntax’ofstatisticalmodelsthatweneed. But
theBayesianlensesthatsatisfythemainresultofChapter4are‘exact’,whilenaturalsystemsare
7
inherentlyapproximate.Inordertomeasuretheperformanceofsuchapproximatesystems,Chapter
5introducesournextnewnotion,theconceptofstatisticalgame,whichattacheslossfunctionsto
lenses. Thesestatisticalgamescollectintoacategoricalstructureknownasafibration(akindof
categorifiedfibrebundle),andwecanusethesectionsofthisfibrationtoclassifywell-behaved
systemsofapproximateinferenceintolossmodels. Theselossmodelsincludewell-knownquantities
suchastherelativeentropy,(maximum)likelihood,thefreeenergy,andtheLaplaceapproximation
of the latter. However, in order to make this classification work, we first introduce a new kind
ofcategoricalcomposition,whichwecallcopy-composition,andwhichseemstocleavethebasic
process of composition in categories of stochastic channels, which typically proceeds first by
copyingandthenbymarginalization(‘discarding’).
Havingdevelopedthesyntacticsideofpredictivecoding,weturninChapter6tothesemantics,
which is found in a new abstract formalization of the concept of open dynamical system. We
makemuchusehereofthelanguageofpolynomialfunctors: thesewillrepresenttheinterfacesof
interactingsystems,andthedynamicalsystemsthemselveswillbedefinedasparticularclassesof
morphismsofpolynomials. Weextendthetraditionalnotionofpolynomialfunctortoasetting
whichallowsfornon-determinism,andtherebyobtainnewcategoriesofopenMarkovprocess
andrandomdynamicalsystem,bothindiscreteandcontinuoustime. Wethensynthesizethese
developments with the algebraic structures of Chapter 3, to define monoidal bicategories of
‘hierarchical’cyberneticsystemsthatwecallcilia,astheycontrollenses.
Connectingthesepiecestogether,Chapter7presentsourfunctorialformalizationofpredictive
coding, using a new notion of approximate inference doctrine, by which statistical models are
translatedintodynamicalsystems.Thisformalizestheprocessbywhichresearchinactiveinference
turnstheabstractspecificationofa“generativemodel”intoadynamicalsystemthatcanbesimulated
andwhosebehaviourscanthenbecomparedwithexperimentallyobserveddata. Weexplainhow
thisfunctorialprocessisdecomposedintostages,andthenexhibitthemintwoways: first,with
thebasic‘Laplacian’formofpredictivecoding;andthenbyintroducing‘Hebbian’plasticity.
Finally,Chapter8reviewstheprospectsforfuturework,fromthemathematicsofthecognitive
map(aprogrammethatwecallcompositionalcognitivecartography),tothecompositionofmulti-
agentsystemsandecosystemsandtheconnectionswithcompositionalgametheory,categorical
cybernetics,andcategoricalsystemstheory. Weclosewithsomespeculationonanewmathematics
oflife,alongwithassociateddevelopmentsoffundamentaltheory.
8
1.2. Contributions
Themainindividualcontributionofthisthesisistheformalizationofmodelsofpredictivecoding
circuitsasfunctorialsemantics,andtheassociateddevelopmentandexemplificationoffibrationsof
statisticalgames,aswellastheintroductionofBayesianlensesandtheproofthatBayesianupdates
compose optically. We believe our presentation of general open dynamical systems as certain
polynomialcoalgebrasalsotobenovel,alongwiththeconceptofciliaandtheirassociatedmonoidal
bicategories. Thecategoriesofstatisticalgames(andofBayesianlenses)supplythesyntax,and
themonoidalbicategoriesofciliathesemantics,forourfunctorialtreatmentofpredictivecoding,
andhencethebasisforourcompositionalactiveinferenceframework. Eachofthesestructuresis
toourknowledgenew,althoughofcourseinspiredbymuchworkthathasgonebefore,andby
interactionswiththebeneficentcommunityofresearchersofwhichthisauthorfindshimselfa
member.
Eachofthesestrandsofworkhasinsomewaybeenexhibitedthroughpublication,principally
asrefereedpresentationsattheconferenceonAppliedCategoryTheory(ACT)in2020[251],2021
[252],and2022[254](eachpublishedintheconferenceproceedings);butalsoinpreliminaryformat
theNeurIPS2019ContextandCompositionalityworkshop[247],throughanumberofmoreinformal
invitedtalks(e.g. [249]),asonemainthemeofafull-dayworkshopatthe2022CognitiveScience
Society conference [12], and our ongoing series of preprints on compositional active inference
[250,253]. OurworkonBayesianlenses,incollaborationwithDylanBraithwaiteandJulesHedges
[42]9,hasbeenacceptedforpublicationatMFCS2023;andwearepresentlypreparingforjournal
publicationanaccountofourcompositionalframeworkforpredictivecodingaimedexplicitlyat
computationalneuroscientists.
Besides these specific novel contributions, we hope that this dissertation contributes to a
renaissance ofcognitive and computational(neuro)science through theadoption of categorical
methods;itisforthisreasonthatwehavebeensodiligentinourexpositionofthebasictheory.
Wehopethatthisexpositionprovesitselfausefulcontributionforinterestedresearchers,andthat
itscognitive-neuroscientificframingissufficientlynoveltobeinteresting.
Some work performed during the author’s DPhil studies is not included in this dissertation.
Inparticular, therehasunfortunatelynotbeenthescopetoincludeoursimulationresultsona
fragmentofthecircuitryunderlyingthecognitivemap—astudyonthedevelopmentofplaceand
head-direction cells, which was published as [255]—although this did motivate our algebra of
9SeeRemark4.3.1forthescholarlyhistory.
9
rate-codedneuralcircuits(§3.3),whichistothebestofourknowledgenovel(thoughmuchinspired
byearlierworkonwiring-diagramalgebras[237,282]). Wehavealsonotexhibitedourworkon
Bayesian optics (as an alternative to Bayesian lenses) [248], as this would require a digression
throughsomeunnecessarilycomplicatedtheory;andwehavenotpresentedindetailtheexamples
of“polynomiallife”presentedatACT2021[252].
AfirstdraftofthisthesiswasproducedinDecember2022,atwhichpointtheauthorintendedto
submitit. However,shortlybeforesubmission,theauthorrealizedthatthethen-currenttreatment
ofstatisticalgamescouldbemuchimproved. Thisledtothepresentfibrationalaccount,andthe
newnotionoflossmodel(whichformalizesthechainruleoftherelativeentropy),butwhichalso
demanded a corresponding revision of the treatment of predictive coding. At the cost of some
higher-categorical machinery, we believe these changes amount to a substantial improvement,
worth the delay in submission. The new account of statistical games has been accepted as a
proceedingspaperatACT2023.
10
2. Basic category theory for computational
and cognitive (neuro)scientists
Thischapterconstitutesacomprehensivereviewoftheconceptsandresultsfrombasiccategory
theorythatscaffoldtherestofthethesis,writtenforthecomputationalneuroscientistorcognitive
scientistwhohasnoticedthe‘network’structureofcomplexsystemslikethebrainandwhowonders
how this structure relates to the systems’ function. Category theory gives us a mathematical
framework in which precise answers to such questions can be formulated, and reveals the
interconnectedness of scientific ideas. After introducing the notions of category and diagram
(§2.1),weswiftlyintroducethenotionsofenrichedcategory,functor,andadjunction(§2.2),with
whichwecantranslateandcomparemathematicalconcepts. Wethenexplainhowcategorytheory
formalizespatternaswellastranslation,usingtheconceptofuniversalconstruction(§2.3),which
weexemplifywithmanycommonandimportantpatterns. Finally,weintroducethefundamental
theoremofcategorytheory,theYonedaLemma,whichtellsusthattounderstandathingistosee
itfromallperspectives(§2.4).
Categorytheoryiswellestablishedinthefoundationsofmathematics,butnotyetexplicitlyin
thefoundationsofscience. Asaresult,althoughtheonlyslightlyoriginalpartofthischapterisits
presentation,wehavegivenproofsofmostresultsandplentifulexamples,inordertofamiliarize
thereaderwiththinkingcategorically.
2.1. Categories, graphs, and networks
Webeginbymotivatingtheuseofcategorytheorybyconsideringwhatismissingfromapurely
graph-theoreticunderstandingofcomplexcomputationalsystems. Laterinthethesis,wewillsee
howeachofthediagramsdepictedbelowcanbeformalizedcategorically,incorporatingallthe
scientificallysalientinformationintocoherentmathematicalobjects.
11
2.1.1. Threeexamples
2.1.1.1. Neuralcircuits: dynamicalnetworksofneurons
Incomputationalandtheoreticalneuroscience,itisnotunusualtoencounterdiagramsdepicting
proposedarchitecturesforneuralcircuits,suchasontheleftorrightbelow:
E
I
Ontheleft,wehavedepictedastandard“excitatory-inhibitorycircuit”motif,inwhichoneneuron
orensembleofneuronsE receivesinputfromanexternalsourceaswellasfromacounterposed
inhibitorycircuitI whichitselfisdrivensolelybyE. Ontheright,wehavereproducedafigure
depictinga“predictivecoding”circuitfromBogacz[33],andweseethattheE-I circuitisindeed
motivic, being recapitulated twice: we could say that the predictive coding circuit is composed
frominterconnectedE-I motifs,inasensesimilarlytothecompositionoftheE-I circuitfromthe
subnetworksE andI ofneurons.
Bothcircuitshaveevidentgraphicalstructure—thenodesarethewhitecircles,andtheedges
theblackwiresbetweenthem—butofcoursethereismoretoneuralcircuitsthanthesegraphs:
notonlydographssodefinedomitthedecorationsonthewires(indicatingwhetheraconnection
isexcitatoryorinhibitory),buttheymissperhapsthemoreimportantdetail,thatthesearecircuits
ofdynamicalsystems,whichhavetheirownrichstructureandbehaviours. Moreover,meregraphs
misstheaforementionedcompositionality ofneuralcircuits: wecanfillinthewhitecircleswith
neuronsorensemblesorothercircuitsandwecanwirecircuitstogether,andattheendofdoing
sowehaveanother‘composite’neuralcircuit.
Working only with graphs means we have to treat the decorations, the dynamics, and the
compositionalityinformally,oratleastinsomeotherdatastructure,therebyincreasingtheoverhead
ofthisaccounting.
2.1.1.2. Bayesiannetworks: beliefanddependence
Incomputationalstatistics, oneoftenbeginsbyconstructingamodelofthecausaldependence
betweenevents,whichcanthenbeinterrogatedforthepurposesofinferenceorbelief-updating.
Suchmodelsaretypicallygraphical,withrepresentationsasshownbelow;thenodesareagainthe
12
circles,andthedashededgeimpliestherepetitionofthedepictedmotif:
Ontheleft,thegraphrepresentsamodelofaneventwithtwopossibleantecedents;ontheright,a
setofevents(oranevent,repeated)witharecurrentcause. Althoughthesegraphicalmodels—
otherwiseknownasBayesiannetworks—mayencodeusefulinformationaboutcausalstructure,
inthemselvestheydonotencodetheinformationabouthow eventsarecaused;thisisdatathat
mustbeaccountedforseparately. Andonceagain,meregraphsareunlikecausalityinthatthey
arenon-compositional: thestructuredoesnotexplainhow,giventhecausaldependenceofB onA
andA1 andofC onB,onemightmodelthedependenceofC onA.
2.1.1.3. Computations: setsandfunctions
Inasimilarway,purecomputations—inthesenseoftransformationsbetweensetsofdata—are
oftendepictedgraphically:
c
t´1
W
f
d
x t W o ` σ
c
W t
i
` σ
W
c `
h
t
d
U
f
` σ
U
h o d
t´1
` σ
U
i
U
i
Here,wehavedepictedasingle‘cell’fromalongshort-termmemorynetwork[132]: afunction
that ingests three variables (c , an internal state; x , an external input; and h , an internal
t´1 t t´1
‘memory’),andemitstwo(c ,anewinternalstate;andh ,anupdatedmemory). Thisfunctionis
t t
itselfcomposedfromotherfunctions,depictedaboveasboxes. (Onetypicallytakesthevariables
c ,x ,h asvectorsofgivendimensionforallt,sothatthedomainandcodomainofthefunction
t t t
areproductsofvectorspaces;theboxesW andU representmatriceswhichactonthesevectors;
i i
theboxes`andddenoteelementwisesumandproduct;theboxσ representstheelementwise
13
applicationofalogisiticfunction;andthesplittingofwiresrepresentsthecopyingofdata.) The
nodes of the graph in this instance are the functions (boxes), and the edges encode the flow of
information. Oncemore,however,apurelygraphicalmodeldoesnotaccountforthecompositional
structureofthecomputation:wecouldfillintheboxeswithothergraphs(representingelaborations
ofthecomputationsimplied),andwecouldadjoinanothersuchdiagrambesideandconnectthe
wireswherethetypesmatch. Toaccountforthiscompositionality—hereandintheexamples
above—wewillneedtoaddsomethingtothestructure:weneedtomovefromgraphstocategories.
2.1.2. Fromgraphstocategories
Acategoryisadirectedgraphinwhichedgescanbecomposed: wheneverthetargetofanedgef
isthesourceofanotheredgeg,thentheremustbeacompositeedgedenotedg˝f whosesourceis
thesourceoff andwhosetargetisthetargetofg,asinthefollowingdiagram.
‚
g˝f
g
‚ ‚
f
This composition rule incorporates into the structure a way to allow systems with compatible
interfaces to connect to each other, and for the resulting composite system also to be a system
ofthe same‘type’; but aswe willsee, ithassome otherimportant consequences. Firstly, every
(‘small’) category has an underlying directed graph: but because of the composition rule, this
underlying graph typically has more edges than the graphs of the examples above, in order to
accountfortheexistenceofcomposites. Secondly,itistheedges,whichinacategoricalcontextwe
willcallmorphisms,thatcompose: thenodes,whichwewillcallobjects,representsomethinglike
the‘interfaces’atwhichcompositionispossible. Thismeansthatwecannotjustinterpretacircuit
diagram“asacategory”,whoseobjectsareensemblesofneuronsandwhosemorphismsaretheir
axons: aswewillseein§3.3,weneedtodosomethingabitmoresophisticated.
Beforewegettothat,however,wemustfirstdefinecategoriesprecisely. Wewilltakeagraphical
approach,withaviewtointerpretingtheaboveexamplescategorically,startingwiththediagram
demonstratingthecompositionofg˝f: howshouldweinterpretthisinacategory? Toanswer
thisquestion,wefirstneedtospecifyexactlywhatwemeanby‘graph’.
Definition 2.1.1. A directed graph G is aset G of nodes along witha set Gpa,bq of edges from
0
atobforeachpair a,b : G ofnodes. Wewillsometimes writeG todenotethe disjointunion
0 1
14
ř
ofthesetsofedges,G :“ Gpa,bq. Ife : Gpa,bqisanedgefromatob,wewillwritethisas
1 a,b
e : a Ñ bandcallaitssourceordomainandbitstarget orcodomain. Thisassignmentofdomain
andcodomaininducesapairoffunctions,dom,cod : G Ñ G respectively,suchthatfore : a Ñ b
1 0
wehavedompeq “ aandcodpeq “ b.
Acategoryisagraphwhoseedgescanbe‘associatively’composedtogether,andwhereevery
nodehasaspecialedgefromitselftoitselfcalledits‘identity’.
Definition 2.1.2. A (small) category C is a directed graph whose nodes are each assigned a
correspondingidentity edgeandwhoseedgesareequippedwithacompositionoperation˝thatis
associativeandunital withrespecttotheidentities. Inthecontextofcategories,wecallthenodes
C theobjectsor0-cells,andtheedgesC themorphismsor1-cells.
0 1
Identitiesareassignedbyafunctionid : C Ñ C satisfyingdompid q “ a “ codpid qforevery
0 1 a a
objecta. Thecompositionoperationisafamilyoffunctions˝ : Cpb,cqˆCpa,bq Ñ Cpa,cqfor
a,b,c
eachtripleofobjectsa,b,c. ThenotationCpa,bqindicatesthesetofallmorphismsa Ñ b,foreach
pairofobjectsaandb;wecallthissetthehomset fromatob.
Givenmorphismsf : a Ñ bandg : b Ñ c,theircompositea ÝÑ f b ÑÝ g ciswritteng˝f,which
wecanreadas“g afterf”.
Associativity means that h ˝ pg ˝ fq “ ph ˝ gq ˝ f, and so we can omit the parentheses to
writeh˝g˝f withoutambiguity. Unitalitymeansthat,foreverymorphismf : a Ñ b,wehave
id ˝f “ f “ f ˝id .
b a
Remark 2.1.3. We say small category to mean that both the collection of objects C and the
0
collectionofmorphismsC isatrueset,ratherthanaproperclass. Wewillsayacategoryislocally
1
small if,foreverypaira,bofobjectsinC,thehomsetCpa,bqisaset(ratherthanaproperclass);
thisallowsforthecollectionofobjectsstilltobeaproperclass,whilelettingusavoid“sizeissues”
suchasRussell’sparadoxinthecourseofnormalreasoning.
Moreprecisely,wecanfixa‘universe’ofsets,ofsizeassumedtobesmallerthanahypothesized
(andtypicallyinaccessible)cardinalℵ . Thenwesaythatacategoryislocallysmallwithrespectto
i
ℵ ifeveryhomsetiswithinthisuniverse,orsmallifbothC andC are. Wesaythatacategoryis
i 0 1
largeifitisnotsmall,butnotethatthe‘set’ofobjectsormorphismsofalargecategorymaystill
bea‘set’,justinalargeruniverse: auniversewhosesetsareofcardinalityatmostℵ ą ℵ .
i`1 i
In the remainder of this thesis, we will typically assume categories to be locally small with
respecttoagiven(butunspecified)universe.
15
Ourfirstexampleofacategoryisinsomesensethefoundationofbasiccategorytheory,and
suppliesaclassicillustrationofsizeissues.
Example2.1.4. ThecategorySethassetsasobjectsandfunctionsasmorphisms. Theidentityon
asetAistheidentityfunctionid : A Ñ A : a ÞÑ a. CompositionofmorphismsinSetisfunction
A
composition: givenf : A Ñ B andg : B Ñ C, theircompositeisthefunctiong ˝f : A Ñ C
definedforeacha : Abypg ˝fqpaq “ gpfpaqq; itiseasytocheckthatfunctioncompositionis
associative.
NotethatSetisalargecategory: thesetSet ofallsetsofatmostsizeℵ mustliveinalarger
0 i
universe.
Not all categories are large, of course. Some are quite small, as the following examples
demonstrate.
Example 2.1.5. There is a category with only two objects 0 and 1 and four morphisms: the
identities id : 0 Ñ 0 and id : 1 Ñ 1, and two non-identity morphisms s,t : 0 Ñ 1, as in the
0 1
followingdiagram:
s
0 1
t
Whendepictingcategoriesgraphically,weoftenomitidentitymorphismsastheyareimpliedby
theobjects.
Example2.1.6. Thereisacategory,denoted1,withasingleobject˚andasinglemorphism,its
identity.
Example2.1.7. ThenaturalnumbersNformthemorphismsofanothercategorywithasingle
object ˚: here, composition is addition and the identity morphism id : ˚ Ñ ˚ is the number 0.
˚
Sinceadditionisassociativeandunitalwithrespectto0,thisisawell-definedcategory.
Sinceacategoryisadirectedgraphequippedwithacompositionoperation,wecan‘forget’the
lattertorecovertheunderlyinggraphonitsown.
Proposition2.1.8. GivenacategoryC,wecanobtainadirectedgraphpC ,C qbykeepingthe
0 1
objectsC andmorphismsC andforgettingthecompositionandidentityfunctions.
0 1
Proof. Taketheobjectstobethenodesandthemorphismstobetheedges.
16
However, in the absence of other data, obtaining a category from a given graph is a little
morelaborious,aswemustensuretheexistenceofwell-definedcompositeedges. Thefollowing
propositiontellsushowwecandothis.
Proposition2.1.9. GivenadirectedgraphG,wecanconstructthefreecategory generatedbyG,
denotedFG,asfollows. TheobjectsofFG arethenodesG ofG. ThemorphismsFGpa,bqfrom
0
atobarethepathsinG fromatob: finitelistspe,f,gqofedgesinwhichthedomainofthefirst
edgeisa,thecodomainofanyedgeequalsthedomainofitssuccessor(ifany),andthecodomain
ofthelastedgeisb. Compositionisbyconcatenationoflists,andtheidentitymorphismforany
nodeistheemptylistpq.
Proof. Letf :“ pf ,...,f q : a Ñ b,g :“ pg ,...,g q : b Ñ c,andh :“ ph ,...,h q : c Ñ dbe
1 l 1 m 1 n
paths. Then
h˝pg˝fq “ ph ,...,h q˝pf ,...,f ,g ,...,g q
1 n 1 l 1 m
“ pf ,...,f ,g ,...,g ,h ,...,h q
1 l 1 m 1 n
“ pg ,...,g ,h ,...,h q˝pf ,...,f q “ ph˝gq˝f
1 m 1 n 1 l
so concatenation of lists is associative. Concatenation is trivially unital on both right and left:
pq˝pf ,...,f q “ pf ,...,f q “ pf ,...,f q˝pq. Sothefreecategoryasdefinedisawell-defined
1 l 1 l 1 l
category.
Remark2.1.10. ObservethattheunderlyinggraphofFGisnotingeneralthesameastheoriginal
graphG: becausetheedgesofG havenocompositioninformation(evenif,givenapairofedges
a Ñ b and b Ñ c, there is an edge a Ñ c), we needed a canonical method to generate such
information,withoutanyextradata. Sincethereisanotionofpathinanygraph,andsincepaths
arenaturallycomposable,thisgivesusthecanonicalmethodweseek.
Webegintoseesomeimportantdifferencesbetweencategoriesandgraphs,asforeshadowed
above. Categoriesaresomehowmore‘dynamical’objects,moreconcernedwithmovementand
changethangraphs; laterinChapter6,wewillevenseehowageneraldefinitionofdynamical
systememergessimplyfromsomeoftheexampleswehavealreadyseen.
At this point, to emphasize that categories allow us to study not just individual structures
themselvesbutalsotherelationshipsandtransformationsbetweenstructures,wenotethatdirected
graphsthemselvesformacategory.
17
Example 2.1.11. Directed graphs pG ,G ,dom ,cod q are the objects of a category, denoted
0 1 G G
Graph. Given directed graphs G :“ pG ,G ,dom ,cod q and H :“ pH ,H ,dom ,cod q, a
0 1 G G 0 1 H H
morphismf : G Ñ H isagraphhomomorphismfromG toH: apairoffunctionsf : G Ñ G
0 0 0
and f : G Ñ H that preserve the graphical structure in the sense that forevery edge e in G,
1 1 1
f pdom peqq “ dom pf peqqandf pcod peqq “ cod pf peqq. Sincegraphhomomorphismsare
0 G H 1 0 G H 1
pairsoffunctions,theycomposeasfunctions,andtheidentitymorphismonagraphG isthepair
pid ,id qofidentityfunctionsonitssetsofnodesandedges.
G0 G1
In large part, the power of category theory derives from its elevation of relationship and
transformationtomathematicalprominence: objectsarerepresentedandstudiedincontext,and
onewegaintheabilitytocomparepatternsofrelationshipsacrosscontexts. Byexpressingthese
patternscategorically,weareabletoabstractawayirrelevantdetail,andfocusonthefundamental
structures that drive phenomena of interest; and since these patterns and abstract structures
are again expressed in the same language, we can continue to apply these techniques, to study
phenomenafromdiverseperspectives. Indeed,aswewillsoonsee,categorytheoryis‘homoiconic’,
abletospeakinitslanguageaboutitself.
Accordingly, it is often helpful to apply graphical or diagrammatic methods to reason about
categories: forexample,tosaythattwo(ormore)morphismsareactuallyequal. Wecanillustrate
thisusingthecategoryGraph: thedefinitionofgraphhomomorphismrequirestwoequalitiesto
besatisfied. Theseequalitiessaythattwo(composite)pairsoffunctionsareequal;sincefunctions
aremorphismsinSet,thisisthesameassayingthattheyareequalasmorphismsthere. Usingthe
factthatSethasanunderlyinggraph,wecanrepresentthesemorphismsgraphically,asinthe
followingtwodiagrams:
G
f1
H G
f1
H
1 1 1 1
(2.1)
domG domH codG codH
G H G H
0 0 0 0
f0 f0
Thentosaythatf ˝dom “ dom ˝f andf ˝cod “ cod ˝f istosaythatthesediagrams
0 G H 1 0 G H 1
commute.
Definition2.1.12. Wesaythattwopathsinagraphareparallel iftheyhavethesamestartand
endnodes. WesaythatadiagraminacategoryC commuteswheneverypairofparallelpathsin
thediagramcorrespondstoapairofmorphismsinC thatareequal.
18
Toclarifythisdefinition,wecanusecategorytheorytoformalizetheconceptofdiagram,which
willhavetheusefulside-effectofsimultaneouslyrenderingitmoregeneralandmoreprecise.
2.1.2.1. Diagramsinacategory,functorially
Therichnessofcategoricalstructureisreflectedinthevarietyofdiagrammaticpractice,andinthis
thesiswewillencounteranumberofformaldiagramtypes. Nonetheless,thereisonetypethatis
perhapsmorebasicthantherest,whichwehavealreadybeguntocalldiagramsinacategory: these
arethecategoricalanalogueofequationsinalgebra. Oftenincategorytheory,wewillbeinterested
intherelationshipsbetweenmorethantwomorphismsatonce,andexpressingsuchrelationships
byequationsquicklybecomescumbersome;instead,onetypicallystartswithadirectedgraphand
interpretsitsnodesasobjectsanditsedgesasmorphismsinone’scategoryofinterest.
Formally,thisinterpretationisperformedbytakingthecategorygeneratedbythegraphand
mappingit‘functorially’intothecategoryofinterest.However,inordertoaccountforrelationships
suchasequalitybetweenthemorphismsrepresentedinthegraph,thedomainofthismapping
cannotbeas‘free’asinProposition2.1.9,asitneedstoencodetheserelationships. Todothis,we
canquotientthefreecategorybythegivenrelationships,aswenowshow.
Proposition2.1.13(MacLane[175,Prop. II.8.1]). LetG beadirectedgraph,andsupposeweare
givenarelation„ oneachsetFGpa,bqofpathsa Ñ b;write„forthewholefamilyofrelations,
a,b
and call it a relation on the category C. Then there is a category FG{„, the quotient of the free
categoryFG by„,whichwecallthecategorygeneratedby G withrelations„orsimplygenerated
by pG,„q.
TheobjectsofFG{„areagainthenodesG . Themorphismsareequivalenceclassesofpaths
0
accordingto„,extendedtoacongruence: supposep „ p1;thentheybothbelongtothesame
a,b
equivalenceclassrps,andcorrespondtothesamemorphismrps : a Ñ binFG{„.
Beforewecanmakesenseofandprovethisproposition,andthusestablishthatcompositionin
FG{„doeswhatwehope,weneedtodefinecongruence.
Definition2.1.14. Suppose„isarelationonthecategoryC. Wecall„acongruence whenits
constituentrelations„ areequivalencerelationscompatiblewiththecompositionalstructureof
a,b
C. Thismeansthat
1. iff „ f1 : a Ñ bandg „ g1 : b Ñ c,theng˝f „ g1˝f1;and
a,b b,c a,c
2. foreachpairofobjectsa,b : C,„ isasymmetric,reflexive,transitiverelation.
a,b
19
Thenotionofcongruenceiswhatallowsustoextendthefamilyofrelations„tocompositesof
morphismsandthusensurethatitiscompatiblewiththecategoricalstructure;constructingthe
mostparsimoniouscongruencefrom„isthekeytothefollowingproof.
ProofsketchforProposition2.1.13. Firstofall,weextend„toacongruence;wechoosethesmallest
congruencecontaining„,anddenoteitby–. Explicitly,wecanconstruct–intwosteps. First,
defineanintermediaterelation»asthesymmetric,reflexive,transitiveclosureof„. Thismeans
thatiff » f1, theneitherf „ f1, orf1 „ f (symmetry), orf “ f1 (reflexivity), orthereexists
someϕ : a Ñ csuchthatf „ ϕandϕ „ f1 (transitivity). Next,define–astheclosureof»under
composition. Thismeansthatifφ – φ1 : a Ñ c,theneitherφ » φ1,orthereexistcomposable
pairs f,f1 : a Ñ b and g,g1 : b Ñ c such thatf » f1 and g » g1, and suchthat φ “ g ˝f and
φ1 “ g1 ˝f1. Toseethat–istheleastcongruenceonFG,observethateverycongruencemust
containitbydefinition.
Havingconstructedthecongruence–,wecanformthequotientofFG byit,whichwedenote
byFG{„inreferencetothegeneratingrelation„. Asinthestatementoftheproposition, the
objectsofFG{„arethenodesofG andthemorphismsareequivalenceclassesofpaths,according
to–;since–isbydefinitionanequivalencerelation,theseequivalenceclassesarewell-defined.
Moreover, the composite of two equivalence classes of morphisms rfs : a Ñ b and rgs : b Ñ c
coincideswiththeequivalenceclassrg˝fs.
Example2.1.15. Toexemplifythenotionofcategorygeneratedwithrelations,letJ denotethe
followingdirectedgraph
G
φ1
H
1 1
δG δH
G H
0 φ0 0
andlet„betherelationφ ˝δ „ δ ˝φ . ThenthecategoryFJ{„generatedbypJ,„qhas
0 G H 1
four objects (G ,G ,H ,H ) and nine morphisms: an identity for each of the four objects; the
1 0 1 0
morphisms φ : G Ñ H , φ : G Ñ H , δ : G Ñ G , and δ : H Ñ H ; and a single
0 0 0 1 1 1 G 1 0 H 1 0
morphismG Ñ H ,theequivalenceclassconsistingofφ ˝δ andδ ˝φ .
1 0 0 G H 1
The category FJ{„ generated in this example expresses the commutativity of one of the
diagramsdefininggraphhomomorphisms, butasthingsstand, itissimplyacategorystanding
alone: to say that any particular pair of functions pf ,f q satisfies the property requires us to
0 1
interpretthemorphismsφ andφ accordinglyasthosefunctions. Thatis,tointerpretthediagram,
0 1
20
weneedtotranslateit,bymappingFJ{„intoSet. Suchamappingofcategoriesisknownasa
functor.
Definition 2.1.16. A functor F : C Ñ D from the category C to the category D is a pair of
functionsF : C Ñ D andF : C Ñ D betweenthesetsofobjectsandmorphismsthatpreserve
0 0 0 1 1 1
domains, codomains, identities and composition, meaning that F pdom pfqq “ dom pF pfqq
0 C D 1
and F pcod pfqq “ cod pF pfqq for all morphisms f, F pid q “ id for all objects a, and
0 C D 1 1 a Fpaq
F pg˝fq “ F pgq˝F pfqforallcompositesg˝f inC.
1 1 1
Remark2.1.17. NotethatwecouldequivalentlysaythatafunctorC Ñ D isahomomorphism
fromtheunderlyinggraphofC tothatofDthatisadditionallyfunctorial,meaningthatitpreserves
identitiesandcomposites.
Notation2.1.18. AlthoughafunctorF consistsofapairoffunctionspF ,F q,wewilltypically
0 1
writejustF whetheritisappliedtoanobjectoramorphism,sincethedistinctionwillusuallybe
clearfromthecontext. Sincefunctioncomposition(andhenceapplication)isassociative,wewill
alsooftenomitbrackets,writingFaforFpaq,exceptwhereitishelpfultoleavethemin.
ForeachobjectcinacategoryC,therearetwoveryimportantfunctors,thehomfunctors,which
exhibitC inSet“fromtheperspective”ofcbyreturningthehomsetsoutofandintoc.
Definition2.1.19. Givenanobjectc : C,itscovarianthomfunctor Cpc,´q : C Ñ Setisdefined
on objects x by returning the hom sets Cpc,xq and on morphisms g : x Ñ y by returning the
postcomposition function Cpc,gq : Cpc,xq Ñ Cpc,yq defined by mapping morphisms f : c Ñ x
in the set Cpc,xq to the composites g ˝f : c Ñ y in Cpc,yq. To emphasize the action of Cpc,gq
bypostcomposition,wewillsometimeswriteitsimplyasg˝p´q. (ThatCpc,´qisawell-defined
functorfollowsimmediatelyfromtheunitalityandassociativityofcompositioninC.)
The covariant hom functor Cpc,´q “looks forward” along morphisms emanating out of c, in
thedirectionthatthesemorphismspoint,andthereforeinthedirectionofcompositioninC: itis
for this reason that we say it is covariant. Dually, it is of course possible to “look backward” at
morphismspointingintoc. SincethismeanslookingcontrarytothedirectionofcompositioninC,
wesaythattheresultingbackwards-lookinghomfunctoriscontravariant. Todefineitasafunctor
inthesenseofDefinition2.1.16,weperformthetrickofswappingthedirectionofcompositionin
C aroundandthendefiningacovariantfunctoraccordingly.
21
Definition2.1.20. ForanycategoryC thereisacorrespondingoppositecategory Cop withthe
same objects as C and where the hom set Coppa,bq is defined to be the ‘opposite’ hom set in C,
namelyCpb,aq. IdentitymorphismsarethesameinCopasinC,butcompositionisalsoreversed. If
wewrite˝forcompositioninC and˝op forcompositioninCop,then,givenmorphismsg : c Ñ b
andf : b Ñ ainCop correspondingtomorphismsg : b Ñ candf : a Ñ binC,theircomposite
f ˝op g : c Ñ a in Cop is the morphism g ˝ f : a Ñ c in C. (Observe that this makes Cop a
well-definedcategorywheneverC is.)
Remark 2.1.21. Because we can always form opposite categories in this way, categorical
constructions often come in two forms: one in C, and a ‘dual’ one in Cop. Typically, we use
theprefixco-toindicatesuchadualconstruction: soifwehaveaconstructioninC,thenitsdual
inCop wouldbecalledacoconstruction.
ThedualofthecovarianthomfunctorCpc,´q : C Ñ Setisthecontravarianthomfunctor.
Definition2.1.22. Givenanobjectc : C,itscontravarianthomfunctor Cp´,cq : Cop Ñ Setis
defined on objects x by returning the hom sets Cpx,cq. Given a morphism f : x Ñ y in C, we
definetheprecompositionfunctionCpf,cq : Cpy,cq Ñ Cpx,cqbymappingmorphismsg : y Ñ c
inthesetCpy,cqtothecompositesg ˝f : x Ñ cinCpx,cq. ToemphasizetheactionofCpf,cq
byprecomposition,wewillsometimeswriteitsimplyasp´q˝f. (ThatCp´,cqisawell-defined
functoragainfollowsfromtheunitalityandassociativityofcompositioninC andhenceinCop.)
Remark2.1.23. Acontravariant functoronC isa(covariant)functoronCop.
Notation2.1.24. Inlinewithothermathematicalliterature,wewillalsooccasionallywritethe
precompositionfunctionp´q˝f asf˚;dually,wecanwritethepostcompositionfunctiong˝p´q
asg . Intheseforms, theformeractionf˚ isalsoknownaspullback alongf, asit“pullsback”
˚
morphismsalongf,andthelatteractiong isalsoknownaspushforward alongg,asit“pushes
˚
forward”morphismsalongg. Thereisacloserelationshipbetweenthepulling-backdescribedhere
andtheuniversalconstructionalsoknownaspullback(Example2.3.43): f˚p´qdefinesafunctor
whichactsbytheuniversalconstructiononobjectsandbyprecompositiononmorphisms,which
wespelloutinDefinition4.2.28.
Functorsarethehomomorphismsofcategories,andjustasgraphsandtheirhomomorphisms
formacategory,sodocategoriesandfunctors.
22
Example2.1.25. ThecategoryCathascategoriesforobjectsandfunctorsformorphisms. The
identity functor id on a category C is the pair pid ,id q of identity functions on the sets of
C C0 C1
objectsandmorphisms. Sincefunctorsarepairsoffunctions,functorcompositionisbyfunction
composition,whichisimmediatelyassociativeandunitalwithrespecttotheidentityfunctorsso
defined. Notethat,withoutarestrictiononsize,Catisalargecategory,likeSet.
As an example, we observe that the construction of the category FG{„ generated by pG,„q
fromthefreecategoryFG isfunctorial.
Example 2.1.26. There is a ‘projection’ functor r¨s : FG Ñ FG{„. It maps every object to
itself,andeverymorphismtothecorrespondingequivalenceclass. TheproofofProposition2.1.13
demonstratedthefunctoriality:identitiesarepreservedbydefinition,andwehaverg˝fs “ rgs˝rfs
byconstruction.
Withthenotionoffunctortohand,wecanformalizetheconceptofdiagramsimplyasfollows.
Definition2.1.27. AJ-shapeddiagraminacategoryC isafunctorD : J Ñ C. Typically,J isa
smallcategorygeneratedfromagraphwithsomegivenrelations,andthefunctorD interpretsJ
inC.
Example2.1.28. Thediagramsexpressingthecommutativityconditionsforagraphhomomor-
phism(2.1)arethereforewitnessedbyapairoffunctorsFJ{„ Ñ SetfromthecategoryFJ{„
generatedinExample2.1.15intoSet: eachfunctorinterpretsφ andφ asf andf respectively,
0 1 0 1
whileonefunctorinterpretsδ asdom andδ asdom andtheotherinterpretsδ ascod and
G G H H G G
δ ascod . ThefactthatthereisonlyasinglemorphismG Ñ H inFJ{„(eventhoughthere
H H 1 0
aretwoinFJ)encodestherequirementsthatf ˝dom “ dom ˝f andf ˝cod “ cod ˝f .
0 G H 1 0 G H 1
Throughoutthisthesis,wewillseetheutilityofdiagramsasinDefinition2.1.27: notonlywill
theybeusefulinreasoningexplicitlyaboutcategoricalconstructions,butin§2.3.3theywillalsobe
usedtoformalize‘universalconstructions’,anotherconceptwhichexhibitsthepowerofcategory
theory.
Despite this, ‘mere’ categories and their diagrams are in some ways not expressive enough:
often we will want to encode looser relationships than strict equality, or to compose diagrams
togetherby‘pasting’themalongcommonedges;wemayevenwanttoconsidermorphismsbetween
morphisms! Forthiswewillneedto‘enrich’ournotionofcategoryaccordingly.
23
2.2. Connecting the connections
As we have indicated, basic category theory is not sufficient if we want to encode information
abouttherelationshipsbetweenmorphismsintotheformalstructure. Inthissection,wewillsee
how to enrich the notion of category by letting the morphisms collect into more than just sets,
andhowthisleadsnaturallytohighercategorytheory,wherewehavemorphismsbetweenthe
morphisms, and from there to the notion of adjunction, with which we can translate concepts
faithfullybackandforthbetweencontexts. Amidstthedevelopment,wediscusstheconceptof
“functorialsemantics”fromascientificperspective,consideringhowcategoricaltoolsletussupply
richsemanticsforstructuredmodelsofcomplexsystemssuchasthebrain.
2.2.1. Enrichedcategories
Wecanthinkoftheconditionthatadiagramcommutes—orequivalentlythespecificationofan
equivalencerelationonitspaths—asa‘filling-in’ofthediagramwithsomeextradata. Forexample,
wecan‘fill’thediagramdepictingthegraphhomomorphismconditionf ˝dom “ dom ˝f
0 G H 1
withsomeannotationordatawitnessingthisrelation,asfollows:
G
f1
H
1 1
domG domH
G H
0 0
f0
If we have a composite graph homomorphism g ˝ f : G Ñ I, we should be able to paste the
commutingdiagramsofthefactorstogetherandfilltheminaccordingly:
G
f1
H
g1
I
1 1 1
domG domH domI
G H I
0 f0 0 g0 0
andweshouldbeableto‘compose’thefillerequalitiestoobtainthediagramforthecomposite:
G
f1
H
g1
I
1 1 1
.
domG domI
G H I
0 f0 0 g0 0
24
Theextradatawithwhichwehavefilledthesediagramssits‘between’themorphisms,andso
ifwewishtoincorporateitintothecategoricalstructure, wemustmovebeyondmeresets, for
setsarejustcollectionsofelements,withnothing“inbetween”. Whatwewilldoisallowthehom
setsofacategorytobenolongersets,butobjectsofanother‘enriching’category. Now,observe
that,inpastingthetwodiagramsabovetogether,wehadtoplacethemsidebyside: thismeans
thatanysuitableenrichingcategorymustcomeequippedwithanoperationthatallowsustoplace
itsobjectssidebyside;inthebasiccase,whereourcategoriesjusthavehomsets,theenriching
categoryisSet,andthisside-by-sideoperationistheproductofsets.
Definition2.2.1. GivensetsAandB,theirproduct isthesetAˆB whoseelementsarepairs
pa,bqofanelementa : Awithanelementb : B.
We have already made use of the product of sets above, when we defined the composition
operationfor(small)categoriesinDefinition2.1.2. Ingeneral,however,wedon’tneedpreciselya
product;onlysomethingweaker,whichwecalltensor. Inordertodefineit,weneedthenotionof
isomorphism.
Definition2.2.2. Amorphisml : c Ñ dina1-categoryisanisomorphismifthereisamorphism
r : d Ñ csuchthatl˝r “ id andid “ r˝l. Wesaythatlandr aremutuallyinverse.
d c
Definition2.2.3. WewillsaythatacategoryC hasatensorproduct ifitisequippedwithafunctor
b : CˆC Ñ C alongwithanobjectI : C calledthetensorunit andthreefamiliesofisomorphisms:
1. associator isomorphismsα : pabbqbc ÝÑ „ abpbbcqforeachtripleofobjectsa,b,c;
a,b,c
2. leftunitor isomorphismsλ : I ba ÝÑ „ aforeachobjecta;and
a
3. rightunitor isomorphismsρ : abI ÝÑ „ aforeachobjecta.
a
Remark2.2.4. Thenotionoftensorproductformspartofthedefinitionofmonoidalcategory,
whichwewillcometoin§3.1.2. Beyondhavingatensorproduct,amonoidalcategorymusthave
structureisomorphismsthatarecoherent withrespecttotheambientcategoricalstructure,which
itselfsatisfiespropertiesofassociativityandunitality;thisisanechoofthemicrocosmprinciple
which we discuss in Remark 3.4.7. However, to give the full definition the notion of monoidal
categoryrequiresustointroducethenotionofnaturaltransformation,whichweotherwisedonot
needuntilDefinition2.2.17;moreover,questionsofcoherenceoftensorproductswillnotyetarise.
Unsurprisingly,theproductofsetsgivesusourfirstexampleofatensorproductstructure.
25
Example 2.2.5. The product of sets gives us a tensor product ˆ : SetˆSet Ñ Set. To see
thatitisfunctorial,observethat,givenaproductofsetsAˆB andafunctionf : A Ñ A1,we
naturallyobtainafunctionf ˆB : AˆB Ñ AˆA1 byapplyingf onlytotheA-componentsof
theelementsoftheproductAˆB;likewisegivenafunctiong : B Ñ B1. Theunitofthetensor
productstructureistheset1withasingleelement˚. Theassociatorandunitorsarealmosttrivial:
forassociativity,mapppa,bq,cqtopa,pb,cqq.
Usingthetensorproducttoputmorphismssidebyside,wecandefinethenotionofenriched
category.
Definition 2.2.6. Suppose pE,b,I,α,λ,ρq is a category equipped with a tensor product. An
E-category C,orcategory C enrichedinE,constitutes
1. asetC ofobjects;
0
2. foreachpairpa,bqofC-objects,anE-objectCpa,bqofmorphismsfromatob;
3. foreachobjectainC,anE-morphismid : I Ñ Cpa,aqwitnessingidentity;and
a
4. for each triple pa,b,cq of C-objects, an E-morphism ˝ : Cpb,cq b Cpa,bq Ñ Cpa,cq
a,b,c
witnessingcomposition;
suchthatcompositionisunital,i.e. foralla,b : C
Cpa,bqbI
Cpa,bqbida
Cpa,bqbCpa,aq Cpa,bqbCpa,aq
id bbCpa,bq
I bCpa,bq
and ,
ρ Cpa,bq
˝a,a,b ˝a,b,b
λ Cpa,bq
Cpa,bq Cpa,bq
andassociative,i.e. foralla,b,c,d : C
` ˘ ` ˘
α
Cpc,dqbCpb,cq bCpa,bq a,b,c,d Cpc,dqb Cpb,cqbCpa,bq
˝b,c,dbCpa,bq Cpc,dqb˝a,b,c
.
Cpb,dqbCpa,bq Cpc,dqbCpa,cq
˝a,b,d ˝a,c,d
Cpa,dq
Ourfirstexampleofenrichedcategoriesvalidatesthedefinition.
26
Example2.2.7. AlocallysmallcategoryisacategoryenrichedinpSet,ˆ,1q.
Remark2.2.8. InSet,morphisms1 Ñ Aoutoftheunitset1correspondtoelementsofA: each
suchmorphismisafunctionmappingtheuniqueelement˚ : 1toitscorrespondingelementofA.
ThisiswhyidentitiesinenrichedcategorytheoryaregivenbymorphismsI Ñ Cpa,aq,anditis
alsowhywewillcallmorphismsoutofatensorunitgeneralizedelements. (Evenmoregenerally,
wemightsaythatmorphismsX Ñ AaregeneralizedelementsofshapeX,reflectingouruseof
theword‘shape’todescribethedomainofadiagram.)
Toincorporatenontrivialfillersintoourdiagrams,wemoveinsteadtoenrichmentinprosets.
Example 2.2.9. A preordered set or proset is a category where there is at most one morphism
betweenanytwoobjects. Theobjectsofsucha‘thin’categoryarethepointsoftheproset,andthe
morphismsencodethe(partial)orderingofthepoints;asaresult,theyareoftenwrittena ď a1.
Functorsbetweenprosetsarefunctionsthatpreservetheordering,andtherestrictionofCatto
prosets produces a category that we denote by Pro. The product of sets extends to prosets as
follows: ifAandB areprosets,thentheirproductistheprosetAˆB whosepointsarethepoints
oftheproductsetAˆB andamorphismpa,bq ď pa1,b1qwhenevertherearemorphismsa ď a1
andb ď b1 inAandB respectively.
AcategoryenrichedinProisthereforeacategorywhosehomsetsare(pre)orderedandwhose
compositionoperationpreservesthisordering,whichwecanillustrateasfollows:
f g
A B C
f1 g1
ď ď
g˝f
˝
ÑÞÝ A C
g1˝f1
ď
We can see how enrichment in Pro generalizes the situation with which we introduced this
section, where we considered filling diagrams with data witnessing the equality of morphisms:
herewehaveinequality data,anditisnothardtoseehowenrichedcompositionencompassesthe
pasting-and-composingdiscussedthere(justreplacethecellsherebythesquaresabove).
Inordertomakethesefilleddiagramsprecise,weneedtoextendthenotionoffunctortothe
enrichedsetting;andsowemakethefollowingdefinition.
Definition2.2.10. SupposeC andD areE-categories. ThenanE-functor F constitutes
1. afunctionF : C Ñ D betweenthesetsofobjects;and
0 0 0
2. foreachpairpa,bq : C ˆC ofobjectsinC,anE-morphismF : Cpa,bq Ñ DpF a,F bq
0 0 a,b 0 0
27
whichpreserveidentities
I
ida idF0a
Cpa,aq DpF a,F aq
0 0
Fa,a
andcomposition
Cpb,cqbCpa,bq
˝a,b,c
Cpa,cq
.
F b,cbF a,b Fa,c
DpF b,F cqbDpF a,F bq DpF a,F cq
0 0 0 0 ˝F0a,F0b,F0c 0 0
A diagram in an E-enriched category C is therefore a choice of E-enriched category J (the
diagram’sshape)andanE-functorJ Ñ C. J encodestheobjects,morphismsandrelationships
ofthediagram,andthefunctorinterpretsitinC. Inthisenrichedsetting,weneednotquotient
parallelpathsintheshapeofadiagram(whichdestroystheirindividuality);instead,wehaveextra
data(thefillers)encodingtheirrelationships.
2.2.2. 2-categories
Wehaveseenthatfillingthecellsofadiagramwithinequalitiespushesustoconsiderenrichment
inPro. SinceProisthecategoryofcategorieswithatmostonemorphism(i.e.,theinequality)
betweeneachpairofobjects,anaturalgeneralizationistoallowabroaderchoiceoffiller: thatis,
toallowtheretobemorphismsbetweenmorphisms. ThismeansmovingfromenrichmentinPro
toenrichmentinCat, andhencetothenotionof2-category. Wethereforemakethefollowing
definition.
Definition2.2.11. Astrict2-category isacategoryenrichedinthe1-categoryCat. Thismeans
that,insteadofhomsets,a2-categoryhashomcategories: theobjectsofthesehomcategoriesare
the1-cellsofthe2-category,andthemorphismsofthehomcategoriesarethe2-cells;the0-cells
ofthe2-categoryareitsobjects. Todistinguishbetweenthecompositiondefinedbytheenriched
categorystructurefromthecompositionwithinthehomcategories,wewillsometimescallthe
formerhorizontal andthelattervertical composition.
Remark2.2.12. Wesay1-categoryabovetorefertothe‘1-dimensional’notionofcategorydefined
inDefinition2.1.2.
28
Remark2.2.13. Wesaystrict tomeanthattheassociativityandunitalityofcompositionholdup
toequality;later,itwillbehelpfultoweakenthissothatassociativityandunitalityonlyholdupto
“coherentisomorphism”,meaningthatinsteadofaskingthediagramsinDefinition2.2.6simplyto
commute(andthusbefilledbyequalities),weaskforthemtobefilledwith‘coherently’defined
isomorphism. Weakening2-categoricalcompositioninthiswayleadstothenotionofbicategory
(§3.1.4).
Inordertogiveawell-definednotionofenrichmentinCat,weneedtoequipitwithasuitable
tensorproductstructure;forthis,wecanextendtheproductofsetstocategories,asfollows.
Proposition2.2.14. GivencategoriesC andD,wecanformtheproduct categoryC ˆD. Itsset
of objects pC ˆDq is the product set C ˆD . Similarly, a morphism pc,dq Ñ pc1,d1q is a pair
0 0 0
pf,gqofamorphismf : c Ñ c1 inC withamorphismg : d Ñ d1 inD;hencepCˆDq “ C ˆD .
1 1 1
CompositionisgivenbycomposingpairwiseinC andD: pf1,g1q˝pf,gq :“ pf1˝f,g1˝gq.
Proof. ThatcompositionisassociativeandunitalinCˆDfollowsimmediatelyfromthoseproperties
intheunderlyingcategoriesC andD.
Remark2.2.15. Usingtheproductofcategories,wecangathertheco-andcontravariantfamilies
ofhomfunctorsCpc,´qandCp´,cqintoasinglehomfunctor Cp´,“q : CopˆC Ñ Set,mapping
px,yq : CopˆC toCpx,yq.
Proposition2.2.16. Theproductofcategoriesextendstoafunctorˆ : CatˆCat Ñ Cat. Given
functorsF : C Ñ C1 andG : D Ñ D1,weobtainafunctorF ˆGbyapplyingF totheleftfactor
oftheproductC ˆD andGtotheright.
Proof. Sufficientlyobviousthatweomitit.
Thearchetypal2-categoryisCatitself,aswewillnowsee: morphismsbetweenfunctorsare
callednaturaltransformation,andtheywillplayanimportantrôlethroughoutthisthesis.
Definition2.2.17. SupposeF andGarefunctorsC Ñ D. Anaturaltransformationα : F ñ G
isafamilyofmorphismsα : Fpcq Ñ GpcqinD andindexedbyobjectscofC,suchthatforany
c
morphismf : c Ñ c1 inC,thefollowingdiagram—calledanaturalitysquareforα—commutes:
Fc
αc
Gc
.
Ff Gf
Fc1 Gc1
α c1
29
Whenthecomponent1-cellsofanaturaltransformationαareallisomorphisms,thenwecallαa
naturalisomorphism.
Example 2.2.18. Every morphism f : a Ñ b in a category C induces a (contravariant)
natural transformation Cpf,´q : Cpb,´q ñ Cpa,´q between covariant hom functors, acting
byprecomposition. Dually,everymorphismh : c Ñ dinducesa(covariant)naturaltransformation
Cp´,hq : Cp´,cq ñ Cp´,dqbetweencontravarianthomfunctors,actingbypostcomposition. To
seethatthesetwofamiliesarenatural,observethatthesquarebelowleftmustcommuteforall
objectsa,b,c : C andmorphismsf : a Ñ bandh : c Ñ d,bytheassociativityofcompositioninC
(asillustratedontheright)
Cpf,cq
Cpb,cq Cpa,cq g g˝f
Cpb,hq Cpa,hq
Cpb,dq Cpa,dq h˝g h˝g˝f
Cpf,dq
andthatitthereforeconstitutesanaturalitysquareforbothCpf,´qandCp´,hq. Notealsothatwe
cantakeeitherpaththroughthissquareasadefinitionofthefunctionCpf,hq : Cpb,cq Ñ Cpa,dq
whichthusactsbymappingg : b Ñ ctoh˝g˝f : a Ñ d.
Remark2.2.19. Wewillseein§3.1.2thatthefamiliesofstructuremorphismsforatensorproduct
(andhenceusedinthedefinitionofenrichedcategory)aremoreproperlyrequiredtobenatural
transformations.
Theexistenceofmorphismsbetweenfunctorsimpliesthatthecollectionoffunctorsbetween
anypairofcategoriesitselfformsacategory,whichwenowdefine.
Proposition 2.2.20. The functors between two categories C and D constitute the objects of a
category,calledthefunctorcategory anddenotedbyCatpC,DqorDC,whosemorphismsarethe
naturaltransformationsbetweenthosefunctors. Theidentitynaturaltransformationonafunctor
isthenaturaltransformationwhosecomponentsareallidentitymorphisms.
Proof. First, observe that the identity natural transformation is well-defined, as the following
diagramcommutesforanymorphismf : c Ñ c1:
Fc
idFc
Fc
Ff Ff
Fc1 Fc1
id Fc1
30
(Notethatingeneral,wewilldepictanidentitymorphisminadiagramasanelongatedequality
symbol,asabove.) Giventwonaturaltransformationsα : F ñ Gandβ : G ñ H,theircomposite
isthenaturaltransformationdefinedbycomposingthecomponentfunctions: pβ˝αq :“ β ˝α .
c c c
Wecanseethatthisgivesawell-definednaturaltransformationbypastingthecomponentnaturality
squares:
Fc
αc
Gc
βc
Hc
Ff Gf Hf
Fc1 Gc1 Hc1
α c1 β c1
Since the two inner squares commute, so must the outer square. And since the composition
of natural transformations reduces to the composition of functions, and the identity natural
transformation has identity function components, the composition of natural transformations
inheritsstrictassociativityandunitalityfromcompositioninSet.
Thisgivesusourafirstnontrivialexampleofa2-category.
Example2.2.21. Functorcategoriesconstitutethehomcategoriesofthestrict2-categoryCat,
andhenceforthwewillwriteCat todenotethe1-categoryofcategoriesandfunctors;wecan
1
therefore say that Cat is enriched in Cat . The 0-cells of Cat are categories, the 1-cells are
1
functors,andthe2-cellsarenaturaltransformations. IfαisanaturaltransformationF ñ G,with
F andGfunctorsC Ñ D,thenwecandepictitasfillingthecellbetweenthefunctors:
F
C α D
G
(More generally, we will depict 2-cells in this way, interpreting such depictions as diagrams of
enrichedcategoriesinthesensediscussedabove.)
SinceCatisa2-category,ithasbothverticalcomposition(compositionwithinhom-categories)
and horizontal (composition between them). In Proposition 2.2.20, we introduced the vertical
composition,soletusnowconsiderthehorizontal,whichwewilldenoteby˛toavoidambiguity.
The horizontal composition of 1-cells is the composition of functors (as morphisms in Cat ),
1
but by the definition of enriched category, it must also extend to the 2-cells (here, the natural
transformations). Supposethenthatwehavenaturaltransformationsφandγ asinthefollowing
31
diagram:
F G
B φ C γ D
F1 G1
Thehorizontalcompositeγ ˛φisthenaturaltransformationGF ñ G1F1 withcomponents
GFb Ý G Ý φ Ñb GF1b Ý γ ÝFÑ 1b G1F1b .
Notation2.2.22(Whiskering). Itisoftenusefultoconsiderthehorizontalcompositeofanatural
transformation α : F ñ G with (the identity natural transformation on) a functor, as in the
followingdiagrams,withprecompositionontheleftandpostcompositionontheright:
L F F R
D idL C α C1 C α C1 idR D1
L G G R
We will often write the left composite α ˛ L : FL ñ GL as α , since its components are
L
α : FLd Ñ GLdforalld : D;andwewilloftenwritetherightcompositeR˛α : RF ñ RG
Ld
asRα, sinceitscomponentsareRα : RFc Ñ RGcforallc : C. Thisuseofnotationiscalled
c
whiskering.
2.2.3. Onfunctorialsemantics
Atthispoint,wepausetoconsidercategorytheoryfromthegeneralperspectiveofourmotivating
examples,toreflectonhowcategorytheorymightsurpriseus: asweindicatedin§2.1.2,categories
aremore‘dynamical’thangraphs,morepreoccupiedwithchange,andsobehavedifferently;infact,
theyhaveamuchrichervarietyofbehaviours,andjustascategoriescanoftenbeverywell-behaved,
they can also be quite unruly. Through its homoiconicity—its ability to describe itself—the use
of category theory impels us to consider not only how individual systems are constructed, nor
onlyhowsystemsofagiventypecanbecompared,butalsohowtocomparedifferentclassesof
system. Inthisway,categorytheoryrapidlyconcernsitselfwithnotionsnotonlyofconnection
andcomposition,butalsoofpatternandtranslation.
Scientifically,thisisveryuseful:inthecomputational,cognitive,orotherwisecyberneticsciences,
we are often concerned with questions about when and how natural systems ‘compute’. Such
questionsamounttoquestionsoftranslation,betweentheabstractrealmofcomputationtothe
moreconcreterealmsinhabitedbythesystemsofinterestandthedatathattheygenerate;oneoften
askshownaturalstructuresmightcorrespondto‘algorithmic’details,orwhetherthebehavioursof
32
systemscorrespondtocomputationalprocesses. Itisforthisreasonthatwechoseourmotivating
examples, which exhibited (abstract) natural structure as well as two kinds of informational
or computational structure: a central question in contemporary neuroscience is the extent to
whichneuralcircuitscanbeunderstoodasperformingcomputation(particularlyoftheformnow
establishedinmachinelearning). Thisquestionisinsomewayattheheartofthisthesis,which
aimstoestablishacompositionalframeworkinwhichthetheoriesofpredictivecodingandactive
inferencemaybestudied.
Thedynamismofcategoriesisahintthatitispossibletodescribeboththestructureofsystems
andtheirfunctioncategorically,witha‘syntax’forsystemsontheonehandand‘semantics’onthe
other. Thisisthenotionoffunctorialsemantics[165],bywhichwetranslatesyntacticstructures
in one category to another category which supplies semantics: the use of functors means that
this translation preserves basic compositional structure, and we often ask for these functors to
preserveotherstructures,too;atypicalchoice,thatwewilladoptinChapter3istouselaxmonoidal
functors,whichpreservecompositionintwodimensions,allowingustoplacesystems“sideby
side”aswellas“endtoend”.
Ofcourse,theparticularchoicesofsyntacticandsemanticcategorywilldependuponthesubject
at hand—in this thesis we will be particularly interested in supplying dynamical semantics for
approximateinferenceproblems—buttypicallythesyntacticcategorywillhavesome‘nice’algebraic
structurethatisthenpreservedandinterpretedbythefunctorialsemantics. Thisis,forinstance,
howfunctorialsemanticsletsusunderstandprocessesthat“happenongraphs”,andasasimple
example,wecanconsiderdiagramsinSet: theshapeofthediagramtellsushowtocomposethe
partsofasystemtogether,whilethediagramfunctorgivesus,foreachabstractpart,asetofpossible
componentsthathaveacompatibleinterface,aswellasfunctionsrealizingtheirinterconnection.
Incategorical‘process’theory,andthemoregeneralcategoricaltheoryofsystems,onetherefore
oftenconsiderstheobjectsofthe‘syntactic’categoryasrepresentingtheshapesorinterfacesof
systemsandthemorphismsasrepresentinghowthedifferentshapescanplugtogether. Thisis
analgebraicapproachtosystemsdesign: mathematically,thesyntacticstructureisencodedasa
monad,andthefunctorialsemanticscorrespondstoamonadalgebra,asweexplaininChapter3;
andthedesireforcompositionricherthanmerelyend-to-endisanothermotivationforventuring
intohighercategorytheory. InChapter6,wewill‘unfold’acombinationoftheseideas,toconstruct
bicategorieswhoseobjectsrepresentinterfaces,whose1-cellsareprocesses‘between’theinterfaces
thatcanbecomposedbothsequentiallyandinparallel,andwhose2-cellsarehomomorphismsof
33
processes. ThisbicategorywilltheninChapter7supplythesemanticsformodelsofpredictive
coding.
Inscience,thereisrarelyonlyonewaytostudyaphenomenon,andourcollectiveunderstanding
ofphenomenaisthereforeapatchworkofperspectives. Attheendofthischapter,wewilldiscuss
theYonedaLemma,whichformalizesthisobservationthattounderstandathingistoseeitfromall
perspectives,anditisforthisreasonthatweexpectcategorytheorytosupplyalinguafrancaforthe
mathematicalsciences. Incomputationalneurosciencespecifically,aninfluentialmethodological
theoryisDavidMarr’s“threelevelsofexplanation”[179],inwhichcomplexcognitivesystemsare
profitablystudiedatthelevelsof‘computation’,‘algorithm’,and‘implementation’. Theselevels
are only very informally defined, and the relationships between them not at all clear. We hope
thatfunctorialsemanticsandothercategoricalapproachescanreplacesuchmethodologiessothat
instead of a simplistic hierarchical understanding of systems, we can progressively and clearly
exposethewebofrelationshipsbetweenmodels.
2.2.4. Adjunctionandequivalence
We discussed above the use of functors to translate between mathematical contexts. Often, we
areinterestednotonlyintranslationinonedirection,butalsointranslatingbackagain. When
wehaveapairoffunctors—or1-cellsmoregenerally—inoppositedirectionsandwhenthetwo
translationsaresomehowreversible,weoftenfindourselveswithanadjunction;forexample,the
functorialmappingsofgraphstocategoriesandbackareadjoint(Example2.2.25below),andwe
conjectureinChapter8thatthemappingof“statisticalgames”todynamicalsystemsformspart
ofanadjunction,too. Adjunctionsareparticularlywell-behaved‘dual’translations,andtheywill
thereforebeofmuchusethroughoutthisthesis. Foritsconceptualelegance, webeginwithan
abstractdefinition,whichexhibitsthefundamentalessence.
Definition2.2.23. SupposeL : C Ñ D andR : D Ñ C are1-cellsofa2-category. Wesaythat
they are adjoint or form an adjunction, denoted L % R, if there are 2-cells η : id ñ RL and
C
ϵ : LR ñ id ,calledrespectivelytheunit andcounit oftheadjunction,whichsatisfythetriangle
D
equalitiesϵ ˝Lη “ id andRϵ˝η “ id ,socalledowingtotheirdiagrammaticdepictions:
L L R R
L
Lη
LRL R
ηR
RLR
and
ϵL Rϵ
L R
34
The unit and counit of the adjunction measure ‘how far’ the round-trip composite functors
LR : C Ñ C and RL : D Ñ D leave us from our starting place, as indicated in the following
diagrams:
D C
L R and R L
η ϵ
C C D D
idC idD
The triangle identities then ensure that the round-trips have an isomorphic ‘core’, so that it is
possibletotranslatemorphismsononesidetotheotherlosslessly(whichwewillexemplifyin
Proposition2.2.26),andthattheadjunctionhasanatural‘algebraic’interpretation(whichwewill
encounterinProposition3.4.13).
Inthespecificcaseofthe2-categoryCat,wecanmakethefollowingalternativecharacterization
ofadjunctions. Hereweseethatthe“isomorphiccore”oftheadjunctioncanbecharacterizedby
sayingthatmorphismsintoobjectsinC thatcomefromD viaRareinbijectionwithmorphisms
outofobjectsinD thatcomefromC viaL.
Definition2.2.24. SupposeL : C Ñ D andR : D Ñ C arefunctorsbetweencategoriesC and
D. We say that they are adjoint functors when there is an isomorphism between the hom-sets
DpLc,dq – Cpc,Rdqthatisnaturalinc : C andd : D.
Givenamorphismf : Lc Ñ dinD,wedenoteits(right)adjunct inC byf7 : c Ñ Rd. Inversely,
givenamorphismg : c Ñ RdinC,wedenoteits(left)adjunct inD byg5 : Lc Ñ d. Theexistence
oftheisomorphismmeansthatf75 “ f andg “ g57.
Example 2.2.25. The functorF : Graph Ñ Cat mapping agraph to thecorresponding free
category(Proposition2.1.9)isleftadjointtotheforgetfulfunctorU : Cat Ñ Graphmapping
a category to its underlying graph (Proposition 2.1.8). To see this, we need to find a natural
isomorphism CatpFG,Cq – GraphpG,UCq. A graph homomorphism G Ñ UC is a mapping
ofthenodesofG totheobjectsofC andoftheedgesofG tothemorphismsofC thatpreserves
sources(domains)andtargets(codomains). AfunctorFG Ñ C isamappingofthenodesofG to
theobjectsofC alongwithamappingofpathsinG tomorphismsinC thatpreservesdomains,
codomains,identitiesandcomposites. ApathinG isalistof‘composable’edges,withtheidentity
path being the empty list, so such a mapping of paths is entirely determined by a mapping of
edges to morphisms that preserves domains and codomains. That is to say, a functor FG Ñ C
is determined by, and determines, a graph homomorphism G Ñ UC, and so the two sets are
isomorphic:insomesense,functorsbetweenfreecategoriesaregraphhomomorphisms. Toseethat
35
theisomorphismisnatural,observethatitdoesn’tmatterifweprecomposeagraphhomomorphism
G1 Ñ G (treatedasafunctorbetweenfreecategories)orpostcomposeafunctorC Ñ C1 (treatedas
agraphhomomorphism): becausegraphhomomorphismscomposepreservingthegraphstructure,
wewouldstillhaveanisomorphismCatpFG1,C1q – GraphpG1,UC1q.
Beforewecanproperlysaythatadjointfunctorsformanadjunction,weneedtoproveit. Asthe
followingproofshows,themappingsp´q7 andp´q5 defineandaredefinedbytheunitandcounit
oftheadjunction.
Proposition2.2.26. FunctorsthatformanadjunctioninCatareexactlyadjointfunctors.
Proof. Weneedtoshowthatfunctorsthatformanadjunctionareadjoint,andthatadjointfunctors
formanadjunction;thatis,weneedtoshowthatanypairoffunctorsL : C Ñ D andR : D Ñ C
satisfyingthedefinitionofadjunctioninDefinition2.2.23necessarilyconstituteadjointfunctors
accordingtoDefinition2.2.24,andthatifLandRareadjointaccordingtoDefinition2.2.24then
theyformanadjunctionaccordingtoDefinition2.2.23: i.e.,thetwodefinitionsareequivalent.
WebeginbyshowingthatifL % R,thenLandRareadjointfunctors. Thismeansweneed
toexhibitanaturalisomorphismDpLc,dq – Cpc,Rdq. Wedefineafunctionp´q7 : DpLc,dq Ñ
Cpc,Rdqbysetting
f7 :“ c Ý η Ñc RLc Ý R ÝÑ f Rd
andafunctionp´q5 : Cpc,Rdq Ñ DpLc,dqbysetting
g5 :“ Lc Ý L Ñ g LRd Ý ϵ Ñd d.
Wethenusenaturalityandthetriangleequalitiestoshowthatf75 “ f andg57 “ g:
f75 “ Lc Ý L Ý f Ñ 7 LRd Ý ϵ Ñd d g57 “ c Ý η Ñc RLc Ý R Ý g Ñ 5 Rd
“ Lc Ý L Ý η Ñc LRLc Ý L Ý R ÝÑ f LRd Ý ϵ Ñd d “ c Ý η Ñc RLc Ý R Ý L Ñ c RLRd Ý R Ý ϵ Ñd Rd
“ Lc Ý L Ý η Ñc LRLc Ý ϵ ÝLÑc Lc ÝÑ f d “ c ÑÝ g Rd Ý η ÝRÑd RLRd Ý R Ý ϵ Ñd Rd
f g
“ Lc ÝÑ d “ c ÑÝ Rd
Ineachcasethefirsttwolinesfollowbydefinition,thethirdbynaturality,andthefourthbythe
triangle equality; hence we have an isomorphism DpLc,dq – Cpc,Rdq. The naturality of this
isomorphismfollowsfromthenaturalityofη andϵ. Wefirstcheckthattheisomorphismsp´q7 are
36
naturalinc,whichmeansthatthefollowingsquarescommuteforallϕ : c1 Ñ cinC:
p´q7
DpLc,dq c,d Cpc,Rdq
DpLϕ,dq Cpϕ,Rdq
DpLc1,dq Cpc1,Rdq
p´q7
c1,d
Thisrequiresinturnthatpf ˝Lϕq7 “ f7˝ϕ,whichwecancheckasfollows:
pf ˝Lϕq7 “ c1 Ý η ÝÑc1 RLc1 Ý R Ý L ÝÑ ϕ RLc Ý R ÝÑ f Rd
“ c1 ÝÑ ϕ c Ý η Ñc RLc Ý R ÝÑ f Rd
“ c1 ÝÑ ϕ c Ý f Ñ 7 Rd
wherethesecondequalityholdsbythenaturalityofη. Thenaturalityofp´q7 indrequiresthat
pϕ1˝fq7 “ Rϕ1˝f7 forallϕ1 : d Ñ d1,whichcanbecheckedalmostimmediately:
pϕ1˝fq7 “ c Ý η Ñc RLc Ý R ÝÑ f Rd Ý R Ý ϕ Ñ 1 Rd1
“ c Ý f Ñ 7 Rd Ý R Ý ϕ Ñ 1 Rd1
Dually,thenaturalityofp´q5 : Cpc,Rdq Ñ DpLc,dqindrequiresthatpRϕ1˝gq5 “ ϕ1˝g5 forall
ϕ1 : d Ñ d1,whichobtainsbythenaturalityofϵ:
pRϕ1˝gq5 “ Lc Ý L Ñ g LRd Ý L Ý R Ý ϕ Ñ 1 LRd1 Ý ϵ Ñd1 d1
“ Lc Ý L Ñ g LRd Ý ϵ Ñd d Ý ϕ Ñ 1 d1
“ Lc Ý g Ñ 5 d Ý ϕ Ñ 1 d1
Thenaturalityofp´q5 inc,whichrequiresthatpg˝ϕq5 “ g5˝Lϕ,obtainssimilarlyimmediately:
pg˝ϕq5 “ Lc1 Ý L ÝÑ ϕ Lc Ý L Ñ g LRd Ý ϵ Ñd d
“ Lc1 Ý L ÝÑ ϕ Lc Ý g Ñ 5 d
Thusp´q7 andp´q5 arebothnaturalincandd,andhenceLandRareadjointfunctors.
To show the converse, that if L : C Ñ D and R : D Ñ C are adjoint functors then L % R,
weneedtoestablishnaturaltransformationsη : id ñ RLandϵ : LR ñ id fromthenatural
C D
isomorphismsp´q7andp´q5,suchthatthetriangleequalitiesϵ ˝Lη “ id andRϵ˝η “ id are
L L R R
satisfied. Wefirstdefineη componentwise,byobservingthatη musthavethetypec Ñ RLc,and
c
37
thattheimageofid : Lc Ñ Lcunderp´q7 isofthistype,andthereforedefiningη :“ pid q7.
Lc c Lc
Dually,wedefineϵbyobservingthatϵ musthavethetypeLRd Ñ d,andthattheimageofid
d Rd
underp´q5 hasthistype. Wethereforedefineϵ :“ pid q5. Toseethatthesedefinitionsconstitute
d Rd
naturaltransformations,observethattheyarethemselvescomposedfromnaturaltransformations.
Explicitly,thenaturalityofη meansthatforanyf : c Ñ c1,wemusthaveRLf ˝η “ η ˝f,and
c c1
thenaturalityofϵmeansthatforanyg : d Ñ d1,wemusthaveg˝ϵ “ ϵ ˝LRg. Theseobtain
d d1
asfollows:
RLf ˝η “ c Ý p Ý id ÝLÝcÑ q7 RLc Ý R Ý L ÝÑ f RLc1 g˝ϵ “ LRd Ý p Ý id ÝRÝdÑ q5 d ÑÝ g d1
c d
“ c Ý p Ý Lf Ý ˝ Ý id ÝLÝcÑ q7 RLc1 “ LRd Ý p Ý R Ý g Ý ˝i Ý d RÝdÝÑ q5 d1
“ c Ý p Ý id ÝLÝc1 Ý ˝ Ý L Ý f Ñ q7 RLc1 “ LRd Ý p Ý id ÝRÝd1 Ý ˝ Ý R Ý g Ñ q5 d1
“ c ÝÑ f c1 Ý p Ý id ÝLcÝ 1 Ñ q7 RLc1 “ LRd Ý L Ý R ÝÑ g LRd1 Ý p Ý id ÝRÝdÝ 1 Ñ q5 d1
“ η ˝f “ ϵ ˝LRg
c1 d1
Ineachcase,thefirstequalityholdsbydefinition,thesecondbynaturalityofp´q7 andp´q5 (left
andright,respectively)ind,thethirdbynaturalityofid,thefourthbynaturalityinc,andthelast
bydefinition. Itremainstocheckthatη andϵsodefinedsatisfythetriangleequalities. Expressed
componentwise,wedemonstratethatϵ ˝Lη “ id andthatRϵ ˝η “ id asfollows:
Lc c Lc d Rd Rd
ϵ ˝Lη “ Lc Ý L Ý p Ý id ÝLÝcÑ q7 LRLc Ý p Ý id ÝRÝLÝcÑ q5 Lc Rϵ ˝η “ Rd Ý p Ý id ÝLÝRÝdÑ q7 RLRd Ý R Ý p Ý id ÝRÝdÑ q5 Rd
Lc c d Rd
“ Lc Ý p Ý id ÝRÝLÝc˝ Ý p Ý id ÝLÝcq Ý 7 Ñ q5 Lc “ Rd Ý p Ý pi Ý d RÝdÝ q Ý 5˝ Ý id ÝLÝRÝdÑ q7 Rd
“ Lc Ý p Ý id ÝLÝcq ÝÑ 75 Lc “ Rd Ý p Ý id ÝRÝdÝ q Ñ 57 Rd
“ Lc Ý id ÝLÑc Lc “ Rd Ý id ÝRÑd Rd
Thefirstequality(oneachside)holdsbydefinition,thesecond(ontheleft)bynaturalityofp´q5 in
cand(ontheright)bynaturalityofp´q7 ind,thethirdbyunitalityofcomposition,andthefourth
bythe7/5isomorphism. ThisestablishesthatL % R,andhencetheresult.
Sometimes,the‘distances’measuredbytheunitandcounitaresosmallthatthecategoriesC
andD areactually‘equivalent’: thishappenswhentheunitandcounitarenaturalisomorphisms,
meaningthattheisomorphiccoreoftheadjunctionextendstothewholeofC andD. Thisgivesus
thefollowingdefinition.
Definition2.2.27. SupposeL % Rina2-category. Whentheunitandcounitoftheadjunction
areadditionallyisomorphisms,wesaythatLandRformanadjointequivalence.
38
Remark2.2.28. Moregenerally,anequivalenceofcategoriesisapairoffunctorsconnectedby
natural isomorphisms of the form of the unit and counit of an adjunction, but which may not
necessarilysatisfythetriangleidentities; however,givenanysuchequivalence,itispossibleto
modifytheunitorcounitsoastoupgradeittoanadjointequivalence. Henceforth,wewillhave
noneedtodistinguishequivalencesfromadjointequivalences,sowewillsaysimply‘equivalence’
for both. If there is an equivalence between a pair of categories, then we will say that the two
categoriesareequivalent.
Notethatthenotionofequivalenceofcategoriescanbegeneralizedtoequivalenceina2-category,
by replacing the categories by 0-cells, the functors by 1-cells, and the natural isomorphisms by
invertible2-cells.
Thestructureofanequivalenceofcategoriescanalternativelybespecifiedaspropertiesofthe
functorsconcerned,whichinsomesituationscanbeeasiertoverify.
Definition2.2.29. WesaythatafunctorF : C Ñ D is
1. full when it is surjective on hom sets, in the sense that the functions F : Cpa,bq Ñ
a,b
DpFa,Fbqaresurjections;
2. faithful whenitisinjectiveonhomsets,inthesensethatthefunctionsF areinjections;
a,b
3. fullyfaithful whenitisbothfullandfaithful(i.e.,isomorphiconhomsets);and
4. essentiallysurjectivewhenitissurjectiveonobjectsuptoisomorphism,inthesensethatfor
everyobjectd : D thereisanobjectc : C suchthatFc – d.
Proposition2.2.30. CategoriesC andDareequivalentifandonlyifthereisafunctorF : C Ñ D
thatisfullyfaithfulandessentiallysurjective.
Proof[213,Lemma9.4.5]. First,weshowthatifF % G : D Ñ C isanequivalenceofcategories,
then F : C Ñ D is fully faithful and essentially surjective. For the latter, observe that G gives
us, for any d : D, an object Gd : C and ϵ is by definition an isomorphism FGd ÝÑ „ d; hence
d
F is essentially surjective. To show that F is fully faithful means showing that each function
F : Cpa,bq Ñ DpFa,Fbqisanisomorphism;wecandefinetheinverseF´1 asthefollowing
a,b a,b
composite:
DpFa,Fbq Ý G ÝFÝaÝ,FÑb CpGFa,GFbq Ý C Ý p Ý ηa Ý ,η Ýb ´ Ý 1 Ñ q Cpa,bq
` ˘
g ÞÑ Gg ÞÑ a Ý η Ña GFa Ý G ÝÑ g GFb Ý η Ýb ´ Ñ 1 b
39
Here, the function Cpη ,η´1q is the function f ÞÑ η´1 ˝f ˝η obtained from the hom functor
a b b a
(Remark2.2.15). HenceF´1pgq :“ η´1 ˝Gg˝η . Toseethatthisisindeedthedesiredinverse,
a,b b a
considerapplyingthefunctorF tothemorphismF´1pgq;wehavethefollowingequalities:
a,b
Fa Ý F Ý η Ña FGFa Ý F Ý G ÝÑ g FGFb Ý F Ý η Ýb ´ Ñ 1 Fb
g Fη
Fη´1
“ Fa ÑÝ Fb ÝÝÑb FGFb ÝÝÝbÑ Fb
g
“ Fa ÑÝ Fb
wherethefirstequalityholdsbythenaturalityofη andthesecondequalityholdssinceη isan
b
isomorphism. SinceF isthereforeisomorphiconhomsets,itisfullyfaithful.
Next, we show that if F : C Ñ D is fully faithful and essentially surjective, then there is a
functorG : D Ñ C andnaturalisomorphismsη : id ñ GF andϵ : FG ñ id . Onobjectsd : D,
C D
wecandefineGd : C asanychoiceofobjectsuchthatFGd ÝÑ „ d: suchanobjectmustexistsince
F is essentiallysurjective. We thendefine ϵ to bethe associatedisomorphism FGd Ñ d; it is
d
easytoverifythatϵsodefinedisnatural. Onmorphisms,letthefunctionsG bedefinedasthe
d,e
compositefunctions
Dpd,eq Ý D Ý p Ý ϵ dÝ , Ý ϵ´ eÝ 1 Ñ q DpFGd,FGeq Ý F ÝG ´ Ýd 1 Ý,GÑe CpGd,Geq
` ˘ ` ˘ .
g ÞÑ FGd Ý ϵ Ñd d ÑÝ g e Ý ϵ Ý ´ eÑ 1 FGe ÞÑ F´1 ϵ´1˝g˝ϵ
Gd,Ge e d
Since F is a fully faithful functor and ϵ is a natural isomorphism, this makes G a well-defined
` ˘
functor. Finally, we define η as having the components η :“ F´1 ϵ´1 ; since ϵ is a natural
c c,GFc Fc
isomorphism,soisϵ´1,whichisthuspreservedassuchbytheinverseactionofF indefiningη.
Thisestablishesallthedataoftheequivalence.
(Notethatwecanactuallyprovealittlemore: itisnothardtoverifyadditionallythatthetwo
constructionsareinverse,sothatequivalencesarethemselvesequivalenttofullyfaithfulessentially
surjectivefunctors.)
Remark 2.2.31. In the above proof, we assumed the axiom of choice, defining Gd as a choice
of object such that FGd ÝÑ „ d. It is possible to avoid making this assumption, by asking for
the surjection on objects F : C Ñ D to be ‘split’ in the sense that it comes with a function
0 0 0
s : D Ñ C suchthatF pspdqq – dinD foreveryobjectd : D;thenwejustsetGd :“ spdq.
0 0 0
40
2.3. Universal constructions
In the preceding sections, we have used diagrams to represent some patterns in a categorical
context,andwehavediscussedhowfunctorsallowustotranslatepatternsandstructuresbetween
contexts;indeed,weusedfunctorstoformalizediagramsthemselves. Butanimportantfacetof
the notion of pattern is replication across contexts, and in many important situations, we will
encounterpatternsthatapplytoallobjectsinacategory. Wecallsuchpatternsuniversal,andmuch
ofscienceisasearchforsuchuniversalpatterns: forexample,muchofphysics,andbyextension
muchofthetheoryoftheBayesianbrain,isastudyoftheuniversalprincipleofstationaryaction.
Inthissection,weintroducetheformalcharacterizationofuniversalityandexemplifyitwithsome
examples that will be particularly importantlater on — as well as some examples that we have
encounteredalready.
2.3.1. Theuniversalityofcommonpatterns
Webeginwithsomebasicexamplesofuniversalpatterns.
2.3.1.1. Disjunctions,orcoproducts
Ourfirstexampleofauniversalpatternisthecoproduct,whichcapturestheessenceofthefollowing
examples—situationslikedisjunction,wherethereisanelementofchoicebetweenalternatives.
Example2.3.1. Giventwopropositions,suchasP :“ “´ isflat”andP :“ “´ issharp”,we
1 2
canformtheirdisjunctionP _P (meaning “´ isflatorsharp”). Similarly,giventwosubsets
1 2
P ,P Ď X,wecanformtheirjoinorunion,P YP : anelementxisanelementofP YP if
1 2 1 2 1 2
(andonlyif)itisanelementofP oranelementofP .
1 2
Example 2.3.2. Given two numbers, we can form their sum; for instance, 1 ` 2 “ 3. More
generally,giventwosetsAandB,wecanformtheirdisjointunion,denotedA`B. Theelements
ofA`B arepairspi,xqwherexisanelementofAorofB andiindicateswhichsetxisdrawn
from(thisensuresthatifanelementxofAisthesameasanelementofB,itisaddedtwicetothe
disjointunion). Therefore,ifAhas1elementandB has2,thenA`B has3elements.
Remark2.3.3. Theprecedingexampleillustrateshowwecanthinkofnumbersequivalentlyas
setsoftheindicatedcardinality. Manyoperationsonsetsaregeneralizationsoffamiliaroperations
onnumbersinthisway.
41
Example2.3.4. Giventwographs,GandG1,wecanformthesumgraphG`G1,whosesetof
nodesisG `G1 andwhosesetofedgesisG `G1.
0 0 1 1
Example2.3.5. GiventwovectorspacesV andV1,wecanformtheirdirectsumV ‘V1,whose
vectorsarelinearcombinationsofvectorseitherinV orinV1.
Eachoftheseisanexampleofacoproduct,whichwenowdefine.
Definition2.3.6. GivenobjectsAandB inacategoryC,theircoproduct (ifitexists)isanobject,
canonicallydenotedA`B,equippedwithtwomorphismsinj : A Ñ A`Bandinj : B Ñ A`B
A B
suchthat,foranyobjectQequippedwithmorphismsf : A Ñ Qandg : B Ñ Q,thereisaunique
morphismu : A`B Ñ Qsuchthatf “ u˝inj andg “ u˝inj . Themorphismsinj andinj
A B A B
arecalledinjections,andthemorphismuiscalledthecopairing andoftendenotedbyrf,gs.
Example 2.3.7. Morphisms of subsets are inclusions, so given subsets P ,P Ď X, there are
1 2
evidentinclusionsP Ď P YP andP Ď P YP . Moreover,givenasubsetQsuchthatP Ď Q
1 1 2 2 1 2 1
andP Ď Q,itisclearlythecasethatP Ď P `P Ď QandP Ď P `P Ď Q.
2 1 1 2 2 1 2
Similarly,morphismsofpropositionsareimplications,sogivenP andP suchthatP Ñ Qand
1 2 1
P Ñ Q,thenitisnecessarilythecasethatP Ñ P _P Ñ QandP Ñ P _P Ñ Q: clearly,
2 1 1 2 2 1 2
bothP andP implyP _P bydefinition,andifbothP andP implyQ,thensodoesP _P .
1 2 1 2 1 2 1 2
Example2.3.8. GivensetsAandB, theinjectionsinj : A Ñ A`B andinj : B Ñ A`B
A B
are the corresponding inclusions: inj maps a to p1,aq and inj maps b to p2,bq, where 1 tags
A B
anelementascomingfromA,and2tagsanelementascomingfromB. Givenf : A Ñ Qand
g : B Ñ Q the copairing rf,gs : A`B Ñ Q is the function that takes an element pi,xq and
returnsfpxqifi “ 1orgpxqifi “ 2;itisfromthisthatthe‘choice’interpretationarisesforthe
coproduct.
Example 2.3.9. Morphisms of vectors spaces are linear maps, and if the spaces are finite-
dimensional, then we can represent these maps as matrices: if V is n-dimensional and W is
m-dimensional,thenamorphismV Ñ W isamatrixofshapepm,nq;writingtheelementsofV
andW ascolumnvectors,suchamatrixhasmrowsandncolumns. Moreover,inthiscase,the
directsumV ‘W ispn`mq-dimensional.
ThereforesupposethatV,V1 andW haverespectivedimensionsn,n1 andm,andsupposewe
h ˆ ave ˙ linearmapsf : V Ñ W andg : V1 Ñ W. TheinjectionV Ñ V ‘V1 istheblockmatrix
1
n where1 isthen-by-nidentitymatrixand0 isthen1-by-n1 zeromatrix;similarly,the
0 n n1
n1
42
ˆ ˙
0
injectionV1 Ñ V ‘V1 istheblockmatrix n . Andthecopairingrf,gs : V ‘V1 Ñ W isthe
1
` ˘ n1
blockmatrix f g .
Remark2.3.10. Thecoproductswehaveconsideredsofarhaveallbeenbinary,beingcoproducts
ofonlytwoobjects. Moregenerally,wecanoftenconsidercoproductsofmoreobjects,byrepeating
thebinarycoproductoperation;typically,thereisanisomorphismpA`Bq`C – A`pB`Cq.
Wecanextendthisfurthertofinite(and,often,infinite)collectionsofobjects. Supposethenthat
tA uisacollectionofobjectsindexedbyi : I,whereI isaset,andformtheiteratedcoproduct
i
ř
A ;wewillcallthisobjectadependentsum,becausethesummandsA dependoni : I. Inthe
i:I i i
ř
casewheretheobjectsA areallsets,thedependentsum A isagainaset,whoseelementsare
i i i
pairspi,xqwhereiisanelementofI andxisanelementofA . InothercategoriesC,typicallythe
i
namedependentsumisreservedforthecasewhenalloftheobjectsA andtheobjectI areobjects
i
ř
ofC. ButwhenI remainsaset,wemaystillbeabletoformtheI-indexedcoproduct A inC.
i i
2.3.1.2. Conjunctions,products,andsections
Ournextexampleofauniversalpatternistheproduct,whichcapturessituationslikeconjunction,
inwhichthingscomealonginseparablepairsofindividuals.
Example2.3.11. Giventwopropositions,suchasP :“ “´ issmall”andP :“ “´ isconnected”,
1 2
wecanformtheirconjunctionP ^P (meaning “´ issmallandconnected”). Similarly,given
1 2
two subsets P ,P Ď X, we can form their meet or intersection, P X P : an element x is an
1 2 1 2
elementofP XP if(andonlyif)itisanelementofP andanelementofP .
1 2 1 2
Example2.3.12. Giventwonumbers,wecanformtheirproduct;forinstance,2ˆ3 “ 6. More
generally,aswesawinDefinition2.2.1,wecanformtheproductofanytwosetsAandB,denoted
AˆB. TheelementsofAˆB arepairspa,bqwhereaisanelementofAandbisanelementof
B. Therefore,ifAhas2elementsandB has3,thenAˆB has6elements.
Remark2.3.13. WhenallthesummandsofadependentsumarethesamesetorobjectAregardless
ř
oftheirassociatedindexi : I,thentheobject AisisomorphictotheproductI ˆA: thisis
i:I
simplyacategorificationofthefactthat“multiplicationisrepeatedaddition”.
Example2.3.14. GivenvectorspacesV andV1 (ofrespectivedimensionsnandn1),theirproduct
is again the direct sum V ‘V1. Since the direct sum of vector spaces is both a product and a
coproduct,itisalsosaidtobeabiproduct.
43
Categorically,theproductisthedualofthecoproduct.
Definition2.3.15. GivenobjectsAandB inacategoryC,theirproduct (ifitexists)isanobject,
canonically denoted A ˆ B, equipped with two morphisms proj : A ˆ B Ñ A and proj :
A B
AˆB Ñ B suchthat,foranyobjectQequippedwithmorphismsf : Q Ñ Aandg : Q Ñ B,
there is a unique morphism u : Q Ñ AˆB such that f “ proj ˝u and g “ proj ˝u. The
A B
morphismsproj andproj arecalledprojections,andthemorphismuiscalledthepairing and
A B
oftendenotedbypf,gq.
Example 2.3.16. Given subjects P ,P Ď X, there are evident inclusions P XP Ď P and
1 2 1 2 1
P XP Ď P . Moreover,givenasubsetQsuchthatQ Ď P andQ Ď P ,itisclearlythenthe
1 2 2 1 2
casethatQ Ď P XP Ď P andQ Ď P XP Ď P .
1 2 1 1 2 2
Similarly,givenpropositionsP andP suchthatQ Ñ P andQ Ñ P ,itis(bythedefinition
1 2 1 2
of“and”)thecasethatQ Ñ P ^P Ñ P andQ Ñ P ^P Ñ P .
1 2 1 1 2 2
Example2.3.17. GivensetsAandB,theprojectionsproj : AˆB Ñ Aandproj : AˆB Ñ B
A B
arethefunctionspa,bq ÞÑ aandpa,bq ÞÑ brespectively. Givenf : Q Ñ Aandg : Q Ñ B,the
` ˘
pairingpf,gq : Q Ñ AˆB isthefunctionx ÞÑ fpxq,gpxq ;notethatthisinvolves‘copying’x,
whichwillberelevantwhenwecometoconsidercopy-discardcategoriesin§3.1.
Remark2.3.18. Above,weobservedthatacoproductwithconstantsummandsAisequivalently
aproductIˆAoftheindexingobjectI withA;wethereforehaveaprojectionproj : IˆA Ñ I.
I
ř ř
Moregenerally,foranydependentsum A ,thereisaprojection A Ñ I;inthecaseof
i:I i i:I i
dependentsumsinSet,thisisunsurprisinglythefunctionpi,xq ÞÑ i.
Example2.3.19. SupposewehavevectorspacesV,V1 andW ofrespectivedimensionsn,n1 and
` ˘
m. TheprojectionV ‘V1 Ñ V istheblockmatrix 1 0 ,andtheprojectionV ‘V1 Ñ V1
n n1
` ˘
is the block matrix 0 1 . Given linear maps f : W Ñ V and g : W Ñ V1, the pairing
n n1 ˆ ˙
f
pf,gq : W Ñ V ‘V1istheblockmatrix . Notethat,inasignofthedualitybetweenproducts
g
andcoproducts,theprojectionsandthepairingarerespectivelytheinjectionsandthecopairing
transposed.
Remark2.3.20. Justasinthecaseofcoproducts,wecanalsoconsiderproductsofmorethantwo
objects,byrepeatingtheproductoperation;thereisagaintypicallyanisomorphismpAˆBqˆC –
AˆpBˆCq. IftA uisacollectionofobjectsindexedbyi : I (withI againaset),wecanform
i
44
ś
the dependent product 1 A . In the case where I is finite and the objects A are all sets, the
i:I i i
ś
dependentproduct A isagainaset,whoseelementscanequivalentlybeseenaslistspa ,...q
i:I i i
indexed byiwith eachelementa drawn fromthe correspondingset A or asfunctionsswith
i i
ř
domainI andcodomainthedependentsum A suchthateachspiqistaggedbyi.Thissituation
i:I i
issummarizedbythecommutativityofthediagram
ř
I s A
i:I i
π
I
whereπistheprojectionandwhichthereforerequiresthatπ˝s “ id . Suchafunctionsisknown
I
asasectionofp,andwecanthinkofsectionsthereforeasdependentfunctions,sincethetypesof
theiroutputvalues(i.e.,A )maydependontheinputvaluesi.
i
Thenotionofsectionisimportantenoughtowarrantageneraldefinition.
Definition2.3.21. Supposep : E Ñ B isamorphism. Asectionofpisamorphisms : B Ñ E
suchthatp˝s “ id .
B
2.3.1.3. Subobjectsandequalizers
Ournextexamplesofuniversalpatternsdonotinvolvepairingorgroupingobjectstogethertomake
newones. Forinstance,inmanysituations,itisofinteresttorestrictourattentionto‘subobjects’
(ofasinglegivenobject)thatsatisfyacertainproperty,whichmaynotextendtothewholeobject
athand.
Example2.3.22. Inexamplesabove,wesawthatsubsetsandpropositionsbehavesimilarlywith
respecttodisjunctionsandconjunctions. Morebroadly,thereisacorrespondencebetweensubsets
and propositions, if we think of propositions on a set X as functions X Ñ 2, where 2 is the
2-elementsettK,Juoftruthvalues(whereweinterpretKas‘false’andJas‘true’). Everysubset
A Ď X hasanassociatedinjection,A ãÑ X,andthereisacorrespondencebetweensuchinjections
andpropositionsP : X Ñ 2,whereP pxqistruewheneverxisanelementofA. Thissituation
A A
1Thisset-indexedproductisalsoknownasanindexedproduct,toemphasizethatthefactorsareindexedbythesetI;
sinceIhaselements,wecanproperlythinkoftheseasindices,whichmaynotbetrueforotherkindsofobject.We
willseeinDefinition2.3.63howtousecategoricalstructuretoabstractawaytherequirementthatIbeaset.
45
canbesummarizedbythecommutativityofthediagram
A ! 1
J
X 2
PA
where1isthesingletonsett˚u,!istheuniquefunctionsendingeveryelementofAto˚,andJis
thefunction˚ ÞÑ JpickingthetruthvalueJ. If,inacategoryC,thereisanobjectsuchthat,for
anysubobjectA ãÑ X,thereisauniquemorphismX Ñ 2suchthattheabovediagramcommutes
(andmoreoverdefinesapullbacksquareinthesenseofExample2.3.43below),thenwesaythat
theobject2isasubobjectclassifier inC;inthiscase,weinterpret1asthe‘terminal’objectinC
(introducedbelow,inExample2.3.41).
Apatternthatwillbeparticularlycommonisthatinwhichwecareaboutasubsetofelements
ofasetthatmaketwofunctionsequal. Thiscanbegeneralizedtoarbitrarycategoriesusingthe
followingnotion.
Definition2.3.23. Supposef andg arebothmorphismsX Ñ Y. Theirequalizer isanobjectE
equippedwithafunctione : E Ñ X suchthatf ˝e “ g˝e(sothateissaidtoequalizef andg)
asinthecommutingdiagram
f
E e X Y
g
andsuchthat,foranyd : D Ñ X equalizingf andg,thereisauniquemorphismu : D Ñ E such
thatd “ e˝u,asinthediagram
f
D u E e X Y .
g
d
Example2.3.24. Viathecorrespondencebetweensubsetsandpropositions,wecanexpressthe
conjunction of propositions as an equalizer. Suppose have have two propositions P : X Ñ 2
A
andP : X Ñ 2,correspondingtosubsetsA ãÑ X andB ãÑ X,whoseinclusionswedenoteby
B
ιA˝proj
A
ι andι respectively. Theequalizerof AˆB X isthesubsetofAˆB whose
A B
ιB˝proj
B
elementsarepairspa,bqinwhicha “ binX. ThissubsetisisomorphictothemeetAXB,which
correspondsasapropositiontotheconjunctionP ^P .
A B
46
2.3.1.4. Coequalizersandquotients
We can also make objects ‘smaller’ by dividing them into equivalence classes, as we did when
quotientingfreecategoriesbygivenrelations(cf. Proposition2.1.13). Ingeneral,thispatternis
capturedbythenotionofcoequalizer,whichisdualtothenotionofequalizerinthesamewaythat
coproductsaredualtoproducts.
Definition2.3.25. Supposef andg arebothmorphismsX Ñ Y. Theircoequalizer isanobjectP
equippedwithafunctionp : Y Ñ P suchthatp˝f “ p˝g (withpsaidtocoequalizef andg)as
inthecommutingdiagram
f
p
X Y P
g
andsuchthat,foranyq : Y Ñ Qcoequalizingf andg,thereisauniquemorphismu : P Ñ Q
suchthatq “ u˝p,asinthediagram
f
X Y p P u Q .
g
q
Example 2.3.26. A relation „ on a set X is a proposition on X ˆX, and thus equivalently a
proj ˝ι
1
subsetR ãÑ X ˆX;letιdenotetheinclusion. Thecoequalizerof R X istheset
proj ˝ι
2
ofequivalenceclassesofX accordingto„,whichispreciselythequotientX{„.
2.3.2. Thepatternofuniversality
Thereisacommonpatterntothecommonpatternsabove: ineachcase,wedescribedanobject
U equipped with some morphisms, such that, given any object X with morphisms of a similar
shape,therewasauniquemorphismurelatingX andU. Theexistenceofsuchauniquemorphism
foranycomparableX makestheobjectU auniversal representativeofthesituationathandand
hasanumberofpowerfulconsequences: inparticular,itentirelycharacterizestheobjectU upto
isomorphism. Muchofthepowerofcategorytheorycomesfromtheuseofuniversalpropertiesto
classify,compare,andreasonaboutsituationsofinterest—forthegeneralnotionofuniversality
itselfcanbecharacterizedcategorically.
Definition 2.3.27. Suppose F : C Ñ D is a functor and X : D an object. We define two dual
universal constructions. A universal morphism from X to F is a morphism u : X Ñ FU for a
correspondinguniversalobject U : C suchthatforanyf : X Ñ FV inD thereexistsaunique
e : U Ñ V suchthatf “ X ÝÑ u FU Ý F ÝÑ e FV.
47
Dually,auniversalmorphismfromF toX isamorphismu : FU Ñ X foragivenU : C such
thatforanyf : FV Ñ X inDthereexistsauniquee : V Ñ U suchthatf “ FV Ý F ÝÑ e FU ÝÑ u X.
Wecannowformalizetheuniversalpropertiesoftheexampleswemetabove,beginningwith
thecoproduct.
Example 2.3.28. Let ∆ : C Ñ C ˆC denote the functor X ÞÑ pX,Xq. A coproduct of X and
Y inC isauniversalmorphismfromtheobjectpX,YqinC ˆC to∆: thatis, anobjectX `Y
in C and a morphism pinj ,inj q : pX,Yq Ñ pX ` Y,X ` Yq in C ˆ C such that, for any
X Y
pf,gq : pX,Yq Ñ pQ,Qq in C ˆ C, the copairing rf,gs : X ` Y Ñ Q uniquely satisfies the
equationpf,gq “ pX,Yq Ý p Ý in Ý j XÝ , Ý in Ý j YÑ q pX `Y,X `Yq Ý p Ý rf Ý ,g Ý s Ý ,rf Ý , Ý g Ñ sq pQ,Qq.
Example2.3.29. Againlet∆ : C Ñ C ˆC denotethefunctorX ÞÑ pX,Xq. AproductofX and
Y in C is a universal morphism from the object pX,Yq : C ˆC to ∆: that is, an object X ˆY
in C and a morphism pproj ,proj q : pX ˆY,X ˆYq Ñ pX,Yq in C ˆC such that, for any
X Y
pf,gq : pQ,Qq Ñ pX,YqinCˆC,thepairingpf,gq : Q Ñ XˆY uniquelysatisfiestheequation
pf,gq “ pQ,Qq Ý p Ý pf Ý ,g Ý q Ý ,p Ý f, Ý g Ñ qq pX ˆY,X ˆYq Ý p Ý pr Ý o Ý j XÝ , Ý pr Ý oj ÝYÑ q pX,Yq.
Remark 2.3.30. If we let 2 denote the two-object discrete category t‚ ‚u, then there is an
equivalenceC ˆC – C2 andsoapairofmorphismsinC isequivalentlyanaturaltransformation
inC2. (Thisisacategorificationofthefamiliarfactthat“exponentiationisrepeatedmultiplication”,
whichwewillexplorein§2.3.4.)
Consequently, the functor ∆ from the preceding examples can equivalently be defined as a
functorC Ñ C2. Lettingtheexponenttakeamoregeneralshape,weobtainafamilyofconstant
functors.
Proposition 2.3.31. Suppose C and D are categories, and d : D is an object. Then there is a
constant functor on d, denoted ∆ : C Ñ D, which takes each object c : C to d : D and each
d
morphismf : c Ñ c1 toid ; notethatFc “ d “ Fc1. Theassignmentd ÞÑ ∆ isitselftrivially
d d
functorial,givingafunctor∆ : D Ñ DC whichwecalltheconstantfunctorfunctor.
Example2.3.32. LetJ bethecategorywithtwoobjects,1and2,andtwonon-identitymorphisms
α
α,β : 1 Ñ 2,asinthediagram 1 2 ,andlet∆betheconstantfunctorfunctorC Ñ CJ.
β
Nowsupposef andg aretwomorphismsX Ñ Y inC. Toconstructtheirequalizerasauniversal
morphism, let D be the diagram J Ñ C mapping α ÞÑ f and β ÞÑ g. Then an equalizer of
f and g is a universal morphism from ∆ to D (with D being an object of the functor category
48
CJ): thatis,anobjectE : C equippedwithanaturaltransformationϵ : ∆ ñ D satisfyingthe
E
universalpropertythat,foranyφ : ∆ ñ D thereexistsauniquemorphismu : F Ñ E such
F
thatφ “ ϵ˝∆ .
u
Unraveling this definition, we find that such a natural transformation ϵ consists of a pair of
morphismsϵ : E Ñ X andϵ : E Ñ Y makingthefollowingnaturalitysquarescommute:
1 2
E
ϵ1
X E
ϵ1
X
f g
E Y E Y
ϵ2 ϵ2
Wecanthereforesetϵ “ e,whereeistheequalizingmorphismE Ñ X. Thecommutativityof
1
thenaturalitysquaresenforcesthatf ˝e “ ϵ “ g˝eandhencethatf ˝e “ g˝e,whichisthe
2
firstconditiondefiningtheequalizer. Unwindingtheuniversalpropertyasexpressedhereshows
thatthemorphismsφ anducorrespondexactlytothemorphismsdanduofDefinition2.3.23.
1
Example2.3.33. Thecaseofacoequalizerispreciselydualtothatofanequalizer. Therefore,let
J,∆,andD bedefinedasabove. Acoequalizeroff,g : X Ñ Y isthenauniversalmorphism
fromD to∆.
Example2.3.34. InProposition2.1.13,weconstructedacategorygeneratedwithrelationsFG{„
as a quotient of a free category on a graph FG. Since this category FG{„ is a quotient and
quotients are coequalizers (by Example 2.3.26), the projection functor FG Ñ FG{„ (Example
2.1.26) constitutes the associated universal morphism, in the sense dual to the morphism ϵ of
1
Example2.3.32.
Example 2.3.35. The free category construction itself (Proposition 2.1.9) exhibits a universal
property,asaconsequenceofthefree-forgetfuladjunction(Example2.2.25): givenagraphG anda
categoryC,anyfunctorFG Ñ C isuniquelydeterminedbyagraphhomomorphismG Ñ UC from
GtotheunderlyinggraphofC. Moreprecisely,thereisauniversalmorphismfromthesingletonset
1tothefunctorCatpF´,CqforeverycategoryC. Thismeansthat,foranygraphG,everyfunctor
f : FG Ñ C factorsasFG Ý F ÝÑ h FUC ÝÑ u C whereuistheuniversalmorphismandhistheunique
graph homomorphism. This universal property follows abstractly from facts that we will soon
encounter: that adjoint functors are ‘representable’ (Proposition 2.4.16); and that representable
functorsareuniversal(Proposition2.4.23). WehintedatthispropertyinExample2.2.25,wherewe
observedthatfunctorsbetweenfreecategories‘are’graphhomomorphisms: thehomomorphismh
hereisthegraphhomomorphismcorrespondingtothefunctorf,andurendersitasafunctorinto
C.
49
Whenanobjectsatisfiesauniversalproperty,thenthispropertycharacterizestheobjectuniquely:
asaresult,universalpropertiesarepowerfulconstructions,tellingusthatforcertainquestions,
therecanbeonlyonepossibleanswer. Characterizinganobjectbyauniversalpropertyabstracts
awayfromcontextuallyirrelevantdetails(forexample,theparticularelementsmakingupaset),
andcrystallizesitsessence.
Theuniquenessofuniversalmorphismsisformalizedbythefollowingproposition.
Proposition 2.3.36 (Universal constructions are unique up to unique isomorphism). Suppose
u : X Ñ FU andu1 : X Ñ FU1 arebothuniversalmorphismsfromX : C toF : C Ñ D. Then
thereisauniqueisomorphismi : U Ñ U1.
Toprovethis,weneedtoknowthatfunctorspreserveisomorphisms.
Proposition 2.3.37. If F : C Ñ D is a functor and f : x Ñ y is an isomorphism in C, then
Ff : Fx Ñ Fy isanisomorphisminD.
Proof. Forf tobeanisomorphism,theremustbeamorphismf´1 : y Ñ xsuchthatf´1˝f “ id
x
andf ˝f´1 “ id . Wehaveid “ Fpid q “ Fpf´1˝fq “ Ff´1˝Ff,wherethefirstandthird
y Fx x
equations hold by the functoriality of F and the second equation holds ex hypothesi. Similarly,
id “ Fpid q “ Fpf ˝f´1q “ Ff ˝Ff´1. ThereforeFf´1 isbotharightandleftinversefor
Fy y
Ff,andsoFf isanisomorphism.
ProofofProposition2.3.36. Sinceu1 isamorphismfromX toF,theuniversalpropertyofusays
thatthereexistsauniquemorphismi : U Ñ U1 suchthatu1 “ Fi˝u. Similarly,theuniversal
propertyofu1 stipulatesthatthereexistsauniquemorphismi1 : U1 Ñ U suchthatu “ Fi1˝u1.
Wecansubstitutethelatterintotheformerandtheformerintothelatter:
u1 “ X Ý u Ñ 1 FU1 ÝÑ i1 FU Ý F Ñ i FU1 u “ X ÝÑ u FU Ý F Ñ i FU1 Ý F ÝÑ i1 FU
“ X Ý u Ñ 1 FU1 Ý F Ý p Ý i˝ Ý i Ñ 1q FU1 “ X ÝÑ u FU Ý F Ý p Ý i1 Ý ˝ Ñ iq FU
“ X Ý u Ñ 1 FU1 Ý F ÝÝ id ÝUÑ 1 FU1 “ X ÝÑ u FU Ý F Ý i Ý d ÑU FU
andsincefunctorspreserveisomorphism,wehavei˝i1 “ id andi1˝i “ id . Therefore,iisan
U1 U
isomorphismwhichisuniquebydefinition.
50
2.3.3. Limitsandcolimits: mappingintoandoutofdiagrams
Manyoftheuniversalconstructionsabove2 fallintotheirowngeneralpattern,inwhichadiagram
ofobjectsandmorphismsisspecified,andauniversalmorphismisproducedwhichencodesthe
data of mapping into or out of that diagram, in a sufficiently parsimonious way that any other
wayofmappingintooroutofthediagramfactorsthroughit. Inthecaseofthe(co)product,the
diagramissimple: simplyapairofobjects,withnomorphismsbetweenthem. Inthecaseofthe
α
(co)equalizer, the diagram is a little more complex, being a ‘fork’ of the form 1 2 . We
β
cangeneralizetheseexamplesfurther,toconsiderthemostparsimoniouswaysofmappinginto
oroutofdiagramsofarbitraryshape: theseuniversalconstructionsarecalledcolimitsandlimits
respectively,andtoformalizethem,weneedtodefinewhatitmeanstomapintooroutofadiagram.
Forthispurpose,weusethefollowingnotionofconeoveradiagram.
Definition2.3.38. AconeovertheJ-shapeddiagramDinC isanaturaltransformation∆ ñ D
c
foragivenobjectc : C whichwecallitsapex. Dually,acocone underD withapexcisanatural
transformationD ñ ∆ . WesaythatJ istheshapeofthecone.
c
Withthisdefinitiontohand,thenotionsoflimitandcolimitareeasytodefine.
Definition2.3.39. Alimit isauniversalcone,andacolimit isauniversalcocone. Moreexplicitly,
ifD isaJ-shapeddiagraminC,thenthelimitofD isauniversalmorphismfromtheconstant
diagramfunctorfunctor∆ : C Ñ CJ toD (consideredasanobjectofthefunctorcategory),and
thecolimitofDisauniversalmorphismfromDto∆;alternatively,acolimitinC isalimitinCop.
Inbothcases,theapexoftheconeistheuniversalobjectoftheconstruction,whichinthecaseof
thelimitofD wedenotebylimD,andinthecaseofthecolimit,colimD.
Notethatwewilloftensay‘(co)limit’torefertotheapexoftheuniversal(co)cone,eventhough
the(co)limitisproperlythewholeuniversalconstruction. Weareentitledtosay“the (co)limit”
thankstotheuniquenessofuniversalconstructions.
We will often denote a universal cone by proj and call its component morphisms projections;
dually,wewilloftendenoteauniversalcoconebyinjandcallitsmorphismsinjections.
Example2.3.40. Wecannowexemplifythepatternofthelimitingexamplesabove. Wewilldraw
diagramstodepicttheshapecategories,witheachsymbol‚indicatingadistinctobjectandeach
arrowÑindicatingadistinctnon-identitymorphism.
2Products,coproducts,equalizers,andcoequalizers.
51
␣ (
1. Acoproductisacolimitofshape ‚ ‚ ;
␣ (
2. aproductisalimitofshape ‚ ‚ ;
␣ (
3. anequalizerisalimitofshape ‚ ‚ ;and
␣ (
4. acoequalizerisacolimitofshape ‚ ‚ .
Of course, these are not the only possible shapes of limits and colimits. Some others will be
particularlyimportant,too.
Example2.3.41. Let0denotethecategorywithnoobjectsormorphisms. Alimitofshape0is
known as a terminal object. This is an object 1 such that, for every object X, there is a unique
morphism! : X Ñ 1. TheterminalobjectinSetisasingletonsett˚u.
Dually,acolimitofshape0isknownasaninitialobject: anobject0suchthat,foreveryobject
X,thereisauniquemorphism!: 0 Ñ X. TheinitialobjectinSetistheemptyset.
Remark2.3.42. InRemark2.2.8,wenotedthatmorphisms1 Ñ AinSetcorrespondtoelements
ofA. IngeneralcategoriesC withaterminalobject, onesometimescallsmorphismsoutofthe
terminalobjectglobalelements. Theword‘global’emphasizesthespecialpositionoftheterminal
objectinacategory,whichhasauniqueviewofeveryobject.
␣ (
Example2.3.43. Apullbackisalimitofshape ‚ ‚ ‚ . Thatis,givenmorphisms
f : A Ñ X and g : B Ñ X, their pullback is an object P and morphisms proj : P Ñ A and
A
proj : P Ñ B makingthefollowingdiagramcommute
B
proj
P B B
{
proj g
A
A X
f
intheuniversalsensethat,foranyobjectQandmorphismsπ : Q Ñ Aandπ : Q Ñ B such
A B
thatf ˝π “ g˝π ,thenthereisauniquemorphismu : Q Ñ P suchthatπ “ proj ˝uand
A B A A
π “ proj ˝u. Weindicateapullbacksquareusingthesymbol{asinthediagramabove,andwill
B B
variouslydenotethelimitingobjectP byAˆ B,f˚B,org˚A,dependingonthecontext.
X
Theinterpretationofthepullbackissomethinglikeageneralizedequation: inthecategorySet,
thepullbackAˆ B isthesubsetoftheproductAˆB consistingofelementspa,bqforwhich
X
fpaq “ gpbq. Alternatively,itcanbeunderstoodasakindofgeneralizedintersection: giventwo
objectsAandB and“waysofassigningthempropertiesinX”f andg,thepullbackAˆ B is
X
52
thegeneralizedintersectionofAandB accordingtotheseX-properties. Infact,wealreadysaw
thislatterinterpretationinExample2.3.24, whereweexhibitedanintersectionasanequalizer;
nowwecanseethatthatequalizerwas‘secretly’apullback.
␣ (
Remark2.3.44. Dually,acolimitofshape ‚ ‚ ‚ isknownasapushout.Whereas
apullbackhasaninterpretationasasubobjectofaproduct, apushouthasaninterprationasa
quotientofacoproduct. Inthiswork,wewillmakefarmoreuseofpullbacksthanpushouts.
The observation that pullbacks can be interpreted as subobjects of products (and dually that
pushoutscanbeinterpretedasquotientsofcoproducts)isaconsequenceofthemoregeneralresult
thatalllimitscanbeexpressedusingproductsandequalizers(andhenceduallythatcolimitscan
beexpressedusingcoproductsandcoequalizers).
ś
Proposition2.3.45. LetD : J Ñ C beadiagraminC,andsupposetheproducts Dpjqand
ś
j:J0
Dpcodfqexist. Then,ifitexists,theequalizerof
f:J1
ś
pDf˝proj q
ś f:J1 domf ś
Dpjq Dpcodfq
j:J0 ś f:J1
proj
f:J1 codf
isthelimitofD.
Proofsketch. ObservethattheequalizerofthediagramaboveisanobjectLsuchthat,forevery
morphismf : j Ñ j1 inJ,thediagram
L
proj j proj j1
Dj Dj1
Df
commutes,andsuchthatanyconeoverDfactorsthroughit.Thisispreciselytheuniversalproperty
ofthelimitofD,andsobyProposition2.3.36,pL,projqisthelimit.
Remark2.3.46. Asweindicatedabove,adualresultholdsexpressingcolimitsusingcoequalizers
and coproducts. Because results obtained for limits in C will hold for colimits in Cop, we will
henceforthnotalwaysgiveexplicitdualizations.
53
2.3.3.1. Functorialityoftakinglimits
InthestatementofProposition2.3.45,weusedthefactthattakingproductsextendstomorphisms,
too: afactthatwasexemplifiedconcretelyinExample2.2.5,andwhichfollowsfromthefactthata
pairofmorphismsinC isequivalentlyamorphisminC ˆC. WethensawinRemark2.3.30that
C ˆC – C2. Bylettingtheexponentagainvary,thefunctorialityoftakingproductsgeneralizesto
thefunctorialityoftakinglimits,aslongasC hasalllimitsoftherelevantshape.
Proposition2.3.47(Takinglimitsisfunctorial). SupposeC hasalllimitsofshapeJ (i.e.,forany
diagramD : J Ñ C,thelimitlimD existsinC). ThenlimdefinesafunctorCatpJ,Cq Ñ C.
Proof. Weonlyneedtochecktheassignmentiswell-definedonmorphismsandfunctorial. Suppose
D and D1 are two diagrams J Ñ C with corresponding limiting cones u : ∆ ñ D and
limD
u1 : ∆ ñ D1, and suppose δ : D ñ D1 is a natural transformation. Observe that the
limD1
compositenaturaltransformation∆ ùñ u D ùñ δ D1 isaconeonD1,andthatconesonD1 arein
limD
bijectionwithmorphismsinC intotheapexobjectlimD1. Therefore,bytheuniversalpropertyof
thelimit,thereisauniquemorphismd : limD Ñ limD1 suchthatδ˝u “ u1˝∆ . Thissituation
d
issummarizedbythecommutativityofthefollowingdiagram,wherethedashedarrowindicates
theuniquenessof∆ :
d
∆
∆ d ∆
limD limD1
u u1
D δ D1
Wedefinetheactionofthefunctorlim : CatpJ,Cq Ñ C onthenaturaltransformationδ bythis
uniquemorphismd,settinglimδ :“ d : limD Ñ limD1.
Itthereforeonlyremainstocheckthatthisassignmentisfunctorial(i.e.,thatitpreservesidentities
and composites). To see that lim preserves identities, just take δ “ id in the situation above;
D
clearly, bytheuniquenessofd, wemusthavelimid “ id . Nowsupposeδ1 : D1 Ñ D2 is
D limD
anothernaturaltransformation. Toseethatlimpδ1˝δq “ limδ1˝limδ,considerthepastingofthe
associateddiagrams:
∆ d1d
∆ ∆ d ∆ ∆ d1 ∆
limD limD1 limD2
u u1 u2
D δ D1 δ1 D2
54
Wehavelimpδ1˝δq “ d1d,whichisuniquebydefinition. Thereforewemusthaved1d “ d1˝d “
limpδ1q˝limpδq,andhencelimpδ1˝δq “ limpδ1q˝limpδqasrequired.
2.3.3.2. (Co)limitsasadjoints
Sincetakinglimitsisfunctorial,itmakessensetoaskifthefunctorlimhasanadjoint,andindeed
itdoes,inafamiliarform.
Proposition2.3.48. Thefunctorlim : CJ Ñ C isrightadjointtotheconstantdiagramfunctor
functor∆ : C Ñ CJ,i.e. ∆ % lim.
Proof. We need to show that CJp∆ ,Dq – Cpc,limDq naturally in c : C and D : J Ñ C. It is
c
sufficient to demonstrate naturality in each argument separately, by the universal property of
theproductinCat. Wehavealreadyestablishednaturalityinc : C inLemma2.3.51andshown
thattakinglimitsisfunctorial(Proposition2.3.47). Soitonlyremainstoshowthatthisextends
tonaturalityinD : J Ñ C,whichrequiresthecommutativityofthefollowingdiagramforany
δ : D Ñ D1,wherewewriteα fortheisomorphismCpc,limDq ÝÑ „ CJp∆ ,Dq:
D c
Cpc,limDq αD CJp∆ ,Dq
c
Cpc,limδq CJp∆c,δq
Cpc,limD1q α D1 CJp∆ ,D1q
c
Chasingamorphismβ : c Ñ limD aroundthisdiagram,wefindthatitscommutativityamounts
tothecommutativityofthefollowingdiagramofconesforallφ : i Ñ j inJ,wherebydefinition
α pβq “ π ˝β andα plimδ˝βq “ π1 ˝limδ˝β:
D i i D1 i i
Di δi D1i
πi˝β
πi Dφ π i 1 D1φ
c β limD limδ limD1
πj π
j
1
πj˝β
Dj D1j
δj
This diagram commutes by definition, so the isomorphism is natural in D, which therefore
establishesthedesiredadjunction.
Remark2.3.49. Dually,ifallcolimitsofshapeJ existinC,thencolimisleftadjointto∆.
55
Later,wewillseethateveryadjointfunctorexhibitsauniversalproperty(Propositions2.4.16
and2.4.23,resultsthatwe’vealreadyseenexemplifiedinExample2.3.35),andthisthereforegives
usanotherperspectiveontheuniversalityoflimits.
2.3.3.3. Hompreserveslimits
Weendthissectionwithausefulresultontheinteractionbetweenthecovarianthomfunctors
Cpc,´q : C Ñ Setandtakinglimits.
Proposition 2.3.50 (Hom functor preserves limits). Suppose D : J Ñ C is a diagram in the
categoryC. ThereisanisomorphismCpc,limDq – limCpc,Dp´qqwhichisnaturalinc : C.
To prove this proposition, it helps to have the following lemma, which establishes a natural
isomorphismbetweenthesetofmorphismsintoalimitandthesetofconesonthecorresponding
diagram.
Lemma2.3.51. Cpc,limDq – CJp∆ ,Dq,naturallyinc : C.
c
Proof. For a given c : C, the isomorphism Cpc,limDq – CJp∆ ,Dq follows directly from the
c
universalpropertyofthelimit: morphismsfromcintothelimitingobjectlimD areinbijection
withcones∆ ñ D. Soitonlyremainstoshowthatthisisomorphismisnaturalinc : C. Writing
c
α : Cp´,limDq ñ CJp∆ ,Dqforthenaturaltransformationthattakeseachmorphismintothe
p´q
limittothecorrespondingconeonD,naturalityamountstothecommutativityofthefollowing
squareforeachf : c1 Ñ cinC:
Cpc,limDq αc CJp∆ ,Dq
c
Cpf,limDq CJp∆ f ,Dq
Cpc1,limDq α c1 CJp∆ ,Dq
c1
Commutativityofthisnaturalitysquarewitnessesthefactthat,givenamorphismg : c Ñ limD,
youcaneithertakethecorrespondingconeα pgqandpullitbackalong∆ (atitsapex)toobtain
c f
theconeα pgq˝∆ ,oryoucanformthecompositemorphismg˝f andtakeitsconeα pg˝fq,
c f c1
andyou’llhavethesamecone: α pgq˝∆ “ α pg˝fq. Thisisillustratedbythecommutativity
c f c1
ofthefollowingdiagram,whichshowsfragmentsofthelimitingconedenotedπ,theconeα pgq,
c
56
andtheconeα pg˝fq,foramorphismφ : i Ñ j inJ:
c1
α c1pg˝fqi
Di
αcpgqi
πi
c1 f c g limD Dφ
πj
αcpgqj Dj
α c1pg˝fqj
Bytheuniversalpropertyofthelimit,wemusthaveα pg˝fq “ α pgq ˝f “ π ˝g˝f naturally
c1 i c i i
ini,andhenceα pg˝fq “ α pgq˝∆ .
c1 c f
ProofofProposition2.3.50. By Lemma 2.3.51, we have a natural isomorphism CJp∆ ,Dq –
c
limCpc,Dp´qq, so it suffices to establish a natural isomorphism CJp∆ ,Dq – limCpc,Dp´qq.
c
This says that cones on D with apex c are isomorphic to the limit of Cpc,Dp´qq : J Ñ Set,
naturally in c. First, note that this limiting cone in Set is constituted by a family of functions
tp : limCpc,Dp´qq Ñ Cpc,Diqu ,asinthefollowingcommutingdiagram:
i i:J
Cpc,Diq
pi
limCpc,Dp´qq Cpc,Dφq
pj
Cpc,Djq
Next,notethereisabijectionbetweencones∆ ñ DonDinC withapexc,asinthecommuting
c
diagrambelow-left,andcones∆ ñ Cpc,Dp´qqinSet,asinthecommutingdiagrambelow-right.
1
Di Cpc,Diq
βi βi
c Dφ 1 Cpc,Dφq
βj βj
Dj Cpc,Djq
By the univeral property of the limit, any cone tβ u as on the right factors uniquely through
i
limCpc,Dp´qq,asinthefollowingcommutingdiagram.Similarly,anyelementβoflimCpc,Dp´qq
inducesacorrespondingconetp pβqu,bycompositionwiththelimitingconep. Toseethatthis
i
correspondenceisanisomorphism,observethattheelementofthesetlimCpc,Dp´qqassignedto
theconetp pβqumustbeexactlyβ,sincetheuniversalpropertyoflimCpc,Dp´qqensuresthatβ
i
57
isuniquelydetermined.
βi Cpc,Diq
pi
˚ β limCpc,Dp´qq Cpc,Dφq
pj
βj Cpc,Djq
Itonlyremainstocheckthatthiscorrespondenceisnaturalinc,sosupposef isanymorphism
c1 Ñ cinC. Ifwewritep : limCpc,Dp´qq Ñ CJp∆ ,Dqtodenotethefunctionβ ÞÑ tp pβqu,
´ c i
and p1 to denote the corresponding function for c1, naturality requires the following square to
´
commute:
limCpc,Dp´qq
p´
CJp∆ ,Dq
c
limCpf,Dp´qq CJp∆ f ,Dq
p1
limCpc1,Dp´qq ´ CJp∆ ,Dq
c1
Thecommutativityofthissquareinturncorrespondstothecommutativityofthefollowingdiagram
inSet,foranyconeβ:
Cpf,Diq
Cpc,Diq Cpc1,Diq
pi p1
i
Cpc,Dφq Cpc1,Dφq
β
1 limCpc,Dp´qq limCpc1,Dp´qq
limCpf,Dp´qq
pj p1
j
Cpc,Djq Cpc1,Djq
Cpf,Djq
By the correspondence between cones ∆ ñ D in C and cones ∆ ñ Cpc,Dp´qq in Set, this
c 1
diagramcommutesifandonlyifthefollowingdiagramcommutes:
Di
βi˝f
βi
c1 f c Dφ
βj
βj˝f Dj
Thisdiagramcommutesbythedefinitionofβ andofthecompositestβ ˝fu,therebyestablishing
i
the naturality of the isomorphism limCpc,Dp´qq – CJp∆ ,Dq. Since we also have a natural
c
isomorphismCJp∆ ,Dq – Cpc,limDq,wehaveestablishedtheresult.
c
58
Theprecedingproofestablishedmorethanjustthehomfunctor’spreservationoflimits: itgave
usanotherusefulnaturalisomorphism,thistimebetwenthesetofcones∆ ñ D inC andtheset
c
ofcones∆ ñ Cpc,DqonthediagramCpc,Dq : J Ñ Setwithapextheterminalset1.
1
Corollary2.3.52. ThereisanisomorphismCJp∆ ,Dq – SetJp∆ ,Cpc,Dqq,naturalinc : C.
c 1
Remark 2.3.53. Since limits in Cop are colimits in C, Proposition 2.3.50 implies that the
contravarianthomfunctorsCp´,cqturnlimitsintocolimits;i.e. CplimD,cq – colimCpDp´q,cq.
2.3.4. Closedcategoriesandexponentialobjects
A distinguishing feature of adaptive systems such as the brain is that they contain processes
whichthemselvescontrolotherprocesses,andsoitisusefultobeabletoformalizethissituation
compositionally. Whenacategorycontainsobjectswhichthemselvesrepresentthemorphismsof
thecategory,wesaythatthecategoryisclosed: insuchcategories,wemayhaveprocesseswhose
outputsareagainprocesses,andwemaythinkofthelatterascontrolledbytheformer.
A basic instance of this mathematical situation is found amidst the natural numbers, where
repeatedmultiplicationcoincideswithexponentiation,asin2ˆ2ˆ2 “ 23. Ifwethinkofnumbers
assetsofthecorrespondingsize,andlet23 denotethesetoffunctions3 Ñ 2,thenitisnothard
to see that there are 8 such distinct functions. If we generalize this situation from numbers to
arbitraryobjects,andfromfunctionstomorphisms,weobtainthefollowinggeneraldefinitionof
exponentiation.
Definition 2.3.54. Let ˆ denote the product in a category C. When there is an object e : C
suchthatCpx,eq – Cpxˆy,zqnaturallyinx,wesaythateisanexponentialobject anddenote
it by zy. The image of id zy under the isomorphism is called the evaluation map and is written
ev : zy ˆy Ñ z.
y,z
Example2.3.55. InSet,givensetsAandB,theexponentialobjectBA isthesetoffunctions
A Ñ B. Givenafunctionf : A Ñ B,theevaluationmapev actsbyapplyingf toelementsof
B,A
A: i.e.,ev pf,aq “ fpaq.
B,A
Typically, we are most interested in situations where every pair of objects is naturally
exponentiable,whichinducesthefollowingadjunction,formalizingtheideathatexponentiationis
repeatedmultiplication.
59
Proposition2.3.56. WhentheisomorphismCpxˆy,zq – Cpx,zyqisadditionallynaturalinz,we
obtainanadjunctionp´qˆy % p´qy calledtheproduct-exponentialadjunction,andthisuniquely
determinesafunctorCopˆC Ñ C : py,zq ÞÑ zy thatwecalltheinternalhomforC.
Proof. ThatthenaturalisomorphisminducesanadjunctionisimmediatefromProposition2.2.26;
thecounitofthisadjunctionisthefamilyofevaluationmapsev : p´qyˆy ñ id . Theuniqueness
C
oftheinternalhomfollowsfromtheuniquenessofadjointfunctors(whichwewillestablishin
Corollary2.4.18).
Definition2.3.57. AcategoryC inwhicheverypairofobjectshasaproductiscalledCartesian. A
CartesiancategoryC withacorrespondinginternalhomiscalledCartesianclosed.
Example2.3.58. We’vealreadyseenthatSetisCartesianclosed. SoisCat: theinternalhomCB
isthecategoryoffunctorsB Ñ C.
Example2.3.59(Anon-example). ThecategoryMeasofmeasurablespaceswithmeasurable
functionsbetweenthemisCartesianbutnotCartesianclosed: theevaluationfunctionisnotalways
measurable[15]. Inthiscontext,wewillintroducequasi-Borelspaces (originallyduetoHeunen
etal.[131])in§4.1.5,inordertoconstructstochasticprocesseswhichemitfunctions.
It is not hard to prove the following result, which says that Cartesian closed categories can
“reasonaboutthemselves”.
Proposition2.3.60. ACartesianclosedcategoryisenrichedinitself.
This‘internalization’iswitnessedbythehomfunctors,whichinthecaseofaCartesianclosed
enrichingcategoryE becomeE-functors.
Proposition 2.3.61. Suppose C is an E-category where E is Cartesian closed. Then the hom
functorCp´,“qisanE-functorCopˆC Ñ E. Onobjectspc,dq,thehomfunctorreturnstheobject
Cpc,dqinE ofmorphismsc Ñ d. Then,foreachquadruplepb,c,a,dqofobjectsinC,wedefinean
` ˘
E-morphismCoppb,aqˆCpc,dq Ñ E Cpb,cq,Cpa,dq astheimageofthecomposite
` ˘ ` ˘
α
Cpa,bqˆCpc,dq ˆCpb,cq ÝÑ Cpa,bqˆ Cpc,dqˆCpb,cq ¨¨¨
¨¨¨ Ý C Ý p Ý a, Ý bq Ý ˆ Ý ˝ Ýb,ÝcÑ,d Cpa,bqˆCpb,dq ÝÑ σ Cpb,dqˆCpa,bq Ý ˝ Ýa,ÝbÑ,d Cpa,dq
undertheproduct-exponentialisomorphism
´ ¯
` ˘ ` ˘
E Cpa,bqˆCpc,dq, Cpa,dqCpb,cq – E Cpa,bqˆCpc,dq ˆCpb,cq, Cpa,dq
60
whereαistheassociativtyoftheproductandσ isitssymmetryX ˆY – Y ˆX,andwherewe
haveusedthatCoppb,aq “ Cpa,bq.
Remark2.3.62. Therôleofthesymmetryhereistestamenttothefactthatwecanreadacomposite
morphismg˝f aseither“g afterf”or“f beforeg”.
Proofsketch. TogiveanE-functor(Definition2.2.10)istogiveafunctiononobjectsandafamily
ofE-morphisms(correspondingtothehomobjectsofC)suchthatidentitiesandcompositesare
preserved. Wehavegivensuchafunctionandsuchafamilyinthestatementoftheproposition,
andsoitremainstochecktheaxioms:thesefollowbytheunitalityandassociativityofcomposition
inanE-category(Definition2.2.6).
WhenE isCartesianclosed,thenasacorollaryitshomfunctorEp´,“qisanE-functor.
Whenadiagramcommutes,everyparallelpathisequalwheninterpretedasamorphism. Ifa
diagramcommutesuptosome2-cellor2-cells,thenparallelpathscanbetransformedintoeach
otherusingthe2-cell(s). Muchcategoricalreasoningthereforeconsistsinusingmorphismsinthe
baseofenrichmenttotranslatebetweendifferenthomobjects;thesimplestsuchofcoursebeing
pre-andpost-composition. Inthenextsection,wewillseemanyexplicitexamplesofthiskindof
reasoningwhenweprovetheYonedaLemma—whichsaysthatthehomobjectscontainallthedata
ofthecategory—butwehavealreadyseenexamplesofitabove,whenweconsideredadjunctions:
afterall,adjunctionsarefamiliesofisomorphismsbetweenhomobjects.
WhenacategoryisCartesianclosed,itisitsownbaseofenrichment,andsoonedoesnothave
tomovetoanexternalperspectivetoreasoncategoricallyaboutit: onecandosousingits‘internal
language’. Wehavealreadyseenacorrespondencebetweenthelanguageoflogicandthatofsets,
inwhichwecanthinkofelementsofsetsaswitnessestotheproofofpropositionsrepresented
by those sets, and where logical operations such as conjunction and disjunction correspond to
operationsonsets. ThiscorrespondenceextendstoCartesianclosedcategoriesgenerally: universal
constructionssuchasthosewehaveintroducedabovecanbeinterpretedasencodingthelogicof
theinternallanguage.
Moreprecisely,Cartesianclosedcategoriesaresaidtoprovidethesemanticsfordependenttype
theory: ahigher-orderlogicinwhichpropositionsaregeneralizedby‘types’3. Onecanconstruct
a‘syntactic’categoryrepresentingthelogicofthetypetheory,andtheninterpretitfunctorially
3Atypeissomethinglikeapropositioninwhichwe’re‘allowed’todistinguishbetweenitswitnesses,whichwecall
termsofthegiventype.
61
in a Cartesian closed category. This correspondence is known as the Curry-Howard-Lambek
correspondence, which says that logical proofs correspond to morphisms in a Cartesian closed
category,andthatsuchmorphismscanequallybeseenasrepresentingthefunctionscomputed
by deterministic computer programs. (In general, the correspondence is an adjoint one: dually,
onecanconstructfromagivencategorya‘syntactic’categoryencodingthelogicofitsinternal
language.)
Whenacategorymoreoverhas(internal)dependentsumsandproducts,thenitcanbeinterpreted
asamodelofdependenttypetheory,inwhichtypesthemselvesmaydependonvalues;forinstance,
onemightexpectthatthetypeofaweatherforecastshoulddependonwhetheroneisonlandorat
sea. Wewillnotsaymuchmoreaboutdependenttypetheory,althoughwewillmakeimplicituse
ofsomeofitsideaslaterinthethesis. Therefore,beforemovingontotheYonedaLemma,wewill
sayjustenoughtodefinethenotionofdependentproduct‘universally’,withoutreferencetosets.
2.3.4.1. Dependentproducts
InRemark2.3.20,wediscussedproductswherethefactorswereindexedbyanarbitrarysetand
explainedhowtheycorrespondtosetsofgeneralized‘dependent’functions,wherethecodomain
typemayvarywiththeinput. Inthatcase,wewererestrictedtoconsideringproductsindexedby
sets,butwiththemachineryoflimitsathand,wecan‘internalize’thedefinitiontootherCartesian
closedcategories.
Definition2.3.63. SupposeC isCartesianclosedandhasalllimits,andsupposep : E Ñ B isa
ś
morphisminC. Thedependentproduct ofpalongB isthepullbackobject pasinthediagram
B
ś
p EB
B
{
pB
1 BB
idB
where1istheterminalobject,id istheelementpickingtheidentitymorphismB Ñ B,andpB is
B
thepostcompositionmorphisminducedbythefunctorialityofexponentiation.
ř
Remark2.3.64. Whenpistheprojection P Ñ B outofadependentsum,wewillwriteits
b:B b
ś ř
dependentproductas P . SinceaproductBˆC isisomorphictothedependentsum C,
b:B b b:B
ś
notethatthismeanswecanalternativelywritetheexponentialobjectCB as C.
b:B
TounderstandhowDefinition2.3.63generalizesRemark2.3.20,wecaninterprettheformerin
Setandseethatthetwoconstructionscoincide. ThesetEB isthesetoffunctionss : B Ñ E,
62
and pB acts by s ÞÑ p˝s. The indicated pullback therefore selects the subset of EB such that
p˝s “ id . Thisispreciselythesetofsectionsofp,whichisinturnthedependentproductofpin
B
Set.
Remark 2.3.65. Definition 2.3.63 is entirely internal to C: it depends only on structure that is
available within C itself, and not on ‘external’ structures (such as indexing sets) or knowledge
(suchasknowledgeofthemake-upoftheobjectsofC). Itisepistemicallyparismonious: apurely
categoricaldefinition,statedentirelyintermsofuniversalconstructions.
Remark2.3.66. UndertheCurry-Howard-Lambekcorrespondence,exponentialobjectsrepresent
the propositions that one proposition implies another; in type theory, they represent the type
of functions from one type to another. As dependent exponential objects, dependent products
couldthereforebeseenasrepresenting‘dependent’implications;aswehavealreadyseen,theydo
representthetypeofdependentfunctions. However,dependentproductsandsumshaveanother
ś
kindoflogicalinterpretation: asquantifiers. Thatis,thelogicalpropositionrepresentedby P
b:B b
ś
is@b : B.Ppbq: anelementof P isaproofthat,forallb : B,thepropositionPpbqissatisfied.
b:B b
ř ř
Dually, the proposition represented by P is Db : B.Ppbq: an element of P is a pair
b:B b b:B b
pb,xqofawitnesstoB andawitnessxofthesatisfactionofPpbq.
2.4. The Yoneda Lemma: a human perspective
We end this chapter by introducing the fundamental theorem of category theory, the Yoneda
Lemma, which expresses mathematically the idea that to know how a thing is related to other
thingsistoknowtheidentityofthethingitself. Thenotionofrelationalidentityisrecognized
throughouthumanendeavour. Inlinguistics,itunderliestheobservationofFirth[92]that“you
shall know a word by the company it keeps!”, which in turn is the foundation of distributional
semanticsandthusmuchofcontemporarynaturallanguageprocessinginmachinelearning. In
culture, it is illustrated by the ancient parable of the blind men and the elephant, in which the
identity of the creature is only known by stitching together evidence from many perspectives.
Insociety,itisreflectedintheSouthAfricanphilosophyofubuntu (meaning“Iambecausewe
are”)andtheMa¯orinotionofwhanaungatanga(inwhichpersonalidentityisdevelopedthrough
kinship),andtheobservationthat“actionsspeaklouderthanwords”. Finally,theYonedaLemmais
manifestinscience,whereourunderstandingofphenomenaderivesfromtheaccumulationacross
contextsofresultsandtheirinterpretationandtranslation: nosingleindividualunderstandsthe
totalityofanysubject,andnosubjectorphenomenonisunderstoodinisolation.
63
2.4.1. FormalizingcategoricalreasoningviatheYonedaembedding
In§2.3.4,wesawhowCartesianclosedcategoriesallowustointernalizecategoricalreasoning. The
categorySetisthearchetypalCartesianclosedcategory,andconstitutesthebaseofenrichment
foralllocallysmallcategories. TheYonedaembeddingallowsustomovefromreasoningabout
theobjectsinanygivencategoryC toreasoningaboutthemorphismsbetweenitshomsets: the
naturaltransformationsbetweenhomfunctors. Inthiscontext,thehomfunctorsconstitutespecial
examplesoffunctorsintothebaseofenrichment,whichwecall‘presheaves’(contravariantly)and
‘copresheaves’(covariantly),andwhichcanbethoughtofasC-shapeddiagramsinSet.
Definition2.4.1. LetCbeacategory. Apresheaf onCisafunctorCop Ñ Set. Dually,acopresheaf
isafunctorC Ñ Set. Thecorrespondingfunctorcategoriesarethecategoriesof(co)presheaveson
C.
Remark2.4.2. Intheenrichedsetting, whenC isenrichedinE, anE-presheaf isanE-functor
Cop Ñ E andanE-copresheaf isanE-functorC Ñ E.
Asafirstexampleofapresheaf,wehaveanalternativedefinitionofthenotionofdirectedgraph.
Example2.4.3. LetGdenotethecategoryofExample2.1.5containingtwoobjects0and1and
twomorphismss,t : 0 Ñ 1. ThenadirectedgraphisapresheafonG.
Thisdefinitionisjustifiedbythefollowingproposition.
Proposition2.4.4. ThereisanequivalenceofcategoriesGraph – Set Gop,whereGraphisthe
categoryofdirectedgraphsintroducedinExample2.1.11.
Proof. To each graph G we can associate a presheaf G : Gop Ñ Set by defining Gp0q :“ G ,
0
Gp1q :“ G ,Gpsq :“ dom andGptq :“ cod ;andtoeachpresheafwecanlikewiseassociatea
1 G G
graph,sothatwehavedefinedabijectiononobjects. Itthereforeonlyremainstoshowthatthere
isabijectionbetweengraphhomomorphismsandnaturaltransformationsaccordingly: butthisis
easytoseeoncewehaveobservedthatthegraphhomomorphismaxiomsarepreciselythelawof
naturality,asillustrateddiagrammaticallyin(2.1).
Takingagainageneralperspective,theYonedaembeddingistheembeddingofacategoryC into
itspresheafcategory,obtainedbymappingc : C tothepresheafCp´,cq;andthereisofcoursea
dual‘coYoneda’embedding.
64
Remark 2.4.5. We say ‘embedding’ to mean a functor that is injective on objects and faithful
(injectiveonhomsets). TheYonedaembeddingwillturnouttobefullyfaithful(bijectiveonhom
sets),asaconsequenceoftheYonedalemma.
Owingtoitsimportance,wemakeaformaldefinitionoftheYonedaembedding.
Definition2.4.6. LetC beacategory. Byapplyingtheproduct-exponentialadjunctioninCatto
thehomfunctorCp´,“q : Cop ˆC Ñ Set,weobtainafunctorよ: C Ñ SetCop : c ÞÑ Cp´,cq
of C into its presheaf category, and dually a functor よ : Cop Ñ SetC : c ÞÑ Cpc,“q into the
copresheafcategory. WecalltheformerfunctortheYonedaembedding andthelatterthecoYoneda
embedding. When C is an E-category and E is Cartesian closed, then the Yoneda embedding is
insteadanE-functorC Ñ ECop (andlikewiseforthecoYonedaembedding).
Remark2.4.7. Thisabstractdefinitiondoesnotmakeexplicithowよ actsonmorphisms.However,
wehavealreadyseenthisaction,whenwefirstexemplifiednaturaltransformationsinExample
2.2.18.
As we discussed in §2.3.4, much categorical reasoning corresponds to following morphisms
betweenhomobjects,andoftenthereasoningisagnosticeithertowhereonestarts,ortowhere
one ends up. The Yoneda embedding witnesses such proofs as morphisms in the (co)presheaf
categories. Asanexample,considertheproofofProposition2.4.20below: eachstepcorrespondsto
theapplicationofanaturaltransformation.
Remark 2.4.8. It also so happens that every (co)presheaf category is very richly structured,
inheritingitsstructurefromthebaseofenrichment. Forexample,thismeansthatthepresheaf
categorySetCop hasalllimits,isCartesianclosed,hasasubobjectclassifier,anddependentsums
andproducts,evenwhenChasnoneofthese.(Interestingly,thismeansthatthecategoryofdirected
graphsisaccordinglyrichlystructured,beingapresheafcategorybyProposition2.4.4.) Asaresult,
(co)presheafcategoriesareverypowerfulplacestodocategoricalreasoning.
2.4.2. Knowingathingbyitsrelationships
TheYonedalemmasaysthatevery(co)presheafonC isdeterminedby“howitlooksfromC”. Since
underthe(co)Yonedaembeddingeveryobjectgivesrisetoa(co)presheaf,acorollaryoftheYoneda
lemmaisthateveryobjectcanbeidentifiedbyitsrelationships.
65
Remark2.4.9. IfthebaseofenrichmentofacategoryisCartesianclosed,thenonecanprovean
analogousenrichedversionoftheYonedalemma. WewillonlyprovethestandardSet-enriched
casehere.
WewillalsoonlyprovetheYonedalemmaforpresheaves;thereisofcourseadualcoYoneda
lemmaforcopresheaves,whichfollowssimplybyswappingC forCop.
Theorem2.4.10(Yonedalemma). LetF : Cop Ñ SetbeapresheafonC. Thenforeachc : C,
thereisanisomorphismFc – SetCop pCp´,cq,Fq. Moreover,thisisomorphismisnaturalinboth
F : Cop Ñ Setandc : C.
Proof. We first define a mapping γ : Fc Ñ SetCop pCp´,cq,Fq as follows. Given h : Fc, we
define the natural transformation γphq : Cp´,cq ñ F to have components γphq : Cpb,cq Ñ
b
Fb : f ÞÑ Ffphq; note that since h : Fc and f : b Ñ c, we have Ff : Fc Ñ Fb and hence
Ffphq : Fb. To check that this definition makes γphq into a natural transformation, suppose
g : a Ñ b. WeneedtocheckFg˝γphq “ γphq ˝Cpg,cq. SinceCpg,cqpfq “ f ˝g,thismeans
b a
verifyingFg˝Ffphq “ Fpf ˝gqphq. ButF isacontravariantfunctor,soFpf ˝gq “ Fg˝Ff,
therebyestablishingnaturality.
Conversely, we define a mapping γ1 : SetCop pCp´,cq,Fq Ñ Fc as follows. Suppose α is a
naturaltransformationCp´,cq ñ F,sothatitscomponentatcisthefunctionα : Cpc,cq Ñ Fc.
c
Wedefineγ1pαq :“ α pid q.
c c
Next,weneedtoestablishthatγ andγ1 aremutuallyinverse. First,wecheckthatγ1˝γ “ id .
Fc
Givenh : Fc,wehave
γ1pγphqq “ γphq pid q “ Fpid qphq “ id phq “ h
c c c Fc
as required. We now check that γ ˝γ1 “ id SetCop
pCp´,cq,Fq
. Given α : Cp´,cq ñ F, we have
γ1pαq “ α pid q by definition. Hence γpγ1pαqq : Cp´,cq ñ F has components γpγ1pαqq :
c c b
Cpb,cq Ñ Fb which act by f ÞÑ Ffpα pid qq. So we need to show that Ffpα pid qq “ α pfq.
c c c c b
Thisfollowsdirectlyfromthenaturalityofα. Thecommutativityofthenaturalitysquareonthe
leftinparticularholdsatid : Cpc,cqasontheright:
c
Cpc,cq
αc
Fc id α pid q
c c c
Cpf,cq Ff
Cpb,cq Fb f α pfq “ Ffpα pid qq
α b c c
b
66
Note that Cpf,cqpid c q “ id c ˝f “ f. This establishes that γ ˝γ1 “ id SetCop pCp´,cq,Fq , and since
γ1˝γ “ id ,wehaveFc – SetCop pCp´,cq,Fq.
Fc
ItremainstoverifythatthisisomorphismisnaturalinF andc. Supposeφ : F ñ F1isanatural
transformation,andwriteγ1 forthefunctionγ1 definedabove,andγ1 forthecorresponding
Fc F1c
functionforF1. NaturalityinF meansthatthediagramontheleftbelowcommutes,whichwe
canseebychasingthenaturaltransformationαasontheright:
SetCop pCp´,cq,Fq γ F 1 c Fc α γ1 pαq
Fc
SetCop pCp´,cq,φq φc
γ1
SetCop pCp´,cq,F1q F1c F1c φ˝α γ
F
1
1c
pφ˝αq “ φ
c
˝γ
F
1
c
pαq
Sinceγ1 pαq :“ α pid qandγ1 pφ˝αq :“ φ ˝α pid q,theequationγ1 pφ˝αq “ φ ˝γ1 pαq
Fc c c c F1c c c c c F1c c Fc
holdsbydefinition,therebyestablishingnaturalityinF. Finally,supposef : b Ñ cinC,andwrite
γ forthefunctionγ definedaboveandγ forthecorrespondingfunctionforb : C. Naturality
Fc Fb
incmeansthecommutativityofthefollowingdiagram:
Fc
γFc SetCop
pCp´,cq,Fq
Ff SetCop pCp´,fq,Fq
Fb γ Fb SetCop pCp´,bq,Fq
Suppose h : Fc. The component of γ phq at a : C is the function γ phq : Cpa,cq Ñ Fa
Fc Fc a
defined by g ÞÑ Fgphq. The component of SetCop pCp´,fq,Fq ˝ γ phq at a : C is thus the
Fc
function γ phq ˝Cpa,fq : Cpa,bq Ñ Fa taking g : a Ñ b to Fpf ˝gqphq. On the other hand,
c a
the component of γ pFfphqq at a : C is the function γ pFfphqq : Cpa,bq Ñ Fa taking g
Fb Fb a
to FgpFfphqq. Since F is a contravariant functor, we have Fpf ˝ gqphq “ FgpFfphqq. This
establishesthecommutativityofthenaturalitysquare,andthusnaturalityincaswellasF.
The identification of an object with its collection of hom sets is formalized by the following
corollary.
Corollary2.4.11(Representablesareuniqueuptoisomorphism). Supposethereisanisomorphism
ofpresheavesCp´,aq – Cp´,bq. Thena – binC.
Thiscorollaryfollowsfromthenextone,whichexpressesthattheimageoftheYonedaembedding
isisomorphicwithC itself.
67
Corollary2.4.12. TheYonedaembeddingisfullyfaithful.
Proof. TheYonedaembeddingdefinesafamilyoffunctionsonthehomsetsofC:
よ : Cpb,cq Ñ SetCop pCp´,bq,Cp´,cqq
b,c
f ÞÑ Cp´,fq
By the Yoneda lemma, we immediately have SetCop pCp´,bq,Cp´,cqq – Cpb,cq, which is the
requiredisomorphismofhomsets.
Next, wehavethefollowingfact, thatfullyfaithfulfunctorstransportisomorphismsintheir
codomaintotheirdomain(they‘reflect’them).
Proposition2.4.13(Fullyfaithfulfunctorsreflectisomorphisms). SupposeF : C Ñ D isafully
faithfulfunctor. Iff : a Ñ bisamorphisminC suchthatFf isanisomorphisminD,thenf isan
isomorphisminC.
Proof. Ff : Fa Ñ Fbbeinganisomorphismmeansthatthereisamorphismg1 : Fb Ñ FainD
suchthatg1˝Ff “ id andFf ˝g1 “ id . BythefunctorialityofF,wehaveid “ F id and
Fa Fb Fa a
id “ F id . Henceg1˝Ff “ F id andFf˝g1 “ F id . SinceF isisomorphiconhomsets,there
Fb b a b
isauniqueg : b Ñ asuchthatg1 “ Fg. HenceFg˝Ff “ F id andFf ˝Fg “ F id . Bythe
a b
functorialityofF,wehaveFg˝Ff “ Fpg˝fqandFf˝Fg “ Fpf˝gq. HenceFpg˝fq “ F id
a
andFpf ˝gq “ F id . Finally,sinceF isisomorphiconhomsets,wemusthaveg˝f “ id and
b a
f ˝g “ id ,andhencef isanisomorphisminC.
b
Andthisgivesustheproofweseek:
ProofofCorollary2.4.11. SincetheYonedaembeddingisfullyfaithful(Corollary2.4.12),itreflects
isomorphismsbyProposition2.4.13.
PresheavesintheimageoftheYonedaembeddingconsequentlyplayaspecialrôleincategory
theory:toshowthatanarbitrarypresheafF isisomorphictoCp´,cqistoidentifyitwiththeobject
citself,andinthiscase,wecansaythatF isrepresented byc. Wethereforemakethefollowing
definition.
Definition2.4.14. SupposeF isapresheafonC. Wesaythatitisrepresentableifthereisanatural
isomorphismF – Cp´,cqforsomeobjectc : C whichwecallitsrepresentingobject;wecallthe
naturalisomorphismCp´,cq ñ F itsrepresentation. Dually,ifF isinsteadacopresheaf,wecall
68
itcorepresentable ifthereisanaturalisomorphismF – Cpc,“q,withcbeingthecorepresenting
object;wecallthenaturalisomorphismCpc,“q ñ F itscorepresentation.
Remark2.4.15. Corepresentablecopresheaveswillplayanimportantrôlelaterinthisthesis: their
coproductsarecalledpolynomialfunctors(§3.5),andthesewillbeusedtoformalizetheinterfaces
ofinteractingadaptivesystems.
Viatheuniquenessofrepresentables,theYonedalemmaunderliesuniversalconstructions,since
knowingthemorphismsintooroutofanobjectisenoughtoidentifythatobject. Thedefinitionof
alimit,notably,isthestatementthatmorphismsintoitcorrespondtomorphismsintoadiagram;
andthisinturnisequivalentlythestatementthatlimisrightadjointto∆. Indeed,adjointness
isitselfacertainkindofrepresentability: thedefinitionofadjointfunctor(2.2.24)ispreciselya
naturalcharacterizationofmorphismsintoandoutofobjects,asrelatedbytheadjunction!
Proposition2.4.16(Adjointsarerepresentable). SupposeR : D Ñ C isrightadjointtoL. Then
foreveryd : D,thepresheafDpL´,dq : Cop Ñ SetisrepresentedbytheobjectRd : C. Dually,
thecopresheafCpc,R´q : D Ñ SetiscorepresentedbytheobjectLc : D.
Proof. SinceL $ R,wehaveanisomorphismDpLc,dq – Cpc,Rdqnaturalincandd. Therefore
inparticularwehaveanaturalisomorphismofpresheavesCp´,Rdq ñ DpL´,dqandanatural
isomorphismofcopresheavesDpLc,´q ñ Cpc,R´q;theformerisarepresentationandthelatter
acorepresentation.
Fromthis,wecanformalizetherepresentabilityoflimitsandcolimits.
Corollary 2.4.17 (Limits are representations). Suppose D : J Ñ C is a diagram in C. A limit
of D is a representation of CJp∆ ,Dq : Cop Ñ Set, or equivalently of SetJp∆ ,Cp´,Dqq.
p´q 1
Dually, a colimit of D is a corepresentation of CJpD,∆ q : C Ñ Set, or equivalently of
p´q
SetJp∆ ,CpD,´qq.
1
Proof. IfC hasalllimitsofshapeJ,thenthisfollowsdirectlyfromthefactsthatlimisrightadjoint
to∆(Proposition2.3.48)andthatadjointsarerepresentable(Proposition2.4.16);thedualresult
followssimilarlyfromthefactthatcolimisleftadjointto∆.
Otherwise, the limit case follows immediately from Lemma 2.3.51 (or equivalently Corollary
2.3.52)andthedefinitionofrepresentation(2.4.14);thecolimitcaseisformallydual.
Accordingly,werecovertheuniquenessofuniversalconstructions.
69
Corollary2.4.18. Adjointfunctorsareuniqueuptouniqueisomorphism.
Corollary2.4.19. Limitsandcolimitsareuniqueuptouniqueisomorphism.
Usingtheseideas,weobtainthefollowingusefulresultrelatinglimitsandadjointfunctors.
Proposition2.4.20(Rightadjointspreservelimits). SupposeD : J Ñ D isadiagraminD and
L $ R : D Ñ C isanadjunction. ThenRlimD – limRD inC.
Proof. Wehavethefollowingchainofnaturalisomorphisms:
Cpc,RlimDq – DpLc,limDq sinceRisrightadjointtoL
– limDpLc,Dq sincehompreserveslimits
– limCpc,RDq sinceRisrightadjointtoL
– Cpc,limRDq sincehompreserveslimits
Sincerepresentablesareuniqueuptoisomorphismandwehaveestablishedanisomorphismof
presheavesCp´,RlimDq – Cp´,limRDq,wemusthaveRlimD – limRD inC.
Remark2.4.21. Thereisofcourseadualresultthatleftadjointspreservecolimits.
Remark2.4.22. Onemightspeculateabouttheconverse: isitthecasethatthepreservationof
limits by a functor is enough to guarantee the existence of its left adjoint? The answer to this
question is, “under certain conditions” on the size and structure of the categories and functors
involved,andapositiveansweriscalledanadjointfunctortheorem. The“certainconditions”hold
quite generally, and so it is often sufficient just to check whether a functor preserves limits (or
colimits)toseethatitisaright(orleft)adjoint.
Weendthischapterbyclosingtheloopbetweenuniversalityandrepresentability.
Proposition2.4.23(Universalityofrepresentability). RepresentablepresheavesF : Cop Ñ Set
correspondbijectivelytouniversalmorphismsfrom1 : SettoF.
Proof. ArepresentationofF isachoiceofobjectc : C andanaturalisomorphismυ : Cp´,cq ñ F.
WeconstructabijectionbetweenthesetofrepresentationsofF andthesetofuniversalmorphisms
from1toF.Thereforesupposegivenarepresentationυ : Cp´,cq ñ F ofF;itscomponentatc : C
istheisomorphismυ : Cpc,cq Ñ Fc. TheYonedalemmaassignstoυ anelementγ1pυq : 1 Ñ Fc
c
satisfyingγ1pυq “ υ pid q. Wenowshowthatthiselementυ pid qsatisfiestheuniversalproperty
c c c c
70
thatforallf : 1 Ñ Fbthereexistsauniquemorphismh : b Ñ cinC suchthatf “ Fh˝υ pid q.
c c
Thereforeletf beanysuchelement1 Ñ Fb. Sinceυ isanaturalisomorphism,ithasaninverse
component at b : C, denoted υ1 : Fb Ñ Cpb,cq, and so we obtain by composition an element
b
h :“ 1 ÝÑ f Fb Ý υ Ñb 1 Cpb,cq of Cpb,cq. Such an element is precisely a morphism h : b Ñ c in C.
Considernowthefollowingdiagram:
1
idc
Cpc,cq
Cph,cq
Cpb,cq
υcpidcq υc υ b
Fc Fh Fb
The triangle on the left commutes by definition and the square on the right commutes by the
naturalityofυ,sothatthewholediagramcommutes. ThecompositemorphismCph,cq˝id along
c
thetopofthediagrampicksouttheelementid ˝hofCpb,cq. Bytheunitalityofcomposition,this
c
elementisequaltohitself,sowecanrewritethediagramasfollows:
1 h Cpb,cq
υcpidcq υ
b
Fc Fh Fb
Next,wecansubstitutethedefinitionh :“ υ1 ˝f,andobservethatυ ˝υ1 “ id (sinceυ isan
b b b Fb b
isomorphismwithυ1 itsinverse):
b
f υ1
1 Fb b Cpb,cq
υcpidcq υ
b
Fc Fh Fb
Thecommutativityofthisdiagrammeansthatf “ Fh˝υ pid q. Moreover,sinceh “ υ1˝f andυ1
c c b b
isanisomorphism,hisuniqueforagivenf. Thereforeυ pid q : 1 Ñ Fcisauniversalmorphism
c c
from1toF.
Next,supposegivenauniversalmorphismu : 1 Ñ Fc. TheYonedalemmeaassociatestothis
elementanaturaltransformationγpuqwhosecomponentatbisthefunctionγpuq : Cpb,cq Ñ Fb
b
whichactsbyf ÞÑ Ffpuq. Weneedtoshowthatthisfunctionisanisomorphismforeveryb : C,so
thatγpuq : Cp´,cq ñ F isanaturalisomorphismandhenceF isrepresentedbyc. Wetherefore
needtodefineaninversefunctionφ : Fb Ñ Cpb,cq,whichwedousingtheuniversalproperty
b
71
ofu: foreachelementf : 1 Ñ Fb,wehaveauniquemorphismh : b Ñ csuchthatf “ Fhpuq.
ThisuniquehisanelementofCpb,cq,andsowecansimplydefineφ pfq :“ h. Theuniqueness
b
ofhensuresthatφ isaninverseofγpuq : observethatγpuq ˝φ actsbyf ÞÑ h ÞÑ Fhpuqand
b b b b
f “ Fhpuqbydefinition;intheoppositedirection,wenecessarilyhavef ÞÑ Ffpuq ÞÑ f.
WehaveconstructedmappingsbetweenthesetofrepresentationsofF anduniversalmorphisms
from1toF,soitremainstoshowthatthesemappingsaremutuallyinverse. Thisagainfollows
directlyfromtheYonedalemma: themappingofrepresentationstouniversalmorphismstakesa
representationυ totheelementγ1pυqinducedbytheYonedalemma;andthemappingofuniversal
morphismstorepresentationstakesauniversalmorphismutothenaturaltransformationγpuq
inducedbytheYonedalemma. Sincethefunctionsγ andγ1 aremutuallyinverse,somustthese
mappingsbe: γ ˝γ1pυq “ υ andγ1˝γpuq “ u.
Usingtheuniversalityofrepresentability,andtheuniquenessofuniversalmorphisms,andthe
representabilityoflimitsandadjoints,wethereforeobtainalternativeproofsoftheuniquenessof
thoseuniversalconstructions.
72
3. Algebraic connectomics
InChapter2,wemotivatedappliedcategorytheoryinthecontextofcomplexsystemslikebrains
byitsabilitiestorelatestructureandfunction,totranslatebetweenmodelsandframeworks,and
todistilphenomenatotheiressences. However,thefocusinthatchapterwason‘one-dimensional’
morphisms,whichcanbeunderstoodasconnectingoneinterfacetoanother,withthecomposition
of 1-cells representing something like the ‘end-to-end’ composition of processes; although we
considered some higher-dimensional category theory, this was largely restricted to weakening
equalitiesandthuscomparingmorphisms.
Becausesystemscanbeplaced‘side-by-side’aswellasend-to-end,andbecausetwosystems
placed side by side may be nontrivially wired together, in this chapter we extend the higher-
dimensionalcategoricallanguageaccordingly,withaparticularfocusoncemoreonthegraphical
anddiagrammaticrepresentationofsystemsandprocesses. Inlinewiththedistinctionmadein
§2.2.3betweensyntaxandsemantics,ourtreatmenthereofthesyntaxofwiring—ofconnectomics—is
largely‘algebraic’. Later,inChapter6,wewillseehowoursemanticfocuswillbe‘coalgebraic’.
We will begin therefore by introducing the graphical calculus of monoidal categories, which
allowustodepictandreasonaboutsequentialandparallelcompositionsimultaneously. Wefollow
thiswiththeformalunderpinningsofthestructure—tousethetermfromChapter2,amonoidal
structureisa‘well-behaved’tensorproduct—beforeexplaininghowmonoidalcategoriesrelate
tothehighercategorytheoryofChapter2usingthenotionofbicategory. Wethenmakeuseof
theextrafreedomaffordedbybicategoriestoconsiderparameterizedsystems,withwhichwecan
modelsystemsthatnotonlyactbutalsolearn.
By this point, we will find ourselves ready to apply our new toolkit, and so in §3.3, we use
functorialsemanticstodefineagraphicalalgebraforneuralcircuits,revisitingourfirstexample
fromChapter2. Thisinvolvesachangeofperspectivefromthegraphicalcalculuswithwhichwe
beginthechapter: insteadofusingthecompositionofmorphismstoencodetheplugging-together
ofsystemsatthesame‘scale’or“levelofhierarchy”,weusecompositiontoencodethewiringof
circuitsatonelevelintosystemsatahigherlevel. Althoughformallycloselyrelatedtomonoidal
73
categories,this‘hierarchical’perspectiveisstrictlyspeakingmulticategoricalandallowsmorphisms’
domainstotakeverygeneralshapes.
Afterthisextendedexample,wereturntoalgebra,explainingwhatmakesmonoidalcategories
monoidal,andusingtherelatedconceptofmonad toexplainhowwethinkofthemasalgebraic;
monadswilllaterprovetobeofimportanceincategoricalapproachestoprobabilitytheory. Finally,
weendthechapterbyintroducingtherichlystructuredcategoryofpolynomialfunctorsSet Ñ Set,
whichwewilluseinChapter6bothtoformalizeawidevarietyofopendynamicalsystemsaswell
astospecifytheshapesofthosesystems’interfaces.
Exceptingtheextendedexampleof§3.3,thecontentofthischapteriswellknowntocategory-
theoreticians. However, since it is not well known to mathematical scientists, we have again
endeavouredtosupplydetailedmotivationsfortheconceptsandresultsthatweintroduce.
3.1. Categories and calculi for process theories
Inthissection,weintroduceanalternativewayofdepictingmorphismsandtheircompositesin
categories equipped with notions of both sequential and parallel composition. Such categories
are useful for representing processes in which information flows: we formalize the processes
as morphisms, and consider the flow as from domain to codomain, even when the categories
themselves are quite abstract and lack a notion of time with which to make sense of ‘flow’. In
suchcontexts,thecategoriesareoftennotonlymonoidal,butalsocopy-discard categories,sincea
distinctivefeatureofclassicalinformationisthatitcanbecopiedanddeleted. Monoidalcategories
willthereforebeimportantnotonlyindepictingcompositecomputations(asindicatedin§2.1.1.3),
butalsoindepictingandmanipulatingthefactorizationofprobabilisticmodels(asindicatedin
§2.1.1.2).
3.1.1. Stringdiagrams
Rather than beginning with the formal definition of “monoidal category”, we start with the
associatedgraphicalcalculusofstringdiagramsanditsintuition.
Sequentialandparallelcomposition Diagramsinthegraphicalcalculusdepictmorphisms
as boxes on strings: the strings are labelled with objects, and a string without a box on it can
be interpreted as an identity morphism. Sequential composition is represented by connecting
stringstogether,andparallelcompositionbyplacingdiagramsadjacenttooneanother;sequential
compositiondistributesoverparallel,andsowecanofcoursecomposeparallelboxesinsequence.
74
Becausemonoidalstructuresare“well-behavedtensorproducts”,wewilltypicallydenotethem
usingthesamesymbolsthatweadoptedinChapter2,withsequentialcompositiondenotedby˝and
parallelcomposition(tensor)denotedbyb. Diagramswillbereadinthedirectionofinformation
flow,whichwillbeeitherbottom-to-toporleft-to-right;wewilladopttheformerconventionin
thissection.
Inthisway,c : X Ñ Y,id : X Ñ X,d˝c : X ÑÝ c Y ÝÑ d Z,andf bg : X bY Ñ AbB are
X
depictedrespectivelyas:
Y X Z A B
d
c f g
c
X X X X Y
Amonoidalstructurecomeswithamonoidalunit,whichwewillalsocontinuetocallatensorunit,
andwhichwillbenotbedepictedindiagrams,butratherleftimplicit.(Alternatively,itisdepictedas
the“emptydiagram”.) Thisisjustified,aswewillsee,bytherequirementthatIbX – X – XbI
naturallyinX.
States and costates In Remark 2.2.8, we called a morphism I Ñ X out of the tensor unit a
generalizedelement,butowingtothemanyrôlestheyplay,suchmorphismsgobymanynames.
WhenwethinkofX asrepresentingasystem,wewillalsocallsuchmorphismsstatesofX. Dually,
morphismsX Ñ I canbecalledcostates,orsometimeseffects. Whentheunitobjectistheterminal
object(suchaswhenthemonoidalstructureisgivenbythecategoricalproduct),thenthesecostates
aretrivial. Inothercategories,costatesmaybemoreeffectful,andsocarrymoreinformation: for
example,inacategoryofvectorspaces,statesarevectors,costatesarelinearfunctionals,andso
thecompositeofastatewithacostateisaninnerproduct.
Graphically,statesη : I Ñ X andcostatesϵ : X Ñ I willberepresentedrespectivelyasfollows:
X
ϵ
η
X
Discarding, marginalization, andcausality Inacategorywithonlytrivialeffects, wecan
thinkoftheseaswitnessingthe‘discarding’ofinformation: inelectronicsterms,they“sendthe
75
signal to ground”. For this reason, we will denote such trivial effects by the symbol , writing
: X Ñ I foreachobjectX.
X
Wecanusediscardingtodepictmarginalization. Givena‘joint’state(astateofatensorproduct)
ω : I Ñ X bY,wecandiscardeitherY orX toobtain‘marginal’statesω ofX andω ofY
1 2
respectively,asinthefollowingdepiction:
X X Y Y
“ and “ .
ω ω ω ω
1 2
WewillseeinChapter4howthiscorrespondstothemarginalizationfamiliarfromprobability
theory.
Tomakethenotionofdiscardingmoremathematicallyprecise,wecanuseittoencodeacausality
condition: physicallyrealisticprocessesshouldnotbeabletoaffectthepast.
Definition3.1.1. Wheneveramorphismcsatisfiestheequation
c “
wewillsaythatciscausal: theequationsaysthat,ifyoudocandthrowawaytheresult,theeffect
isofnothavingdonecatall—andsoccouldnothavehadananti-causaleffectonitsinput.
Remark3.1.2. Ifinacategoryeverymorphismiscausal,thenthisisequivalentlyastatementof
thenaturalityoffamilyofdiscardingmorphisms : X Ñ I,whichimpliesthatthereisonlyone
X
suchmorphismX Ñ I foreveryobjectX,andwhichthereforemeansthatI mustbeaterminal
object.
Some categories of interest will have nontrivial costates, yet we will still need notions of
discarding and marginalization. In these categories, it suffices to ask for each object X to be
equippedwitha‘comonoid’structure(tobeelaboratedin§3.4.1),ofwhichonepartisa‘counit’
morphismX Ñ I whichcanplayadiscardingrôle,andwhichwewillthereforealsodenoteby
.
X
Copying TheotherpartofacomonoidstructureonX isa‘copying’map : X Ñ X bX,
X
whichhasanintuitivegraphicalrepresentation. Aswewillseein§3.4.1,thecomonoidlaws say
76
thatcopyingmustinteractnicelywiththediscardingmaps:
“ “ and “
Theseequationssaythatmakingacopyandthrowingitawayisthesameasnotmakingacopy(left,
counitality;andthatincopyingacopy,itdoesn’tmatterwhichcopyyoucopy(right,coassociativity).
Definition3.1.3. Acategorywithacomonoidstructurep , qforeveryobjectX iscalleda
X X
copy-discardcategory [60].
Symmetry Inallourapplications,thetensorproductstructurewillbesymmetric,meaningthat
X bY canreversiblybeturnedintoY bX simplybyswappingtermsaround. Inthegraphical
calculus,wedepictthisbytheswappingofwires,whichweasktosatisfythefollowingequations:
“ and “
Theequationssaythatswappingisself-inverse(ontheleft),andthatcopyingisinvariantunderthe
symmetry(ontheright). (Strictlyspeaking,therightequationisanaxiomcalledcocommutativity
thatweadditionallyaskthecomonoidstructuretosatisfyinthepresenceofasymmetrictensor.)
3.1.2. Monoidalcategories
Itbeingimportanttousetoolsappropriateforthejobsathand,wewillnotalwaysworkjustwith
thegraphicalcalculus: wewillneedtotranslatebetweenstringdiagramsandthesymbolicalgebra
ofChapter2. Inthefirstinstance,thismeansmakingmathematicalsenseofthegraphicalcalculus
itself,forwhichthekeydefinitionisthatofthemonoidalcategory.
Definition3.1.4. WewillcallacategoryC monoidalifitisequippedwithafunctorb : CˆC Ñ C
calledthetensor ormonoidalproduct alongwithanobjectI : C calledthemonoidalunit andthree
naturalisomorphisms
1. anassociator α : pp´qbp´qqbp´q ñ p´qbpp´qbp´qq;
2. aleftunitor λ : I bp´q ñ p´q;and
77
3. arightunitor ρ : p´qbI ñ p´q
suchthattheunitorsarecompatiblewiththeassociator,i.e. foralla,b : C thediagram
α
pabIqbb a,I,b abpI bbq
ρabid
b
idabλ
b
abb
commutes,andsuchthattheassociativityis‘order-independent’,i.e. foralla,b,c,d : Cthediagram
α
pabpbbcqqbd a,bbc,d abppbbcqbdq
α a,b,cbid
d
idabα
b,c,d
ppabbqbcqbd abpbbpcbdqq
α α
abb,c,d a,b,cbd
pabbqbpcbdq
commutes.
WecallC strictmonoidal iftheassociatorandunitorsareequalitiesratherthanisomorphisms;
inthiscase,thediagramsabovecommutebydefinition.
Example 3.1.5. Any category equipped with a tensor product in the sense of Definition 2.2.3
wherethestructureisomorphismsareadditionallynaturalandsatisfytheaxiomsofcompatibility
andorder-independenceisamonoidalcategory.
Example 3.1.6. If pC,b,Iq is a monoidal category, then so is pCop,bop,Iq, where bop is the
inducedoppositefunctorCopˆCop Ñ Cop.
Theassociativityofthetensoriswhatallowsustodepictstringdiagrams“withoutbrackets”
indicatingtheorderoftensoring, andtheunitalityiswhatallowsustoomitthemonoidalunit
fromthediagrams. Notethatthefunctorialityofthetensormeansthatbdistributesover˝asin
pf1˝fqbpg1˝gq “ pf1bg1q˝pf bgq,bothofwhichexpressionsarethereforedepictedas
f1 g1
.
f g
Thesymmetryofamonoidalstructureisformalizedasfollows.
78
Definition3.1.7. Asymmetricmonoidal categoryisamonoidalcategorypC,b,I,α,λ,ρqthat
is additionally equipped with a natural isomorphism σ : p´q b p“q ñ p“q b p´q, called the
symmetry,suchthatσ ˝σ “ id foralla,b : C,andwhosecompatibilitywiththeassociator
b,a a,b abb
iswitnessedbythecommutativityofthefollowingdiagram:
α σ
pabbqbc a,b,c abpbbcq a,bbc pbbcqba
σ a,bbidc α b,c,a
pbbaqbc bbpabcq bbpcbaq
α b,a,c id bbσa,c
Hereisafamiliarfamilyofexamplesofsymmetric,butnotstrict,monoidalcategories.
Example3.1.8. Anycategorywithinwhicheverypairofobjectshasaproductissaidtohave
finiteproducts,andanycategorywithfiniteproductsandaterminalobjectisamonoidalcategory.
ThisincludestheCartesianproductsofsets(Definition2.2.1andExample2.2.5)andofcategories
(Propositions2.2.14and2.2.16).
ToseethattheCartesianproductofsetsisnotstrictlyassociative,observethattheelements
ofAˆpBˆCqaretuplespa,pb,cqqwhereastheelementsofpAˆBqˆC aretuplesppa,bq,cq;
evidently, these two sets are isomorphic, but not equal, and the same holds for the product of
categories.
Atthesametime,itiseasytoseethataCartesianproductissymmetric:wehaveAˆB – BˆA
bythemappingpa,bq Ø pb,aq.
Andhereisafamilyofexamplesofstrict,butnotsymmetric,monoidalcategories.
Example3.1.9. IfCisanycategory,thenthecategoryCC ofendofunctorsC Ñ Cisastrictmonoidal
category,wherethemonoidalproductisgivenbycomposition˝ofendofunctorsandthemonoidal
unitistheidentityfunctorid onC. Thatthemonoidalstructurehereisstrictfollowsfromthefact
C
thatcompositioninacategoryisstrictlyassociativeandunital.
Inpractice,wewilltendtoencounterstrictmonoidalcategoriesonlywhenthemonoidalstructure
derivesfromthecompositionoperatorofacategory,asintheprecedingexample. However,when
weworkwiththegraphicalcalculus,weareoftenimplicitlyworkingwithstrictmonoidalstructure,
asaresultofthefollowingimportanttheorem.
Theorem3.1.10(MacLane[175,TheoremXI.3.1]). Everymonoidalcategoryisstrongmonoidally
equivalenttoastrictmonoidalone.
79
As a consequence of this coherence theorem, any two string diagrams where one can be
transformedintotheotherbyapurelytopologicaltransformationareequal,asinthefollowing
example(readfromlefttoright):
“
Thisfollowsbecausethecoherencetheoremrendersparallelmorphismsentirelyconstructedfrom
identities,associatorsandunitors(andthesymmetry,aslongasitisstrictlyself-inverse)equal“on
thenose”1.
Tomakesenseofthenotionofstrongmonoidalequivalence,weneedanotionoffunctorthat
preservesmonoidalstructure;wedefinethe‘weak’casefirst.
Definition3.1.11. SupposepC,b ,I qandpD,b ,I qaremonoidalcategories. Alaxmonoidal
C C D D
functor pC,b ,I q Ñ pD,b ,I qisatripleof
C C D D
1. afunctorF : C Ñ D;
2. astateϵ : I Ñ FpI qcalledtheunit;and
D C
3. anaturaltransformation,thelaxator,µ : Fp´qb Fp“q ñ Fpp´qb p“qq
D C
satisfyingtheaxiomsof
(a) associativity,inthatthefollowingdiagramcommutes
αD
pFpaqb Fpbqqb Fpcq Fpaq,Fpbq,Fpcq Fpaqb pFpbqb Fpcqq
D D D D
µ a,bbDFpcq FpaqbDµ
b,c
Fpab bqb Fpcq Fpaqb Fpbb cq
C D D C
µ µ
abCb,c Fpaq,bbCc
FpαC q
Fppab bqb cq a,b,c Fpab pbb cqq
C C C C
whereαC andαD aretheassociatorsoftherespectivemonoidalstructuresonC andD;and
1Thisprocessofturningnaturalisomorphismsintoequalitiesiscalledstrictification.
80
(b) (leftandright)unitality,inthatthefollowingdiagramscommute
I b Fpaq
ϵbDFpaq
FpI qb Fpaq Fpaqb I
FpaqbDϵ
Fpaqb FpI q
D D C D D D D C
and
λD
Fpaq
µIC,a ρD
Fpaq
µa,IC
Fpaq FpI b aq Fpaq Fpab I q
C C C C
FpλCq FpρCq
a a
whereλC andλD aretheleft,andρC andρD theright,unitorsoftherespectivemonoidal
structuresonC andD.
Astrongmonoidalfunctor isalaxmonoidalfunctorforwhichtheunitandlaxatorareisomorphisms.
Astrongmonoidalequivalenceisthereforeanequivalenceofcategoriesinwhichthetwofunctors
arestrongmonoidal.
Remark3.1.12. Laxnesscanbereadasasignofan“emergentproperty”: ifF islaxmonoidal,
thenthismeanstherearesystemsoftypeFpX bYqthatdonotarisesimplybyplacingasystem
oftypeFpXqbesideasystemoftypeFpYqusingb;whereasifF isstrongmonoidal,thenthere
arenosuch‘emergent’systems. Moregenerally,wecanthinkofemergenceasanindicationof
higher-dimensionalstructurethatishiddenwhenonerestrictsoneselftolowerdimensions(and
hencecanappearmysterious). Inthisexample,thehigher-dimensionalstructureisthe2-cellofthe
laxator.
Thereisofcourseanotionofmonoidalnaturaltransformation,makingmonoidalcategories,lax
monoidalfunctors,andmonoidalnaturaltransformationsintotheconstituentsofa2-category.
Definition3.1.13. IfpF,µ,ϵqandpF1,µ1,ϵ1qarelaxmonoidalfunctorspC,b ,I q Ñ pD,b ,I q,
C C D D
then a monoidal natural transformation α : pF,µ,ϵq ñ pF1,µ1,ϵ1q is a natural transformation
α : F ñ F1 thatiscompatiblewiththeunitors
I
D
ϵ ϵ1
FpI q F1pI q
C αIC C
andthelaxators
Fab Fb
αabDα
b F1ab F1b
D C
µ
a,b
µ1
a,b
α
Fpab bq abCb F1pab bq
C C
81
foralla,b : C.
Proposition3.1.14. Monoidalcategories,laxmonoidalfunctors,andmonoidalnaturaltransfor-
mationsformthe0-cells,1-cells,and2-cellsofa2-category,denotedMonCat.
Proof. Given composable lax monoidal functors pF,ϵ,µq : pC,b ,I q Ñ pD,b ,I q and
C C D D
pF1,ϵ1,µ1q : pD,b ,I q Ñ pE,b ,I q,formtheirhorizontalcompositeasfollows. Thefunctors
D D E E
compose as functors, G˝F. The composite state is given by I ÝÑ ϵ1 F1pI q Ý F ÝÑ 1ϵ F1FpI q. The
E D C
laxatorisgivenby
F1Fp´qb F1Fp“q ù µ ù 1 F ù p´ ù q ù ,F ù p ù “ ñ q F1pFp´qb Fp“qq ù F ù 1 ù µ ù a, ñ b F1Fpp´qb p“qq.
E D C
TheidentitylaxmonoidalfunctoronCisgivenbypid ,id ,id q.Unitalityandassociativity
C IC p´qbCp“q
ofcompositionoflaxmonoidalfunctorsfollowstraightforwardlyfromunitalityandassociativity
ofcompositionofmorphisms,functors,andnaturaltransformations. Monoidalnaturaltransforma-
tionscomposeverticallyasnaturaltransformations,anditiseasytoseethatthecompositessatisfy
thecompatibilityconditionsbypastingtherelevantdiagrams.
3.1.3. Closedmonoidalcategories
Sinceonesourceofmonoidalstructuresisthegeneralizationofthecategoricalproduct,itisno
surprisethatthereisacorrespondinggeneralizationofexponentials: a‘tensor-hom’adjunction
thatinducesaconceptofclosedmonoidalcategory. Suchcategorieswillbeimportantlaterinthe
thesiswhenweconsiderlearningandadaptivesystems: ourcompositionalmodelofpredictive
coding,forexample,willbebuiltonacertaingeneralizedexponential(seeRemark6.3.2).
Definition 3.1.15. Let pC,b,Iq be a monoidal category. When there is an object e : C such
that Cpx,eq – Cpxby,zq naturally in x, we say that e is an internal hom object and denote it
byry,zs. Theimageofid undertheisomorphismiscalledtheevaluationmapandiswritten
ry,zs
ev : ry,zsby Ñ z.
y,z
Proposition3.1.16. WhentheisomorphismCpxby,zq – Cpx,ry,zsqisadditionallynaturalin
z, we obtain an adjunction p´qby % ry,´s called the tensor-hom adjunction, which uniquely
determinesafunctorCopˆC Ñ C : py,zq ÞÑ ry,zsthatwecalltheinternalhomforC.
Proof. AdirectgeneralizationoftheCartesiancase(Proposition2.3.56).
Definition3.1.17. AmonoidalcategoryC withacorrespondinginternalhomiscalledmonoidal
closed.
82
Example3.1.18. Thecategoryoffinite-dimensionalrealvectorspacesandlinearmapsbetween
themismonoidalclosedwithrespecttothetensorproductofvectorspaces,aseachspaceoflinear
mapsisagainavectorspaceandthetensorisnecessarilybilinear.
AsintheCartesiancase,monoidalclosedcategoriescanreasonaboutthemselves.
Proposition3.1.19. Amonoidalclosedcategoryisenrichedinitself.
And when a category is enriched in a symmetric monoidal category, then its hom functor is
likewiseenriched.
Proposition3.1.20. SupposeC isanE-categorywhereE issymmetricmonoidalclosed. Thenthe
homfunctorCp´,“qisanE-functor.
Proof. AdirectgeneralizationofProposition2.3.61.
Remark3.1.21. SinceCartesianclosedcategorieshavearichinternallogic,viatheCurry-Howard-
Lambekcorrespondence,onemightwonderifthereisananalogoussituationformonoidalclosed
categories. Toacertainintricateextentthereis: theinternallogicofmonoidalclosedcategories
isgenerallyknownaslinearlogic,anditscorrespondinglanguagelineartypetheory. Theseare
‘refinements’ofintuitionisticlogicandtypetheorywhichofcoursecoincideintheCartesiancase,
butwhichmoregenerallyclarifycertainlogicalinteractions;weshallsaynomoreinthisthesis,
except that such logics find application in quantum mechanics, owing to the monoidal closed
structureofvectorspaces,wherethelinearstructureconstrainstheuseofresources(inrelation,
forexample,tothefamousquantum‘no-cloning’and‘no-deleting’theorems).
Withrespecttodependent types, thesituationisalittlemorevexed, astheexistenceofwell-
behaveddependentsumsandproductsclassicallydependsontheexistenceofpullbacksandtheir
coherencewithproducts(and,forexample,thetensorproductofvectorspacesisnotacategorical
product);thismeansthatclassicaldependentdataissomehownotresource-sensitive. Nonetheless,
variousproposalshavebeenmadetounifylinearlogicwithdependenttypetheory[14,111,174,
182,269]:thesimplestoftheseproceedbyrequiringdependencetobesomehowCartesian,whichis
theapproachwewilltakeinChapter6whenwefaceasimilarquandaryinthecontextofdefining
acategoryofpolynomialfunctorswithnon-deterministicfeedback. (WewillseeinChapter4that
thepropertyofCartesiannessisequallycloselyrelatedtodeterminism.)
83
3.1.4. Bicategories
Monoidal categories are not the first two-dimensional categorical structures we have so far
encountered, theotherprimaryexamplebeing2-categories. Thesetwoclassesofexamplesare
closelyrelated: astrictmonoidalcategoryisa2-categorywithoneobject;andsojustasamonoidal
categoryisacorrespondinglyweakenedversion,abicategoryisa‘weak2-category’.
Definition3.1.22. Abicategory B isconstitutedby
1. asetB ofobjectsor0-cells;
0
2. foreachpairpA,BqofB-objects,acategoryBpA,Bqcalledthehomcategory,theobjectsof
whicharethemorphismsor1-cellsfromAtoB,andthemorphismsofwhicharethe2-cells
betweenthose1-cells;
3. foreach0-cellA,a1-cellid : BpA,Aqwitnessingidentity;and
a
4. for each triple pA,B,Cq of 0-cells, a functor ˛ : BpB,Cq ˆ BpA,Bq Ñ BpA,Cq
A,B,C
witnessinghorizontalcomposition(withverticalcompositionreferringtocompositionwithin
eachhomcategory);
5. foreachpairpA,Bqof0-cells,naturalisomorphismsρ (therightunitor)andλ (the
A,B A,B
leftunitor)witnessingtheunitalityofhorizontalcomposition,asinthediagrams
BpA,Bqˆ1
BpA,BqˆidA
BpA,BqˆBpA,Aq BpB,BqˆBpA,Bq
idBˆBpA,Bq
1ˆBpA,Bq
ρA,B λA,B
and
˛A,A,B ˛A,B,B
P Λ
BpA,Bq BpA,Bq
BpA,Bq BpA,Bq
where Λ : 1ˆp´q ñ p´q and P : p´qˆ1 ñ p´q are the (almost trivial) left and right
unitorsoftheproductˆonCat;and
6. foreachquadruplepA,B,C,Dqof0-cells,anaturalisomorphismα witnessingthe
A,B,C,D
84
associativityofhorizontalcomposition,asinthediagram
` ˘ ` ˘
A
BpC,DqˆBpB,Cq ˆBpA,Bq BpC,Dq,BpB,Cq,BpA,Bq BpC,Dqˆ BpB,CqˆBpA,Bq
αA,B,C,D
˛B,C,DˆBpA,Bq BpC,Dqˆ˛A,B,C
BpB,DqˆBpA,Bq BpC,DqˆBpA,Cq
˛A,B,D ˛A,C,D
BpA,Dq
whereA : pp´qˆp´qqˆp´q ñ p´qˆpp´qˆp´qqisthe(almosttrivial)associatorofthe
productˆonCat;
such that the unitors are compatible with the associator, i.e. for all 1-cells a : BpA,Bq and
b : BpB,Cqthediagram
α
pb˛id q˛a
b,idB,a
b˛pid ˛aq
B B
ρ b˛ida id b˛λa
b˛a
commutes(wherewehaveomittedthesubscriptsindexingthe0-cellsonα,ρ,andλ);andsuchthat
theassociativityis‘order-independent’,i.e. forall1-cellsa : BpA,Bq,b : BpB,Cq,c : BpC,Dq,
andd : BpD,Eqthediagram
α
pa˛pb˛cqq˛d a,b˛c,d a˛ppb˛cq˛dq
α a,b,c˛id
d
ida˛α
b,c,d
ppa˛bq˛cq˛d a˛pb˛pc˛dqq
α α
a˛b,c,d a,b,c˛d
pa˛bq˛pc˛dq
commutes(wherewehaveagainomittedthesubscriptsindexingthe0-cellsonα).
Remark 3.1.23. Just as a 2-category is a category enriched in Cat, a bicategory is a category
weaklyenrichedinCat. ThisiseasytoseebycomparingDefinition3.1.22withDefinition2.2.6:the
formerisobtainedfromthelatterbytakingE tobeCatandfillingtheunitalityandassociativity
85
diagramswithnontrivialfillerswhicharerequiredtosatisfycoherencelawsgeneralizingthoseof
themonoidalcategorystructure(Definition3.1.4). Conceptually,wecanseethisweakeninginthe
contextofourbriefdiscussionofemergenceabove(Remark3.1.12): werecognizethepropertyof
axiom-satisfactionasashadowofahigher-dimensionalstructure(thefillers),whichwecategorify
accordingly.
Bicategorieswillappearlaterinthisthesiswhenweconstructcategoriesofdynamicalhierarchical
inference systems: the construction proceeds by using polynomial functors to “wire together”
categories of dynamical systems, and the composition of polynomials distributes weakly but
naturallyoverthecategoriesofsystems,therebyproducingacategoryweaklyenrichedinCat.
Before then, we will encounter bicategories in the abstract context of general parameterized
morphisms,wherethe2-cellswitnesschangesofparameter.
For now, our first examples of bicategories are induced by monoidal categories, which are
equivalentlysingle-objectbicategories.
Proposition3.1.24. SupposepC,b,Iqisamonoidalcategory. ThenthereisabicategoryBC with
asingle0-cell,˚,andwhosecategoryof1-cellsBCp˚,˚qisC. Theidentity1-cellisI,andhorizontal
composition is given by the monoidal product C; vertical composition is just the composition
of morphisms in C. The unitors and associator of the bicategory structure are the unitors and
associatorofthemonoidalstructure. WecallBC thedelooping ofC.
Proof. Thebicategoryaxiomsaresatisfiedimmediately,becausethestructuremorphismssatisfy
the(inthiscaseidentical)monoidalcategoryaxioms.
Intheoppositedirection,theequivalenceiswitnessedbythefollowingproposition.
Proposition 3.1.25. Suppose B is a bicategory with a single 0-cell, ˚, and whose horizontal
` ˘
compositionisdenoted˛. Then Bp˚,˚q,˛,id isamonoidalcategory.
˚
Remark 3.1.26. It is possible to define a notion of monoidal bicategory, as something like a
monoidalcategoryweaklyenrichedinCat,orasaone-object‘tricategory’,andinmanycasesthe
bicategoriesconsideredbelowarelikelytohavesuchstructure. Wewillsayalittlemoreaboutthis
inRemark3.4.7below,butwillnotdefineormakeformaluseofthishigherstructureinthisthesis.
Moregenerally,thereareanaloguesoftheotherstructuresandresultsofbasiccategorytheory
introducedbothinthischapterandinChapter2thatareapplicabletohigher-dimensionalcategories
suchasbicategories,buttheytoowillnotplayanimportantrôleinthisthesis.
86
3.2. Parameterized systems
Acategorydoesnothavetobemonoidalclosedforustobeabletotalkabout“controlledprocesses”
init: itsbeingmonoidalissufficient,forwecanconsidermorphismsoftheformP bX Ñ Y and
treattheobjectP asanobjectofadjustableparameters. Parameterizedmorphismsofthisform
caneasilybemadetocompose: givenanothermorphismQbY Ñ Z,wecanstraightforwardly
obtainacompositeparameterizedmorphismpQbPqbX Ñ Z,asweelaboratein§3.2.1below.
Categoriesofsuchparameterizedmorphismsplayacentralrôleinthecompositionalmodelling
ofcyberneticsystems[54,251],wherewetypicallyseetheparameterascontrollingthechoiceof
process,andunderstandlearningasa‘higher-order’processbywhichthechoiceofparameteris
adjusted. Moreconcretely,considerthesynapticstrengthsorweightsofaneuralnetwork,which
changeasthesystemlearnsabouttheworld,affectingthepredictionsitmakesandactionsittakes;
orconsidertheprocessofBayesianinference,wheretheposteriorisdependentonaparameter
thatistypicallycalledthe‘prior’.
Inthissection,weintroducetworelatedformalnotionsofparameterization:‘internal’,wherethe
parameterobjectconstitutesapartofthedomainofmorphismsinacategory;and‘external’,where
theparametersremainoutsideofthecategorybeingparameterizedandthechoiceofmorphism
is implemented as a morphism in the base of enrichment. We will make use of both kinds of
parameterizationinthisthesis.
Remark3.2.1. Parameterizationcanbeunderstoodasintroducinganewdimensionintoacategory
ofprocesses. Consequently,theparameterization(eitherinternalorexternal)ofacategorywill
produce a bicategory. When representing processes graphically, such as when using the string
diagramcalculus,thisextradimensionbecomesparticularlyexplicit,andalthoughwewon’tmake
useofgraphicalrepresentationsofparameterizedprocessesinthisthesis,theyaretypicalinthe
applied-categoricalliterature,particularlyintheliteratureoncategoricalcybernetics;forexample,
seeCapuccietal.[54,Fig. 1],Cruttwelletal.[74,pp.1–2],andCapucci[51,Fig. 1].
3.2.1. Internalparameterization
Internalparameterizationgeneralizesthecasewithwhichweopenedthissection,ofmorphisms
P bX Ñ Y, to a situation in which the parameterization may have different structure to the
processesathand,sothattheparameterizingobjectsliveinadifferentcategory. Forthisreason,we
describethe‘actegorical’situationinwhichacategoryofparametersMactsononacategoryof
processesC togenerateacategoryofparameterizedprocesses. Nonetheless,eveninthiscase,the
87
parameterendsupconstitutingpartofthedomainofthemorphismrepresentingtheparameterized
process.
The first concept we need is that of an ‘actegory’, which categorifies the better known
mathematicalnotionofmonoidaction2.
Definition3.2.2(M-actegory). SupposeMisamonoidalcategorywithtensorbandunitobject
I. WesaythatCisaleftM-actegorywhenthereisafunctord : MˆC Ñ Ccalledtheactionalong
withnaturalunitorandassociatorisomorphismsλd : IdX ÝÑ „ X andad : pMbNqdX ÝÑ „
X M,N,X
M dpN dXqcompatiblewiththemonoidalstructureofpM,b,Iq,inasenseanalogoustothe
coherencedataofamonoidalcategory(Definition3.1.4). Thismeansthatthefollowingtriangle
andpentagondiagramsmustcommute,whereρandαaretherightunitorandtheassociatorof
themonoidalstructureonM.
ad
pM bIqdC M,I,C M dpI dCq
ρMbidC idMdλd
C
M dC
ad
pK bpM bNqqdC K,MbN,C K dppM bNqdCq
αK,M,NbidC idKbad
M,N,C
ppK bMqbNqdC K dpM dpN dCqq
ad ad
KbM,N,C K,M,NdC
pK bMqdpN dCq
Givenanactegory,wecandefineacategoryofcorrespondinglyparameterizedmorphisms.
Proposition3.2.3(Capuccietal.[54]). LetpC,d,λd,adqbeanpM,b,Iq-actegory. Thenthereis
abicategoryofM-parameterizedmorphismsinC,denotedParapdq. ItsobjectsarethoseofC. For
ř
eachpairofobjectsX,Y,thesetof1-cellsisdefinedasParapdqpX,Yq :“ CpM dX,Yq;
M:M
wedenoteanelementpM,fqofthissetbyf : X Ý M Ñ Y.Given1-cellsf : X Ý M Ñ Y andg : Y Ý N Ñ Z,
theircompositeg˝f : X Ý N ÝÝ b Ý M Ñ Z isthefollowingmorphisminC:
pN bMqdX Ý a Ý d NÝ,MÝÝ,XÑ N dpM dXq Ý id ÝNÝÝ d Ñ f N dY ÑÝ g Z
2Foracomprehensivereferenceonactegorytheory,seeCapucciandGavranović[52].
88
Given1-cellsf : X Ý M Ñ Y andf1 : X Ý M ÝÑ 1 Y,a2-cellα : f ñ f1 isamorphismα : M Ñ M1 in
Msuchthatf “ f1˝pαdid qinC;identitiesandcompositionof2-cellsareasinC.
X
Andwhentheactionis‘strong’andthemonoidalstructureonCissymmetric,theseparameterized
categoriesinheritamonoidalstructure.
Definition3.2.4. SupposeC isamonoidalcategoryandF : C Ñ C isanendofunctor. Aright
strengthforF isanaturaltransformationstrr : FX bY Ñ FpX bYqmakingthefollowing
X,Y
diagramscommute:
strr
FX bpY bZq X,YbZ FpX bpY bZqq
αFX,Y,Z FpαX,Y,Zq
pFX bYqbZ FpX bYqbZ FppX bYqbZq
strr
X,Y
bidZ strr
XbY,Z
strr
FX bI X,I FpX bIq
ρFX FρX
FX
An action d : MˆC Ñ C induces a family of functors M dp´q : C Ñ C, natural in M : M.
If each of these is equipped with a right strength, also natural in M : M, then we call the
resultingtransformationstrr arightstrengthford. Dually,therearenotionsofleftstrength,
M,X,Y
strl : X bFY Ñ FpX bYq and costrength, with the latter obtained in the usual way as a
X,Y
strengthinCop (reverseallthedefiningarrows).
Notethat,ifC issymmetricmonoidal,thenaleftstrengthinducesarightstrength(byswapping)
andlikewisearightstrengthinducesaleftstrength.
Proposition3.2.5(Capuccietal.[54,§2.1]). WhenC isequippedwithbothasymmetricmonoidal
structurepb,IqandanpM,b,Iq-actegorystructured,andthesearecompatibleinthattheaction
dhasastrengthisomorphism,thesymmetricmonoidalstructurepb,IqliftstoParapdq.
ThetensorofobjectsinParapdqisthendefinedasthetensorofobjectsinC,andthetensorof
morphisms(1-cells)f : X Ý M Ñ Y andg : A Ý N Ñ B isgivenbythecomposite
fbg : XbA Ý M ÝÝ b Ý N Ñ Y bB :“ pMbNqdpXbAq Ý ι ÝMÝ,NÝ,ÝXÝ,ÑA pMdAqbpNdAq Ý f Ý b Ñ g Y bB
89
wheretheinterchanger ι : pMbNqdpXbAq ÝÑ „ pMdXqbpNdAqisobtainedusing
M,N,X,A
theassociatoroftheactegorystructureandthecostrengths:
ad
ι :“ pM bNqdpX bAq ÝÝ M Ý ,N Ý , ÝpX ÝbÝ A Ñq M dpN dpX bAqq ¨¨¨
M,N,X,A
Mdcostrl costrr
¨¨¨ ÝÝÝÝÝÝÝNÝ,XÝ,ÑA M dpX bpN dAqq ÝÝÝÝMÝ,ÝXÝ,NÝdÝÑA pM dXqbpN dAq .
(Notethatthecostrengthsareobtainedastheinversesofthestrengths.)
Wecanseeamonoidalproductb : C ˆC Ñ C asanactionofC onitself,andthisinducesthe
self-parameterizationofC.
Proposition3.2.6(Self-parameterization). IfpC,b,Iqisamonoidalcategory,thenitinducesa
parameterizationParapbqonitself. ForeachM,X,Y : C,themorphismsX Ý M Ñ Y ofParapbq
arethemorphismsM bX Ñ Y inC.
Notation 3.2.7. When considering the self-paramterization induced by a monoidal category
pC,b,Iq,wewilloftenwriteParapCqinsteadofParapbq.
Itwillfrequentlybethecasethatwedonotinfactneedthewholebicategorystructure. The
followingpropositiontellsusthatwecanalsojustwork1-categorically,aslongasweworkwith
equivalenceclassesofisomorphically-parameterizedmaps,inorderthatcompositionissuffiently
strictlyassociative.
Proposition3.2.8. EachbicategoryParapdqinducesa1-categoryParapdq byforgettingthe
1
bicategoricalstructure. ThehomsetsParapdq pX,YqaregivenbyUParapdqpX,Yq{ „where
1
U istheforgetfulfunctorU : Cat Ñ Setandf „ g ifandonlyifthereissome2-cellα : f ñ g
thatisanisomorphism.WecallParapdq the1-categoricaltruncationofParapdq.WhenParapdq
1
ismonoidal,soisParapdq .
1
Remark3.2.9. Wecanunderstandthe1-categoricaltruncationofParapdqasgroupingtheobjects
ofeachhom-categoryintotheirisomorphism-connectedcomponents.
3.2.2. Externalparameterization
In a monoidal closed category, morphisms P b X Ñ Y correspond bijectively to morphisms
P Ñ rX,Ys. The fact that monoidal closed categories are enriched in themselves presents an
opportunity for generalization in a different direction to the actegorical approach taken above:
90
thatis,givenacategoryofprocessesC enrichedinE,wecanthinkofanexternallyparameterized
processfromX toY asamorphismP Ñ CpX,YqinE.
Thisnotionofexternalparameterizationcanbeoperationallymorefaithfultothestructureof
systems of interest, even though in the case of monoidal closed categories it is equivalent. For
example,theimprovementoftheperformanceofasystemofinferenceduetolearningisoften
treated‘externally’totheinferenceprocessitself: thelearningprocessmightproceedbyobserving
(butnotinterferingwith)theinferenceprocess,andupdatingtheparametersaccordingly;and,if
treateddynamically,thetwoprocessesmightbeassumedtoexhibitaseparationoftimescalessuch
thattheparametersarestationaryonthetimescaleofinference. Wewillmakesuchassumptions
whenweformalizelearninginChapter7,andsowewillmakeuseofexternalparameterization.
Thedefinitionofexternalparameterizationissimplifiedbyusingthe‘slice’construction.
Definition3.2.10. SupposeX isanobjectofacategoryE. WedefinethesliceofE overX,denoted
E{X,asthecategoryof‘bundles’overX inE: itsobjectsaremorphismsp : A Ñ X intoX for
anyA : E,whichwecallbundlesoverX andwriteaspA,pq. Themorphismsf : pA,pq Ñ pB,qq
inE{X aremorphismsf : A Ñ B inE suchthatq˝f “ p,asinthediagram
f
A B
.
p q
X
Wethereforedefineexternalparameterizationusingslicesoverhomobjects.
Definition3.2.11. GivenacategoryCenrichedinpE,ˆ,1q,wedefinetheexternalparameterization
PC of C in E as the following bicategory. 0-cells are the objects of C, and each hom-category
PCpA,BqisgivenbytheslicecategoryE{CpA,Bq. Thecompositionof1-cellsisbycomposing
inC aftertakingtheproductofparameters: givenf : Θ Ñ CpA,Bqandg : Ω Ñ CpB,Cq,their
compositeg˝f is
gˆf ‚
g˝f :“ ΩˆΘ ÝÝÑ CpB,CqˆCpA,Bq ÑÝ CpA,Cq
where ‚ is the composition map for C in E. The identity 1-cells are the points on the identity
morphismsinC.Forinstance,theidentity1-cellonAisthecorrespondingpointid : 1 Ñ CpA,Aq.
A
We will denote 1-cells using our earlier notation for parameterized morphisms: for instance,
f : A ÝÑ Θ B and id : A ÑÝ 1 A. The horizontal composition of 2-cells is given by taking their
A
product.
91
Remark3.2.12. Externalparameterizationisalternativelyobtainedasthechange-of-enrichment
induced by the covariant self-indexing, the functor E{p´q : E Ñ E-Cat, given on objects by
X ÞÑ E{X andonmorphismsbythefunctorinducedbypost-composition3. Abaseofenrichment
must a fortiori be a monoidal category, and in this case E{p´q is a lax monoidal functor. A lax
monoidalfunctoroutofthebaseofenrichmentinducesacorrespondingchange-of-enrichment
pseudofunctor4,andPisobtainedpreciselyasthechange-of-enrichmentinducedbyE{p´q.
One important consequence of this is that P defines a pseudofunctor P : E-Cat Ñ
pE-Catq-Cat. Notethatwetakeenrichmentheretomeanweakenrichment,inthesenseindicated
byRemark2.2.13. Inthecaseoflocallysmallcategories,whereE “ Set,thismeansthatPhasthe
typeCat Ñ Bicat,assuggestedabove. (WewilldiscussthedefinitionofBicatin§5.2.2,where
wealsodefinepseudofunctorsbetweenbicategories.)
Remark 3.2.13. In prior work, this external parameterization has been called ‘proxying’ [53].
Wepreferthemoreexplicitname‘externalparameterization’,reserving‘proxying’foraslightly
differentdouble-categoricalconstructiontoappearinfutureworkbythepresentauthor.
Remark3.2.14. Bothinternalandexternalparameterizationarejointlygeneralizedbythenotion
oflocallygradedcategory [172],whichcanbeunderstoodtomean“presheaf-enrichedcategory”.
IfMactsonC byd,thenthehomcategoryParapdqpA,Bqisthecategoryofelementsofthe
presheafCp´dA,Bq : Mop Ñ Set. Similarly,thehomcategoryPCpA,Bqisthecategoryof
` ˘
elements of the presheaf E ´,CpA,Bq : Eop Ñ Set. We will see in §4.2.1 that the category
ofelementsconstructionyieldsanequivalencebetweenpresheavesandcategories-of-elements,
and so we may as well consider Parapdq to be enriched in the presheaf category rMop,Sets
andPC tobeenrichedinrEop,Sets. Thephrase“locallygraded”indicatesthatthe‘homsets’of
Parapdq and PC are ‘graded’ by the objects of M and E respectively. We learnt about locally
gradedcategoriesfromDylanBraithwaite.
3.3. Systems from circuits
The dominant motivation for the use of monoidal categories so far has been in modelling the
compositionalstructureofprocesses,onthebasisoftheobservationthatprocessesmaygenerally
3Later,inDefinition4.2.28,wewillencounterthecontravariantself-indexing,whichhasthesameactiononobjectsbut
isgivenonmorphismsbypullback.Whereasthecovariantself-indexingisalwayswell-defined,thecontravariant
self-indexingisthereforeonlywell-definedinthemorerestrictedsituationwhereE hasallpullbacks.
4Apseudofunctorisakindof‘weakened’functor,forwhichfunctorialityonlyneedstoholduptoisomorphism;see
Definition4.2.10.
92
be composed both sequentially and in parallel, and so 1-dimensional category theory alone is
insufficient. Theprocessesforwhichthiskindofstructureismostsuitedarethosethatexhibita
flowofinformation. Forexample,ifwetakethemorphismsofthecategorySetascomputable
functions,thenweseethatthecorresponding“processtheory”isadequateforinterpretingdiagrams
oftheformof§2.1.1.3;andwewillencounterinChapter4aprocess-theoreticframeworkformalizing
probabilisticgraphicalmodelsofthekinddiscussedin§2.1.1.2.
Inthesemonoidalcategories,processesarerepresentedbymorphisms,withcompositionused
toconnectprocessestogether: thecompositeoftwoprocessesisagainaprocess. However,some
morphismsarepurely‘structural’,implementingtheplumbingofinformationflow—suchascopying,
discarding,andswapping—andsothesecategoriessomewhatblurtheboundarybetweensyntax
and semantics. At the same time, it is strange to think of something like a neural circuit as a
‘process’: althoughitmightreifysomeprocessinitsbehaviour,itisratherasystem.
Tosharpenthesyntax-semanticsboundary,onecanshowthateverymonoidalcategoryarises
as an algebra for a certain monad. We will make these notions precise in §3.4 below, and here
itwillsufficetoprovidesomeintuition: themonaddefinesthesyntax,andthealgebrasupplies
acompatiblesemantics. Algebrainthissenseisavastgeneralizationoftheabstractalgebraof
familiarmathematics,andtypicallyinvolvesdefiningsymbolicoperationsandrulesbywhichthey
canbecombined,substituted,compared,andreduced.
Inthissection,althoughwedonotexplicitlymakeuseofthetechnologyofmonads,weexemplify
this approach with an example of compositional connectomics: on the syntactic side, we will
introducea‘multicategory’oflinearcircuitdiagramswhichgovernpatternsofneuralconnectivity;
whileonthesemanticside,wewillequipthismulticategorywithafunctorialalgebraofrate-coded
neuralcircuits5. Wewillfindthatthismoreexplicitlyalgebraicapproachresolvesthedilemma
observedabovebetweenthecompositionalstructureofprocessesandthatofsystems: algebraic
syntaxisinsomesenseaboutsubstitution,andsocircuitdiagramswillhave‘holes’intowhichcan
besubstitutedothercircuitdiagrams. Thatistosay,acircuitdiagramisamorphismwhichtakesa
givenpatternofholesandconnectsthemtogetherintoasinglecircuit,asinthefollowingdiagram,
5IntheAppendix(§A.1),wesketchtheconnectionbetweenthismulticategoricalstoryandthemonadicone.
93
whichbringsusbacktoourfirstmotivatingexamplefrom§2.1.1.1andwhichweformalizebelow.
E
ÞÑ EI
I
Wewilluseasimilarapproachwhenwesupplydynamicalsemanticsforapproximateinference,
althoughthere,forourgeneralsyntaxofsystems,wewillusecategoriesofpolynomialfunctors,
which we introduce in §3.5 at the end of this chapter. In any case, it will turn out that linear
circuitdiagramsembednaturallyintopolynomials,andsothecircuitsbelowcanbeunderstoodas
providingasampleofwhatistocome.
3.3.1. Multicategoricalalgebraforhierarchicalsystems
Amulticategoryislikeacategory,butwheremorphismsmayhavea‘complex’domain,suchasa
listofobjects[168]. Amorphismwhosedomainisann-lengthlistiscalled‘n-ary’,andwecan
abstractlythinkofsuchmorphismsas‘n-aryoperations’: forexample,wewillusethemtomodel
connecting n circuits together into a single system. Because these morphisms effect a kind of
‘zooming-out’,wecanusethemtoconstructhierarchicalor‘nested’systems-of-systems.
Definition3.3.1. Amulticategory O consistsof
1. asetO ofobjects;
0
2. asetO ofmorphisms,equippedwith
1
a) acodomainfunctioncod : O Ñ O ,and
1 0
b) a domain function dom : O Ñ ListpO q, where ListpO q is the set of finite lists of
1 0 0
objectspo ,...,o q,
1 n
sothateachn-ary morphismf hasalistofnobjectsasitsdomainandasingleobjectasits
codomain,writtenf : po ,...,o q Ñ p;
1 n
3. anidentity functionid : O Ñ O suchthatcodpid q “ oanddompid q “ poq,sothatthe
0 1 o o
identityonoiswrittenid : o Ñ o;
o
4. afamilyofcompositionfunctions
˝ : Opo ,...,o ;pqˆOpo1,...,ok1;o qˆ¨¨¨ˆOpo1,...,okn;o q
p,poiq,poj
i
q 1 n 1 1 1 n n n
Ñ
Opo1,...,ok1,...,o1,...,okn;pq
1 1 n n
94
writtenas
pf,f ,...,f q ÞÑ f ˝pf ,...,f q
1 n 1 n
foreachobjectp,n-arylistobjectspo ,...,o q,andnk -arylistsofobjectspo1,...,okiq;
1 n i i i
satisfyingtheequationsofassociativity
` ˘
f ˝ f ˝pf1,...,fk1q,...,f ˝pf1,...,fknq
1 1 1 n n n
` ˘
“ f ˝pf ,...,f q ˝pf1,...,fk1,...,f1,...,fknq
1 n 1 1 n n
wheneversuchcompositesmakesense,andunitality
f ˝pid ,...,id q “ f “ id ˝f
o1 on p
foreveryf : po ,...,o q Ñ p.
1 n
Forourpurposes,theorderofobjectsinthelistswillnotmatter,whichweformalizewiththe
notionofsymmetric multicategory—analogoustothesymmetricmonoidalcategoriesof§3.1.2.
Definition3.3.2. LetS bethesymmetricgrouponnelements. Asymmetricmulticategory Oisa
n
multicategoryO whichisadditionallyequipped,foreachn : N,withanactionσ ofS ontheset
n n
On ofn-arymorphisms
1
σ : S ˆOn Ñ On
n n 1 1
suchthatcomposition˝preservesthisaction.
Remark 3.3.3. In other applied-category-theoretical contexts, multicategories of this kind are
sometimescalledoperads(cf.e.g.[18,97,98,171,206,222,231,237,243,244,268,282]).Traditionally,
anoperadisthesameasamulticategorywithoneobject[168];sometimestherefore,multicategories
arecalledcoloured ortyped operads[17,59,98,168]. Inordertoavoidconfusion,wewillstickwith
‘multicategory’.
Although the multicategorical intuition—of hierarchically constructing complex systems—is
valuable,thefollowingfactmeansthatthereisacloseconnectionbetweenmulticategoriesand
monoidalcategories,forinamonoidalcategory,wecaninterpretann-arytensorx b¨¨¨bx as
1 n
ann-arylistofobjects.
Proposition3.3.4. AnymonoidalcategorypC,b,IqinducesacorrespondingmulticategoryOC.
TheobjectsOC aretheobjectsC ofC. Then-arymorphismspc ,...,c q Ñ darethemorphisms
0 0 1 n
c b ¨¨¨ b c Ñ d; i.e., OCpc ,...,c ;dq :“ Cpc b ¨¨¨ b c ,dq. Identities are as in C, and
1 n 1 n 1 n
compositionisdefinedbypf,f ,...,f q ÞÑ f ˝pf b¨¨¨bf q. WhenC issymmetric,soisOC.
1 n 1 n
95
Example3.3.5. AnexamplethatwillsoonbecomeimportantistheoperadSetsofsetsandn-ary
functions,whichisobtainedfromthesymmetricmonoidalcategorySetbySets :“ OSet.
Aswediscussedabove,wewillconsidermulticategoriesassupplyingasyntaxforthecomposition
ofsystems,andsoactuallytocomposesystemsrequirestheextradataofwhatthosesystemsare
and how they can be composed according to the syntax. This extra semantic data is called an
‘algebra’forthemulticategory.
Definition3.3.6. Analgebraforamulticategory Misamultifunctor M Ñ Sets.
Multifunctorsarethemulticategoricalanaloguesoffunctors;butfortunately(eventhoughthe
definitionisnotahardone),wewillnotneedtodefinethem,owingtothefollowingresult,which
relatesmultifunctorsandlaxmonoidalfunctors.
Proposition3.3.7(Leinster[168,Example4.3.3,Definition2.1.12]). IfthemulticategoryMarises
from a monoidal category pC,b,Iq as M “ OC, then an algebra for M is determined by a lax
monoidalfunctorpC,b,Iq Ñ pSet,ˆ,1q.
Remark3.3.8. In§3.4,wewillencountertheconceptof“algebraforamonad”,whichisperhaps
the more familiar concept in mathematics and computer science. One might therefore wonder
whattherelationshipbetweenthetwonotionsof‘algebra’is: whydotheybothhavethisname?
TheanswerisprovidedbyLeinster[168]: every‘shape’ofmulticategorycorrespondstoacertain
monad;andeverymulticategoryalgebracorrespondstoanalgebraforamonadderived(inthe
contextoftheparticularmulticategoryathand)fromthismulticategory-shapemonad. Forthe
interestedreader,wereviewtheseresultsintheAppendix(§A.1). In§3.3.2,wewillexemplifythe
notionofmonadalgebrawiththemorebasicresultthateverysmallcategorycorrespondstoan
algebraforacertainmonad. Monadalgebraswillalsoproveusefullaterinthethesisinthecontext
ofcompositionalprobabilitytheory.
3.3.2. Linearcircuitdiagrams
Let us now exhibit the multicategory formalizing circuit diagrams of the type with which we
openedthissection. Althoughourmotivationismulticategorical,forsimplicitywewillproceedby
definingasymmetricmonoidalcategory. Itsobjectswillrepresentthe‘output-input’dimensionsof
acircuit,writtenaspairsofnumberspn ,n q,anditsmorphismspn ,n q Ñ pm ,m qencodehow
o i o i o i
towireacircuitwithn outputsandn inputstogethertoproduceacircuitofm outputsandm
o i o i
inputs: thismayinvolveconnectingsomeofthen outputstothem outputs;orconnectingsome
o o
96
ofthem inputs,or(toallowrecurrence)then outputs,tothen inputs. Thedefinitionmayseem
i o i
somewhatmysteriousatfirst,butitsformisowedtoamoreabstractstructure(lenses)thatwewill
definelater,in§4.2.
` ˘
Example3.3.9. Wedefineasymmetricmonoidalcategory LinCirc,`,p0,0q oflinearcircuit
diagramsandconsidertheinducedmulticategoryOLinCirc. TheobjectsofLinCircarepairs
pn ,n q of natural numbers. A morphism pn ,n q Ñ pm ,m q is a pair of real-valued matrices
o i o i o i
pA,BqwithAofshapepm ,n qandsemi-orthogonal(i.e.,suchthatAAT “ 1 )andB ofshape
o o mo
pn
i
,n
o
`m
i
q;equivalently,Aisasemi-orthogonallinearmapRno Ñ Rmo andB isalinearmap
Rno`mi Ñ Rni . The identity m
`
orphism
˘
id
pno,niq
on pn
o
,n
i
q is the pair of matrices p1
no
,01
no
q
where01 istheblockmatrix 0 1 . GivenmorphismspA,Bq : pn ,n q Ñ pm ,m qand
no no no o i o i
pA1,B1q : pm ,m q Ñ pk ,k q, their composite is the pair pA1A,BB1 q where A1A is the usual
o i o i A
matrixproductandBB1 isdefinedasthefollowingblockmatrixmultiplication:
A
¨ ˛
ˆ ˙
1 0
BB1 :“ B 1 no 0 ˝ A no 0 ‚
A 0 B1
0 1
ki
Unitalityandassociativityofcompositionfollowfromthosepropertiesofmatrixmultiplication,
andAA1 iseasilyseentobesemi-orthogonal(byAA1pAA1qT “ AA1A1TAT “ AAT “ 1 ),so
mo
LinCircisawell-definedcategory.
Wenowturntothemonoidalstructure. Themonoidalunitisthepairp0,0q;notethatRo – 1.
Themonoidalproduct`isdefinedonobjectsasthepointwisesum: pn ,n q`pm ,m q :“ pn `
o i o i o
m
o
,n
i
`m
i
q;notethatRno`mo – Rno ˆRmo . GivenmorphismspA,Bq : pn
o
,n
i
q Ñ pm
o
,m
i
q
and pA1,B1q : pn1,n1q Ñ pm1,m1q, their monoidal product pA,Bq`pA1,B1q is defined as the
o i o i
pairpA‘A1,B‘B1q : pn `n1,n `n1q Ñ pm `m1,m `m1qwith
o o i i o o i i
¨ ˛
1 0 0 0
ˆ ˙ ˆ ˙
˚
no
‹
A‘A1 :“ A 0 and B‘B1 :“ B 0 ˚ ˝ 0 0 1 mi 0 ‹ ‚.
0 A1 0 B1 0 1 0 0
n1
o
0 0 0 1
m1
i
For each pair of objects pn ,n q and pm ,m q, the symmetry σ : pn ,n q `
o i o i pno,niq,pmo,miq o i
pm ,m q Ñ pm ,m q`pn ,n qisdefinedasthepairofmatricespσo ,σi q,
o i o i o i n,m n,m
ˆ ˙ ˆ ˙
0 1 0 0 0 1
σo :“ mo and σi :“ ni .
n,m 1 0 n,m 0 0 1 0
no mi
That this definition produces a well-defined symmetric monoidal structure follows from more
abstract considerations that we explain in Remark 4.2.33 and Corollary 4.2.36: LinCirc is a
subcategoryofCartesianlenses,withthemonoidalstructureinheritedaccordingly.
97
Thecategoryoflinearcircuitdiagramsisasyntacticcategory:onitsown,itdoesnotdoanything.
Weneedtoequipitwithsemantics.
3.3.3. Analgebraofrate-codedneuralcircuits
Webeginbydefininganotionof‘rate-coded’neuralcircuit.
Definition3.3.10. Ann -dimensionalrate-codedneuralcircuit withn -dimensionalinputisan
o i
ordinarydifferentialequation
` ˘
x9 “ ´λdx`h Wpx‘iq;α,β,γ
where x,λ,α,β,γ are real vectors of dimension n , i a real vector of dimension n , W a real
o i
matrixofshape ˆpn˙o ,n
o
`n
i
q,delementwisemultiplication,‘thedirectsum(sothatx‘iisthe
x
concatenation ),andhthelogisticfunction
i
γ
hpx;α,β,γq “ ` ˘
1`exp ´βpx´αq
appliedelementwise. Wesummarizethedataofsuchacircuitasthetuplepλ,α,β,γ,Wq.
Remark 3.3.11. Rate-coded neural circuits are a coarse phenomenological model of neural
dynamics. The state variable x represents the firing rates of an ensemble of neurons, either
averagedovertimeoroversubpopulations. Neuralactivityisofcoursenotsosimple: neurons
communicatebythetransmissionofdiscrete‘actionpotentials’alongtheiraxons. Theemissionof
anactionpotentialisgovernedbytheelectricalpotentialofitscellularmembrane: ifthispotential
crossesathreshold,thentheneuron‘fires’anactionpotentialdownitsaxon. Theaxoncrossesthe
dendritesofotherneuronsatjunctionscalledsynapses,whichmodulateandtransmittheactivity
accordingly: it is these afferent signals which in large part determine the neurons’ membrane
potentials.
Thereareofcoursedetailedphysiologicalmodelsofthisprocess(cf. e.g. [79,133,181,226]),as
wellasmanymodelswhichaimtocaptureitsstatisticsandphenomenologyinamoreexplicitly
computational setting (cf. e.g. [81, 82, 117, 136, 146, 202, 227, 273]), but in some situations, one
can simply model neural firing as an inhomogeneous Poisson process: in this case the variable
x encodes the rate parameters of the processes. We expect there to be functorial connections
betweenthedifferentclassesofmodels: inparticular,weexpectadjointfunctorsbetweencertain
spike-emissionmodelsandfiringratemodelsoftheclassdefinedabove;andinthespecificcaseof
98
‘efficientbalanced’networks[32,82],therelationshipsareexpectedtobequitesimple. Nonetheless,
weleavetheexplorationofsuchfunctorstofuturework.
The parameters of a rate-coded neural circuit—the terms λ,α,β,γ,W— have a neurological
interpretation, even though this dynamical model is not physiologically faithful. The term λ
representsthe‘leak’ofvoltagefromtheneuron’smembrane,whichhastheeffectofdetermining
thetimescaleofitsmemoryorsignal-sensitivity(effectively,thevoltageleakentailsaprocessof
filtering). Thetermαrepresentsanabstractionoftheneuron’sfiringthreshold,andthetermβ its
sensitivity(i.e.,howmuchitsfiringrateincreaseswithincomingsignals);thetermγ determines
themaximumfiringrateoftheneuron(andistypicallynormalizedto1). Finally,thematrixW
recordsthestrengthsofthesynapticconnectionswithinthecircuit: positivecoefficientsrepresent
excitatoryconnections,whilenegativecoefficientsrepresentinhibitoryconnections.
Rate-coded neural circuits can be organized into complex ‘hierarchical’ systems using linear
circuitdiagrams: thelinearconnectivityofthediagramsisusedtodefinethesynapticconnection
matrix of the complex, algebraically. The proof that the following construction does actually
constituteanalgebraensuresthatcomposingsystemsfromcircuitsusingdiagramsispredictably
well-behaved,aswewillsubsequentlyexemplify.
Proposition3.3.12(Algebraofrate-codedneuralcircuits). ThereisaLinCirc-algebrapR,µ,ϵq :
` ˘
LinCirc,`,p0,0q Ñ pSet,ˆ,1q of rate-coded neural circuits. On objects pn ,n q, define
o i
Rpn ,n q to be the set of n -dimensional rate-coded neural circuits with n -dimensional input.
o i o i
Then,givenalinearcircuitdiagrampA,Bq : pn ,n q Ñ pm ,m q,defineafunction
o i o i
RpA,Bq : Rpn ,n q Ñ Rpm ,m q
o i o i
pλ,α,β,γ,Wq ÞÑ pAλ,Aα,Aβ,Aγ,W q
AB
whereW isthefollowingblockmatrixproduct:
AB
¨ ˛
ˆ ˙ ˆ ˙
1 0
W :“ AW 1 no 0 ˝ 1 no 0 ‚ AT 0 .
AB 0 B no 0 1
0 1 mi
mi
Thelaxatorµisdefinedcomponentwiseasthefamilyoffunctions
` ˘
µ : Rpn ,n qˆRpm ,m q Ñ R pn ,n q`pm ,m q
pno,niq,pmo,miq o i o i o i o i
taking a pair of circuits pλ,α,β,γ,Wq : Rpn
o
,n
i
q and pλ1,α1,β1,γ1,W1q : Rpˆm o˙,m
i
q to the
x
circuitpλ‘λ1,α‘α1,β‘β1,γ‘γ1,WW1qwherex‘y isagainthedirectsum andwhere
y
99
thematrixWW1 isdefinedas
¨ ˛
ˆ ˙
˚
1 no 0 0 0
‹
WW1 :“ W 0 ˚ ˝ 0 0 1 ni 0 ‹ ‚.
0 W1 0 1 0 0
mo
0 0 0 1
mi
Theunitorϵistheisomorphismϵ : 1 ÝÑ „ Rp0,0q.
Proof. We need to check that R is a lax monoidal functor, and begin by verifying functoriality.
SosupposepA1,B1qisalinearcircuitdiagrampm ,m q Ñ pk ,k q. Onthetermsλ,α,β,γ,the
o i o i
functoriality of R is immediate from matrix multiplication, so we concentrate on the action of
` ˘
R on W. We need to show that R pA1,B1q˝pA,Bq pWq “ RpA1,B1q˝RpA,BqpWq, where
RpA,BqpWq “ W asdefinedabove. NotethatwecanalternativelywriteW asthefollowing
AB AB
compositelinearmap
m `m Ý A Ý T Ý ` Ý m ÝÑi n `m ÝÝÝ ` Ý m Ñi n `n `m Ý n ÝoÝ ` ÝÑ B n `n Ý W Ñ n ÝÑ A m .
o i o i o o i o i o o
WecanthereforewriteRpA1,B1qpW qas
AB
k `k Ý A Ý 1 Ý T Ý ` Ý k Ñi m `k Ý A Ý T Ý ` Ý k Ñi n `k ÝÝÝ ` Ý k Ñi n `n `k ¨¨¨
o i o i o i o o i
¨¨¨ Ý n Ý o Ý ` ÝÝ ` Ý k Ñi n `n `n `k Ý n ÝoÝ ` Ý noÝ ` Ý A Ý ` Ý k Ñi n `n `m `k ¨¨¨
o o o i o o o i
¨¨¨ Ý n ÝoÝ ` Ý n ÝoÝ ` Ý B Ñ 1 n `n `m Ý n ÝoÝ ` ÝÑ B n `n Ý W Ñ n ÝÑ A m Ý A Ñ 1 k
o o i o i o o o
` ˘
andR pA1,B1q˝pA,Bq pWqas
k `k Ý A Ý 1 Ý T Ý ` Ý k Ñi m `k ÝÝÝ ` Ý k Ñi m `m `k Ý m ÝoÝ ` Ý B Ñ 1 m `m Ý A Ý T Ý ` Ý m ÝÑi ¨¨¨
o i o i o o i o i
¨¨¨ n `m ÝÝÝ ` Ý m Ñi n `n `m Ý n ÝoÝ ` ÝÑ B n `n Ý W Ñ n ÝÑ A m Ý A Ñ 1 k
o i o o i o i o o o
soitsufficestocheckthat
m `k Ý A Ý T Ý ` Ý k Ñi n `k ÝÝÝ ` Ý k Ñi n `n `k Ý n Ý o Ý ` ÝÝ ` Ý k Ñi n `n `n `k ¨¨¨
o i o i o o i o o o i
¨¨¨ Ý n ÝoÝ ` Ý noÝ ` Ý A Ý ` Ý k Ñi n `n `m `k Ý n ÝoÝ ` Ý n ÝoÝ ` Ý B Ñ 1 n `n `m
o o o i o o i
“
m `k ÝÝÝ ` Ý k Ñi m `m `k Ý m ÝoÝ ` Ý B Ñ 1 m `m Ý A Ý T Ý ` Ý m ÝÑi n `m ÝÝÝ ` Ý m Ñi n `n `m
o i o o i o i o i o o i
100
whichwecandousingthegraphicalcalculus:
n n
o o
AT
m o (1) m o
AT “ ¨¨¨
n n
o o
AT
A m i A m i
k
i
B1 k
i
B1
n n
o o
AT AT
(2) m o (3) m o
¨¨¨ “ AT “ AT ¨¨¨
n n
o o
AT A m i m i
k
i
B1 k
i
B1
n
o
AT
n
o
(4) (5)
¨¨¨ “ m o AT “ AT
n m n
o o o
m m
i i
k
i
B1 k
i
B1
wheretheequality(1)holdsbecauseAT isacomonoidmorphism(Definition3.4.23)6,(2)likewise,
(3)becauseAissemi-orthogonal,(4)bythecoassociativityofcopying,and(5)againbecauseAT is
acomonoidmorphism. Finally,weobservethatthelaststringdiagramdepictsthelinearmap
m `k ÝÝÝ ` Ý k Ñi m `m `k Ý A Ý T Ý ` Ý B Ñ 1 n `m ÝÝÝ ` Ý m Ñi n `n `m
o i o o i o i o o i
whichequalstherequiredmap
m `k ÝÝÝ ` Ý k Ñi m `m `k Ý m ÝoÝ ` Ý B Ñ 1 m `m Ý A Ý T Ý ` Ý m ÝÑi n `m ÝÝÝ ` Ý m Ñi n `n `m
o i o o i o i o i o o i
bytheunitalityofcomposition. ThisestablishesthatRpreservescomposites;itremainstocheck
that it preserves identities. Once again, this follows immediately on the terms λ,α,β,γ, so we
concentrateontheactiononW. Wehave
¨ ˛
ˆ ˙ ˆ ˙
1 0
Rp1 ,01 qpWq “ 1 W 1 no 0 0 ˝ 1 no 0 ‚ 1 no 0
no no no 0 0 1 no 0 1
no 0 1 mi
mi
whichiseasilyseentobeequaltoW itself. ThereforeRdefinesafunctor.
Wenowneedtoverifythattheunitorandlaxatorsatisfytheunitalityandassociativityaxiomsofa
laxmonoidalfunctor.Webeginbycheckingassociativity,sosupposethatwearegiventhreecircuits:
6Thisinturnbecause‘istheCartesianproduct,andsoeverymorphismisa‘-comonoidmorphism.
101
pλ,α,β,γ,Wq : Rpn ,n q, and pλ1,α1,β1,γ1,W1q : Rpm ,m q, and pλ2,α2,β2,γ2,W2q :
o i o i
Rpk ,k q. Associativity on all the terms but W,W1,W2 follows from the associativity of the
o i
direct sum ‘, and so we just need to check that µpW,µpW1,W2qq “ µpµpW,W1q,W2q where
µpW,W1q “ WW1 andµpW1,W2q “ W1W2,accordingtothedefinitionabove. Oncemore,we
usethegraphicalcalculus. ObservethatwecandepictWW1 andW1W2 as
n m
o o
n m
o o
m o W k o W1
and
n m
i i
m o k o
m i W1 k i W2
respectively. HenceµpW,µpW1,W2qqsatisfiestheequality
n n
o o
n n
o o
m W m W
o o
k k
o o
m m
µpW,µpW1,W2qq “ n o “ n W1 o
i i
m W1W2 m
i i
k k
o o
k k
W2
i i
andlikewiseµpµpW,W1q,W2qsatisfies
n n
o o
n n
o o
m m W
o o
k
WW1
k
o o
m m
µpµpW,W1q,W2q “ n o “ n W1 o .
i i
m m
i i
k k
o o
k
W2
k
W2
i i
The two diagrams on the right hand side are equal up to a topological deformation, and so the
depictedmorphismsareequalbythecoherencetheoremformonoidalcategories. Thisestablishes
the associativity of the laxator. It remains to establish unitality: but this follows immediately,
becauseRp0,0q – R0andthe0-dimensionalspaceistheunitforthedirectsum‘. HencepR,µ,ϵq
` ˘
isalaxmonoidalfunctor,andhenceanalgebrafor LinCirc,`,p0,0q .
Remark3.3.13. Atpointsintheprecedingproof,weusedthefactthatalinearmapisacomonoid
morphism,whichimpliesthatitcommuteswithcopying. Wewilldefinethenotionofcomonoid
102
morphismin§3.4.1below;meanwhile,thefactthatAT isonefollowsfromthefactthat‘isthe
categoricalproductofvectorspaces,andsoeverylinearmapisa‘-comonoidmorphism.
Remark 3.3.14. Let us return briefly to the distinction made at the beginning of this section
betweenprocessesandsystems,andtheircorrespondingcategoricalincarnations. Onemightbe
temptedtotryconstructingasymmetricmonoidalcategoryofneuralcircuitsusingthisalgebra
whose objects would be natural numbers and whose morphisms i Ñ o would be circuits in
Rpo,iq, treated thus as ‘processes’. But this won’t work, because there is no neural circuit that
will function as an identity morphism! Later in the thesis (§6.3), we will see one way around
this problem, building monoidal categories of hierarchical dynamical systems that are in some
senseanalogoustothesecircuits(whilebeingmoregeneral): there,wewillusetherichstructure
of polynomial functors to define both the syntax of composition as well as the hom categories
(for our construction will be bicategorical) of dynamical systems, and the extra generality will
mean we will have identity systems (that compose appropriately unitally). Until then, we note
thatthemoralofthisobservationmightbethatitaffirmsthatthecompositionofneuralcircuitsis
multicategory-algebraic(formalizinganotionofhierarchy),ratherthanmerelycategorical.
Theweightmatricesresultingfromthelinearcircuitalgebraencodethepatternofconnectivity
specifiedbythediagram,aswenowexemplify.
Example3.3.15. Letusconsiderthecircuitexamplefromthebeginningofthissection,thewiring
ofaninhibitorycircuittoanexcitatorycircuit,asinthediagram
E
ÞÑ EI
I
whichdepictsalinearcircuitdiagramE `I Ñ EI. Insuchadiagram,theinputdimensionof
anobject(suchasE)musthavedimensionequallingthesumofthedimensionsoftheincoming
wires. Dually,thedimensionalongawireemanatingfromanobjectmusthavedimensionequalto
theoutputdimensionofthatobject. Todistinguishthesourceandtargetofawire,wedecoratethe
targetends: afilledcircledenotesaninhibitoryconnection,interpretedinthelinearcircuitasthe
negativeidentitymatrix´1oftheappropriatedimension;andaninvertedarrowheaddenotesan
excitatoryconnection,interpretedasthepositiveidentity1oftheappropriatedimension. Wewill
writethedimensionsoftheobjectEaspo ,i q,ofI aspo ,i q,andofEI aspo ,i q. Therefore,
E E I I EI EI
103
inthisexample,thefollowingequalitiesmusthold: i “ o `i ;i “ o ;ando “ o `o .
E I EI I E EI E I
ThelastequationholdsbecausethecircuitEI isformedfromthesumofthecircuitsE andI.
TogiveacircuitdiagrampA,Bq : po ,i q`po ,i q Ñ po ,i qistogiveasemi-orthogonal
E E I I EI EI
realmatrixAofshapepo ,o `o qandarealmatrixB ofshapepi `i ,o `o `i q. Using
EI E I E I E I EI
the preceding equalities, these are equivalently shaped as po `o ,o `o q and po `i `
E I E I I EI
o ,o `o `i q,andwejustchoosetheidentitymatrix1 forA. TodefineB,wereadit
E E I EI oE`oI
offfromthediagramas
¨ ˛
0 ´1 0
˝
oI
‚
B :“ 0 0 1 .
iEI
1 0 0
oE
Nowsupposepλ ,α, ,β ,γ ,W qandpλ ,α, ,β ,γ ,W qaretworate-codedneuralcircuits,
E E E E E I I I I I
theformeroftypeRpo ,i qandthelatteroftypeRpo ,i q. HowdoesRpA,Bqactuponthemto
E E I I
giveourcompositecircuit?
Onalltheparametersbuttheweightmatrices,RpA,Bqactstrivially(sinceAisjusttheidentity
matrix),andsowewillconcentrateontheactiononW ,W . Firstly,weneedtoformthemonoidal
E I
productoftheweightmatrices,µpW ,W q,whichisdefinedby
E I
¨ ˛
ˆ ˙
˚
1 oE 0 0 0
‹
µpW E ,W I q “ W 0 E W 0 ˚ ˝ 0 0 1 0 1 0 iE 0 0 ‹ ‚
I oI
0 0 0 1
¨
iI
˛
1 0 0 0 0
ˆ ˙˚
oE
‹
“ W 0 E W 0 I ˚ ˚ ˚ ˝ 0 0 0 1 0 0 1 0 0 oI 1 i 0 0 EI 0 0 0 ‹ ‹ ‹ ‚
oI
0 0 0 0 1
oE
wherethesecondequalityholdsbyapplyingtheequalitiesbetweenthedimensionsdefinedabove.
TheweightmatrixRpA,BqpµpW ,W qqisthendefinedas
E I
¨ ˛
ˆ ˙ ˆ ˙
1 0
AµpW ,W q 1 oE`oI 0 ˝ 1 oE`oI 0 ‚ AT 0 .
E I 0 B oE`oI 0 1
0 1 iEI
iEI
SinceA “ 1 ,andbysubstitutingthedefinitionofµpW ,W q,thisreducesto
oE`oI E I
¨ ˛
ˆ ˙˚
1 oE 0 0 0 0
‹ˆ ˙
¨ ˛
W 0 E W 0 I ˚ ˚ ˚ ˝ 0 0 0 1 0 0 1 0 0 oI 1 i 0 0 EI 0 0 0 ‹ ‹ ‹ ‚ 1 oE 0 `oI B 0 ˝ 1 1 o o E E 0 ` ` o o I I 1 0 0 ‚ .
oI iEI
0 0 0 0 1
oE
104
Then,bysubstitutionandmatrixmultiplication,wehavethefollowingequalities:
¨ ˛
˚
1 oE 0 0 0 0
‹ˆ ˙
¨ ˛
˚ ˚ ˚ ˝ 0 0 0 0 1 0 oI 1 i 0 EI 0 0 ‹ ‹ ‹ ‚ 1 oE 0 `oI B 0 ˝ 1 1 o o E E ` ` o o I I 0 0 ‚
0 1 0 0 0 0 1
oI iEI
0 0 0 0 1
¨
oE
˛¨ ˛¨ ˛
1 0 0 0 0 1 0 0 0 0 1 0 0
˚
oE
‹˚
oE
‹˚
oE
‹
˚
˚
0 0 1 oI 0 0 ‹
‹
˚
˚
0 1 oI 0 0 0 ‹
‹
˚
˚
0 1 oI 0 ‹
‹
“ ˚
˝
0 0 0 1 iEI 0 ‹
‚
˚
˝
0 0 0 ´1 oI 0 ‹
‚
˚
˝
1 oE 0 0 ‹
‚
0 1 0 0 0 0 0 0 0 1 0 1 0
oI iEI oI
0 0 0 0 1 0 0 1 0 0 0 0 1
¨
oE˛¨ oE
˛
iEI
1 0 0 0 0 1 0 0
˚
oE
‹˚
oI
‹
˚
˚
0 0 1 oI 0 0 ‹
‹
˚
˚
0 1 oI 0 ‹
‹
“ ˚
˝
0 0 0 1 iEI 0 ‹
‚
˚
˝
0 ´1 oI 0 ‹
‚
0 1 0 0 0 0 0 1
oI iEI
0 0 0 0 1 1 0 0
¨ ˛
oE oE
1 0 0
˚
oE
‹
˚
˚
0 ´1 oI 0 ‹
‹
“ ˚
˝
0 0 1 iEI ‹
‚
0 1 0
oI
1 0 0
oE
sothattheresultingweightmatrixRpA,BqpµpW ,W qqis
E I
¨ ˛
1 0 0
ˆ ˙˚
oE
‹
W 0 E W 0 I ˚ ˚ ˚ ˝ 0 0 0 ´ 1 1 0 oI 1 i 0 0 EI ‹ ‹ ‹ ‚ .
oI
1 0 0
oE
Readingoffthisweightmatrix,weseethattheE neuronsreceiveexternalinputplusrecurrent
excitatoryinputfromthemselvesaswellasinhibitoryinputfromI,andthattheI neuronsreceive
only recurrent excitatory input plus excitatory input from E. This is exactly as it should be,
giventhediagram: byformalizingthesecomputations, werenderthemmechanical(andhence
computer-implementable). Inparticular,wecantreattheresultingEI circuitasa“blackbox”and
substituteitintootherdiagramstoconstructstilllarger-scalesystems.
Since linear circuit diagrams allow for any linear pattern of connectivity, we can of course
generalizethepictureabovetoallowformoresubtleinterconnections.
Example3.3.16. Supposethatinsteadofincorporatingonlyexcitatoryorinhibitoryconnections,
105
wesoughtsomethingalittlemorecomplex,asinthefollowingcircuitdiagram:
E
C D ÞÑ EI
I
Now,wehavedecoratedthewireswithfleches,toindicatetheflowofactivity;andbesidesthe
circular boxes (representing circuits), we have incorporated square boxes (representing linear
patternsofinterconnection). UsingthesamenotationforthedimensionsofthecircuitsE,I and
EI asinExample3.3.15,thismeansthattheboxessquareboxesrepresentmatricesC ofshape
pi `i ,n`i qandD ofshapepn,o `o q,wherenisthedimensionoftheD-C wire. Ifwe
E I EI E I
againwritepA,Bqfortheimpliedcircuitdiagram,andwecanagainsetAtobetheidentitymatrix,
andreadB fromthediagramasthecompositematrix
B :“ o `o `i Ý D Ý ‘ Ý 1 Ý i ÝEÑI n`i ÝÑ C i `i .
E I EI EI E I
Therestofthecalculationfollowsmechanically,justasbefore.
Onefeaturemissingfromtheconstructioninthissectionissynapticplasticity: althoughwehave
shownhowtocomposecircuitsintosystems,itisonlytheneuralfiringratesthataredynamical;
theconnectionmatricesremainfixed. Intheprecedingsection,wemotivatedtheintroductionof
parameterizedcategoriesbytheirapplicationtolearningproblems,andindeedonecouldfactorize
the linear circuit algebra above by extracting the connection matrices into parameters; if one
wantedtoretainachoiceofinitialweightmatrix,thiscouldalsobeincorporatedintoa‘pointed’
versionofthestructure.
This parameterized construction would be bicategorical, and so a faithful semantics for it
wouldnolongerlandinSet,butratherinCat: wewouldhavecategoriesofcircuitsrelatedby
reparameterizationsoftheweightmatrices,andwiththedynamicsalsoincorporatingplasticity7.
Withasufficientlysophisticatedalgebra,itwouldevenbepossibletoallowthecircuitdiagrams
themselvestobedynamicalandsubjecttolearning. Wewillnotpursuethislineofenquiryfurther
here,butwewillreturntoitwhenweintroduceplasticityintoapproximateinferencedoctrines:
there,ourstructureswillbesufficientlysuppletoincorporatealloftheconceptssketchedhere.
7Anevenmorefaithfuldynamicalsemanticswouldlandin“bundledynamicalsystems”,oftheformthatweintroduce
inChapter6:twotwolevelsofthebundlewouldwitnessthedynamicsofthefiringactivityandtheplasticity,and
thebundlesthemselveswouldwitnessthetimescaleseparation.
106
3.4. From monoids to monads
Inordertoreachthelevelofsupplenessrequiredbyplasticdynamicalapproximateinference,itwill
helptounderstandthestructuresunderlyingthedefinitionsandconstructionsintroducedsofarin
thischapter—inparticular,wewillneedafirmgraspoftheconceptsofmonadandcomonoid—and
soatthispointwereturntoanexpositorymode.
Thefundamentalconceptunderlyingmanyofthestructureswehaveseensofaristhemonoid:
anobjectequippedwithtwooperations,onebinaryandone‘nullary’,withthelatteractingasa
‘unit’fortheformer,andalthoughthemajoroperationisonlybinary,itcanbechainedinorderto
formn-aryoperations. Forthisreason,monoidsarefundamentaltoabstractalgebra: categories
themselvesare“monoidswithmanyobjects”(inthesamewaythatamulticategoryisanoperad
withmanyobjects). Bothmonadsandcomonoidscanbedefinedusingmonoids.
Eventhoughmonoidsarefundamentalandintimatelyfamiliartomathematiciansandcomputer
scientists,theyremainunderappreciatedincomputationalandcognitiveneuroscience. Forthis
reason,weonceagaintakeafairlypedagogicalapproachinthissection.
Definition3.4.1. SupposepC,b,Iqisamonoidalcategory. Amonoidobject inC isanobjectm
equipped with a multiplication morphism µ : mbm Ñ m and a unit morphism η : I Ñ m,
satisfyingtheaxiomsof(leftandright)unitality
m
µ “ “ µ
η η
andassociativity
µ µ
“ .
µ µ
IfC issymmetricmonoidalthenwesaythatthemonoidpm,µ,ηqiscommutativeifµcommutes
107
withthesymmetryasin
µ “ µ
.
Sincewearedoingcategorytheory,itisimportanttounderstandmorphismsofmonoids.
Definition3.4.2. Supposepm,µ,ηqandpm1,µ1,η1qaremonoidsinpC,b,Iq. Amonoidmorphism
pm,µ,ηq Ñ pm1,µ1,η1q is a morphism f : m Ñ m1 in C that is compatible with the monoidal
structures,i.e. bysatisfyingtheaxioms
µ1 f
f “ and “ .
f f µ
η η1
MonoidsandtheirmorphismsinC constituteacategoryMonpCq;compositionandidentitiesare
asinC,anditiseasytocheckthatthecompositeoftwomonoidmorphismsisagainamonoid
morphism.
IfC issymmetricmonoidal,thenthereisasubcategoryCMonpCq ãÑ MonpCqofcommutative
monoidsandtheirmorphisms.
InthenamesMonpCqandCMonpCq,weleavethemonoidalstructureimplicit;shoulditbe
necessarytobeexplicit,wewriteMon pCqandCMon pCq.
b b
Letusconsidersomefirstexamplesofmonoidsinmonoidalcategories.
Example 3.4.3. The natural numbers N equipped with addition ` : N ˆ N Ñ N and zero 0
constituteamonoidinSet. (Infact,pN,`,0qisthefreemonoid generatedbyasingleelement.)
` ˘
Example3.4.4. IfAisaset,thenthereisamonoid ListpAq,˝,pq oflistsofelementsofA: the
elementsofthesetListpAqarefinitelistspa,b,...qofelementsofA;themultiplication˝ : ListpAqˆ
ListpAq Ñ ListpAqisgivenbyconcatenationoflistspb ,...q˝pa ,...q “ pa ,...,b ,...q;and
1 1 1 1
theunit1 Ñ ListpAqisgivenbythenemptylistpq. WesawintheproofofProposition2.1.9that
listconcatenationisassociativeandunital.
108
Example 3.4.5. A monoid pm,˝,˚q in Set is a category with a single object, denoted ˚. We
alreadysawanexampleofthis,inExample2.1.7: themonoidpN,`,0q,treatedasacategory. More
generally,amonoidinamonoidalcategorypC,b,IqisaC-enrichedcategorywithasingleobject.
Example 3.4.6. A monoid pC,b,Iq in the monoidal category pCat,ˆ,1q of categories and
functorsisastrictmonoidalcategory: thetensoristhemonoidmultiplication,anditsunitisthe
monoidunit. Infact,thisexplainsthename“monoidalcategory”: a(strict)monoidalcategoryisa
monoidobjectinCat.
Remark 3.4.7. Non-strict monoidal categories are ‘weak’ in the same sense that bicategories
areweak2-categories;afterall,amonoidalcategoryisaone-objectbicategory. Inthisway,we
canalsoweakenthenotionofmonoidobjectinabicategory,sothattheaxiomsofunitalityand
associativityonlyholdupto‘coherentisomorphism’: thatis,uptoisomorphismsthatcoherewith
the weak unitality and associativity of the ambient bicategory. Such weak monoid objects are
calledpseudomonoids 8,andwheninterpretedinthemonoidal2-categorypCat,ˆ,1qtheirformal
definition[77,§3]yieldsexactlythenon-strictmonoidalcategories.
Butnotethattomakesenseingeneralofthenotionofpseudomonoid,wefirstneedtohavea
notionofmonoidalbicategory. Abstractly,suchathingshouldbeaone-objecttricategory,butthis
oftendoesn’thelp: inthosecases,weneedsomethingmoreconcrete. Informally,then,amonoidal
bicategoryisabicategoryequippedwithamonoidalstructurethatiscoherentwiththe2-cells,but
aswehavebeguntoseehere, tospecifyallthiscoherencedataquicklybecomesquiteverbose,
and to prove their satisfaction by any given structure quite arduous, so we will only make use
informallyinthisthesisofthenotionsofmonoidalbicategoryandpseudomonoid—andwhenwe
do,itwillbebyreferencetothefamiliarstructuresonandinCat: itsCartesianmonoidalstructure;
and(non-strict)monoidalcategories.
Finally,wenotethatthegeneralphenomenon,ofwhichweobserveaninstancehere,wherein
algebraic structures (such as monoids) may be defined internally to categories equipped with
higher-dimensionalanaloguesofthatsamestructureisknownasthemicrocosmprinciple[17].
InExample3.1.9,wesawthatcategoriesofendofunctorsarestrictmonoidalcategories.Following
Example 3.4.6, this means that endofunctor categories are equivalently monoid objects. In fact,
since categories are monoids with many objects9, this means we can consider any object of
endomorphismsasanappropriatelytypedmonoidobject.
8Oneoftenusestheprefix‘pseudo-’incategorytheorytodenoteaweakstructure.
9Thispattern—ofextendingstructuresto“manyobjects”—issometimescalledhorizontalcategorification,todistinguish
itfromthe‘vertical’categorificationofaddinganextradimensionofmorphism.
109
Example 3.4.8. If c : C is any object in any category C, then the hom-set Cpc,cq is a monoid
` ˘ ` ˘
Cpc,cq,˝,id inSet. Moregenerally,ifC isenrichedinE,then Cpc,cq,˝,id isamonoidinE.
c c
Ineachcase,wecallthemonoidtheendomorphismmonoid onc.
Inthecasewhentheendomorphismobjectsarecategories,asinthecaseofExample3.1.9,the
monoidalstructuremakesthemintomonoidalcategories,andsowecanconsidermonoidsobjects
definedinternallytothem. Moregenerally,wecandothisinsideanybicategory,andtheresulting
monoidswillplayanimportantrôlesubsequently.
Remark3.4.9. Justasamonoidalcategoryisabicategorywithasingleobject,thehom-category
Bpb,bqforany0-cellbinabicategoryBisamonoidalcategory:theobjectsarethe1-cellsb Ñ b,the
morphismsarethe2-cellsbetweenthem,composedvertically;thetensorishorizontalcomposition
of1-cells,anditsunitistheidentity1-cellid . Wecanthereforedefineamonoidinabicategory B
b
tobeamonoidinBpb,bqforsome0-cellb : B,usingthisinducedmonoidalstructure.
SinceCatismorallya2-category(andafortioriabicategory),andthustoavoidconfusionwith
monoidobjectsinpCat,ˆ,1q(i.e. strictmonoidalcategories),wewillintroduceanewtermfor
monoidsinthebicategoryCat.
Definition3.4.10. Amonad onthecategoryC isamonoidobjectinthestrictmonoidalcategory
pCC,˝,id q.
C
Monadsareoftendefinedinamoreexplicitway,byexpressingthemonoidstructuresandaxioms
directlyanddiagrammatically.
Proposition3.4.11. AmonadonC isequivalentlyatriplepT,µ,ηqof
1. afunctorT : C Ñ C;
2. anaturaltransformationµ : TT ñ T calledthemultiplication;and
3. anaturaltransformationη : id ñ T calledtheunit;
C
suchthat,forallc : C,thefollowingdiagramscommute:
TTTc
Tµc
TTc Tc
ηTc
TTc
Tηc
Tc
and
µTc µc µc
TTc
µc
Tc Tc
110
A monad is like a monoidal structure for composition: instead of taking two objects and
constructingasingleobjectrepresentingtheirconjunction(likethetensorofamonoidalcategory),
amonadtakestwolevelsofnestingandcomposesthemintoasinglelevel;thisisthesourceofthe
connectionbetweenmulticategoryalgebrasandmonadalgebras.
Example3.4.12. RecallthelistmonoidfromExample3.4.4. ThemappingA ÞÑ ListpAqdefines
thefunctorpartofamonadList : Set Ñ Set;givenafunctionf : A Ñ B,Listpfq : ListpAq Ñ
ListpBqisdefinedbyapplyingf toeachelementofthelists: pa ,a ,...q ÞÑ pfpa q,fpa q,...q.
1 2 1 2
Themonadmultiplicationµ : List2 ñ Listisgivenby“removinginnerbrackets”fromlistsoflists:
` ˘
µ pa1,a2,...q,pa1,...q,... “ pa1,a2,...,a1,...,...q;equivalently,formtheperspectiveof
A 1 1 2 1 1 2
Example 3.4.4, this is the concatenation of the ‘inner’ lists into a single list. The monad unit
η : id ñ Listisdefinedbyreturning‘singleton’lists: η : A Ñ ListpAq : a ÞÑ paq.
Set A
Thereisacloseconnectionbetweenmonadsandadjunctions: everyadjunctioninducesamonad.
Proposition 3.4.13. Suppose L % R : D Ñ C is an adjunction, with unit η : id ñ RL and
C
counitϵ : LR ñ id . ThenpRL,Rϵ ,ηqisamonad.
D L
Proof. Toseethattheassociativityaxiomissatisfied,observethatRϵ “ RLϵ “ RLRϵ
LRL RL L
by naturality. Right unitality follows by the triangle identity ϵ ˝Lη “ id , which entails the
L L
requiredequationRϵ ˝RLη “ id ;andleftunitalityfollowsfromrightunitalitybynaturality,
L RL
asη “ RLη.
RL
Itisalsotruethateverymonadarisesfromanadjunction: infact,therearetypicallymultiple
adjunctionsinducingthesamemonad,andwewillexhibitoneextremalcasein§4.1.
Remark 3.4.14. This dual correspondence is itself an example of an adjunction—in the quite
generalbicategoricalsense,followingthedefinitionofmonadasamonoidinabicategory—though
weleavethedemonstrationofthistothereader.
Beforeweshowingeneralityhoweverymonadarisesfromanadjunction,wecanexhibitthe
listmonadasaclassicspecialcase.
Example 3.4.15 (Lists are free monoids). There is a forgetful functor U : MonpSetq Ñ Set,
taking each monoid pM,˝,˚q (or monoid morphism f) and forgetting the monoid structure to
returnjustthesetM (orthemorphismf). ThisfunctorhasaleftadjointF : Set Ñ MonpSetq,
whichtakeseachsetAtothefreemonoid onA;thisfreemonoidFpAqispreciselythemonoid
111
` ˘
ListpAq,˝,pq oflistsinA,equippedwithconcatenationasmultiplicationandtheemptylistas
unit,asdescribedinExample3.4.4. TheinducedmonadpList,µ,ηq,describedinExample3.4.12,is
thenpreciselythemonadinducedbythisadjunction,withList “ UF.
Atthispoint,withanexampleofamonadtohand,wecanstarttoexploretheirconnectionto
algebra.
Definition3.4.16. SupposepT,µ,ηqisamonadonC. AT-algebraisachoiceofobjectA : C and
amorphisma : TA Ñ Asuchthatthefollowingdiagramscommute:
A ηA TA TTA Ta TA
and
a µA a
A TA a A
Onceagain,thisbeingcategorytheory,weareinterestedlessinindividualT-algebrasthanin
theircategory.
Definition 3.4.17. A morphism of T-algebras pA,aq Ñ pB,bq is a morphism f : A Ñ B that
preservestheT-algebrastructures,inthesensethatthefollowingdiagramcommutes:
Tf
TA TB
a b
f
A B
T-algebrasandtheirmorphismsconstituteacategory,denotedAlgpTqandcalledthecategoryof
T-algebrasortheEilenberg-MoorecategoryforT. (Algebramorphismscomposebythecomposition
ofmorphisms;acompositemorphismofT-algebrasisagainamorphismofT-algebrasbypasting.
IdentitiesaretheusualidentitymorphismsinC.)
Wenowdemonstratethe‘algebra’ofmonadalgebrasusingtwofamiliarexamples.
Example 3.4.18. The category of monoids in pSet,ˆ,1q is equivalent to the category of List-
algebras. AList-algebraisapairofasetAandafunctiona : ListpAq Ñ Asatisfyingthealgebra
axioms,whichmeanthatamustmapsingletonliststotheircorrespondingelements,andthata
mustrespecttheorderingofelementsinthelist(sothatitdoesn’tmatterwhetheryouapplyato
thelistsinalistsoflists,ortothecollapsedlistresultingfromthemonadmultiplication). Toobtain
amonoid,wecansimplytakethesetA. Themonoidmultiplicationisgivenbytheactionofaon
112
2-elementlists;andthemonoidunitisgivenbytheactionofaontheemptylist. Sinceasatisfies
themonadalgebralaws,theresultingmultiplicationandunitsatisfythemonoidaxioms:themonad
lawsareacategorificationofthemonoidaxioms,andthealgebralawsensurecompatibilitywith
them.
Dually,givenamonoidpA,m,eq,wecanconstructaListalgebraabyinduction: onemptylists,
returne;onsingletonlists,returntheirelements;on2-elementlists,applym;onlistsoflength
n,applymtothefirsttwoelementstoobtainalistoflengthn´1repeatedlyuntilreachingthe
2-elementcase. Themonoidlawsthenensurethatthemonadaxiomsaresatisfied.
Example3.4.19. RecallfromProposition2.1.8thatonecanobtainfromanycategoryadirected
graphbyforgettingthecompositionalstructureandretainingonlytheobjectsandmorphismsas
nodesandedges. RecallalsofromProposition2.1.9thatonecanobtainfromanydirectedgraphG
acategoryFG,thefreecategoryonG whoseobjectsarethenodesofG andwhosemorphismsare
pathsinG. Thesetwoconstructionsformafree-forgetfuladjunction,F % U : Cat Ñ Graph,
andtheinducedmonadUF : Graph Ñ Graphiscalledthepathmonad: onobjects,ittakesa
graphG andreturnsagraphwiththesamenodesbutwhoseedgesarethepathsinG. Thecategory
AlgpUFqofalgebrasofUF isequivalenttothecategoryCatof(small)categories.
Toseethis,notethataUF-algebraisagraphhomomorphismUFG Ñ G,forsomegraphG:
a mapping of nodes in UFG to nodes in G, and a mapping of edges in UFG to edges in G that
preservesdomainsandcodomains. SinceUFG andG havethesamenodes,thesimplestchoiceis
tomapeachnodetoitself: wewillconsiderthenodesastheobjectsoftheresultingcategory. The
mappingofpathstoedgesinducesacompositionoperationontheedgesofG,whichwehenceforth
thinkofasmorphisms. Thereasoningproceedsinductively,muchliketheList-algebracase: we
takepathsoflength0tobeidentitymorphisms;pathsoflength1aretakentotheirconstituent
morphisms; paths of length 2 are taken to their composites; and one obtains the composites of
longerpathsbyinduction. Associativityandunitalitythenfolloweasilyfromthemonadalgebra
laws.
Remark 3.4.20. Both the preceding examples suggest a connection between monad algebras
and inductive reasoning, and indeed one can formalize inductive reasoning (as inductive types)
intermsofalgebras. Dually,thereisacloseconnectionbetween‘coalgebras’and‘coinduction’,
whichcanbeusedtoformalizethebehavioursofsystemsthatcanbeiterated,suchasdynamical
systems. Asaninformalexample,thecoinductivetypecorrespondingtoLististhetypeof“streams”:
113
possiblyinfinitelistsofthestatesoroutputsoftransitionsystems. InChapter6,weusecoalgebrato
formalizethecompositionalstructureof‘open’(i.e.,interacting)dynamicalsystemsquitegenerally.
IntheAppendix(§A.1),wepursuethemonadalgebrastoryalittlefurther,todemonstratethe
connectionwithmulticategoryalgebra. However,sincethatconnectionisnotstrictlygermaneto
therestofthethesis,andwiththesuggestednotionofcoalgebratowhetourappetite,wenow
turntomonoids’duals,comonoids.
3.4.1. Comonoids
Weintroducedcomonoidsgraphicallyatthebeginningof§3.1.1,asastructuralmanifestationof
copyinganddiscarding,butinthefullestofgenerality,comonoidsaresimplymonoidsinopposite
categories.
Definition3.4.21. Acomonoid inpC,b,IqisamonoidinCop,whenCop isequippedwiththe
oppositemonoidalstructureinducedbypb,Iq. Explicitly,thismeansanobjectc : C equippedwith
acomultiplicationδ : c Ñ cbcandcounit ϵ : c Ñ I,satisfyingcounitality andcoassociativity laws
formallydualtothecorrespondingunitalityandassociativitylawsofmonoids: readthediagrams
ofDefinition3.4.1top-to-bottom,ratherthanbottom-to-top. Likewise,ifC issymmetricmonoidal,
wesaythatacomonoidinC iscocommutativeifitscomultiplicationcommuteswiththesymmetry.
Example3.4.22. Everyobjectinacategorywithfiniteproductsˆandaterminalobject1isa
comonoidwithrespecttothemonoidalstructurepˆ,1q. Thecomultiplicationsδ : X Ñ X ˆX
X
are defined by the pairing pid ,id q (recall Definition 2.3.15) and the counits ϵ : X Ñ 1 are
X X X
(necessarily)theuniquemorphismsintotheterminalobject.
Coassociativityfollowsbecausepid ,pid ,id qq “ α ˝ppid ,id q,id q,whereαisthe
X X X X,X,X X X X
associatoroftheproduct. Counitalityfollowsbythenaturalityofpairing,pid ˆ!q˝pid ,id q “
X X X
pid , !q,andbecauseproj ˝pid , !q “ id bytheuniversalpropertyoftheproduct;notethat
X X X X
proj istheX componentoftherightunitorofthemonoidalstructure,andpid , !qisitsinverse.
X X
Instantiating this example in Set, we see that the comultiplication is given by copying, i.e.,
x ÞÑ px,xq; and the counit is the unique map x ÞÑ ˚ into the singleton set. This justifies our
writingofthecomonoidstructureincopy-discardstyleasp , q.
X X
Ingeneral,whenacomonoidstructureistobeinterpretedasacopy-discardstructure,wewill
thereforewritethestruturemorphismsasp , qanddepictthemaccordinglyinthegraphical
calculus,ratherthanusingtheboxedformsofDefinition3.4.1. However,copy-discardstructures
114
arenottheonlyimportantcomonoidsthatwewillencounter. Inthenextsection,weintroduce
thecategoryofpolynomialfunctorsSet Ñ Set,andsincetheseareendofunctors,theircategory
inheritsamonoidalstructuregivenbyfunctorcomposition. Comonoidsforthismonoidalstructure
inPolygiveusanotherdefinitionforanowmultifariouslyfamiliarconcept: theyareagainsmall
categories,althoughtheirmorphismsarenotfunctorsbutrathercofunctors.
Ofcourse,amorphismofcomonoidsismuchlikeamorphismofmonoids.
Definition 3.4.23. A comonoid morphism f : pc,δ,ϵq Ñ pc1,δ1,ϵ1q in pC,b,Iq is a morphism
f : c Ñ c1 thatiscompatiblewiththecomonoidstructures,inthesenseofsatisfyingaxiomsdual
to those of Definition 3.4.2. There is thus a category ComonpCq of comonoids in C and their
morphisms,aswellasasubcategoryCComonpCq ãÑ ComonpCqofcommutatitvecomonoids.
Inthemorefamiliarcopy-discardsetting,comonoidmorphismsalsoplayanimportantrôle. In
thenextchapter,wewillseeconcretelythat,inthecontextofstochasticmaps,comonoidmorphisms
(withrespecttothetensorproduct)correspondtothedeterministicfunctions. Thisresultisclosely
relatedtothefollowingfact.
Proposition3.4.24. IfeverymorphisminthemonoidalcategorypC,b,Iqisacomonoidmorphism,
then abb satisfies the universal property of the product for every a,b : C, and hence b is the
categoricalproductandI theterminalobjectinC (uptoisomorphism).
Proof. If every morphism is a comonoid morphism, then every object a : C carries a comonoid
structure;assumeachoiceofcomonoidstructurep : a Ñ aba, : a Ñ Iqforeverya : C.
a a
Theuniversalpropertyoftheproductsaysthateverymorphismf : x Ñ abbfactorsas
a a
f
x x a
f “
b b
f
b
wheref : x Ñ aandf : x Ñ bareuniquelydefinedas
a b
a
x x
f :“ f and f :“ f .
a b
b
Sincef isexhypothesiacomonoidmorphism,wehave
a
a
a f a
f
x x x x a
f “ f “ “
b b
f
b f b
b
115
wherethefirstequalityholdsbycounitality,thesecondsincef commuteswith exhypothesi,
x
andthethirdbydefinition. Thisestablishesthatabbsatisfiestheuniversalproperty,andhence
thatbisthecategoricalproduct.
ToseethatI istheterminalobjectuptoisomorphism,supposethat1istheterminalobject. Since
bisthecategoricalproduct,thereisanisomorphisma ÝÑ „ ab1foranya : C,bytheuniversal
property. Inparticular,thereisanisomorphismI ÝÑ „ I b1. ButsinceI isthemonoidalunitforb,
thecomponentoftheleftunitorat1isanisomorphismI b1 ÝÑ „ 1. Hencewehaveacomposite
isomorphismI ÝÑ „ I b1 ÝÑ „ 1,andsoI – 1.
Remark3.4.25. Theprecedingpropositiongivesusanotherwaytolookatcomonoids: wecan
thinkofthemas“productswithouttheuniversalproperty”.Thereasonforthisisthat,sinceproducts
arecharacterizedbytheir(universal)projections,wecanusethecounitstodefineprojectionsfor
the monoidal product of comonoids: that is, if a and b are comonoids in C, then we can define
(non-universal)projectionsa Ð p Ý ro Ý j Ýa abb Ý p Ý r Ý o Ñ j b bby
a Ð ρ Ýa abI Ð id ÝaÝ b ÝÝÝb abb ÝÝÝab ÝÝ id Ñb I bb Ý λ Ñb b
whereρandλdenotetherightandleftunitorsofthemonoidalstructurerespectively. Thefailure
ofuniversalitymeansthatthefamilyofprojectionstproj u inC doesnotconstituteanatural
a a:C
transformation.
Remark3.4.26. Abstractly,wecanusenaturalityasawaytocharacterizedeterministicmorphisms:
thenaturalitylawfor requiresthat
a ÝÑ f b ÝÝÑb bbb “ a ÝÝÑa aba Ý f Ý b ÝÑ f bbb
andthissaysthatfirstdoingf andthecopyingitsoutputisthesameascopyingtheinputand
feedingeachcopyintof. Iff werenon-deterministic,thentherewouldbeacorrelationbetween
thecopiesintheformercasebutnotinthelatter,andsothisequationwouldnothold. Therefore,
wecanthinkofthosemorphismsf forwhichcopyingisnaturalasthedeterministicmorphismsin
C. WewillreturntothisperspectiveinRemark4.1.19.
Finally,thereisalsoanotionofcomonad,dualtomonad:acomonadisquitegenerallyacomonoid
in a bicategory, in the sense of Remark 3.4.9, or, less generally, a comonoid with respect to the
compositionproductinacategoryofendofunctors. Thismeansthatthepolynomialcomonoidswe
discussedabovearebydefinitioncomonads.
116
InRemark3.4.20,weintroducedthenotionof‘coalgebra’,andindeedthereisanotionofcomonad
coalgebra that is dual to the notion of monad algebra; and indeed we will use coalgebras later
to formalize dynamical systems. But although these coalgebras will be morphisms of the form
FX Ñ X,forF anendofunctorandX anobject,theendofunctorF willnotnecessarilyhavea
comonadstructure,andsothecoalgebraswillbemoregeneralthanthealgebrasweconsidered
above: therewillbenocomonadcompatibilityaxiomstosatisfy.
Inmanycases,theendofunctorF willbeapolynomialfunctor,soletusnowintroducethese.
3.5. Polynomial functors
Inordertobeconsideredadaptive,asystemmusthavesomethingtoadaptto. This‘something’is
oftenwhatwecallthesystem’senvironment,andwesaythatthesystemisopentoitsenvironment.
The interface or boundary separating the system from its environment can be thought of as
‘inhabited’ by the system: the system is embodied by its interface of interaction; the interface
isanimatedbythesystem. Inthisway,thesystemcanaffecttheenvironment,bychangingthe
shapeorconfigurationofitsinterface10;throughthecoupling,thesechangesarepropagatedtothe
environment. Inturn,theenvironmentmayimpingeontheinterface: itsownchanges,mediated
bythecoupling,arriveattheinterfaceasimmanentsignals;andthetypeofsignalstowhichthe
systemisalivemaydependonthesystem’sconfiguration(aswhenaneyecanonlyperceiveifits
lidisopen). Thus,informationflowsacrosstheinterface.
Themathematicallanguagecapturingthiskindofinhabitedinteractionisthatofpolynomial
functors,whichweadoptfollowingSpivakandNiu[235]. Wewillseethatthislanguage—orrather,
itscategory—issufficientlyrichlystructuredtoprovidebothasatisfactorysyntaxforthepatterns
ofinteractionofadaptivesystems,generalizingthecircuitdiagramsof§3.3.2,aswellasahomefor
thedynamicalsemanticsthatwewillseek.
Polynomialfunctorsaresonamedbecausetheyareacategorificationofpolynomialfunctions:
ř
functionsbuiltfromsums,products,andexponentials,oftheformy ÞÑ
i:I
b
i
yai . Tocategorify
afunctionofthiskind,wecansimplyinterpretthecoefficientsandexponentsandthevariable
y as standing for sets rather than mere numbers. In this way, we reinterpret the term yai as
the representable copresheaf Setpa ,´q, so that we can substitute in any set X and obtain the
i
exponentialXai (justasintheclassicalcase). Tocategorifythesumsandproducts,wecansimply
usetheuniversalconstructionsavailableinthecopresheafcategorySetSet: thesearestillavailable
10Suchchangescanbeverygeneral:considerforinstancethechangesinvolvedinproducingsound(e.g.,rapidvibration
oftissue)orlight(e.g.,connectingaluminescentcircuit,orthemolecularinteractionsinvolvedtherein).
117
inthesubcategoryPoly,sincePolyisbydefinitionthesubcategoryofthecopresheafcategory
onsumsofrepresentables(andaswehaveseen,productsareequivalentlyiteratedcoproducts).
Remark3.5.1. Limitsandcolimitsin(co)presheafcategoriesarecomputed‘pointwise’. Therefore,
ifF andGaretwocopresheavesC Ñ Set, thentheirsumF `Gisthecopresheafdefinedby
x ÞÑ Fpxq`Gpxqandtheirproductisthecopresheafdefinedbyx ÞÑ FpxqˆGpxq.
WewilladoptthestandardnotationforpolynomialfunctorsofSpivakandNiu[235],sothat
ř
ifpisapolynomial,wewillexpanditas ypris. Whentreatingpasencodingthetypeofa
i:pp1q
system’sinterface,wewillinterpretpp1qasencodingthesetofpossibleconfigurations(or‘shapes’)
thatthesystemmayadopt,andforeachconfigurationi : pp1q,thesetprisisthesetofpossible
immanentsignals(‘inputs’)thatmayarriveontheinterfaceinconfigurationi.
Definition3.5.2. First,ifAbeanyset,wewilldenotebyyA itsrepresentablecopresheafyA :“
SetpA,´q : Set Ñ Set. Apolynomialfunctor p : Set Ñ Setisthenanindexedcoproductof
ř
suchrepresentablecopresheaves,writtenp :“ ypi ,wherepp1qdenotestheindexingsetand
i:pp1q
pristherepresentingsetforeachi. Thecategoryofpolynomialfunctorsisthefullsubcategory
Poly ãÑ SetSet ofthecopresheafcategoryspannedbycoproductsofrepresentables. Amorphism
ofpolynomialsisthusanaturaltransformation.
Remark 3.5.3. Note that, given a polynomial functor p : Set Ñ Set, the indexing set pp1q is
indeedobtainedbyapplyingptotheterminalset1.
We will make much use of the following ‘bundle’ representation of polynomial functors and
theirmorphisms.
ř
Proposition 3.5.4. Every polynomial functor ypi corresponds to a bundle (a function)
i:pp1q
ř ř
p : p Ñ pp1q,wheretheset p isthepp1q-indexedcoproductoftherepresenting
i:pp1q i i:pp1q i
objectsp andpistheprojectionoutofthecoproductontotheindexingsetpp1q.
i
Every morphism of polynomials f : p Ñ q corresponds to a pair pf ,f7q of a function f :
1 1
pp1q Ñ qp1q and a pp1q-indexed family of functions f7 : qrf piqs Ñ pris making the diagram
i 1
ř
belowcommute. Weadoptthenotationpris :“ p ,andwritef7 todenotethecoproduct f7.
i i i
ř ř ř
f7
pris qrf piqs qrjs
i:pp1q i:pp1q 1 j:qp1q
{
p q
pp1q pp1q
f1
qp1q
118
Givenf : p Ñ q andg : q Ñ r,theircompositeg˝f : p Ñ r isasmarkedinthediagram
ř ř ř
pgfq7
pris rrg ˝f piqs rrks
i:pp1q i:pp1q 1 1 k:rp1q
{
p r
pp1q pp1q
g1˝f1
rp1q
wherepgfq7 isthecoproductofthepp1q-indexedfamilyofcompositemaps
f˚g7 f7
rrg pf piqqs ÝÝÝÑ qrf piqs ÝÑ pris .
1 1 1
Theidentitymorphismonapolynomialpispid ,idq.
pp1q
Proof. We just need to show that every natural transformation between polynomial functors
corresponds to a pair of maps pf ,f7q as defined above. The set of natural transforma-
1
ř ř `ř ř ˘
tions ypris ñ yqrjs is the hom-set SetSet ypris, yqrjs . Since the
i:pp1q j:qp1q i:pp1q j:qp1q
contravariant hom functor takes colimits to limits (Remark 2.3.53), this hom-set is isomor-
ś ř
phic to SetSetpypris, yqrjsq. By the Yoneda lemma, this is in turn isomorphic
i:pp1q j:qp1q
ś ř
to prisqrjs. And since products distribute over sums, we can rewrite this as
i:pp1q j:qp1q
ř ś
f1:pp1qÑqp1q i:pp1q
prisqrf1piqs. The elements of this set are precisely pairs of a function f
1
:
pp1q Ñ qp1qalongwithafamilyoffunctionsqrf piqs Ñ prisindexedbyi : pp1q,suchthatthe
1
diagramabovecommutes.
Wenowrecallahandfulofusefulfactsaboutpolynomialsandtheirmorphisms,eachofwhich
isexplainedinSpivakandNiu[235]andsummarizedinSpivak[241].
Wewillconsidertheunitpolynomialy torepresenta‘closed’system,sinceithasnonontrivial
configurationsandnopossibilityofexternalinput. Forthisreason,morphismsp Ñ ywillrepresent
waystomakeanopensystemclosed,andinthiscontextthefollowingfactexplainswhy: such
morphismscorrespondtoachoiceofpossibleinputforeachp-configuration;thatis,theyencode
“howtheenvironmentmightrespondtop”.
ř
Proposition3.5.5. Polynomialmorphismsp Ñ y correspondtosectionspp1q Ñ prisofthe
i
ř
correspondingfunctionp : pris Ñ pp1q.
i
ThefollowingembeddingofSetintoPolywillbeusefulinconstructing‘hierarchical’dynamical
systems.
Proposition3.5.6. ThereisanembeddingofSetintoPolygivenbytakingsetsX tothelinear
polynomialsXy : Polyandfunctionsf : X Ñ Y tomorphismspf,id q : Xy Ñ Yy.
X
119
TherearemanymonoidalstructuresonPoly,buttwowillbeparticularlyimportantforus. The
firstrepresentstheparallelcompositionofsystems.
Proposition3.5.7. Thereisasymmetricmonoidalstructurepb,yqonPolythatwecalltensor,
ř ř
andwhichisgivenonobjectsbypbq :“ yprisˆqrjsandonmorphismsf :“ pf ,f7q :
i:pp1q` j:qp1q
˘
1
p Ñ p1 andg :“ pg ,g7q : q Ñ q1 byf bg :“ f ˆg ,Σpf7,g7q ,whereΣpf7,g7qisthefamily
1 1 1
offunctions
f7ˆg7
Σpf7,g7q :“ p1rf piqsˆq1rg pjqs ÝÝiÝÝÑj prisˆqrjs
i,j 1 1
indexedbypi,jq : pp1qˆqp1q. Thisistosaythatthe‘forwards’componentoff bgistheproduct
oftheforwardscomponentsoff andg,whilethe‘backwards’componentisthepointwiseproduct
oftherespectivebackwardscomponents.
Proposition3.5.8. pPoly,b,yqissymmetricmonoidalclosed,withinternalhomdenotedr´,“s.
ř ř
Explicitly,wehaverp,qs “ y i:pp1q qrf1piqs. GivenansetA,wehaverAy,ys – yA.
f:pÑq
Thesecondimportantmonoidalstructureisthatinheritedfromthecompositionofendofunctors.
Toavoidconfusionwithothercompositionoperators,wewillinthiscontextdenotetheoperation
by◁.
Proposition3.5.9. Thecompositionofpolynomialfunctorsq˝p : E Ñ E Ñ E inducesamonoidal
structureonPoly ,whichwedenote◁,andcall‘composition’or‘substitution’. Itsunitisagainy.
E
Comonoids with respect to ◁ play a particularly important rôle in the theory of polynomial
functors,andwewillmakeaccordinglymuchuseofthem.
Proposition 3.5.10 (Ahman and Uustalu [7, §3.2]). Comonoids in pPoly,◁,yq correspond to
smallcategories. Ifpc,δ,ϵqisacomonoid,thentheshapescp1qaretheobjectsofthecorresponding
ř
category C. For each object x : cp1q, cris is the set Cpx,yq of morphisms out of x. The
y:cp1q
counit morphism ϵ : c Ñ y is, following Proposition 3.5.5, a section of c, and assigns to each
x : cp1qitsidentitymorphismid : x Ñ x. Thecomultiplicationδ : c Ñ c◁cencodesmorphisms’
x
codomains(itsforwardaction)andtheircomposition(itsbackwardaction). Finally,thecomonoid
lawsensurethatthecategoryiswelldefined.
Remark3.5.11. ◁-comonoidhomomorphismsarenot,asonemightexpect,functors;rather,they
are‘cofunctors’: theyactbackwardsonmorphisms. Wewillnotexplorethetheoryofcofunctors
any further in this thesis, although we will make frequent use of them later in the context of
dynamicalsystems.
120
Thefollowing◁-comonoidswillplayaprominentrôleinourdynamicaldevelopments.
Proposition3.5.12. IfTisamonoidinpSet,ˆ,1q,thenthecomonoidstructureony T witnesses
itasthecategoryBT.
Proposition 3.5.13. Monomials of the form SyS can be equipped with a canonical comonoid
structurewitnessingthecodiscretegroupoidonS: thecategorywithanobjectforeveryelements
ofS andamorphisms Ñ tforeverypairofelementsps,tq.
121
4. The compositional structure of Bayesian
inference
This chapter introduces the fundamental concepts and structures needed for the development
ofstatisticalgamesinChapter5,andprovesthecrucialresultthatBayesianupdatingcomposes
accordingtothe‘lens’pattern. Tomakesenseofthisstatement,wefirstintroducecompositional
probability(§4.1),motivatingitasaresolutionofsomeimprecisionthatariseswhenoneworks
informallywithprobabilityandstatistics,particularlyinthecontextof‘hierarchical’models. We
exhibit categorical probability theory both abstractly (§4.1.2 and §4.1.3) and concretely (using
discreteprobabilityin§4.1.1and‘continuous’probabilityin§4.1.4). Wethenmoveontoconstruct
categoriesofbidirectionalprocessesin§4.2,byfirstcategorifyingourearlierdiscussionofdependent
datausingtheGrothendieckconstruction(§4.2.1)andthenusingthistointroducethelenspattern
(§4.2.2).
In§4.3,wepresentournovelresults. First,weintroducetheindexedcategoryof“state-dependent
channels”in§4.3.1. TheseformalizethetypeofBayesianinversions,andsoin§4.3.2wedefinethe
associatednotionofBayesianlens,andshowin§4.3.3thatBayesianupdatingcomposesaccording
tothelenspattern. Weendwithabriefdiscussionofthe‘lawfulness’ofBayesianlenses.
Remark4.0.1. TogainsomeintuitionaboutthehierarchicalcompositionalstructureofBayesian
inference,considersittingclosetothescreenatacinema. Yourneuralactivityencodesabelief
aboutwherethecharactersareonthescreenandwhattheyaredoing,butyourvisualfieldcan
onlycaptureapartoftheimageatanyonetime. Theseincomingvisualsignalscontain“low-level”
information,aboutthelightintensityoverthepatchofscreenyoucansee,andthefirstjobofthe
visualsystemistoinferwhatthismeansforwhat’sgoingoninthispatch. Ofcourse,havingbeen
followingthefilmsofar,yourbrainencodesahigh-levelbeliefaboutwhatisgoingonacrossthe
wholescreen,anditusesthistopredictwhattoexpectinthepatch. Thisintermediate-levelbelief
is then updated using the received visual signals, through a process of (approximate) Bayesian
inference. Theresultingintermediate-levelposteriorthensuppliestheinputforasecondinference
process,updatingthepriorhigh-levelbeliefaccordingly. Noticethatthismeansthattheprocessof
122
predictioninsuchahierarchicalinferencesystempointsfrominsideanagent“towardstheworld”;
andthebelief-updatingprocesspointstheotherway,fromtheworldintotheagent.
4.1. Compositional probability
Ininformalliterature,Bayes’ruleisoftenwritteninthefollowingform:
PpB|Aq¨PpAq
PpA|Bq “
PpBq
wherePpAqistheprobabilityoftheeventA,andPpA|BqistheprobabilityoftheeventAgiven
thattheeventB occurred;andviceversaswappingAandB. Unfortunately,thisnotationobscures
thatthereisingeneralnouniqueassignmentofprobabilitiestoevents: differentobserverscanhold
differentbeliefs. Moreover,weareusuallylessinterestedintheprobabilityofparticularevents
thanintheprocessofassigningprobabilitiestoarbitrarilychosenbeliefs;andwhatshouldbedone
ifPpBq “ 0forsomeB? Theaiminthissectionistoexhibitageneral,precise,andcompositional,
formofBayes’rule;webegin,asbefore,byintroducingtheintuition.
Inthecategoricalsetting,theassignmentofprobabilitiesorbeliefstoeventswillformallybethe
taskofastate (inthesenseof§3.1.1)onthespacefromwhichtheeventsaredrawn;weshould
thinkofstatesasgeneralizingdistributionsormeasures. Withthisnotiontohand,wecanwrite
P pAqtodenotetheprobabilityofAaccordingtothestateπ.
π
The formalization of conditional probability will be achieved by morphisms that we will call
channels,meaningthatwecanwriteP pB|AqtodenotetheprobabilityofB givenAaccordingto
c
thechannelc. WecanthinkofthechannelcastakingeventsAasinputsandemittingstatescpAq
asoutputs. ThismeansthatwecanalternativelywriteP pB|Aq “ P pBq.
c cpAq
IftheinputeventsaredrawnfromthespaceX andtheoutputstatesencodebeliefsaboutY,
thenthechannelcwillbeamorphismXÑ‚ Y. Givenachannelc : XÑ‚ Y andachanneld : YÑ‚ Z,
wewillunderstandtheircomposited‚c : XÑ‚ Z asmarginalizing(averaging)overthepossible
outcomesinY. Wewillseepreciselyhowthisworksinvarioussettingsbelow.
Notation 4.1.1. In a stochastic context, we will denote channels by the arrow Ñ‚ , and write
theircompositionoperatoras‚. Wedothistodistinguishstochasticchannelsfromdeterministic
functions,whichwewillcontinuetowriteasÑwithcomposition˝;inanumberofsituations,it
willbedesirabletoworkwithbothkindsofmorphismandcomposition.
123
GiventwospacesX andY ofevents,wecanformbeliefsaboutthemjointly,representedby
statesontheproductspacedenotedX bY. ThenumeratorinBayes’rulerepresentssuchajoint
state,bythelawofconditionalprobabilityor‘productrule’:
P pA,Bq “ P pB|Aq¨P pAq (4.1)
ω c π
where¨ismultiplicationofprobabilities,π isastateonX,andω denotesthejointstateonX bY.
Bycomposingcandπ toformastatec‚π onY,wecanwrite
P pB,Aq “ P pA|Bq¨P pBq
ω1 c:
π
c‚π
wherec: willdenotetheBayesianinversionofcwithrespecttoπ.
π
Jointstatesinclassicalprobabilitytheoryaresymmetric—andsothetensorbissymmetric—
meaningthatthereisafamilyofisomorphismsswap : X bYÝÑ „ ‚ Y bX,asin§3.1.1,andwhich
willsatisfythesymmetricmonoidalcategoryaxioms(Definition3.1.4). Consequently, wehave
P pA,Bq “ P pB,Aqwhereω1 “ swap‚ω,andthus
ω ω1
P pB|Aq¨P pAq “ P pA|Bq¨P pBq (4.2)
c π c:
π
c‚π
wherebothleft-andright-handsidesarecalleddisintegrationsofthejointstateω [60]. Fromthis
equality, we can write down the usual form of Bayes’ theorem, now with the sources of belief
indicated:
P pB|Aq¨P pAq
P pA|Bq “ c π . (4.3)
c: π P c‚π pBq
AslongasP pBq ‰ 0,thisequalitydefinestheinversechannelc:. Ifthedivisionisundefined,
c‚π π
orifwecannotguaranteeP pBq ‰ 0,thenc: canbeanychannelsatisfying(4.2).
c‚π π
There is therefore generally no unique Bayesian inversion c: : YÑ‚ X for a given channel
c : XÑ‚ Y: rather, we have an inverse c:
π
: YÑ‚ X for each prior state π on X. Moreover, c:
π
is
nota“posteriordistribution”(aswritteninsomeliterature),butaprocesswhichemitsaposterior
distribution,givenanobservationinY. IfwedenoteourcategoryofstochasticchannelsbyC,then,
byallowingπ tovary,weobtainamapoftheformc: : PX Ñ CpY,Xq,wherePX denotesa
p¨q
spaceofstatesonX. NotethatherewearenotassumingtheobjectPX tobeanobjectofC itself
(thoughitoftenwillbe),butratheranobjectinitsbaseofenrichment,sothatherewecanthinkof
c: asakindofexternallyparameterizedchannel(inthesenseof§3.2.2). Makingthetypeofthis
p¨q
‘state-dependent’channelc: preciseisthetaskof§4.2.1.
p¨q
124
Remark4.1.2. Therearetwoeasilyconfusedpiecesofterminologyhere. Wewillcallthechannel
c: theBayesianinversionofthechannelcwithrespecttoπ. Then, givensomey P Y, thestate
π
c: pyqisanew‘posterior’distributiononX.Wewillcallc: pyqtheBayesianupdate ofπ alongc
π π
giveny.
Intheremainderofthissection,weinstantiatetheideasaboveincategoriesofstochasticchannels
ofvariouslevelsofgenerality,beginningwiththefamiliarcaseofdiscrete(i.e.,finitelysupported,
or‘categorical’)probability.
4.1.1. Discreteprobability,algebraically
InterpretingtheinformalBayes’rule(4.3)issimplestinthecaseofdiscreteorfinitely-supported
probability. Here,everyeventisaset,generatedasthedisjointunionofsomanyatomic(singleton)
events, whichonecanthereforetakeastheelementsoftheset. Afinitely-suportedprobability
distributionisthensimplyanassignmentofnonzeroprobabilitiestofinitelymanyelements,such
that the sum of all the assignments is 1. This condition is a convexity condition, and so in this
subsectionwewillintroducediscretecompositionalprobabilitytheoryfromageometricperspective,
usingthealgebraictoolsofthepreviouschapter.
Definition 4.1.3. Suppose X is a set. A function c : X Ñ r0,1s such that cpxq ą 0 for only
ř
finitelymanyx : X and cpxq “ 1willbecalledadiscreteorfinitely-supported distributionon
x:X
X. WewriteDX todenotethesetofdiscretedistributionsonX. A(real-valued)convexset isaset
X equippedwithafunctionς : DX Ñ X calleditsevaluation.
ConvexsetsX aresetsinwhichwecanformconvexcombinationsofelements. Algebraically,
wecanmodeltheseconvexcombinationsasdistributionsonX,andtheevaluationsrealizethe
convexcombinations(distributions)aselementsagainofX: geometrically,theevaluationreturns
thebarycentreofthedistribution.
In light of Chapter 3, this situation may seem familiar. Indeed, the assignment X ÞÑ DX is
thefunctorpartofamonadonSet, whosealgebrasareconvexsets. Thismonadarisesfroma
free-forgetful adjunction between the category of convex sets (the category of algebras of the
monad)andthecategorySet. Later,wewillfindthatthecategoryoffinitely-supportedconditional
probabilitydistributions—thecategoryofdiscretestochasticchannels—isequivalenttothecategory
offreeconvexsetsandtheirmorphisms: afreeconvexsetonX isequivalentlyadistributiononX.
LetusfirstformalizethefunctorD.
125
Proposition4.1.4. ThemappingofsetsX ÞÑ DX isfunctorial. Givenafunctionf : X Ñ Y,we
obtainafunctionDf : DX Ñ DY mappingc : DX tothedistributionDfpcq : DY,
Dfpcq : Y Ñ r0,1s
ÿ
y ÞÑ cpxq .
x:fpxq“y
Proof. Givenf : X Ñ Y andg : Y Ñ Z,wehave
DgpDfpcqq : Z Ñ r0,1s
ÿ ÿ
z ÞÑ cpxq
y:gpÿ yq“zx:fpxq“y
“ cpxq
x:g˝fpxq“z
henceDg˝Df “ Dpg˝fq. Wealsohave
Dpid qpcq : X Ñ r0,1s
X
ÿ
x ÞÑ cpx1q
x1:idXpx1q“x
“ cpxq
andhenceDpidq “ id .
D
ToobtainthemonadstructureofD,wewillexhibitthefree-forgetfuladjunction. Westartby
definingthecategoryofconvexsets,andthespecificcaseofafreeconvexset.
Definition4.1.5. Thecategoryof(real-valued)convexsetsConvhasconvexsetspX,ς qasobjects.
X
ItsmorphismspX,ς q Ñ pY,ς qarefunctionsf : X Ñ Y thatpreservetheconvexstructure,in
X Y
thesensethatthefollowingsquarecommutes:
Df
DX DY
ςX ςY
f
X Y
Definition4.1.6. IfX isanyset,thenthefreeconvexset onX isthesetDX equippedwiththe
evaluationµ : DDX Ñ DX whichmapsα : DDX tothedistributionµ pαq : DX,
X X
µ pαq : X Ñ r0,1s
X
ÿ
x ÞÑ αpcq¨cpxq .
c:DX
126
Notation 4.1.7. To emphasize the algebraic nature of finitely-supported distributions π : DX,
insteadofwritingthemasfunctionsx ÞÑ πpxq,wecanwritethemasformalsumsorformalconvex
ř
combinations πpxq|xy,witheachelementx : X correspondingtoaformal“basisvector”|xy
x:X
withthecoefficientπpxq. IfX isaconvexset,thentheevaluationrealizesthisformalsumasan
actualelement(‘vector’)inX.
Wearenowinapositiontoexhibittheadjunction:thereasoningbehindthefollowingproposition
followsthelinesofExample3.4.19andProposition2.2.25(onthefree-forgetfuladjunctionbetween
graphsandcategories).
Proposition4.1.8. ThemappingofX : SettothefreeconvexsetpDX,µ qdefinesafunctor
X
F : Set Ñ Convwhichtakesfunctionsf : X Ñ Y tomorphismsFf : pDX,µ q Ñ pDY,µ q
X Y
definedbyDf : DX Ñ DY. ThisfunctorF isleftadjointtotheforgetfulfunctorU : Conv Ñ
SetwhichactsbypX,ς q ÞÑ X.
X
UsingProposition3.4.13,theadjunctiongivesusamonad.
Corollary 4.1.9. The functor D : Set Ñ Set is equivalently the functor part of the monad
inducedbythefree-forgetfuladjunctiononconvexsets. Itthereforeacquiresamonadstructure
pµ,ηqwherethecomponentsofthemultiplicationµarethefreeevaluationsµ : DDX Ñ DX,
X
andtheunitη hascomponentsη : X Ñ DX whichreturnthe‘Dirac’distributions,asin
X
η pxq : X Ñ r0,1s
X #
1 iffx “ x1
x1 ÞÑ
0 otherwise.
AndConvisthecategoryofalgebrasforthismonad.
Corollary4.1.10. Conv – AlgpDq.
Using Corollary 4.1.10, we can actually exhibit the relationship between the monad D and
itsdefiningadjunctiontautologously: everymonadT onacategoryC inducesanfree-forgetful
adjunctionbetweenitscategoryofalgebrasAlgpTqandC itself,suchthatthemonadgenerated
bythisadjunctionisagainT. Thisispreciselythesituationhere.
Proposition4.1.11. SupposepT,µ,ηqisamonadonthecategoryC. Thereisaforgetfulfunctor
U : AlgpTq Ñ C whichhasaleftadjointF : C Ñ AlgpTqtakingeachobjectX : C tothefree
T-algebrapTX,µ qonX,whereµ : TTX Ñ TXisthecomponentofthemonadmultiplication
X X
µatX. Theunitoftheadjunctionisthemonadicunitη,thecounitϵisdefinedbyϵ :“ ς ,
pX,ςXq X
andthemonadinducedbytheadjunctionispT,µ,ηq.
127
Proofsketch. TheproofthatF isleftadjointtoU isstandard(seeBorceux[39,Prop. 4.1.4]),and
thattheadjunctiongeneratesthemonadfollowsalmostimmediatelyfromProposition3.4.13.
Remark4.1.12. Itmustbeemphasizedthat,althougheverymonadarisesfromsuchafree-forgetful
adjunction,noteveryadjunctiondoes!(Considerforexampletheadjunction∆ % limofProposition
2.3.48: ∆doesnotassigntoeachc : C the“freeJ-shapeddiagramonc”,andlimdoesnotsimply
forgetdiagrammaticstructure.) Thoseadjunctionswhichdoarisefrommonadsinthiswayare
calledmonadic.
Thereisaspecialnameforsubcategoriesoffreealgebras.
Definition4.1.13. SupposepT,µ,ηqisamonadonC. ThesubcategoryofAlgpTqonthefree
T-algebraspTX,µ qiscalledtheKleislicategory forT,anddenotedKℓpTq.
X
ThefollowingpropositiongivesusanalternativepresentationofKℓpTqwhich,whenappliedto
themonadD,willyieldacomputationallymeaningfulcategoryoffinitely-supportedstochastic
channels.
Proposition4.1.14. TheobjectsofKℓpTqaretheobjectsofC. ThemorphismsXÑ‚ Y ofKℓpTq
arethemorphismsX Ñ TY ofC. Identitymorphismsid
X
: XÑ‚ X aregivenbythemonadicunit
η
X
: X Ñ TX. CompositionisdefinedbyKleisliextension: giveng : YÑ‚ Z,weformitsKleisli
extensiong ▷ : TYÑ‚ Z asthecompositeTY Ý T ÝÑ g TTZ Ý µ ÝÑZ TZ inC. Then,givenf : XÑ‚ Y,we
formthecompositeg‚f : XÑ‚ Z asg ▷ ˝f: X ÝÑ f TY Ý T ÝÑ g TTZ Ý µ ÝÑZ TZ.
Proof. ObservethatthereisabijectionbetweentheobjectsXofCandthefreeT-algebraspTX,µ q.
X
` ˘
Wethereforeonlyneedtoestablishabijectionbetweenthehom-setsAlgpTq pTX,µ q,pTY,µ q
X Y
andKℓpTqpX,Yq,withthelatterdefinedasinthestatementoftheproposition.
First,wedemonstratethatKleisliextensiondefinesasurjection
` ˘
KℓpTqpX,Yq Ñ AlgpTq pTX,µ q,pTY,µ q .
X Y
SupposeϕisanyalgebramorphismpTX,µ q Ñ pTY,µ q;weshowthatitisequaltotheKleisli
X Y
extensionoftheKleislimorphismX Ý η ÝXÑ TX ÝÑ ϕ TY:
TX Ý p Ý ϕ˝ Ý η ÝXÝ q Ñ ▷ TY “ TX Ý T Ý η ÝXÑ TTX Ý T ÝÑ ϕ TTY Ý µ ÝTÝÑY TY
“ TX Ý T Ý η ÝXÑ TTX Ý µ ÝTÝXÑ TX ÝÑ ϕ TY
“ TX ùù id ùTùXù TX ÝÑ ϕ TY
ϕ
“ TX ÝÑ TY
128
wherethefirstequalityholdsbydefinition, thesecondlinebynaturalityofµ, andthethirdby
theunitalityofthemonadpT,µ,ηq. HenceeveryfreealgebramorphismisintheimageofKleisli
extension,andsoKleisliextensiondefinesasurjection.
Next,weshowthatthissurjectionisadditionallyinjective.Supposef,garetwoKleislimorphisms
X Ñ TY suchthattheirKleisliextensionsareequal
TX Ý T ÝÑ f TTY Ý µ ÝTÝÑY TY “ TX Ý T ÝÑ g TTY Ý µ ÝTÝÑY TY
andrecallthattheidentityinKℓpTqisη. Wethereforehavethefollowingequalities:
X Ý η ÝXÑ TX Ý T ÝÑ f TTY Ý µ ÝTÝÑY TY “ X Ý η ÝXÑ TX Ý T ÝÑ g TTY Ý µ ÝTÝÑY TY
“ X ÝÑ f TY Ý T Ý η Ñy TTY Ý µ ÝTÝÑY TY “ X ÑÝ g TY Ý T Ý η Ñy TTY Ý µ ÝTÝÑY TY
f g
“ X ÝÑ Y “ X ÑÝ Y .
where the equality in the first line holds ex hypothesi, the second by naturality, and the
third by monadic unitality. Since f “ g when their Kleisli extensions are equal, Kleisli
extensionisinjective. Sinceitisalsosurjective,wehaveanisomorphismbetweenKℓpTqpX,Yq
` ˘
and AlgpTq pTX,µ q,pTY,µ q . Hence KℓpTq is the subcategory of AlgpTq on the free
X Y
algebras.
IfT isamonadonC,thereisacanonicalembeddingofC intoKℓpTq. InthecaseofKℓpDq,this
willyieldthesubcategoryofdeterministic channels: thosewhichdonotaddanyuncertainty.
Proposition4.1.15. SupposeT isamonadonC. Thenthereisanidentity-on-objectsembedding
C ãÑ KℓpTq given on morphisms by mapping f : X Ñ Y in C to the Kleisli morphism X Ý η ÝXÑ
TX Ý T ÝÑ f TY.
Proofsketch. Functoriality follows from the unitality of η in the monad structure, since Kleisli
compositioninvolvespost-composingthemonadmultiplication,andµ ˝Tη “ id.
T
4.1.1.1. Stochasticmatrices
Atthispoint,letusexhibitKℓpDqalittlemoreconcretely,byinstantiatingProposition4.1.14. Since
adistributionπonthesetX isafunctionX Ñ r0,1s,andfollowingthe“formalsum”intuition,we
canalternativelythinkofπ asavector,whosecoefficientsareindexedbyelementsofX (thebasis
vectors|xy). MorphismsXÑ‚ Y inKℓpDqarefunctionsX Ñ DY,andsowecansimilarlythinkof
theseasstochasticmatrices,bytheCartesianclosureofSet: afunctionX Ñ DY isequivalently
129
afunctionX Ñ r0,1sY,whichinturncorrespondstoafunctionX ˆY Ñ r0,1s,whichwecan
readasa(left)stochasticmatrix,withonlyfinitelymanynonzerocoefficientsandeachofwhose
columns must sum to 1. We will adopt ‘conditional probability’ notation for the coefficients of
thesematrices: givenp : XÑ‚ Y,x P X andy P Y,wewriteppy|xq :“ ppxqpyq P r0,1sfor“the
probabiltyofy givenx,accordingtop”.
CompositioninKℓpDqisthenmatrixmultiplication: givenp : X Ñ DY andq : Y Ñ DZ,we
computetheircompositeq ‚p : X Ñ DZ by‘averagingover’or‘marginalizingout’Y viathe
Chapman-Kolmogorovequation:
ÿ ÿ
q‚p : X Ñ DZ :“ x ÞÑ qpz|yq¨ppy|xq |zy.
z:Z y:Y
Herewehaveagainusedtheformalsumnotation,drawingaboxtoindicatethecoefficients(i.e.,
theprobabilitiesreturnedbytheconditionaldistributionq‚ppxqforeachatomiceventz inZ).
Via the monadic unit, identity morphisms id
X
: XÑ‚ X in KℓpDq take points to ‘Dirac delta’
distributions: id :“ x ÞÑ 1|xy. TheembeddingSet ãÑ KℓpDqmakesanyfunctionf : Y Ñ X
X
intoa(deterministic)channelf “ η ˝f : Y Ñ DX bypost-composingwithη .
X X
4.1.1.2. Monoidalstructure
WewillwanttoequipKℓpDqwithacopy-discardcategorystructure,inordertorepresentjoint
states(jointdistributions)andtheirmarginalization,aswellasthecopyingofinformation. Thefirst
ingredientmakingacopy-discardcategory,afterthecategoryitself,isamonoidalstructure. Once
again,inthecaseofKℓpDq,thiscanbeobtainedabstractlyfromamorefundamentalstructure—the
categoricalproductpˆ,1qonSet—asaconsequenceofDbeinga‘monoidal’monad. Wewillwrite
theinducedtensorproductonKℓpDqasb;itsmonoidalunitremainstheobject1.
Definition 4.1.16. A monoidal monad is a monad in MonCat. This means that it is a monad
pT,µ,ηqinCatwhosefunctorT : C Ñ C isadditionallyequippedwithalaxmonoidalstructure
pα,ϵq such that the monad multiplication µ and unit η are monoidal natural transformations
accordingly.
Withthisextrastructure,itisnothardtoverifythatthefollowingpropositionmakesKℓpTq
intoawell-definedmonoidalcategory.
Proposition4.1.17. TheKleislicategoryKℓpTqofamonoidalmonadpT,α,ϵ,µ,ηqisamonoidal
category. Themonoidalproductisgivenonobjectsbythemonoidalproductbofthebasecategory
130
C. OnKleislimorphismsf : XÑ‚ Y andf1 : X1Ñ‚ Y1,theirtensorf bg isgivenbythefollowing
compositeinC:
X bX1 Ý f Ý b Ý f Ñ 1 TX bTX1 Ý α ÝXÝ,ÝXÑ 1 TpX bX1q
ThemonoidalunitisthemonoidalunitI inC. Theassociatorandunitorofthemonoidalcategory
structure are inherited from C under the embedding C ãÑ KℓpTq. When pC,b,Iq is symmetric
monoidal,thensoispKℓpTq,b,Iq.
InthespecificcaseofKℓpDq,thetensorproductbisgivenonobjectsbytheproductofsetsand
onstochasticchannelsf : X Ñ DAandg : Y Ñ DB as
X ˆY Ý f Ý ˆ Ñ g DAˆDB Ý α ÝAÝ,ÑB DpAˆBq.
Notethatbecausenotalljointstateshaveindependentmarginals,themonoidalproductbisnot
Cartesian: thatis, givenanarbitraryω : DpX bYq, wedonotnecessarilyhaveω “ pρ,σqfor
someρ : DX andσ : DY. Thelaxatortakesapairofdistributionspρ,σqinDXˆDY tothejoint
distributiononXˆY givenbypx,yq ÞÑ ρpxq¨σpyq;ρandσarethenthe(independent)marginals
ofthisjointdistribution. (Ofcourse,thejointdistributionpρ,σqisnottheonlyjointdistribution
withthosemarginals: otherjointstatesmayhavethesemarginalsbutalsocorrelationsbetween
them,andthisiswhatitmeansfornotalljointstatestohaveindependentmarginals.)
Since pSet,ˆ,1q is symmetric monoidal, KℓpDq is too, with swap isomorphisms swap :
X,Y
X bYÝÑ „ ‚ Y bX similarlyinheritedformthoseofˆ.
4.1.1.3. Copy-discardstructure
The copy-discard structure in KℓpDq is inherited from Set through its embedding: since every
objectinKℓpDqisanobjectinSet,andeveryobjectinSetisacomonoid(Example3.4.22),and
sincefunctorspreserveequalities,thesecomonoidstructuresarepreservedundertheembedding.
More explicitly, the discarding channels are given by x ÞÑ 1|˚y, and the copiers by
X X
x ÞÑ 1|x,xy. NotethatthecopiersarenotnaturalinKℓpDq: ingeneral, ‚f ‰ f bf ‚ ,asa
resultofthepossibilityofcorrelations.
Since the projections proj : X ˆ Y Ñ X in Set satisfy proj “ ρ ˝ pid ˆ q where
X X X X Y
ρ : X ˆ1 Ñ X is component of the right unitor, we can see how discarding and projection
X
giveusmarginalization,therebyexplainingthestringdiagramsof§3.1.1. Givensomejointstate
ω : 1Ñ‚ X bY,itsX-marginalω
X
: 1Ñ‚ X isgivenbyproj
X
‚ω,whichinKℓpDqisgivenbythe
ř ř
formalsumformula ωpx,yq |xy,wherewehaveagaindrawnaboxtodistinguishthe
x:X y:Y
131
probabilityassignedto|xy,whichwenotecoincideswiththeclassicalruleformarginaldiscrete
probability. (TheY-marginalisofcoursesymmetric.)
Remark4.1.18. Asemicartesiancategoryisamonoidalcategoryinwhichthemonoidalunitis
terminal. Inasemicartesianmonoidalcategory,everytensorproductX bY isequippedwitha
naturalfamilyofprojectionsproj : X bY Ñ X andproj : X bY Ñ Y givenby‘discarding’
X Y
oneofthefactorsandusingtheunitor;theexistenceofsuchprojectionsisnototherwiseimplied
byamonoidalstructure(thoughofcourseitdoesfollowwhenthetensoristheproduct).
Arelatednotionisthatofanaffinefunctor,whichisonethatpreservestheterminalobject,and
ofwhichD isanexample. Asaresult,andfollowingthediscussionabove,wecanseethatKℓpDq
isanexampleofasemicartesiancategory.
Semicartesiancopy-discardcategoriesarealsoknownasMarkovcategories,followingFritz[109].
Remark 4.1.19. Since 1 is therefore terminal in KℓpDq, Proposition 3.4.24 tells us that those
channelsf thatdocommutewithcopying(i.e.,forwhich isnatural;Remark3.4.26),andwhichare
thereforecomonoidmorphisms,arepreciselythedeterministic channels: thoseintheimageofthe
embeddingofSet(andwhichthereforeemitDiracdeltadistributions). Asaresult,wecanthinkof
ComonpKℓpDqqasthesubcategoryofdeterministicchannels,andwriteComonpKℓpDqq – Set.
(Intuitively,thisfollowsalmostbydefinition:adeterministicprocessisonethathasnoinformational
side-effects;thatistosay,whetherwecopyastatebeforeperformingtheprocessoneachcopy,or
performtheprocessandthencopytheresultingstate,orwhetherweperformtheprocessandthen
marginalize,orjustmarginalize,makesnodifferencetotheresultingstate.)
4.1.1.4. Bayesianinversion
WecannowinstantiateBayesianinversioninKℓpDq,formalizingEquation(4.3). Givenachannel
p : X Ñ DY satisfyingtheconditioninRemark4.1.20below,itsBayesianinversionisgivenby
thefunction
ÿ ÿ
ppy|xq¨πpxq ppy|xq¨πpxq
p: : DX ˆY Ñ DX :“ pπ,yq ÞÑ ř |xy “ |xy
ppy|x1q¨πpx1q pp‚πqpyq
x:X x1:X x:X
(4.4)
sothattheBayesianupdateofpalongπ istheconditionaldistributiondefinedby
ppy|xq¨πpxq
p:px|yq “ .
π pp‚πqpyq
NotethatherewehaveusedtheCartesianclosureofSet,writingthetypeofp:asDXˆY Ñ DX
ratherthanDX Ñ KℓpDqpY,Xq,whereKℓpDqpY,Xq “ pDXqY.
132
Remark4.1.20. Intheformgivenabove,p: isonlywell-definedwhenthesupportofp‚π isthe
whole of Y, so that, for all y, pp‚πqpyq ą 0; otherwise, the division is ill-defined. Henceforth,
in the context of Bayesian inversion, we will therefore assume that p‚π has full support (see
Definition4.1.21).
Toavoidthis(ratherugly)condition,onecanreplaceitbytheassumptionthatthenotionof
‘support’iswell-defined,andmodifythetypeofp: accordingly: thisistherefinementmadeby
BraithwaiteandHedges[41],andwereitnotforthepresently-uncertainnatureofsupportobjects
in general, it would now be this author’s preferred approach. This leads to writing the type of
ř
theinversionp: as supppp‚πq Ñ DX,wheresupppp‚πqisthesubobjectofY onwhich
π:DX
p‚π issupported: withthistype,p: isalwaysawell-definedchannel. Onecanthenproceedwith
π
thedefinitionof‘dependent’Bayesianlensesaccordingly;forthedetails,wereferthereaderto
BraithwaiteandHedges[41]. Inthisthesis, forsimplicityofexpositionandfaithfulnesstothis
author’searlierwork,wewillproceedunderthefull-supportassumption.
4.1.2. AbstractBayesianinversion
BeyondtheconcernsofRemark4.1.20,inamoregeneralsettingitisnotalwayspossibletodefine
BayesianinversionusinganequationlikeEquation(4.4)orEquation(4.3): theexpressionppy|xq
mightnotbewell-defined,ortheremightnotbeawell-definednotionofdivision. Insteadbeing
guided by Equation (4.3) in defining Bayesian inversion, we can use Equation (4.2). Therefore,
supposingachannelc : XÑ‚ Y andastateπ : IÑ‚ X inanambientcopy-discardcategoryC,we
canaskfortheBayesianinversionc: tobeanychannelsatisfyingthegraphicalequality[60,eq. 5]:
π
X Y X Y
c c:
π
“ (4.5)
c
π π
Thisdiagramcanbeinterpretedasfollows. Givenapriorπ : IÑ‚ X andachannelc : XÑ‚ Y,we
formthejointdistributionω :“ pid
X
bcq‚
X
‚π : IÑ‚ X bY shownonthelefthandside: this
formalizestheproductrule,P pA,Bq “ P pB|Aq¨P pAq,andπisthecorrespondingX-marginal.
ω c π
133
AsintheconcretecaseofKℓpDq,weseekaninversechannelYÑ‚ X witnessingthe‘dual’formof
therule,P pA,Bq “ PpA|Bq¨PpBq;thisisdepictedontherighthandside. BydiscardingX,we
ω
seethatc‚π : IÑ‚ Y istheY-marginalwitnessingPpBq. Soanychannelc:
π
: YÑ‚ X witnessing
PpA|BqandsatisfyingtheequalityaboveisaBayesianinverseofcwithrespecttoπ.
InlightofRemark4.1.20,wethereforemakethefollowingdefinition.
Definition 4.1.21. We say that a channel c : XÑ‚ Y admits Bayesian inversion with respect to
π : IÑ‚ X if there exists a channel c:
π
: YÑ‚ X satisfying equation (4.5). We say that c admits
Bayesianinversiontoutcourt ifcadmitsBayesianinversionwithrespecttoallstatesπ : IÑ‚ X.
Remark4.1.22. Weneedtobecarefulabouttheexistenceofinversionsasaconsequenceofthe
factthatc‚π maynotalwaysbefullysupportedonY (recallRemark4.1.20). Inthisthesiswewill
henceforthassumethatc‚π isalwaysfullysupported,inordertokeeptheexpositionclear. This
isjustifiedintwoways: first,becausewecanalwaysrestricttoawidesubcategoryallofwhose
channelsdoadmitinversion;andsecond,becausewemayequallyworkwithdependentBayesian
lenses(asdescribedbyBraithwaiteandHedges[41]andnotedinRemark4.1.20).
4.1.3. Densityfunctions
Abstract Bayesian inversion (4.5) generalizes the product rule form of Bayes’ theorem (4.2) but
in most applications, we are interested in a specific channel witnessing PpA|Bq “ PpB|Aq ¨
PpAq{PpBq. Inthetypicalmeasure-theoreticsetting,thisisoftenwritteninformallyas
ppy|xq¨ppxq ppy|xq¨ppxq
ppx|yq “ “ ş (4.6)
ppyq ppy|x1q¨ppx1qdx1
x1:X
but the formal semantics of such an expression are not trivial: for instance, what is the object
ppy|xq,andhowdoesitrelatetoachannelc : XÑ‚ Y?
Following Cho and Jacobs [60], we can interpret ppy|xq as a density function for a channel,
abstractlywitnessedbyaneffectX bYÑ‚ I inourambientcategoryC. Consequently,C cannotbe
semicartesian—asthiswouldtrivializealldensityfunctions—thoughitmuststillsupplycomonoids.
Wecanthinkofthisasexpandingthecollectionofchannelsinthecategorytoincludeacausalor
‘partial’mapsandunnormalizeddistributionsorstates.
Example4.1.23. AnexampleofsuchacategoryisKℓpD q,whoseobjectsaresetsandwhose
ď1
morphismsXÑ‚ Y arefunctionsX Ñ DpY `1q. Thenastochasticmapispartialifitsendsany
probability to the added element ˚, and the subcategory of total (equivalently, causal) maps is
KℓpDq(see[61]formoredetails).
134
AmorphismXÑ‚ 1inKℓpD
ď1
qisthereforeafunctionX Ñ Dp1`1q. Now,adistributionπ on
1`1isthesameasanumberπ¯ inr0,1s: notethat1`1hastwopoints,andsoπ assignsπ¯ toone
ofthemand1´π¯ totheother. ThereforeaneffectXÑ‚ 1isequivalentlyafunctionX Ñ r0,1s,
whichispreciselythetypeweexpectforadensityfunction.
Wethereforeadoptthefollowingabstractdefinition.
Definition4.1.24(Densityfunctions[60,Def. 8.1]). Achannelc : XÑ‚ Y issaidtoberepresented
byaneffect p : X bYÑ‚ I withrespecttoµ : IÑ‚ Y if
Y
Y
p
c “ .
µ
X X
Inthiscase,wecallpadensityfunctionforc.
Wewillalsoneedtheconceptsofalmost-equalityandalmost-invertibility.
Definition4.1.25(Almost-equality,almost-invertibility[60,Def. 8.2]). Givenastateπ : IÑ‚ X,
wesaythattwochannelsc : XÑ‚ Y andd : XÑ‚ Y areπ-almost-equal,denotedc „ π d,if
X Y X Y
c d
“
π π
andwesaythataneffectp : XÑ‚ I isπ-almost-invertiblewithπ-almost-inverseq : XÑ‚ I if
p q
π .
„
X X
135
Thefollowingbasicresultsaboutalmost-equalitywillprovehelpful.
Proposition4.1.26(Compositionpreservesalmost-equality). Ifc „ π d,thenf ‚c „ π f ‚d.
Proof. Immediatefromthedefinitionofalmost-equality.
Proposition4.1.27(Almost-inversesarealmost-equal). Supposeq : XÑ‚ I andr : XÑ‚ I areboth
π-almost-inversesfortheeffectp : XÑ‚ I. Thenq „ π r.
Proof. Byassumption,wehave
p q p r
π π .
„ „
Then,bythedefinitionofalmost-equality(Definition4.1.25):
p q p r
. (4.7)
“ “ “
π π π π
Weseektoshowthat
q r
. (4.8)
“
π π
136
Substitutingtheright-hand-sideof (4.7)forπ intheleft-hand-sideof (4.8),wehavethat
p r q
q
“
π π
p q r
r
“ “
π π
whichestablishestheresult. Thesecondequalityfollowsbythecoassociativityof andthethird
byitscounitality.
Withthesenotions,wecancharacteriseBayesianinversionviadensityfunctions. Theresultis
duetoChoandJacobs[60],butweincludethegraphicalproofforexpositorycompleteness,asan
exampleofstring-diagrammaticreasoning.
Proposition4.1.28(Bayesianinversionviadensityfunctions[60,Thm. 8.3]). Supposec : XÑ‚ Y
isrepresentedbytheeffectpwithrespecttoµ. TheBayesianinversec:
π
: YÑ‚ X ofcwithrespect
toπ : IÑ‚ X isgivenby
X
p p´1
π
Y
137
wherep´1 : YÑ‚ I isaµ-almost-inversefortheeffect
p
π
Y
Proof. Weseektoestablishtherelation(4.5)characterizingBayesianinversion. Bysubstitutingthe
densityfunctionrepresentationsforcandc: intotheright-hand-sideof (4.5),wehave
π
p p´1
c:
π
π
“
p
c
µ
π
π
p p´1 p
π
“
π
µ
138
c
p
“ “
π
µ π
as required. The second equality holds by the coassociativity of , the third since p´1 is an
almost-inverseexhypothesi,andthefourthbythecounitalityofp , qandthedensityfunction
representationofc.
Thefollowingpropositionisanimmediateconsequenceofthedefinitionofalmost-equalityand
oftheabstractcharacterisationofBayesianinversion(4.5). Weomittheproof.
Proposition4.1.29(Bayesianinversesarealmost-equal). Supposeα : YÑ‚ X andβ : YÑ‚ X are
bothBayesianinversionsofthechannelc : XÑ‚ Y withrespecttoπ : IÑ‚ X. Thenα c „ ‚π β.
4.1.4. S-finitekernels
To represent channels by concrete density functions, we can work in the category sfKrn of
measurablespacesands-finitekernels. Wewillonlysketchthestructureofthiscategory,andrefer
thereadertoChoandJacobs[60]andStaton[258]forelaboration.
Objects in sfKrn are measurable spaces pX,Σ q; often we will just write X, and leave the
X
σ-algebraΣ
X
implicit. MorphismspX,Σ
X
qÑ‚ pY,Σ
Y
qares-finitekernels. Akernel k fromX to
Y isafunctionk : X ˆΣ Ñ r0,8ssatisfyingthefollowingconditions:
Y
• forallx P X,kpx,´q : Σ Ñ r0,8sisameasure;and
Y
• forallB P Σ ,kp´,Bq : X Ñ r0,8sismeasurable.
Y
A kernel k : X ˆΣ Ñ r0,8s is finite if there exists some r P r0,8q such that, for all x P X,
Y
kpx,Yq ď r. And k is s-finite if it is the sum of at most countably many finite kernels k ,
n
ř
k “ k .
n:N n
Identitymorphismsid
X
: XÑ‚ X areDirackernelsδ
X
: X ˆΣ
X
Ñ r0,8s :“ xˆA ÞÑ 1iff
x P Aand0otherwise. CompositionisgivenbyaChapman-Kolmogorovequation,analogouslyto
139
compositioninKℓpDq. Supposec : XÑ‚ Y andd : YÑ‚ Z. Then
ż
d‚c : X ˆΣ Ñ r0,8s :“ xˆC ÞÑ dpC|yqcpdy|xq
Z
y:Y
wherewehaveagainusedthe‘conditionalprobability’notationdpC|yq :“ d˝pyˆCq. Reading
dpC|yqfromlefttoright,wecanthinkofthisnotationasakintoreadingthestringdiagramsfrom
toptobottom,i.e. fromoutput(s)toinput(s).
MonoidalstructureonsfKrn ThereisamonoidalstructureonsfKrnanalogoustothaton
KℓpDq. Onobjects,X bY istheCartesianproductX ˆY ofmeasurablespaces. Onmorphisms,
f bg : X bYÑ‚ AbB isgivenby
ż ż
f bg : pX ˆYqˆΣ :“ pxˆyqˆE ÞÑ δ pE|x,yqfpda|xqgpdb|yq
AˆB AbB
a:A b:B
where, asabove, δ pE|a,bq “ 1iffpa,bq P E and0otherwise. Notethatpf bgqpE|x,yq “
AbB
pgbfqpE|y,xqforalls-finitekernels(andallE,xandy),bytheFubini-Tonellitheoremfors-finite
measures[60,258],andsobissymmetriconsfKrn.
ThemonoidalunitinsfKrnisagainI “ 1,thesingletonset. UnlikeinKℓpDq,however,wedo
havenontrivialeffectsp : XÑ‚ I,givenbykernelsp : pX ˆΣ
1
q – X Ñ r0,8s,withwhichwe
willrepresentdensityfunctions.
ComonoidsinsfKrn EveryobjectinsfKrnisacomonoid,analogouslytoKℓpDq. Discarding
is given by the family of effects : X Ñ r0,8s :“ x ÞÑ 1, and copying is again Dirac-like:
X
: X ˆΣ :“ xˆE ÞÑ 1 iff px,xq P E and 0 otherwise. Because we have nontrivial
X XˆX
effects,discardingisonlynaturalforcausalor‘total’channels: ifcsatisfies ‚c “ ,thencp´|xq
is a probability measure for all x in the domain1. And, once again, copying is natural (that is,
‚c “ pcbcq‚ )ifandonlyifthechannelisdeterministic.
Channelsrepresentedbyeffects Wecaninterpretthestringdiagramsof§4.1.3insfKrn,and
wewilldosobyfollowingtheintuitionoftheconditionalprobabilitynotationandreadingthestring
diagramsfromoutputstoinputs. Hence,ifc : XÑ‚ Y isrepresentedbytheeffectp : X bYÑ‚ I
withrespecttothemeasureµ : IÑ‚ Y,then
ż
c : X ˆΣ Ñ r0,8s :“ xˆB ÞÑ µpdyqppy|xq.
Y
y:B
1ThismeansthatthesubcategoryoftotalmapsinsfKrnisequivalenttotheKleislicategoryKℓpGqoftheGirymonad
GtakingeachmeasurablespaceXtothespaceGXofmeasuresoverX;seeExample4.1.30formoredetails.
140
Note that we also use conditional probability notation for density functions, and so ppy|xq :“
p˝pxˆyq.
Suppose that c : XÑ‚ Y is indeed represented by p with respect to µ, and that d : YÑ‚ Z is
representedbyq : Y bZÑ‚ I withrespecttoν : IÑ‚ Z. TheninsfKrn,d‚c : XÑ‚ Z isgivenby
ż ż
d‚c : X ˆΣ :“ xˆC ÞÑ νpdzq qpz|yqµpdyqppy|xq
Z
z:C y:Y
Alternatively,bydefiningtheeffectppµqq : X bZÑ‚ I as
ż
ppµqq : X ˆZ Ñ r0,8s :“ xˆz ÞÑ qpz|yqµpdyqppy|xq,
y:Y
wecanwrited‚cas
ż
d‚c : X ˆΣ :“ xˆC ÞÑ νpdzqppµqqpz|xq.
Z
z:C
Bayesianinversionviadensityfunctions Onceagainwritingπ : IÑ‚ X foraprioronX,and
interpretingthestringdiagramofProposition4.1.28forc:
π
: YÑ‚ X insfKrn,wehave
ˆż ˙
c: : Y ˆΣ Ñ r0,8s :“ yˆA ÞÑ πpdxqppy|xq p´1pyq
π X
x:A ż (4.9)
“ p´1pyq ppy|xqπpdxq,
x:A
wherep´1 : YÑ‚ Iisaµ-almost-inverseforeffectp‚pπbid
Y
q,andisgivenuptoµ-almost-equality
by
ˆż ˙
´1
p´1 : Y Ñ r0,8s :“ y ÞÑ ppy|xqπpdxq .
x:X
NotethatfromthiswerecovertheinformalformofBayes’ruleformeasurablespaces(4.6). Suppose
π isitselfrepresentedbyadensityfunctionp withrespecttotheLebesguemeasuredx. Then
π
ż
ppy|xqp pxq
c:pA|yq “ ş π dx.
π ppy|x1qp px1qdx1
x:A x1:X π
4.1.5. Onprobabilitymonads
Later,itwillattimesbehelpfultoworkinacategoryofstochasticchannelsthatistheKleislicategory
foramonad,withoutfixingthatmonadinadvance;inthiscasewewillspeakofaprobabilitymonad.
Unfortunately,anabstractcharacterizationofprobabilitymonadsisnotpresentlyknowntothe
author,andsoweusethisterminformally. However,whenwedoso,wehaveinmindamonoidal
monadthatmapsspacestospacesofmeasuresorvaluationsonthem,andthatmapsmorphismsto
thecorrespondingpushforwards. Inthesettingoffinitaryprobability,wehavealreadyseenone
example,themonadD exploredin§4.1.1. Herewenotetheexistenceofothers.
141
Example4.1.30(Girymonad[120]). LetMeasdenotethecategoryofmeasurablespaces,whose
objectsaresetsequippedwithσ-algebrasandwhosemorphismsaremeasurablefunctions.TheGiry
monad G : Meas Ñ MeasmapseachmeasurablespacepX,Σ qtothespaceGX ofprobability
X
measuresα : Σ Ñ r0,1soverit,equippedwiththesmallestσ-algebramakingtheevaluation
X
functions
ev : GX Ñ r0,1s
U
α ÞÑ αpUq
measurableforallU P Σ . Givenameasurablefunctionf : X Ñ Y,thefunctionGf : GX Ñ GY
X
isdefinedbypushforwards: thatis,foreachα : GX,wedefine
Gfpαq : Σ Ñ r0,1s
Y
` ˘
V ÞÑ α f´1pVq .
(Wemayalsowritef αtodenoteGfpαq.) Theunitofthemonadηhascomponentsη : X Ñ GX
˚ X
mappingeachpointxtothecorrespondingDiracmeasureδ ,whichisdefinedbyδ pUq “ 1iff
x x
x P U andδ pUq “ 0otherwise. Finally,themultiplicationµhascomponentsµ : GGX Ñ GX
x X
definedbyintegration,analogoustothe‘evaluation’ofD (Def. 4.1.6): foreachν : GGX,define
µ pνq : Σ Ñ r0,1s
X X ż
U ÞÑ αpUqdν .
α:GX
NotethatthesubcategoryoftotalmorphismsinsfKrnisequivalenttoKℓpGq.
The category Meas has all finite limits (it has products and equalizers), and this will mean
that we will be able in Chapter 6 to define “effectful polynomials” in KℓpGq, and hence obtain
categoriesofcontinuous-timecontinuous-spaceopenMarkovprocesses. However,Measdoes
not have exponentials and is therefore not Cartesian closed, because the evaluation function
evR,R : MeaspR,RqˆR Ñ R : pf,xq ÞÑ fpxq is not measurable, for any choice of σ-algeba
on the function space MeaspR,Rq [15]. This means that KℓpGq cannot be enriched in Meas,
andsowecannotdefineBayesianlensesinternallytoMeas. Circumnavigatingthisobstruction
wouldcomplicateourconstructionofcilia—dynamicalsystemsthatcontrollenses—whichare
centraltoourformalizationofpredictivecoding. Thisisbecausetheoutputmapsofstochastic
dynamicalsystemsaredeterministicfunctions: inthecaseofsystemsinKℓpGq,thismeansthey
aremorphismsinMeas;forageneralprobabilitymonadP : E Ñ E,theyaremorphismsinE.
142
Forasystemtobeabletoemitalens,therefore,thehomobjectsofBayesLens mustbeobjectsin
E,andthisinturnrequiresKℓpPqtobeenrichedinE. Fortunately,asthefollowingexamplenotes,
asuitableprobabilitymonaddoesexist.
Example4.1.31(Quasi-Borelspaces[131]). Aquasi-Borelspace isasetX equippedwithaset
M of ‘random variables’ on X taking samples from the real line, M Ă X R. The set M is
X X X
takentosatisfythreeclosureproperties: (i)M containsallconstantfunctions;(ii)M isclosed
X X
undercompositionwithmeasurablefunctions,suchthatifρ P M andf : R Ñ Rismeasurable
X
withrespecttothestandardBorelstructureonR,thenρ˝f P M ;and(iii)M isclosedunder
X X
ř
gluing‘disjointBoreldomains’,meaningthatifRiscountablypartitionedbyR – S ,and
i:N i
if tα i u i:N Ă M X , then the function px P S i q ÞÑ α i pxq is in M X . A function f : X Ñ Y is a
morphism of quasi-Borel spaces if for all ρ P M , f ˝ ρ P M . Quasi-Borel spaces and their
X Y
morphismsformacategory,QBS,andthiscategoryisCartesianclosed:ifX andY arequasi-Borel
spaces,thenQBSpX,Yqcanbegivenaquasi-BorelstructureM bydefining
XY
` ˘
M :“ tρ : R Ñ QBSpX,Yq | ρ5 : RˆX Ñ Y P QBSpRˆX,Yqu .
XY
Aprobabilitymeasureonaquasi-BorelspaceX isdefinedtobeapairofa(standard)probability
measureν onRandarandomvariableρ P M . Sincetwodifferentpairspν,ρqandpµ,τqmay
X
produce equal pushforward measures, ρ ν “ τ µ, it makes sense to consider two such QBS
˚ ˚
measurestobeequivalentiftheirpushforwardsareequal. ThesetPX ofsuchequivalenceclasses
ofQBSmeasuresonX canthenbeequippedwiththestructureofaquasi-Borelspace,andthe
assignmentPismadefunctorialbythepushforwardsaction.Finally,thefunctorP : QBS Ñ QBS
can be equipped with the structure of a (monoidal) monad in a manner analogous to the Giry
monad: theunityieldsDiracmeasures,andthemultiplicationactsbyintegration.
We end this section by noting that the notions of s-finite measure and s-finite kernel can be
reconstructedwithinQBS,sothatwemayinterpretsfKrntobeenrichedaccordingly[270,§11].
Moreover,VákárandOng[270]showthatthesetTX ofs-finitemeasuresonX canbegivena
quasi-Borelstructure,andthisassignmentactuallyyieldsamonadT : QBS Ñ QBS(byanalogy
withthe‘continuation’monad). ThislicensesustotakesfKrntobeinsteaddefinedasKℓpTq.
Forfurtherexamplesofprobabilitymonads,wereferthereadertoJacobs[139].
143
4.2. Dependent data and bidirectional processes
TwopropertiesofBayesianinversionareparticularlynotable. Firstly,givenachannelXÑ‚ Y,its
inversionyieldsachannelintheoppositedirection,YÑ‚ X. Secondly,thisinversechanneldoes
notexistinisolation,butratherdependsonasupplied‘prior’distribution. InChapter7wewill
wanttoassignfunctoriallytostochasticchannelsdynamicalsystemsthatinvertthem,andtodo
this requires understanding how inversions compose. The general pattern for the composition
of dependent bidirectional processes is called the lens pattern, and this section is dedicated to
introducingit. Themorefundamentalaspectisthatofdependence,whichwebegantoexplore
inthecontextofdependentsumsandproductsinChapter2: wethereforebeginthissectionby
introducing the Grothendieck construction, a ‘fibrational’ framework for composing dependent
processes.
4.2.1. IndexedcategoriesandtheGrothendieckconstruction
Atvariouspointabove,wehaveencountered‘dependent’objectsandmorphisms: indexedand
dependentsums(Remark2.3.10);indexedproducts(Remark2.3.20);dependentproducts(§2.3.4.1);
hintsatdependenttypetheory(endof§2.3.4);parameterizedmorphisms(§3.2.2);circuitalgebras
(§3.3);and,ofcourse,Bayesianinversions. TheGrothendieckconstructionclassifieseachofthese
as examples of a common pattern, allowing us to translate between ‘indexed’ and ‘fibrational’
perspectives: fromtheindexedperspective,weconsiderfunctorsfromanindexingobjectintoa
category(thinkofdiagrams);fromthefibrationalperspective,weconsiderbundlesasprojection
maps. Thecorrespondenceisthen,roughlyspeaking,between“theobjectindexedbyi”and“the
subobjectthatprojectstoi”,whichiscalledthe‘fibre’ofthebundleoveri.
Forthisreason,categoriesofbundlesareanimportantpartofthestory,fromwhichmuchelse
isgeneralized. RecallfromDefinition3.2.10thatthesecategoriesofbundlesareslicecategories:
thecategoryofbundlesoverB inC isthesliceC{B,whoseobjectsarepairspE,pqofanobjectE
andamorphismp : E Ñ B;andwhosemorphismspE,pq Ñ pE1,p1qaremorphismsα : E Ñ E1
ofC suchthatp “ p1 ˝α. WecallthisthecategoryofbundlesoverB asageneralizationofthe
notionof“fibrebundle”,fromwhichweinheritthenotionof‘fibre’.
Definition4.2.1. SupposeC isacategorywithfinitelimits. Givenabundlep : E Ñ B inC,its
fibre over b : B is the subobject E of E such that ppeq “ b for all e : E . The fibre E can be
b b b
144
characterizedasthefollowingpullbackobject,where1istheterminalobjectinC:
E E
b
{
p
1 B
b
In the case where C “ Set, there is an equivalence between the slice Set{B and a certain
presheafcategory: thecategoryofB-diagramsinSet,whichwecanequivalentlythinkofasthe
categoryofB-indexedsets.
Definition4.2.2. SupposeB isaset. Thediscretecategory onX isthecategorywhoseobjectsare
theelementsofB andwhoseonlymorphismsareidentitymorphismsid : b Ñ bforeachelement
b
b : B. WewilldenotethediscretecategoryonB simplybyB.
Proposition4.2.3. ForeachsetB,thereisanequivalenceSet{B – SetB.
Proof. InthedirectionSet{B Ñ SetB,letp : E Ñ B beabundleoverB.Weconstructafunctor
P : B Ñ SetbydefiningPpbq :“ E ,whereE isthefibreofpoverb; therearenonontrivial
b b
morphismsinB,sowearedone. Nowsupposef : pE,pq Ñ pF,qqisamorphismofbundles. A
naturaltransformationφ : P ñ QinSetB isjustafamilyoffunctionsφ : Pb Ñ Qbindexedby
b
b. Hence,givenf,wedefineφ astherestrictionoff toE foreachb : B.
b b
InthedirectionSetB Ñ Set{B,letP : B Ñ Setbeafunctor. WedefineE asthecoproduct
ř ř
Ppbq,andthebundlep : E Ñ B astheprojectionpb,xq ÞÑ bforeverypb,xqin Ppbq.
b:B b:B
Nowsupposeφ : P ñ QisanaturaltransformationinSetB. Wedefinethefunctionf : pE,pq Ñ
ř
pF,qqbythecoproductofthefunctionsφ ,asf :“ φ .
b b:B b
Thesetwoconstructionsareeasilyverifiedasmutuallyinverse.
IftheBinSetBisnotjustaset,butratheracategory,thenthereisacorrespondinglycategorified
notionofthecategoryofbundles.
Definition4.2.4. SupposeF : C Ñ SetisacopresheafonC. Itscategoryofelements C{F has
forobjectspairspX,xqofanobjectX : C andanelementx : FX. AmorphismpX,xq Ñ pY,yq
isamorphismf : X Ñ Y inC suchthatFfpxq “ y,asinthefollowingdiagram,wherethetop
trianglecommutesinSet:
1
x y
Ff .
FX FY
f
X Y
145
IdentitiesaregivenbyidentitymorphismsinC,andcompositioniscompositionoftheunderlying
morphismsinC. Thereisanevidentforgetfulfunctorπ : C{F Ñ C, whichactsonobjectsas
F
pX,xq ÞÑ X andonmorphismsasf ÞÑ f.
To validate that the category of elements construction is a good generalization of the slice
category,wehavethefollowingexample.
Example4.2.5. ThecategoryofelementsofarepresentablecopresheafCpC,´qisequivalentto
theslicecategoryC{C,fromwhichwederivethesimilarnotation.
Remark4.2.6. AnotherwaytolookatthemorphismspX,xq Ñ pY,yqinC{F isaspairspf,ιq,
where f is a morphism X Ñ Y in C and ι is an identification Ffpxq “ y. Then composition
inC{F isnotjustcompositionofmorphismsinC,butalsocompositionofidentifications: given
pf,ιq : pX,xq Ñ pY,yqandpg,κq : pY,yq Ñ pZ,zq,thecompositepg,κq˝pf,ιqispg˝f,κ˝Fgpιqq,
whereκ˝FgpιqisthecompositeidentificationFpg˝fqpxq ùù F ù gp ù ι ù q Fgpyq ù κ ù z. Wecanthinkof
theseidentificationsaswitnessestotherequiredequalities. ThisperspectiveonC{F isanalogous
totheprocessofcategorificationweconsideredinChapter2,whereweaddedwitnesses(fillers)to
equationsanddiagrams.
AbetterwaytovalidatethecategoryofelementsconstructionistogeneralizetheGrothendieck
correspondence, Proposition 4.2.3, which means we need something to correspond to SetB: a
categoryofcategoriesofelements. Thesegeneralizedcategoriesofelementsarecalled“discrete
opfibrations”,andconstituteourfirstexamplesofcategorifiedbundles.
Definition4.2.7. AdiscreteopfibrationisafunctorF : E Ñ B suchthat,foreveryobjectE in
E andmorphismg : FE Ñ B inB,thereexistsauniquemorphismh : E Ñ E1 inE suchthat
Fh “ g (calledthelift ofg):
E h E1
g
FE B
WriteDOpfibpBqtodenotethefullsubcategoryofCat{B onthoseobjectswhicharediscrete
opfibrations. ThesubcategoryE ofE allofwhoseobjectsaremappedbyF toB andallofwhose
B
morphismsaremappedtoid iscalledthefibreofF overB.
B
Example4.2.8. Theforgetfulfunctorπ : C{F Ñ Coutofthecategoryofelementsofacopresheaf
F
F isadiscreteopfibration: foranyobjectpX,xqinC{F andmorphismg : X Ñ Y inC,thereisa
uniquemorphismg : pX,xq Ñ pY,yq,namelywherey “ Ffpxq.
146
AndthusweobtainaGrothendieckcorrespondenceatthenextlevelofcategorification.
Proposition4.2.9. ForanycategoryB,thereisanequivalenceDOpfibpBq – SetB.
Proofsketch. Weonlysketchthebijectiononobjects; thecorrespondenceonmorphismssubse-
quentlyfollowsquitemechanically.
Givenadiscreteopfibrationp : E Ñ B,itiseasytocheckthateachfibreE isadiscretecategory
b
andhenceaset. Givenamorphismf : b Ñ cinB,wedefineafunctionφ : E Ñ E bymapping
b c
eache : E tothecodomainoftheuniquelifth. ThisdefinesafunctorB Ñ Set; functoriality
b
followsfromtheuniquenessoflifts.
Intheinversedirection,givenacopresheafF : B Ñ Set,taketheforgetfulfunctorπ : B{F Ñ
F
B outofitscategoryofelements,whichisadiscreteopfibrationbytheexampleabove. Givena
natural transformation σ : F ñ G, define a functor S : B{F Ñ B{G on objects as SpX,xq “
pX,σ pxqq and on morphisms f : pX,xq Ñ pY,yq as Sf “ pX,σ pxqq ÝÑ f pY,σ pyqq; this is
X X Y
well-definedbythenaturalityofσ andthedefinitionoff,sinceGf ˝σ pxq “ σ ˝Ffpxqand
X Y
Ffpxq “ y.
Theverificationthatthesetwoconstructionsaremutuallyinverseisstraightforward.
Inmanycases,thedependentdataofinterestwillhavemorestructurethanthatofmeresets. For
example,in§3.3weintroducedarate-codedcircuitdiagramsasanindexingofsetsofrate-coded
circuitsbyacategoryofcircuitdiagrams;later,wewillseethatdynamicalsystemshaveacanonical
notionofmorphism,andsoourdynamicalsemanticswilltaketheformofanindexedcollectionof
categories. Thisrequiresustocategorifynotonlythedomainofindexing(aswehavedoneabove),
butalsothecodomainofvalues(aswedonow). Aswithmonoidalcategories—andasinthecase
ofcircuitalgebras—inthishigher-dimensionalsetting,itbecomesnecessarytoworkwithweak
composition,andtherelevantnotionofweakfunctoristhe‘pseudofunctor’.
Definition4.2.10. SupposeC isacategoryandB isabicategory. Apseudofunctor F : C Ñ B is
constitutedby
1. afunctionF : C Ñ B onobjects;
0 0 0
2. foreachpairofobjectsa,b : C,afunctionF : Cpa,bq Ñ BpF a,F bq onmorphisms;
a,b 0 0 0
3. foreachobjectc : C,a2-isomorphismF : id ñ F pid qwitnessingweakunity,natural
idc F0c c,c c
inc;and
147
4. for each composable pair of morphisms f : a Ñ b and g : b Ñ c in C, a 2-isomorphism
F : F pgq˛F pfq ñ F pg ˝fq witnessing weak functoriality, natural in f and g,
g,f b,c a,b a,c
wherewehavewrittencompositioninC as˝andhorizontalcompositioninB as˛;
satisfyingthefollowingconditions:
(a) coherence with left and right unitality of horizontal composition, so that the respective
diagramsof2-cellscommute:
λ ρ
id ˛F pfq
Fa,bpfq
F pfq F pfq˛id
Fa,bpfq
F pfq
F0b a,b a,b a,b F0a a,b
F idb ˛F a,bpfq F a,bpfq˛F ida
F pid q˛F pfq F idb,f F pid ˝fq F pfq˛F pid q F f,ida F pf ˝id q
b,b b a,b a,b b a,b a,a a a,b a
(b) coherence with associativity of horizontal composition, so that the following diagram of
2-cellscommutes:
α
pF phq˛F pgqq˛F pfq
Fc,dphq,Fb,cpgq,Fa,bpfq
F phq˛pF pgq˛F pfqq
c,d b,c a,b c,d b,c a,b
F h,g˛F a,bpfq F c,dphq˛F
g,f
F ph˝gq˛F pfq F phq˛F pg˝fq .
b,d a,b c,d a,c
F F
h˝g,f h,g˝f
F pph˝gq˝fq F ph˝pg˝fqq
a,d a,d
Remark 4.2.11. If C is in fact a nontrivial bicategory, then the definition of pseudofunctor is
weakened accordingly: the functions F are replaced by functors between the corresponding
a,b
hom-categories,andtheequalitiesinthefunctorialityconditions(a)and(b)arereplacedbythe
relevantunitororassociatorisomorphism. Wewillencounterthismoregeneralcaseinthenext
chapter,whereweintroducethe(yetweaker)conceptoflaxfunctor: seeDefinition5.2.8,andthe
associatedfootnote5fortherelationshipwiththepresentnotionofpseudofunctor.
Withpseudofunctors,wegainanotionofindexedcategory.
Definition4.2.12. Anindexedcategory isapseudofunctorF : Cop Ñ Cat,forsomeindexing
categoryC. AnopindexedcategoryisapseudofunctorF : C Ñ Cat. Givenan(op)indexedcategory
F,wecallthecategoriesFcitsfibres,foreachobjectc : C.
148
Workingwithindexedcategoriesratherthanindexedsets,therelevantnotionof(op)fibration
is no longer discrete, as there are now (non-trivial) morphisms to account for. Following the
Grothendieck logic, fibrations p : E Ñ B should be in bijective correspondence with indexed
categories F : Bop Ñ Cat. This means that we should be able to turn any indexed category
intoafibrationbyappropriatelygluingtogetheritsfibres;andconversely,givenafibrationp,the
assignmentb ÞÑ E 2 shoulddefineapseudofunctorBop Ñ Cat. Theseconsiderationsyieldthe
b
followingdefinition.
Definition 4.2.13. A fibration is a functor p : E Ñ B such that, for every pair of morphisms
f : E1 Ñ E and ϕ : E2 Ñ E in E, and for every morphism g : ppE2q Ñ ppE1q such that
ppϕq “ ppfq˝g inB,thereexistsauniquemorphismh : E2 Ñ E1 inE suchthatpphq “ g and
ϕ “ f ˝h:
E2 h E1
f
ϕ
E
g
ppE2q ppE1q
ppfq
ppϕq
ppEq
ThesubcategoryE ofallthoseobjectsmappedbyptoB : B andallthosemorphismsmappedto
B
id iscalledthefibreofpoverB. Anopfibrationisafunctorp : E Ñ Bforwhichpop : Eop Ñ Bop
B
isafibration.
Remark 4.2.14. Note that a discrete (op)fibration is a(n) (op)fibration each of whose fibres is
adiscretecategory: thismeansthatineachfibre, therearenonon-identitymorphisms, sothat
morphismsf andϕinthedefinitionabovearetrivialized,therebyrecoveringtheformofDefinition
4.2.7.
TheGrothendieckconstructionthentellsushowtotranslatefrom(op)indexedcategoriesto
(op)fibrations: insomesituations,itwillbeeasiertoworkwiththeone,andinotherstheother.
Inparticular,categoriesoflenses(andpolynomialfunctors)willbeseentoariseasGrothendieck
constructions.
Definition4.2.15. SupposeF : Cop Ñ Catisapseudofunctor. Its(contravariant)Grothendieck
ş ş
constructionisthecategory F definedasfollows. Theobjectsof F arepairspX,xqofanobject
2withE beingthesubcategoryofE sometimesdenotedp´1pbqallofwhoseobjectsaremappedbyptob,asinthe
b
proofofProposition4.2.9.
149
X : C and an object x : FX. A morphism pX,xq Ñ pY,yq is a pair pf,φq of a morphism
f : X Ñ Y inC andamorphismφ : x Ñ FfpyqinFX,asinthefollowingdiagram,wherethe
uppertriangleisinterpretedinCat(notethecontravarianceofFf):
1
x y
φ
Ff
FX FY
X Y
f
ş ` ˘ ř ` ˘
Wecanthuswritethehomset F pX,xq,pY,yq asthedependentsum FX x,Ffpyq .
f:CpX,Yq
The identity morphism on pX,xq is pid ,id q, and composition is defined as follows. Given
X x
pf,φq : pX,xq Ñ pY,yqandpg,γq : pY,yq Ñ pZ,zq,theircompositepg,γq˝pf,φqisthepair
pg˝f,Ffpγq˝φq .
Thefollowingwell-knownresulttellsusthattheGrothendieckconstructionyieldsfibrations.
Proposition4.2.16(JohnsonandYau[145,Prop. 10.1.10]). SupposeF : Cop Ñ Catisanindexed
ş
category. Thenthereisa‘projection’functorπ : F Ñ C mappingpX,xq ÞÑ X andpf,φq ÞÑ f,
F
andthisfunctorisafibration.
Remark4.2.17. Dually,thereisacovariantGrothendieckconstruction,foropindexedcategories
ş
F : C Ñ Cat. The objects of F are again pairs pX : C,x : FXq, but now the morphisms
pX,xq Ñ pY,yq are pairs pf,φq with f : X Ñ Y in C as before and now φ : Ffpxq Ñ y; all
thatwehavedoneisswappedthedirectionofthearrowFf inthediagraminDefinition4.2.15
(comparetheidentificationsinthecategoryofelementsofacopresheaf,inDefinition4.2.4). Asa
ş ` ˘ ř ` ˘
result,wecanwritethehomset F pX,xq,pY,yq inthiscaseas FX Ffpxq,y .
f:CpX,Yq
Remark4.2.18. TheGrothendieckconstructioninducesananalogueofProposition4.2.9between
thebicategoryofpseudofunctorsBop Ñ CatandthebicategoryofGrothendieckfibrationsonB
[145,Theorem10.6.16]. IndeedthereareanaloguesofPropositions4.2.9and4.2.3inanycategorical
dimension. Becausefibrationsarethehigher-dimensionalanaloguesofbundles,theyhaveabase
category (the codomain) and a ‘total’ category (the domain), which is a kind of colimit of the
fibres (constructed by the Grothendieck construction): strictly speaking, what we have called
the Grothendieck construction above is total category of the full fibrational construction; the
fibrationitselfisthecorrespondingforgetful(projection)functor. Forahighlyreadableexposition
ofGrothendieckconstructions,wereferthereadertoLoregianandRiehl[173].
150
4.2.1.1. ThemonoidalGrothendieckconstruction
WhenC isamonoidalcategorywithwhichF isappropriatelycompatible,thenwecan‘upgrade’
thenotionsofindexedcategoryandGrothendieckconstructionaccordingly. Inthischapter,we
willrestrictourselvestolocallytrivialmonoidalindexedcategories,thoseforwhichthedomainC
isonlyacategory;MoellerandVasilakopoulou[189]workoutthestructureforbicategoricalC.
(AsnotedinRemark4.2.11,inChapter5,wewillsketchanotionofmonoidalindexedbicategory
whichamountstoacategorificationofthepresentnotion;butthatwillalsoinsomesensebelocally
trivial.)
Definition4.2.19(AfterMoellerandVasilakopoulou[189,§3.2]). SupposepC,b,Iqisamonoidal
category. WesaythatF isamonoidalindexedcategory whenF isalaxmonoidalpseudofunctor
pF,µ,ηq : pCop,bop,Iq Ñ pCat,ˆ,1q. Thismeansthatthelaxatorµisgivenbyanaturalfamily
of functors µ : FAˆFB Ñ FpAbBq along with, for any morphisms f : A Ñ A1 and
A,B
g : B Ñ B1 in C, a natural isomorphism µ : µ ˝pFf ˆFgq ñ Fpf bgq˝µ . (This
f,g A1,B1 A,B
makesµintoapseudonaturaltransformationinthesenseofDefinition5.2.9.) Thelaxatorandthe
unitorη : 1 Ñ FI togethersatisfyaxiomsofassociativityandunitalitythatconstituteindexed
versionsoftheassociatorsandunitorsofamonoidalcategory(Definition3.1.4).
Explicitly, this means that there must be three families of natural isomorphisms, indexed by
objectsA,B,C : C,
1. anassociator familyα : µ pµ p´,´q,´q ñ µ p´,µ p´,´qq;
A,B,C AbB,C A,B A,BbC B,C
2. aleftunitor λ : µ pη,´q ñ id ;and
A I,A FA
3. arightunitor ρ : µ p´,ηq ñ id
A A,I FA
suchthattheunitorsarecompatiblewiththeassociator,i.e. forallA,B : C thediagram
µ pµ p´,ηq,´q
αA,I,Bp´,η,´q
µ p´,µ pη,´qq
AbI,B A,I A,IbB I,B
µPA,BpρA,´q µA,ΛB p´,λBq
µ p´,´q
A,B
commutes(wherePandΛaretherightandleftassociatorsofthemonoidalstructurepb,Iqon
C),andsuchthattheassociativityis‘order-independent’,i.e. forallA,B,C,D : C,thediagram
151
µ pµ p´,µ p´,´qq,´q
αA,BbC,D
µ p´,µ pµ p´,´q,´qq
AbpBbCq,D A,BbC B,C A,pBbCqbD BbC,D B,C
µAA,B,C,DpαA,B,C,´q µA,AB,C,D p´,αB,C,Dq
µ pµ pµ p´,´q,´q,´q µ p´,µ p´,µ p´,´qqq
pAbBqbC,D AbB,C A,B A,BbpCbDq B,CbD C,D
αAbB,C,D αA,B,CbD
µ pµ p´,´q,µ p´,´qq
AbB,CbD A,B C,D
commutes(whereAistheassociatorofthemonoidalstructureonC).
The following proposition exhibits the monoidal structure carried by the Grothendieck
constructionwhentheindexedcategoryismonoidal.
Proposition4.2.20(MoellerandVasilakopoulou[189,§6.1]). SupposepF,µ,ηq : pCop,bop,Iq Ñ
pCat,ˆ,1q is a monoidal indexed category. Then the total category of the Grothendieck
ş
construction F obtainsamonoidalstructurepb ,I q. Onobjects,define
µ µ
` ˘
pC,Xqb pD,Yq :“ C bD,µ pX,Yq
µ CD
whereµ : FC ˆFD Ñ FpC bDqisthecomponentofµatpC,Dq. Onmorphismspf,f:q :
CD
pC,Xq ÑÞ pC1,X1qandpg,g:q : pD,Yq ÑÞ pD1,Y1q,define
` ˘
pf,f:qb pg,g:q :“ f bg,µ pf:,g:q .
µ CD
` ˘
The monoidal unit I is defined to be the object I :“ I,ηp˚q . Writing λ : I bp´q ñ p´q
µ µ
andρ : p´qbI ñ p´qfortheleftandrightunitorsofthemonoidalstructureonC,theleftand
ş
rightunitorsin F aregivenbypλ,idqandpρ,idqrespectively. Writingαfortheassociatorofthe
ş
monoidalstructureonC,theassociatorin F isgivenbypα,idq.
Remark 4.2.21. Sometimes, rather than (or in addition to) an indexed category F being lax
monoidalasapseudofunctor(whichyieldsa‘global’monoidalstructure),itmayinfactbefibrewise
monoidal, meaning that each fibre FX is itself a monoidal category (yielding ‘local’ monoidal
structures); in this case, the pseudofunctor F can be written with the type Cop Ñ MonCat.
In general, the fibrewise monoidal structures may be independent both of each other and of
the lax monoidal structure on F itself, but when C is in fact Cartesian monoidal, the local and
globalmonoidalstructurescoincide. Formorereadingonthis,wereferthereadertoMoellerand
Vasilakopoulou[189,§4].
152
4.2.2. Grothendiecklenses
Lensesformalizebidirectionalprocessesinwhichthe‘backward’processdependsondatainthe
domain of the ‘forward’ process. The name originates in database theory [34, 99], where the
forwardprocessgivesazoomed-in‘view’ontoadatabaserecord,andthebackwardprocessisused
toupdateit. FollowinganobservationofMyersandSpivak[238],lensesofthisgeneralshapecan
begivenaconcisedefinitionusingtheGrothendieckconstruction. Inordertoobtainthebackward
directionalityofthedependentpart,weusethe“pointwiseopposite”ofapseudofunctor.
Definition4.2.22. SupposeF : Cop Ñ Catisapseudofunctor. Wedefineitspointwiseopposite
Fp : Cop Ñ Cattobethepseudofunctorc ÞÑ Fcop returningtheoppositeofeachcategoryFc;
givenf : c Ñ c1,Fpf : Fcop Ñ Fc1op isdefinedaspFfqop : Fcop Ñ Fc1op.
Categories of Grothendieck lenses are then obtained via the Grothendieck construction of
pointwiseoppositesofpseudofunctors.
Definition4.2.23(Grothendiecklenses[238]). WedefinethecategoryLens ofGrothendieck
F
lensesforapseudofunctorF : Cop Ñ CattobethetotalcategoryoftheGrothendieckconstruction
forthepointwiseoppositeFp ofF. Explicitly,itsobjectspLens q arepairspC,XqofobjectsC
F 0
` ˘
inC andX inFpCq,anditshom-setsLens pC,Xq,pC1,X1q arethedependentsums
F
` ˘ ÿ ` ˘
Lens pC,Xq,pC1,X1q “ FpCq FpfqpX1q,X (4.10)
F
f:CpC,C1q
so that a morphism pC,Xq ÑÞ pC1,X1q is a pair pf,f:q of f : CpC,C1q and f: :
` ˘
FpCq FpfqpX1q,X . WecallsuchpairsGrothendiecklenses forF orF-lenses. Wesaythatthe
morphismf istheforward componentofthelens,andthemorphismf: thebackward component.
The identity Grothendieck lens on pC,Xq is id “ pid ,id q. Sequential composition is
pC,Xq C X
asfollows. Givenpf,f:q : pC,Xq ÑÞ pC1,X1qandpg,g:q : pC1,X1q ÑÞ pD,Yq,theircomposite
` ˘
pg,g:q pf,f:qisdefinedtobethelens g‚f,f:˝Fpfqpg:q : pC,Xq ÑÞ pD,Yq.
(cid:11)
Notation4.2.24. Inthecontextoflenses,wewilloftenwritethebackwardmapasf: orf7,with
theformerparticularlyusedforBayesianlenses. WewillalsouseÑÞ todenotealens,and for
(cid:11)
lenscomposition. Above,weadditionallyused‚forcompositioninthebasecategoryand˝for
compositioninthefibres.
SincelensesarebidirectionalprocessesandEnglishisreadhorizontally,whenitcomestostring
diagramsforlenses,wewilldepictthesehorizontally,withtheforwardsdirectionreadfromleftto
right.
153
WheneverC isamonoidalcategory,itgivesrisetoacanonicalcategoryoflenses,inwhichthe
forwardsmorphismsarecomonoidmorphismsinC andthebackwardsmorphismsare(internally)
parameterizedbythedomainsoftheforwardsones. Comonoidsandtheirmorphismsarenecessary
tocopyparametersduringcomposition. Theresulting‘monoidal’lensesareanaturalgeneralization
of the ‘Cartesian’ lenses used in the database setting, and we will see that Bayesian lenses are
similarlyconstructedusinganindexedcategoryof(externally)parameterizedmorphisms.
Example4.2.25. SupposepC,b,IqisamonoidalcategoryandletComonpCqbeitssubcategory
ofcomonoidsandcomonoidmorphisms. Amonoidallens pX,Aq ÑÞ pY,Bqisapairpf,f7qofa
comonoid morphism f : X Ñ Y in ComonpCq and a morphism f7 : X bB Ñ A in C. Such
lensescanbecharacterizedasGrothendiecklenses,followingSpivak[238,§3.2].
First,defineapseudofunctorP : ComonpCqop Ñ Catasfollows. OnobjectsX : ComonpCq,
definePX asthecategorywiththesameobjectsasC andwithhom-setsgivenbyPXpA,Bq :“
CpXbA,Bq;denoteamorphismf fromAtoBinPX byf : A Ý X Ñ B. Theidentityid : A Ý X Ñ A
A
is defined as the projection proj : X b A ÝÝÝXÝ b Ý id ÝÑA I b A Ý λ ÝÑA A. Given f : A Ý X Ñ B and
A
g : B Ý X Ñ C,theircompositeg˝f : A Ý X Ñ C isgivenbythefollowingstringdiagraminC:
B
X g
.
f
A
Given h : X Ñ Y in ComonpCq, the functor Ph : PY Ñ PX acts by precomposition on
morphisms,takingf : A ÝÑ Y B tothemorphismPhpfq : A Ý X Ñ B givenby
X bA Ý h Ý b Ý i Ý d ÑA Y bA ÝÑ f B .
(AnalternativewaytoobtainPX isasthe‘coKleisli’categoryofthecomonadX bp´q.)
ThecategoryofmonoidallensesisthendefinedtobethecategoryofGrothendieckP-lenses.
TheobjectsofLens arepairspX,AqofacomonoidX andanobjectAinC,andthemorphisms
P
aremonoidallenses. Givenlensespf,f7q : pX,Aq Ñ pY,Bqandpg,g7q : pY,Bq Ñ pZ,Cq,the
compositelenshasforwardcomponentgivenbyg˝f : X Ñ Z andbackwardcomponentgiven
byf7˝Pfpg7q : C Ý X Ñ A.
We can depict monoidal lenses string-diagrammatically, with the forward and backward
componentsorientedinoppositedirections. Toexemplifythis,notethat,becausetheforwards
154
componentsarecomonoidmorphisms,thefollowingequalityholdsforallcompositemonoidal
lensespg,g7q˝pf,f7q:
f g f g
X Y Z X Z
X Y “
f
A B C A C
f7 g7 f7 g7
Here, we have decorated the strings with fletches to indicate the direction of information-flow
anddisambiguatethebidirectionality,anddrawnboxesaroundthepairsthatconstituteeachlens.
Notehoweverthattheparameterizinginputtothebackwardscomponentofthefirstlensisnot
constrained to be a copy of the input to the forwards component; it is only for compositional
conveniencethatwedepictlensesthisway.
Definition 4.2.26. When C is Cartesian monoidal, so that its monoidal structure pˆ,1q is the
categoricalproduct,wewillcallmonoidallensesinC Cartesianlenses.
Remark4.2.27. Thestring-diagrammaticdepictionsoflensesabovewerenotstrictlyformal,orat
leastwehavenotexplainhowtheymightbe;wehavenotexhibitedacoherencetheoremsuchas
3.1.10. Inthiscase,thediagramsabovearedepictionsinthegraphicalcalculusofBoisseau[35].
Analternativegraphicallanguageforageneralizationoflensescalledoptics[184,217]hasbeen
describedbyRomán[219].
Monoidallensesfindusesnotonlyindatabasetheory,butinmanyothersituations,too: the
general pattern is “interacting systems where information flows bidirectionally”. In economics
(specifically,compositionalgametheory),lensesareusedtomodelthepatternofinteractionof
economic games: the forward maps encode how players act in light of observations, and the
backward maps encode how utility is passed “backwards in time” from outcomes, in order to
assigncredit[119]. Innon-probabilisticmachinelearning,lensescanbeusedtoformalizereverse
differentiationandhencethebackpropagationoferror(anotherkindofcreditassignment): the
forwardsmapsrepresentdifferentiableprocesses(suchasneuralnetworks),andthebackwardmaps
arethereverse-derivativesusedtopasserrorback(e.g.,betweenneuralnetworklayers)[74,96].
155
Generalizationsoflensesknownasoptics[184,217]havealsobeenusedbothtomodeleconomic
gameswithuncertainty(‘mixed’strategies)[36]andtomodeltheprocessofdynamicprogramming
(Bellmaniteration)usedin therelatedfieldofreinforcementlearning[128], aswell astomodel
client-serverinteractionsincomputing[277].
Insystemstheory,lensescanbeusedtoformalizevariouskindsofdynamicalsystem:theforward
mapsencodetheir‘outputs’or‘actions’, andthebackwardmapsencodehowstatesandinputs
giverisetotransitions[191]. Thislatterapplicationwillbeaparticularinspirationtous, andis
closelyrelatedtoExample4.2.30,whichexpressespolynomialfunctorsaslenses(therebyexplaining
Proposition3.5.4),andforwhichweneedthefollowingcanonicalfamilyofindexedcategories.
Definition4.2.28. WhenacategoryChaspullbacks,itsslicecategoriesC{Ccollectintoanindexed
categoryC{p´q : Cop Ñ Catcalledthe(contravariant3)self-indexing ofC,anddefinedasfollows.
OnobjectsC : C,theself-indexingunsurprisinglyreturnsthecorrespondingslicecategoriesC{C.
Givenamorphismf : A Ñ B,thefunctorC{f : C{B Ñ C{Aisdefinedbypullback. Onobjects
pE,pq : C{B, we define pC{fqpE,pq :“ pf˚E,f˚pq, where f˚E is the pullback object Aˆ E
B
andf˚pistheassociatedprojectiontoA. Onmorphismsφ : pE,pq Ñ pE1,p1qinC{B,wedefine
pC{fqpφqasthemorphismf˚φ : pf˚E,f˚pq Ñ pf˚E1,f˚p1qinducedbytheuniversalproperty
ofthepullbackf˚E1,asinthecommutingdiagram
f˚E E
{
f˚φ φ
.
f˚p f˚E1 E1 p
{
f˚p1 p1
f
A B
Remark4.2.29. ThefunctorsC{f : C{B Ñ C{Aarealsoknownasbase-changefunctors,asthey
changethe‘base’oftheslicecategory.
Example4.2.30. ThecategoryPolyofpolynomialfunctors(§3.5)isequivalenttothecategory
of Grothendieck lenses for the self-indexing of Set: that is, Poly – Lens . To see this,
Set{p´q
observethattheobjectsofLens arebundlesp : E Ñ B ofsets. Ifwedefinethesetpristo
Set{p´q
ř
bethefibreE ofpforeachi : B,wehaveanisomorphismE – pris. Wecanthendefine
i i:B
3‘Contravariant’ in contradistinction to the covariant self-indexing of Remark 3.2.12 (in the context of external
parameterizationaschange-of-enrichment).
156
ř
apolynomialfunctorP :“ ypris,andthenfindthatPp1q “ B,whichjustifieswritingthe
i:B
ř
original bundle as p : pris Ñ pp1q. We saw in Proposition 3.5.4 how to associate to any
i:pp1q
polynomialfunctorP abundlep,anditiseasytocheckthatapplyingthisconstructiontotheP
definedherereturnsouroriginalbundlep. ThisshowsthattheobjectsofPoly areinbijection
withtheobjectsofLens . Whataboutthemorphisms?
Set{p´q
A morphism p Ñ q in Lens , for p : X Ñ A and q : Y Ñ B is a pair of functions
Set{p´q
f : A Ñ B andf7 : f˚Y Ñ X suchthatf˚q “ p˝f7,asinthefollowingdiagram:
1 1 1
f7
X f˚Y Y
1
{
p f˚q q
1
A A
f1
B
ř
Replacing the bundles p and q by their polynomial representations p : pris Ñ pp1q and
i:pp1q
ř
q : qrjs Ñ qp1q,weseethatthepairpf ,f7qispreciselyamorphismofpolynomialsofthe
j:qp1q 1
formestablishedinProposition3.5.4,andthateverymorphismofpolynomialscorrespondstosuch
alens. Thisestablishesanisomorphismofhom-sets,andhencePoly – Lens .
Set{p´q
Lenses are also closely related to wiring diagrams[239, 282] and our linear circuit diagrams
(§3.3.2).
Example 4.2.31. Let FVect denote the category of finite-dimensional real vector spaces and
linearmapsbetweenthem;writenfortheobjectRn. FVecthasaCartesianmonoidalproduct
p`,0qgivenbythedirectsumofvectors(n`m “ Rn ‘Rm “ Rn`m),andwhoseunitobject
is0. ThecategoryofmonoidallensesinpFVect,`,0qisthecategoryoflinearcircuitdiagrams
(Example3.3.9).
CartesianlensespX,Aq ÑÞ pY,Bqareinsomesense‘non-dependent’lenses,becausethedomain
ofthebackwardsmapisasimpleproductX ˆB,inwhichtheobjectB doesnotdependonx : X.
WecanseepolynomialfunctorsasadependentgeneralizationofCartesianlensesinSet.
Proposition 4.2.32. The category of monoidal lenses in pSet,ˆ,1q is equivalently the full
subcategoryofPolyonthemonomialsXyA.
Proofsketch. Amorphismofmonomialspf ,f7q : XyA Ñ YyB isapairoffunctionsf : X Ñ Y
1 1
and f7 : X ˆB Ñ A; this is a Cartesian lens pX,Aq Ñ pY,Bq. There is clearly a bijection of
objectsXyA Ø pX,Aq.
157
In particular, this situation encompasses linear circuit diagrams, which embed into Poly
accordingly.
Remark4.2.33. Thereisaforgetfulfunctorfromvectorspacestosets,U : FVect Ñ Set. Ifwe
writeLenspCqtodenotethecategoryofmonoidallensesinC(withtherelevantmonoidalstructure
left implicit), this forgetful functor induces a ‘change of base’ LenspUq : LenspFVectq Ñ
LenspSetq,sincetheGrothendieckconstructionisfunctorialbyRemark4.2.18,andhencesois
theLensconstruction. Thereisthereforeacanonicalembeddingoflinearcircuitdiagramsinto
Poly,LenspFVectq Ý L Ý e Ý n Ý sp Ý U Ñ q LenspSetq ãÑ Poly.
Ourdynamicalsemanticsforapproximateinference(Chapter7)can,ifonesquintsalittle,be
thereforeseenasakindofprobabilisticgeneralizationofouralgebraforrate-codedneuralcircuits:
it will be an algebra for (a stochastic analogue of) the multicategory OPoly with semantics in
categoriesof(stochastic)dynamicalsystems. Onecanseeamorphismofpolynomialstherefore
as a kind of ‘dependent’ circuit diagram, with the forwards component transporting ‘outgoing’
informationfrominsidea(‘nested’)systemtoitsboundary(itsexternalinterface),andthebackward
componenttransporting‘incoming’information(“immanentsignals”)fromtheboundaryinternally,
dependingontheconfigurationoftheboundary.
Ofcourse,togiveanOPoly-algebraistogivealaxmonoidalfunctor,whichmeansknowing
therelevantmonoidalstructure. Whilewesawthisinthecaseofpolynomialfunctorsofsetsin
Proposition3.5.7,itwillbehelpfulwhenitcomestogeneralizingPolytoseehowthisstructureis
obtained. Moreover,wewillwantamonoidalstructureonBayesianlenses,inordertodefinejoint
approximateinferencesystems. Forthesereasons,wenowturntomonoidalcategoriesoflenses.
4.2.2.1. Monoidalcategoriesoflenses
ThemonoidalstructuresoncategoriesofGrothendiecklenses—atleastthoseofinteresthere—area
directcorollaryofthemonoidalGrothendieckconstruction,Proposition4.2.20.
Corollary4.2.34. WhenF : Cop Ñ Catisequippedwithamonoidalindexedcategorystructure
pµ,ηq,itscategoryoflensesLens becomesamonoidalcategorypLens ,b1 ,I q. Onobjects
F F µ µ
b1 isdefinedasb inProposition4.2.20,asisI . Onmorphismspf,f:q : pC,Xq ÑÞ pC1,X1qand
µ µ µ
pg,g:q : pD,Yq ÑÞ pD1,Y1q,define
` ˘
pf,f:qb1 pg,g:q :“ f bg,µop pf:,g:q
µ CD
158
whereµop : FpCqopˆFpDqop Ñ FpCbDqopisthepointwiseoppositeofµ . Theassociator
CD CD
andunitorsaredefinedasinProposition4.2.20.
Asanexample,thisgivesusthetensorproductonPoly,whichisinheritedbythecategoryof
CartesianlensesinSet.
Example4.2.35. Thetensorproductstructurepb,yqonPolyisinducedbyamonoidalindexed
categorystructurepµ,ηqontheself-indexingofpSet,ˆ,1q. Todefinetheunitorη,firstnotethat
Set{1 – Set,sothatηequivalentlyhasthetype1 Ñ Set;wethusmakethenaturalchoiceforη,
theterminalelement˚ ÞÑ 1. ThelaxatorµisdefinedforeachB,C : Setbythefunctor
µ : Set{B ˆ Set{C Ñ Set{pBˆCq
B,C
` ÿ ÿ ˘ ÿ
p : pris Ñ B, q : qrjs Ñ C ÞÑ prisˆqrjs
i:B j:C pi,jq:BˆC
thenaturalityandfunctorialityofwhichfollowfromthefunctorialityofˆ. ApplyingCorollary
4.2.34 to this structure, we obtain precisely the tensor product of polynomials introduced in
Proposition3.5.7.
Corollary 4.2.36. Since the category of Cartesian lenses in Set is the monomial subcategory
ofPoly,towhichthetensorstructurepb,yqrestricts,thelatterinducesasymmetricmonoidal
structureontheformer,theunitofwhichistheobjectp1,1q. GivenobjectspX,AqandpX1,A1q,
theirtensorpX,AqbpX1,A1qispX ˆX1,AˆA1q. Givenlensespf,f7q : pX,Aq Ñ pY,Bqand
pf1,f17 q : pX1,A1q Ñ pY1,B1q,theirtensorhasforwardcomponentf ˆf1 : X ˆX1 Ñ Y ˆY1
andbackwardcomponent
X ˆX1ˆBˆB1 Ý i Ý dX ÝÝ ˆ Ý σ ÝX1 Ý,BÝ ˆ Ý id ÝBÑ 1 X ˆBˆX1ˆB1 Ý f Ý 7 Ý ˆ Ý f Ñ 17 AˆA1
whereσ isthesymmetryoftheproductˆ.
WewillseethatthemonoidalstructureonBayesianlensesisdefinedsimilarly. Firstofall,we
needtodefineBayesianlensesthemselves.
4.3. The bidirectional structure of Bayesian updating
Inthissection,wedefineacollectionofindexedcategories,eachdenotedStat,whosemorphismscan
beseenasgeneralizedBayesianinversions. FollowingDefinition4.2.23,theseinducecorresponding
categories of lenses which we call Bayesian lenses. In §4.3.3, we show abstractly that, for the
159
subcategoriesofexact Bayesianlenseswhosebackwardchannelscorrespondto‘exact’Bayesian
inversions, the Bayesian inversion of a composite of forward channels is given (up to almost-
equality)bythelenscompositeofthecorrespondingbackwardchannels. Thisjustifiescallingthese
lenses‘Bayesian’,andprovidesthefoundationforthestudyofapproximate(non-exact)Bayesian
inversioninChapter5.
Remark4.3.1. Bayesianlenses,andtheresultthat“Bayesianupdatescomposeoptically”,were
firstintroducedbythepresentauthorin[248]. BraithwaiteandHedges[41]thenelaboratedthe
structuretodefinedependent Bayesianlenses,solvingthe‘divide-by-zero’issuealreadyindicated
inRemark4.1.22. Allthreeauthorsthenjoinedforcestoproduceapaper[42],publishedatMFCS
2023,whichwetaketobeacanonicalsummaryofthedefinitionsandbasicresults.
4.3.1. State-dependentchannels
Aswesawin§4.1,achannelc : XÑ‚ Y admittingaBayesianinversioninducesafamilyofinverse
channelsc:
π
: YÑ‚ X,indexedby‘prior’statesπ : 1Ñ‚ X. Makingthestate-dependenceexplicit,in
typicalcaseswherecisaprobabilitykernelweobtainafunctionc: : GX ˆY Ñ GX,underthe
assumptionthatc‚πisfullysupportedforallπ : GX (seeRemark4.1.20forourjustificationofthis
simplifyingassumption). Inmoregeneralsituations,andinlightofthefull-supportassumption,
weobtainamorphismc: : CpI,Xq Ñ CpY,Xqinthebaseofenrichmentofthemonoidalcategory
pC,b,Iqofc,whichforsimplicitywetaketobeSet(althoughtheconstructionstillsucceedsfor
anarbitraryCartesianbaseofenrichment). Wecallmorphismsofthisgeneraltypestate-dependent
channels,andstructuretheindexingasanindexedcategory.
Definition 4.3.2. Let pC,b,Iq be a monoidal category. Define the C-state-indexed category
Stat : Cop Ñ Catasfollows.
Stat : Cop Ñ Cat
¨ ˛
StatpXq 0 :“ C 0 ` ˘
˚ ‹
˚ StatpXqpA,Bq :“ "Set CpI,Xq,CpA,Bq ‹
X ÞÑ StatpXq :“ ˝ ‚
id : CpI,Xq Ñ CpA,Aq
id : StatpXqpA,Aq :“ A
A ρ ÞÑ id
A
(4.11)
¨ ˛
Statpfq : StatpXq Ñ StatpYq
˚ ‹
˚ ‹
˚ StatpXq 0 “ StatpYq 0 ‹
f : CpY,Xq ÞÑ ˚ ` ˘ ‹
˝ SetpCpI,Xq,CpA,Bqq Ñ Set CpI,Yq,CpA,Bq ‚
` ˘ ` ˘
α ÞÑ σ : CpI,Yq ÞÑ α : CpA,Bq
f‚σ
160
CompositionineachfibreStatpXqisasinC. Explicitly,indicatingmorphismsCpI,Xq Ñ CpA,Bq
inStatpXqbyAÝ X Ñ‚ B,andgivenα : AÝ X Ñ‚ Bandβ : BÝ X Ñ‚ C,theircompositeβ˝α : AÝ X Ñ‚ isdefined
by pβ ˝αq :“ β ‚α , where here we indicate composition in C by ‚ and composition in the
ρ ρ ρ
fibresStatpXqby˝. Givenf : YÑ‚ X inC,theinducedfunctorStatpfq : StatpXq Ñ StatpYqacts
bypre-composition(compareDefinition4.2.28ofthefunctorialactionoftheself-indexing);for
example:
CpI,fq α
Statpfqpαq : CpI,Yq ÝÝÝÝÑ CpI,Xq ÝÑ CpA,Bq
.
σ ÞÑ f ‚σ ÞÑ α
f‚σ
Remark4.3.3. Ifwedonotwishtomakethefull-supportassumption,andinsteadweknowthat
thecategoryC hasawell-definednotionofsupportobject[41,109,259],thenforagivengeneral
ś ` ˘
channelc : XÑ‚ Y,wecanwritethetypeofitsBayesianinversionc:as C supppc‚πq,Y .
π:CpI,Xq
AsBraithwaiteandHedges[41]show,thiscorrespondstoamorphisminacertainfibration,and
givesrisetoacategoryofdependentBayesianlenses;seeRemark4.1.20.
Notation 4.3.4. Just as we wrote X Ý M Ñ Y for an internally M-parameterized morphism in
CpM dX,Yq(seeProposition3.2.3)andA ÝÑ Θ B foranexternallyΘ-parameterizedmorphism
` ˘
in E Θ,CpA,Bq (see Definition 3.2.11), we write AÝ X Ñ‚ B for an X-state-dependent morphism
` ˘
in Set CpI,Xq,CpA,Bq . Given a state ρ in CpI,Xq and an X-state-dependent morphism f :
AÝ X Ñ‚ B,wewritef
ρ
fortheresultingmorphisminCpA,Bq.
Remark4.3.5. Thesimilaritiesbetweenstate-dependentchannelsandexternallyparameterized
functionsarenocoincidence: theindexedcategoryStatiscloselyrelatedtoanindexedcategory
underlying external parameterization in Set, which in previous work, reported by Capucci,
Gavranović,andStClereSmithe[53],wecalledProx(for‘proxies’).
When C is a Kleisli category KℓpTq, it is of course possible to define a variant of Stat on the
othersideoftheproduct-exponentialadjunction,withstate-dependentmorphismsAÝ X Ñ‚ B having
thetypesTX ˆA Ñ TB. Thisavoidsthetechnicaldifficultiessketchedintheprecedingexample
atthecostofrequiringamonadT. However,theexponentialformmakesforbetterexegesis,and
sowewillsticktothat.
Wewillwanttoplaceinferencesystemsside-by-side,whichmeanswewantamonoidalcategory
structureforBayesianlenses. FollowingCorollary4.2.34,thismeansStatneedstobeamonoidal
indexedcategory.
Proposition 4.3.6. Stat is a monoidal indexed category, in the sense of Definition 4.2.19. The
components µ : StatpXq ˆ StatpYq Ñ StatpX b Yq of the laxator are defined on objects
XY
161
by µ XY pA,A1q :“ AbA1 and on morphisms f : AÝ X Ñ‚ B and f1 : A1ÝÑ Y ‚ B1 as the X bY-state-
dependentmorphismdenotedf bf1 andgivenbythefunction
µ pf,f1q : CpI,X bYq Ñ CpAbA1,BbB1q
XY
.
ω ÞÑ f bf1
ωX ωY
Here,ω andω aretheX andY marginalsofω,givenbyω :“ proj ‚ωandω :“ proj ‚ω.
X Y X X Y Y
(Note that this makes µ into a strict transformation in the sense of Definition 5.2.9.) The unit
η : 1 Ñ StatpIqofthelaxmonoidalstructureisthefunctormappingtheuniqueobject˚ : 1tothe
unitobjectI : StatpIq.
Remark4.3.7. NotethatStatisalsofibrewisemonoidalinthesenseofRemark4.2.21,asanalmost
trivialconsequenceofC beingmonoidal. Wewillnotmakeuseofthisstructureinthischapter,but
wewillreturntoitintheconstructionofstatisticalgamesin§5.3.1.
Atthispoint,wecanturntoBayesianlensesthemselves.
4.3.2. Bayesianlenses
WedefinethecategoryofBayesianlensesinC tobethecategoryofGrothendieckStat-lenses.
Definition4.3.8. ThecategoryBayesLens ofBayesianlensesinC isthecategoryLens of
C Stat
GrothendiecklensesforthefunctorStat. ABayesianlensisamorphisminBayesLens . Where
C
thecategoryC isevidentfromthecontext,wewilljustwriteBayesLens.
Unpackingthisdefinition,wefindthattheobjectsofBayesLens arepairspX,Aqofobjects
C
ofC. Morphisms(thatis,Bayesianlenses)pX,Aq ÑÞ pY,Bqarepairspc,c:qofachannelc : XÑ‚ Y
andageneralizedBayesianinversionc: : BÝ X Ñ‚ A;thatis,elementsofthehomobjects
` ˘ ` ˘
BayesLens pX,Aq,pY,Bq : “ Lens pX,Aq,pY,Bq
C Stat
` ˘
– CpX,YqˆSet CpI,Xq,CpB,Aq .
TheidentityBayesianlensonpX,Aqispid ,id q,wherebyabuseofnotationid : CpI,Yq Ñ
X A A
CpA,Aqistheconstantmapid definedinEquation(4.11)thattakesanystateonY totheidentity
A
onA.
Thesequentialcompositepd,d:q pc,c:qofpc,c:q : pX,Aq ÑÞ pY,Bqandpd,d:q : pY,Bq ÑÞ
` (cid:11) ˘
pZ,Cq is the Bayesian lens pd‚cq,pc: ˝c˚d:q : pX,Aq ÑÞ pZ,Cq where pc: ˝c˚d:q : CÝ X Ñ‚ A
takesastateπ : IÑ‚ X tothechannelc:
π
‚d:
c‚π
: CÑ‚ A.
162
ToemphasizethestructuralsimilaritybetweenBayesianandmonoidallenses,andvisualizethe
channelc: ‚d: ,notethatfollowingExample4.2.25,wecandepictBayesianlenscomposition
π c‚π
usingthegraphicalcalculusofBoisseau[35]as
c d c d
X Y Z X Z
X Y “ .
c
A B C A C
c: d: c: d:
Remark 4.3.9. Strictly speaking, these depictions are diagrams in Boisseau [35]’s calculus of
stringdiagramsforoptics,whichmeansthattheyarenotdirectdepictionsoftheBayesianlenses
themselves;rathertheyaredepictionsofthecorrespondingoptics,whichwedefineandelaborate
in[248]. Briefly,theseopticsareobtainedbyembeddingthecategoriesofforrwardsandbackwards
channelsintotheircorresponding(co)presheafcategoriesandcouplingthemtogetheralongthe
‘residual’categoryC;inthedepictions,thestringdiagramsintheforwardsandbackwardsdirections
arethusinterpretedinthesedifferentcategories. Thisexplainswhyweareallowedto‘copy’the
channelcinthedepictionabove,producingtheright-handsidebypushingcthroughthecopieras
ifitwereacomonoidmorphism: itisbecausethecomonoidsinquestionareCpI,XqandCpI,Yq,
andthefunctionCpI,cqisindeedacomonoidmorphism,eventhoughcisingeneralnot!
Remark 4.3.10. Note that the definition of Stat and hence the definition of BayesLens do
C
notrequireC tobeacopy-deletecategory,eventhoughourmotivatingcategoriesofstochastic
channels are; all that is required for the definition is that C is monoidal. On the other hand, as
we can define Bayesian lenses in any copy-delete category, we can define them in Set, where
Setp1,Xq – X foreverysetX: inthiscase,BayesianlensescoincidewithCartesianlenses.
Ofcourse,sinceStatisamonoidalindexedcategory,BayesLens isamonoidalcategory.
C
` ˘
Proposition4.3.11. BayesLens isamonoidalcategory,withstructure pb,pI,Iq inherited
C
from C. On objects, define pA,A1q b pB,B1q :“ pA b A1,B b B1q. On morphisms pf,f:q :
pX,Aq ÑÞ pY,Bqandpg,g:q : pX1,A1q ÑÞ pY1,B1q,definepf,f:qbpg,g:q :“ pf bg,f: bg:q,
where f: b g: : B b B1Ý X ÝÝ b ‚Ý X Ñ 1 A b A1 acts on states ω : IÑ‚ X b X1 to return the channel
163
f: bg: ,followingthedefinitionofthelaxatorµinProposition4.3.6. Themonoidalunitin
ωX ω X1
BayesLens isthepairpI,IqduplicatingtheunitinC. WhenC ismoreoversymmetricmonoidal,
C
soisBayesLens .
C
Proofsketch. ThemainresultisimmediatefromProposition4.3.6andCorollary4.2.34. Whenbis
symmetricinC,thesymmetryliftstothefibresofStatandhencetoBayesLens .
C
ButBayesLens isnotingeneralacopy-discardcategory.
C
Remark4.3.12. AlthoughBayesLens isamonoidalcategory,itdoesnotinheritacopy-discard
C
structurefromC,owingtothebidirectionalityofitscomponentmorphisms. Toseethis,wecan
considermorphismsintothemonoidalunitpI,Iq,andfindthatthereisgenerallynocanonical
discardingmap. Forinstance,amorphismpX,Aq ÑÞ pI,IqconsistsinapairofachannelXÑ‚ I
(whichmayindeedbeadiscardingmap)andastate-dependentchannelIÝ X Ñ‚ A,forwhichthereis
generallynosuitablechoicesatisfyingthecomonoidlaws. Note,however,thatalensofthetype
pX,Iq ÑÞ pI,Bqmightindeedactbydiscarding,sincewecanchoosetheconstantstate-dependent
ş
channelBÝ X Ñ‚ I onthediscardingmap : BÑ‚ I. Bycontrast,theGrothendieckcategory Stat
ş
isacopy-deletecategory,asthemorphismspX,Aq Ñ pI,Iqin StatarepairsXÑ‚ I andAÝ X Ñ‚ I,
andsoforbothcomponentswecanchoosemorphismswitnessingthecomonoidstructure.
4.3.3. Bayesianupdatescomposeoptically
Inthissectionweprovethefundamentalresultthatjustifiesthedevelopmentofstatisticalgamesas
hierarchicalinferencesystemsinChapter5: thattheBayesianinversionofacompositechannelis
givenuptoalmost-equalitybythelenscompositeofthebackwardscomponentsoftheassociated
‘exact’Bayesianlenses.
Definition4.3.13. Letpc,c:q : pX,Xq ÑÞ pY,YqbeaBayesianlens. Wesaythatpc,c:qisexact
ifcadmitsBayesianinversionand,foreachπ : IÑ‚ X suchthatc‚π hasfullsupport,candc:
π
togethersatisfyequation(4.5)(p. 133). Bayesianlensesthatarenotexactaresaidtobeapproximate.
Theorem4.3.14. Letpc,c:qandpd,d:qbesequentiallycomposableexactBayesianlenses. Then,
foranystateπ onthedomainofc,thecontravariantcomponentc:˝c˚d: ofthecompositelens
pd,d:q pc,c:qistheBayesianinversionofd‚c. Thatistosay,Bayesianupdatescomposeoptically:
(cid:11)
pd‚cq : d‚ „ c‚π c: ‚d: .
π π c‚π
164
Proof. Foranysuitably-typedπ,thestate-dependentchannelc:˝c˚d:returnsthechannelc: ‚d: :
π c‚π
ZÑ‚ X,sotoestablishtheresultitsufficestoshowthat
X Z X Z
c: d
π
d: c
c‚π
“ .
d
c
π π
Wehave
X Z X Z X Z
c: c: d
π π
d: d c
c‚π
“ “
d
c
c
π π π
wherethefirstobtainsbecaused: isbyassumptionaBayesianinverseofdwithrespecttoc‚π,
c‚π
andthesecondbecausec: islikewiseaBayesianinverseofcwithrespecttoπ. Hence,c: ‚d:
π π c‚π
andpd‚cq : arebothBayesianinversionsofd‚cwithrespecttoπ. SinceBayesianinversionsare
π
almost-equal(Proposition4.1.29),wehavec: ‚d: d‚ „ c‚π pd‚cq :,asrequired.
π c‚π π
Thistheoremhasthefollowingimportantimmediateconsequence.
Corollary4.3.15. SupposeC:isasubcategoryofCallofwhosechannelsadmitBayesianinversion,
andconsidertherestrictiontoC: ofthefibrationπ : BayesLens Ñ C ofBayesianlenses,
Lens C
denotedπ: . Thenthereisanalmostsuresection: : C: Ñ BayesLens ofπ: takingeach
Lens C Lens
objectX topX,Xqandeachchannelc : XÑ‚ Y toalenspc,c:q : pX,Xq ÑÞ pY,Yqwherec: isan
almost-surelyuniqueBayesianinversionofc. HencethecompositeC ÑÝ : BayesLens Ý π ÝL : ÝeÑns C is
C
equaltotheidentityfunctorid .
C
Remark 4.3.16. A morphism σ : B Ñ E is a section of π : E Ñ B when π ˝ σ “ id . In
B
standard category theory, a section of a fibration π is therefore a functor: but, since Bayesian
165
inversion is only defined up to almost-equality, the functoriality of the preceding corollary is
accordingly weakened. This leads to the notion of almost sure section, which we formalize by
lifting the relation of almost-equality from C to BayesLens , as follows. Suppose pc,c7q and
C
pd,d7q are lenses pX,Xq ÑÞ pY,Yq. Then we may say that they are equivalent up to almost
equality, denoted pc,c7q « pd,d7q, if for all states α : IÑ‚ X, we have c „ α d and c7
α
c „ ‚α d7
α
. If
additionallywehavec “ d,wewritepc,c7q » pd,d7qandsaythattheyarestronglyequivalent.
Notethenthatthemapping:oftheprecedingcorollaryisfunctorialuptothisstrongequivalence:
:pdq :pcq » :pd‚cq;thisiswhatwemeanbyalmostsuresection. Webelievethisnotion(andthe
(cid:11)
implicitmoregeneraloneofalmostsurefunctor)tobenew,butdonotstudyitfurtherhere.
Remark4.3.17. Inthecontextoffinitely-supportedprobability(i.e.,inKℓpDq),almost-equality
coincideswithsimpleequalityoverthesupport,andsoBayesianinversionsarethenjustequal
(overthesupport). Thissuggeststhat,inthiscontext,:maybestrengthenedtoastrictfunctor: but
thequalificationoverthesupport meanswemustusethemachineryofdependentBayesianlenses
(Remark4.1.20);then,:doesyieldastrictfunctor.
Remark 4.3.18. Note that the functor : is not monoidal, because inverting the tensor of two
channels with respect to a joint distribution is not the same as inverting the two channels
independently with respect to the marginals and tensoring them together (unless the joint is
alreadytheproductoftwoindependentstates);thatis,pcbdq : ‰ c: bd: ,whereω andω
ω ω1 ω2 1 2
arethetwomarginalsofthejointstateω. Technically,thissituationobtainsbecausethereisno
channelX
1
bX
2
Ñ‚ X
1
bX
2
thatperformsthismarginalization-then-tensoringthatcouldplaythe
partofthelaxatorof:. (ButnotethattypicallyaprobabilitymonadP willbe‘bimonoidal’,with
the ‘opmonoidal’ structure PpX ˆX q Ñ PX ˆPX witnessing this joint-marginalization
1 2 1 2
operation[110,§4];thetechnicalhurdleisthatthisstructuretypicallyinteractsnicelywiththe
monadstructure,sincethetensoroftwoDiracdeltasisagainaDiracdelta.)
In§5.4,wewillusethemachineryofstatisticalgamestomeasuretheerrorproducedbyinverting
twochannelsindependently,versusinvertingthemjointly.
Historically,lenseshaveoftenbeenassociatedwith‘lenslaws’: additionalaxiomsguaranteeing
their well-behavedness. These laws originate in the context of database systems, and we now
investigatehowwelltheyaresatisfiedbyBayesianlenses,whereonemightseeaninferencesystem
asakindofuncertaindatabase. WewillfindthatBayesianlensesarenotlawfulinthistraditional
sense,becausethey‘mix’information.
166
4.3.4. LawfulnessofBayesianlenses
ThestudyofCartesianlensessubstantiallyoriginatesinthecontextofbidirectionaltransformations
ofdatainthecomputerscienceanddatabasecommunity[34,99],wherewecanthinkoftheview
(orget)functionasreturningpartofadatabaserecord,andtheupdate(orput)functionas‘putting’
apartintoarecordandreturningtheupdatedrecord. Inthissetting,axiomsknownaslenslaws
canbeimposedonlensestoensurethattheyare‘well-behaved’withrespecttodatabasebehaviour:
forexample,thatupdatingarecordwithsomedataisidempotent(the‘put-put’law).
Wemighthopethatwell-behavedor“verywell-behaved”lensesinthedatabasecontextshould
roughlycorrespondtoournotionofexactBayesianlens: withtheviewthataninferencesystem,
formalizedbyaBayesianlens,issomethinglikeaprobabilisticdatabase. However,aswewillsee,
evenexactBayesianlensesareonlyweaklylawfulinthedatabasesense: Bayesianupdatingmixes
informationinthepriorstate(the‘record’)withtheobservation(the‘data’),ratherthanreplacing
thepriorinformationoutright.
Wewillconcentrateonthethreelenslawsthathaveattractedrecentstudy[35,217]: GetPut,
PutGet,andPutPut. ACartesianlenssatisfyingtheformertwoiswell-behaved whilealens
satisfyingallthreeisverywell-behaved,intheterminologyofFosteretal.[99].Informally,GetPut
saysthatgettingpartofarecordandputtingitstraightbackreturnsanunchangedrecord;PutGet
saysthatputtingapartintoarecordandthengettingitreturnsthesamepartthatwestartedwith;
andPutPutsaysthatputtingonepartandthenputtingasecondparthasthesameeffectona
recordasjustputtingthesecondpart(thatis,updatecompletelyoverwritesthepartintherecord).
Wewillexpresstheselawsgraphically,andconsiderthemeachbrieflyinturn.
NotefirstthatwecanliftanychannelcinthebasecategoryC intoanystate-dependentfibre
StatpAq using the constant (identity-on-objects) functor taking c to the constant-valued state-
indexedchannelρ ÞÑ cthatmapsanystateρtoc. WecanliftstringdiagramsinC intothefibres
accordingly.
GetPut
Definition4.3.19. Alenspc,c:qissaidtosatisfytheGetPutlawifitsatisfiestheleftequality
in(4.12)below. Equivalently,becausethecopierinducedbytheCartesianproductisnatural(i.e.,
˝f “ pf ˆfq˝ ),foranystateπ,wesaythatpc,c:qsatisfiesGetPutwithrespecttoπ ifit
167
satisfiestherightequalityin(4.12)below.
c:
c:
π
c “ ùñ c “ (4.12)
π π
(Notethatherewehavewrittenthecopyingmapas ,sinceweareassuminganambientCartesian
monoidalstructure;henceforaBayesianlensweinterprettheleftdiagramaboveintheimageof
theYonedaembedding.)
Proposition4.3.20. Whenciscausal,theexactBayesianlenspc,c:qsatisfiestheGetPutlaw
withrespecttoanystateπ forwhichcadmitsBayesianinversion.
Proof. Startingfromtheright-hand-sideof (4.12),wehavethefollowingchainofequalities
c c:
π c:
π
“ “ “ “
c
c
π π π π π
where the first holds by the counitality of , the second by the causality of c, the third since c
admitsBayesianinversion(4.5)withrespecttoπ,andthefourthagainbycounitality.
NotethatbyBayes’law,exactBayesianlensesonlysatisfyGetPutwithrespecttostates. This
resultmeansthat,ifwethinkofcasgeneratingapredictionc‚π fromapriorbeliefπ,thenifour
observationexactlymatchestheprediction,updatingthepriorπaccordingtoBayes’ruleresultsin
nochange.
168
PutGet ThePutGetlawischaracterizedforalenspv,uqbythefollowingequality:
v
u “
Ingeneral,PutGetdoesnotholdforexactBayesianlensespc,c:q. However,becauseGetPut
holdswithrespecttostatesπ,wedohavec‚c: ‚c‚π “ c‚π;thatis,PutGetholdsforexact
π
Bayesianlensespc,c:qforthepriorπ and‘input’c‚π.
ThereasonPutGetfailstoholdingeneralisthatBayesianupdatingmixesinformationfrom
thepriorandtheobservation,accordingtothestrengthofbelief. Consequently,updatingabelief
accordingtoanobservedstateandthenproducinganewpredictionneednotresultinthesame
stateasobserved;unless,ofcourse,thepredictionalreadymatchestheobservation.
PutPut Finally,thePutPutlawforalenspv,uqischaracterizedbythefollowingequality:
u
“
u
u
PutPutfailstoholdforexactBayesianlensesforthesamereasonthatPutGetfailstoholdin
general: updatesmixoldandnewbeliefs,ratherthanentirelyreplacetheoldwiththenew.
Comment Intheoriginalcontextofcomputerdatabases,thereisassumedtobenouncertainty,
soa‘belief’iseithertrueorfalse. Consequently,therecanbeno‘mixing’ofbeliefs;andindatabase
applications,suchmixingmaybehighlyundesirable. Bayesianlenses,ontheotherhand,liveina
fuzzierworld: ourpresentinterestinBayesianlensesoriginatesintheirapplicationtodescribing
cognitiveandcyberneticprocessessuchasperceptionandaction,andheretheabilitytomixbeliefs
accordingtouncertaintyisdesirable.
Possiblyitwouldbeofinteresttogiveanalogousinformation-theoreticlenslawsthatcharacterize
exactandapproximateBayesianlensesandtheirgeneralizations;andwemightthenexpectthe
169
‘Boolean’lenslawstoemergeintheextremalcasewherethereisnouncertaintyandonlyDirac
states. Weleavesuchanendeavourforfuturework: Bayes’law(4.5)issufficientlyconciseand
productiveforourpurposeshere.
170
5. Statistical games
Inthischapter,wecharacterizeanumberofwellknownsystemsofapproximateinferenceasloss
models(definedin§5.3.2): laxsectionsof2-fibrationsofstatisticalgames,themselvesconstructed
(in§5.3.1)byattachinginternally-definedlossfunctionstoBayesianlenses. Ourexamplesinclude
therelativeentropy(§5.3.3.1),whichconstitutesastrict section,andwhosechainruleisformalized
bythehorizontalcompositionofthe2-fibration. Inordertocapturethiscompositionalstructure,
wefirstintroducethenotionof‘copy-composition’(in§5.2.1),alongsidecorrespondingbicategories
throughwhichthecompositionofcopy-discardcategoriesfactorizes. Theselatterbicategoriesare
obtainedasavariantoftheCopara construction[54,§2](dualtotheinternalparameterizationof
§3.2.1),andsoweadditionallyintroducecoparameterizedBayesianlenses(§5.2.3),provingthat
coparameterizedBayesianupdatescomposeoptically(§5.2.4),asinthenon-coparameterizedcase.
Besidestherelativeentropy,ourotherexamplesoflossmodelsaregivenbymaximumlikelihood
estimation(§5.3.3.2),thefreeenergy(whichgivesusin§5.3.3.3acharacterizationofautoencoders),
andthe‘Laplace’approximationtothefreeenergy(§5.3.3.4). Itisthislatterlossmodelwhichwill,
inChapter7,finallyyieldthedynamicalsemanticsforpredictivecoding.
Webeginwithadiscussionofcompositionalapproximateinferencefromthe‘lens’perspective,
focusingontherelativeentropy.
5.1. Compositional approximate inference, via the chain rule for
relative entropy
InChapter4,weobservedthattheBayesianinversionofacompositestochasticchannelis(almost
surely) equal to the ‘lens composite’ of the inversions of the factors; that is, Bayesian updates
compose optically (‘BUCO’, Theorem 4.3.14). Formalizing this statement for a given category C
yields a fibration of Bayesian lenses as a Grothendieck construction of the indexed category of
state-dependentchannels(Definition4.3.8),andBayesianinversionalmostsurelyyieldsasection:
ofthecorrespondingfibration(Corollary4.3.15). Thissection:picksoutaspecialclassofBayesian
lenses, which we call exact as they compute ‘exact’ inversions (Definition 4.3.13), but although
171
thecategoryBayesLenspCqhasmanyothermorphisms,itsconstructionisnotextravagant: by
comparison,wethinkofthenon-exactlensesasrepresentingapproximateinferencesystems. This
is particularly necessary in computational applications, because computing exact inversions is
usuallyintractable,butthiscreatesanewproblem: choosinganapproximation,andmeasuring
itsperformance. Inthischapter,weformalizethisprocess,byattachinglossfunctionstoBayesian
lenses,thuscreatinganotherfibration,ofstatisticalgames. Sectionsofthislatterfibrationencode
compositionallywell-behavedsystemsofapproximationthatwecalllossmodels.
Aclassicexampleofalossmodelwillbesuppliedbytherelativeentropy,whichinsomesense
measuresthe‘divergence’betweendistributions: thegamehereisthentominimizethedivergence
between the approximate and exact inversions. If π and π1 are two distributions on a space X,
withcorrespondingdensityfunctionsp andp (bothwithrespecttoacommonmeasure),then
π π1
theirrelativeentropyDpπ,π1qistherealnumbergivenbyE rlogp pxq´logp pxqs 1. Given
x„π π π1
apairofchannelsα,α1 : AÑ‚ B (againcommensuratelyassociatedwithdensities),wecanextend
` ˘
DtoamapD : A Ñ R inthenaturalway,writinga ÞÑ D αpaq,α1paq . Wecanassignsuch
α,α1 `
amapD toanysuchparallelpairofchannels,andso,followingthelogicofcompositionin
α,α1
C 2,wemighthopeforthefollowingequationtoholdforalla : Aandcomposableparallelpairs
α,α1 : AÑ‚ B andβ,β1 : BÑ‚ C:
“ ‰
D paq “ E D pbq `D paq
β‚α,β1‚α1 β,β1 α,α1
b„αpaq
The right-hand side is known as the chain rule for relative entropy, but, unfortunately, the
equationdoesnot holdingeneral,becausethecompositesβ ‚αandβ1‚α1 eachinvolveanextra
expectation:
“ ‰
D paq “ E logp pcq´logp pcq
β‚α,β1‚α1 β‚αpaq β1‚α1paq
c„β‚αpaq„ ȷ
“ ‰
“ E log E rp pc|bqs´log E p pc|bq
β β1
c„β‚αpaq b„αpaq b„α1paq
However,wecansatisfyanequationofthisformbyusing‘copy-composition’: ifwewrite to
B
denotethecanonical‘copying’comultiplicationonB,anddefineβ ‚2α :“ pid bβq‚ ‚α,as
B B
depictedbythestringdiagram
B
A C
α β
1Fordetailsaboutthis‘expectation’notationE,see5.3.19.
2Inwhich,followingtheChapman-Kolmogorovrule,acompositechannelβ‚αcanbeexpressedastheexpectationof
βunderα,i.e.aÞÑE rβpbqs.
b„αpaq
172
thenD paqdoesequalthechain-ruleformontheright-handside:
β‚2α,β1‚2α1
“ ‰
D paq “ E E logp pc|bqp pb|aq´logp pc|bqp pb|aq
β‚2α,β1‚2α1 β α β1 α1
b„αpaq„c„βpbq ȷ
“ ‰
“ E E logp pc|bq´logp pc|bq `logp pb|aq´logp pb|aq
β β1 α α1
b„αpaq“ c„βpbq
‰
“ E D pbq `D paq
β,β1 α,α1
b„αpaq
wherethesecondlinefollowsbythelinearityofexpectation. Thisresultexhibitsageneralpattern
aboutcopy-discardcategories(Definition3.1.3)suchasC: composition‚canbedecomposedinto
first copying , and then discarding . If we don’t discard, then we retain the ‘intermediate’
variables,andthisresultsinafunctorialassignmentofrelativeentropiestochannels.
Therestofthischapterisdedicatedtomakinguseofthisobservationtoconstructlossmodels,
including (but not restricted to) the relative entropy. The first complication that we encounter
is that copy-composition is not strictly unital, because composing with an identity retains an
extravariable. Todealwiththis,in§5.2,weconstructabicategory ofcopy-compositechannels,
extendingtheCopara construction,andbuildcoparameterized(copy-composite)Bayesianlenses
accordingly;wealsoproveacorrespondingBUCOresult. In§5.3,wethenconstruct2-fibrations
ofstatisticalgames,defininglossfunctionsinternallytoanycopy-discardcategoryC thatadmits
“bilineareffects”. Becausewearedealingwithapproximatesystems,the2-dimensionalstructureof
theconstructionisuseful: lossmodelsareallowedtobelax sections. Wethencharacterizethe
relativeentropy,maximumlikelihoodestimation,thefreeenergy,andthe‘Laplacian’freeenergy
assuchlossmodels.
Unsurprisingly,eachoftheselossfunctionsaremoreover(lax)monoidal,and,assumingC is
symmetricmonoidal,eachoftheconstructionsmentionedhereresultinmonoidal(2-)fibrations.
Weexplorethismonoidalstructurein§5.4.
5.2. ‘Copy-composite’ Bayesian lenses
5.2.1. Copy-compositionbycoparameterization
In a locally small copy-discard category C (Definition 3.1.3), every object A is equipped with a
canonical comonoid structure p , q, and so, by the comonoid laws (Definition 3.4.21), it is
A A
almostatrivialitythatthecompositionfunctions‚ : CpB,CqˆCpA,Bq Ñ CpA,Cqfactorizeas
´ ¯
pidBb´qˆC idA,
B
CpB,CqˆCpA,Bq ÝÝÝÝÝÝÝÝÝÝÝÝÝÝÑ CpBbB,BbCqˆCpA,BbBq ¨¨¨
¨¨¨ ÑÝ ‚ CpA,BbCq Ý C Ý pi Ý dAÝ , Ý pr Ý o Ý j CÑ q CpA,Cq
173
wherethefirstfactorcopiestheB outputofthefirstmorphismandtensorsthesecondmorphism
with the identity on B, the second factor composes the latter tensor with the copies, and the
third discards the extra copy of B 3. This is, however, only almost trivial, since it witnesses the
structureofChapman-Kolmogorovstylecompositionincategoriesofstochasticchannelssuchas
KℓpDq,theKleislicategoryofthe(finitary)distributionsmonadD : Set Ñ Set(§4.1.1.1). There,
givenchannelsc : AÑ‚ B andd : BÑ‚ C,thecomposited‚cisformedfirstbyconstructingthe
‘joint’channel,denotedd‚2canddefinedbypd‚2cqpb,c|aq :“ dpc|bqcpb|aq,andthendiscarding
(marginalizingover)b : B,giving
ÿ ÿ
pd‚cqpc|aq “ pd‚2cqpb,c|aq “ dpc|bqcpb|aq.
b:B b:B
Of course, the channel d ‚2 c is not a morphism AÑ‚ C, but rather AÑ‚ B b C; that is, it is
coparameterized byB,inasenseformallydualtothenotionofparameterizationof§3.2.1.
Moreover,asnotedabove,‚2 isnotstrictlyunital: giventhecompositesid ‚2f andf‚2id ,
B A
weneed2-cellsthatdiscardthecoparametersintroducedbythecopying;and,inversely,weneed
2-cellsf ÞÑ id ‚2f andf ÞÑ f‚2id thatintroducethem. Theformerareofcoursegivenbythe
B A
discardingstructure
M M
M
B
A f ÞÑ A f “ A f (5.1)
B B B
A
M M M
A f ÞÑ A f “ A f (5.2)
B B B
whilethelatteraregivenbycopying:
M
M
B
A f ÞÑ A f (5.3)
B B
3Wedefineproj C :“BbC ÝÝÝBÝ b Ý i Ý dCÑIbC Ý λ ÝCÑC,usingthecomonoidcounit B andtheleftunitorλ C ofC’s
monoidalstructure.
174
A
M M
A f ÞÑ A f (5.4)
B B
Theseputative2-cellsclearlyneedaccesstocopiesofthedomainandcodomainoff,andhence
arenotavailableinthestandardCopara constructionobtainedbyformallydualizingPara. For
thisreason,weconstructabicategoryCopara pCqasavariantoftheCopara construction,in
2
whicha1-cellA Ñ B maybeanymorphismAÑ‚ M bB inC,andwherehorizontalcomposition
ispreciselycopy-composition. Wewillhenceforthdropthecumbersomenotation‚2,andwrite
simply‚forhorizontalcompositioninCopara pCq,matchingthecompositionoperatorofC itself.
2
(Later,ifweneedtobeexplicitabouthorizontalcomposition,wewillsometimesusethesymbol˛.)
Theorem5.2.1. LetpC,b,Iqbeacopy-discardcategory. ThenthereisabicategoryCopara pCq
2
asfollows. Its0-cellsaretheobjectsofC. A1-cellf : A ÝÑ B isamorphismf : A Ñ M bB in
M
C. A2-cellφ : f ñ f1,withf : A ÝÑ B andf1 : A ÝÝÑ B,isamorphismφ : AbM bB Ñ M1
M M1
ofC,satisfyingthechangeofcoparameter axiom:
M1 M1
φ
A A
f1 “ f
B B
Given2-cellsφ : f ñ f1 andφ1 : f1 ñ f2,theirverticalcompositeφ1dφ : f ñ f2 isgivenby
thefollowingstringdiagram:
φ φ1
The identity 2-cell id : f ñ f on f : A ÝÑ B is given by the projection morphism proj :
f M
M
AbM bB Ñ M obtainedbydiscardingAandB,asinfootnote3.
Thehorizontalcompositeg˝f : A ÝÝÝÝÝÝÑ C of1-cellsf : A ÝÑ B theng : B ÝÑ C isgiven
MbBbN M N
175
bythefollowingstringdiagraminC:
M
B
N
A
f g
C
Strictlyspeaking,wedefinethecoparameterofg˝f tobepMbBqbN. Theidentity1-cellid on
A
AisgivenbytheinverseoftheleftunitorofthemonoidalstructureonC,i.e. id :“ λ´1 : A ÑÝ A,
A A
I
withcoparameterthusgivenbytheunitobjectI.
The horizontal compositeγ ˝φ : pg ˝fq ñ pg1 ˝f1q of 2-cells φ : f ñ f1 and γ : g ñ g1 is
givenbythestringdiagram
A
M M1
φ
B B
.
N N1
γ
C
Proof. ToshowthatCopara pCqisabicategory,weneedtoestablishtheunitalityandassociativity
2
ofverticalcomposition;verifythathorizontalcompositioniswell-definedandfunctorial;establish
theweakunitalityandassociativityofhorizontalcomposition;andconfirmthatthecorresponding
unitorsandassociatorsatisfythebicategoricalcoherencelaws. Then,toprovethatCopara pCq
2
ismoreovermonoidal,weneedtodemonstratethatthetensorasproposedsatisfiesthedataofa
monoidalbicategory. However,sincethemonoidalstructureisinheritedfromthatofC,wewill
elidemuchofthislatterproof,anddemonstrateonlythatthetensorisfunctorial;therestfollows
straightforwardlybuttediously.
Webeginbyconfirmingthatverticalcompositiondisunitalandassociative. Toseethatdis
unital, simply substitute the identity 2-cell (given by projection onto the coparameter) into the
stringdiagramdefiningdandthenapplythecomonoidcounitalitylawtwice(onceontheleft,
onceontheright). Theassociativityofdrequiresthatφ2 dpφ1 dφq “ pφ2 dφ1qdφ, which
176
correspondstothefollowinggraphicalequation:
φ φ1 φ2 “ φ φ1 φ2
Toseethatthisequationissatisfied,simplyapplythecomonoidcoassociativitylawtwice(once
left,onceright).
Next,wecheckthathorizontalcomposition˝iswell-defined,whichamountstocheckingwhether
thehorizontalcompositeof2-cellssatisfiesthechangeofcoparameteraxiom. Again,wereason
graphically. Given2-cellsφandγ betweencomposablepairsof1-cellsf,f1 andg,g1,ourtaskisto
verifythat
M1
M1
B
B γ ˝φ
N1
N1
A f1 g1 “ A f g .
C C
Sinceφandγsatisfychangeofcoparameterexhypothesi,thelefthandsideisequaltothemorphism
M1
B
N1
φ γ
A
f g .
C
177
Bycomonoidcoassociativity,thisisinturnequalto
M1
φ
B
N1
γ
A
f g
C
which,bythedefinitionof˝,ispreciselyequalto
M1
B
γ ˝φ
N1
A
f g
C
andsothisestablishestheresult.
We now verify that ˝ so defined is functorial on 2-cells, beginning with the preservation of
composition. We need to validate the equation pγ1 ˝φ1qdpγ ˝φq “ pγ1 dγq˝pφ1 dφq (for
appropriatelycomposable2-cells). Thisamountstocheckingthefollowingequation,whichcanbe
seentoholdbytwoapplicationsofcomonoidcoassociativity:
A
A
M M2
φ φ1
M φ1 M2
φ
B B B B
“
N N2
γ
γ1
N N2
C γ γ1
C
Itiseasytoverifythat˝preservesidentities,i.e. thatid ˝id “ id ;justsubstitutetheidentity
g f g˝f
2-cellsintothedefinitionof˝on2-cells,andapplycomonoidcounitalityfourtimes.
178
Next,weestablishthathorizontalcompositionisweaklyassociative,whichrequiresustosupply
isomorphisms α : ph˝gq˝f ñ h˝pg ˝fq natural in composable triples of 1-cells h,g,f.
f,g,h
Supposingthethreemorphismshavethetypesf : A ÝÑ B,g : B ÝÑ C,andh : C ÝÑ D,wecan
M N O
choosea tobethe2-cellrepresentedbythemorphism
f,g,h
` ˘
proj
Ab pM bBqbppN bCqbOq bD ÝÝÑ pM bBqbppN bCqbOq ¨¨¨
αC
¨¨¨ ÝÝpM ÝÝbÝ BqÝ ,pÝ N ÝbÝ C Ýq, Ñ O ppM bBqbpN bCqqbO ¨¨¨
¨¨¨ Ý α Ý C pÝ M ÝbÝ B Ýq, Ý N Ý ,C Ý b Ý id ÝÑ O pppM bBqbNqbCqbO
where the first factor is the projection onto the coparameter and αC denotes the associator of
the monoidal structure pb,Iq on C. In the inverse direction, we can choose the component
α´1 : h˝pg˝fq ñ ph˝gq˝f tobethe2-cellrepresentedbythemorphism
f,g,h
` ˘
proj
Ab pppM bBqbNqbCqbO bD ÝÝÑ pppM bBqbNqbCqbO ¨¨¨
¨¨¨ Ý α Ý C pÝ M ,´ Ýb 1 Ý B Ýq, Ý N Ý ,C Ý b Ý id ÝÑ O ppM bBqbpN bCqqbO ¨¨¨
αC,´1
¨¨¨ ÝÝpM ÝÝbÝ BqÝ ,pÝ N ÝbÝ C Ýq, Ñ O pM bBqbppN bCqbOq
whereαC,´1 denotestheinverseoftheassociatoronpC,b,Iq. Thatthepairofα andα´1
f,g,h f,g,h
constitutes an isomorphism in the hom category follows from the counitality of the comonoid
structures. Thatthisfamilyofisomorphismsismoreovernaturalfollowsfromthenaturalityofthe
associatoronpC,b,Iq.
WecometothematterthatmotivatedtheconstructionofCopara pCq: theweakunitalityof
2
copy-composition,witnessedherebytheweakunitalityofhorizontalcomposition. Weneedto
exhibittwofamiliesofnaturalisomorphisms: theleftunitorswithcomponentsλ : id ˝f ñ f,
f B
andtherightunitorswithcomponentsρ : f˝id ñ f,foreachmorphismf : A ÝÑ B.Eachsuch
f A
M
componentwillbedefinedbyaprojectionmorphism,andweakunitalitywillthenfollowfromthe
counitalityofthecomonoidstructures.Moreexplicitly,λ iswitnessedbyproj : AbMbBbB Ñ
f M
M; its inverse λ´1 is witnessed by proj : A b M b B Ñ M b B; ρ is witnessed by
f MbB f
proj : AbAbMbB Ñ M;anditsinverseρ´1iswitnessedbyproj : AbMbB Ñ AbM.
M f AbM
Checkingthatthesedefinitionsgivenaturalisomorphismsisthenanexerciseincounitalitythat
weleavetothereader.
AllthatremainsoftheproofthatCopara pCqisindeedabicategoryistocheckthattheunitors
2
arecompatiblewiththeassociator(i.e.,pid ˝λ qdα “ ρ ˝id )andthatassociativityisorder-
g f g,idB,f g f
dependent(i.e.,theassociatorαsatisfiesthepentagondiagram). Thelatterfollowsimmediately
179
fromthecorrespondingfactabouttheassociatorαC onpC,b,Iq. Todemonstratetheformer,itis
easiertoverifythatpid ˝λ qdα dpρ´1˝id q “ id . Thisamountstocheckingthatthe
g f g,idB,f g f g˝f
followingstringdiagramisequallyadepictionofthemorphismunderlyingid :
g˝f
A
M
id f λ M
f
B
B
N
ρ´1
g
N
id
C g
(Note that here we have elided the associator from the depiction. This is allowed by comonoid
counitality, and because string diagrams are blind to bracketing.) Substituting the relevant
morphismsintotheboxes,weseethatthisdiagramisequalto
A
M M
B
B
N
N
C
andsixapplicationsofcounitalitygiveusid . ThisestablishesthatCopara pCqisabicategory.
g˝f 2
Remark 5.2.2. When C is symmetric monoidal, Copara pCq inherits a monoidal structure,
2
elaboratedinProposition5.4.1.
Remark 5.2.3. In order to capture the bidirectionality of Bayesian inversion we will need to
considerleft-andright-handedversionsoftheCopara construction. Theseareformallydual,
2
and when C is symmetric monoidal (as in most examples) they are isomorphic. Nonetheless, it
makesformalizationeasierifweexplicitlydistinguishCoparalpCq,inwhichthecoparameteris
2
placedontheleftofthecodomain(asabove),fromCopararpCq,inwhichitisplacedontheright.
2
Asidefromtheswappingofthishandedness,therestoftheconstructionisthesame.
180
Weendthissectionwiththreeeasy(andambidextrous)propositionsrelatingCandCopara pCq.
2
Proposition 5.2.4. There is an identity-on-objects lax embedding p´q : C ãÑ Copara pCq,
2
mappingf : X Ñ Y tof : X ÑÝ Y,which(intheleft-handedcase)hastheunderlyingmorphism
I
X ÝÑ f Y Ý λ Ý ´ YÑ 1 I b Y (where λ is the left unitor of the monoidal structure on C). The laxator
ιpgq˝ιpfq Ñ ιpg˝fqdiscardsthecoparameterobtainedfromcopy-composition.
Remark5.2.5. Wewilldefinethenotionoflaxfunctor inDefinition5.2.8below. Alaxembedding
is a lax functor that is an embedding in the sense of Remark 2.4.5: that is, a lax functor that is
faithfulonhomcategories.
Proposition 5.2.6. There is a ‘discarding’ functor p´q : Copara pCq Ñ C, which takes any
2
coparameterizedmorphismanddiscardsthecoparameter.
Proposition5.2.7. p´q isasectionofp´q . Thatis,id “ C ãÝ p Ý ´ ÝÑ q Copara pCq Ý p Ý ´ Ý q Ñ C;more
C 2
suggestively,thiscanbewrittenp´q “ p´q .
5.2.2. Laxfunctors,pseudofunctors,theirtransformations,andindexed
bicategories
Inordertodefinebicategoriesofstatisticalgames,coherentlywithlossfunctionsliketherelative
entropy that compose by copy-composition, we first need to define coparameterized (copy-
composite) Bayesian lenses. Analogously to non-coparameterized Bayesian lenses, these will
beobtainedbyapplyingaGrothendieckconstructiontoanindexedbicategory[19,Def. 3.5]of
state-dependentchannels,Stat . Constructingcopy-compositeBayesianlensesinthiswayisthe
2
subjectof§5.2.3;inthissection,wesupplythenecessaryhigher-categoricalprerequisites.
AnindexedcategoryisahomomorphismofbicategorieswithcodomainCatandlocallytrivial
domain, and analogously an indexed bicategory will be a homomorphism of tricategories with
codomainBicat(appropriatelydefined)andlocally‘2-trivial’domain. Inordertostayascloseas
possibletothematterathand,wedonotgivehereanexplicitdefinitionof‘tricategory’orindeed
of ‘indexed bicategory’, and instead refer the reader to [19, §3]. The definition of Stat will of
2
courseprovideanexampleofanindexedbicategory,butinordertostateitwewillnonetheless
needtoextendthenotionofpseudofunctorfromDefinition4.2.10tothecasewherethedomainis
atruebicategory;andwewillalsoneedmorphismsofpseudofunctors,calledpseudonatural (or
strong)transformations.
181
We will begin by defining the notion of lax functor, of which pseudofunctors constitute a
special case. Just as a lax monoidal functor F is equipped with a natural family of morphisms
FpXqbFpYq Ñ FpX bYq(thelaxator; cf. Definition3.1.11), alaxfunctorisaweakfunctor
equippedwithanaturalfamilyof2-cellsFpgq˛Fpfq ñ Fpg˝fq;thislaxfunctoriality willbe
importantwhenwecometostudylossmodelsin§5.3.2.
Definition5.2.8(JohnsonandYau[145,Def. 4.1.2]). SupposeB andC arebothbicategories. Alax
functor F : B Ñ C isconstitutedby
1. afunctionF : B Ñ C on0-cells;
0 0 0
2. foreachpairof0-cellsa,b : B,afunctorF : Bpa,bq Ñ CpF a,F bq;
a,b 0 0
3. foreach0-cellb : B,anaturaltransformation
id
1 b Bpb,bq
F1
F
b,b
id
F0b CpF b,F bq
0 0
witnessinglaxunity,withcomponent2-cellsF : id ñ F pid q;
b F0b b,b b
4. foreachtripleof0-cellsa,b,c : B,anaturaltransformation
Bpb,cqˆBpa,bq ˝ Bpa,cq
F2
F b,cˆF a,b Fa,c
CpF b,F cqˆCpF a,F bq ˛ CpF a,F cq
0 0 0 0 0 0
witnessinglaxfunctoriality andcalledthelaxator 4,withcomponent2-cells
F : F pgq˛F pfq ñ F pg˝fq
g,f b,c a,b a,c
where˝and˛denotehorizontalcompositioninB andC respectively;
satisfyingthefollowingconditions:
4Byanalogywiththelaxatorofalaxmonoidalfunctor(Definition3.1.11).Sincemonoidalcategoryisaspecialcaseof
bicategory,thenotionoflaxfunctor(betweenbicategories)generalizesthenotionoflaxmonoidalfunctor(between
monoidalcategories).
182
(a) coherencewiththeleftandrightunitalityofhorizontalcomposition,sothatforall1-cells
f : a Ñ bthefollowingdiagramscommute:
λC ρC
id ˛F pfq
Fa,bpfq
F pfq F pfq˛id
Fa,bpfq
F pfq
F0b a,b a,b a,b F0a a,b
F b˛F a,bpfq F a,bpλB
f
q F a,bpfq˛Fa F a,bpρB
f
q
F pid q˛F pfq F idb,f F pid ˝fq F pfq˛F pid q F f,ida F pf ˝id q
b,b b a,b a,b b a,b a,a a a,b a
whereλB,λC andρB,ρC aretheleftandrightunitorsforthehorizontalcompositioninB
andC respectively;
(b) coherencewiththeassociativityofhorizontalcomposition,sothatforall1-cellsf : a Ñ b,
g : b Ñ c,andh : c Ñ d,thefollowingdiagramcommutes:
αC
pF phq˛F pgqq˛F pfq
Fc,dphq,Fb,cpgq,Fa,bpfq
F phq˛pF pgq˛F pfqq
c,d b,c a,b c,d b,c a,b
F h,g˛F a,bpfq F c,dphq˛F
g,f
F ph˝gq˛F pfq F phq˛F pg˝fq
b,d a,b c,d a,c
F F
h˝g,f h,g˝f
F pph˝gq˝fq
F a,dpαB
h,g,f
q
F ph˝pg˝fqq
a,d a,d
whereαB andαC aretheassociatorsforthehorizontalcompositioninB andC respectively.
Apseudofunctor isalaxfunctorF forwhichF andF arenaturalisomorphisms5.
1 2
Thevariablelaxnessoflaxfunctorsisrecapitulatedinthelaxnessoftheirmorphisms;again,we
beginwiththeweakestcase.
Definition 5.2.9. Suppose F and G are lax functors B Ñ C. A lax transformation α : F Ñ G
consistsof
1. a1-cellα : Fb Ñ GbinC foreach0-cellb : B;
b
2. anaturaltransformationα : α ˚G ñ α F (whereα ˚ denotespre-compositionbyα ,
b,c b c˚ b b
andα denotespost-compositionbyα )foreachpairb,cofobjectsinB,withcomponent
c˚ c
5CompareDefinition4.2.10,treatingCthereasabicategorywithdiscretehom-categories.
183
2-cells
Ff
Fb Fc
α
α b f αc
Gf
Gb Gc
foreach1-cellf : b Ñ cinB;
satisfyingconditionsoflaxunityandlaxnaturalitywhoseprecisegeneralformthereadermay
findinJohnsonandYau[145,Def. 4.2.1].
Astrongtransformation(orpseudonaturaltransformation)isalaxtransformationforwhichthe
component2-cellsconstitutenaturalisomorphisms.
It is notable that, unlike natural transformations, lax transformations do not compose, not
evenlaxly;seeJohnsonandYau[145,Motivation4.6.1]. Thismeansthatthereisnobicategory
of bicategories, lax functors, and lax transformations, analogous to Cat. However, strong
transformations between pseudofunctors do compose, weakly, up to isomorphism. These
isomorphismscollectinto3-cellsknownasmodifications,producingatricategory Bicatwhose
0-cells are bicategories, 1-cells are pseudofunctors, 2-cells strong transformations, and 3-cells
modifications. Thistricategoryconstitutesthecodomainofanindexedbicategory.
Remark5.2.10. Thereisanothernotionofcomposablemorphismbetweenlaxfunctors,calledicon,
whichyieldsabicategoryBicat ofbicategories,laxfunctors,andicons. Iconsare,however,more
ic
restrictivethanlaxtransformations,astheir1-cellcomponentsmustbeidentities. Nonetheless,
thisrestrictionissatisfiedbylossmodelsasdefinedin§5.3.2,andsomorphismsoflossmodelswill
beicons.
5.2.3. CoparameterizedBayesianlenses
Withthatcategoricalbackgroundoutoftheway,weareabletodefinecopy-compositeBayesian
lenses,startingwiththecorrespondingindexedbicategory. Letdisc denotethefunctorSet Ñ Cat
takingsetstodiscretecategories(cf. Definition4.2.2).
Definition5.2.11. WedefinetheindexedbicategoryStat : CoparalpCqcoop Ñ Bicatfibrewise
2 2
asfollows.
(i) The0-cellsStat pXq ofeachfibreStat pXqaretheobjectsC ofC.
2 0 2 0
(ii) Foreachpairof0-cellsA,B,thehom-categoryStat pXqpA,Bqisdefinedtobethefunctor
2
` ˘
categoryCat discCpI,Xq,CopararpCqpA,Bq .
2
184
(iii) Foreach0-cellA,theidentityfunctorid : 1 Ñ Stat pXqpA,Aqistheconstantfunctoron
A 2
theidentityonAinCopararpCq;i.e. discCpI,Xq ÑÝ ! 1 Ý i Ý d ÑA CopararpCqpA,Aq.
2 2
(iv) ForeachtripleA,B,C of0-cells,thehorizontalcompositionfunctor˝ isdefinedby
A,B,C
˝ : Stat pXqpB,CqˆStat pXqpA,Bq ¨¨¨
A,B,C 2 2
` ˘ ` ˘
¨¨¨ ÝÑ “ Cat discCpI,Xq,CopararpCqpB,Cq ˆCat discCpI,Xq,CopararpCqpA,Bq ¨¨¨
2 2
` ˘
¨¨¨ ÝÑ ˆ Cat discCpI,Xq2,CopararpCqpB,CqˆCopararpCqpA,Bq ¨¨¨
2 2
´ ¯
` ˘
Cat ,˝
¨¨¨ ÝÝÝÝÝÝÑ Cat discCpI,Xq,CopararpCqpA,Cq ¨¨¨
2
“
¨¨¨ ÝÑ Stat pXqpA,Cq
2
whereCatp ,˝qindicatespre-compositionwiththeuniversal(Cartesian)copyingfunctorin
pCat,ˆ,1qandpost-compositionwiththehorizontalcompositionfunctorofCopararpCq.
2
Foreachpairof0-cellsX,Y inCoparalpCq,wedefinethereindexingpseudofunctorStat :
2,X,Y
` ˘
CoparalpCqpX,Yqop Ñ Bicat Stat pYq,Stat pXq asfollows.
2 2
(a) Foreach1-cellf inCoparalpCqpX,Yq,weobtainapseudofunctorStat pfq : Stat pYq Ñ
2 2
Stat pXqwhichactsastheidentityon0-cells.
2
(b) Foreachpairof0-cellsA,BinStat pYq,thefunctorStat pfq isdefinedastheprecompo-
2 2 A,B
` ˘
sitionfunctorCat discCpI,f q,CopararpCqpA,Bq ,wherep´q isthediscardingfunctor
2
CoparalpCq Ñ C ofProposition5.2.6.
2
(c) For each 2-cell φ : f ñ f1 in CoparalpCqpX,Yq, the pseudonatural transformation
2
Stat pφq : Stat pf1q ñ Stat pfqisdefinedon0-cellsA : Stat pYqbythediscretenatural
2 2 2 2
transformationwithcomponentsStat pφq :“ id ,andon1-cellsc : Stat pYqpA,Bqby
2 A A 2
thesubstitutionnaturaltransformationwithconstitutent2-cellsStat pφq : Stat pfqpcq ñ
2 c 2
` ˘
Stat pf1qpcqinStat pXqwhichactsbyreplacingCat discCpI,f q,CopararpCqpA,Bq
2 2 2
` ˘
by Cat discCpI,f1 q,CopararpCqpA,Bq ; and which we might alternatively denote by
2
` ˘
Cat discCpI,φ q,CopararpCqpA,Bq .
2
Notation5.2.12. Wewillwritef : AÝ X Ñ‚ B todenoteastate-dependentcoparameterizedchannel
M
f withcoparameterM andstate-dependenceonX.
Remark5.2.13. WecouldgiveanalternativedefinitionofStat ,forwhichthedefinitionabove
2
wouldgiveasub-indexedbicategory,bydefiningthestate-dependenceonthewholehom-category
185
Copara pCqpI,Xq rather than just CpI,Xq. However, doing this would cause the reindexing
2
pseudofunctorstointroducecoparameters(fromthenow-coparameterizedpriors),whichwould
contradict the type signature of coparameterized Bayesian inversion: imagine the equation of
Definition5.2.18belowbutwithoutthediscardingontheright-handside.
Remark5.2.14. Similarly,thesamedefinitionswouldgothroughuponsubstitutingCoparapCq
forCopara pCq;but,asnotedabove,weneedcopy-compositionfortherelativeentropy.
2
Aswesawin§4.2.2,lensesin1-categorytheoryaremorphismsinthefibrewiseoppositeofa
fibration. Analogously,ourbicategoricalBayesianlensesareobtainedas1-cellsinthebicategorical
Grothendieckconstructionof(thepointwiseoppositeof)theindexedbicategoryStat ;thisyields
2
a2-fibration. Soasnottoover-complicatethepresentation,wedonotpresentallthedetailsofthis
construction,andreferthereaderinsteadtoBaković[19,§6].
Definition5.2.15. Fixacopy-discardcategorypC,b,Iq. Wedefinethebicategoryofcoparameter-
izedBayesianlensesinC,denotedBayesLens pCqorsimplyBayesLens ,tobethebicategorical
2 2
Grothendieck construction of the pointwise opposite of the corresponding indexed bicategory
Stat ,withthefollowingdata:
2
(i) A0-cellinBayesLens isapairpX,AqofanobjectX inCoparalpCqandanobjectAin
2 2
Stat pXq;equivalently,a0-cellinBayesLens isapairofobjectsinC.
2 2
` ˘
(ii) Thehom-categoryBayesLens pX,Aq,pY,Bq istheproductcategoryCoparalpCqpX,Yqˆ
2 2
Stat pXqpB,Aq.
2
(iii) TheidentityonpX,Aqisgivenbythepairpid ,id q.
X A
(iv) Foreachtripleof0-cellspX,Aq,pY,Bq,pZ,Cq,thehorizontalcompositionfunctorisgiven
186
by
` ˘ ` ˘
BayesLens pY,Bq,pZ,Cq ˆBayesLens pX,Aq,pY,Bq
2 2
“ CoparalpCqpY,ZqˆStat pYqpC,BqˆCoparalpCqpX,YqˆStat pXqpB,Aq
2 2 2 2
ÿ ÿ
„
ÝÑ Stat pYqpC,BqˆStat pXqpB,Aq
2 2
g:CoparalpCqpY,Zqf:CoparalpCqpX,Yq
2 2
ř ř ÿ ÿ
ÝÝÝgÝÝfÝ St Ý a Ý t2 Ý pf Ý q Ý C Ý ,B Ý ˆ ÝÑ id Stat pXqpC,BqˆStat pXqpB,Aq
2 2
g:CoparalpCqpY,Zqf:CoparalpCqpX,Yq
2 2
ř
ÝÝ˝Ý C Ý o Ý pa Ý r Ý al 2Ý pC Ý q Ý ˝ Ý St Ý at Ý 2p Ý X Ñ q ÿ Stat pXqpC,Aq
2
g˝f:CoparalpCqpX,Zq
2 ` ˘
„
ÝÑ BayesLens pX,Aq,pZ,Cq
2
where the functor in the penultimate line amounts to the product of the horizontal
compositionfunctorsonCoparalpCqandStat pXq.
2 2
Proposition5.2.16. Thereisaprojectionpseudofunctorπ : BayesLens pCq Ñ CoparalpCq
Lens 2 2
mapping each 0-cell pX,Aq to X, each 1-cell pf,f1q to f, and each 2-cell pφ,φ1q to φ. This
pseudofunctorisa2-fibrationinthesenseofBaković[19,Def. 4.7].
Proof. TheclaimfollowsasaconsequenceofBaković[19,Theorem6.2].
Remark5.2.17. WhenCissymmetricmonoidal,Stat acquiresthestructureofamonoidalindexed
2
bicategory (Definition 5.4.2 and Theorem 5.4.4), and hence BayesLens becomes a monoidal
2
bicategory(Corollary5.4.5).
5.2.4. CoparameterizedBayesianupdatescomposeoptically
So that our generalized Bayesian lenses are worthy of the name, we should also confirm that
Bayesian inversions compose according to the lens pattern (‘optically’) in the coparameterized
setting. Suchconfirmationisthesubjectofthepresentsection.
Definition5.2.18. Wesaythatacoparameterizedchannelγ : AÑ‚ MbBadmitsBayesianinversion
187
ifthereexistsaduallycoparameterizedchannelρ
π
: BÑ‚ AbM satisfyingthegraphicalequation
A M B A M B
γ “ ρ π .
γ
π
π
Inthiscase,wesaythatρ istheBayesianinversionof γ withrespecttoπ.
π
Withthisdefinition,wecansupplythedesiredresultthat“coparameterizedBayesianupdates
composeoptically”.
Theorem 5.2.19. Suppose pγ,γ:q : pA,AqÝÑpB,Bq and pδ,δ:q : pB,BqÝÑpC,Cq are
| |
M N
coparameterized Bayesian lenses in BayesLens
2
. Suppose also that π : IÑ‚ A is a state on
AintheunderlyingcategoryofchannelsC,suchthatγ: isaBayesianinversionofγ withrespect
π
toπ,andsuchthatδ: isaBayesianinversionofδ withrespecttopγπq ;wherethenotationp´q
γπ
representsdiscardingcoparameters. Thenγ: ‚δ: isaBayesianinversionofδ‚γ withrespectto
π γπ
π. (Here‚denotescopy-composition.) Moreover,ifpδ‚γq : isanyBayesianinversionofδ‚γ with
π
respecttoπ,thenγ: ‚δ: ispδγπq -almost-surelyequaltopδ‚γq :: thatis,pδ‚γq : pδγ „ πq γ: ‚δ: .
π γπ π π π γπ
Proof. Weonlyneedtoshowthatγ: ‚δ: isaBayesianinversionofδ‚γ withrespecttoπ;the
π γπ
‘moreover’claimfollowsimmediatelybecauseBayesianinversionsarealmostsurelyunique(by
Proposition4.1.29). Thus,δ‚γ ‚π hasthefollowingdepiction;
A M B N C
δ
γ
π
188
Sinceγ: isaBayesianinversionofγ withrespecttoπ,thisisequalto
π
A M B N C
γ: δ
π
.
γ
π
Bythecoassociativityofcopying,thisinturnisequalto
A M B N C
γ: δ
π
.
γ
π
189
Andsinceδ: isaBayesianinversionofδ withrespecttopγπq ,thisisequalto
γπ
A M B N C
γ:
π
δ:
γπ
δ
γ
π
whichestablishestheresult.
InordertosatisfythiscoparameterizedBayes’rule,aBayesianlensmustbeof‘simple’type.
Definition 5.2.20. We say that a coparameterized Bayesian lens pc,c1q is simple if its domain
and codomain are ‘diagonal’ (duplicate pairs of objects) and if the coparameter of c is equal to
thecoparameterofc1. Inthiscase,wecanwritethetypeofpc,c1qaspX,XqÝÑpY,Yqorsimply
|
M
XÝÑY.
|
M
Remark5.2.21. InRemark5.2.13,weexplainedthatweshouldrestrictthetypeofstate-dependent
coparameterizedmorphismssothattheycoherewiththecoparameterizedBayes’ruleofDefinition
5.2.18. The restriction here to simple lenses is by contrast not enforced by the type system, an
oversightwhich(likethefailuretorestricttosupportsnotedinRemark4.1.20)iscomparatively
inelegant,butwhichisforceduponusbytheGrothendieckconstruction,whichdoesnothavea
placeforsuchconstraints. Weexpectthattheuseof(abicategoricalinstanceof)dependentoptics
[43,50,276]wouldallowsuchaconstrainttobeenforced(alongsidesupportobjects),atthecostof
requiringyetmorehigh-poweredcategoricalmachinery,ofwhichthereisprobablyenoughinthis
thesis. Wethereforeleavethisavenueunexploredfornow.
190
ByanalogywithCorollary4.3.15,wehavethefollowingimportantconsequenceofTheorem
5.2.19.
Corollary5.2.22. SupposeCoparalpCq:isasubbicategoryofCoparalpCqallofwhosechannels
2 2
admit Bayesian inversion. Then there is almost surely a pseudofunctor : : CoparalpCq: Ñ
2
BayesLens mappingeach1-celltoitsalmost-surelyuniquecorrespondingexactBayesianlens.
2
Moreover,:isasectionofthe2-fibrationπ : BayesLens Ñ CoparalpCqinducedbythe
Lens 2 2
bicategoricalGrothendieckconstruction.
5.3. Statistical games for local approximate inference
5.3.1. Attachinglossestolenses
StatisticalgamesareobtainedbyattachingtoBayesianlenseslossfunctions,representing‘local’
quantificationsoftheperformanceofapproximateinferencesystems. Becausethisperformance
depends on the system’s context (i.e., the prior π : IÑ‚ X and the observed data b : B), a loss
functionatitsmostconcretewillbeafunctionCpI,XqˆB Ñ R. TointernalizethistypeinC,we
mayrecallthat,whenC isthecategorysfKrnofs-finitekernelsortheKleislicategoryKℓpD q
ď1
ofthesubdistributionmonad6, adensityfunctionp
c
: X ˆY Ñ r0,1sforachannelc : XÑ‚ Y
correspondstoaneffect (orcostate)X bYÑ‚ I. Inthisway,wecanseealossfunctionasakindof
state-dependenteffect BÝ X Ñ‚ I (andnotacoparameterizedone).
Lossfunctionswillcomposebysum,andsoweneedtoaskfortheeffectsinC toformamonoid.
Moreover,weneedthismonoidtobe‘bilinear’withrespecttochannels,sothatStat-reindexing
(cf. Definition4.3.2)preservessums. Theseconditionsareformalizedinthefollowingdefinition.
Definition5.3.1. SupposepC,b,Iqisacopy-discardcategory. WesaythatC hasbilineareffectsif
thefollowingconditionsaresatisfied:
(i) effectmonoid:thereisanaturaltransformation` : Cp´,IqˆCp“,Iq ñ Cp´b“,Iqmaking
ř
CpA,Iqintoacommutativemonoidwithunit0 : IÑ‚ I;
A:C
(ii) bilinearity: pg`g1q‚ ‚f “ g‚f `g1‚f foralleffectsg,g1 andmorphismsf suchthat
pg`g1q‚ ‚f exists.
Example5.3.2. AtrivialexampleofacategorywithbilineareffectsissuppliedbyanyCartesian
category, such as Set, in which there is a unique effect for each object, so the effect monoid
6WeakenthedefinitionofthedistributionmonadD:SetÑSetsothatdistributionsmaysumtoanynumberinthe
unitinterval.
191
structureisgivenonlybytheproductofobjects,andbilinearityfollowsfromtheterminalityofthe
unitobject1.
Example5.3.3. WemighthopethatKℓpD qhasbilineareffects,butthisisnotthecase,because
ď1
the sum of two effects may exceed 1: the effects only form a partial monoid7. But if M is any
monoidinSet,thenthereisamonadD takingeachsetX tothesetD pXqofformalM-linear
M M
combinationsofelementsofX. ThisisthefreeM-moduleonX,justastraditionallyDX isthe
free convex space on X, and the monad structure is obtained from the adjunction in the same
way[137,§2]. AneffectYÑ‚ I thencorrespondstoafunctionY Ñ M,andthemonoidstructure
followsfromthemonoidstructureonM;bilinearityfollowsfromthelinearityofthe(free)module
structure:
ÿ` ˘
pg`g1q‚ ‚fpxq “ gpyq`g1pyq ¨fpy|xq
ÿy
“ gpyq¨fpy|xq`g1pyq¨fpy|xq
ÿy ÿ
“ gpyq¨fpy|xq` g1pyq¨fpy|xq
y y
“ g‚fpxq`g1‚fpxq
Example5.3.4. ThecategorysfKrnofs-finitekernels[270]hasbilineareffects. AneffectYÑ‚ I
isameasurablefunctionY Ñ r0,8s,andbilinearityfollowsfromthelinearityofintegration:
ż
` ˘
pg`g1q‚ ‚fpxq “ gpyq`g1pyq fpdy|xq
ży
“ gpyqfpdy|xq`g1pyqfpdy|xq
ży ż
“ gpyqfpdy|xq` g1pyqfpdy|xq
y y
“ g‚fpxq`g1‚fpxq
WewilltypicallyassumesfKrnasourambientC fortheexamplesbelow.
Example5.3.5. GivenacategoryC withbilineareffects,wecanliftthenaturaltransformation`,
andhencethebilineareffectstructure,tothefibresofStat ,usingtheuniversalpropertyofthe
C
7Indeed,aneffectalgebraisakindofpartialcommutativemonoid[141,§2],butwedonotneedtheextracomplication
here.
192
productofcategories:
` ˘ ` ˘
` : StatpXqp´,IqˆStatpXqp“,Iq ùù Set CpI,Xq,Cp´,Iq ˆSet CpI,Xq,Cp“,Iq
X
` ˘
p¨,¨q
ùùñ Set CpI,Xq,Cp´,IqˆCp“,Iq
` ˘
` ˘
Set CpI,Xq,`
ùùùùùùùùùùñ Set CpI,Xq,Cp´b“,Iq
“
ùñ StatpXqp´b“,Iq
Here,p¨,¨qdenotesthepairingoperationobtainedfromtheuniversalproperty. Inthisway,each
StatpXqhasbilineareffects. Notethatthisliftingis(strictly)compatiblewiththereindexingofStat,
sothat` definesanindexednaturaltransformation. Thismeansinparticularthatreindexing
p´q
distributesoversums: givenstate-dependenteffectsg,g1 : BÝÑ Y ‚ I andachannelc : XÑ‚ Y,wehave
pg` g1q “ g ` g1. Wewillthusgenerallyomitthesubscriptfromtheliftedsumoperation,
Y c c X c
andjustwrite`.
Wearenowreadytoconstructthebicategoryofstatisticalgames.
Definition 5.3.6. Suppose pC,b,Iq has bilinear effects, and let BayesLens denote the
2
correspondingbicategoryof(copy-composite)Bayesianlenses. WewillwriteSGame todenote
C
thefollowingbicategoryof(copy-composite)statisticalgamesinC:
• The0-cellsarethe0-cellspX,AqofBayesLens ;
2
• the 1-cells, called statistical games, pX,Aq Ñ pY,Bq are triples pc,c1,Lcq consisting of a
1-cellpc,c1q : pX,Aq ÑÞ pY,BqinBayesLens
2
andalossLc : BÝ X Ñ‚ I inStatpXqpB,Iq;
• given1-cellspc,c1,Lcq,pe,e1,Leq : pX,Aq Ñ pY,Bq,the2-cellspc,Lcq ñ pe,Leqarepairs
pα,Kαq of a 2-cell α : pc,c1q ñ pe,e1q in BayesLens
2
and a loss Kα : BÝ X Ñ‚ I such that
Lc “ Le`Kα;
• theidentity2-cellonpc,c1,Lcqispid ,0q;
pc,c1q
• given 2-cells pα,Kαq : pc,c1,Lcq ñ pd,d1,Ldq and pβ,Kβq : pd,d1,Ldq ñ pe,e1,Leq,
theirverticalcompositeispβ˝α,Kβ `Kαq,where˝heredenotesverticalcompositionin
BayesLens ;
2
• given1-cellspc,c1,Lcq : pX,Aq Ñ pY,Bqandpd,d1,Ldq : pY,Bq Ñ pZ,Cq,theirhorizontal
` ˘
compositeis pd,d1q pc,c1q,Ld`Lc˝d1 ;and
c c
(cid:11)
193
– given2-cellspα,Kαq : pc,c1,Lcq ñ pe,e1,Leqandpβ,Kβq : pd,d1,Ldq ñ pf,f1,Lfq,
theirhorizontalcompositeispβ α,Kβ `Kα˝d1q,where heredenoteshorizontal
c c
(cid:11) (cid:11)
compositioninBayesLens .
2
Remark5.3.7. Inearlierwork(suchasversions1and2ofourpreprint[250]),wegaveamore
elaborate but less satisfying definition of “statistical game”, as a Bayesian lens equipped with a
functionfromits‘context’toR(whichwealsocalledalossfunction). Theconstructiongivenhere
showsthatthecomplicatedearliernotionofcontext,whichfollowstheideasof‘Bayesianopen
games’[36],isactuallyunnecessaryforthepurposesofstatisticalgames. ConsideringaBayesian
lens in KℓpDq of type pX,Aq Ñ pY,Bq, its ‘context’ is an element of DX ˆSetpDY,DBq. By
comparison,acorrespondinglossfunctionofthetypegivenaboveisequivalentlyafunctionwith
domainDX ˆB,andsowehavereplacedthedependenceon‘continuations’inSetpDY,DBq
withasimpledependenceonB.
Theorem5.3.8. Definition5.3.6generatesawell-definedbicategory.
The proof of this result is that SGame is obtained via a pair of bicategorical Grothendieck
C
constructions: first to obtain Bayesian lenses; and then to attach the loss functions. The proof
dependsonthefollowingintermediateresultthatoureffectmonoidscanbe‘upgraded’tomonoidal
categories; we then use the delooping of this structure to associate (state-dependent) losses to
(state-dependent)channels,afterdiscardingthecoparametersofthelatter.
Lemma 5.3.9. Suppose pC,b,Iq has bilinear effects. Then, for each object B, CpB,Iq has the
structureofasymmetricmonoidalcategory. TheobjectsofCpB,Iqareitselements,theeffects.
Ifg,g1 aretwoeffects,thenamorphismκ : g Ñ g1 isaneffectsuchthatg “ g1`κ;theidentity
morphismforeacheffectid isthentheconstant0effect. Likewise,thetensoroftwoeffectsistheir
g
sum,andthecorrespondingunitistheconstant0. Precompositionbyanymorphismc : AÑ‚ B
preservesthemonoidalcategorystructure,makingthepresheafCp´,Iqintoafibrewise-monoidal
indexedcategoryCop Ñ MonCat(cf. Remark4.2.21).
Asalreadyindicated,thisstructureliftstothefibresofStat.
Corollary 5.3.10. For each object X in a category with bilinear effects, and for each object
B,StatpXqpB,IqinheritsthesymmetricmonoidalstructureofCpB,Iq;notethatmorphismsof
state-dependenteffectsarelikewisestate-dependent,andthattensoring(summing)state-dependent
effectsinvolvescopyingtheparameterizingstate. Moreover,Statp´qp“,Iqisafibrewise-monoidal
ř
indexedcategory StatpXqop Ñ MonCat.
X:Cop
194
Using this corollary, we can give the abstract proof of Theorem 5.3.8. There are two further
observations of note: first, that we can deloop a monoidal category into a bicategory with one
object;second,thatwecanextendStatp´qp“,IqtoStat viadiscarding.
2
Proofof5.3.8. RecallfromProposition3.1.24thateverymonoidalcategoryMcanbetransformed
into a one-object bicategory, its delooping BM, with the 1-cells and 2-cells being the objects
andmorphismsofM,verticalcompositionbeingcompositioninM,andhorizontalcomposition
beingthetensor. Thisdeloopingisfunctorial,givinga2-functorB : MonCat Ñ Bicatwhich,
following Corollary 5.3.10, we can compose after Statp´qp“,Iq (taking its domain as a locally
discrete2-category)toobtainindexedbicategories;wewillassumethistransformationhenceforth.
ř
Next,observethatwecanextendthedomainofStatp´qp“,Iqto Stat pXqcoop
X:CoparalpCqcoop 2
2
bydiscardingthecoparametersofthe(coparameterized)state-dependentchannelsaswellasthe
coparameteronanyreindexing,asinthefollowingdiagramofindexedbicategories:
ř
Stat pXqcoop
X:CoparalpCqcoop 2
2
ř Stat2p´qp“,Iq
ř
StatpXqop Bicat
X:Cop
Statp´qp“,Iq
Here,the2-cellindicatesalsodiscardingthecoparametersofthe‘effects’inStat p´qp“,Iq.
2
IfweletLdenotethecompositefunctorinthediagramabove,wecanreasonasfollows:
ř
L : Stat pXqcoop Ñ Bicat
X:CoparalpCqcoop 2
ś 2 sum/product
BicatStat2pXqcoop
śX:Coparal
2
pCqcoop śş
2FibpStat pXqq
X:CoparalpCqcoop 2
2 forget
CoparalpCqcoop Ñ Bicat
2 op
G : CoparalpCqcoop Ñ Bicat
2
wherethefirststepusestheadjointnessof(dependent)sumsandproducts;thesecondappliesthe
bicategoricalGrothendieckconstructioninthecodomain;thethirdforgetsthe2-fibrations,toleave
onlythetotalbicategory;andthefourthsteptakesthepointwiseopposite. Wecanthuswritethe
`ş ˘
actionofGasGpXq “ LpX,´q op.
SinceeachbicategoryLpX,Bqhasonlyasingle0-cell,the0-cellsofeachGpXqareequivalently
justtheobjectsofC,andthehom-categoriesGpXqpA,Bqareequivalenttotheproductcategories
Stat pXqpB,AqˆStatpXqpB,Iq. That is to say, a 1-cell A Ñ B in GpXq is a pair of a state-
2
dependentchannelBÝ X Ñ‚ Aalongwithacorrespondinglystate-dependenteffectonitsdomainB.
We therefore seem to approach the notion of statistical game, but in fact we are already there:
195
ş
SGame issimply G,bythebicategoricalGrothendieckconstruction. Toseethisisonlyamatter
C
offurtherunfoldingthedefinition.
Remark5.3.11. Therearetwonotabledetailsthattheabstractnessoftheprecedingproofobscures.
Firstly,thehorizontalcompositionofeffectsinSGame isstrict. Toseethis,letpc,ιq : A Ñ B
C
andpd,κq : B Ñ C andpe,λq : C Ñ Dbe1-cellsinGpXq,andforconcisionwritethehorizontal
compositeofeffectsbyconcatenation,sothatκι “ κ`ι˝d (bytheGrothendieckconstruction).
Thenstrictassociativitydemandsthatλpκιq “ pλκqι. Thisobtainsasfollows:
λpκιq “ λ`pκιq˝e byGrothendieck
“ λ`pκ`ι˝d q˝e byGrothendieck
“ λ`pκ˝e `ι˝d ˝e q bybilinearity
“ λ`pκ˝e `ι˝pd˝eq q byfunctoriality
“ λ`pκ˝e `ι˝pe˝opdq q by“pointwiseopposite”
“ pλ`κ˝e q`ι˝pe˝opdq bymonoidassociativity
“ pλκqι byGrothendieck
Sincetheidentityeffectistheconstant0,itiseasytoseethathorizontalcompositionisstrictly
unitaloneffects:
0κ “ 0`κ˝id “ κ “ κ`0˝d “ κ0
Secondly, note that the well-definedness of horizontal composition in SGame depends
C
furthermoreonthedistributivityofreindexingoversums(cf. Example5.3.5). Supposewehave
1-cellsand2-cellsinSGame asinthefollowingdiagram:
C
pc,Lcq pd,Ldq
pX,Aq pα,Kαq pY,Bq pβ,Kβq pZ,Cq
pc1,Lc1
q
pd1,Ld1
q
Then,writing forhorizontalcompositioninSGame and˝forcompositioninStat (andleaving
C 2
(cid:11)
thediscardingofcoparametersimplicit):
Ld1 Lc1 “ pLd`Kβq pLc`Kαq exhypothesi
(cid:11) (cid:11)
“ pLd`Kβq `pLc`Kαq˝d byGrothendieck
c c
“ Ld`Kβ `pLc˝d q`pKα˝d q bydistributivityandbilinearity
c c c c
“ Ld`pLc˝d q`Kβ `pKα˝d q bycommutativityoftheeffectmonoid
c c c c
“ Ld Lc`Kβ Kα byGrothendieck
(cid:11) (cid:11)
196
Remark 5.3.12. Of course, we don’t strictly need to use BayesLens in the preceding; the
2
structureequallymakessenseifweworkonlywith‘marginalized’lensesinBayesLens. Inthis
case, although BayesLens is a 1-category, one still obtains 2-cells between statistical games,
becauseitremainspossibletoconsidertheirdifferences.
5.3.2. Inferencesystemsandlossmodels
Inthecontextofapproximateinference,oneoftendoesnothaveasinglestatisticalmodeltoevaluate,
butawholefamilyofthem. Inparticularlynicesituations,thisfamilyisactuallyasubcategory
D of C, with the family of statistical models being all those that can be composed in D. The
problemofapproximateinferencecanthenbeformalizedasfollows. SincebothBayesLens and
2
SGame wereobtainedbybicategoricalGrothendieckconstructions,wehaveapairof2-fibrations
C
SGame Ý π ÝLÝoÑss BayesLens Ý π ÝLÝeÑns CoparalpCq.Eachofπ ,π ,andthediscardingfunctor
C 2 2 Loss Lens
p´q canberestrictedtothesubcategoryD. Theinclusionp´q : D ãÑ CoparalpDqrestrictsto
2
asectionofthisrestrictionofp´q ;theassignmentofinversionstochannelsinDthencorresponds
toa2-sectionofthe2-fibrationπ (restrictedtoD);andthesubsequentassignmentoflossesisa
Lens
further2-sectionofπ . Thissituationisdepictedinthefollowingdiagramofbicategories:
Loss
SGame SGame
D C
π Loss|D π Loss
BayesLens | BayesLens
2 D 2
π Lens|D π Lens
CoparalpDq CoparalpCq
2 2
|D
D C
Thismotivatesthefollowingdefinitionsofinferencesystemandlossmodel,although,forthesakeof
ourexamples,wewillexplicitlyallowtheloss-assignmenttobelax: ifLisalossmodelandcandd
arecomposablelenses,thenratherthananequalityornaturalisomorphismLpdq˛Lpcq – Lpd cq,
(cid:11)
wewillonlyrequireanaturaltransformationLpdq˛Lpcq ñ Lpd cq.
(cid:11)
Before defining loss models and inference systems, it helps to recall the concept of essential
image: ageneralizationofthenotionofimagefromfunctionstofunctors.
Definition5.3.13([196]). SupposeF : C Ñ D isann-functor(apossiblyweakhomomorphism
ofweakn-categories). TheimageofF isthesmallestsub-n-categoryofD thatcontainsFpαqfor
allk-cellsαinC,alongwithanypk`1q-cellsrelatingimagesofcompositesandcompositesof
images, for all 0 ď k ď n. We say that a sub-n-category D is replete if, for any k-cells α in D
197
andβ inC (with0 ď k ă n)suchthatf : α ñ β isapk`1q-isomorphisminC,thenf isalsoa
pk`1q-isomorphisminD. TheessentialimageofF,denotedimpFq,isthenthesmallestreplete
sub-n-categoryofD containingtheimageofF.
Withtheseconceptsinmind,westateourdefinitions.
Definition5.3.14. SupposepC,b,Iqisacopy-deletecategory. AninferencesysteminC isapair
pD,ℓqofasubcategoryD ãÑ C alongwithasectionℓ : D Ñ BayesLens | ofπ | ,where
2 D Lens D
D istheessentialimageofthecanonicallaxinclusionp´q : D ãÑ CoparalpDq.
2
Definition5.3.15. SupposepC,b,IqhasbilineareffectsandBisasubbicategoryofBayesLens .
2
Alossmodel forB isalaxsectionLoftherestrictionπ | ofπ toB. WesaythatLisastrict
Loss B Loss
lossmodelifitisinfactastrict2-functor,andastrong lossmodelifitisinfactapseudofunctor.
Remark5.3.16. WemayoftenbeinterestedinlossmodelsforwhichB isinfacttheessential
imageofaninferencesystem,butwedonotstipulatethisrequirementinthedefinitionasitisnot
necessaryforthefollowingdevelopment.
InorderfortwolossmodelsF andGtobecomparable,theymustbothbesectionsofthesame
fibrationofstatisticalgames. OneconsequenceofthisisthatbothF andGmustmapeach0-cell
pX,Aq in the bicategory of lenses to the same 0-cell in the bicategory of games, which (by the
definitionofthebicategoryofgames)mustagainbepX,Aq. Insuchcircumstances,therelevant
typeofmorphismoflaxfunctorsistheicon,whosedefinitionwenowreview.
Definition5.3.17(JohnsonandYau[145,Def. 4.6.2]). SupposeF andGarelaxfunctorsB Ñ C
such that, for all b : B, Fb “ Gb. An icon (or identity component oplax natural transformation)
α : F Ñ Gconsistsofafamilyofnaturaltransformations
F
a,b
Bpa,bq α a,b CpFa,Fbq “ CpGa,Gbq
G
a,b
foreachpaira,bof0-cellsinB,satisfyingcoherenceconditionscorrespondingtounityandoplax
naturality,andwhosecomponent2-cellswewriteasα : Ff ñ Gf foreach1-cellf inB.
f
LaxfunctorsB Ñ C andiconsbetweenthemconstitutetheobjectsandmorphismsofacategory,
Bicat pB,Cq,whichwecanusetoconstructcategoriesoflossmodels. Moreover,owingtothe
ic
monoidalityof`,thiscategorywillbemoreovermonoidal: apropertythatwewillusetodefine
198
thefreeenergylossmodelbelow. (Notethatthismonoidalstructure,onthecategoryoflossmodels,
isdistinctfromthemonoidalstructurethatwewillattachtolossmodelsthemselvesin§5.4.)
Proposition5.3.18. LossmodelsforB constitutetheobjectsofasymmetricmonoidalcategory
` ˘
LosspBq,`,0 . ThemorphismsofLosspBqareiconsbetweenthecorrespondinglaxfunctors,and
theycomposeaccordingly. Themonoidalstructureisgivenbysumsoflosses.
Proofsketch. FromJohnsonandYau[145,Theorem4.6.13],weknowthaticonscompose,forming
the morphisms of a category. Next, note that for any two loss models F and G and any k-cell
α(foranyk P t0,1,2u),FpαqandGpαqmustonlydifferonthelosscomponent,andsowecan
sumthelosses;thisgivesthemonoidalproduct. Themonoidalunitisnecessarilytheconstant0
loss. Finally,observethatthestructureissymmetricbecauaseeffectmonoidsarecommutative(by
Definition5.3.1).
5.3.3. Examples
Eachofourexamplesinvolvestakingexpectationsoflog-densities,andsotomakesenseofthemit
firsthelpstounderstandwhatwemeanby“takingexpectations”.
Notation5.3.19(Expectations). Writtenasafunction,adensityponX hasthetypeX Ñ R ;
`
written as an effect, the type is XÑ‚ I. Given a measure or distribution π on X (equivalently, a
stateπ : IÑ‚ X),wecancomputetheexpectationofpunderπasthecompositep‚π. Wewritethe
“ ‰
resultingquantityasE rps,ormoreexplicitlyasE ppxq . Wecanthinkofthisexpectationas
π x„π
representingthe‘validity’(ortruthvalue)ofthe‘predicate’pgiventhestateπ [142].
5.3.3.1. RelativeentropyandBayesianinference
Forourfirstexample,wereturntothesubjectwithwhichweopenedthispaper: thecompositional
structureoftherelativeentropy. Webeginbygivingaprecisedefinition.
Definition 5.3.20. Suppose α,β are both measures on X, with α absolutely continuous with
respecttoβ. Thentherelativeentropy orKullback-Leiblerdivergencefromαtoβ isthequantity
” ı
D pα,βq :“ E log α ,where α istheRadon-Nikodymderivativeofαwithrespecttoβ.
KL α β β
Remark5.3.21. Whenαandβ admitdensityfunctionsp andp withrespecttothesamebase
α β
“ ‰
measuredx,thenD pα,βqcanequallybecomputedasE logp pxq´logp pxq . Ititthis
KL x„α α β
formthatwewilladopthenceforth.
199
Proposition 5.3.22. Let B be a subbicategory of simple lenses in BayesLens , all of whose
2
channelsadmitdensityfunctionswithrespecttoacommonmeasureandwhoseforwardchannels
admit Bayesian inversion (and whose forward and backward coparameters coincide), and with
onlystructural2-cells. ThentherelativeentropydefinesastrictlossmodelKL : B Ñ SGame.
Givenalenspc,c1q : pX,Xq ÑÞ pY,Yq,KLassignsthelossfunctionKLpc,c1q : YÝ X Ñ‚ I defined,for
` ˘
π : IÑ‚ X andy : Y,bytherelativeentropyKLpc,c1q
π
pyq :“ D
KL
c1
π
pyq,c:
π
pyq ,wherec: isthe
exactinversionofc.
Proof. Beingasectionofπ | ,KLleaveslensesunchanged,onlyactingtoattachlossfunctions.
Loss B
It therefore suffices to check that this assignment of losses is strictly functorial. Writing ‚ for
compositioninC,˝forhorizontalcompositioninStat , inBayesLens ,and˛forhorizontal
2 2
(cid:11)
compositionoflossesinSGame,wehavethefollowingchainofequalities:
”
` ˘
KL pd,d1q pc,c1q pzq “ E logp px,m,y,n|zq
(cid:11) π px,m,y,nq„pc1˝d1 c qπpzq pc1˝d1 c qπ ı
´logp px,m,y,n|zq
” pc:˝d: cqπ
“ E E logp px,m|yqp py,n|zq
c1 d1
py,nq„d1 c‚π pzqpx,mq„c1 π pyq π c‚π ı
´logp px,m|yqp py,n|zq
”
c:
π
d:
c‚π
“ E logp py,n|zq´logp py,n|zq
py,nq„d1 c‚π pzq
d1
c‚π ”
d:
c‚π ıı
` E logp px,m|yq´logp px,m|yq
px,mq„c1 pyq
c1
π
c:
π
` ˘ π “ ` ˘‰
“ D d1 pzq,d: pzq ` E D c1 pyq,c:pyq
KL c‚π ‚π KL π π
`
py,nq„d1
c˘‚π
pzq
“ KLpd,d1q pzq` KLpc,c1q˝d1 pzq
c‚π c π
` ˘
“ KLpd,d1q˛KLpc,c1q pzq
π
ThefirstlineobtainsbydefinitionofKLand ;thesecondbydefinitionof˝;thethirdbythelog
(cid:11)
adjunction(logab “ loga`logb)andbylinearityofE;thefourthbydefinitionofD ;thefifth
KL
bydefinitionofKLandof˝;andthesixthbydefinitionof˛.
` ˘
ThisestablishesthatKL pd,d1q pc,c1q “ KLpd,d1q˛KLpc,c1qandhencethatKLisstrictly
(cid:11)
functorialon1-cells. Sincewehaveassumedthattheonly2-cellsarethestructural2-cells(e.g.,
thehorizontalunitors),whichdonotresultinanydifferencebetweenthelossesassignedtothe
corresponding1-cells,theonlyloss2-cellavailabletobeassignedisthe0loss;whichassignmentis
easilyseentobeverticallyfunctorial. HenceKLisastrict2-functor,andmoreoverasectionof
π | asrequired.
Loss B
200
Successfully playing a relative entropy game entails minimizing the divergence from the
approximatetotheexactposterior. Thisdivergenceisminimizedwhenthetwocoincide,andso
KLrepresentsaformofapproximateBayesianinference.
Remark5.3.23. Weopenedthechapterbyobservingthattherelativeentropysatisfiesachain
ruledefinednotonBayesianlenses,butsimplyonpairsofchannels: toformalizethissimplercase,
wedonotneedthefullmachineryofstatisticalgames(whichisusefulwhenwehavebidirectional
inferencesystems);butwedoneedsomeofit.
If c and c1 are parallel channels XÑ‚ Y, then D
KL
pcp´q,c1p´qq defines an effect XÑ‚ I. This
meanswecanusethestatisticalgamesideatoequipparallel(copy-composite)channelsinC with
suchnon-state-dependentlossfunctions;andtherelativeentropywillagainformastrictsection
oftheresultingGrothendieckfibration.
Therefore, let B be the bicategory whose 0-cells are the objects of C, but whose 1-cells and
2-cellsareparallelpairsof1-cellsand2-cellsinCopara pCq;equivalently,thesubbicategoryof
2
Copara pCq2 whichisdiagonalon0-cells.
2
Next,letK denotetheindexedbicategoryBcoop Ñ Bicatobtainedasthecomposite
Bcoop Ý p Ý ro ÝÑ j 1 Copara pCqcoop ÝÝÝ co Ý o Ñ p Cop Ý C Ý p Ý ´ Ý ,I Ñ q MonCat Ý B Ñ Bicat
2
where proj indicates the projection of the 1st factor of the parallel pairs of 1-cells and 2-cells.
1
ş
Applying the Grothendieck construction to K yields a 2-fibration K Ý π ÝKÑ B. The 0-cells of
ş
K are the objects of C. The 1-cells X Ñ Y are triples pc,c1,Lq where c and c1 are parallel
coparameterizedchannelsXÑ‚ Y andLisaneffect(lossfunction)XÑ‚ I. Givencomposable1-cells
pc,c1,Lq : X Ñ Y andpd,d1,Mq : Y Ñ Z,theirhorizontalcompositeisdefinedontheparallel
channelsascopy-composition,andonthelossfunctionsasM‚c `L(where‚hereiscomposition
inC). 2-cellsarepairsof2-cellsinCopara pCqanddifferencesoflosses.
2
Finally,therelativeentropyD definesastrictsectionofπ ,mappingtheparallelpairpc,c1q
KL K
` ˘ ş
to c,c1,D pc,c1q . Itschainruleisthusformalizedbythehorizontalcompositionin K.
KL
5.3.3.2. Maximumlikelihoodestimation
Astatisticalsystemmaybemoreinterestedinpredictingobservationsthanupdatingbeliefs. This
iscapturedbytheprocessofmaximumormarginallikelihoodestimation.
Definition5.3.24. Letpc,c1q : pX,Xq ÑÞ pY,Yqbeasimplelenswhoseforwardchannelcadmits
adensityfunctionp . Thenitslogmarginallikelihood isthelossfunctiongivenbythemarginal
c
logevidenceMLEpc,c1q pyq :“ ´logp pyq.
π c ‚π
201
Proposition5.3.25. LetBbeasubbicategoryoflensesinBayesLens allofwhichadmitdensity
2
functionswithrespecttoacommonmeasure,andwithonlystructural2-cells. Thentheassignment
pc,c1q ÞÑ MLEpc,c1qdefinesalaxlossmodelMLE : B Ñ SGame.
Proof. WeadoptthenotationalconventionsoftheproofofProposition5.3.22. Observethat
` ˘
MLE pd,d1q pc,c1q pzq “ ´logp pzq “ MLEpd,d1q pzq .
π d ‚c ‚π c‚π
(cid:11)
Bydefinition,wehave
` ˘ ` ˘
MLEpd,d1q˛MLEpc,c1q pzq “ MLEpd,d1q pzq` MLEpc,c1q˝d1 pzq
π c‚π c π
andhencebysubstitution
` ˘ ` ˘ ` ˘
MLEpd,d1q˛MLEpc,c1q pzq “ MLE pd,d1q pc,c1q pzq` MLEpc,c1q˝d1 pzq .
π π c π
(cid:11)
` ˘
Therefore,MLEpc,c1q˝d1 constitutesa2-cellfromMLEpd,d1q˛MLEpc,c1qtoMLE pd,d1q pc,c1q ,
c
(cid:11)
and hence MLE is a lax functor. It is evidently moreover a section of π | , and, like KL, acts
Loss B
triviallyonthe(purelystructural)2-cells.
Successfullyplayingamaximumlikelihoodgameinvolvesmaximizingthelog-likelihoodthatthe
systemassignstoitsobservationsy : Y. Thisprocessamountstochoosingachannelcthatassigns
highlikelihoodtolikelyobservations,andthusencodesavalidmodelofthedatadistribution.
5.3.3.3. Autoencodersviathefreeenergy
Manyadaptivesystemsneitherjustinfernorjustpredict: theydoboth,buildingamodeloftheir
observationsthattheyalsoinverttoupdatetheirbeliefs. Inmachinelearning,suchsystemsare
knownasautoencoders,asthey‘encode’(infer)and‘decode’(predict),‘autoassociatively’[161]. In
aBayesiancontext,theyareknownasvariationalautoencoders[154],andtheirlossfunctionisthe
freeenergy [80].
Definition5.3.26. Thefreeenergy lossmodelisthesumoftherelativeentropyandthelikelihood
lossmodels: FE :“ KL`MLE. Givenasimplelenspc,c1q : pX,Xq ÑÞ pY,YqadmittingBayesian
inversionandwithdensities,FEassignsthelossfunction
FEpc,c1q pyq “ pKL`MLEqpc,c1q pyq
π π
` ˘
“ D c1 pyq,c:pyq ´logp pyq
KL π π c ‚π
202
NotethatthismeansthatoptimizingthefreeenergyisnotguaranteedtooptimizeeitherKL
orMLEindividually,althoughbydefinitionFEisanupperboundonthemboth(andhenceoften
knowninmachinelearningbythealternativename,theevidenceupperbound,thinkingofMLEas
encodingameasureof‘evidence’).
Remark5.3.27. Beyonditsautoencodingimpetus,anotherimportantpropertyofthefreeenergy
isitsimprovedcomputationaltractabilitycomparedtoeithertherelativeentropyorthelikelihood
loss. Thispropertyisaconsequenceofthefollowingfact: althoughobtainedasthesumofterms
whichbothdependonanexpensivemarginalization8,thefreeenergyitselfdoesnot. Thiscanbe
seenbyexpandingthedefinitionsoftherelativeentropyandofc: andrearrangingterms:
π
` ˘
FEpc,c1q pyq “ D c1 pyq,c:pyq ´logp pyq
π KL π π c ‚π
“ ‰
“ E logp px,m|yq´logp px,m|yq ´logp pyq
px,mq„c1
π
pyq“
c1
π
c:
π
c ‚π
‰
“ E logp px,m|yq´logp px,m|yq´logp pyq
px,mq„c1 pyq
c1
π
c:
π
c ‚π
π
“ ‰
p pm,y|xqp pxq
“ E logp px,m|yq´log c π ´logp pyq
px,mq„c1 π pyq“ c1 π p c ‚π pyq ‰ c ‚π
“ E logp px,m|yq´logp pm,y|xq´logp pxq (5.5)
c1 c π
px,mq„` c1
π
pyq π
˘ “ ‰
“ D c1 pyq,πb1 ´ E logp pm,y|xq
KL π c
px,mq„c1 pyq
π
Here,1denotesthemeasurewithdensity1everywhere. Notethatwhenthecoparameteristrivial,
FEpc,c1q pyqreducesto
π
` ˘ “ ‰
D c1 pyq,π ´ E logp py|xq .
KL π c
x„c1 pyq
π
Remark 5.3.28. The name free energy is due to an analogy with the Helmholtz free energy in
thermodynamics,aswecanwriteitasthedifferencebetweenan(expected)energyandanentropy
term:
“ ‰ “ ‰
FEpc,c1q pyq “ E ´logp pm,y|xq´logp pxq ´S c1 pyq
π c π XbM π
px,mq„c1
π
pyq“
‰ “ ‰
“ E E px,m,yq ´S c1 pyq “ U ´TS
pc,πq XbM π
px,mq„c1 pyq
π
wherewecallE
pc,πq
: X bM bYÝ X Ñ‚ I theenergy,andwhereS
XbM
: IÝ X ÝÝ b ‚Ý M ÑI istheShannon
entropy. Thelastequalitymakesthethermodynamicanalogy: U hereistheinternalenergy ofthe
system;T “ 1isthetemperature;andS isagaintheentropy.
8Evaluatingthepushforwardc ‚πinvolvesmarginalizingovertheintermediatevariable;andevaluatingc:pyqalso
π
involvesevaluatingc ‚π.
203
5.3.3.4. TheLaplaceapproximation
Althoughoptimizingthefreeenergydoesnotnecessitateaccesstoexactinversions,itdoesstill
entailcomputinganexpectationundertheapproximateinversion(cf. equation(5.5)ofRemark
5.3.27 above), which may remain non-trivial. When one is interested in optimizing a model by
gradient descent, this becomes particularly pressing, as one needs to form an estimate of the
gradientofthisexpectationwithrespecttotheparameters(whichisnotingeneralequaltothe
expectationofthegradientoftheenergy).Inmachinelearning,optimizingvariationalautoencoders
typicallyinvolvesa“reparameterizationtrick”[155,§2.5]tocircumventthisdifficulty,butinthe
context of neuroscientific modelling (where one is concerned with biological plausibility), this
optionisnotgenerallyavailable.
Analternativestrategyistomakesimplifyingassumptions,enablingthedesiredcomputations
withouttotallysacrificingbiologicalrealism. Inthecontextofpredictivecoding,atypicalsuch
assumptionisthatallmeasuresareGaussian[21,33,48,104,216]. Thisismotivatednotonlyby
hypothesesaboutthenatureofbiologicalnoise(relatedtotheCentralLimitTheorem),butalsoby
expediency,asaGaussiandistributionisdeterminedbyjusttwosufficientstatistics: itsmeanand
variance. IfonefirstrestrictstolenseswithGaussianchannels,andthentolenseswhoseinversion
morphismsareconstrainedtoemit‘tightly-peaked’Gaussians(i.e.,withsmallvariances),thenone
can eliminate the expectation from the expected energy, and simply evaluate the energy at the
posteriormean.
TheconceptualjustificationforthisapproximationisduetoLaplace[163,p.367],whoobserved
that, given a function of the form fpxq “ enhpxq with h having a maximum at x , the only
0
non-negligible contributions to its integral as n Ñ 8 are those near to x 9. Consequently, the
0
function h can be approximated by the quadratic form obtained from its its 2nd-order Taylor
expansionaboutx ,sothat,intheone-dimensional(univariate)case,
0
ż ż
fpxqdx « enhpx0q e´ 2σ 1 2 px´x0q2 dx
` ˘
forσ “ nB2hpx q ´1{2. Notably,theintegrandontheright-handsideisaGaussianfunction: it
x 0
hastheformofthedensityofanormaldistribution.
“ ‰
In the present context, we are generally interested in expectations of the form E gpxq ,
x„π
ş
whichcorrespondtointegrals gpxqelogpπpxqdx. Itispossibletoextendtheforegoingreasoning
tothiscase: supposingthatlogp pxq9nhpxqforsomefunctionhwithamaximumatx ,thenas
π 0
9A demonstration of this can be found on Wikipedia at https://en.wikipedia.org/w/index.php?
title=Laplace%27s_method&oldid=1154930495.
204
n Ñ 8,wecanapproximatebothgandhbytheir2nd-orderexpansions,therebyapproximatingπ
byaGaussianandg byaquadraticform.
ThismethodofapproximatingintegralsisknownasLaplace’smethod,andithasbeenwidely
appliedinstatistics10 [22,101,151,280][176,Chp. 27],insomecircumstances,evenyieldingexact
posteriors[267,§10.2]. Forfurtherexposition(andmorerigour)inthefinite-dimensionalcase,we
referthereadertoBruijn[46,Ch. 4]andOlver[200,§3.7];forthegeneralcaseinBanachspaces,
the reader may consult Piterbarg and Fatalov [211]. And for an analysis of the specific case of
approximatingBayesianposteriors(beyondtheexactcase),withconsiderationoftheapproximation
errors,onemayrefertoKass,Tierney,andKadane[150]orthetechnicalreportaccompanying
TierneyandKadane[263].
This latter situation is of course closely related to the matter at hand. Here, rather than
approximatingtheposteriorbyaGaussian,weassumeittohaveGaussianform.
Remark5.3.29. Wesaythatachannelc : XÑ‚ Y isGaussianifcpxqisaGaussianmeasurefor
everyxinitsdomain. Wedenotethemeanandvarianceofcpxqbyµ pxqandΣ pxqrespectively,
c c
andwriteits(log)densityfunctionas
A E a
1
logp py|xq “ ϵ py,xq,Σ pxq´1ϵ py,xq ´log p2πqndetΣ pxq
c c c c c
2
havingalsodefinedthe‘error’functionϵ : Y ˆX Ñ Y byϵ py,xq “ y´µ pxq. In§7.1,wegive
c c c
afulldefinitionofacategoryof(nonlinear)Gaussianchannels.
“ ‰
We will still be concerned with approximating expectations E gpxq by the quadratic
x„dpyq
expansionofg,andsotolicenseLaplace’smethodweneedananalogueoftheconditionn Ñ 8.
ThiswillbesuppliedbythefurtherassumptionthatΣ pyqhassmalleigenvalues: thatis,wework
d
inthelimittrpΣ pyqq Ñ 0. Withthesetwoassumptions,wecanwrite
d
ż A E
“ ‰
E gpxq 9 gpxq exp ϵ px,yq,Σ pyq´1ϵ px,yq dx
d d d
x„dpyq x:X
´ ¯
and observe that as trpΣ pyqq Ñ 0, we must have tr Σ pyq´1 Ñ 8. Thus, by Laplace’s
d d
reasoning,thecontributionstotheintegralareonlyappreciablynon-zeronearthemeanµ pyq.
d
This licenses the approximation of g by its quadratic expansion around µ pyq, and leads to the
d
following approximation of the free energy, known in the predictive coding literature as the
Laplaceapproximation[101]. (Consistentwiththeotherexamplesinthischapter,weconsiderthe
coparameterizedcase.)
10Instatistics,makingGaussianassumptionsaboutBayesianposteriors,orequivalentlyusingsecond-orderapproxima-
tionstologposteriors,isalsoknownasvariationalLaplace[101].
205
Definition5.3.30. ACartesianspaceisanobjectX thatisisomorphictoRn forsomen : N.
Proposition5.3.31(Laplacianfreeenergy). Supposepγ,ρq : pX,Xq ÑÞ pY,YqisaBayesianlens
withGaussianchannelsbetweenfinite-dimensionalCartesianspaces,forwhich,forally : Y and
Gaussianpriorsπ : IÑ‚ X,theeigenvaluesofΣ
ρπ
pyqaresmall. ThenthefreeenergyFEpγ,ρq
π
pyq
canbeapproximatedbytheLaplacianfreeenergy
FEpγ,ρq pyq « LFEpγ,ρq pyq (5.6)
π π
` ˘ “ ‰
:“ E µ pyq,y ´S ρ pyq (5.7)
pγ,πq ρπ XbM π
“ ‰
“ ´logp pµ pyq,yq´logp pµ pyq| q´S ρ pyq
γ ρπ π ρπ X XbM π
wherewehavewrittentheargumentofthedensityp in‘function’style;wherep´q denotesthe
γ X
projectionontoX; andwhereS rρ pyqs “ E r´logp px,m|yqsistheShannon
XbM π px,mq„ρπpyq ρπ
entropyofρ pyq. TheapproximationisvalidwhenΣ satisfies
π ρπ
´ ¯
Σ pyq “ B2 E pµ pyq,yq´1 . (5.8)
ρπ px,mq pγ,πq ρπ
WecallE theLaplacianenergy.
pγ,πq
Proof. RecallthatwecanwritethefreeenergyFEpγ,ρq pyqasthedifferencebetweenexpected
π
energyandentropy:
“ ‰ “ ‰
FEpγ,ρq pyq “ E ´logp pm,y|xq´logp pxq ´S ρ pyq
π γ π XbM π
px,mq„ρπpyq“
‰ “ ‰
“ E E px,m,yq ´S ρ pyq
pγ,πq X π
px,mq„ρπpyq
Next, since the eigenvalues of Σ pyq are small for all y : Y, we can approximate the expected
ρπ
energybyitssecond-orderTaylorexpansionaroundthemeanµ pyq,followingLaplace:
ρπ
«
@ ` ˘ D
FEpγ,ρq pyq « E E pµ pyq,yq` ϵ px,m,yq, B E pµ pyq,yq
π pγ,πq ρπ ρπ px,mq pγ,πq ρπ
px,mq„ρπpyq
ff
A ´ ¯ E
1
` ϵ px,m,yq, B2 E pµ pyq,yq¨ϵ px,m,yq
2 ρπ px,mq pγ,πq ρπ ρπ
“ ‰
´S ρ pyq
XbM π B F
“ ‰ ` ˘
p “ aq E pµ pyq,yq` E ϵ px,m,yq , B E pµ pyq,yq
pγ,πq ρπ ρπ px,mq pγ,πq ρπ
”´
px,mq
¯
„ρπpyq
ı
“ ‰
1
` tr B2 E pµ pyq,yq Σ pyq ´S ρ pyq
2 px,mq pγ,πq ρπ ρπ XbM π
”´ ¯ ı
“ ‰
p “ bq E pµ pyq,yq` 1 tr B2 E pµ pyq,yq Σ pyq ´S ρ pyq
pγ,πq ρπ 2 px,mq pγ,πq ρπ ρπ XbM π
206
´ ¯
where B2 E pµ pyq,yq is the Hessian of E with respect to px,mq evaluated at
px,mq pγ,πq ρπ pγ,πq
pµ pyq,yq. Theequalitymarkedpaqholdsfirstbythelinearityofexpectationsandsecondbecause
ρπ
« ff
A ´ ¯ E
E ϵ px,m,yq, B2 E pµ pyq,yq¨ϵ px,m,yq
ρπ px,mq pγ,πq ρπ ρπ
px,mq„ρπpyq
« ff
”´ ¯ ı
“ E tr B2 E pµ pyq,yq ϵ px,m,yqϵ px,m,yqT
px,mq pγ,πq ρπ ρπ ρπ
px,mq„ρπpyq
„ ȷ
´ ¯ ” ı
“ tr B2 E pµ pyq,yq E ϵ px,m,yqϵ px,m,yqT
px,mq pγ,πq ρπ ρπ ρπ
”´ ¯ px,mq„ρıπpyq
“ tr B2 E pµ pyq,yq Σ pyq (5.9)
px,mq pγ,πq ρπ ρπ
where the first equality obtains because the trace of an outer product equals an inner product;
thesecondbylinearityofthetrace;andthethirdbythedefinitionofthecovarianceΣ pyq. The
“ ‰
ρπ
equalitymarkedpbqabovethenholdsbecauseE ϵ px,m,yq “ 0.
px,mq„ρπpyq ρπ
Next,notethattheentropyofaGaussianmeasuredependsonlyonitscovariance,
“ ‰
1
S ρ pyq “ logdetp2πeΣ pyqq ,
XbM π
2
ρπ
andthattheenergyE pµ pyq,yqdoesnotdependonΣ pyq. Wecanthereforewritedown
pγ,πq ρπ ρπ
directlythecovarianceΣ˚ pyqminimizingFEpγ,ρq pyqasafunctionofy. Wehave
ρπ π
´ ¯
pbq 1 1
B FEpγ,ρq pyq « B2 E pµ pyq,yq` Σ ´1
Σρπ π 2 px,mq pγ,πq ρπ 2 ρπ
by equation pbq above. Setting B FEpγ,ρq pyq “ 0, we find the optimum as expressed by
Σρπ π
equation(5.8):
` ˘
Σ˚ pyq “ B2E pµ pyq,yq´1 .
ρπ x pγ,πq ρπ
Finally,bysubstitutingΣ˚ pyqinequation(5.9),weobtainthedesiredexpression,equation(5.6):
ρπ
FEpγ,ρq pyq « E pµ pyq,yq´S rρ pyqs “: LFEpγ,ρq pyq.
π pγ,πq ρπ XbM π π
Remark5.3.32. TheusualformoftheLaplacemodelintheliteratureomitsthecoparameters. It
isofcourseeasytorecoverthenon-coparameterizedformbytakingM “ 1.
As well as being an approximation to a particular statistical game, the Laplacian free energy
definesalaxlossmodel.
207
Proposition 5.3.33. Let B be a subbicategory of BayesLens of Gaussian lenses between
2
Cartesianspaceswhosebackwardchannelshavesmallvariance,andwithonlystructural2-cells11.
ThenLFEdefinesalaxlossmodelB Ñ SGame.
Proof. AgainwefollowthenotationalconventionsoftheproofofProposition5.3.22. Additionally,
ifω isastateonatensorproductsuchasX bY,wewillwriteω andω todenoteitsX andY
X Y
marginals. Wewillcontinuetowritec todenotetheresultofdiscardingthecoparametersofa
coparameterizedchannelc.
Observethat,byrepeatedapplicationofthelinearityofE,thelogadjunction,andthedefinitions
of‚and˝,
` ˘
LFEpd,d1q˛LFEpc,c1q pzq
π
` ˘
“ LFEpd,d1q pzq` LFEpc,c1q˝d1 pyq
c‚π c π
“ ‰
“ LFEpd,d1q pzq` E LFEpc,c1q pyq
c‚π π
` p˘ y,nq„d1 c‚π pzq ` ˘
“ ´logp µ pzq,z ´logp µ pzq
d d1
c‚π ”
c ‚π d1
c‚π
Y
` ˘ ` ˘
` E logp py,n|zq´logp µ pyq,y ´logp µ pyq
d1 c c1 π c1 X
py,nq„d1 c‚π pzq c‚π “ π ‰ ı π
` E logp px,m|yq
c1
` ˘
px,mq„c1 π`pyq π
˘
“ ´logp µ pzq,z ´logp µ pzq
d d1
c‚π
c ‚π d1
c‚π
Y
“ ` ˘ ` ˘‰
` E ´logp µ pyq,y ´logp µ pyq
c c1 π c1 X
py,nq„d1 c‚π pzq” π “ π ‰ ı
` E logp py,n|zq` E logp px,m|yq
d1 c1
py,
`
nq„d1
c‚π
pzq
˘
c‚π
`
px,mq„˘ c1
π
pyq π
“ ´logp µ pzq,z ´logp µ pzq
d d1
c‚π
c ‚π d1
c‚π
Y
“ ` ˘ ` ˘‰
` E ´logp µ pyq,y ´logp µ pyq
c c1 π c1 X
py,nq„d1
c‚π
pzq
“
π π
‰
` E E logp py,n|zq`logp px,m|yq
d1 c1
py,
`
nq„d1
c‚π
pzqpx,
˘
mq„c1
π
pyq
`
c‚π
˘
π
“ ´logp µ pzq,z ´logp µ pzq
d d1
c‚π
c ‚π d1
c‚π
Y
“ ` ˘ ` ˘‰
` E ´logp µ pyq,y ´logp µ pyq
c c1 π c1 X
py,nq„d1
c‚π
pzq
“
π π
‰
` E ´logp px,m,y,n|zq
px,
`
m,y,nq„pc1˝d1 c˘qπpzq
p
`
c1˝d1
c
qπ
˘
“ ´logp µ pzq,z ´logp µ pzq
d d1
c‚π
c ‚π d1
c‚π
Y
“ ` ˘ ` ˘‰ “ ‰
` E ´logp µ pyq,y ´logp µ pyq ´S pc1˝d1q pzq
py,nq„d1 pzq c c1 π π c1 π X XMYN c π
c‚π
11AnexampleofBhereisobtainedbyrestrictingBayesLens tothecategoryFdGaussofDefinition7.1.9,andby
2
excludingallbutthestructural2-cells
208
` ˘ ` ˘
“ ´logp µ pzq,z ´logp µ pzq
d d1
c‚π
c ‚π d1
c‚π
Y
“ ` ˘‰ “ ‰
` E E µ pyq,y ´S pc1˝d1q pzq
py,nq„d1
c‚π
pzq pc,πq c1 π
“
X
`
MYN
˘‰
c π
“ ‰
“ E pµ pzq,zq` E E µ pyq,y ´S pc1˝d1q pzq
pd,c‚πq d1 c‚π py,nq„d1 pzq pc,πq c1 π XMYN c π
c‚π
whereXMYN isshorthandforX bM bY bN.
` ˘
Now,writingEµ pyq :“ E µ pyq,y ,bytheLaplaceassumption,wehave
pc,πq pc,πq c1 π
”´ ¯ ı
“ ‰ ` ˘
1
E Eµ pyq « Eµ pµ pzq q` tr B2Eµ µ pzq Σ pzq
py,nq„d1 pzq pc,πq pc,πq d1 c‚π Y 2 y pc,πq d1 c‚π Y d1 c‚π YY
c‚π
andsowecanwrite
` ˘
LFEpd,d1q˛LFEpc,c1q pzq
π
“ ‰
« E pµ pzq,zq`Eµ pµ pzq q´S pc1˝d1q pzq
pd,c‚πq d ” 1 c´‚π ¯ pc,πq d1 c‚π Y XM ı YN c π
` ˘
1
` tr B2Eµ µ pzq Σ pzq
2 y pc,πq d1 c‚π Y d1 c‚π YY
` ˘ ` ˘ ` ˘
“ ´logp µ pzq,z ´logp µ pµ pzq q,µ pzq ´logp µ pµ pzq q
d d1 c c1 d1 Y d1 Y π c1 d1 Y X
c‚π π c‚π c‚π π c‚π
“ ‰ ` ˘
´S pc1˝d1q pzq ´logp µ pzq
XM ” Y ´ N ¯ c π c ‚π d1 c‚πı Y
` ˘
1
` tr B2Eµ µ pzq Σ pzq
2 y pc,πq d1 c‚π Y d1 c‚π YY
` ˘ “ ‰
“ E µ pzq,z ´S pc1˝d1q pzq
pd‚c,πq pc1˝d1
c
qπ XMYN
”´
c π
¯ ı
` ˘ ` ˘
1
´logp µ pzq ` tr B2Eµ µ pzq Σ pzq
c ‚π d1 c‚π Y 2 y pc,πq d1 c‚π Y d1 c‚π YY
` ˘ ` ˘
“ LFE pd,d1q pc,c1q pzq´logp µ pzq
”´(cid:11) π¯
`
c
˘
‚π d1 c‚π Y ı
1
` tr B2Eµ µ pzq Σ pzq .
2 y pc,πq d1 c‚π Y d1 c‚π YY
Therefore,ifwedefinealossfunctionκby
”´ ¯ ı
` ˘ ` ˘
1
κ pzq :“ tr B2Eµ µ pzq Σ pzq ´logp µ pzq
π 2 y pc,πq d1 c‚π Y d1 c‚π YY c ‚π d1 c‚π Y
` ˘
thenκconstitutesa2-cellLFEpd,d1q˛LFEpc,c1q ñ LFE pd,d1q pc,c1q ,asrequired.
(cid:11)
Effectively, this proposition says that, under the stated conditions, the free energy and the
Laplacianfreeenergycoincide. Consequently,successfullyplayingaLaplacianfreeenergygame
hasthesameautoencodingeffectasplayingafreeenergygameinthesenseof§5.3.3.3.
Remark5.3.34. WeformalizedtheideaofaGaussianhavingsmall ortightly-peaked varianceas
meaningitscovariancematrixΣhassmalleigenvalues. Wedonotspecifypreciselywhat‘small’
means here: only, it must be enough to license the use of Laplace’s method. Of course, as the
209
eigenvaluesapproach0,theGaussianapproachesaDiracdeltadistribution. Inthiscase,onemay
truncatetheapproximatingexpansionatfirstorderandjustworkwiththemeans—infact,the
inversionsbecomedeterministic—andindeed,thisisthechoicemadeinsomeofthepredictive
codingliterature[33].
5.4. Monoidal statistical games
InRemark4.3.18,wenotedthatthecanonicalsection:takingachannelctothelensequipped
with its exact inversion c: is not monoidal, because inverting the tensor of two channels with
respecttoajointstateisingeneralnotthesameasinvertingthetwochannelsindependentlywith
respecttothemarginals,owingtothepossibilityofcorrelations. Atthesametime,weknowfrom
Proposition4.3.11thatthecategoryBayesLens ofnon-coparameterizedBayesianlensesinC
C
isnonethelessamonoidalcategory(anditismoreoversymmetricmonoidalwhenC is);andwe
sawinCorollary5.3.10thatStat,andhenceBayesLens ,areadditionallyfibrewisemonoidal.
C
Inthissection,weestablishanalogousresultsforcopy-compositeBayesianlenses,andstatistical
gamesandlossmodelsinturn,aswellasdemonstratingthateachofourlossmodelsisaccordingly
monoidal. Thismonoidalstructureonlossmodelscanthenbeusedtomeasuretheerrorobtained
byinvertingchannelsindependentlywithrespecttothemarginalsofajointprior.
Becausestatisticalgamesaredefinedovercopy-compositechannels,ourstartingpointmustbe
toestablishamonoidalstructureonCopara pCq.
2
Proposition 5.4.1. If the copy-discard category C is symmetric monoidal, then Copara pCq
2
inheritsamonoidalstructurepb,Iq,withthesameunitobjectI asinC. On1-cellsf : A ÝÑ B
M
andf1 : A1 ÝÝÑ B1,thetensorf bf1 : AbA1 ÝÝÝÝÑ BbB1 isdefinedby
M1 MbM1
M
f
A M1
.
A1 B
f1
B1
On2-cellsφ : f ñ g andφ1 : f1 ñ g1, thetensorφbφ1 : pf bf1q ñ pg bg1qisgivenbythe
210
stringdiagram
A
A1 φ N
M
.
M1
B N1
φ1
B1
Proof. ToestablishthatpCopara pCq,b,Iqisamonoidalbicategory,weneedtoshowthatbisa
2
pseudofunctorCopara pCqˆCopara pCq Ñ Copara pCqandthatI inducesapseudofunctor
2 2 2
1 Ñ Copara pCq,suchthatthepairofpseudofunctorssatisfiestherelevantcoherencedata. We
2
willomitthecoherencedata,andonlysketchthatthepseudofunctorbiswelldefined,leavinga
fullproofforlaterwork. (Inthesequelhere,wewillnotmakeverymuchuseofthistensor.)
First, we confirm that b is locally functorial, meaning that our definition gives a functor on
each pair of hom categories. We begin by noting that b is well-defined on 2-cells, that φbφ1
satisfies that change of coparameter axiom for f bf1; this is immediate from instantiating the
axiom’sstringdiagram. Next,wenotethatbpreservesidentity2-cells;again,thisisimmediate
uponsubstitutingidentitiesintothedefiningdiagram. Wethereforeturntothepreservationof
composites,whichrequiresthatpγ dφqbpγ1dφ1q “ pγ bγ1qdpφbφ1q,andwhichtranslates
tothefollowinggraphicalequation:
A
A
O
A1 O γ
φ γ A1
M φ
M
“
M1
M1
φ1
B
B O1
φ1 γ1 O1
B1 φ1
B1
Itiseasytoseethatthisequationissatisfied: usethenaturalityofthesymmetryofpC,b,Iq. This
establishesthatbislocallyfunctorial.
Next, we confirm that b is horizontally (pseudo) functorial. First, we note that id bid “
f f1
id bythenaturalityofthesymmetryofpC,b,Iq. Second,weexhibitamultiplicationnatural
fbf1
211
isomorphism,witnessingpseudofunctoriality,withcomponentsµ : pgbg1q˝pf bf1q ñ
g,g1,f,f1
pg˝fqbpg1˝f1qforallcomposablepairsof1-cellsg,f andg1,f1. Letthese1-cellsbesuchthat
pgbg1q˝pf bf1qhastheunderlyingdepiction
M
M1
B
B1
N
A N1
f g
C
A1 C1
f1 g1
andsopg˝fqbpg1˝f1qhasthedepiction
M
B
N
A M1
f g
B1
N1
.
C
A1 C1
f1 g1
Itistheneasytoseethatdefiningµ anditsinverseµ´1 asthe2-cellswiththefollowing
g,g1,f,f1 g,g1,f,f1
212
respectiveunderlyingdepictionsgivesusthedesiredisomorphism:
A A
A1 A1
M M M M
M1 B B M1
B N N B
B1 M1 and M1 B1 .
N B1 B1 N
N1 N1 N1 N1
C C
C1 C1
ThenaturalityofthisdefinitionisaconsequenceofthenaturalityofthesymmetryofpC,b,Iq.
That this tensor satisfies the monoidal bicategory axioms — of associativity, unitality, and
coherence — follows from the fact that the monoidal structure pb,Iq satisfies correspondingly
decategorifiedversionsoftheseaxioms;weleavethedetailstosubsequentexposition.
FollowingthemonoidalGrothendieckrecipe,establishingthatBayesLens ismonoidalentails
2
establishingthatStat isamonoidalindexedbicategory. Butfirstwemustdefinethelatterconcept,
2
bycategorifyingDefinition4.2.19.
Definition5.4.2. SupposepB,b,Iqisamonoidalbicategory.WewillsaythatF : Bcoop Ñ Bicat
isamonoidalindexedbicategorywhenitisequippedwiththestructureofaweakmonoidobjectinthe
3-categoryofindexedbicategories,indexedpseudofunctors,indexedpseudonaturaltransformations,
andindexedmodifications.
Moreexplicitly,wewilltakeF tobeamonoidalindexedbicategorywhenitisequippedwith
(i) anindexedpseudofunctorµ : Fp´qˆFp“q Ñ Fp´b “qcalledthemultiplication,i.e.,
(a) afamilyofpseudofunctorsµ : FX ˆFY Ñ FpX bYq,alongwith
X,Y
(b) for any 1-cells f : X Ñ X1 and g : Y Ñ Y1 in B, a pseudonatural isomorphism
µ : µ ˝pFf ˆFgq ñ Fpf bgq˝µ ;
f,g X1,Y1 X,Y
(ii) apseudofunctorη : 1 Ñ FI calledtheunit;
as well as three indexed pseudonatural isomorphisms — an associator, a left unitor, and a right
unitor—whichsatisfyweakanaloguesofthecoherenceconditionsforamonoidalindexedcategory
[189,§3.2],uptoinvertibleindexedmodifications.
213
Remark5.4.3. Becauseitisnotourmainpurpose,andbecausethecoherencedataforhigher-
dimensionalstructuresrapidlybecomescumbersome,theprecedingdefinitiononlysuggeststhe
formofthiscoherencedata. Unfortunately,wearenotpresentlyawareofafullexplicitdefinition
intheliteratureoftheconceptofmonoidalindexedbicategory.
Usingthisnotion,wecanestablishthatStat ismonoidal.
2
Theorem5.4.4. Stat isamonoidalindexedbicategory,intheexplicitsenseofDefinition5.4.2.
2
Proofsketch. Weonlychecktheexplicitrequirementsoftheprecedingdefinition,andexpectthat
thehighercoherencedataissatisfiedbythefactthateachofourhigh-dimensionalstructuresis
obtainedfromawell-behavedlower-dimensionaloneusingcanonicalcategoricalmachinery.
Inthisway,themultiplicationµisgivenfirstbythefamilyofpseudofunctorsµ : Stat pXqˆ
X,Y 2
Stat pYq Ñ Stat pX bYqwhicharedefinedonobjectssimplybytensor
2 2
µ pA,Bq “ AbB
X,Y
sincetheobjectsdonotvarybetweenthefibresofStat ,andonhomcategoriesbythefunctors
2
Stat pXqpA,BqˆStat pYqpA1,B1q
2 2
` ˘ ` ˘
“ Cat discCpI,Xq,CopararpCqpA,Bq ˆCat discCpI,Yq,CopararpCqpA1,B1q
2 2
` ˘
– Cat discCpI,XqˆdiscCpI,Yq,CopararpCqpA,BqˆCopararpCqpA1,B1q
2 2
` ˘
Ý C ÝÝ at Ý p Ý di Ý sc Ý C Ý pI Ý ,p Ý r Ý oj ÝXÝ qˆ Ý d Ý is Ý c Ý C Ý pI Ý ,p Ý ro Ý j ÝYÝ q, Ý b Ñ q Cat discCpI,X bYq2,CopararpCqpAbA1,BbB1q
2
Ý C Ý a Ý t Ý p ÝÝ ,id Ñ q CatpdiscCpI,X bYq,CopararpCqpAbA1,BbB1q
2
“ Stat pX bYqpAbA1,BbB1q .
2
whereCatp ,idqindicatespre-compositionwiththeuniversal(Cartesian)copyingfunctor. For
allf : X Ñ X1 andg : Y Ñ Y1 inCoparalpCq,thepseudonaturalisomorphisms
2
` ˘
µ : µ ˝ Stat pfqˆStat pgq ñ Stat pf bgq˝µ
f,g X1,Y1 2 2 2 X,Y
areobtainedfromtheuniversalpropertyoftheproductˆofcategories. Theunitη : 1 Ñ Stat pIq
2
is the pseudofunctor mapping the unique object of 1 to the monoidal unit I. Associativity and
unitalityofthismonoidalstructurefollowfromthefunctorialityoftheconstruction, giventhe
monoidalstructuresonC andCat.
214
JustasthemonoidalGrothendieckconstructioninducesamonoidalstructureoncategoriesof
lensesformonoidalpseudofunctors[189], weobtainamonoidalstructureonthebicategoryof
copy-compositebayesianlenses.
Corollary5.4.5. Thebicategoryofcopy-compositeBayesianlensesBayesLens isamonoidal
2
bicategory. ThemonoidalunitistheobjectpI,Iq. Thetensorbisgivenon0-cellsbypX,Aqb
pX1,A1q :“ pX bX1,AbA1q,andonhom-categoriesby
` ˘ ` ˘
BayesLens pX,Aq,pY,Bq ˆBayesLens pX,Aq,pY,Bq
2 2
“ CoparalpCqpX,YqˆStat pXqpB,AqˆCoparalpCqpX1,Y1qˆStat pX1qpB1,A1q
2 2 2 2
ÝÑ „ CoparalpCqpX,YqˆCoparalpCqpX1,Y1qˆStat pXqpB,AqˆStat pX1qpB1,A1q
2 2 2 2
bˆµop
ÝÝÝÝÝXÝ,XÑ 1 CoparalpCqpX bX1,Y bY1qˆStat pX bX1qpBbB1,AbA1q
2 2
` ˘
“ BayesLens pX,AqbpX1,A1q,pY,BqbpY1,B1q .
2
Andsimilarly,weobtainamonoidalstructureonstatisticalgames.
Proposition5.4.6. Thebicategoryofcopy-compositestatisticalgamesSGame isamonoidal
bicategory. ThemonoidalunitistheobjectpI,Iq. Thetensorbisgivenon0-cellsasforthetensor
ofBayesianlenses,andonhom-categoriesby
` ˘ ` ˘
SGame pX,Aq,pY,Bq ˆSGame pX1,A1q,pY1,B1q
` ˘
“ BayesLens pX,Aq,pY,Bq ˆStatpXqpB,Iq
2
` ˘
ˆBayesLens pX1,A1q,pY1,B1q ˆStatpX1qpB1,Iq
2
` ˘ ` ˘
ÝÑ „ BayesLens pX,Aq,pY,Bq ˆBayesLens pX1,A1q,pY1,B1q
2 2
ˆStatpXqpB,IqˆStatpX1qpB1,Iq
` ˘
Ý b Ý ˆ ÝÝ µ ÝXÝ,XÑ 1 BayesLens pX,AqbpX1,A1q,pY,BqbpY1,B1q ˆStatpX bX1qpBbB1,I bIq
2
` ˘
ÝÑ „ SGame pX,AqbpX1,A1q,pY,BqbpY1,B1q
wherehereµindicatesthemultiplicationofthemonoidalstructureonStat(cf. Proposition4.3.6).
Having obtained a monoidal structure on statistical games, we are in a position to ask for
monoidalstructuresoninferencesystemsandlossmodels:
Definition5.4.7. AmonoidalinferencesystemisaninferencesystempD,ℓqforwhichℓisalax
monoidal pseudofunctor. A monoidal loss model is a loss model L which is a lax monoidal lax
functor.
215
To make sense of this definition, we need a notion of lax monoidal structure appropriate for
strong (pseudo-) and lax functors: a lax-functor generalization of the notion of lax monoidal
functor12 fromDefinition3.1.11. Justasalaxmonoidalstructureonafunctorisgivenbyequipping
the functor with natural transformations, a lax monoidal structure on a lax functor is given by
equippingitwithpseudonaturaltransformations. ThegeneralstructureisgivenbyMoellerand
Vasilakopoulou[189,§2.2]forthecaseofpseudofunctors;thelaxcaseissimilar.
Inthefollowingremark,weinstantiatethisstructureforlossmodels.
Remark5.4.8. AlossmodelL : B Ñ SGame islaxmonoidalwhenitisequippedwithstrong
transformations
BˆB LˆL SGameˆSGame 1 pI,Iq
bB λ bG
and
pI,Iq
λ0
B SGame B SGame
L L
whereb andb denotethemonoidalproductsonB ãÑ BayesLens andSGamerespectively,
B G 2
andwhenλandλ arethemselvesequippedwithinvertiblemodificationssatisfyingcoherence
0
axioms,asinMoellerandVasilakopoulou[189,§2.2].
Note that, because L must be a (lax) section of the 2-fibration π | : SGame| Ñ B, the
Loss B B
unitorλ isforcedtobetrivial,pickingouttheidentityonthemonoidalunitpI,Iq. Likewise,the
0
laxatorλ : Lp´qbLp“q ñ Lp´b“qmusthave1-cellcomponentswhichareidentities:
` ˘
LpX,AqbLpX1,Aq “ pX,AqbpX1,A1q “ pX bX1,AbA1q “ L pX,AqbLpX1,Aq
The interesting structure is therefore entirely in the 2-cells. We follow the convention of [145,
Def. 4.2.1]thatastrongtransformationisalaxtransformationwithinvertible2-cellcomponents.
Supposing that pc,c1q : pX,Aq ÑÞ pY,Bq and pd,d1q : pX1,A1q ÑÞ pY1,B1q are 1-cells in B, the
` ˘
corresponding2-cellcomponentofλhastheformλ : L pc,c1qbpd,d1q ñ Lpc,c1qbLpd,d1q,
c,d
hencefillingthefollowingsquareinSGame:
Lpc,c1qbLpd,d1q
pX,AqbpX1,A1q pY,BqbpY1,B1q
λ
c,d
pX,AqbpX1,A1q pY,BqbpY1,B1q
Lppc,c1qbpd,d1qq
Intuitively,these2-cellswitnessthefailureofthetensorLpc,c1qbLpd,d1qofthepartstoaccount
` ˘
forcorrelationsthatmaybeevidenttothe“wholesystem”L pc,c1qbpd,d1q .
12Notethat,althoughlaxfunctorsthemselvesgeneralizelaxmonoidalfunctors(asbicategoriesgeneralizemonoidal
categories),laxmonoidallaxfunctorsaredifferentagain,addinganotherdimension(asmonoidalfunctorsadda
dimensiontofunctors):alaxmonoidallaxfunctorisequivalentlyahomomorphismofone-objecttricategories.
216
Justasthereisanotionofmonoidalnaturaltransformationaccompanyingthenotionofmonoidal
functor (recall Definition 3.1.13), there is a notion of monoidal icon between lax monoidal lax
functors13,fromwhichweobtainasymmetricmonoidalcategoryofmonoidallossmodels.
Proposition5.4.9. MonoidallossmodelsandmonoidaliconsformasubcategoryMonLosspBqof
LosspBq,andthesymmetricmonoidalstructurep`,0qonthelatterrestrictstotheformer.
5.4.1. Examples
Inthissection,wepresentthemonoidalstructureonthelossmodelsconsideredabove. Because
lossmodelsLare(lax)sections,followingRemark5.4.8,thismonoidalstructureisgivenineach
` ˘
case by a lax natural family of 2-cells λ : L pc,c1qbpd,d1q ñ Lpc,c1qbLpd,d1q, for each
c,d
pair of lenses pc,c1q : pX,Aq ÑÞ pY,Bq and pd,d1q : pX1,A1q ÑÞ pY1,B1q. Such a 2-cell λ is
c,d
` ˘
itselfgivenbyalossfunctionoftypeBbB1Ý X ÝÝ b ‚Ý X Ñ 1 I satisfyingtheequationL pc,c1qbpd,d1q “
Lpc,c1qbLpd,d1q`λ ;wecanthinkofitasmeasuringthedifferencebetweenthejointgame
c,d
` ˘
L pc,c1qbpd,d1q andthe“meanfield”gamesLpc,c1qandLpd,d1qtakentogether.
FollowingJohnsonandYau[145,Eq. 4.2.3],laxnaturalityrequiresthatλsatisfythefollowing
equationof2-cells,whereK denotesthelaxator(withrespecttohorizontalcomposition˛)with
componentsKpe,cq : Le˛Lc ñ Lpe cq:
(cid:11)
pY,BqbpY1,B1q
Lpcbdq Lpebfq
Kpebf,cbdq
´ ¯
pX,AqbpX1,A1q L pe cqbpf dq pZ,CqbpZ1,C1q
(cid:11) (cid:11)
λpe c,f dq
(cid:11) (cid:11)
Lpe cqbLpf dq
(cid:11) (cid:11)
“
pY,BqbpY1,B1q
Lpcbdq Lpebfq
λpc,dq λpe,fq
pX,AqbpX1,A1q LcbLd pY,BqbpY1,B1q LebLf pZ,CqbpZ1,C1q
Kpe,cqbKpf,dq
Lpe cqbLpf dq
(cid:11) (cid:11)
13Thenotionofmonoidaliconcanbeobtainedbyweakeningthenotionofmonoidalpseudonaturaltransformation
givenbyMoellerandVasilakopoulou[189,§2.2].
217
SinceverticalcompositioninSGame isgivenonlossesby`,wecanwritethisequationas
λpe c,f dq`Kpebf,cbdq
(cid:11) (cid:11)
“ λpe,fq˛λpc,dq`Kpe,cqbKpf,dq
“ λpe,fq `λpc,dq˝pe1bf1q `Kpe,cqbKpf,dq . (5.10)
cbd cbd
Ineachoftheexamplesbelow,therefore,weestablishthedefinitionofthelaxatorλandcheckthat
itsatisfiesequation5.10.
Wewilloftenusethenotationp´q todenoteprojectionontoafactorX ofamonoidalproduct.
X
5.4.1.1. Relativeentropy
Proposition 5.4.10. The loss model KL of Proposition 5.3.22 is lax monoidal. Supposing that
pc,c1q : pX,Xq ÑÞ pY,Yq and pd,d1q : pX1,X1q ÑÞ pY1,Y1q are lenses in B, the corresponding
componentλKLpc,dqofthelaxatorisgiven,forω : IÑ‚ X bX1 andpy,y1q : Y bY1,by
„ ȷ
p px,x1q p py,y1q
λKLpc,dq py,y1q :“ E log ωXbω X1 `log pcbdq ‚ω .
ω
pc1
px,
b
x1,
d
m
1
,m
q
1q
py
„
,y1q
p ω px,x1q p pcbdq ‚pωXbω X1q py,y1q
ωX ω X1
(Note that the first term has the form of a “posterior mutual information” and the second a
log-likelihoodratio.)
Proof. Wehave
` ˘
KLpcqbKLpdq py,y1q
”ω ı
“ E logp px,m|yq´logp px,m|yq
px,mq„c1
ωX
pyq
c1
ωX
„
c:
ωX
ȷ
` E logp px1,m1|y1q´logp px1,m1|y1q
px1,m1q„d1 ω„X1 py1q
d1
ω X1
d:
ω X1 ȷ
“ E logp px,x1,m,m1|y,y1q´logp px,x1,m,m1|y,y1q
px,x1,m,m1q„
c1
ωX
bd1
ω X1
c:
ωX
bd:
ω X1
pc1 bd1 qpy,y1q
ωX ω X1
and
`
KLpcbdq py,y1q
ω
” ı
“ E logp px,x1,m,m1|y,y1q´logp px,x1,m,m1|y,y1q .
px,x1,m,m1q„
c1
ωX
bd1
ω X1
pcbdq:
ω
pc1 bd1 qpy,y1q
ωX ω X1
218
UsingBayes’rule,wecanrewritetheexactinversionsintheseexpressions,obtaining
` ˘
KLpcqbKLpdq py,y1q
ω ”
“ E logp px,x1,m,m1|y,y1q´logp py,m|xq´logp py1,m1|x1q
c1 bd1 c d
px,x1,m,m1q„ ωX ω X1
pc1 bd1 qpy,y1q
ωX ω X1 ı
´logp pxq´logp px1q`logp pyq`logp py1q
ωX ω X1 c ‚ωX d ‚ω X1
and
`
KLpcbdq py,y1q
ω
”
“ E logp px,x1,m,m1|y,y1q´logp py,m|xq´logp py1,m1|x1q
c1 bd1 c d
px,x1,m,m1q„ ωX ω X1
pc1 bd1 qpy,y1q
ωX ω X1 ı
´logp px,x1q`logp py,y1q .
ω pcbdq ‚ω
` ` ˘
WedefineλKLpc,dq py,y1qasthedifferencefrom KLpcbdq py,y1qto KLpcqbKLpdq py,y1q,
ω ω ω
andso,withalittlerearranging,weobtaintheexpressionabove:
` ` ˘
λKLpc,dq py,y1q :“ KLpcbdq py,y1q´ KLpcqbKLpdq py,y1q
ω ω „ ȷ ω
p px,x1q p py,y1q
“ E log ωXbω X1 `log pcbdq ‚ω .
pc1
px,
b
x1,
d
m
1
,m
q
1q
py
„
,y1q
p ω px,x1q p pcbdq ‚pωXbω X1q py,y1q
ωX ω X1
Next,weneedtovalidatelaxnaturality. SinceKLisstrictonlosses,weneedonlycheckthat
λKLpe c,f dq “ λKLpe,fq `λKLpc,dq˝pe1bf1q .
cbd cbd
(cid:11) (cid:11)
Bydefinition,wehave
` ˘
λKLpe,fq pz,z1q
cbd ω« ff
p py,y1q p pz,z1q
“ E log pcbdq ‚pωXbω X1q `log pebfq ‚pcbdq ‚ω
pe
p
1 c
y
b
,y
f
1,
d 1
n
q
,
ω
n
p
1
z
q
,
„
z1q
p pcbdq ‚ω py,y1q p pebfq ‚pcbdq ‚pωXbω X1q pz,z1q
and
` ˘
λKLpc,dq˝pe1bf1q pz,z1q
» cbd ω fi
„ ȷ
“ E
—
— – E log
p
ωXbω X1
px,x1q
`log
p
pcbdq ‚ω
py,y1q ffi
ffi fl .
pe
p
1 c
y
b
,y
f
1,
d 1
n
q
,
ω
n
p
1
z
q
,
„
z1q pc1 ω
p
X
x,
b
x1,
d
m
1 ω X
,m
1 q
1q
py
„
,y1q
p ω px,x1q p pcbdq ‚pωXbω X1q py,y1q
219
Andsowealsohave
λKLpe c,f dq pz,z1q
ω
„ ȷ
(cid:11) (cid:11)
p px,x1q p pz,z1q
“ E log ωXbω X1 `log pebfq ‚pcbdq ‚ω
` px,x1,m,m1q˘„ p ω px,x1q p pebfq ‚pcbdq ‚pωXbω X1q pz,z1q
pc1˝e1qbpd1˝f1q pz,z1q
` c d ω ˘ ` ˘
“ λKLpc,dq˝pe1bf1q pz,z1q` λKLpe,fq pz,z1q
cbd ω cbd ω
therebyestablishingthelaxnaturalityofλKL,bythecommutativityof`.
Remark5.4.11. AlthoughKLislaxmonoidal,itslaxnessarisesfromthestate-dependenceofthe
inversions,andwesawintheopeningofthischapter,andthenmoreformallyinRemark5.3.23,
thatinitssimplestformtherelativeentropydoesnotdependontheinversions;insomesense,the
statisticalgamestructureisextraneous.
ş
InRemark5.3.23,wesawthatD definesastrictsectionofa2-fibration K Ý π ÝKÑ B,attaching
KL
relative entropies to parallel pairs of channels and capturing their chain rule compositionally.
Sincethissectiondoesnotinvolveanyinversions,wemaythuswonderwhetheritismorethan
lax monoidal: and indeed it is! D is in fact a strong monoidal section which is moreover
KL
strict monoidal on the losses themselves. The laxator simply maps pc,c1,D pc,c1qq and
KL
pd,d1,D pd,d1qq to pc b d,c1 b d1,D pc,c1q ` D pd,d1qq; and indeed it is easy to verify
KL KL KL
thatD pcbd,c1bd1q “ D pc,c1q`D pd,d1q.
KL KL KL
5.4.1.2. Maximumlikelihoodestimation
Proposition5.4.12. ThelossmodelMLEofProposition5.3.25islaxmonoidal. Supposingthat
pc,c1q : pX,Xq ÑÞ pY,Yq and pd,d1q : pX1,X1q ÑÞ pY1,Y1q are lenses in B, the corresponding
componentλMLEpc,dqofthelaxatorisgiven,forω : IÑ‚ X bX1 andpy,y1q : Y bY1,by
p py,y1q
λMLEpc,dq py,y1q :“ log pcbdq ‚pωXbω X1q .
ω
p py,y1q
pcbdq ‚ω
Proof. To obtain the definition of λMLEpc,dq, we consider the difference from MLEpc b dq to
MLEpcqbMLEpdq:
` ˘
λMLEpc,dq py,y1q :“ MLEpcbdq py,y1q´ MLEpcqbMLEpdq py,y1q
ω ω ω
“ ´logp py,y1q`logp pyq´logp py1q
pcbdq ‚ω c ‚ωX d ‚ω X1
p py,y1q
“ log
pcbdq ‚pωXbω X1q
.
p py,y1q
pcbdq ‚ω
220
To demonstrate lax naturality, recall that MLE is a lax section, so we need to consider the
corresponding˛-laxator. FromProposition5.3.25,thelaxatorKMLEpe,cq : MLEpeq˛MLEpcq ñ
MLEpe cqisgivenbyKMLEpe,cq :“ MLEpcq˝e1. Next,observethat
c
(cid:11)
` ˘
p pz,z1q
λMLEpe c,f dq ω pz,z1q “ log
pe‚c
`
q bpf‚dq ‚pω
˘
Xbω X1q
(cid:11) (cid:11)
p pz,z1q
pe‚cq bpf‚dq ‚ω
p pz,z1q
“ log
pebfq ‚pcbdq ‚pωXbω X1q
p pz,z1q
pebfq ‚pcbdq ‚ω
“ λMLEpe,fq pz,z1q.
pcbdq‚ω
Consequently,weneedtoverifytheequation
` ˘
MLEpcbdq˝pebf1q “ λMLEpc,dq˝pe1bf1q ` MLEpcqbMLEpdq ˝pe1bf1q
cbd cbd cbd
which,bybilinearityofeffects,isequivalenttoverifying
MLEpcbdq “ λMLEpc,dq`MLEpcqbMLEpdq.
But, since ` is commutative, this is satisfied by the definition of λMLEpc,dq as a 2-cell of type
MLEpcbdq ñ MLEpcqbMLEpdq.
5.4.1.3. Freeenergy
SinceKLandMLEarebothlaxmonoidal,itfollowsthatsoisFE.
Corollary5.4.13. ThelossmodelFEofDefinition5.3.26islaxmonoidal. Supposingthatpc,c1q :
pX,Xq ÑÞ pY,Yqandpd,d1q : pX1,X1q ÑÞ pY1,Y1qarelensesinB,thecorrespondingcomponent
λFEpc,dqofthelaxatorisgiven,forω : IÑ‚ X bX1 andpy,y1q : Y bY1,by
„ ȷ
p px,x1q
λFEpc,dq py,y1q :“ E log ωXbω X1 .
ω
px,x1q„pc1 ωX bd1 ω X1 qpy,y1q p ω px,x1q
Proof. FEisdefinedasKL`MLE,andhenceλFE isobtainedasλKL`λMLE. Since`isfunctorial,
it preserves lax naturality, and so λFE is also lax natural. λFE is thus a strong transformation
FEp´qbFEp“q ñ FEp´b“q,andhenceFEislaxmonoidalbyRemark5.4.8.
5.4.1.4. Laplacianfreeenergy
In order to demonstrate that the lax monoidal structure on FE is not destroyed by the Laplace
approximation,weproveexplicitlythatLFEisalsolaxmonoidal.
221
Proposition 5.4.14. The loss model LFE of Propositions 5.3.31 and 5.3.33 is lax monoidal.
Supposing that pc,c1q : pX,Xq ÑÞ pY,Yq and pd,d1q : pX1,X1q ÑÞ pY1,Y1q are lenses in B, the
correspondingcomponentλLFEpc,dqofthelaxatorisgiven,forω : IÑ‚ XbX1andpy,y1q : Y bY1,
by
p pµ py,y1q q
λLFEpc,dq py,y1q :“ log ωXbω X1 pcbdq1 ω XX1
ω
p pµ py,y1q q
ω pcbdq1 XX1
ω
whereµ py,y1q isthepX bX1q-meanoftheGaussiandistributionpc1 bd1 qpy,y1q.
pcbdq1 ω XX1 ωX ω X1
Proof. Wehave
LFEpcbdq py,y1q
ω
“ ´logp pµ py,y1q,y,y1q´logp pµ py,y1q q
cbd pc1bd1qω ω pc1bd1qω XX1
“ ‰
´S pc1bd1q py,y1q
XX1MM1 ω
“ ´logp pµ pyq,yq´logp pµ py1q,y1q´p pµ py,y1q q
c c
“
1
ωX ‰
d
”
d1
ω X1 ı
ω pc1bd1qω XX1
´S c1 pyq ´S d1 py1q
XM ωX X1M1 ω X1
and
` ˘
LFEpcqbLFEpdq py,y1q
ω
“ LFEpcq pyq`LFEpdq py1q
ωX ω X1
“ ‰
“ ´logp pµ pyq,yq´p pµ pyq q´S c1 pyq
c c1 ωX ωX cωX X XM ωX ” ı
´logp pµ py1q,y1q´p pµ py1q q´S d1 py1q
d d1 ω X1 ω X1 d1 ω X1 X1 X1M1 ω X1
sothat
` ˘
λLFEpc,dq py,y1q “ LFEpcbdq py,y1q´ LFEpcqbLFEpdq py,y1q
ω ω ω
p pµ py,y1q q
“ log ωXbω X1 pcbdq1 ω XX1
p pµ py,y1q q
ω pcbdq1 XX1
ω
asgivenabove.
Weneedtoverifylaxnaturality,whichmeanscheckingtheequation
λLFEpe c,f dq`κpebf,cbdq “ λLFEpe,fq `λLFEpc,dq˝pe1bf1q `κpe,cqbκpf,dq
cbd cbd
(cid:11) (cid:11)
whereκisthe˛-laxatorwithcomponentsκpe,cq : LFEpeq˛LFEpcq ñ LFEpe cqgivenby
(cid:11)
”´ ¯ ı
` ˘ ` ˘
1
κpe,cq pzq “ tr B2Eµ µ pzq Σ pzq ´logp µ pzq .
π 2 y pc,πq e1 c‚π Y e1 c‚π YY c ‚π e1 c‚π Y
222
(seeProposition5.3.33). Wehave
p pµ pµ pz,z1q q q
λLFEpe c,f dq “ log ωXbω X1 pcbdq1 ω pebfq1 pcbdq‚ω YY1 XX1
(cid:11) (cid:11) p ω pµ pcbdq1 pµ pebfq1 pz,z1q YY1 q XX1 q
ω pcbdq‚ω
“ λLFEpc,dq pµ pz,z1q q q
ω pebfq1 YY1 XX1
pcbdq‚ω
and,bytheLaplaceapproximation,
`
λLFEpc,dq˝pe1bf1q q pz,z1q
cbd ω
” ı
“ E λLFEpc,dq py,y1q
ω
py,y1,n,n1q„
pe1
c
bf
d
1qωpz,z1q
« λLFEpc,dq pµ pz,z1q q
ω pebfq1 YY1
”´ pcbdq‚ω ¯´ ¯ ı
1
` tr B2 λLFEpc,dq µ pz,z1q Σ pz,z1q .
2 py,y1q ω pebfq1 pcbdq‚ω YY1 pebfq1 pcbdq‚ω pYY1qpYY1q
Wealsohave
` ˘
κpe,cqbκpf,dq pz,z1q
ω
“ κpe,cq pzq`κpf,dq pz1q
”´ ωX ¯ ω X1 ı
` ˘ ` ˘
1
“ tr B2Eµ µ pzq Σ pzq ´logp µ pzq
2 y „pc,ωXq e1 c‚ωX Y e1 c‚ωX YY c ‚ ȷ ωX e1 c ‚ωX Y
´ ¯
` ˘ ` ˘
1
` tr B2Eµ µ pz1q Σ pz1q ´logp µ pz1q
”
2
´
y1 pd,ω X1q
¯
f d 1 ‚ω X1 Y1 f d 1 ‚ω X1 Y1Y1 d ‚ω X1 f d 1 ‚ω X1 Y1
` ˘
1
“ tr B2 Eµ µ pz,z1q
2 py,y1q pcbd,ωXbω X1q pebfq1 pcbdq‚pωXıbω X1q YY1
Σ pz,z1q
pebfq1 pYY1qpYY1q
pcbdq‚pωXbω X`1q ˘
´logp µ pz,z1q .
pcbdq ‚pωXbω X1q pebfq1
pcbdq‚pωXbω X1q
YY1
Theleft-handsideofthelaxnaturalityequationisthereforegivenby
` ˘
λLFEpe c,f dq`κpebf,cbdq pz,z1q
ω
(cid:11) (cid:11)
“ λLFEpc,dq pµ pz,z1q q
ω pebfq1 YY1
”´ pcbdq‚ω ¯ ı
` ˘
1
` tr B2 Eµ µ pz,z1q Σ pz,z1q
2 py,y1 ` q pcbd,ωq pebfq1 pcbdq‚˘ω YY1 pebfq1 pcbdq‚ω pYY1qpYY1q
´logp µ pz,z1q
pcbdq‚ω pebfq1 YY1
pcbdq‚ω
223
whiletheright-handsideisgivenby
` ˘
λLFEpe,fq `λLFEpc,dq˝pe1bf1q `κpe,cqbκpf,dq pz,z1q
cbd cbd ω
p pµ pz,z1q q
“ log
pcbdq ‚pωXbω X1q pebfq1
pcbdq‚ω
YY1
p pµ pz,z1q q
pcbdq ‚ω pebfq1 YY1
pcbdq‚ω
`λLFEpc,dq pµ pz,z1q q
ω pebfq1 YY1
”´ pcbdq‚ω¯´ ¯ ı
1
` tr B2 λLFEpc,dq µ pz,z1q Σ pz,z1q
2 ”´ py,y1q ω ¯ pebfq1 pcbdq‚ω YY1 pebfq1 pcbdq‚ω pYY1qpYY1q
` ˘
1
` tr B2 Eµ µ pz,z1q
2 py,y1q pcbd,ωXbω X1q pebfq1 pcbdq‚pωıXbω X1q YY1
Σ pz,z1q
pebfq1 pYY1qpYY1q
pcbdq‚pωX`bω X1q ˘
´logp µ pz,z1q
pcbdq ‚pωXbω X1q pebfq1
pcbdq‚pωXbω X1q
YY1
“ ´logp pµ pz,z1q q`λLFEpc,dq pµ pz,z1q q
pcbdq ‚ω pebfq1 YY1 ω pebfq1 YY1
”´ pcbdq‚ω ¯´ ¯ pcbdq‚ω ı
1
` tr B2 λLFEpc,dq µ pz,z1q Σ pz,z1q
2 ”´ py,y1q ω ¯ pebfq1 pcbdq‚ω YY1 pebfq1 pcbdq‚ω pYY1qpYY1q
` ˘
1
` tr B2 Eµ µ pz,z1q
2 py,y1q pcbd,ωXbω X1q pebfq1 pcbdq‚pωıXbω X1q YY1
Σ pz,z1q .
pebfq1 pYY1qpYY1q
pcbdq‚pωXbω X1q
Thedifferencefromtheleft-totheright-handsideisthus
”´ ¯ ı
` ˘
1
tr B2 Eµ µ pz,z1q Σ pz,z1q
2 ” py ´ ,y1q pcbd,ωq pebfq1 pc¯bdq‚ω YY1 pebfq1 pcbdq‚ω pYY1qpYY1q
` ˘
1
´ tr B2 Eµ µ pz,z1q
2 py,y1q pcbd,ωXbω X1q pebfq1 pcbdq‚pωXbω Xı1q YY1
Σ pz,z1q
pebfq1 pYY1qpYY1q
”´ pcbdq‚p¯ ωX´bω X1q ¯ ı
1
´ tr B2 λLFEpc,dq µ pz,z1q Σ pz,z1q .
2 py,y1q ω pebfq1 pcbdq‚ω YY1 pebfq1 pcbdq‚ω pYY1qpYY1q
Now,bydefinitionΣ “ Σ ,andsobythelinearityofthetraceandof
pebfq1 pebfq1
pcbdq‚ω pcbdq‚pωXbω X1q
derivation,thisdifferencesimplifiesto
”´ ´ ¯¯
1
tr B2 Eµ ´Eµ ´λLFEpc,dq
2
`
py,y1q pcbd,ωq pcbd
˘
,ωXbω X1q ω ı
µ pz,z1q Σ pz,z1q .
pebfq1 YY1 pebfq1 pYY1qpYY1q
pcbdq‚ω pcbdq‚ω
224
` ˘
RecallfromtheproofofProposition5.3.33thatEµ pyq :“ E µ pyq,y ,andhence
pc,πq pc,πq c1 π
` ˘
Eµ ´Eµ py,y1q
pc
`
bd,ωq pcbd,ωXbω X1q
˘` ˘
“ E ´E µ py,y1q,y,y1
pcbd,ωq pcbd,ωXbω X1q pcbdq1
ω
“ ´logp pµ py,y1q q`logp pµ py,y1q q
ω pcbdq1 ω XX1 ωXbω X1 pcbdq1 ω XX1
p pµ py,y1q q
“ log ωXbω X1 pcbdq1 ω XX1
p pµ py,y1q q
ω pcbdq1 XX1
ω
“ λLFEpc,dq py,y1q
ω
sothatEµ ´Eµ ´λLFEpc,dq “ 0. ThisestablishesthatλLFE islaxnatural.
pcbd,ωq pcbd,ωXbω X1q ω
5.5. Discussion
Havingestablishedthebasicstructureofstatisticalgamesandahandfulofexamples,thereismuch
moretobedone,andsointhissectionwediscussanumberofseeminglyfruitfulavenuesoffuture
research.
An important such avenue is the link between this structure and the similar structure of
diegeticopen(economic)games[51],arecentreformulationofcompositionalgametheory[119],
which can also be understood as a constituting a fibration over lenses. Accordingly, the close
connectionbetweengametheoryandreinforcementlearning[25,128]suggeststhatalgorithms
forapproximateinference(suchasexpectation-maximization)andreinforcementlearning(such
asdynamicprogramming)aremorethansuperficiallysimilar. Morebroadly,weexpectallthree
ofactiveinference,gametheory, andreinforcementlearningtofitintothegeneralprogramme
of categorical systems theory [192] (with cybernetic extensions [54, 251]), and we expect that
reframingthesedisciplinesinthiswaywillelucidatetheirrelationships. InChapter7,wesupply
functorial dynamical semantics for approximate inference — a form of approximate inference
algorithm—butweleavetheexpressionofthisinsystems-theoretictermstofuturework. Likewise,
weleavetothefuturethestudyoftheperformanceandconvergenceofalgorithmsbuiltuponthese
compositionalfoundations14.
Another avenue for further investigation concerns mathematical neatness. First, we seek an
abstractcharacterizationofcopy-compositionandCopara : OwenLynchhassuggestedtous
2
14Itisnotclearthatthefixedpointsofjointlyoptimizingthefactorsofacompositestatisticalgamearethesame
asthoseoftheoptimizationofthecomposite. Ifoneisonlyconcernedwithoptimizingtheinversions,thenthe
lens-likecompositionruletellsusthatwemayproceedbybackwardinduction,firstoptimizingthefactornearestthe
codomain,andthenoptimizingeachremainingfactorinturnbacktowardsthedomain.Buttheproblemisharderif
wealsowishtooptimizetheforwardchannels,astheinversionnearestthecodomainstilldependsontheforward
channelnearestthedomain.
225
thatthecomputationbycompilersof“staticsingle-assignmentform”(SSA)[152]bycompilersmay
haveasimilarstructure,andsoweexpectanabstractcharacterizationtocapturebothSSAandour
examples;wealsohopethatamoreabstractapproachwillalleviatesomeofthehigher-categorical
complexity resulting from the weakness of copy-composition. Second, the explicit constraint
definingsimplecoparameterizedBayesianlensesisinelegant;asindicatedinRemark5.2.21,we
expect that using dependent optics [43, 50, 276] may help to encode this constraint in the type
signature,atthecostofhigher-poweredmathematicalmachinery.
Finally,weseekfurtherexamplesoflossmodels,andmoreabstract(andhopefullyuniversal)
characterizationsofthosewealreadyhave;forexample,itisknownthattheShannonentropyhas
atopologicalorigin[40]viaa“nonlinearderivation”[169],andweexpectthatwecanfollowthis
connectionfurther. Infollowingthispath,weexpecttomakeuseofthedualitybetweenalgebra
andgeometry[180,194](andtheirintersectionin(quantitative)categoricallogic[55,140]),for
as we have already noted, loss functions have a natural algebraic structure. We consider such
investigationspartofthenascentfieldofcategoricalinformationgeometry.
226
6. Open dynamical systems, coalgebraically
In Chapter 3, we saw how to compose neural circuits together using an algebraic approach
to connectomics. These neural circuits are dynamical systems, formalized as sets of ordinary
differentialequations. However,simplyspecifyingthesesetsobscuresthegeneralcompositional
structureofdynamicalsystemsthemselves,therevelationofwhichsupportsasubtlerintertwining
of syntax and semantics, form and function—or, as it happens, algebra and coalgebra. In this
chapterwebeginbyintroducingcategoricallanguagefordescribinggeneraldynamicalsystems
‘behaviourally’. Thesesystemswillbe‘closed’(non-interacting),andsowethenexplainhowthe
languageofcoalgebra,andspecificallypolynomialcoalgebras,canbeusedtoopenthemup.
However, traditional coalgebraic methods are restricted to discrete-time dynamical systems,
whereaswearealsointerestedinthecontinuous-timesystemsthatarecommonlyusedinscience,
such as our earlier neural circuits. This motivates the development of a class of generalized
polynomialcoalgebrasthatmodelopensystemsgovernedbyageneraltimemonoid,andwhich
thereforeencompasssystemsofdynamicallyinteractingordinarydifferentialequations. Inorderto
accountforstochasticdynamics,wegeneralizethesituationstillfurther,byredefiningthecategory
ofpolynomialfunctorssothatitcanbeinstantiatedinanondeterministicsetting. Thiswillshowus
howtodefineopenMarkovprocessescoalgebraically,andwealsodemonstraterelatedcategories
ofopenrandomdynamicalsystems.
Finally,weusethepolynomialsettingtopackagethesesystemsintomonoidalbicategoriesof
‘hierarchical’cyberneticsystems,ofwhichsomeareusefullygenerateddifferentially. Inthenext
chapter,thesebicategorieswillprovidethesettinginwhichwecastthedynamicalsemanticsof
approximateinference.
Remark6.0.1. Thestorytoldinthischapterisofaformsimilartothatofcategoricalsystems
theory[191,192],inwhichsystemsoninterfacescollectinto(doubly)indexed(double)categories.
Thatstorytellsageneraltale,buthereweareinterestedinaspecificcase: coalgebraicsystems
withpolynomialinterfaceswhosetimeevolutionisgovernedbyanarbitrarymonoidandwhich
mayhavenon-determinismorsideeffectsgovernedbyamonad. Suchsystemsappeartositata
227
sweetspotofscientificutility;inparticular,thenextchapterwillusethemtoformalizemodelsof
predictivecoding. Infuturework,weintendtoconnectthetwostories,expressingourgeneralized
polynomialcoalgebrasinthedouble-categoricalframework.
6.1. Categorical background on dynamics and coalgebra
Inthissection,weintroducethebackgroundmaterialneededforourdevelopmentofopendynamical
systemsaspolynomialcoalgebras.
6.1.1. DynamicalsystemsandMarkovchains
We begin by recalling a ‘behavioural’ approach to dynamical systems popularized by Lawvere
andSchnauel[164](whogiveapedagogicalaccount). Thesesystemsare‘closed’inthesensethat
theydonotrequireenvironmentalinteractionfortheirevolution. Later,whenweconsideropen
systems,their‘closures’(inducedbyinteractionwithanenvironment)willconstitutedynamical
systemsofthisform.
The evolution of dynamics is measured by time, and we will take time to be represented by
anarbitrarymonoidpT,`,0q. Thisallowsustoconsidertime-evolutionthatisnotnecessarily
reversible,suchasgovernedbyNorR ,aswellasreversibleevolutionthatisproperlygoverned
`
bygroupssuchasZorR. Withthisinmind,wegiveaclassicdefinitionofdynamicalsystem,asa
T-action.
Remark6.1.1. WewillworkinanabstractcategoryE whoseobjectsareconsideredtobe“state
spaces”; its morphisms will determine the nature of the dynamical evolution. Therefore, for
deterministic systems, we can take E simply to be Set, or alternatively some other Cartesian
categoryorcategoryofcomonoidhomomorphisms. Forstochasticsystems,wemaytakeE tobe
acopy-discardcategorysuchasKℓpDqorsfKrn,orsomeothercategorywhosemorphismsare
consideredtobestochasticmaps. Fordifferentialsystems,wewillrequireE tobeequippedwitha
tangentbundleendofunctorT;moreonthisin§6.3.2.
Definition6.1.2. LetpT,`,0qbeamonoid,representingtime. LetX : E besomespace,called
the state space. Then a closed dynamical system ϑ with state space X and time T is an action of
T on X. When T is also an object of E, then this amounts to a morphism ϑ : TˆX Ñ X (or
equivalently,atime-indexedfamilyofX-endomorphisms,ϑptq : X Ñ X),suchthatϑp0q “ id
X
andϑps`tq “ ϑpsq˝ϑptq. Inthisdynamicalcontext,wewillrefertotheactionaxiomsasthe
flowconditions,astheyensurethatthedynamicscan‘flow’.
228
Notethat,indiscretetime,thisdefinitionimpliesthatadynamicalsystemisgovernedbyasingle
transitionmap.
Proposition6.1.3. IndiscretetimeT “ N,anydynamicalsystemϑisentirelydeterminedbyits
actionat1 : T. Thatis,lettingthestatespacebeX,wehaveϑptq “ ϑp1q˝t whereϑp1q˝t means
“composeϑp1q : X Ñ X withitselfttimes”.
Proof. Theproofisbyinductionont : T. Wemusthaveϑp0q “ id andϑpt`sq “ ϑptq˝ϑpsq. So
X
foranyt,wemusthaveϑpt`1q “ ϑptq˝ϑp1q. Theresultfollowsimmediately;noteforexample
thatϑp2q “ ϑp1`1q “ ϑp1q˝ϑp1q.
An ordinary differential equation x9 “ fpxq defines a vector field x ÞÑ px,fpxqq on its state
spaceX,anditssolutionsxptqfort : Rdefineinturnacloseddynamicalsystem,asthefollowing
examplesketches.
Example6.1.4. LetTdenoteatangentbundlefunctorE Ñ E ontheambientcategoryofspaces
E. Suppose X : U Ñ TU is a vector field on U, with a corresponding solution (integral curve)
χ : R Ñ U forallx : U;thatis,χ1ptq “ Xpχ ptqqandχ p0q “ x. Thenlettingthepointxvary,
x x x
weobtainamapχ : RˆU Ñ U. ThisχisacloseddynamicalsystemwithstatespaceU andtime
R.
Sofar,wehaveabstainedfromusingmuchcategoricallanguage. Butthesecloseddynamical
systemshaveasimplecategoricalrepresentation.
Proposition6.1.5. CloseddynamicalsystemswithstatespacesinE andtimeTaretheobjectsof
thefunctorcategoryCatpBT,Eq,whereBTisthedeloopingofthemonoidT. (Recalldelooping
fromProp. 3.1.24.) Morphismsofdynamicalsystemsarethereforenaturaltransformations.
Proof. ThecategoryBThasasingleobject˚andmorphismst : ˚ Ñ ˚foreachpointt : T;the
identityisthemonoidalunit0 : Tandcompositionisgivenby`. Afunctorϑ : BT Ñ E therefore
picks out an object ϑp˚q : E, and, for each t : T, a morphism ϑptq : ϑp˚q Ñ ϑp˚q, such that
thefunctorialityconditionissatisfied. Functorialityrequiresthatidentitiesmaptoidentitiesand
compositionispreserved,sowerequirethatϑp0q “ id andthatϑps`tq “ ϑpsq˝ϑptq. Hence
ϑp˚q
thedataforafunctorϑ : BT Ñ E amounttothedataforacloseddynamicalsysteminE with
timeT,andthefunctorialityconditionamountspreciselytotheflowcondition. Amorphismof
closeddynamicalsystemsf : ϑ Ñ ψ isamaponthestatespacesf : ϑp˚q Ñ ψp˚qthatcommutes
229
withtheflow,meaningthatf satisfiesf ˝ϑptq “ ψptq˝f foralltimest : T;thisispreciselythe
definitionofanaturaltransformationf : ϑ Ñ ψ betweenthecorrespondingfunctors.
BychangingthestatespacecategoryE,thissimpleframeworkcanrepresentdifferentkindsof
dynamics. Forexample,bychoosingE tobeacategoryofstochasticchannels,suchasKℓpDqor
sfKrn,weobtaincategoriesofclosedMarkovprocesses.
Example6.1.6(ClosedMarkovchainsandMarkovprocesses). AclosedMarkovchainisgivenby
astochastictransitionmapXÑ‚ X,typicallyinterpretedasaKleislimorphismX Ñ PX forsome
probabilitymonadP : E Ñ E (cf. §4.1.5onprobabilitymonads). Followingthediscussionabove,a
` ˘
closedMarkovchainisthereforeanobjectinCat BN,KℓpPq . WithmoregeneraltimeT,one
` ˘
obtains closed Markov processes: objects in Cat BT,KℓpPq . More explicitly, a closed Markov
processisatime-indexedfamilyofMarkovkernels;thatis,amorphismϑ : TˆX Ñ PX such
that, for all times s,t : T, ϑ “ ϑ ‚ϑ as a morphism in KℓpPq. Note that composition ‚ in
s`t s t
KℓpPqistypicallygivenbytheChapman-Kolmogorovequation,sothismeansthat
ż
ϑ py|xq “ ϑ py|x1qϑ pdx1|xq.
s`t s t
x1:X
6.1.2. Coalgebra
Wesawabovethatacloseddiscrete-timedeterministicdynamicalsystemisafunctionX Ñ X,
and that a closed discrete-time Markov chain is a function X Ñ PX. This suggests a general
patternfordiscrete-timedynamicalsystems,asmorphismsX Ñ FX forsomeendofunctorF:
suchamorphismiscalledacoalgebrafortheendofunctorF.
Definition6.1.7. LetF : E Ñ E beanendofunctor. Acoalgebrafor F,orF-coalgebra,isapair
pX,cqofanobjectX : E andamorphismc : X Ñ FX.
AmorphismofF-coalgebrasorcoalgebramorphismpX,cq Ñ pX1,c1qisamorphismf : X Ñ
X1 thatcommuteswiththecoalgebrastructures;i.e.,thatmakesthefollowingdiagramcommute:
f
X X1
c c1
FX FX1
Ff
F-coalgebras and their morphisms constitute a category, denoted CoalgpFq. The identity
morphismonpX,cqissimplytheidentitymorphismid : X Ñ X.
X
230
Remark6.1.8. In§3.4.1,webrieflydiscussedthenotionofcoalgebraforacomonad,whichisa
coalgebrainthesenseoftheprecedingdefinitionthatadditionallysatisfiesaxiomsdualtothose
definingalgebrasforamonad(Definition3.4.16). Inourdynamicalapplications,theendofunctors
notingeneralbecomonads,andsoitdoesnotmakesensetodemandsuchaxioms.
Remark6.1.9. Atthesametime,thedualityofalgebraandcoalgebraunderliesthesubtlepowers
ofthefieldofcoalgebraiclogic,inwhichthealgebraicstructureoflogicalsyntaxisusedtodefine
constraintsonorpropositionsaboutthebehavioursofdynamicalsystems[62,72,138,162,207].
Thesetoolsareparticularlyusefulinsettingofformalverification,whereitisdesirabletoprove
thatsystemsbehaveaccordingtoaspecification(forinstance,forsafetyreasons).
WiththenotionofF-coalgebratohand,weimmediatelyobtaincategoriesofcloseddiscrete-time
deterministicsystemsandMarkovchains:
Example6.1.10. Thecategoryofcloseddiscrete-timedeterministicdynamicalsystemsinE isthe
categoryCoalgpidqofcoalgebrasfortheidentityendofunctorid : E Ñ E.
E
Example6.1.11. LetP : E Ñ E beaprobabilitymonadonE. ThecategoryofMarkovchainsis
thecategoryCoalgpPqofP-coalgebras.
Of course, polynomial functors are endofunctors Set Ñ Set, so they come with a notion of
coalgebra,andwemayaskhowsuchobjectsbehave.
Example 6.1.12. Suppose p : Set Ñ Set is a polynomial functor. A coalgebra for p is a
ř
function c : X Ñ pX for some set X. By Definition 3.5.2, we can write p as ypris, and
i:pp1q
ř
hence the p-coalgebra c has the form c : X Ñ Xpris. Such a function corresponds to a
i:pp1q
choice,foreachx : X,ofanelementofpp1qwhichwedenotecopxqandanassociatedfunction
cu : prc pxqs Ñ X. We can therefore write c equivalently as a pair pco,cuq where cu is the
x 1
ř ř
coproduct cu : prcopxqs Ñ X. We think of p as defining the interface of the dynamical
x x x
systemrepresentedbyc,withpp1qencodingthesetofpossible‘outputs’or‘configurations’ofthe
system,eachpristhesetofpossible‘inputs’forthesystemwhenitisinconfigurationi : pp1q,and
X asthedynamicalstatespace. Thecoalgebraccanthenbeunderstoodasanopendiscrete-time
dynamicalsystem:themapcutakesastatex : X andacorrespondinginputinprcopxqsandreturns
thenextstate;andthemapco takesastatex : X andreturnsthesystem’scorrespondingoutputor
configurationcopxq.
231
ř
A pair of functions co : X Ñ pp1q and cu : prcopxqs Ñ X is precisely a morphism
x
c : XyX Ñ pofpolynomials,andsowehaveestablishedamappingfromp-coalgebraspX,cqto
morphismsXyX Ñ p. Infact,wehaveastrongerresult.
Proposition6.1.13. Thereisanisomorphismofhom-setsPolypAyB,pq – SetpA,pBqnatural
in A,B,p, and hence adjunctions p´qyB % p´q ˝ B : Poly Ñ Set and Ayp´q % p ˝ p´q :
Polyop Ñ Set.
Proofsketch. InExample6.1.12,weestablishedamappingSetpA,pBq Ñ PolypAyB,pqforthe
case where A “ B; the general case is analogous. The inverse mapping follows directly from
Proposition3.5.4. NaturalityinAandB followsfromnaturalityofpre-composition;naturalityin
pfollowsfromnaturalityofpost-composition.
Polynomialcoalgebrasthereforeconstituteatypeofopendiscrete-timedynamicalsystems. But
whatifwewantopencontinuous-timedynamicalsystems:dothesefitintothecoalgebraformalism?
Inadifferentdirection,whatifwewantopenMarkovchains? Indiscretetime,weshouldbeableto
considercoalgebrasforcompositeendofunctorspP,butwhatifwewanttodothisingeneraltime?
Letusturnnowtoansweringthesequestions.
6.2. Open dynamical systems on polynomial interfaces
Inthissection,webeginbyincorporatingdynamicalsystemsingeneraltimeintothecoalgebraic
framework,beforegeneralizingthenotionofpolynomialfunctortoincorporate‘side-effects’such
asrandomness. Theresultingframeworkwillallowustodefinetypesofsystemofinterest,suchas
openMarkovprocesses,quitegenerallyusingcoalgebraicmethods,andinthesubsequentsections
wewillmakemuchuseofthenewlyavailablecompositionality.
6.2.1. Deterministicsystemsingeneraltime
Inthissection,letussupposeforsimplicitythattheambientcategoryE isSet. Wewillbeginby
statingourgeneraldefinition,beforeexplainingthestructuresandintuitionsthatjustifyit.
Definition 6.2.1. A deterministic open dynamical system with interface p : Poly, state space
S : Set and time T : Set is a morphism β : SyS Ñ rTy,ps of polynomials, such that, for any
sectionσ : p Ñ y ofp,theinducedmorphism
SyS ÝÑ β rTy,ps Ý r Ý T Ý y, Ý σ Ñ s rTy,ys ÝÑ „ y T
isa◁-comonoidhomomorphism.
232
To see how such a morphism β is like an ‘open’ version of the closed dynamical systems
of §6.1.1, note that by the tensor-hom adjunction, β can equivalently be written with the type
TybSyS Ñ p.Inturn,suchamorphismcorrespondstoapairpβo,βuq,whereβoisthecomponent
‘on configurations’ with the type TˆS Ñ pp1q, and βu is the component ‘on inputs’ with the
ř ř
type prβopt,sqs Ñ S. Wewillcallthemapβo theoutputmap,asitchoosesanoutput
t:T s:S
configurationforeachstateandmomentintime;andwewillcallthemapβu theupdatemap,asit
takesastates : S,aquantityoftimet : T,andaninputinprβopt,sqs,andreturnsanewstate. We
mightimaginethenewstateasbeinggivenbyevolvingthesystemfromsfortimet,andtheinput
assuppliedwhilethesystemisintheconfigurationcorrespondingtops,tq.
Itis,however,notsufficienttoconsidermerelysuchpairsβ “ pβo,βuqtobeouropendynamical
systems,forweneedthemtobelike‘open’monoidactions: evolvingfortimetthenfortimes
mustbeequivalenttoevolvingfortimet`s,giventhesameinputs. Itisfairlyeasytoprovethe
following proposition, whose proof we defer until after establishing the categories Coalg T ppq,
whenweproveitinanalternateformasProposition6.2.4.
Proposition 6.2.2. Comonoid homomorphisms SyS Ñ y T correspond bijectively with closed
dynamicalsystemswithstatespaceS,inthesensegivenbyfunctorsBT Ñ Set.
Thisestablishesthatseekingsuchacomonoidhomomorphismwillgiveusthemonoidaction
propertythatweseek,andsoitremainstoshowthatacompositecomonoidhomomorphismofthe
formrTy,σs˝β isacloseddynamicalsystemwiththe“rightinputs”. Unwindingthiscomposite,
wefindthattheconditionthatitbeacomonoidhomomorphismcorrespondstotherequirement
that,foranyt : T,theclosureβσ : TˆS Ñ S ofβ byσ givenby
ÿ
βσptq :“ S Ý β Ý o Ý pt Ý q˚ ÝÑ σ prβopt,sqs Ý β Ñ u S
s:S
constitutesacloseddynamicalsystemonS. Theideahereisthatσ givesthe‘context’inwhichwe
canmakeanopensystemclosed, therebyformalizingthe“giventhesameinputs”requirement
above.
Withthisconceptualframeworkinmind,weareinapositiontorenderopendynamicalsystems
onpwithtimeTintoacategory, whichwewilldenotebyCoalg T ppq. Itsobjectswillbepairs
pS,βqwithS andβ anopendynamicalonpwithstatespaceS;wewilloftenwritethesepairs
equivalentlyastriplespS,βo,βuq,makingexplicittheoutputandupdatemaps. Morphismswillbe
mapsofstatespacesthatcommutewiththedynamics:
233
Proposition 6.2.3. Open dynamical systems over p with time T form a category, denoted
Coalg T ppq. Itsmorphismsaredefinedasfollows. Letϑ :“ pX,ϑo,ϑuqandψ :“ pY,ψo,ψuqbe
twodynamicalsystemsoverp. Amorphismf : ϑ Ñ ψ consistsinamorphismf : X Ñ Y such
ř
that, for any time t : T and section σ : pp1q Ñ pris of p, the following naturality squares
i:pp1q
commute:
ř
X
ϑoptq˚σ
prϑopt,xqs
ϑuptq
X
x:X
f f
ř
Y prψopt,yqs Y
ψoptq˚σ ψuptq
y:Y
Theidentitymorphismid onthedynamicalsystemϑisgivenbytheidentitymorphismid on
ϑ X
itsstatespaceX. Compositionofmorphismsofdynamicalsystemsisgivenbycompositionofthe
morphismsofthestatespaces.
Proof. Weneedtocheckunitalityandassociativityofcomposition. Thisamountstocheckingthat
thecompositenaturalitysquarescommute. Butthisfollowsimmediately,sincethecompositeof
twocommutativediagramsalongacommonedgeisagainacommutativediagram.
WecanalternativelystateProposition6.2.2asfollows,notingthatthepolynomialy represents
thetrivialinterface,exposingnoconfigurationtoanyenvironmentnorreceivinganysignalsfrom
it:
Proposition6.2.4. Coalg T pyqisequivalenttotheclassicalcategoryCatpBT,Setqofclosed
id
dynamicalsystemsinSetwithtimeT.
Proof. Thetrivialinterfacey correspondstothetrivialbundleid : 1 Ñ 1. Therefore,adynamical
1
system over y consists of a choice of state space S along with a trivial output map ϑo “ :
TˆS Ñ 1 and a time-indexed update map ϑu : TˆS Ñ S. This therefore has the form of a
classical closed dynamical system, so it remains to check the monoid action. There is only one
section of id , which is again id . Pulling this back along the unique map ϑoptq : S Ñ 1 gives
1 1
ϑoptq˚id “ id . Thereforetherequirementthat,givenanysectionσ ofy,themapsϑu˝ϑoptq˚σ
1 S
formanactionmeansinturnthatsodoesϑu : TˆS Ñ S. Sincethepullbackoftheuniquesection
id alongthetrivialoutputmapϑoptq “ : S Ñ 1ofanydynamicalsysteminCoalg T pyqisthe
1 id
identityofthecorrespondingstatespaceid ,amorphismf : pϑp˚q,ϑu, q Ñ pψp˚q,ψu, qin
S
Coalg T pyqamountspreciselytoamapf : ϑp˚q Ñ ψp˚qonthestatespacesinSetsuchthatthe
id
234
naturalityconditionf ˝ϑuptq “ ψuptq˝f ofProposition6.1.5issatisfied,andeverymorphismin
CatpBT,SetqcorrespondstoamorphisminCoalg T pyqinthisway.
id
Nowthatweknowthatourconceptofopendynamicalsystemsubsumesclosedsystems,letus
considersomemoreexamples.
Example 6.2.5. Consider a dynamical system pS,ϑo,ϑuq with outputs but no inputs. Such a
systemhasa‘linear’interfacep :“ Oy forsomeO;alternatively,wecanwriteitsinterfacepas
the‘bundle’id : O Ñ O. Asectionofthisbundlemustagainbeid ,andsoϑoptq˚id “ id .
O O O S
Onceagain,theupdatemapscollectintotoacloseddynamicalsysteminCatpBT,Setq;justnow
wehaveoutputsϑo : TˆS Ñ pp1q “ O exposedtotheenvironment.
Proposition6.2.6. Whentimeisdiscrete,aswithT “ N,anyopendynamicalsystempX,ϑo,ϑuq
overpisentirelydeterminedbyitscomponentsat1 : T.Thatis,wehaveϑoptq “ ϑop1q : X Ñ pp1q
ř
andϑuptq “ ϑup1q : prϑopxqs Ñ X. Adiscrete-timeopendynamicalsystemisthereforea
x:X
ř
triplepX,ϑo,ϑuq,wherethetwomapshavetypesϑo : X Ñ pp1qandϑu : prϑopxqs Ñ X.
x:X
Proof. Supposeσ isasectionofp. Werequireeachclosureϑσ tosatisfytheflowconditions,that
ϑσp0q “ id andϑσpt`sq “ ϑσptq˝ϑσpsq. Inparticular,wemusthaveϑσpt`1q “ ϑσptq˝ϑσp1q.
X
Byinduction,thismeansthatwemusthaveϑσptq “ ϑσp1q˝t(compareProposition6.1.3). Therefore
wemustingeneralhaveϑoptq “ ϑop1qandϑuptq “ ϑup1q.
Remark 6.2.7. Note that the preceding proposition means that the objects of Coalg N ppq are
theobjectsofthetraditionalcategoryCoalgppqofp-coalgebras. Infact,wehavemorethanthis:
Coalg N ppq – Coalgppq;cf. Example6.1.12andProposition6.1.13.
Example6.2.8. Wecanexpress‘open’vectorfieldsinthisframework. SupposethereforethatX is
adifferentiablemanifold(andwriteX equallyforitsunderlyingsetofpoints),andletx9 “ fpx,aq
and b “ gpxq, with f : X ˆA Ñ TX and g : X Ñ B. Then, as for the ‘closed’ vector fields
ş
of Example 6.1.4, this induces an open dynamical system pX, f,gq : Coalg R pByAq, where
ş
f : RˆX ˆA Ñ X returnsthepX,Aq-indexedsolutionsoff.
Example 6.2.9. The preceding example is easily extended to the case of a general polynomial
ř
interface. Supposesimilarlythatx9 “ fpx,a qandb “ gpxq,nowwithf : prgpxqs Ñ TX
x x:X
ş
and g : X Ñ pp1q. Then we obtain an open dynamical system pX, f,gq : Coalg R ppq, where
ş ř
now f : Rˆ prgpxqs Ñ X isthe‘update’andg : X Ñ pp1qthe‘output’map.
x:X
235
Bylettingthepolynomialpvary,itisquitestraightforwardtoextendCoalg T ppqtoanopindexed
categoryCoalg T.
Proposition 6.2.10. Coalg T extends to an opindexed category Coalg T : Poly Ñ Cat. On
objects(polynomials),itreturnsthecategoriesabove. Onmorphismsofpolynomials,wesimply
post-compose: givenφ : p Ñ q andβ : SyS Ñ rTy,ps,obtainSyS Ñ rTy,ps Ñ rTy,qsinthe
obviousway.
WhenweintroducedPoly in§3.5,itwasasa“syntaxforinteractingadaptivesystems”,and
weknowthatwecanunderstandPolymulticategorically,asithasamonoidalstructurepb,yq
allowingustoplacesystems’interfacesside-by-side(andwhichthereforegivesusamulticategory,
OPolybyProposition3.3.4). Wemotivatedourdevelopmentofcoalgebraicdynamicalsystemsas
acompositionalextensionofthesetsofordinarydifferentialequationsthatweusedtoformalize
rate-codedneuralcircuits(Definition3.3.10),andwehaveseenthatlinearcircuitdiagramsembed
intoPoly(Remark4.2.33).
Onemaywonder,therefore,whethertheopindexedcategoriesCoalg Tmightsupplythegeneral
“semantics for interacting adaptive systems” that we seek: more precisely, is Coalg T a Poly-
algebra? Thisquestioncanbeansweredaffirmatively,asCoalg T islaxmonoidal: moreprecisely,
itisastrongmonoidalopindexedcategory.
Proposition6.2.11. Coalg T isamonoidalopindexedcategorypPoly,b,yq Ñ pCat,ˆ,1q.
Proof. We need to define a natural family of functors µ : Coalg T ppq ˆ Coalg T pqq Ñ
p,q
Coalg T ppbqqconstitutingthelaxator,andaunitη : 1 Ñ Coalg T pyq,alongwithassociatorsα
andleftandrightunitorsλandρsatisfyingthepseudomonoidaxiomsofDefinition4.2.19.
Theunitη : 1 Ñ Coalg T pyqisgivenbythetrivialsystemp1,!,!qwiththetrivialstatespace
and the trivial interface: the output map is the unique map 1 Ñ 1 (the identity); likewise, the
updatemapistheuniquemap1ˆ1 Ñ 1. Notethat1ˆ1 – 1.
The laxator µ is given on objects pX,ϑq : Coalg T ppq and pY,φq : Coalg T pqq by the
p,q
` ˘
µ pϑ,φq :“ XY,pϑφq wherethestatespaceXY “ X ˆY andpϑφqisthesystemgivenby
p,q
therightadjunctof
XYyXY bTy Ý „ Ý b ÝÝÑ y XyX bYyY bTybTy Ý X ÝÝ yX ÝÝ b Ý sw Ý a Ý pb ÝÝ T Ñ y XyX bTybYyY bTy Ý ϑ Ý 5 Ý b Ý φ Ñ 5 pbq
underthetensor-homadjunctioninPoly,whereϑ5 andφ5 arethecorrespondingleftadjunctsof
ϑandφ,andwhere„istheisomorphismXYyXY ÝÑ „ XyXbYyY. Onmorphismsf : pX,ϑq Ñ
236
pX1,ϑ1qandg : pY,φq Ñ pY1,φq,µ actsasµ pf,gq :“ fˆg;functorialityhencefollowsfrom
p,q p,q
thatofˆ.
Next, we need to define µ on morphisms ζ : p Ñ p1 and ξ : q Ñ q1 of polynomials, giving
` ˘
naturalisomorphismsµ : µ ˝ Coalg T pζqˆCoalg T pξq ñ Coalg T pζbξq˝µ . Butitis
ζ,ξ p1,q1 p,q
` ˘
easytoseeinfactthatµ ˝ Coalg T pζqˆCoalg T pξq “ Coalg T pζ bξq˝µ ,asbothsides
p1,q1 p,q
actbypost-composingζ bξ.
Theassociatorisdefinedcomponentwiseonobjectsas
´ ¯ ´ ¯
α : pXYqZypXYqZ Ý p Ý ϑ Ý b Ý φ Ý qb ÝÑ ψ rppbqqbr,Tys ÞÑ XpYZqyXpYZq Ý ϑ Ý b Ý p Ý φ Ý b Ý ψ Ñ q rpbpqbrq,Tys
p,q,r
andonmorphismsasα : pf ˆgqˆh ÞÑ f ˆpgˆhq,implicitlyusingtheassociatorsofbon
p,q,r
PolyandˆonSet.
Likewise,theleftunitorisdefinedby
´ ¯ ´ ¯
λ : 1Xy1X Ý µ Ýy,ÝpÝ pη Ý ,ϑ Ñ q rybp,Tys ÞÑ XyX ÝÑ ϑ rp,Tys
p
implicitlyusingtheleftunitorsofbonPolyandˆonSet;andtherightunitorisdefineddually,
usingthecorrespondingrightunitorsonPolyandSet.
That the associators and unitors satisfy the indexed monoidal category axioms follows from
thesatisfactionofthemonoidalcategoryaxiomsbypPoly,b,yqandpSet,ˆ,1q. (Butitiseasy,
thoughlaborious,toverifythismanually.)
Remark 6.2.12. We emphasize that the functor Coalg T is lax monoidal—the laxators are not
equivalences—sincenotallsystemsovertheparallelinterfacepbq factorintoasystemoverp
alongsideasystemoverq.
With this indexed monoidal structure, we can show that, as we might hope from a general
semanticsforinteractingdynamicalsystems,Coalgsubsumesourearlierlinearcircuitalgebraof
rate-codedneuralcircuits.
Proposition6.2.13. Thereisaninclusionιofmonoidalindexedcategoriesasinthediagram
` ˘
LinCirc,`,p0,0q R pSet,ˆ,1q
ι
CoalgR
pPoly,b,yq pCat,ˆ,1q
whereRisthealgebrafromProposition3.3.12.
237
Proofsketch. ιisdefinedbyafamilyoffunctorsι
pno,niq
: Rpn
o
,n
i
q Ñ Coalg R pRnoy Rniq,where
each set Rpn ,n q is treated as the corresponding discrete category; this means that ι is
o i pno,niq
triviallyfunctorial,andneedsonlybedefinedonobjects(rate-codedneuralcircuits). Eachsuch
circuitpλ,α,β,γ,Wqdefinesan‘open’ordinarydifferentialequationbyDefinition3.3.10with
inputsi : Rni .ι isthendefinedbytakingthisordinarydifferentialequationtoacorresponding
pno,niq
opendynamicalsystemfollowingExample6.2.8,wheretheoutputspaceisthesameasthestate
spaceRno andtheoutputmapisidRno .
Wethenneedtocheckthatthisdefinitionofιisnatural,meaningthatthefollowingdiagram
commutesforeachlinearcircuitdiagrampA,Bq : pn ,n q Ñ pm ,m q,whereCoalg R pA,Bqis
o i o i
definedbytreatingpA,Bqasalensandhenceamorphismofmonomialsofthetypeindicated.
RpA,Bq
Rpn ,n q Rpm ,m q
o i o i
ι ι
pno,niq pmo,miq
Coalg R pRnoy Rniq CoalgR pA,Bq Coalg R pRmoy Rmiq
To see that this diagram commutes, observe that we can write a rate-coded neural circuit κ as
a morphismRnoyTRno Ñ Rnoy Rni ofpolynomials, whereTisthe tangentbundle functor; and
observethattheactionofRpA,Bqistopost-composethelenspA,Bqafterκ,asinRnoyTRno
ÝÑ
κ
Rnoy Rni Ý p Ý A Ý ,B Ñ q Rmoy Rmi. Now,ι actsbytakingκtoasystemRnoy Rno Ñ rTy,Rnoy Rnis,
pno,niq
andCoalg R pA,Bqpost-composesrTy,pA,Bqs,soweobtainthesystem
Rnoy Rno Ý ι Ý pn Ýo, Ý n Ýiq Ý pκ Ñ q rTy,Rnoy Rnis Ý rT Ý y Ý ,p Ý A Ý ,B ÝÑ qs rTy,Rmoy Rmis .
Thisispreciselythesystemobtainedbyapplyingι topA,Bq˝κ,andhenceιisnatural.
pmo,miq
Finally,itiseasytocheckthatιisamonoidalnaturaltransformation(Definition3.1.13),which
by Moeller and Vasilakopoulou [189, Proposition 3.6] entails that ι is a morphism of monoidal
indexed categories. That it is additionally an inclusion follows from the evident fact that each
functorι isanembedding.
pno,niq
Atsomepointduringtheprecedingexposition,thereadermayhavewonderedinwhatsense
theseopendynamicalsystemsarecoalgebras. Toanswerthis,recallfromProposition6.1.13thata
polynomialmorphismSyS Ñ q isequivalentlyafunctionS Ñ qS andhencebyExample6.1.12
a q-coalgebra. Then, by setting q “ rTy,ps, we see the connection immediately: the objects of
Coalg T ppqarerTy,ps-coalgebrasthatsatisfythe◁-comonoidcondition,andthemorphismsof
Coalg T ppqarecoalgebramorphisms.
238
Inthefollowingsubsection,wegeneralizetheconstructionsabovetoallowfornon-deterministic
(‘effectful’)feedback,usingageneralizationofthecategoryPoly.
6.2.2. Polynomialswith‘effectful’feedback,andopenMarkovprocesses
The category Poly of polynomial functors Set Ñ Set can be considered as a category of
‘deterministic’polynomialinteraction;notably,morphismsofsuchpolynomials,whichwetaketo
encodethecouplingofsystems’interfaces,donotexplicitlyincorporateanykindofrandomness
oruncertainty. Eveniftheuniverseisdeterministic,however,thefinitenessofsystemsandtheir
general inability to perceive the totality of their environments make it a convenient modelling
choice to suppose that systems’ interactions may be uncertain; this will be useful not only in
allowing for stochastic interactions between systems, but also to define stochastic dynamical
systems‘internally’toacategoryofpolynomials.
Toreachthedesiredgeneralization,webeginbyrecallingthatPolyisequivalenttothecategory
ofGrothendiecklensesfortheself-indexingofSet(Example4.2.30). Wedefineourcategoriesof
generalizedpolynomialsfromthisperspective,byconsideringKleislicategoriesindexedbytheir
“deterministicsubcategories”. ThisallowsustodefinecategoriesofGrothendiecklenseswhich
behavelikePoly whenrestrictedtothedeterministiccase, butalsoadmituncertaininputs. In
ordertoapplytheGrothendieckconstruction,webeginbydefininganindexedcategory.
Definition6.2.14. SupposeE isacategorywithalllimits,andsupposeM : E Ñ E isamonad
onE. DefinetheindexedcategoryE {´ : Eop Ñ Catasfollows. OnobjectsB : E,wedefine
M
E
M
{B to be the full subcategory of KℓpMq{B on those objects ιp : EÑ‚ B which correspond
to maps E ÑÝ p B Ý η ÝÑB MB in the image of ι. Now suppose f : C Ñ B is a map in E. We
define E
M
{f : E
M
{B Ñ E
M
{C as follows. The functor E
M
{f takes objects ιp : EÑ‚ B to
ιpf˚pq : f˚EÑ‚ C wheref˚pisthepullbackofpalongf inE,includedintoKℓpMqbyι.
To define the action of E
M
{f on morphisms α : pE,ιp : EÑ‚ Bq Ñ pF,ιq : FÑ‚ Bq, note
that since we must have ιq ‚ α “ ιp, we can alternatively write α as the B-dependent sum
ř ř ř
α : prbs Ñ Mqrbs. ThenwecandefinepE {fqpαqaccordinglyaspE {fqpαq :“
b:B b b:B b:B M M
ř ř ř
α : prfpcqs Ñ Mqrfpcqs.
c:C fpcq c:C c:C
Definition6.2.15. WedefinePoly tobethecategoryofGrothendiecklensesforE {´. That
M M
ş
is,Poly :“ E {´op,wheretheoppositeisagaintakenpointwise.
M M
Example6.2.16. WhenE “ SetandM “ id ,Definition6.2.14recoversourearlierdefinition
Set
ofPoly.
239
Example6.2.17. WhenM isamonadonSet,wefindthattheobjectsofPoly arethesame
M
polynomialfunctorsasconstitutetheobjectsofPoly. Themorphismsf : p Ñ q arepairspf ,f7q,
1
wheref
1
: B Ñ C isafunctioninSetandf7 isafamilyofmorphismsqrf
1
pxqsÑ‚ prxsinKℓpMq,
makingthefollowingdiagramcommute:
ř ř ř
f7
Mprxs qrf pxqs qrys
x:B b:B 1 y:C
{
ηB ˚p q
B B
f1
C
Remark6.2.18. Consequently,wecanthinkofPoly asadependentversionofthecategoryof
M
M-monadiclenses,inthesenseofClarkeetal.[65,§3.1.3].
Remark6.2.19.
AnymonadpM,µ,ηqonSetinducesacomonadpM¯,δ,ϵqonthecategoryPoly
ofpolynomialfunctorsSet Ñ Set,andPoly canberecoveredasthecoKleislicategoryofthis
M
comonad,Poly – coKℓpM¯ q. WeheardofthisideafromDavidSpivak.
M
ř
On objects (polynomial functors), M¯ : Poly Ñ Poly acts to map p : pris Ñ pp1q
i:pp1q
ř
to M¯p : Mpris Ñ pp1q. Given a morphism of polynomials φ : p Ñ q, M¯ returns the
i:pp1q
morphismM¯ pφqwhoseforwardcomponentisagainφ andwhosebackwardcomponentisdefined
1
byM¯ pφq 7 :“ Mpφ7 qforeachiinpp1q.
i i
The counit ϵ : M¯ ñ id is defined for each p as the morphism ϵ : M¯p Ñ p whose
Poly p
forwardcomponentisid andwhosebackwardcomponentisgivenforeachi : pp1qbytheunit
pp1q
η : pris Ñ MprisofthemonadM. Similarly,thecomultiplicationδ : M¯M¯ ñ M¯ isdefinedfor
pris
eachpasthemorphismδ : M¯M¯p Ñ M¯pwhoseforwardcomponentisagaintheidentityand
p
whosebackwardcomponentsaregivenbythemultiplicationofthemonadµ,i.e. pδ7 q :“ µ .
p i pris
Finally,thecoKleislicategorycoKℓpM¯ qhasthesameobjectsasPoly. Amorphismp Ñ q in
coKℓpM¯ qisamorphismM¯p Ñ q inPoly. CompositionincoKℓpM¯ qistheusualcompositionin
theforwarddirectionandKleislicompositioninthebackwarddirection.
Remark 6.2.20. Since E is assumed to have all limits, it must have a product structure pˆ,1q.
WhenM isadditionallyamonoidalmonad(Definition4.1.16),thenPoly acquiresatensorakin
M
tothatdefinedforPolyinProposition3.5.7,andwhichwealsodenotebypb,Iq: thedefinition
only differs by substituting the structure pb,Iq on KℓpMq for the product pˆ,1q on Set. This
monoidalstructurefollowsasbeforefromthemonoidalGrothendieckconstruction: E {´islax
M
monoidal,withlaxatortakingp : E {B andq : E {C topbq : E {pBbCq.
M M M
Ontheotherhand,forPoly alsotohaveaninternalhomrq,rsrequireseachfibreofE {´
M M
to be closed with respect to the monoidal structure. In cases of particular interest, E will be
240
locallyCartesianclosed,andrestrictingE {´totheself-indexingE{´givesfibreswhicharethus
M
Cartesianclosed. Inthesecases,wecanthinkofthebroaderfibresofE {´,andthusPoly itself,
M M
asbeing‘deterministically’closed.Thismeans,forthestochasticexamplePoly forPaprobability
P
monad,wegetaninternalhomsatisfyingtheadjunctionPoly ppbq,rq – Poly pp,rq,rsqonly
P P
whenthebackwardscomponentsofmorphismspbq Ñ r are‘uncorrelated’betweenpandq.
Remark6.2.21. ForPoly tobehavefaithfullylikethecategoryPolyofpolynomialfunctorsof
M
setsandtheirmorphisms,weshouldwantthesubstitutionfunctorsE {f : E {C Ñ E {B to
M M M
haveleftandrightadjoints(correspondingrespectivelytodependentsumandproduct). Although
wedonotspellitouthere,itisquitestraightforwardtoexhibitconcretelytheleftadjoints. On
theotherhand, writingf˚ asshorthandforE {f, wecanseethatarightadjointonlyobtains
M
inrestrictedcircumstances. DenotetheputativerightadjointbyΠ : E {B Ñ E {C,andfor
f M M
ιp : EÑ‚ B supposethatpΠ
f
Eqrysisgivenbythesetof‘partialsections’σ : f´1tyu Ñ ME ofp
overf´1tyuasinthecommutativediagram:
f´1tyu tyu
σ
{
ME
ηB ˚p
B
f
C
ThenwewouldneedtoexhibitanaturalisomorphismE {Bpf˚D,Eq – E {CpD,Π Eq. But
M M f
thiswillonlyobtainwhenthe‘backwards’componentsh7 : Drys Ñ MpΠ Eqrysareintheimage
y f
ofι—otherwise,itisnotgenerallypossibletopullf´1tyuoutofM.
Despitetheserestrictions,wedohaveenoughstructureathandtoinstantiateCoalg TinPoly .
M
Theonlypieceremainingisthecompositionproduct◁,butforourpurposesitsufficestodefine
its action on objects, which is identical to its action on objects in Poly 1, and then to consider
◁-comonoidsinPoly . Thecomonoidlawsforcethestructuremapstobedeterministic(i.e.,in
M
theimageofι),andso◁-comonoidsinPoly arejust◁-comonoidsinPoly .
M idSet
Finally,wenotethat,eveniftheinternalhomr´,´sisnotavailableingeneral,wecandefine
morphismsβ : SyS Ñ rTy,ps: theseagainjustcorrespondtomorphismsTybSyS Ñ p,andthe
conditionthatthebackwardsmapsbeuncorrelatedbetweenTy andpisincontrovertiblysatisfied
becauseTyhasatrivialexponent.UnwindingsuchaβaccordingtothedefinitionofPoly indeed
M
givespreciselyapairpβo,βuqoftherequisitetypes;andacomonoidhomomorphismSyS Ñ y Tin
Poly ispreciselyafunctorBT Ñ KℓpMq,therebyestablishingequivalencebetweentheobjects
M
ofCoalg T ppqestablishedinPoly andtheobjectsofCoalg T ppq.
M C
1Weleavethefullexpositionof◁inPoly tofuturework.
M
241
Henceforth,therefore,wewillwriteCoalg T todenotetheinstantiationofCoalg T inPoly .
M M
WewillcalltheobjectsofCoalg T ppqpM-coalgebraswithtimeT,andtogetasenseofhow,in
M
thecasewhereM isaprobabilitymonad,theyprovideanotionofopenMarkovprocess,wecan
readoffthedefinitionalittlemoreexplictly.
Proposition6.2.22. ApM-coalgebrawithtime Tconsistsofatripleϑ :“ pS,ϑo,ϑuqofastate
ř ř
spaceS : E andtwomorphismsϑo : TˆS Ñ pp1qandϑu : prϑopt,sqs Ñ MS,such
t:T s:S
ř
that,foranysectionσ : pp1q Ñ prisofpinE,themapsϑσ : TˆS Ñ MS givenby
i:pp1q
ÿ ÿÿ
S Ý ϑ Ý o Ý pt Ý q˚ ÝÑ σ prϑopt,sqs Ý ϑ Ñ u MS
t:T t:Ts:S
` ˘
constituteanobjectinthefunctorcategoryCat BT,KℓpMq ,whereBTisthedeloopingofT
andKℓpMqistheKleislicategoryofM. (Oncemore,wecalltheclosedsystemϑσ,inducedbya
sectionσ ofp,theclosureofϑbyσ.)
FollowingExample6.1.6andtheintuitionofExample6.2.9,wecanseehowthisproducesan
openversionofaMarkovprocess.
Since stochastic dynamical systems are often alternatively presented as random dynamical
systems,wenowbrieflyconsiderhowthesecanbeincorporatedintothecoalgebraicframework.
6.2.3. Openrandomdynamicalsystems
Intheanalysisofstochasticsystems,itisoftenfruitfultoconsidertwoperspectives: ononeside,
oneconsidersexplicitlytheevolutionofthedistributionofthestatesofthesystem,byfollowing
(forinstance)aMarkovprocess,orFokker-Planckequation. Ontheotherside,oneconsidersthe
systemasifitwereadeterministicsystem,perturbedbynoisyinputs,givingrisetotheframeworks
ofstochasticdifferentialequationsandassociatedrandomdynamicalsystems.
Whereas a (closed) Markov process is typically given by the action of a time monoid on an
objectinaKleislicategoryofaprobabilitymonad,a(closed)randomdynamicalsystemisgiven
byabundleofcloseddynamicalsystems,wherethebasesystemisequippedwithaprobability
measurewhichitpreserves: theideabeingthatarandomdynamicalsystemcanbethoughtofas
a‘random’choiceofdynamicalsystemonthetotalspaceateachmomentintime,withthebase
measure-preservingsystembeingthesourceoftherandomness[13].
This idea corresponds in non-dynamical settings to the notion of randomness pushback [109,
Def. 11.19], by which a stochastic map f : A Ñ PB can be presented as a deterministic map
f5 : ΩˆA Ñ B where pΩ,ωq is a measure space such that, for any a : A, pushing ω forward
242
throughf5p-,aqgivesthestatefpaq;thatis,ω inducesarandomchoiceofmapf5pω,-q : A Ñ B.
Similarly,underniceconditions,randomdynamicalsystemsandMarkovprocessesdocoincide,
althoughtheyhavedifferentsuitabilityinapplications.
Inthissection,wesketchhowthegeneralized-coalgebraicstructuresdevelopedaboveextendalso
torandomdynamicalsystems. Webeginbydefiningtheconceptofmeasure-preservingdynamical
system,whichitselfrequiresthenotionofmeasurespace(inorderthatmeasurecanbepreserved);
wedefinethecorrespondingcategoryabstractly,usinganotionofslicecategorydualtothatof
Definition3.2.10.
Definition6.2.23. SupposeX isanobjectofacategoryE. ThesliceofE under X,denotedX{E,
isthecategorywhoseobjectspA,iqaremorphismsX ÑÝ i AoutofX inE,andwhosemorphisms
f : pA,iq Ñ pB,jqaretheevidenttriangles:
X
i j
f
A B
ThereisaprojectionfunctorF : X{E Ñ E mappingeachobjectpA,iqtoAandeachmorphism
f : pA,iq Ñ pB,jqtof : A Ñ B.
Wecanusethisnotiontodefineanotionof‘pointed’category.
Definition6.2.24. LetpC,b,Iqbeamonoidalcategory,D beasubcategoryD ãÑ C,andletF
denotetheprojectionI{C Ñ C. WedefinethecategoryD tobethepullbackcategoryoverthe
˚
diagramD ãÑ C Ð F Ý I{C.
ThecategoryD hasobjects‘pointed’bycorrespondingstatesinC,anditsmorphismsarethose
˚
thatpreservethesestates. Thecategoryofmeasurespacesisobtainedasanexampleaccordingly.
Example6.2.25. ConsiderthedeterministicsubcategoryMeas ãÑ sfKrn. Thepointedcategory
Meas obtainedfromDefinition6.2.24isthecategorywhoseobjectsaremeasurespacespM,µq
˚
with µ a measure 1Ñ‚ M, and whose morphisms f : pM,µq Ñ pN,νq are measure-preserving
maps; i.e., measurablefunctionsf : M Ñ N suchthatν “ f ‚µinsfKrn. Likewise, ifP isa
probabilitymonadonE,thenwehaveE ãÑ KℓpPqandhencecanunderstandE asacategoryof
˚
abstractmeasurespaces.
Proposition 6.2.26. There is a projection functor U : E Ñ E taking measure spaces pB,βq
˚
to the underlying spaces B and their morphisms f : pA,αq Ñ pB,βq to the underlying maps
243
f : A Ñ PB. WewillwriteB torefertothespaceinE underlyingameasurespacepB,βq,inthe
imageofU.
Proof. Thefunctorisobtainedastheprojectioninducedbytheuniversalpropertyofthepullback.
Definition 6.2.27. Let pB,βq be a measure space in E ãÑ KℓpPq. A closed metric or measure-
preserving dynamicalsystempϑ,βqonpB,βqwithtimeTisacloseddynamicalsystemϑwith
statespaceB : E suchthat,forallt : T,Pϑptq˝β “ β;thatis,eachϑptqisapB,βq-endomorphism
in1{KℓpPq.
Proposition6.2.28. Closedmeasure-preservingdynamicalsystemsinE withtimeTformthe
objectsofacategoryCatpBT,E qwhosemorphismsf : pϑ,αq Ñ pψ,βqaremapsf : ϑp˚q Ñ
˚
ψp˚q in E between the state spaces that preserve both flow and measure, as in the following
commutativediagram,whichalsoindicatestheircomposition:
Pϑptq
Pϑp˚q Pϑp˚q
α Pf Pf α
1 Pψp˚q Pψp˚q 1
β Pψptq β
γ Pg Pg γ
Pλp˚q Pλp˚q
Pλptq
Proof. Theidentitymorphismonaclosedmeasure-preservingdynamicalsystemistheidentity
maponitsstatespace. Itiseasytocheckthatcompositionasinthediagramaboveisthusboth
associativeandunitalwithrespecttotheseidentities.
Asweindicatedintheintroductiontothissection,closedrandomdynamicalsystemsarebundles
ofdeterministicsystemsovermetricsystems.
Definition6.2.29. Letpϑ,βqbeaclosedmeasure-preservingdynamicalsystem. Aclosedrandom
dynamical system over pϑ,βq is an object of the slice category CatpBT,Eq{ϑ; it is therefore a
bundleofthecorrespondingfunctors.
Example 6.2.30. The solutions Xpt,ω;x q : R ˆ Ω ˆ M Ñ M to a stochastic differential
0 `
equationdX “ fpt,X qdt`σpt,X qdW ,whereW : R ˆΩ Ñ M isaWienerprocessinM,
t t t t `
244
definearandomdynamicalsystemR ˆΩˆM Ñ M : pt,ω,xq ÞÑ Xpt,ω;x qovertheWiener
` 0
baseflowθ : R ˆΩ Ñ Ω : pt,ωq ÞÑ Wps`t,ωq´Wpt,ωqforanys : R .
` `
Wecanusethesametrick,ofopeningupclosedsystemsalongapolynomialinterface,todefine
anotionofopenrandomdynamicalsystem—althoughatthispointwedonothaveanelegant
concisedefinition.
Definition6.2.31. Letpθ,βqbeaclosedmeasure-preservingdynamicalsysteminE withtime
T, and let p : Poly be a polynomial in E. Write Ω :“ θp˚q for the state space of θ, and let
idE
π : S Ñ Ω be an object (bundle) in E{Ω. An open random dynamical system over pθ,βq on the
interfacepwithstatespaceπ : S Ñ ΩandtimeTconsistsinapairofmorphismsϑo : TˆS Ñ pp1q
ř ř ř
and ϑu : prϑopt,sqs Ñ S, such that, for any section σ : pp1q Ñ pris of p, the maps
t:Ts:S i:pp1q
ϑσ : TˆS Ñ S definedas
ÿ ÿÿ
S Ý ϑ Ý o Ý p´ Ý q Ý ˚ Ñ σ prϑop´,sqs Ý ϑ Ñ u S
t:T t:Ts:S
form a closed random dynamical system in CatpBT,Eq{θ, in the sense that, for all t : T and
sectionsσ,thefollowingdiagramcommutes:
ř
S
ϑoptq˚σ
prϑopt,sqs
ϑuptq
S
s:S
π π
Ω Ω
θptq
Proposition6.2.32. Letpθ,βqbeaclosedmeasure-preservingdynamicalsysteminE withtime
T, and let p : Poly be a polynomial in E. Open random dynamical systems over pθ,βq on
idE
the interface p form the objects of a category RDyn T pp,θq. Writing ϑ :“ pπ ,ϑo,ϑuq and
X
ψ :“ pπ ,ψo,ψuq,amorphismf : ϑ Ñ ψisamapf : X Ñ Y inE makingthefollowingdiagram
Y
commuteforalltimest : Tandsectionsσ ofp:
ř
X
ϑoptq˚σ
prϑopt,xqs
ϑuptq
X
x:X
πX πX
f θptq f
Ω Ω
πY πY
ř
Y prψopt,yqs Y
ψoptq˚σ ψuptq
y:Y
245
Identities are given by the identity maps on state-spaces. Composition is given by pasting of
diagrams.
Proposition6.2.33. ThecategoriesRDyn T pp,θqcollectintoadoubly-indexedcategoryofthe
formRDyn T : Poly ˆCatpBT,E q Ñ Cat. Bytheuniversalpropertyoftheproductˆin
idE ˚
Cat,itsufficestodefinetheactionsofRDyn T separatelyonmorphismsofpolynomialsandon
morphismsofclosedmeasure-preservingsystems.
Suppose therefore that φ : p Ñ q is a morphism of polynomials. Then, for each measure-
preservingsystempθ,βq : CatpBT,E q,wedefinethefunctorRDyn T pφ,θq : RDyn T pp,θq Ñ
˚
RDyn T pq,θq as follows. Let ϑ :“ pπ : X Ñ Ω,ϑo,ϑuq : RDyn T pp,θq be an object (open
X
random dynamical system) in RDyn T pp,θq. Then RDyn T pφ,θqpϑq is defined as the triple
pπ ,φ ˝ ϑo,ϑu ˝ φo˚φ7q : RDyn T pq,θq, where the two maps are explicitly the following
X 1
composites:
ÿ ÿ ÿ ÿ
TˆX Ý ϑ Ñ o pp1q Ý φ Ñ1 qp1q, qrφ ˝ϑopt,xqs Ý ϑ Ý o Ý ˚ Ý φ Ñ 7 prϑopt,xqs Ý ϑ Ñ u X.
1
t:Tx:X t:Tx:X
Onmorphismsf : pπ : X Ñ Ω,ϑo,ϑuq Ñ pπ : Y Ñ Ω,ψo,ψuq,theimageRDyn T pφ,θqpfq :
X Y
RDyn T pφ,θqpπ ,ϑo,ϑuq Ñ RDyn T pφ,θqpπ ,ψo,ψuq is given by the same underlying map
X Y
f : X Ñ Y ofstatespaces.
Next, suppose that ϕ : pθ,βq Ñ pθ1,β1q is a morphism of closed measure-preserving
dynamical systems, and let Ω1 :“ θ1p˚q be the state space of the system θ1. By Proposition
6.2.28, the morphism ϕ corresponds to a map ϕ : Ω Ñ Ω1 on the state spaces that preserves
both flow and measure. Therefore, for each polynomial p : Poly , we define the functor
idE
RDyn T pp,ϕq : RDyn T pp,θq Ñ RDyn T pp,θ1q by post-composition. That is, suppose given
openrandomdynamicalsystemsandmorphismsoverpp,θqasinthediagramofProposition6.2.32.
ThenRDyn T pp,ϕqreturnsthefollowingdiagram:
ř
X
ϑoptq˚σ
prϑopt,xqs
ϑuptq
X
x:X
ϕ˝πX ϕ˝πX
f f
Ω1 Ω1
θ1ptq
ϕ˝πY ϕ˝πY
ř
Y prψopt,yqs Y
ψoptq˚σ ψuptq
y:Y
246
That is, RDyn T pp,ϕqpϑq :“ pϕ ˝ π ,ϑo,ϑuq and RDyn T pp,ϕqpfq is given by the same
X
underlyingmapf : X Ñ Y onstatespaces.
6.3. Cilia: monoidal bicategories of cybernetic systems
Whereasitisthemorphisms(1-cells)ofprocess-theoreticcategories—suchascategoriesoflenses,
orthecategoriesofstatisticalgamestobedefinedinChapter7—thatrepresentopensystems,itis
theobjects(0-cells)oftheopindexedcategoriesCoalg T 2 thatplaythisrôle;infact,theobjectsof
M
Coalg T eachrepresentbothanopensystemandits(polynomial)interface. Inordertosupply
M
dynamicalsemanticsforstatisticalgames—functorsfromcategoriesofstatisticalgamestocategories
ofdynamicalsystems—weneedtocleavethedynamicalsystemsfromtheirinterfaces,makingthe
interfacesinto0-cellsandsystemsinto1-cellsbetweenthem,therebylettingthesystems’types
andcompositionmatchthoseofthegames. Doingthisisthejobofthissection,whichwefirst
performinthecaseofthegeneralcategoriesCoalg T ,followedbythespecificcaseofsystems
M
generateddifferentially,asinthevector-fieldExamples6.2.8and6.2.9.
6.3.1. Hierarchicalbidirectionaldynamicalsystems
Toconstruct“hierarchicalbidirectionalsystems”,wewillassociatetoeachpairofobjectspA,Sq
andpB,Tqofacategoryof(forourpurposes,Bayesian)lensesapolynomialvAyS,ByTwwhose
configurations correspond to lenses and whose inputs correspond to the lenses’ inputs. The
` ˘
categoriesCoalg T vAyS,ByTw willthenformthehom-categoriesofbicategoriesofhierarchical
P
inference systems called cilia 3, and it is in these bicategories that we will find our dynamical
semantics.
Throughout this subsection, we will fix a category C of stochastic channels, defined by C :“
KℓpPqastheKleislicategoryofaprobabilitymonadP : E Ñ E,whichwewillalsotaketodefine
acategoryPoly ofpolynomialswithstochasticfeedback. WewillassumeP tobeamonoidal
P
monad,andwewillwritethemonoidalstructureonC aspb,Iq. Finally,wewillassumethatC is
enrichedinitsunderlyingcategoryofspacesE.
Definition6.3.1. LetBayesLens bethecategoryofBayesianlensesinC. Thenforanypairof
objectspA,SqandpB,TqinBayesLens,wedefineapolynomialvAyS,ByTwinPoly by
P
ÿ
vAyS,ByTw :“ yCpI,AqˆT .
` ˘
l:BayesLens pA,Sq,pB,Tq
ş
2or,moreprecisely,theircorrespondingopfibrations CoalgT
M
3‘Cilia’,becausethey“controloptics”,liketheciliarymusclesoftheeye.
247
Remark6.3.2. WecanthinkofvAyS,ByTwasan‘externalhom’polynomialforBayesLens,
playing a rôle analogous to the internal hom rp,qs in Poly . Its ‘bifunctorial’ structure—with
P
domainandcodomainparts—iswhatenablescleavingsystemsfromtheirinterfaces,whichare
givenbytheseparts. Thedefinition,andthefollowingconstructionofthemonoidalbicategory,are
inspiredbytheoperadOrgintroducedbySpivak[240].
Remark 6.3.3. Note that vAyS,ByTw is strictly speaking a monomial, since it can be written
` ˘
intheformIyJ forI “ BayesLens pA,Sq,pB,Tq andJ “ CpI,AqˆT. However,wehave
writtenitinpolynomialformwiththeviewtoextendingitinfutureworktodependentlensesand
dependentoptics[43,276]andthesegeneralizedexternalhomswillinfactbetruepolynomials.
Proposition6.3.4. Definition6.3.1definesafunctorBayesLensopˆBayesLens Ñ Poly .
P
Supposec :“ pc ,c7q : pZ,Rq ÑÞ pA,Sqandd :“ pd ,d7q : pB,Tq ÑÞ pC,UqareBayesianlenses.
1 1
Weobtainamorphismofpolynomialsvc,dw : vAyS,ByTw Ñ vZyR,CyUwasfollows. Sincethe
configurations of vAyS,ByTw are lenses pA,Sq ÑÞ pB,Tq, the forwards map acts by pre- and
post-composition:
` ˘ ` ˘
vc,dw :“ d p´q c : BayesLens pA,Sq,pB,Tq Ñ BayesLens pZ,Rq,pC,Uq
1
(cid:11) (cid:11)
l ÞÑ d l c
(cid:11) (cid:11)
Foreachsuchl,thebackwardsmapvc,dw 7 hastypeCpI,ZqbU Ñ CpI,AqbT inC,andis
l
obtainedbyanalogywiththebackwardscompositionruleforBayesianlenses. Wedefine
vc,dw 7 :“ CpI,ZqbU Ý c Ý1˚Ý b ÝÑ U CpI,AqbU ÝÝ b ÝÑ U CpI,AqbCpI,AqbU ¨¨¨
l
¨¨¨ Ý C Ý pI Ý , Ý A Ý qb Ý l Ý1˚Ý b ÝÑ U CpI,AqbCpI,BqbU Ý C Ý pI Ý ,A Ý q Ý b Ý d Ý 7b ÝÑ U CpI,AqbCpU,TqbU ¨¨¨
¨¨¨ Ý
C
Ý
pI
Ý
,A
ÝÝ
qb
Ý
e
Ý
vUÝ,ÑT
CpI,AqbT
wherel istheforwardspartofthelensl : pA,Sq ÑÞ pB,Tq,andc :“ CpI,c qandl :“ CpI,l q
1 1˚ 1 1˚ 1
arethepush-forwardsalongc andl ,andev istheevaluationmapinducedbytheenrichment
1 1 U,T
ofC inE.
Lessabstractly,withC “ KℓpPq,wecanwritevc,dw 7 asthefollowingmapinE,depictedasa
l
248
stringdiagram:
PA
PZ
c
1˚
str
vc,dw 7 “
l
l
1˚
PT
d5
U
Here,wehaveassumedthatKℓpPqpI,Aq “ PA,anddefined5 : PBˆU Ñ PT tobetheimage
`
ofd7 : PB Ñ KℓpPqpU,TqundertheCartesianclosureofE,andstr : PAˆPT Ñ P PAˆTq
the(left)strengthofthemonoidalmonadP.
Themorphismvc,dw actsto‘wrap’thelenslbypre-composingwithcandpost-composingwith
l
d. Thebackwardscomponentvc,dw 7 thereforeactstotaketheinputsoftheresultingcomposite
l
d l ctoappropriateinputsforl;thatis,itmapsapairpπ,uqtopc ‚π,d7 puqq.
(cid:11) (cid:11)
1 l1‚c1‚π
Proof. Weneedtocheckthatthemappingsdefinedaboverespectidentitiesandcomposition. Itis
easytoseethatthedefinitionpreservesidentities: intheforwardsdirection,thisfollowsfromthe
unitalityofcompositioninBayesLens;inthebackwardsdirection,becausepushingforwards
along the identity is again the identity, and because the backwards component of the identity
Bayesianlensistheconstantstate-dependentmorphismontheidentityinC.
Tocheckthatthemappingpreservescomposition,weconsiderthecontravariantandcovariant
parts separately. Suppose b :“ pb ,b7q : pY,Qq ÑÞ pZ,Rq and e :“ pe ,e7q : pC,Uq ÑÞ pD,Vq
1 1
are Bayesian lenses. We consider the contravariant case first: we check that vc b,ByTw “
(cid:11)
vb,ByTw˝vc,ByTw. Theforwardsdirectionholdsbypre-compositionoflenses. Inthebackwards
direction,wenotefromthedefinitionthatonlytheforwardschannelc playsarôleinvc,ByTw 7,
1 l
andthatrôleisagainpre-composition. Wethereforeonlyneedtocheckthatpc ‚b q “ c ˝b ,
1 1 ˚ 1˚ 1˚
andthisfollowsimmediatelyfromthefunctorialityofCpI,´q.
Wenowconsiderthecovariantcase,thatvAyS,e dw “ vAyS,ew˝vAyS,dw. Onceagain,the
(cid:11)
forwardsdirectionholdsbycompositionoflenses. Forsimplicityofexposition,weconsiderthe
backwardsdirection(withC “ KℓpPq)andreasongraphically. Inthiscase,thebackwardsmapon
249
theright-handsideisgiven,foralensl : pA,Sq ÑÞ pB,Tqbythefollowingstringdiagram:
PA
str
PA
PU
d5
l d ˚
1˚ 1˚
e5
V
Itiseasytoverifythatthecompositionofbackwardschannelshereispreciselythebackwards
channelgivenbye d—seeTheorem4.3.14—whichestablishestheresult.
(cid:11)
Remark6.3.5. Above,weclaimedthatamonoidalmonadP : E Ñ E onasymmetricmonoidal
`
categorypE,ˆ,1qisequippedwitha(left)strengthstr : X ˆPY Ñ P X ˆYq,inthesense
X,Y
ofDefinition3.2.4. Thiscanbeobtainedfromtheunitη andthelaxatorαofthemonadasfollows:
str : X ˆPY Ý η ÝXÝ ˆ Ý i Ý dPÝÑY PX ˆPY Ý α ÝXÝ,ÑY PpX ˆYq
X,Y
Usingthemonadlaws,astrengthobtainedinthiswaycanbeshowntosatisfythefollowingaxioms
(that the strength commutes with the monad structure), and so one may say that P is a strong
monad:
AˆB
idAˆηB ηAˆB
AˆPB PpAˆBq
strA,B
AˆPPB
strA,PB
PpAˆPBq
PpstrA,Bq
PPpAˆBq
AˆµB µAˆB
AˆPB
strA,B
PpAˆBq
Nowthatwehavean‘externalhom’,wemightexpectalsotohaveacorresponding‘external
composition’,representedbyafamilyofmorphismsofpolynomials;weestablishsuchafamily
now,anditwillbeimportantinourbicategoricalconstruction.
Definition6.3.6. Wedefinean‘externalcomposition’naturaltransformationc,withcomponents
vAyS,ByTwbvByT,CyUw Ñ vAyS,CyUw
250
givenintheforwardsdirectionbycompositionofBayesianlenses. Inthebackwardsdirection,for
eachpairoflensesc : pA,Sq ÑÞ pB,Tqandd : pB,Tq ÑÞ pC,Uq,weneedamap
˘
c7 : CpI,AqbU Ñ CpI,AqbT bCpI,BqbU
c,d
whichwedefineasfollows:
c7 :“ CpI,AqbU ÝÝÝ b ÝÑ CpI,AqbCpI,AqbU bU ¨¨¨
c,d
¨¨¨ Ý C Ý pI Ý ,A Ý q Ý b Ý c Ý1˚Ý b Ý U Ý b ÝÑ U CpI,AqbCpI,BqbU bU ¨¨¨
CpI,Aqb bCpI,BqbUbU
¨¨¨ ÝÝÝÝÝÝÝÝÝÝÝÝÝÝÝÝÑ CpI,AqbCpI,BqbCpI,BqbU bU
CpI,AqbCpI,Bqbd7bUbU
¨¨¨ ÝÝÝÝÝÝÝÝÝÝÝÝÝÝÝÝÑ CpI,AqbCpI,BqbCpU,TqbY bU
¨¨¨ Ý C Ý p Ý I, Ý A Ý qb Ý C Ý p Ý I Ý ,B Ý q Ý ev ÝUÝ,TÝ b ÝÑ U CpI,AqbCpI,BqbT bU
CpI,AqbswapbU
¨¨¨ ÝÝÝÝÝÝÝÝÝÝÑ CpI,AqbT bCpI,BqbU
wherec andev areasin6.3.4.
1˚ U,T
With C “ KℓpPq, we can equivalently (and more legibly) define c7 by the following string
c,d
diagram:
PA
PA
PT
c
1˚
c7 :“
c,d PB str
d5
U
U
whered5 andstrarealsoasinProposition6.3.4.
Wecanthereforeunderstandc7 asmappingforwardandbackwardinputsforthecomposite
c,d
lens d c to appropriate inputs for the constituent lenses c and d; that is, c7 maps pπ,uq to
c,d
(cid:11)
pπ,d7 puq,c ‚π,uq. Theresultinginputstothelenscarethereforepπ,d7 puqq,andthoseto
c1‚π 1 c1‚π
darepc ‚π,uq. (Thisispreciselyasthelawoflenscompositionstipulates: theforwardsinputto
1
disobtainedbypushingforwardsthroughd;andthebackwardsinputtocisobtainedfromthe
backwardscomponentofd.)
251
Weleavetothereaderthedetailedproofthatthisdefinitionproducesawell-definednatural
transformation,notingonlythattheargumentisanalogoustothatofProposition6.3.4:oneobserves
that,intheforwardsdirection,thedefinitionissimplycompositionofBayesianlenses(whichis
immediatelynatural);inthebackwardsdirection,oneobservesthatthedefinitionagainmirrors
thatofthebackwardscompositionofBayesianlenses.
Next,weestablishthestructureneededtomakeourbicategorymonoidal.
Definition6.3.7. Wedefineadistributivelawdofv´,“woverb,anaturaltransformationwith
components
vAyS,ByTwbvA1yS1 ,B1yT1 w Ñ vAyS bA1yS1 ,ByT bB1yT1 w,
notingthatAySbA1yS1 “ pAbA1qypSbS1q andByT bB1yT1 “ pBbB1qypTbT1q. Theforwards
componentisgivensimplybytakingthetensorofthecorrespondingBayesianlenses,usingthe
monoidalproduct(alsodenotedb)inBayesLens. Backwards,foreachpairoflensesc : pA,Sq ÑÞ
pB,Tqandc1 : pA1,S1q ÑÞ pB1,T1q,weneedamap
d7 : CpI,AbA1qbT bT1 Ñ CpI,AqˆT ˆCpI,A1qˆT1
c,c1
forwhichwechoose
CpI,AbA1qbT bT1 ÝÝÝ b Ý T Ý b Ý T Ñ 1 CpI,AbA1qbCpI,AbA1qbT bT1¨¨¨
¨¨¨ Ý C Ý pI Ý ,p Ý r Ý oj ÝAÝ qb Ý C Ý p Ý I, Ý pr Ý o Ý j AÝ 1q Ý b Ý T Ý b Ý T Ñ 1 CpI,AqbCpI,A1qbT bT1¨¨¨
¨¨¨ Ý C Ý pI Ý ,A ÝÝ qb Ý s Ý w Ý ap Ý b Ý T Ñ 1 CpI,AqbT bCpI,A1qbT1
whereswapisthesymmetryofthetensorbinC. Notethatd7 sodefineddoesnotinfactdepend
c,c1
oneithercorc1.
We now have everything we need to construct a monoidal bicategory Cilia T of dynamical
P
hierarchicalinferencesystemsinC,followingtheintuitionoutlinedatthebeginningofthissection.
We call systems over such external hom polynomials cilia, as they “control optics”, akin to the
ciliarymusclesoftheeye. Infuturework,wewillstudythegeneralstructureofthesecategories
and their relationship to categorical systems theory [191, 192] and related work in categorical
cybernetics[51].
Definition 6.3.8. Let Cilia T denote the monoidal bicategory whose 0-cells are objects
P
` ˘
pA,Sq in BayesLens, and whose hom-categories Cilia T pA,Sq,pB,Tq are given by
P
252
` ˘
Coalg T vAyS,ByTw . The identity 1-cell id : pA,Sq Ñ pA,Sq on pA,Sq is given by
P pA,Sq
the system with trivial state space 1, trivial update map, and output map that constantly emits
theidentityBayesianlenspA,Sq ÑÞ pA,Sq. ThecompositionofasystempA,Sq Ñ pB,Tqthena
systempB,Tq Ñ pC,Uqisdefinedbythefunctor
` ˘ ` ˘
T T
Cilia pA,Sq,pB,Tq ˆCilia pB,Tq,pC,Uq
P P
` ˘ ` ˘
“ Coalg T vAyS,ByTw ˆCoalg T vByT,CyUw
P P
` ˘
ÝÑ λ Coalg T vAyS,ByTwbvByT,CyUw
P
` ˘ ` ˘
Ý C ÝÝ oa Ý l Ý gT PÝ p Ý c Ñ q Coalg T vAyS,CyUw “ Cilia T pA,Sq,pC,Uq
P P
whereλisthelaxatorandcistheexternalcompositionmorphismofDefinition6.3.6.
Themonoidalstructurepb,yqonCilia T derivesfromthestructuresonPoly andBayesLens,
P P
justifyingouroverloadednotation. On0-cells,pA,SqbpA1,S1q :“ pAbA1,S bS1q. On1-cells
pA,Sq Ñ pB,TqandpA1,S1q Ñ pB1,T1q,thetensorisgivenby
` ˘ ` ˘
Cilia T pA,Sq,pB,Tq ˆCilia T pA1,S1q,pB1,T1q
P P
` ˘ ` ˘
“ Coalg T vAyS,ByTw ˆCoalg T vA1yS1 ,B1yT1 w
P P
` ˘
ÝÑ
λ
Coalg
T vAyS,ByTwbvA1yS1 ,B1yT1
w
P
` ˘
Ý C ÝÝ oa Ý l Ý gT PÝ p Ý d Ñ q Coalg T vAyS bA1yS1 ,ByT bB1yT1 w
P
` ˘
“ Cilia T pA,SqbpA1,S1q,pB,TqbpB1,T1q
P
wheredisthedistributivelawofDefinition6.3.7. Thesamefunctors
` ˘ ` ˘ ` ˘
Cilia T pA,Sq,pB,Tq ˆCilia T pA1,S1q,pB1,T1q Ñ Cilia T pA,SqbpA1,S1q,pB,TqbpB1,T1q
P P P
inducethetensorof2-cells;concretely,thisisgivenonmorphismsofdynamicalsystemsbytaking
theproductofthecorrespondingmorphismsbetweenstatespaces.
WedonotgivehereaproofthatthismakesCilia T intoawell-definedmonoidalbicategory;
P
briefly, the result follows from the facts that the external composition c and the tensor b are
appropriatelyassociativeandunital,thatCoalg T islaxmonoidal,thatv´,“wisfunctorialinboth
P
positions,andthatv´,“wdistributesnaturallyoverb.
Beforewemoveon,itwillbeusefultospelloutconcretelytheelementsofa‘cilium’(a1-cell)
pA,Sq Ñ pB,TqinCilia T.
P
253
Proposition 6.3.9. Suppose P is a monad on a Cartesian closed category E. Then a 1-cell ϑ :
pA,Sq Ñ pB,TqinCilia T isgivenbyatupleϑ :“ pX,ϑo,ϑo,ϑuqof
P 1 2
• achoiceofstatespaceX,
• aforwardsoutputmapϑo : TˆX ˆA Ñ PB inE,
1
• abackwardsoutputmapϑo : TˆX ˆPAˆT Ñ PS inE,and
2
• anupdatemapϑu : TˆX ˆPAˆT Ñ PX inE,
satisfyingthe‘flow’conditionofProposition6.2.22.
Proof. Theresultfollowsimmediatelyuponunpackingthedefinitions,usingtheCartesianclosure
ofE.
6.3.2. Differentialsystems
Approximateinferencedoctrinesdescribehowsystemsplaystatisticalgames,andareparticularly
ofinterestwhenoneaskshowsystems’performancemayimproveduringsuchgame-playing. One
prominentmethodofperformanceimprovementinvolvesdescendingthegradientofastatistical
game’slossfunction,andwewillseebelowthatthismethodisadoptedbyboththeLaplaceand
the Hebb-Laplace doctrines. The appearance of gradient descent prompts questions about the
connectionsbetweensuchstatisticalsystemsandother‘cybernetic’systemssuchasdeeplearnersor
playersofeconomicgames,bothofwhichmayalsoinvolvegradientdescent[51,74];indeed,ithas
beenproposed[54]thatparameterizedgradientdescentshouldformthebasisofacompositional
accountofcyberneticsystemsingeneral4.
In order to incorporate gradient descent explicitly into our own compositional framework,
wefollowtherecipesabovetodefineherefirstacategoryofdifferentialsystemsopindexedby
polynomialinterfacesandthenamonoidalbicategoryofdifferentialhierarchicalinferencesystems.
Wethenshowhowwecanobtaindynamicalfromdifferentialsystemsbyintegration,andsketch
howthisinducesa“changeofbase”fromdynamicaltodifferentialhierarchicalinferencesystems.
4Ourownviewoncyberneticsissomewhatmoregeneral,sincenotallsystemsthatmaybeseenascyberneticare
explicitlystructuredasgradient-descenders,andnorevenisexplicitdifferentialstructurealwaysapparent.Inearlier
work,wesuggestedthatstatisticalinferencewasperhapsmoreinherenttocybernetics[251],althoughtodaywe
believethatabetter,thoughmoreinformal,definitionofcyberneticsystemisperhaps“anintentionally-controlled
opendynamicalsystem”.(Slightlymoreformally,wecanunderstandthisas“anopendynamicalsystemcladina
controller”,withthepossible‘cladding’collectedintoafibrationoversystemsofeachgiventype.)Nonetheless,we
acknowledgethatthisnotionof“intentionalcontrol”maygenerallybereducibletoastationaryactionprinciple,
againindicatingtheimportanceofdifferentialstructure.Weleavethestatementandproofofthisgeneralprinciple
tofuturework.
254
Differentialsystemsrequiredifferentialstructure,butweareherestillconcernedwithstatistical
systemswhosetimeevolutionisstochastic. Thismeansthatadifferentialsystemwillbegivenby
astochasticvectorfield: astochasticsectionofthetangentbundleoverthesystem’sstatespace.
However,aswehaveseen,thestatespacesofstochasticsystemsarenaturallyfoundinacategory
ofmeasurablespaces,butsuchacategoricalsettingdoesnotgenerallysupplydifferentialstructure
too,andwithoutthiswecannotdefinetangentbundles. Thisposesourfirsthurdle.
Wewillnothereentirelyvaultthishurdle,fortheinterplayofrandomnessandsmoothnessis
subtleanduntanglingitisnotourpurposeinthisthesis. However,wecanovercomeitinamanner
whichissatisfactoryforourpresentneeds,bynotingthatallourstatespacesoflaterinterestwill
beEuclidean,meaningthatwecanequipthemwiththeirstandardBorelmeasurablestructure. In
futurework,wehopetogeneralizethissituation,possiblyusingthenotionofrelativemonad [8].
Definition6.3.10. LetEucdenotethecategorywhoseobjectsarefinite-dimensionalEuclidean
spacesRn andwhosemorphismsaresmoothmapsbetweenthem.
Euclidean spaces are trivially manifolds: the tangent space over each point x P Rn is again
Rn. Hence,ifX isaEuclideanspace,thenthetangentbundleTX Ñ X issimplytheprojection
X ˆX Ñ X mappingpx,vqtox. Asingeneraldifferentialgeometry,TyieldsafunctorEuc Ñ
Euc.
Proposition6.3.11. ThetangentbundlefunctorT : Euc Ñ EucmapseachEuclideanspaceRn
to Rn ˆRn and each smooth map f : Rm Ñ Rn to its differential df : Rm ˆRm Ñ Rn ˆRn,
` ˘
which in turn maps px,vq to fpxq,B fpvq , where B f denotes the (total) derivative of f at x,
x x
whichcanberepresentedbyitsnˆmJacobianmatrix.
Remark6.3.12. Differentialscomposebypushforward,whichyieldsthechainruleofdifferential
calculus. Earlierwehaveseenthatchainrulesindicatethepresenceofafibration,andindeedthis
isalsothecasehere: Tisproperlyafunctorintothefibrationofvectorbundlesoverthecategory
ofspaces;composingthisfunctorwiththeprojectionoutofthefibrationyieldstheendofunctor
wehavesketchedintheprecedingproposition.
Ordinary differential equations define vector fields, which are (deterministic) sections of the
tangentbundleoveraspace;thesearedeterministiccloseddifferentialsystems. Weareinterested
inopendifferentialsystemsthatmayhaveeffectful(e.g. stochastic)evolution: foropenness,wewill
usethetrickof§6.2;forstochasticity,wewillneedstochasticsections,whichmeanstransporting
thetangentbundlesintoacategoryofstochasticmapsandconsideringtheirsectionsthere.
255
Proposition6.3.13. ThereisafunctorJ : Euc Ñ MeasthattakeseachEuclideanspaceand
exhibitsitasameasurablespaceequippedwithitsstandardBorelσ-algebra,andwhichtakeseach
smoothmapandexhibitsitasameasurablefunction. Thisfunctorpreservesproducts.
Proposition6.3.14(Heunenetal.[131,§III.B]). ThereisafunctorR : Meas Ñ QBSwhichis
fullandfaithfulwhenrestrictedtothesubcategoryBorel ãÑ MeasofstandardBorelspaces.
Using these functors, we can transport a tangent bundle π : TX Ñ X in Euc to QBS, as
X
RJπ . Then, ifweletP : QBS Ñ QBSdenotetheprobabilitymonadonquasi-Borelspaces
X
introduced in Example 4.1.31, we can take the sections of RJπ in KℓpPq to be the stochastic
X
vectorfieldsoverthespaceX. Moreover,sinceQBSisfinitelycompleteandCartesianclosed,itis
sufficientlystructuredthatwemayinstantiatethecategoryPoly ofpolynomialswithP-effectful
P
feedback.
Usingthesetwoideas,wemaydefineourdesiredcategoriesofstochasticdifferentialsystems.
RecallthatmorphismsAyB Ñ pinPoly
P
correspondtomorphismsAÑ‚ pB inKℓpPq.
Notation6.3.15. Inthissection,letuswritep´ r qtodenotethefunctorRJ : Euc Ñ QBS.
Definition6.3.16. Foreachp : Poly ,defineacategoryDiffSysppqasfollows. Itsobjectsare
P
pairspM,mqofaEuclideanspaceM : Eucandamorphismm : M Ă yT Ą M Ñ pofpolynomialsin
Poly ,suchthatforanysectionσ : p Ñ y ofp,thecompositemorphismσ˝m : M Ă yT Ą M Ñ y
P
corresponds to a stochastic section mσ : M Ă Ñ‚ T Ą M of the tangent bundle TM Ñ M under RJ.
Amorphismα : pM,mq Ñ pM1,m1qinDiffSysppqisasmoothmapα : M Ñ M1 inEucsuch
thatthefollowingdiagramcommutes:
M Ă m pT Ą M
αr pT Ă α
Ă Ć
M1 pTM1
m1
Weobtainamonoidalopindexedcategoryfromthisdatainmuchthesamewayaswedidfor
Coalg
T.
Proposition6.3.17. DiffSysdefinesanopindexedcategoryPoly Ñ Cat. Givenamorphism
P
φ : p Ñ q of polynomials, DiffSyspφq : DiffSysppq Ñ DiffSyspqq acts on objects by
postcompositionandtriviallyonmorphisms.
Proposition6.3.18. ThefunctorDiffSysislaxmonoidalpPoly ,b,yq Ñ pCat,ˆ,1q.
P
256
Proofsketch. NotethatTisstrongmonoidal,withTpR0q – R0 andTpMqˆTpNq – TpM ˆNq,
thatRJ preservesproducts,andthatRJpR0q “ 1. Theunitor1 Ñ DiffSyspyqisgivenbythe
isomorphism R
Ă
0yT
ĆR0
– 1y1 – y induced by the strong monoidal structure of T. The laxator
λ : DiffSysppqˆDiffSyspqq Ñ DiffSysppbqq is similarly determined: given objects m :
p,q
M Ă yT Ą M Ñ p and n : N r yT Ą N Ñ q, take their tensor m b n : pM Ă b N r qyT Ą MbT Ą N Ñ p b q
andprecomposewiththeinducedmorphismpM Č ˆNqyTp Č MˆNq Ñ pM Ă bN r qyT Ą MbT Ą M;proceed
similarlyonmorphismsofdifferentialsystems. Thesatisfactionoftheunitalityandassociativity
lawsfollowsfromthemonoidalityofT.
WenowdefineamonoidalbicategoryDiffCiliaofdifferentialhierarchicalinferencesystems,
followingthedefinitionofCiliaabove.
Definition6.3.19. LetDiffCiliadenotethemonoidalbicategorywhose0-cellsaretheobjects
` ˘
pA,Sq of BayesLens and whose hom-categories DiffCilia pA,Sq,pB,Tq are given by
KℓpPq
` ˘
DiffSys vAyS,ByTw . The identity 1-cell id : pA,Sq Ñ pA,Sq on pA,Sq is given by
pA,Sq
thedifferentialsystemy Ñ vAyS,ByTwwithstatespaceR0,trivialbackwardscomponent,and
forwardscomponentthatpickstheidentityBayesianlensonpA,Sq. Thecompositionofdifferential
systemspA,Sq Ñ pB,TqthenpB,Tq Ñ pC,Uqisdefinedbythefunctor
` ˘ ` ˘
DiffCilia pA,Sq,pB,Tq ˆDiffCilia pB,Tq,pC,Uq
` ˘ ` ˘
“ DiffSys vAyS,ByTw ˆDiffSys vByT,CyUw
` ˘
ÝÑ λ DiffSys vAyS,ByTwbvByT,CyUw
` ˘ ` ˘
Ý D Ý i Ý ff Ý Sy Ý s Ý pc Ñ q DiffSys vAyS,CyUw “ DiffCilia pA,Sq,pC,Uq
whereλisthelaxatorofProposition6.3.18andcistheexternalcompositionmorphismofDefinition
6.3.6.
Themonoidalstructurepb,yqonDiffCiliaissimilarlydefinedfollowingthatofCilia T. On
P
0-cells,pA,SqbpA1,S1q :“ pAbA1,SbS1q. On1-cellspA,Sq Ñ pB,TqandpA1,S1q Ñ pB1,T1q
(andtheir2-cells),thetensorisgivenbythefunctors
` ˘ ` ˘
DiffCilia pA,Sq,pB,Tq ˆDiffCilia pA1,S1q,pB1,T1q
` ˘ ` ˘
“ DiffSys vAyS,ByTw ˆDiffSys vA1yS1 ,B1yT1 w
` ˘
ÝÑ
λ
DiffSys
vAyS,ByTwbvA1yS1 ,B1yT1
w
` ˘
Ý D ÝÝ iff Ý S Ý y Ý sp Ý d Ñ q DiffSys vAyS bA1yS1 ,ByT bB1yT1 w
P
` ˘
“ DiffCilia pA,SqbpA1,S1q,pB,TqbpB1,T1q
257
wheredisthedistributivelawofDefinition6.3.7.
FollowingProposition6.3.9,wehavethefollowingcharacterizationofadifferentialhierarchical
inferencesystempA,Sq Ñ pB,TqinKℓpPq.
Proposition 6.3.20. A 1-cell δ : pA,Sq Ñ pB,Tq in DiffCilia is given by a tuple δ :“
pX,δo,δo,δ7qof
1 2
• achoiceofstatespaceX : Euc;
• aforwardsoutputmapδo : X r ˆA Ñ PB,
1
• abackwardsoutputmapδo : X r ˆPAˆT Ñ PS,
2
• astochasticvectorfieldδ7 : X r ˆPAˆT Ñ PT Ą X.
Atleastfordeterministicdifferentialsystems,wecanobtaincontinuous-timedynamicalsystems
fromdifferentialsystemsbyintegration. Wemaythendiscretizetheseflowstogivediscrete-time
dynamicalsystems.
Proposition 6.3.21. For the purposes of this proposition, let P be the identity monad on a
finitely complete category E of manifolds, let p´ r q be the corresponding inclusion Euc ãÑ E,
andletDiffSysbeinstantiatedaccordingly. ThenintegrationinducesanindexedfunctorFlow :
DiffSys Ñ Coalg
R.
P
Proof. SupposepM,mqis anobjectin DiffSysppq. The morphismm : M Ă yT Ą M Ñ pconsists of
ř
functionsm 1 : M Ă Ñ pp1qandm7 : x:M Ă prm 1 pxqs Ñ T Ą M. Since,foranysectionσ : p Ñ y,the
inducedmapmσ : M Ă Ñ T Ą M isavectorfieldonacompactmanifold,itgeneratesauniqueglobal
flowFlowppqpmqσ : RˆM Ă Ñ M Ă[167,Thm.s12.9,12.12],whichfactorsas
ÿ ÿ ÿ
Ă m˚σ Flowppqpmqu Ă
M ÝÝÝ1Ñ prm pxqs ÝÝÝÝÝÝÝÑ M .
1
t:R t:R
x:M
Ă
WethereforedefinethesystemFlowppqpmqtohavestatespaceM Ă,outputmapm (forallt : R),
1
and update map Flowppqpmqu. Since Flowppqpmqσ is a flow for any section σ, it immediately
satisfies the monoid action condition. On morphisms α : m Ñ m1, we define Flowppqpαq by
the same underlying map on state spaces; this is again well-defined by the condition that α is
compatible with the tangent structure. Given a morphism φ : p Ñ q of polynomials, both the
reindexing DiffSyspφq and Coalg R pφq act by postcomposition, and so it is easy to see that
P
Coalg R pφq˝Flowppq – Flowpqq˝DiffSys pφqnaturally.
P P
258
Remark6.3.22. Thequestionofintegrationofstochastic systemsismorevexedandwewillnot
treatitinthisthesis.
Notonlymayweintegrateadifferentialsystemtoobtainacontinuous-timedynamicalsystem,
wecanalsovariouslydiscretizethecontinuous-timesystemtoobtainadiscrete-timeone.
Proposition 6.3.23. Any map f : T1 Ñ T of monoids induces an indexed functor (a natural
transformation)Coalg T Ñ Coalg T1.
P P
Proof. We first consider the induced functor Coalg T ppq Ñ Coalg T1 ppq, which we denote by
P P
∆p. Note that we have a morphism rfy,ps : rTy,ps Ñ rT1y,ps of polynomials by substitution
f
(precomposition). Asystemβ inCoalg T isamorphismSyS Ñ rTy,psforsomeS, andsowe
P
define ∆p pβq to be rf,ps˝β : SyS Ñ rTy,ps Ñ rT1y,ps. To see that this satisfies the monoid
f
actionaxiom,considerthattheclosure∆p pβqσ foranysectionσ : p Ñ y isgivenby
f
ÿ ÿÿ
S Ý β Ý o Ý pf Ý p Ý tq Ý q˚ ÝÑ σ prβopfptq,sqs Ý β Ñ u S
t:T1 t:T1s:S
` ˘
whichisanobjectinthefunctorcategoryCat BT1,KℓpPq sincef isamonoidhomomorphism.
Onmorphismsofsystems,thefunctor∆p actstrivially.
f
Toseethat∆ collectsintoanindexedfunctor,considerthatitisdefinedoneachpolynomialp
f
bythecontravariantactionrf,psoftheinternalhomr´,“s,andthatthereindexingCoalg T pφq
for any morphism φ of polynomials is similarly defined by the covariant action rTy,φs. By
the bifunctoriality of r´,“s, we have rT1y,φs ˝ rfy,ps “ rfy,φs “ rfy,qs ˝ rTy,φs, and so
Coalg T1 pφq˝∆p “ ∆q ˝Coalg T.
P f f P
Corollary 6.3.24. For each k : R, the canonical inclusion ι : N ãÑ R : i ÞÑ ki induces a
k
corresponding‘discretization’indexedfunctorDisc :“ ∆ : Coalg R Ñ Coalg N.
k ι P P
Remark6.3.25. FromProposition6.3.21andCorollary6.3.24weobtainafamilyofcomposite
indexed functors DiffSys Ý F Ý l Ý o Ñ w Coalg R Ý D Ý is Ý c Ñk Coalg N taking each differential system to a
P P
discrete-time dynamical system in C. Below, we will define approximate inference doctrines in
discretetimethatarisefromprocessesof(stochastic)gradientdescent,andwhichthereforefactor
throughdifferentialsystems,buttheforminwhichthesearegiven—andinwhichtheyarefound
intheinformalliterature(e.g.,Bogacz[33])—isnotobtainedviathecompositeDisc ˝Flowforany
k
k,eventhoughthereisafreeparameterk thatplaysthesamerôle(intuitively,a‘learningrate’).
Instead,onetypicallyadoptsthefollowingscheme,sometimesknownasEulerintegrationorthe
Eulermethod.
259
Euler integration induces a family of indexed functors Euler : DiffSys Ñ Coalg N, for
k P
k : R, which we illustrate for a single system pRn,mq over a fixed polynomial p, with m :
Rny RnˆRn Ñ p. This system is determined by a pair of morphisms m : Rn Ñ pp1q and
1
ř
m7 :
x:Rn
prm
1
pxqsÑ‚ RnˆRn,andwecanwritetheactionofm7 aspx,yq ÞÑ px,v
x
pyqq.
Using these, we define a discrete-time dynamical system β over p with state space Rn. This
β is given by an output map βo, which we define to be equal to m , βo :“ m , and an update
1 1
ř
mapβu :
x:Rn
prβopxqsÑ‚ Rn,whichwedefinebypx,yq ÞÑ x`kv
x
pyq. Together,thesedefinea
systeminCoalg N ppq,andthecollectionofthesesystemsβ producesanindexedfunctorbythe
P
definitionEuler ppqpmq :“ β.
k
Bycontrast,thediscrete-timesystemobtainedviaDisc ˝Flowinvolvesintegratingacontinuous-
k
timesystemforkunitsofrealtimeforeachunitofdiscretetime: althoughthisingeneralproduces
a more accurate simulation of the trajectories implied by the vector field, it is computationally
morearduous;totradeoffsimulationaccuracyagainstcomputationalfeasibility,onemaychoosea
moresophisticateddiscretizationschemethanthatsketchedabove,oratleastchoosea“sufficiently
small”timescalek.
Finally,wecanusetheforegoingideastotranslatedifferentialhierarchicalinferencesystemsto
dynamicalhierarchicalinferencesystems.
Corollary 6.3.26. The indexed functors Disc : Coalg R Ñ Coalg N, Flow : DiffSys Ñ
k P P
Coalg R, and Euler : DiffSys Ñ Coalg N induce functors (respectively) HDisc : Cilia R Ñ
P k P k P
Cilia N,HFlow : DiffCilia Ñ Cilia R andHEuler : DiffCilia Ñ Cilia N bychangeofbaseof
P P k P
enrichment.
260
7. Approximate inference doctrines for
predictive coding
TheconstructionofthepredictivecodingmodelsthatunderliethetheoryoftheBayesianbrain
involves mapping a (‘generative’) statistical model, representing how the modeller believes the
braintounderstandtheworld,toadynamicalsystemwhichplaystherôleoftheneuralcircuits
whicharehypothesizedtoinstantiatethatmodel. Thisdynamicalsystemisthensimulatedandthe
resultingtrajectoriesstudied: forinstance,tocomparewithexperimentalneuralorpsychological
data,ortojudgeagainstasyntheticbenchmark.
Typically,boththegenerativemodelandtheresultingdynamicalsystemsare‘modular’,and
themappingfromtheformertothelatterpreservesthisstructure: thatistosay,predictivecoding
formsanexampleoffunctorialsemantics,ofwhichwesawarudimentaryexamplein§3.3,whenwe
consideredanalgebraofrate-codedneuralcircuits. Thischaptermakesthisfunctorialityexplicit,
whichwehopetohaveausefulscientificconsequence:itoftenseemstobethecasethatresearchers
manuallyderivecomplicateddynamicalsystemsfromtheirstatisticalmodels[21,48,76,108,148,
264,265][205,Chapter5],butoncefunctorialityisestablished,thismanuallabourisunnecessary;
thefunctorrepresentsamachinewithwhichtheprocessmaybeautomated.
Wecallsuchfunctorsapproximateinferencedoctrines. Indefiningthem,webringtogetherthe
statistical games of Chapter 5 (which supply the ‘syntax’ of generative models) and the open
dynamicalsystemsofChapter6(whichsupplythe‘semantics’),andweexplainpreciselyhowthese
doctrinesmayfactorizethroughthevariouscomponentswehaveseen: thestochasticchannels,
theinferencesystems,thelossmodels,thedifferentialsystems,andthecilia. Thisistheworkof
§7.3,whichalsoestablishesthefunctorialityofpredictivecodingunderthe(Laplacian)freeenergy
principle. Beforewegetthere,weconstructsomefinalpiecesoftechnicalmachinery,aspectsof
whichwehaveseenbefore: stochasticchannelswithGaussiannoise,tomodelfunctionsofthe
formfpxq`ω withω Gaussian-distributed(§7.1);andexternallyparameterizedBayesianlenses,
sothatourconstructionshavethefreedomtolearn(§7.2).
261
7.1. Channels with Gaussian noise
Ourmotivatingexamplesfromthepredictivecodingliteratureincomputationalneuroscienceare
definedoverasubcategoryofchannelsbetweenCartesianspaceswithadditiveGaussiannoise
[33, 48, 101]; typically one writes x ÞÑ fpxq`ω, with f : X Ñ Y a deterministic map and ω
sampledfromaGaussiandistributionoverY. Thischoiceismade,aswesawin§5.3.3.4,because
itpermitssomesimplifyingassumptions,andtheresultingdynamicalsystemsresembleknown
neuralcircuits.
Inthissection,wedevelopsomecategoricallanguageinwhichwecanexpresssuchGaussian
channels,expandingontheinformaldefinitiongiveninRemark5.3.29. Wedosobythinkingof
x ÞÑ fpxq`ω asamapparameterizedbyanoisesource,andsotoconstructacategoryofsuch
channels,wecanusetheParaconstruction,followingProposition3.2.3. Becausethenoisecomes
fromtheparameter,weneedacategorywhoseobjectsarespacesequippedwithmeasures. Forthis,
wecanusethe‘pointing’constructionintroducedin§6.2.3;aswesawinExample6.2.25,thisgives
usacategoryofmeasurespaces. Thenextstepistospelloutanactegorystructurethatinduces
theparameterizationweseek.
Proposition7.1.1. SupposepC,b,Iqisamonoidalcategory,andsupposeD ãÑ C isasubcategory
towhichthemonoidalstructurerestricts. ThenthereisaD -actegorystructureD Ñ CatpD,Dq
˚ ˚
onD asfollows. ForeachpM,µq : D ,definepM,µq˚p´q : D Ñ D bypM,µq˚X :“ M bp´q.
˚
Foreachmorphismf : pM,µq Ñ pN,νqinD ,definef ˚p´q :“ f bp´q.
˚
Proofsketch. The action on morphisms is well-defined because each morphism f : pM,µq Ñ
pN,νqinD projectstoamapf : M Ñ N inD;itisclearlyfunctorial. Theunitorandassociator
˚
oftheactegorystructureareinheritedfromthemonoidalstructure,andtheysatisfytheactegory
axiomsforthesamereason.
Remark7.1.2. Notethattheconstructionof˚iseasilyextendedtoanactiononthewholeofC.
WewillhoweverbeconcernedonlywiththeactionofD onD.
˚
When we instantiate ˚ in the context of Meas ãÑ sfKrn, the resulting Para bicategory
Parap˚qcanbethoughtofasabicategoryofmapseachofwhichisequippedwithanindependent
noise source; the composition of maps takes the product of the noise sources, and 2-cells are
noise-sourcereparameterizations.
Inthiscase, theactegorystructure˚ismoreoversymmetricmonoidal, andthe1-categorical
truncationParap˚q (cf. Proposition3.2.8)isacopy-deletecategory,aswenowsketch.
1
262
Proposition 7.1.3. Suppose pC,b,Iq is a symmetric monoidal copy-discard category, and let
thesymmetryandcopy-discardstructurerestricttoD ãÑ C. ThenParap˚q isalsoasymmetric
1
monoidalcopy-deletecategory.
Proofsketch. ThemonoidalstructureisdefinedfollowingProposition3.2.5. Weneedtodefinea
rightcostrengthρwithcomponentspN,νq˚pX bYq ÝÑ „ X bppN,νq˚Yq. Since˚isdefinedby
forgettingthepointingandtakingthemonoidalproduct,thecostrengthisgivenbytheassociator
andsymmetryinD:
„ „ „
pN,νq˚pXbYq “ NbpXbYq ÝÑ NbpYbXq ÝÑ pNbYqbX ÝÑ XbpNbYq “ XbppN,νq˚Yq
Asthecompositeofnaturalisomorphisms,thisdefinitiongivesagainanaturalisomorphism;the
restofthemonoidalstructurefollowsfromthatofthemonoidalproductonC.
Wenowneedtodefineasymmetrynaturalisomorphismβ : X bY ÝÑ „ Y bX inParap˚q.
X,Y
ThisisgivenbythesymmetryofthemonoidalproductinD,undertheembeddingofDinParap˚q
thattakeseverymaptoitsparameterizationbythemonoidalunit.
Therestofthecopy-deletestructureisinheritedsimilarlyfromC viaD.
WhenC isacategoryofMarkovkernels,wewilltypicallythinkofthemorphismsofParap˚q
1
askernelswhoseuncertaintyarisesfromanoisyparameter. Toformalizethiswecanpushforward
thenoisetoobtainagainamorphisminC. ThisyieldsafunctorPush : Parap˚q Ñ C.
1
Proposition7.1.4. ThereisastrictmonoidalfunctorPush : Parap˚q Ñ C. Givenamorphism
1
inParap˚q
1
representedbyf : X Ý p Ý Ω Ý ,µ Ñ q Y,letPushpfqbethecompositef ‚pµbid
X
q : XÑ‚ Y
inC.
Proofsketch. First, the given mapping preserves identities: the identity in Parap˚q is trivially
parameterized,andisthereforetakentotheidentityinC.Themappingalsopreservescomposites,by
thenaturalityoftheunitorsofthesymmetricmonoidalstructureonC.Thatis,givenf : X Ý p Ý Ω Ý ,µ Ñ q Y
andg : Y Ý p Ý Θ Ý ,ν Ñ q Z,theircompositeg˝f : X Ý p Ý Θ Ý b Ý Ω Ý ,ν Ý b Ý µ Ñ q Z istakento
XÝÑ „ ‚ 1b1bXÝ ν Ý b Ý µ Ý‚ b Ý id ÝXÑΘbΩbXÝ g Ý ˝ ‚Ñ f Z
wherehereg˝f istreatedasamorphisminC. Composingtheimagesofg andf underthegiven
mappinggives
XÝÑ „ ‚ 1bXÝ µ Ý b Ý‚ id ÝXÑΩbXÝÑ f ‚ YÝÑ „ ‚ 1bYÝ ν Ý b ‚ÝÑ Y ΘbYÑÝ g ‚ Z
263
whichisequalto
XÝÑ „ ‚ 1b1bXÝ ν Ý b Ý µ Ý‚ b Ý id ÝXÑΘbΩbXÝ i Ý dΘÝ‚ b ÝÑ f ΘbYÑÝ g ‚ Z
whichinturnisequaltotheimageofthecompositeabove.
SincethemonoidalstructureonParap˚qisinheritedfromthatonC (withidenticalobjects),the
embeddingisstrictmonoidal.
Remark 7.1.5. Note that Push is not an embedding, since the mapping on hom sets need not
beinjective: pushingforwardthenoiseoftwoparallelmorphismsinParap˚q mayyieldequal
1
morphisms in C without the noise sources being isomorphic, and hence without the original
morphismsbeingequivalentinParap˚q;thatistosay,theparameterizationofnoisesourcesis
notgenerallyunique.
WenowrestrictourattentiontoGaussianmorphismsinC “ sfKrn.
Definition7.1.6. Wesaythatf : XÑ‚ Y insfKrnisGaussianif,foranyx : X,themeasurefpxq
isGaussian1. Similarly,wesaythatf : X Ý p Ý Ω Ý ,µ Ñ q Y inParap˚qisGaussianifitsimageunderPush
is Gaussian. We will write Gauss to denote the subcategory of sfKrn generated by Gaussian
kernelsandtheircomposites;likewise,wewillwriteGauss todenotetheGaussiansubcategory
˚
ofParap˚q. GivenaseparableBanachspaceX,wewillwriteGausspXqforthespaceofGaussian
statesonX.
Example 7.1.7. Random functions of the form x ÞÑ fpxq ` ω, where ω : Ω is distributed
accordingtoaGaussian,arethereforemorphismsinGauss . UndertheembeddingintoGauss,
˚
the corresponding kernel emits, for each x : X, a Gaussian distribution with mean fpxq`µ ,
ω
whereµ isthemeanoftheGaussianrandomvariableω,andvariancethesameasthatofω.
ω
Remark 7.1.8. In general, Gaussian morphisms are not closed under composition: pushing a
Gaussiandistributionforwardalonganonlineartransformationwillnotgenerallyresultinanother
Gaussian. For instance, consider the Gaussian functions x ÞÑ fpxq ` ω and y ÞÑ gpyq ` ω1.
` ˘ ` ˘
Their composite in Gauss is the morphism x ÞÑ g fpxq`ωq `ω1; even if g fpxq`ωq is
˚
` ˘
Gaussian-distributed,thesumoftwoGaussiansisingeneralnotGaussian,andsog fpxq`ωq `ω1
will not be Gaussian. This non-closure underlies the power of statistical models such as the
variational autoencoder, which are often constructed by pushing a Gaussian forward along a
1WeadmitDiracdeltadistributions,andthereforedeterministicmorphisms,asGaussian,sincedeltadistributionscan
beseenasGaussianswithinfiniteprecision.
264
learnt nonlinear transformation [155], in order to approximate an unknown distribution; since
sampling from Gaussians is relatively straightforward, this method of approximation can be
computationally tractable. The Gauss construction here is an abstraction of the Gaussian-
preservingtransformationsofShiebler[232],andistobedistinguishedfromthecategorywith
thesamenameintroducedbyFritz[109],whosemorphismsareaffinetransformations(whichdo
preserveGaussianness)andwhicharethereforeclosedundercomposition;thereisnonethelessan
embeddingofFritz’sGaussintoourGauss.
ForLaplacianstatisticalgames(intheimageofLFE),andfortheassociatedapproximateinference
doctrines,weareinterestedonlyinGaussianchannelsbetweenfinite-dimensionalCartesianspaces
Rn forn : N.
Definition7.1.9. DenotebyFdGaussthefullsubcategoryofGaussspannedbytheobjectsRn
forn : N.
Proposition7.1.10. Everychannelc : XÑ‚ Y inFdGaussadmitsadensityfunctionp
c
: YˆX Ñ
r0,1s with respect to the Lebesgue measure on Y. Moreover, since Y “ Rn for some n : N,
this density function is determined by two maps: the mean µ : X Ñ Rn, and the covariance
c
Σ : X Ñ Rnˆn inE. Wecallthepairpµ ,Σ q : X Ñ RnˆRnˆn thestatisticalparametersofc
c u c
(tobedistinguishedfromanyparameterizationinthecategory-theoreticsenseof§3.2).
Proof. Thedensityfunctionp : Y ˆX Ñ r0,1sisdefinedby
c
A E a
1
logp py|xq “ ϵ py,xq,Σ pxq´1ϵ py,xq ´log p2πqndetΣ pxq
c c c c c
2
wherethe‘error’functionϵ : Y ˆX Ñ Y isdefinedbyϵ py,xq :“ y´µ pxq.
c c c
7.2. Externally parameterized Bayesian lenses and statistical games
ThestatisticalgamesofChapter5aresimplyBayesianlensesequippedwithlossfunctions. Givena
statisticalgame,itslensisthereforefixed,andtheonlywaytoahighscoreonitslossisthroughits
opennesstotheenvironment—thedependenceonapriorandanobservation. Butthisseemslikea
strangemodelofadaptiveorcyberneticsystems,whichshouldalsobefreetochangethemselves
inordertoimprovetheirperformance.
Indeed, this changing-oneself is at the heart of the construction of approximate inference
doctrines,andinordertoincorporateitintothestructure,theremustbesomemorefreedomin
265
themodel: thefreedomtochoosethelens. Thisfreedomisaffordedbytheuseofparameterized
statisticalgames,andinparticular,externally parameterizedstatisticalgames,inthesenseof§3.2.2.
Remark 7.2.1. It is of course possible to define an actegorical (internal) parameterization of
statisticalgames,butthisseemstoprovemorecomplicatedthannecessaryforourpurposes.
Inadvanceofouruseofexternalparameterizationintheconstructionofapproximateinference
doctrines,recallthatwedenotetheexternalparameterizationofanenrichedcategoryC initsbase
of enrichment E by PC. This section is dedicated to exhibiting the external parameterizations
PBayesLens and PSGame of Bayesian lenses and statistical games, and the notion of
2
parameterizedlossmodel.
Remark7.2.2. BecauseBayesLens andSGamearebothbicategories,theyareweaklyenriched
2
in Cat. Consequently, following Remark 3.2.12, P has the type Cat-Cat Ñ pCat-Catq-Cat,
or equivalently, Bicat Ñ Tricat. This means that, in full generality, PBayesLens and
2
PSGame are tricategories: if B is a bicategory, then the hom-bicategory PBpa,bq is the
bicategoryCat{Bpa,bq. Becausewearenowworkingwithweakenedstructures(weakenrichment,
bicategories,laxlossmodels),wetakethistobealax sliceofCat.
Wepausetodefinethisnewnotion,generalizingourearlierDefinition3.2.10(slicecategory).
Definition7.2.3. SupposeX isa0-cellinabicategoryB. ThelaxsliceofBoverX,denotedB{X,
isthefollowingbicategory. Its0-cellsarepairspA,pqwhereAisa0-cellandpisa1-cellA Ñ X
inB. A1-cellpA,pq Ñ pB,qqisapairpf,ϕqwheref isa1-cellA Ñ B andϕisa2-cellp ñ q˝f
inB,asinthediagram
f
A B
ϕ .
p q
X
A2-cellpf,ϕq ñ pg,γqisa2-cellα : f ñ g inB suchthat
ϕ q˝α γ
p q˝f g˝g “ p q˝g .
(Inthisdefinition,˝denoteshorizontalcompositioninB.) ThehorizontalcompositioninB{X is
givenintheobviouswaybythehorizontalcompositionoftherelevant1-and2-cells. Likewise,
verticalcompositioninB{X isverticalcompositioninB. (Itiseasytocheckthatthesedefinitions
allsatisfytherelevantaxioms,henceconstitutingavalidbicategory.)
266
Wewillseehowthisstructureworksinpracticeinourexamplesofparameterizationbelow.
Remark7.2.4. Toavoidventuringinto3-and4-dimensionalcategorytheory,wewillrestrictthe
hom-bicategoriesofPBayesLens andPSGame tobelocallydiscrete,withtheparameterizing
2
objectsbeingmeresets(treatedasdiscretecategories). Strictlyspeaking,ourparameterizingsets
willbetheunderlyingsetsofdifferentialmanifolds—specifically,thetrivialmanifoldsRn—andwe
couldtreatthemproperlyasparameterizingcategoriesbyusingtheirgroupoidal(path)structure,
butwedonotpursuethishere. (Alternatively,wecouldfollowtheideaofProposition3.2.8and
truncatethehom-categoriesbyquotientingbyconnectedcomponents;butthisturnsthe1-cells
intoequivalenceclassesoffunctors,whichareagainmorecomplicatedthanwehavetheneedor
appetiteforhere.)
Restricting P to discrete parameterization means that we instantiate PBayesLens and
2
PSGameasfollows. BothbeingconstructedoverCopara pCq,webuildupfromPCopara pCq,
2 2
afterfirstsketchingthehorizontalcompositionofexternallyparameterizedbicategories.
Remark7.2.5. GivenabicategoryB,horizontalcompositioninPB isobtainedfromthestrong
monoidalstructureofthecovariantself-indexing(whichfollowsfromtheuniversalpropertyof
theproductofcategories)andthehorizontalcompositioninB. Foreachtripleof0-cellsa,b,c : B,
thecompositionpseudofunctorisgivenby
PBpb,cqˆPBpa,bq “ Cat{Bpb,cqˆCat{Bpa,bq ¨¨¨
` ˘
¨¨¨ ÝÑ „ Cat{ Bpb,cqˆBpa,bq Ý C Ý a Ý t Ý {˝ ÝaÝ,bÑ,c Cat{Bpa,cq “ PBpa,cq .
Observethatthisgeneralizesthelower-dimensionalcaseofDefinition3.2.11: first, wetakethe
productoftheparameterizingfunctors,andthenwecomposeintheircodomain.
Example7.2.6. The0-cellsofPCopara pCqarethe0-cellsofCopara pCq,whichareinturn
2 2
theobjectsofC. A1-cellfromX toY isachoiceof(discrete)parameterizingcategory(hencea
set)Θ,alongwithafunctorΘ Ñ Copara pCqpX,Yq. Moreintuitively,wecanthinkofsucha
2
1-cellasamorphisminC thatisboth(externally)parameterizedand(internally)coparameterized,
andwriteitasf : X Ý Θ Ñ Y,denotinga1-cellwithparameterΘ(inthebaseofenrichmentofC),
M
domainX,codomainY,andcoparameterM.
A 2-cell from f : X Ý Θ Ñ Y to f1 : X ÝÝ Θ Ñ 1 Y is a pair pϕ,φq of a functor ϕ : Θ Ñ Θ1 and a
M M1
natural transformation φ : f ñ f1 ˝ϕ. The functor ϕ changes the parameterization; and the
267
naturaltransformationφpermitsadditionallyacompatiblechangeofcoparameterization,being
givenbyanaturalfamilyof2-cellsinCopara pCq
2
` ˘ ` ˘
φθ : fθ : X ÝÑ θ Y ñ f1ϕpθq : X Ý ϕ Ý pθ Ñ q Y
M M1
indexed by the parameters θ : Θ. (With discrete parameterization, such a family is trivially
natural.) RecallingthedefinitionofCopara inTheorem5.2.1,thismeansthateachcomponent
2
φθ correspondstoamorphismXbM bY Ñ N inC satisfyingthechangeofcoparameteraxiom
withrespecttofθ andf1ϕpθq.
HorizontalcompositioninPCopara pCqisassketchedinRemark7.2.5:given1-cellsf : X Ý Θ Ñ
2
M
Y andg : Y ÝÑ Ω Z,theircompositeistheevidentg˝f : X Ý Θ Ñ Y ÝÑ Ω Z whoseparameteristhe
N M N
productΩˆΘandwhosecoparameteristhetensorofM andN. Thehorizontalcomposition
of 2-cells is likewise by first forming the product of their parameters. Vertical composition in
PCopara pCqisgivenbythehorizontalcompositionineachlaxslicehom(bi)category.
2
ThestructureofPBayesLens andPSGame followsthesamepattern.
2
Example7.2.7. The0-cellsofPBayesLens arethesamepairspX,AqasinBayesLens . A
2 2
1-cellfrompX,AqtopY,BqisabiparameterizedBayesianlens: apairpc,c1qofabiparameterized
forwards channel c : XÝ Θ Ñ‚ Y and a biparameterized inversion (state-dependent) channel c1 :
M
BÝ Θ Ý‚Ý ;X ÑA;herewehavedenotedthestate-dependenceandtheparameterizationtogetherasΘ;X.
M1
(Notethatinallourexamples,theforwardsandbackwardscoparameterswillbeequal,i.e.,M “ M1;
cf. Remark5.2.21ondependentoptics.)
A2-cellfrompc,c1q : pX,AqÝÝ Θ ÝÑpY,Bqtopd,d1q : pX,AqÝÝ Ω ÝÑpY,Bqisatriplepα,α ,α1q
| | 1
M,M1 N,N1
suchthatαisafunctorΘ Ñ Ω,pα,α qisa2-cellc ñ dinPCopara pCq(cf. Example7.2.6),and
1 2
pα,α1qisa2-cellc1 ñ d1 inPStat pXqpB,Aq. Thelattermeansthatα1 isafamilyof2-cellsin
2
Copara pCqpB,Aq
2
` ˘ ` ˘
α1θ : c1θ : B Ý θ Ý ; Ñ π A ñ d1αpθq : B Ý α Ý p Ý θq Ý ; Ñ π A
π π π
M1 N1
naturalinθ : Θandindexedbyπ : CpI,Xq. (Theprecedingexampleshowshowthiscorresponds
toanindexednaturalfamilyofchange-of-coparametermorphismsinC.)
HorizontalcompositioninPBayesLens isofcoursebytakingtheproductoftheparameters
2
andthenapplyinghorizontalcompositioninBayesLens ;andverticalcompositionishorizontal
2
compositioninthelaxslicesmakingupeachhom(bi)category.
268
Example7.2.8. StatisticalgamesareobtainedbyattachinglossfunctionstoBayesianlenses,and
hencetounderstandparameterizedstatisticalgameshavingelaboratedparameterizedBayesian
lensesintheprecedingexample,itsufficestoexhibitparameterizedlossfunctions.
A parameterized statistical game pX,Aq ÝÝ Θ ÝÑ pY,Bq consists of a parameterized Bayesian
M,M1
lens pX,AqÝÝ Θ Ý
|
ÑpY,Bq along with a parameterized loss function BÝ Θ Ý‚Ý ;X ÑI in PStatpXqpB,Iq.
M,M1
Since StatpXqpB,Iq is a discrete category, such a loss function is given by a function Θ Ñ
0
StatpXqpB,Iq, or equivalently (by the Cartesian closure of Set) a function Θ ˆ CpI,Xq Ñ
0
CpB,Iq. In the case where C “ sfKrn, this means a function Θ ˆsfKrnp1,XqˆB Ñ R
0 `
whichismeasurableinB.
A2-cellfromtheparameterizedstatisticalgamepc,c1,Kq : pX,Aq ÝÝ Θ ÝÑ pY,Bqtopd,d1,Lq :
M,M1
pX,Aq ÝÝ Ω ÝÑ pY,Bqisaquadruplepα,α ,α1,α˜qwherepα,α ,α1qisa2-cellofBayesianlenses
1 1
N,N1
andα˜ isafamilyofparameterizedlossfunctionsBÝ Θ Ý‚Ý ;X ÑI suchthatKθ “ Lαpθq`α˜θ,naturallyin
θ : Θ.
Horizontalandverticalcompositionofparameterizedstatisticalgamesandtheir2-cellsfollow
thepatternoftheprecedingexamples.
BecausePisfunctorial,wecanconsiderparameterizedversionsoftheinferencesystemsand
lossmodelsthatweintroducedin§5.3.2. Wecanthinkofparameterizationasintroducinga‘hole’
inastructure(suchasanextrainputtoasystem),andparameterizedinferencesystemsandloss
modelsareinferencesystemsandlossmodelsthataccountfor(andpossiblymodulate)suchholes.
Example 7.2.9. Suppose pD,ℓq is an inference system in C. P acts on the canonical inclusion
p´q : D ãÑ CoparalpDqtoreturntheinclusionPp´q : PD ãÑ PCoparalpDq,whichmaps
2 2
aparameterizedchanneld : XÝÑ Θ ‚ Y toitstriviallycoparameterizedformd : XÝÑ Θ ‚ Y.
I
ℓthenmapsachanneldtoalenspd,ℓdq. IfdisparameterizedbyΘ,thenitsinversionℓdunderℓ
willbeparameterizedaccordingly,sothatthewholelenspd,ℓdqhasparameterΘ. Thismappingis
theactionofthepseudofunctorPℓ : PD Ñ PBayesLens | ,inducedbytheparameterization
2 D
ofℓ.
However, in the next section, we will want approximate inference systems that do not just
preserveanexistingparameterization,butwhichalsoaddtoit,equipping(possiblyparameterized)
morphismswithinversionsthatmayhavetheirowndistinctcapacityforimprovementorlearning.
Forthisreason,wemakethefollowingdefinition.
269
Definition7.2.10. SupposepC,b,Iqisacopy-deletecategory. Aparameterizedinferencesystem
inC isapairpB,ℓqofasub-bicategoryB ãÑ PC alongwitha(strongfunctorial)sectionℓ : B Ñ
PBayesLens | of the restriction Ppπ q| to B of the parameterized 2-fibration Ppπ q :
2 B Lens B Lens
PBayesLens Ñ PCoparalpCq,whereB istheessentialimageoftherestrictiontoB ofthe
2 2
(parameterized)canonicallaxinclusionPp´q : PC ãÑ PCoparalpCq. Wesaylaxparameterized
2
inferencesystemwhenℓisalaxfunctor.
Atrivialexampleofalaxparameterizedinferencesystemisobtainedbytakingtheparameters
tobehomcategories,andthechoicefunctortobetheidentity,asthefollowingexampleshows.
Example 7.2.11. The following data define a lax parameterized inference system ℓ acting on
theentiretyofPC. First,letPpX,Y,MqdenotethefullsubcategoryofStat pXqpY,Xqonthose
2
objects(state-dependentmorphisms)withcoparameterM. Thenℓisdefinedasfollows.
(i) Each0-cellX ismappedtothe0-cellpX,Xq.
(ii) Each1-cellc : XÝ Θ Ñ‚ Y ismappedtotheparameterizedlenspc,c1q : pX,XqÝ Θ Ý ˆ Ý P Ý p Ý X
|
Ý ,Y Ý , Ý M Ñ q pY,Yq
M M
whoseforwardchannelischosenby
ΘˆPpX,Y,Mq Ý p Ý ro ÝÑ j 1 Θ ÑÝ c CoparalpCqpX,Yq
2
andwhoseinversechannelc1 : YÝ P Ý p Ý X Ý ,Y Ý‚ , Ý M Ý q Ý ;X ÑX ischosenby
M
proj
ΘˆPpX,Y,Mq ÝÝÝÑ2 PpX,Y,Mq ãÑ Stat pXqpY,Xq
2
` ˘ ` ˘
(iii) Each 2-cell pa,αq : c : XÝ Θ Ñ‚ Y ñ d : XÝÝ Θ ‚Ñ 1 Y is mapped to the 2-cell paˆα
˚
,α,αq,
M M1
where α is the functor defined by post-composing with α taken as a family of 2-cells in
˚
CopararpCqandhenceinPpX,Y,Mq.
2
Proof. First,weconfirmthatthemappingiswell-definedon1-cells(takingittobeevidentlysoon
0-cells): ingeneral,thecoparametersinPCopara pCqmaydependontheparameters,buthere
2
theparametersarisefromtheembeddingp´q : PC Ñ PCopara pCq. Theonlycoparameters
2
arethereforethosethatarisebycopy-composition,andtheirtypeisthusnotparameter-dependent.
Itisthereforelegitimatetomapa1-cellc : X Ý Θ Ñ Y toalenswithtypepX,XqÝ Θ Ý ˆ Ý P Ý p Ý X Ý ,Y Ý , Ý M Ñ q pY,Yq.
|
M ` M ˘ `
Next, wecheckwell-definednesson2-cells. Notethatthe2-cellpa,αq : c : XÝ Θ Ñ‚ Y ñ d :
˘ M
XÝÝ Θ ‚Ñ 1 Y inPCoparal
2
pCqisconstitutedbyafamilyofmorphismsαθ : X bM bYÑ‚ M1,and
M1 ` ˘ ` ˘
that a 2-cell YÝÑ‚ X ñ YÝÝ‚ÑX in Coparar
2
pCq has an underlying morphism of the same
M M1
270
type;henceeachαθ witnessessucha2-cellinCoparar
2
pCq. Inparticular,foreachπ : IÑ‚ X inC,
andforeachstate-dependentρ : YÝ X Ñ‚ X,αθ yieldsa2-cellfromρ
π
to
M
X
Y
α ˚ pθ,ρq π :“ ρ π .
M1
αθ
Thefunctorα isthusdefinedbymappingpθ,ρq : ΘˆPpX,Y,Mqtoα pθ,ρq : PpX,Y,M1q;its
˚ ˚
ownactionon2-cellsislikewisebyparameterizedpost-composition. Finally,notethatd1 isalso
givenbyevaluation,andsoαalsodefinesanindexednaturalfamilyof2-cells
` ˘ ` ˘
α
π
θ,ρ : c1
π
ρ “ ρ
π
: YÝÑ‚ X ñ d1
π
α˚pθ,ρq “ α
˚
pθ,ρq
π
: YÝÝ‚ÑX
M M1
asrequired(cf. Example7.2.7). Therefore,paˆα ,α,αqdefinesa2-cellinPBayesLens . This
˚ 2
iscompatiblewithℓbeingasectionofPπ ,aspaˆα ,α,αq ÞÑ pa,αq.
Lens ˚
Toestablishlaxunity,weneedtoexhibitafamilyof2-cellspi ,i ,i1 q : id ñ pid ,id1 q
X X1 X pX,Xq X X
naturalinX,whereid istheidentitylensonpX,XqinPBayesLens withtrivialparameter
pX,Xq 2
1,id isthelikewisetriviallyparameterizedidentityonX inPC,andid1 istheparameterized
X X
state-dependentchannelid1
x
: XÝ 1 Ý ˆ Ý P Ý p Ý X ‚Ý ,X ÝÝ ,1 Ñ q X definedbytheinclusion
1
„
1ˆPpX,X,1q ÝÑ PpX,X,1q ãÑ Stat pXqpX,Xq .
2
Clearly id1 is not constantly the identity morphism, and this is why ℓ is only laxly unital. By
X
defining the functor i : 1 Ñ 1ˆPpX,X,1q to pick the element id , the 2-cell i to be the
X X X1
identityonid ,andlikewisei1,weobtaintherequiredfamilyofwitnesses.
X x
Laxfunctorialityiswitnessedbyafamilyof2-cells
pf ,f ,f1 q : pd,d1q pc,c1q ñ pd‚c,pd‚cq1q
dc dc1 dc
(cid:11)
naturalinc : XÝ Θ Ñ‚ Y andd : YÝÑ Φ ‚ Z. Wedefinethefunctor
M N
f : ΘˆPpX,Y,MqˆΦˆPpY,Z,Nq Ñ ΘˆΦˆPpX,Z,M bNq
dc
bycomposition,f
dc
pθ,ρ,ϕ,χq :“ pθ,ϕ,ρ˝χ
cθ
q;itisthefactthatnotallmorphismsXÑ‚ Z factor
through Y that makes ℓ lax functorial. With f so defined, we can set both f and f1 to be
dc dc1 dc
identity2-cells,andthusobtaintherequisitewitnesses.
271
On the other hand, the only parameterized loss models we encounter will be those of §5.3.3
undertheactionofP. Thisisbecausetheabilitytochangeispartofthesystemitself,ratherthan
partofhowwemeasurethesystem2: wedonotseekto“movethegoalpoasts”. (Infuturework,we
mayconsidersystemswhoseperformanceisdependentonsomebroadercontext;butnothere.)
Therefore,ourparameterizedlossmodelswillallbeofthefollowingform.
Example7.2.12. IfLisalossmodelforB,thenitsparameterizationPLassignstoaparameterized
Bayesian lens pc,c1q : pX,AqÝÝ Θ ÝÑpY,Bq the correspondingly parameterized statistical game
|
` ˘ M,M1
c,c1,Lpcq . The parameterized loss function Lpcq thus also has parameter Θ and depends
accordingly on it, with type Lpcq : BÝ Θ Ý‚Ý ;X ÑI. For each θ : Θ, its component is the loss function
Lpcqθ : BÝ X Ñ‚ I which is assigned to the lens pcθ,c1θq by L (as a loss model applied to an
unparameterizedlens).
Remark7.2.13. Beforewemoveontoexamplesofapproximateinferencedoctrines,letusnotethe
similarityofthenotionsofexternallyparameterizedlens(Example7.2.7),cilia(Definition6.3.8),and
differentialcilia(Definition6.3.19): bothofthelattercanbeconsideredasexternallyparameterized
lenseswithextrastructure,wheretheextrastructureisamorphismorfamilyofmorphismsback
into(analgebraof)theparameterizingobject: inthecaseofdifferentialcilia,this‘algebra’isthe
tangentbundle;for(dynamical)cilia,itistrivial;andforgettingthisextrastructurereturnsamere
externalparameterization. Notably,the‘input’ontheexternalhompolynomialdefiningbothtypes
ofcilia(Definition6.3.1)correspondspreciselytothedomainofthelossfunctionofastatistical
game;andsothedomainsoftheupdatemapsofeithertypeofciliacorrespondtothedomainsof
parameterizedlossfunctions. Wewillmakeuseofthiscorrespondenceindefiningapproximate
inferencedoctrinesinthenextsection.
7.3. Approximate inference doctrines
Weareatlastinapositiontobuildthebridgebetweenabstractstatisticalmodelsandthedynamical
systems that play them: functors from a copy-discard category of parameterized channels to a
categoryofciliathatfactorizethroughaninferencesystem(modellinghowthesysteminvertsthe
channels)andpossiblyalossmodel(encodinghowwellthesystemisdoing). Intheround,wecan
thinkoftheresultingapproximateinferencedoctrinesas“dynamicalalgebras”forcategoriesof
parameterizedstochasticchannels(consideredasstatisticalmodels),whichtaketheparameters
2Physicallyspeaking,weadoptthe‘Schrödinger’perspectiveonchangeratherthanthe‘Heisenberg’perspective.
272
aspartofthedynamicalstatespacesothattheymightimprovethemselves. Thislineofthinking
leadsustothefollowingdefinitions.
Definition 7.3.1. Let pC,b,Iq be a copy-discard category, and let pB,ℓq be a parameterized
inferencesysteminC.
(a) AnapproximateinferencedoctrineisapseudofunctorB Ñ Cilia T thatfactorsthroughℓ,as
B Ý P Ý p Ý ´ Ý q Ý | ÑB B ÑÝ ℓ impℓq ÝÑ D Cilia T .
WesaylaxapproximateinferencedoctrineifDisinsteadalaxfunctor.
(b) AnapproximateinferencedoctrinewithlossLisanapproximateinferencedoctrinealongwith
alossmodelLforimpℓq,apseudofunctorDL : impLq Ñ Cilia T,andaniconλ : D ñ DL˝L,
asinthediagram
B Pp´q |B B ℓ impℓq D Cilia T
L λ .
DL
impLq
WesaylaxapproximateinferencedoctrinewithlossifLandDL arelaxfunctors.
(c) Adifferentialapproximateinferencedoctrinewithloss Lisanapproximateinferencedoctrine
withlossLsuchthatDL factorsthroughadifferentialsystem,asinthediagram
B Pp´q |B B ℓ impℓq D Cilia T
λ
L
impLq
DL
Cilia
T .
δ ş
∇
DiffCilia
ş
WesaylaxdifferentialapproximateinferencedoctrinewhenL,∇and arelaxfunctors.
Thedifferentfactorsofadifferentialapproximateinferencedoctrinewithlossencodethedifferent
stages by which a dynamical system is constructed from a statistical model: the parameterized
inferencesystemℓequipsaparameterizedchannelwithaparameterizedinversion;thelossmodel
Lequipstheresultinglenswithalossfunction;thefunctor∇translatesthisstatisticalgametoa
273
ş
differentialsystem,possiblyrepresentinggradientdescentontheloss;andfinallythefunctor
turnsthisdifferentialsystemintoadynamicalsystemthat‘flows’,possiblybyintegration.
Withthesedefinitionstohand,wecometoourmotivatingneuroscientificexamples. First(§7.3.1),
weformalizepredictivecodingusingtheLaplaceapproximationtothefreeenergy[21,33,104],
whichwesawin§5.3.3.4formsalaxlossmodelforGaussianlenses. Thisapproximationallowsthe
resultingdynamicalsystemstoexhibitsomebiologicalplausibility,withpredictionerrorscomputed
linearlyandthedynamicalupdatesobtainedasaffinetransformationsofpredictionerrors. Wecall
thistheLaplacedoctrine.
ApartfromrequiringGaussianchannels,theLaplacedoctrineisagnosticabouthowpredictions
areactuallygenerated,anditdoesnotproducesystemswhichareabletoimprovetheirpredictions;
they have no ‘synaptic’ plasticity, and thus do not learn. To remedy this, our second example
ofanapproximateinferencedoctrine(§7.3.2)ismoreopinionatedaboutthepredictiveforward
channels,restrictingthemtobeoftheformx ÞÑ θhpxq`ω whereθ isasquarematrixonY,h
isadifferentiablefunctionX Ñ Y,andω isdistributedaccordingtoaGaussianonY;compare
this with the form of the firing rate dynamics of rate-coded neural circuits in Definition 3.3.10.
The‘synaptic’parameter(orweightmatrix)θ canthenbelearnt,andthisisincorporatedintothe
statespaceofthesystemsproducedbythecorrespondingHebb-Laplacedoctrine,whichformalizes
anotherstandardschemeintheneuroscienceliterature[33]. Thenameofthisdoctrineindicates
anotheraspectofthebiologicalplausibilityofthisscheme: theθ-updatescanbeseenasaformof
Hebbianlearning[127].
Remark7.3.2. Inwhatfollows,inordertofocusonexemplification,weomitafulltreatmentof
allthehigher-categoricalstructure. Thismeansthatwedonotconsidertheactionofthedoctrines
on2-cells,andleaveleavethefullelaborationofthe2-dimensionalstructuretofuturework. Our
mainconcerninthisfinalpartisthescientificquestionofthecompositionalstructureofpredictive
coding,andonefurthermathematicalconsequenceofthisisthattheinferencesystemsonwhich
thedoctrinesarebasedwillnotbeunital: theschemesthatarepresentedintheliteratureinvolve
mappingswhichdonotpreserveidentitychannels.
7.3.1. PredictivecodingcircuitsandtheLaplacedoctrine
Notation7.3.3. AnycategoryC embedsintoitsexternalparameterizationPC bymappingevery
morphismtoitstriviallyparameterizedform;inamildabuseofnotation,wewilldenotetheimage
ofthisembeddingsimplybyC. Inthissection,wewillworkwiththetrivialparameterizationof
274
thesubcategoryFdGaussofsfKrnofGaussiankernelsbetweenfinite-dimensionalCartesian
spaces(Definition7.1.9). Hence,whenwewriteFdGauss ,itdenotestheimageofFdGauss
underPp´q .
WebeginbypresentingtheactionoftheLaplacedoctrineona(non-coparameterized3)Gaussian
channelc. Below,wewillseehowtheresultingsystemisobtainedfromadifferentialapproximate
inferencedoctrinewiththeLaplacianfreeenergyloss.
Proposition 7.3.4. Suppose c : XÑ‚ Y is a morphism in FdGauss, and fix a “learning rate”
λ : R. ThenthefollowingdatadefineasystemL pcq : pX,Xq Ñ pY,YqinCilia N,followingthe
λ
representationofProposition6.3.9.
(i) thestatespaceisX;
(ii) theforwardsoutputmapL pcqo : X ˆX Ñ GausspYqisdefinedby
λ 1
L pcqo : X ˆX Ý p Ý ro ÝÑ j 2 X ÑÝ c GausspYq ;
λ 1
(iii) theinverseoutputmapL pcqo : X ˆGausspXqˆY Ñ GausspXqisdefinedby
λ 2
L pcqo : X ˆGausspXqˆY Ñ R|X|ˆR|X|ˆ|X| ãÑ GausspXq
λ 2
` ˘
px,π,yq ÞÑ x,Σ px,π,yq
c1
wheretheinclusionpickstheGaussianstatewiththeindicatedstatisticalparameters,whose
` ˘
covarianceΣ px,π,yq :“ B2E px,yq´1 isdefinedfollowingequation(5.8)ofLemma
c1 x pc,πq
5.3.31(withtrivialcoparameterizationM “ 1);
(iv) theupdatemapL pcqu : X ˆGausspXqˆY Ñ GpXqisdefinedby
λ
L pcqu : X ˆGausspXqˆY Ñ X ãÑ GpXq
λ
px,π,yq ÞÑ x`λB µ px,yqTη px,yq´λη pxq
x c c π
wheretheinclusionX ãÑ GpXqisgivenbytheunitoftheGirymonadG whichtakeseachx : X
to the corresponding delta distribution, and where η px,yq :“ Σ pxq´1ϵ py,xq and η pxq :“
c c c π
Σ´1ϵ pxq.
π π
3Notethatallcoparameterizedchannelsofinterestareobtainedasthecopy-compositesofnon-coparameterized
channels.
275
Remark7.3.5. NotethattheupdatemapL pcqu isactuallydeterministic,inthesensethatitis
λ
definedasadeterministicmapfollowedbytheunitoftheprobabilitymonad. However,thegeneral
stochasticsettingisnecessary, becausethecompositionofsystemdependsonthecomposition
of Bayesian lenses; recall Definition 6.3.6, which defines the bidirectional composition of cilia.
Intuitively,wecanconsideracompositesystemL pdq˝L pcqandnotethattheforwardinputsto
λ λ
thedcomponentandthebackwardinputstotheccomponentwillbesampledfromthestochastic
outputsofcanddrespectively. Becausetheseinputsarepassedtothecorrespondingupdatemaps,
theupdatesinheritthisstochasticity.
Remark7.3.6. Thetermsη px,yq “ Σ pxq´1ϵ py,xqintheupdatemapoftheLaplacedoctrine
c c c
canbeunderstoodasprecision-weightederror terms: theinversecovarianceΣ pxq´1 encodesthe
c
‘precision’ of the distribution (consider the univariate case); and the term ϵ py,xq “ y ´µ pxq
c c
encodesthe‘error’betweentheobservationy andthepredictedmeanµ pxq. Therepresentation
c
ofpredictionerrorsisahallmarkofpredictivecodingschemes.
Todefineanapproximateinferencedoctrine,weneeda(parameterized)inferencesystem. For
predictivecoding,thiswillbeobtainedbyassigningtoeachchannelcaninversionwhoseparameter
representsthemeanoftheemittedposterior;thisparameterwilllaterbelearnedbytheresulting
doctrine. Inorderforthisassignmenttobefunctorial,werestricttheposteriorsemittedbythis
inferencesystemtohavediagonalcovariance,meaningthattherewillbenocorrelationsbetween
dimensions. Thisformalizeswhatisknownintheliteratureasameanfield assumption[48,101],
withoutwhichthoseearlierworkswouldnothavebeenabletomakeimplicituseoffunctoriality.
Proposition7.3.7(MeanfieldLaplace). Aslongas‚denotescopy-composition,thefollowing
data define a (non-unital) strong parameterized inference system ℓ on FdGauss. Each 0-cell
X is mapped to pX,Xq. Each 1-cell c : XÝÑ‚ Y is mapped to the parameterized lens pc,c1q :
M
pX,XqÝ X ÝÝ ˆ Ý M ÑpY,Yq whose forward channel is c and whose parameterized backward channel
|
M
c1 : YÝ X Ý ˆ Ý M ‚ÝÝ ;X ÑX emitstheGaussianwithmeanpx,mq : XˆM determinedbytheparameterand
M ` ˘
whichminimizesthe(mean-field)Laplacianfreeenergy. Thus,writing µx,m pyq,Σx,m pyq forthe
c1 c1
π π
statisticalparametersofc1x,m pyq,ℓassigns
π
˜` ˘ ¸
B2E px,m,yq´1 0
µx,m pyq :“ px,mq and Σx,m pyq :“ x pc,πq ` ˘ .
c1 π c1 π 0 B m 2 E pc,πq px,m,yq´1
276
where B2 denotes the diagonal Hessian4 It is the diagonal structure of Σx,m that justifies the
c1
π
‘mean-field’moniker.
Proof. First, we note that ℓ fails to be unital because, for each identity channel id
X
: XÝ X Ñ‚ , the
meanoftheassignedinversionid1 isdeterminedbytheparameterX,ratherthantheinput. If
X
thisparameterhappenstoequaltotheinput, thenid1 willactuallyactastheidentitychannel.
X
Thisisbecausewecanunderstandtheidentitychannelasthelimitasσ Ñ 0ofaGaussianwith
meanequaltotheinputxandvarianceσ1 (where1 istheidentitymatrixonX). Informally,
X X
`
wehaveΣx px1q “ B2E px,x1q´1 “ 0,andsopid1 qx actsastheDiracdeltadistribution
pid1
X
qπ x pidX,πq X
ontheparameterx;butofcourseingeneraltheparameterxneednotequaltheforwardinput.
Next,weshowthatℓisstronglyfunctorial(aslongas‚isalwaysinterpretedascopy-composition).
Ifc : XÝÑ‚ Y andd : YÝÑ‚ Z arecomposableGaussianchannels,thenthestatisticalparametersof
M N
thecompositeapproximateinversionc1˝d1
c
: ZÝ Y ÝÝ N
M
Ý X
Y
‚Ý M
N
ÝÝ ;X ÑX areµy
pc
,n
1˝
,
d
x
1 c
,m
qπ
pzq “ px,m,y,nqand
» ` ˘ fi
B2E px,m,yq´1
— ` x pc,πq˘ ffi
— B2 E px,m,yq´1 ffi
Σy,n,x,m pzq “ diag—` m pc,π˘q ffi .
pc1˝d1 c qπ – ` B y 2E pd,c‚πq˘ px,m,y,n,zq´1fl
B2E px,m,y,n,zq´1
n pd,c‚πq
Notethat,byinterpreting‚ascopy-composition,wehave
E px,m,y,n,zq “ ´logp pn,z|yq´logp pm,y|xq´logp pxq .
pd,c‚πq d c π
` ˘
On the other hand, ℓ assigns to d ‚ c : XÝÝÝ‚ÝÑZ the lens d ‚ c,pd ‚ cq1 whose inversion
MYN
pd‚cq1 : ZÝ X ÝÝ M Ý Y ‚Ý N ÝÝ ;X ÑX isdefinedbythestatisticalparametersµx,m,y,n pzq “ px,m,y,nqand
MYN
pd‚cq1
π
»` ˘ fi
B2E px,m,y,n,zq´1
— ` x pd‚c,πq˘ ffi
— B2 E px,m,y,n,zq´1ffi
Σx,m,y,n pzq “ diag—` m pd‚c,πq˘ ffi
pd‚cq1 π – ` B y 2E pd‚c,πq˘ px,m,y,n,zq´1fl
B2E px,m,y,n,zq´1
n pd‚c,πq
where
E px,m,y,n,zq “ ´logp pn,z|yq´logp pm,y|xq´logp pxq
pd‚c,πq d c π
“ E px,m,y,n,zq .
pd,c‚πq
Consequently,Σx,m,y,n pzq “ Σy,n,x,m pzq. Itthereforesufficestotakethelaxatorℓpdq ℓpcq ñ
pd‚cq1
π
pc1˝d1
c
qπ
(cid:11)
ℓpd‚cqtobedefinedbytheisomorphismpY ˆNqˆpX ˆMq ÝÑ „ pX ˆMqˆpY ˆNq.
4Thatis,B2fpxqcanberepresentedasthematrixwithdiagonalequaltothediagonaloftheHessianmatrixB2fpxq
x x
andwithallothercoefficients0.
277
Remark 7.3.8. Note that the preceding inference system requires ‚ to be interpreted as copy-
compositioneverywhere,whichisnotstrictlyinaccordancewithourearlierusage(whichmixed
copy-compositionwithordinarycompositioninthestate-dependence). Resolvingthisirregularity
isthesubjectofongoingwork.
Proposition7.3.9. StochasticgradientdescentwithrespecttothemeanparameterofLaplacianfree
energygamesintheimageofℓyieldsastrongfunctor∇ : L Ñ DiffCilia,whereListheessential
image of LFE restricted to the essential image of ℓ. If c :“ pc,c1,Lcq : pX,Xq Ý X ÝÝ ˆ Ý M Ñ pY,Yq is
M
suchagame(a1-cell)inL,then∇cisthedifferentialciliumpX,Xq Ý X ÝÝ ˆ Ý M Ñ pY,Yqwithstatespace
equaltotheparameterX ˆM definedasfollows.
Foreachpx,mq : XˆM,∇coutputsthenon-coparameterizedBayesianlensℓpcq x,m : pX,Xq ÑÞ
pY,Yqobtainedbytakingthedynamicalstatepx,mqastheparameterofthelensanddiscarding
anycoparameters.
The ‘update’ vector field p∇cqu : pX ˆ Mq Ñ GausspXq Ñ YÑ‚ TpX ˆ Mq is obtained
bytakingthenegativegradientofthelossfunctionLc : YÝ G ÝÝ au Ý s Ý s Ý pX ‚Ý ˆ Ý M ÝÝ q Ý ;X ÑI withrespecttothe
posteriormeanparameter,evaluatedattheposteriormean:
pX ˆMq Ñ GausspXq Ñ Y Ñ TpX ˆMq
` ˘
px,m,π,yq ÞÑ ´ B E px,m,yq .
px,mq pc,πq
(ThisyieldsamorphisminsfKrnviatheembeddingMeas ãÑ sfKrn;itisclearlymeasurableas
itisacontinuousfunctionbetweenCartesianspaces.)
Proof. SincethestatespaceX ˆM isthespaceofmeansoftheLaplacianposteriors,the‘update’
actionof∇c,theopenvectorfieldp∇cqu,isdefinedasthe(negative)gradientofLc withrespect
tothesemeans(sothattheassociatedflowperformsgradientdescent). Theparameterizedloss
functionLc : YÝ X Ý ˆ Ý M ‚ÝÝ ;X ÑI encodestheLaplacianfreeenergyassociatedtotheparameterizedlens
pc,c1q,andcorresponds(byExample5.3.4)tothefunction
X ˆM Ñ GausspXq Ñ Y Ñ r0,8s
px,m,π,yq ÞÑ LFEpc,c1x,mq pyq
π
where
LFEpc,c1x,mq pyq “ E px,m,yq´S rc1x,mpyqs .
π pc,πq XbM π
278
The entropy S rc1x,m pyqs does not depend on the mean of c1x,m pyq, and so the gradient of
XbM π π
` ˘
LFEpc,c1x,mq pyqwithrespecttopx,mqissimply B E px,m,yq. Hencedefiningp∇cqu
π px,mq pc,πq
asstatedyields
` ˘
p∇cqu : px,m,π,yq ÞÑ ´ B E px,m,yq .
px,mq pc,πq
Wenowshowthat∇isstronglyfunctorialwithrespecttocompositionof1-cellsinL. First,we
checkthat∇satisfiesthestrongunityaxiom,whichmeansweneeda2-isomorphismid ñ
pX,Xq
∇pid qinDiffCilia. Notethattheciliumid hastrivialstatespace1,trivialupdatemap,
pX,Xq pX,Xq
andoutputstheidentitylenspX,Xq ÑÞ pX,Xq. Likewise,theidentitygameid hastrivial
pX,Xq
parameter1,lossfunctionequalto0,andlensbeingthe(triviallycoparameterizedcopy-composite)
identitylenspX,Xq ÑÞ pX,Xq.Sincethelossfunctionisconstantly0withtrivialparameter,∇acts
toreturnaciliumpX,Xq ÑÝ 1 pX,Xqagainwithtrivialstatespaceandwhichconstantlyoutputsthe
identitylens;itsupdatemapislikewisetrivial. Thereforewetakethe2-cellid ñ ∇pid q
pX,Xq pX,Xq
tobewitnessedbytheidentityid : 1 Ñ 1,whichsatisfiesstrongunityafortiori.
1
Finally, we check that ∇ satisfies the strong functoriality axiom, meaning that we seek a 2-
` ˘
isomorphism∇pd,d1,Ldq˝∇pc,c1,Lcq ñ ∇ pd,d1,Ldq˝pc,c1,Lcq foreachpairofcomposable
Laplacianfreeenergygamespc,c1,Lcq : pX,XqÝ X ÝÝ ˆ Ý M ÑpY,Yqandpd,d1,Ldq : pY,YqÝ Y Ý ˆ Ý N ÑpZ,Zq.
| |
M N
Note that the composite game has the type pX,XqÝ p Ý Y Ý ˆ Ý N Ý q Ý ˆ Ý pX Ý ˆ ÝÝ M Ñ q pZ,Zq, that by the universal
|
MYN
propertyofˆwehaveanisomorphismpY ˆNqˆpX ˆMq – pX ˆMqˆpY ˆNq,andthat
theproductofGaussiansisagainGaussian. NotealsothattheparameterizedlossfunctionLd˝Lc
equals
pY ˆNqˆpX ˆMq Ñ GausspXq Ñ Z Ñ r0,8s
py,n,x,m, π, zq ÞÑ pLcq x,m ˝d1y,n pzq`pLdq y,n pzq .
π c‚π c‚π
` ˘
Ontheotherhand,theupdatemapofthecompositecilium ∇pd,d1,Ldq˝∇pc,c1,Lcq u equals
` ˘
pX ˆMqˆpY ˆNq Ñ GausspXq Ñ‚ Z Ñ ` T pX ˆMqˆpY ˆNq ˘
.
px,m,y,n, π, zq ÞÑ p∇cuq x,m ‚d1y,n pzq, p∇duq y,n pzq
π c‚π c‚π
` ˘
The desired 2-isomorphism ∇pd,d1,Ldq ˝ ∇pc,c1,Lcq ñ ∇ pd,d1,Ldq ˝ pc,c1,Lcq is thus
witnessed by a map pY ˆNq Ñ pX ˆMq Ñ pX ˆMqˆpY ˆNq, which we take to be the
symmetryswapofthecategoricalproduct. ComputingthegradientoftheLtermsinLd˝Lc with
respecttothemeanofthejointGaussianpχ,ρqyieldstheupdatemap
` ˘
pY ˆNqˆpX ˆMq Ñ GausspXq Ñ‚ Z Ñ
`
T pY ˆNqˆpX ˆMq
˘
py,n,x,m, π, zq ÞÑ p∇duq y,n pzq, p∇cuq x,m ‚ ÐÝ d y,n pzq
c‚π π c‚π
279
` ˘
whichisclearlyequalto ∇pd,d1,Ldq˝∇pc,c1,Lcq u uponcompositionwithswap. Ittherefore
onlyremainstocheckthatthetwociliaoutputthesameBayesianlensespX,Xq ÑÞ pZ,Zq,upto
swap. Thisfollowsfromthestrongfunctorialityofℓ.
Remark7.3.10. Althoughwehavedefined ∇manually, weexpectthat itcanalternativelybe
obtainedmoreabstractly,fromapropertreatmentofstochasticgradientdescentappliedtostatistical
games. Weleavethistofuturework.
Finally,toobtainthedynamicalsystemswithwhichwestartedthissubsection(inProposition
7.3.4),weuseEulerintegration,usingthefunctorEuler ofRemark6.3.25.
λ
Corollary 7.3.11. Fix a real number λ : R. By defining L :“ Euler ˝ ∇ ˝ LFE one obtains
λ λ
Laplacianpredictivecodingasadifferentialapproximateinferencedoctrine,theLaplacedoctrine
forthemeanfieldLaplaceinferencesystemℓ. ThesystemsofProposition7.3.4areobtainedinits
image.
Proof. Supposec : XÑ‚ Y isamorphisminFdGauss. Itisnotcoparameterized,soℓassignstoit
theparameterspaceX,whichbecomesthestatespaceoftheciliumL pcq. Bydefinition,thiscilium
λ
emitsthesamelens—andthereforehasthesameoutputmaps—asthosegiveninProposition
7.3.4. Wethereforeonlyneedtocheckthat
` ˘ ` ˘
∇pcqu x pyq “ ´ B E px,yq
π x pc,πq
“ B µ px,yqTη px,yq´η pxq .
x c c π
RecallfromProposition5.3.31that
E px,yq “ ´logp py|xq´logp pxq
pc,πq c π
@ D @ D
1 1
“ ´ ϵ py,xq,Σ ´1ϵ py,xq ´ ϵ pxq,Σ ´1ϵ pxq
c c c π π π
2 b b2
`log p2πq|Y|detΣ `log p2πq|X|detΣ .
c π
Itisthenasimpleexerciseinvectorcalculustoshowthat
` ˘
´ B E px,yq “ B µ px,yqTη px,yq´η pxq
x pc,πq x c c π
asrequired.
280
7.3.2. SynapticplasticitywiththeHebb-Laplacedoctrine
TheLaplacedoctrineconstructsdynamicalsystemsthatproduceprogressivelybetterposterior
approximationsgivenafixedforwardschannel,butnaturaladaptivesystems—brainsinparticular—
domorethanthis: theyalsorefinetheforwardschannelsthemselves,inordertoproducebetter
predictions. Indoingso,thesesystemsbetterrealizetheabstractnatureoffreeenergygames,for
whichimprovingperformancemeansimprovingbothpredictionaswellasinversion. Tobeableto
improvetheforwardschannelrequiresallowingsomefreedominitschoice,whichmeansgivingit
anontrivialparameterization.
The Hebb-Laplace doctrine that we introduce in this section therefore modifies the Laplace
doctrinebyfixingaclassofparameterizedforwardschannelsandperformingstochasticgradient
descentwithrespecttoboththeseparametersaswellastheposteriormeans;wecallittheHebb-
Laplacedoctrineastheparticularchoiceofforwardschannelsresultsintheirparameter-updates
resemblingthe‘local’Hebbianplasticityknownfromneuroscience,inwhichthestrengthofthe
connectionbetweentwoneuronsisadjustedaccordingtotheircorrelation[79,118,127,218,233].
(Here,wecouldthinkofthe‘neurons’asencodingthelevelofactivityalongabasisvector.)
Webeginbydefiningthecategoryoftheseparameterizedforwardschannels,afterwhichwe
proceedbymodifyingthemean-fieldLaplaceinferencesystemandtheLaplacedoctrineaccordingly.
Definition7.3.12(‘Neural’channels). LetHdenotethesubbicategoryofPFdGauss generated
˚
by1-cellsXÑ‚ Y oftheform
Θ Ñ Gauss pX,Yq
X ˚
´ ¯
θ ÞÑ x ÞÑ θhpxq`ω
whereX andY arefinite-dimensionalCartesianspaces,hisadifferentiablemapX Ñ Y,Θ is
X
thevectorspaceofsquarematricesonX,andω issampledfromaGaussiandistributiononY.
Proposition7.3.13(MeanfieldHebb-Laplace). Taking‚ascopy-composition,thefollowingdata
define a (non-unital) strong parameterized inference system ℓ on H. Each 0-cell X is mapped
to pX,Xq. Each (parameterized) 1-cell c : XÝ Θ Ñ‚ Y is mapped to the parameterized lens pc,c1q :
M
pX,XqÝ Θ Ý ˆ Ý p Ý X Ý ˆ Ý M ÝÑ q pY,YqwhoseforwardchannelisgivenbyprojectingΘfromΘˆpXˆMqand
|
M
applyingc,andwhosebackwardchannelisdefinedasinProposition7.3.7(mean-fieldLaplacian
inference).
281
Proof. TheonlydifferencefromProposition7.3.7isintheforwardchannel;butthesearejusttaken
fromH,andsotheycomposestronglybyassumption.
LiketheLaplacedoctrine,theHebb-Laplacedoctrineisobtainedbystochasticgradientdescent
withrespecttotheparameters.
Proposition7.3.14. LetLdenotetheessentialimageofLFErestrictedtotheessentialimageofℓ.
Letc :“ pc,c1,Lcq : pX,Xq Ý Θ Ý ˆ Ý p Ý X Ý ˆ Ý M ÝÑ q pY,Yqbea1-cellinL. Thenstochasticgradientdescent
M
yields an identity-on-objects strong functor ∇ : L Ñ DiffCilia mapping c to the differential
cilium∇pcq : pX,Xq Ý Θ Ý ˆ Ý p Ý X Ý ˆ Ý M ÝÑ q pY,Yqdefinedasfollows.
Foreachtripleofparameterspθ,x,mq : ΘˆpX ˆMq,∇coutputsthenon-coparameterized
Bayesianlensℓpcq θ,x,m : pX,Xq ÑÞ pY,Yqobtainedbytakingthedynamicalstatepθ,x,mqasthe
parameterofthelensanddiscardinganycoparameters.
Thevectorfieldp∇cqu isobtainedbytakingthegradientofthelossfunctionLc withrespectto
the‘synaptic’parameterθ : Θandtheposteriormeanpx,mq : X ˆM,evaluatedatpθ,x,mq:
ΘˆpX ˆMq Ñ GausspXq Ñ Y Ñ TpΘˆpX ˆMqq
` ˘
pθ,x,m,π,yq ÞÑ ´ B E pθ,x,m,yq .
pθ,x,mq pc,πq
Proof. TheproofisalmostidenticaltothatofProposition7.3.9: thesoledifferenceisthatnowwe
alsotakegradientswithrespecttothesynapticparameterθ : Θ,butthereasoningisotherwisethe
same.
Finally,weobtaindynamicalsystemsbyEulerintegration.
Definition7.3.15. Fixarealnumberλ : R. TheHebb-Laplacedoctrineisobtainedasthecomposite
H :“ Euler ˝∇˝LFE,yieldingadifferentialapproximateinferencedoctrineforthemeanfield
λ λ
Hebb-Laplaceinferencesystemℓ.
Corollary7.3.16. Supposec : XÝÑ Θ ‚ Y isachannelinHdefinedbycθpxq “ θhpxq`ω,forsome
differentiablehandGaussiannoiseω. ThentheupdatemapH pcqu isgivenby
λ
ΘˆX Ñ GausspXq Ñ Y Ñ ˆ ΘˆX ˙
θ´λη px,yqhpxqT
pθ,x, π, yq ÞÑ cθ
x`λB hpxqTθTη px,yq´λη pxq
x cθ π
whereη px,yq “ Σ´1ϵ py,xqandη pxq “ Σ´1ϵ pxqaretheprecision-weightederrorterms.
cθ cθ cθ π π π
282
Proof. FollowingCorollary7.3.11(theLaplacedoctrine),Wejustneedtocheckthat
ˆ ˙ ˆ ˙
`
B E
˘
px,yq “
B
θ
E
pcθ,πq px,yq “
η
cθ
px,yqhpxqT
.
pθ,xq pcθ,πq B E ´B hpxqTθTη px,yq`λη pxq
x pcθ,πq x cθ π
ThisamountstoverifyingthatB µ pxq “ θB hpxqandthatB E px,yq “ η px,yqhpxqT.
x cθ x θ pcθ,πq cθ
Theformerholdsbythelinearityofderivationsinceµ pxq “ θhpxqbydefinition;andthelatter
cθ
holdsbecause
@ D
´B
B E px,yq “ θ ϵ py,xq,Σ´1ϵ py,xq
θ pcθ,πq 2 cθ cθ cθ
@ ` ˘D
´B
“ θ y´θhpxq,Σ´1 y´θhpxq
2 cθ
` ˘
“ Σ´1 y´θhpxq hpxqT
cθ
“ Σ´1ϵ py,xqhpxqT
cθ cθ
“ η px,yqhpxqT
cθ
asrequired.
Remark 7.3.17. From a biophysical point of view, the Hebb-Laplace doctrine so defined has
a notably suboptimal feature: the ‘synaptic’ forwards parameter θ : Θ is updated on the same
timescale λ as the parameter x : X that encodes the posterior mean, even though the latter
parameter is typically interpreted as encoding the activity of a population of neurons, which
thereforechangesonafastertimescalethanthoseneurons’synapses. Notonlyisthisimportant
forreasonsofbiologicalplausibility,butalsoformathematicalreasons: weshouldunderstandthe
backwardsactivityasbundledovertheforwardssynapses,andachangeintheparameterθ should
induceacorresponding‘transport’ofx. Anappropriatelygeometrictreatmentofcompositional
approximateinferenceandpredictivecoding,resultinginbundlesofopendynamicalsystems,is
againsomethingthatweleavetofuturework.
283
8. Future directions
Apowerfulmotivationpropellingthedevelopmentofthisthesiswasthebeliefthatscience,and
particularlythecognitivesciences,willbenefitfrombeingsuppliedwithwell-typedcompositional
foundations. Inthisfinalchapter,wesurveyanumberofnewvistasthatwehaveglimpsedfrom
thevantagepointofourresults,andindicateroutesthatwemightclimbinordertoseethembetter.
Oneimportantbenefitofthecategoricalframeworkisthatithelpsusexpressideasatauseful
levelofabstraction,andtherebycomparepatternsacrosssystemsandphenomenaofinterest. Asa
result,althoughourprimarysystemofinterestisthebrain,weareawarethatmuchofourworkis
morediverselyapplicable,andsooursurveyhereissimilarlynotrestrictedtoneuralsystems. At
thesametime,asneuralsystemsareourfinestexamplesofnaturalintelligence,weattempttostay
groundedincurrentneuroscience.
Beyond the evident shortcomings of the work that we have presented—which we review
momentarily—wefirstconsiderhowtousethecategoricallanguageofstructuretoincorporate
structurebetterintoourmodelsthemselves(§8.1),withaparticularfocusonthebrain’s“cognitive
maps”(§8.1.3). Wewillseethatthecompositionalconsiderationofthestructureofopensystems
naturally leads us to consider societies of systems (§8.2), and hence the relationships between
compositionalactiveinferenceandsingle-andmulti-agentreinforcementlearningandeconomic
gametheory(§8.2.3),althoughourfirstpriorityinthissectionistheincorporationofaction(§8.2.1)
andplanning(§8.2.2)intotheframeworkofstatisticalgames. Fromourabstractvantagepoint,there
islittledifferencebetweensocietiesofagentsandcollectivenaturalsystemssuchasecosystems1,
andsowethenconsidertheprospectsforacompositionalmathematicsoflife(§8.3). Finally,we
closewithsomethoughtsonmattersoffundamentaltheory(§8.4).
Beforewewadeintothethickofit,letusnotethreeprominentexamplesoftheaforementioned
evidentshortcomings.
Firstly,thecurrentpresentationofcopy-compositestochasticchannels,andthebicategoriesof
lensesandstatisticalgamesthatresultfromthem,isquiteinelegant: thenecessityofcoparameters
1Afterall,asinglemulticellularorganismisitselfakindofsocietyofagents.
284
introduces substantial complexity that is never repaid, because all coparameters arise from the
copy-compositionofordinarychannels.Thiscomplexityinfectsthenotionofapproximateinference
doctrine,whichcouldbenefitbothfromsimplificationandfromfurtherexemplification,ideallyby
examplesdrawnfrombeyondneuroscience.
Secondly, the generative models that we have considered are somehow ‘static’, despite our
interestindynamicalsystems,andthiswarrantsasatisfactoryexplorationofdynamical generative
models.
Thirdly,althoughweconsidered“lowerlevel”neuralcircuitmodelsin§3.3,wedidnotexplicitly
connect our approximate inference doctrines to these more ‘biological’ models. A satisfactory
accountoftheBayesianbrainwouldofcoursespanfromabstractprinciplestodetailedbiology,a
relationshiptheelaborationofwhichwesadlyweleavetofuturework.
Fortunately,althoughthesethreeshortcomingsmaybepressing,weexpectthatthepursualofa
researchprogrammeakintothatsketchedbelowwouldresultinovercomingthem.
8.1. Structured worlds
8.1.1. Bayesiansensorfusion
A situation that is common in natural embodied systems but which is not yet well treated by
current statistical and machine learning methods2, particularly those that are most popular in
computationalneuroscience,isthatofsensorfusion. Inthissituation,onehasanumberofsensors
(suchascamerasorretinalganglioncells)whichreportspatiallysituateddata,andwherethesensor
fieldsoverlap inthespace;theproblemisthenhowtocombinethese“localviews”ofthespace
intoacoherentglobalpicture. Mathematically,fusing‘local’dataintoa‘global’representationis
thejobofsheaves: asheafisa“spatiallycoherentdatatype”—somethinglikeabundleforwhich
‘local’sectionscanalwaysbeuniquelygluedtogetherintoaglobalsection—andsheaftheoryand
the related fields of applied topology and cohomology allow us to judge when it is possible to
formaconsensus,andquantifytheobstructionstotheformationofconsensus;recentworkhas
alsobeguntosuggestalgorithmsanddynamicsbywhichwecanconstructconsensus-forming
distributedsensorsystems[123].
Sheavesthereforeallowustoconstructandtomeasurespatiallystructureddatatypes,butmissing
fromthecurrentsheaf-theoreticunderstandingofsensorfusionisathoroughtreatmentofbelief
anduncertainty,especiallyfromaBayesianperspective. Sincebiologicalsystemscontainmany
2Thisisbeginningtochange:recently,theuseofsheaf-theoreticandotherapplied-topologicaldeviceshasstartedto
penetratemachinelearning[31,266].
285
distributedsensortypes,andeachofthesesystemsisconstitutedbymanycells,themathematics
ofneuralrepresentationsmaybeexpectedtobesheaf-theoretic. Afirstpossibleextensionofthe
workpresentedhere,therefore,istoextendstatisticalgamesandapproximateinferencedoctrines
(and hence the classes of model that they encompass) to structured data types such as sheaves.
Becausestatisticalgamesandapproximateinferencedoctrinesaredefinedusinglensesoveran
abstractcategoryofstochasticchannels,weexpectthatthefirststepwillbetoconsidercategories
ofchannelsbetweensheaves;recently,therehasbeenworkoncategorifyinglenses[63,64],andwe
expectthatthismayproverelevanthere. Wealsoexpectthatatthispointthefibrationalstructure
of statistical games will again prove utile in order that losses may be correctly counted on any
overlaps. Fortunately,beingsimilarlystructured,sheavesandfibrationsarenaturalpartners,andso
weexpectthatasecondspatialextensionofthepresentworkwillbetoexploitthelatentgeometric
structureoffibrationsofstatisticalgames.
Inthiscontext,wemayalsoencounterconnectionstosheaf-theoreticapproachesto‘contextual-
ity’,inwhichanswerstoquestionsdependon(thetopologyof)howtheyareasked,andwhich
seemstolieattheheartofquantumnonlocality. Itisnotablethatlensesoriginatedindatabase
theory[34,99]andthatcontextualitycanalsobeobservedindatabasesystems[1,58],andsoat
thispoint,itmaybepossibletouncoverthemathematicaloriginsof‘quantum-like’psychological
effects [6, 49, 153], and relate them formally to other kinds of perceptual bistability that have
beeninterpretedinaBayesiancontext[144,170]. Sheavescomewithacohomologytheorythat
permits the quantification of the ‘disagreements’ that underlie such paradoxes [5, 45, 75], and
dynamicalsystemscanbedesignedaccordinglytominimizedisagreementsandthusseekconsensus
[123–125]. Wehopethatthesetoolswillsupplynewandmathematicallyenlighteningmodelsof
thesepsychologicalphenomena,whileatthesametimealsosuggestingnewconnectionstowork
onquantum-theoreticformulationsofthefree-energyframeworkitself[90,91].
Theadoptionofasheaf-theoreticframeworkinthiswaymayfurthermoreilluminateconnections
between computational neuroscience and machine learning. Graph neural networks [156, 157,
285],andtheirgeneralizationin‘geometric’deeplearning[44],areincreasinglyusedtoapplythe
techniquesofdeeplearningtoarbitrarilystructureddomains,and,asindicatedabove,recentwork
hasfoundsheavestosupplyausefullanguagefortheirstudy[31]. Inasimilarfashion,weexpect
connectionsheretothestructureofmessagepassingalgorithms[83,190,208,283,285](alsohinted
atbySergeant-Perthuis[229])andlessconventionalstructuredmachinelearningarchitectures
suchascapsulenetworks[223]. Finally,eachcategoryofsheavesisnaturallyatopos[177],and
286
hencecomeswithitsownrichinternallanguage,modellingdependenttypetheory(cf. §2.3.4).
8.1.2. Learningstructureandstructuredlearning
Having considered the incorporation of structured data into the process of inference, we can
considertheincorporationofstructureintotheprocessoflearning,andherewemakeanimportant
distinctionbetweenstructuredlearning andlearningstructure. Bytheformer,wemeanextending
theprocessoflearningtoastructuredsetting(suchasthesheaf-theoreticoneofthepreceding
section),whereasbythelatter,wemeanlearningtheunderlyingstructuresthemselves. Thislatter
processisalsoknownintheliteratureasstructurelearning [143,260,262],butinordertoavoid
ambiguity,weswaptheorderofthetwowords.
Theobservationattheendoftheprecedingsection,thateachcategoryofsheavesformsatopos,
is pertinent here, as dependent type theory formalizes a notion of logical ‘context’, containing
the “axioms that are valid in the present situation”, and determining which (non-tautological)
statementscanbederived. Inthecategoricalsemanticsofdependenttypetheory,thecontextis
witnessed by the object over which a slice category is defined, and so in some sense it defines
the“shapeoftheuniverse”. BytheGrothendieckconstruction,thereisacorrespondencebetween
sheavesandcertainbundles(objectsofslicecategories),andso(veryroughlyspeaking)wecan
thinkofstructuredinferenceandlearningastakingplaceinappropriateslicecategories.
Inthesamewaythatwemotivatedrandomdynamicalsystems(quabundles,§6.2.3)through“pa-
rameterizationbyanoisesource”,wecanthinkofbundlemorphismsasgeneralizedparameterized
maps.Theproblemoflearningstructurethenbecomesaproblemofgeneralizedparameter-learning,
andmuchlikethiscanbeformalizedbya‘reparameterization’intheParaconstruction(§3.2.1),
inthismoregeneralsettingitisformalizedbythe“generalizedreparameterization”ofbase-change
betweentopoi(cf. Remark4.2.29). Base-changesynthesizesnotionsofparalleltransport,allowing
ustotranslatespatially-defineddatacoherentlybetweenspaces—and,inparticular,alongchanges
ofstructure;recallourearlierremarkabouttheimportanceofparalleltransporttoabiophysically-
plausibleHebb-Laplacedoctrine(Remark7.3.17). Inthissettingtherefore,weexpectthatworkon
functoriallenses[63],aswellasworkonfunctorialdatamigration[236,242],mayproverelevant.
Atthesametime,weexpectthislineofenquirytoclarifytherelationshipsbetweenourformalism
ofapproximateinferenceandotherrelatedworkonthecategoricalfoundationsofcybernetics[51,
54],whichhavetypicallybeenstudiedinadifferentialratherthanprobabilisticsetting[74]. We
expecttheconnectiontobemadeviainformationgeometry[9,10,195],whereBayesianinference
canbeunderstoodbothusinggradientdescent[199]andasakindofparalleltransport[225].
287
8.1.3. Compositionalcognitivecartography
Naturalsystemssuchasanimalslearnthestructureoftheirenvironmentsastheyexplorethem. We
willcomebelow(§8.2.1)tothequestionofhowtoincorporateaction—andhenceexploration—into
the compositional framework that we have developed here, but meanwhile we note that the
topos-theoreticdevelopmentssketchedabovemayprovideasuitablesettinginwhichtounderstand
theneuralbasisfornavigation,andhelpexplainhowostensibly‘spatial’navigationprocessesand
circuitsareinvariablyinvolvedinmoreabstractproblemsolving[24,26,27,116,178].
Therearetwokeyobservationsunderlyingthisproposal. Firstly, atoposisnotonlyarichly
structuredcategoryofspaces(orspatialtypes),butitcanalsobeunderstoodasacategorifiedspace
itself[234]: inthiscontext,wecancalleachcategorifiedspacea‘little’topos,andthecategoryof
spacesitselfisthecorresponding‘big’topos;changesinspatialstructure—witnessedbybase-change
betweenlittletopoi—thuscorrespondtotrajectorieswithinthespacerepresentedbythebigtopos.
Secondly,underthefreeenergyprinciple,thereisacloserelationshipbetweenbeliefsaboutthe
geometryofanenvironmentandbeliefsaboutexpectedfuturetrajectoriesinthatenvironment
[148]: fundamentally,thisisalsotheideaunderlyingthe“successsorrepresentation”[78]ofthe
cognitivemap,whichsaysroughlythatthebrain’srepresentationofwhereitisisequivalentlya
representationofwhereitsoonexpectstobe[47,256,257]. Althoughtherehavebeenstudiesinthe
informalscientificliteratureattemptingtoconnectfree-energymodelsofnavigation,exploration,
andthecognitivemapwiththesuccessorrepresentation[185],andtoplacebothoftheseinless
overtlyspatialcontexts[47,205],therehasnotyetbeenacomprehensivemathematicaltreatment
explainingthestructuresthatunderliethisnexus.
Byplacingsuchamathematicaltreatmentinatopos-theoreticcontext, itmaybepossibleto
makesenseofthe“logicofspace”oftopoitoexplainwhyanimals’abstractproblem-solvingmakes
useoftheirabilitiesforspatialnavigation: inparticular,provingapropositionismathematically
analogoustofindingapathfrompremisetoconclusion. Moreover,inaspatialtopos,the“truth
values”arenolongersimplybinary,butencodewhere apropositionis(believedtobe)true;the
(sub)objectclassifierofaspatialtoposencodessomethinglikethe“internaluniverse”ofthattopos,
or“theuniverseaccordingtothesystem”.
Tobesuccessful,thismathematicaltreatmentshouldbeattentivetotheresultsandproposalsof
computationalandtheoreticalneuroscience,andsowenowturntooursecondkeyobservation:the
relationshipbetween(believed)geometryand(expected)dynamics. Thiswillrequireanextension
ofstatisticalgamesandapproximateinferencetodynamical generativemodels;untilthispoint,
288
our treatment has merely supplied inference (or ‘recognition’ [48]) dynamics to static models.
Throughthisextension,weshouldexpectaconnectiontootherworkondynamicalinference,such
asfiltering[105,147]andparticularlyitsemergingcompositionaltreatment[271,272].
Underthefree-energyprinciple,andsimilarlyunderthesuccessorrepresentation,theexpected
dynamicsisageodesicflow,whichisbygeodesydeterminedbybeliefsaboutthespatialgeometry.
Butthesebeliefsinturnarenotstatic: theydependonwhattheagentbelieveswillhappen[76,
186], and this has been suggested as an explanation for the ‘predictive’ nature of the cognitive
map[148]. Thecognitivemaphasitscentrallocusinthehippocampus[88,193,198],whichwe
maythereforeunderstandasrepresentingthebasespaceoverwhichthebigtoposissliced;and
since changes-of-plan seem therefore to induce changes-of-base, we might see the ‘functional’
connectivityofthebrain[245]aswitnessingthismathematicalstructure.
Because the internal universe of the topos represented by the cognitive map is inherently
context-dependent,itseemstofitnaturallywiththesubjectivistmetaphysicsimpliedbythefree
energyframework—thattheuniverseasexperiencedbyanagentisaconstructionofthatagent’s
internalmodel,asupdatedbyapproximateinference—andthustoprovideanaturalsettingforthe
mathematicalstudyofphenomenology. Moreover,ascategoriesofsheaves,agents’internaltopoi
encodetheconsensusformedbythedistributedcircuitsandsensorsthatconstitutetheirbeliefs,
andthispointsawaytowardsunderstandinghowsocietiesofagentsareabletoinhabitshared
spacesaboutwhichtheyformaconsensusbetweenthemselves: themathematicsofthisshared
universeshouldbelittledifferentfromthemathematicsofasingleagent’sinternaluniverse.
Suchmulti-agentadaptivesystemshavebeenstudiedinthecontextofreinforcementlearning(of
whichmorebelow),butthispotentialfortheformationof‘nested’systemswithshareduniverses
impliedbyconsensusisnottheonlyconnectionbetweencognitivecartographyandreinforcement
learning,asitisinreinforcementlearningthatthesuccessorrepresentationoriginates.Wetherefore
hopethatthislineofenquirymayilluminatetherelationshipbetweenreinforcementlearningand
compositionalactiveinference,tothebasisofwhichwenowturn.
8.2. Societies of systems
Adaptive agents being necessarily in interaction with an external environment, we saw in the
previoussectionhowconsiderationofthecompositionalstructureofagents’internalmapsoftheir
worldseasilyleadstotheconsiderationofsocietiesofagents. However,inorderforustostudy
289
these,wefirstneedtomakethemorebasicstepofincorporatingactionintothecompositional
framework: acollectionofpurelypassiveagentsisnosociety.
8.2.1. Activeinference
The doctrines of approximate inference introduced in this thesis are inherently perceptual. As
we described in Remark 4.0.1, the forwards channel of a statistical game points “towards the
environment”,predictingtheexpectedincomingsense-data,whereasthebackwardschannelpoints
fromtheenvironmentintotheagent,terminatingintheagent’smostcausallyabstractbeliefs. In
othercontemporaryworkoncategoricalcybernetics,theorientationappearsdifferent:theforwards
channelofanopen(economic)game,forinstance,pointsalongthedirectionofinteractioninthe
environment,inthedirectionofcausality,fromobservationstoactions[36,119];thereisnoroom
forpredictionanditsinversion,andthetwokindsofgameseemsomehowperpendicular.
Inresolutionofthisapparentdisagreement,wecanobservethatanopeneconomicgamedoes
haveaperpendiculardirection: asecond3 dimensioninhabitedbythestrategies. Thatistosay,an
openeconomicgameisalensexternallyparameterizedbystrategies,afunctionfromthelatter
totheformer,andthereforeformallymuchlikeourcilia(§6.3). Thisresemblencebecomeseven
closer whenone considers therecent‘diegetic’formulation of opengames, in which strategies
themselvescanbeupdatedusingabackwardsmapfromthearenaofthegamebackintostrategies
(orrather,strategyupdates).
Thissuggestsonewayinwhichwecanincorporateactionandtherebyshapetheframework
ofthisthesisintoaframeworkforactiveinference: theforwardschannelshouldpredictnotonly
sense-dataincomingfromtheenvironment,butalsotheactionstobetakenbytheagent. Indeed
thismatchestheusualinformalpresentationofactiveinference,whichadoptsachannelofthe
formXÑ‚ S bA,whereS isthespaceofsense-data,Athespaceofpossibleactions,andX the
‘latent’space.
Yetatthispointtheformalsimilaritybetweencompositionalactiveinferenceandcompositional
gametheoryagainbeginstorecede,asachannelXÑ‚ S bAismorelikea“stochasticspan”than
an open economic game’s player model Σ Ñ rS,As. Moreover, we expect our active inference
systems to have a richer variety of patterns of interaction, being embodied in a world—in part,
this motivated our adoption of polynomial functors for structuring interaction. We therefore
expectthecompositionaltheoryofactiveinferencetohaveforwardschannelsratheroftheform
3Orthird,ifoneremembersthemonoidalstructure.
290
ř
XÑ‚ Sras,sothatanagent’ssensoriumdependsontheconfiguration(or‘action’)thatithas
a:A
chosen.
Thiswastheapproachwesketchedinourearlierwork-in-progressonPolynomialLife [252],
where we suggested that polynomial functors supply a formalization of the notion of “Markov
blanket”usedintheinformalactiveinferenceliteraturetocharacterizetheinteractionboundaries
ofadaptivesystems[102,158,203](aformalizationthatissituatedatausefulleveloftechnical
flexibility,beingneitherasabstractastheverygeneralnotionofinterfaceadoptedbycategorical
systemstheory[192],norasconcreteassimpleproductsofspaces). Inthisway,webelievethata
fruitfuldirectioninwhichtopursueacompositionaltheoryofactiveinferenceis,likeourtheory
ofopendynamicalsystems,asaPoly-algebraofstatisticalgames. Fortunately,althoughthetypes
provesomewhatdifferent,thestructuralresemblencebetweenactiveinferenceandeconomicgames
ismaintained: inbothcases, onehascategoriesoflensesintothearenaofinteraction, indexed
by a category of interfaces, and thus in philosophical (and thus we expect also mathematical)
concordancewithMyers’double-categoricalviewofsystemstheory[192].
Onceagain,thislineofenquirynaturallyleadsontotheconsiderationofmulti-agentsystems.
Butbeforewecometothat,thereremainimportantquestionsaboutsingle-agentsystems,andthe
connectionbetweensingle-agentactiveinferenceandthecousinofeconomicgames,reinforcement
learning.
8.2.2. Whatisthetypeofaplan?
Eachactiveinferencesystemhasaninternal‘latent’statespaceequipped(byitsgenerativemodel)
with a prior distribution, which represents the systems’s initial beliefs about the likelihood of
thosestates. Aswehaveseen,thesystemcanperceive,changingthatdistributionbettertomatch
incomingsensedata. Andaswehopetosee,itshouldalsobeabletoact,affectingitsenvironment
sothatfuturestatesbettermatchitsinitialbeliefs. Perceptionandactionarethusingeneralthe
twodualwaysinwhichasystemcanminimizeitsfreeenergy,akintothetwodegreesoffreedom
availableinafreeenergygame.
But a system that acts must necessarily be motivated towards some goal, even if that goal is
simply“stayalive”or“performactiona”,andeventhoughthisgoalmaybeadjustedbythesystem’s
perceptions. Inordertorealizeitsgoal,whateveritmaybe,thesystemmustenactaplan,however
trivial—andtheinformalliteratureonactiveinferenceencodestheplanintothesystem’slatent
prior. Whenitcomestostaticmodels,thepriormaybesimplya(static)distributionoverthestate
spaceitself;butinthedynamicalcase,itistypicallyadistributionovertrajectoriesofstates.
291
Suchadistributionisoften[76,148]takentoencodelikelihoodsofhypotheticalcoursesofaction,
whichonemightcallapolicy 4: thesystemthenperceivesandactsinordertoimplementitspolicy.
Buttheconstructionofthispolicymayinvolvealotofdata,suchasthespecificationofgoalstates
andtheaccumulationofthe“expectedfreeenergy”oftrajectoriesinthecontextofthosegoals,
andsoitseemsunnecessarilycrudetohideallofthisdatainsideasingleundifferentiatedchoiceof
priordistribution.
Thispromptsustoask,whatistheformofthisdata,andhowcanweincorporateitintothe
compositionalframework? Inotherwords,whatisthetypeofaplan? Theseseemtoustobekey
questionsforfuturework.
8.2.3. Reinforcementlearning,opengames,andecosystems
ThereisknowntobeacloserelationshipbetweenactiveinferenceinMarkovdecisionproblems
(MDPs)andreinforcementlearning[73],anditisthroughthisrelationshipthatoneseesparticularly
clearlythestrangenessofencodingallthedataofanagent’spolicyinasingle‘prior’state. This
relationshipisseeminglynotsuperficial,astherearehintsofadeepstructuralconnection.
First,recallthatthestandardalgorithmforobtainingaBellman-optimalpolicyforanMDPis
backwardinduction(otherwiseknownasdynamicprogramming)[214,284]5. Itisnowknownthat
backwardinductionisstructuredaccordingasimilarbidirectionalpattern(theoptic pattern)to
thatofbothBayesianinferenceandreversedifferentiation[128],andthatMDPsthemselvesfitinto
theassociatedgeneralframeworkofopengames[36](whicharegovernedbythesamepattern).
Second,intheinformalactiveinferenceapproachtoMDPs,thesysteminquestioncounterfactually
evaluatespoliciesusingabackward-induction-likeprocess,accumulatingfreeenergiesinorderto
scorethem[73]. Itisthisprocessthatresultsinthepriordiscussedabove,whichisthenupdated
by the agent’s inference process. Future work will need to untangle this knot of interrelated
bidirectional processes; and as usual in categorical modelling, this means first writing them all
downprecisely. Wehopethat,havingdoneso,wewillseehowthewholepictureemerges,and
how it relates to the developing geometric (or ‘diegetic’) framework in categorical cybernetics
[51](possiblyinvolvingthefurtherdevelopmentofournotionof‘cilia’from§6.3). Inparticular,
sincethefreeenergyprincipleunderlyingactiveinferenceassertsacertaininformaluniversality
(onwhichmorein§8.3.1),wemightalsohopethatthesatisfactorydevelopmentofcompositional
4Inthelanguageofpolynomialfunctors,thisseemstobesomethinglikeadistributionoverthecofreecomonadonthe
system’spolynomialinterface.
5Alsosee[29,89,106,128,261]forotherpresentations.
292
activeinferencemightexhibitauniversalproperty: thatanyotherdoctrineofcyberneticsystems
factorsuniquelythroughit.
The story of these connections will initially be told from the perspective of a single agent,
as backward induction only considers how to find a single policy for a single MDP; although
thispolicymayinvolvemultipleagents, theimpliedglobalsearchentailsacommoncontroller:
theproceduredoesn’tconsiderthefactorisationoftheagents. Butcastingthisaccountintothe
emergingframeworkofcompositionalactiveinferencewillpointtowardsabridgetomulti-agent
reinforcementlearning. Forexample,multi-agentRLoftenstudiestheemergenceofcollaboration,
andwemightexpecttoseethisrepresentedintheformalstructure,therebyunderstandinghowto
incorporatethefactorisationofagentsintothecompositionalframeworkforbackwardinduction
(whichinturnmaybehelpfulfordesigningcollaborative‘edge’AIsystems).
Theresultinggeneralaccountofmulti-agentintelligencewillencompassbothreinforcement
learningandactiveinference,allowingustounderstandtheirrelativestrengthsanddifferences.
Oneseemingdifference(atthisearlystage,andfollowingourthinkingabove)isthatcompositional
active inference envisages the latent state spaces of agents as their “internal universes”, which
comealongwithsufficientstructurethatwemightconsiderthemasUmwelten(i.e.,theirsubjective
worlds,inthesenseofbiosemiotics;see§8.3.2below).Consequently,weshouldbeabletostudyhow
agentsmightcometoconsensus,therebyresolvingtheirdisagreements. Andbecauseagentsare
embodiedinasharedworldwithinwhichtheyact,thisprocessmightinvolveplanningcooperation,
atwhichpointtheteleologicalstructureofcompositionalgametheorymaybecomeimportant,as
cooperatingagentswillhavetobetonspatiotemporallydistributedactions. Wehopethereforethat
onedistaloutcomeofthisworkwillbeanewandbeneficialunderstandingofcorporateactivity.
Below,in§8.3,wewilldiscusshowactiveinferenceandthefreeenergyprincipleaimnotonly
tobetheoriesofbrainsorotherprominentintelligentsystems,butratheruniversaltheoriesofall
adaptivethings.Consequently,theircompositionaltreatmentshouldextendinthe‘multi-agent’case
notjusttocorporateactivity,buttoecosystemsmorebroadly. And,followingthemulticategorical
algebralatentthroughoutthisthesis,itwillundoubtedlyprovenatural,oncewehaveconsidereda
singlelevelofnestingofsystemsintoecosystems,toletthehierarchycontinuetoinfinity,producing
afractal-likestructure. Atthispoint,weshouldexpectoncemoretomakecontactwithtopicssuch
ashighercategoriesandtypetheory,particularlyinoperadicoropetopic(i.e.,‘directed’)forms;
syntheticapproachestomathematicalphysics;anditeratedparameterizationincategoricalsystems
theory.
293
Italmostgoeswithoutsayingthatweshouldexpectanyframeworkresultingfromthisworkto
captureexistingmodelsofcollectiveactiveinference,suchasrecentworkonspinglasses[129].
8.3. The mathematics of life
We move on to consider the relationships between compositional active inference and the
contemporary mathematics of life. We hope that compositional active inference may supply
partofthestoryofamoderntheoryofautopoiesis,theabilityforlifetorecreateitself[274].
8.3.1. Bayesianmechanicsandthefreeenergyprinciple
Recently,ithasbeensuggestedinvariousvenues[102,204]thatthefreeenergyframeworkprovides
a‘universal’waytounderstandthebehaviourofadaptivesystems,inthesensethat,givenarandom
dynamicalsystem,itmaybepossibletowritedownagenerativemodelsuchthatthedynamics
of the system can be modeled as performing inference on this model. In the language of the
conjecturedcompositionalframeworkforactiveinference,wemaybeabletodescribeacanonical
statisticalgamethateachgivenrandomdynamicalsystemcanbeseenasplaying.
If this is true, we should be able to express this canonicity precisely: in particular, it should
correspondtoauniversalproperty.Sinceapproximateinferencedoctrinesalreadygivesusfunctorial
waystoturnstatisticalgamesintodynamicalsystems,thissuggestsweshouldseekfunctorsthat
associatetoeachrandomdynamicalsystemastatisticalgame;andweshouldexpectthesefunctors
tobeadjoint(asmorphismsofcategoriesindexedbythesystems’interfaces). Thedesireduniversal
property would then be expressed by the adjunction. (Notably, adjunctions are at the heart of
recentsyntheticapproachestomathematicalphysics[228].) Thiswouldconstituteanimportant
mathematicalsteptoestablishingtheuniversalityofthefreeenergyprinciple,ortoestablishing
theconditionsthatmustbesatisfiedbyanysatisfactorysuccessor.
Bayesianmechanics promisestobuilduponthenascentunderstandingofrandomdynamicsvia
inference [224] to supply a new theory of mechanics for statistical systems [215]. The present
formulationofBayesianmechanicsisconstructedusingmathematicaltoolsfromphysics,butnot
(yet)thekindsofcompositionaltoolpromotedinthisthesisandfurtherdescribedabove. Weexpect
thatdevelopmentsalongthelinessketchedherewillunifytheon-goingdevelopmentofBayesian
mechanics(andtheresultingunderstandingofnon-equilibriumsystems)withthenewsynthetic
understandingofmathematicalphysics. Bycastingalldynamicsasabstractinference,weshould
294
alsoexpectthislineofenquirytobegintoquantifythepersistenceofthingsandimbuemuchof
physicswithanélanvital.
8.3.2. Biosemiotics
Itisincreasinglyacknowledgedthatbiologicalsystemsarecharacterizednotonlybyinformation-
processing,butbycommunication[20]: anoftenoverlookedfactabout‘information’inthestrict
mathematicalsenseisthatitisonlymeaningfulincontext.IntheoriginalNyquist-Hartley-Shannon
conceptionofinformation,thiscontextisthecommunicationofapredefinedmessageoveranoisy
channel[126,197,230];butmoregenerally,wemightthinkofthiscontextassimply“aquestion”,in
whichcaseitiseasytoseethatinformationansweringonequestionmaynotbeusefulinanswering
another;or,inamorecomputationalsetting,wecanseethatthebitsofanencryptedsignalare
onlyusefulinrevealingthemessageifonehasthedecryptionkey.
Still,oneoftenencountersdescriptionsofsignalsascontainingnbitsofinformation,withouta
clearspecificationofaboutwhat. Mathematically,theconfusionarisesbecauseinformationtheory
is framed by classical probability, and the assumed context is always the problem of trying to
communicateaprobabilitydistributionoverapre-definedspaceX;andoncethespaceisfixed,the
onlyquestionthatcanbeaskedis“whatisthedistribution?” (Mathematically,thisistosaythatin
theMarkovcategoryofclassicalstochasticchannels,therearenonon-trivialeffectsorcostates.)
Yet, in the shared universe that we inhabit, there are more questions than this: in quantum
theory,forinstance,onecanaskmanyquestionsofthestateofasystem,byprojectingthestate
ontothesubspacerepresentingone’squestion. (Theseprojectionsarethenon-trivialeffectsor
costatesofquantumprobability.) Thisactofprojectionisanactofinterpretationofthemessage
encodedbythestateathand.
Theemerging‘biosemiotic’reconceptualizationoflifeexplicitlyacknowledgestheimportance
and universality of communication in context [20], proposing that in any such situation the
interpretingsystemnecessarilyhasaninternalrepresentationoftheexternalworld(itsUmwelt)
whichisupdatedbyinterpretingincomingsignals. Wecaninprinciplereconstructtheexternal
world by understanding it as “that which a collection of systems agrees about”: perhaps, then,
the shared universe (as determined topos-theoretically) of a fusion of active inference agents
is a good model of this ‘semiosphere’. It seems therefore that the mathematics resulting from
ourworkoninternaluniversesandtheirinteractions—and,morebroadly,manyoftheformal
ingredients of compositional active inference — is well aligned with the informal structures of
biosemiotics,andsoitmaybedesirabletore-expressbiosemioticsaccordingly. Indoingso,perhaps
295
the mathematics for a modern Bayesian subjectivist metaphysics will be found6: for instance,
by expressing communication and its phenomenology as a geometric morphism (a generalized
base-change)betweenagents’internaluniverses. Morepragmatically,perhapswewillbeableto
saypreciselywhensomeobjectmayactasasymbol,andhowsystemsmay(learnto)manipulate
suchsymbols.
8.4. Fundamental theory
Futureworkconnectedtothisthesisneednotonlybeinapplications;anumberofpurelytheoretical
questionsraisethemselves,too.
8.4.1. Geometricmethodsfor(structured)beliefupdating
Themathematicsof‘belief’isinlargepartaboutreplacingdefinitepointswith‘fuzzier’distributions
overthem. Independenttypetheory,wereplacepointswith‘terms’(non-dependenttermsare
exactlypoints): soatypetheorywithbeliefshouldsomehowencompass“fuzzyterms”. Justaswe
canreplacepointswithdistributions,wecanreplacedependentpointswithdependentdistributions.
However,thestandardreplacement(movingfromacategoryoffunctionstoacategoryofstochastic
channels)obscuressomeofthe‘universal’categoricalstructurethatunderpinstherulesoftype
theory. Thisstandardreplacementalsomissessomethingelse: whileitdoesallowforfuzzyterms,
it omits a model of fuzzy types; and we might well want to express beliefs about things whose
identity we are not quite sure. (This omission also seems to be related to the loss of universal
structure.)
Thereseemtobeacoupleofrelatedresolutionstothispuzzle. Thefirstistonoticethatreplacing
pointsbydistributionsyieldsanotherspace: thespaceofdistributionsovertheoriginalspace;this
isakintothemoveindynamicsfromworkingwiththerandommotionofstatestoworkingwith
thedeterministicmotionofthedistributionoverstates. Thisspaceofdistributionshasaparticular
geometry(itsinformationgeometry),andhenceweshouldexpectcorrespondingflavoursoftopos
andtypetheory. Aswehaveindicatedabove,thereisamoveinfundamentalmathematicalphysics
(cf. Schreiber [228]) to work ‘synthetically’, expressing concepts using the universal structures
of higher topoi. This has proven particularly fruitful in the context of differential systems, but
it is interesting that stochastic and differential structures bear a number of similarities7: what
6PerhapsgettingtothestructuralheartofthetheoryknownasQBism[112,113].
7Bothconditionalprobabilityanddifferentialcalculusexhibit“chainrules”ofsimilartypes,whichgiverisetobackwards
actionsthatcomposeviathelensrule:intheformercase,Bayesianinversion;inthelatter,reversedifferentiation.
Categories that admit a differentiation operation have begun to be axiomatized (as differential categories [30]
296
are we to make of this? Does Bayesian inversion induce a canonical geometric morphism, by
whichstructuredmodelsmaybecoherentlyupdated? Wehavealreadyindicatedabovesignsofa
relationshipbetweeninferenceandparalleltransport;itseemsthatitmayatleastbefruitfulto
consider‘metric’topoi,appropriatelyenriched.
Thesecondresolutionistoworkwithtopoiasweworkwithrandomdynamicalsystems,by
noticingthatrandomnessisoftenlike“anuncertainparameterization”. Byparameterizingatopos
withacategoryofnoisesources,wemayobtainanotionof“stochastictopos”inwhichthestandard
operationsofdependenttypetheoryareavailable,butwhereeachtypeandtermmaydependon
therealizationofthenoisesource,therebygivingusnotionsoffuzzytermandfuzzytype. The
mathematicsofsuchuncertainlyparameterizedtopoiisasyetundeveloped,althoughweexpect
thattheyshouldbeararelationshiptothe“topoiofbeliefs”oftheforegoingfirstresolutionsimilar
totherelationshipofFokker-Plancktorandomdynamicalsystems.
Finally,wenotethathighertopoibehaveabstractlysomewhatlikevectorspaces(withsheaveslike
categorifiedfunctionals). Sincedistributionsarethemselveslikevectors,perhapsthisobservation
isafirststeptowardsrelatingtheresolutions.
8.4.2. Dynamics
Chapter6hassuppliedthebeginningsofacompositionalcoalgebraictheoryforopenstochastic
and random dynamical systems in general time, and we hope that this theory could provide a
homeforamodernaccountofnon-equilibriumsystems,withthecategoryofpolynomialfunctors
supplying a satisfactory account of these systems’ interfaces (i.e., the boundaries across which
informationflows,alongwhichtheycompose,andthroughwhichtheyinteract).
Inthiscontext,andinparalleltotheabstractquestionsabove,therearesimilarquestionstobe
askedspecificallyofdynamicalsystems. Forinstance,whatisthepreciserelationshipbetween
thecategoryofMarkovprocessesonaninterface,andthecategoryofrandomdynamicalsystems
onthatinterface? Weknowthatcategoriesofdeterministicdiscrete-timepolynomialcoalgebras
aretopoi[240],sodoesthesameholdingeneraltime? Towhatextentisthelogicofoursystems
relatedtocoalgebraiclogics[72,138,162,207,275]?
Besidesthese‘parallel’questions,thereareanumberofmoretechnicalones. Forinstance,our
currentdefinitionof“Markovprocessonapolynomialinterface”issomewhatinelegant,andwe
andreverse-derivativecategories[66]),andcategorieswhosemorphismsbehavelikestochasticchannelsarealso
presentlybeingaxiomatized(intheframeworkofMarkovcategories[109]),buttheconnectionsbetweenthese
variousformalismsarenotyetclear.Thesimilarstructuresindicatethatthetwofamiliesofaxiomatisationmay
haveacommongeneralization.
297
seek to simplify it. Similarly, we believe that there is a better definition of “random dynamical
system on a polynomial interface” that may be obtained by a (different) generalization of the
categoryofpolynomialfunctors,usingrandomvariables. Andweknowthatatopologyforthe
cofreecomonoidonaninterfacecanbegeneratedbythecorrespondingfreemonoid,whichmay
berelevantforunderstandingthetopologicalstructureofopensystems. Animportantsetofopen
questions about open random dynamical systems in this framework comes from attempting to
importnotionsaboutrandomsystemsfromtheclassical‘closed’setting: fundamentally,weask,
doesthisframeworkindeedsupplyasatisfactorysettinginwhichtounderstandstochasticsystems
awayfromequilibrium?
8.4.3. Computation
The early 21st century understanding of biological systems as information-processing involves
treating them as computational, but remarkably lacks a precise concept of what it means for a
systemtocompute,otherthaninthecontextofartificialmachines. Tous,itseemsthatacrisper
understandingofcomputationingeneralmightbeginwiththesloganthat“computationisdynamics
plussemantics”,whichisphilosophicallyalignedwiththesemioticunderstandingofbiological
information-processingsketchedabove: forexample,weknowthatattractornetworksinthebrain
caninformallybeunderstoodascomputational[11],buttheseare‘continuous’systemsforwhich
wedonotyethaveagoodcorrespondingconceptofalgorithm(anditisuponalgorithmsthatour
currentunderstandingisbuilt). Butwhatmoreisanalgorithmthanadescriptionofadiscrete-time
open dynamical system? The quality that makes an algorithm computational is that its states
oritsoutputscorrespondtosomequantityofinterest,andthatitreachesafixedpoint(ithalts)
atthetargetquantitywhenthecomputationiscomplete. Ifthisintuitioniscorrect,thenanew
understandingofcomputationmayfollowthesemioticunderstandingofinformation-processing
thatweproposeabove: perhapswecouldsaymorepreciselythatcomputationisthedynamicsof
semiosis? Thetimeisrightforsuchareconceptualization,ashuman-madesystemsincreasingly
moveawayfromvonNeumannarchitecturestowardsmorebiosimilarones(suchasmemristors,
opticalprocessors,neuromorphictechnology,graphprocessors,orevenmany-coreandmesh-based
evolutionsofclassicalprocessors).
298
A. Auxiliary material
A.1. From monads to multicategories
The assignment of domain and codomain to the morphisms of a small category C constitutes a
pair of functions C Ñ C , which we can write as a span, C Ð c Ý o Ý d C Ý d Ý om Ñ C . Similarly, the
1 0 0 1 0
assignmentofdomainandcodomaintothemorphismsofamulticategoryMconstitutesaspan
M Ð c Ý o Ý d M Ý d Ý om Ñ ListpM q. ThisobservationwasusedbyLeinster[168]toconstructageneral
0 1 0
frameworkforconstructingmulticategories,replacingListwithanarbitrary‘Cartesian’monadT,
whichopensthewaytoaconnectionbetweenmonadalgebrasandmulticategoryalgebras. Inthis
section,weexplorethisconnection,startingbydefiningcategoriesofspans.
DefinitionA.1.1. SupposeAandB aretwoobjectsinacategoryC. WewillwriteaspanfromA
toB aspX,xq : A Ð x ÝAÝ X Ý x ÝÑB B,andcallX theapex ofthespanandx ,x itslegsorprojections.
A B
The category of spans from A to B, denoted SpanpA,Bq has spans pX,xq as objects, and the
morphismsf : pX,xq Ñ pX1,x1qaremorphismsf : X Ñ X1 inC thatcommutewiththespans,
asinthefollowingdiagram:
X
xA xB
A f B
x1 x1
A B
X1
WecantreatthecategoriesSpanpA,Bqasthehomcategoriesofabicategory.
DefinitionA.1.2. SupposeC isacategorywithallpullbacks. ThebicategoryofspansinC,denoted
Span,hasforobjectstheobjectsofC,andforhom-categoriesthecategoriesSpanpA,Bqofspans
from A to B. Given spans pX,xq : A Ñ B and pY,yq : B Ñ C, their horizontal composite
299
pY,yq˝pX,xq : A Ñ C isthepullbackspandefinedby
X ˆ Y
B
proj X { proj Y
.
X Y
xA xB yB yC
A B C
If pX1,x1q : A Ñ B and pY1,y1q : B Ñ C are also spans with f : pX,xq ñ pX1,x1q and
g : pY,yq ñ pY1,y1qverticalmorphisms,thehorizontalcompositeoff andg isalsodefinedby
pullback as f ˆ g : pY,yq˝pX,xq ñ pY1,y1q˝pX1,x1q. The identity span on an object A is
B
pA,idq : A ùù A ùù A.
If the ambient category C is not clear from the context, we will write Span to denote the
C
bicategoryofspansinC.
RemarkA.1.3. NotethatSpanreallyisabicategoryratherthana2-category:sincethehorizontal
compositionofspansisdefinedbypullback,itisonlydefineduptoisomorphism. Consequently,
thecompositionofspanscaningeneralonlybeassociativeandunitaluptoisomorphism,rather
thanthestrictequalityrequiredbya2-category.
Now,recallthat‘monad’isanothernamefor“monoidinabicategory”,wherethebicategoryhas
sofarbeentakentobeCat: butitneednotbe.
Remark A.1.4. Since CC is the endomorphism monoid on C in the bicategory Cat, we can
generalizetheprecedingdefinitionofmonadtoanybicategoryB: amonadinabicategory B is
simply a monoid in B, as defined in Remark 3.4.9. That is, a monad in B is a monoid object in
` ˘
themonoidalcategory Bpb,bq,˝,id forsomechoiceof0-cellb : B,where˝denoteshorizontal
b
composition.Explicitly,amonadpt,µ,ηqinBisa1-cellt : b Ñ b,amultiplication2-cellµ : t˝t ñ t,
andaunit2-cellη : id ñ t,suchthattheassociativityandunitalitydiagramscommuteinBpb,bq:
b
ttt
tµ
tt t
ηt
tt
tη
t
and
µt µ µ
µ
tt t t
Withthismoregeneralnotionofmonad,weobtainanothermonadicdefinitionof“smallcategory”,
toaddtotheexplicitDefinition2.1.2andthemonad-algebraicExample3.4.19.
PropositionA.1.5. SmallcategoriesaremonadsinSpan .
Set
300
Proof. AmonadinSpan isachoiceofobjectC andmonoidinSpan pC ,C q.Suchamonoid
Set 0 Set 0 0
isaspanofsetsC : C Ð c Ý o Ý d C Ý d Ý om Ñ C alongwithfunctions‚ : C ˆ C Ñ C andid : C Ñ C .
0 1 0 1 C0 1 1 0 1
ThesetC ˆ C istheapexofthepullbackspanC ˝C asin
1 C0 1
C ˆ C
1 C0 1
{
C C
1 1
cod dom cod dom
C C C
0 0 0
sothat‚andidmakethefollowingdiagramscommute:
C ˆ C
1 C0 1
C
0
and
C 1 ‚ C 1 id
cod dom
C C C
0 1 0
C C C cod dom
0 1 0
cod dom
Thismeansthatcodpg‚fq “ codpgqanddompg‚fq “ dompfq,andcodpid q “ dompid q “ x.
x x
ItiseasytocheckthatpC,‚,idqthereforeconstitutesthedataofasmallcategory;moreover,the
functions‚andidmustsatisfythemonoidaxiomsofassociativityand(rightandleft)unitality,
whichcorresponddirectlytothecategoricalaxiomsofassociativityandunitality.
Asweindicatedattheopeningofthissection,bygeneralizingtoacategoryof‘spans’ofthe
form A Ð X Ñ TB, we can use the preceding result to produce generalized multicategories
whosemorphismshavedomains“intheshapeofT”. Sincethehorizontalcompositionofspansis
bypullback,weneedanextraconditiononthemonadT toensurethatpullbacksofT-spansare
well-defined. Thisconditionisknownas‘Cartesianness’.
Definition A.1.6. A Cartesian natural transformation between functors F and G is a natural
transformationα : F ñ Gforwhicheverynaturalitysquareisapullback:
Fa
αa
Ga
{
Ff Gf
Fb Gb
α
b
A Cartesian monad is a monad pT : C Ñ C,µ,ηq such that C has all pullbacks, T preserves
thesepullbacks(sendingpullbacksquarestopullbacksquares),andµandη areCartesiannatural
transformations.
301
DefinitionA.1.7. SupposeT isamonadonC. AT-spanfromAtoB isaspanfromAtoTB in
C. Thecategoryof T-spansfromAtoB,denotedSpan pA,BqhasT-spansasobjects,andthe
T
morphismsf : pX,xq Ñ pX1,x1qaremorphismsf : X Ñ X1 inC thatcommutewiththespans,
asinthediagram
X
xA xB
.
A f TB
x1 x1
A B
X1
Definition A.1.8. Suppose pT,µ,ηq is a Cartesian monad on C. The bicategory of T-spans
in C, denoted Span , has for objects the objects of C, and for hom-categories the categories
T
Span pA,BqofT-spansfromAtoB. GivenT-spanspX,xq : A Ñ B andpY,yq : B Ñ C,their
T
horizontalcompositepY,yq˝pX,xq : A Ñ C istheouterT-spaninthediagram
X ˆ TY
TB
proj X { proj TY
X TY
xA xB TyB TyC .
A TB TTC
µC
TC
If pX1,x1q : A Ñ B and pY1,y1q : B Ñ C are also T-spans with f : pX,xq ñ pX1,x1q and
g : pY,yq ñ pY1,y1q vertical morphisms, the horizontal composite of f and g is defined as
f ˆ Tg accordingly. TheidentityspanonanobjectAisA Ð id ÝAÝ A Ý η ÑA TA.
TB
Withthesenotionstohand,thegeneralconceptofT-multicategoryiseasytodefine.
Definition A.1.9 (Leinster [168, Def. 4.2.2]). Suppose T is a Cartesian monad on C. A T-
multicategory isamonadinthebicategorySpan ofT-spans.
T
Andofcoursewecanrecoverourearlierexamplesofcategoryshapesaccordingly.
Example A.1.10. The identity monad on a category with all pullbacks is trivially a Cartesian
monad. Therefore,takingT “ id tobetheidentitymonadonSet,weimmediatelyseethatan
Set
id -multicategoryisasmallcategory.
Set
ExampleA.1.11(Leinster[168,Examples4.1.4and4.2.7]). ThefreemonoidmonadList : Set Ñ
Set is Cartesian. Unpacking the definitions, we find that a List-multicategory is precisely a
multicategoryasinDefinition3.3.1.
302
Atthispoint,wecansketchhowmulticategoryalgebrascorrespondtomonadalgebras,referring
thereadertoLeinster[168,§4.3]forthedetails. Thebasicpictureisthat,ifT : C Ñ C isaCartesian
monadandMisaT-multicategory, thenonecanobtainfunctoriallyamonadT ontheslice
M
C{M ofC overtheobjectM ofM-objects. Thealgebrasα : T pX,pq Ñ pX,pqofthismonad
0 0 M
aremorphismsα : T X Ñ X asinthecommutingdiagram
M
T X α X
M
{
TX M p
1
Tp dom cod
TM M
0 0
where T pX,pq is defined as the bundle T X Ñ M on the right leg of the pullback square.
M M 0
Togetasenseforhowthisworks,considerthecasewhereT “ id : aT-multicategoryisthen
Set
simplyasmallcategoryC,andasLeinster[168,Example4.3.2]shows,itsalgebrasarefunctors
C Ñ Set.
303
B. Bibliography
[1] SamsonAbramskyandGiovanniCarù.“Non-Locality,ContextualityandValuationAlgebras:
A General Theory of Disagreement”. In: Philosophical Transactions of the Royal Society
A: Mathematical, Physical and Engineering Sciences 377.2157 (09/2019), p. 20190036. doi:
10.1098/rsta.2019.0036.
[2] SamsonAbramskyandBobCoecke.“ACategoricalSemanticsofQuantumProtocols”.In:
LogicinComputerScience,2004.Proceedingsofthe19thAnnualIEEESymposiumOn.IEEE.
2004,pp.415–425.
[3] Samson Abramsky and Viktor Winschel. “Coalgebraic Analysis of Subgame-perfect
Equilibria in Infinite Games without Discounting”. 10/16/2012. doi: 10 . 1017 /
S0960129515000365.arXiv:1210.4537[cs.GT].
[4] SamsonAbramskyetal.“CategoricalMethodsattheCrossroads(DagstuhlPerspectives
Workshop14182)”.In:(2014).Incollab.withMarcHerbstritt,15pages.doi:10.4230/
DAGREP.4.4.49.url:http://drops.dagstuhl.de/opus/volltexte/
2014/4618/(visitedon12/23/2022).
[5] SamsonAbramskyetal.“Contextuality,CohomologyandParadox”.In:24thEACSLAnnual
Conference on Computer Science Logic (CSL 2015), Leibniz International Proceedings in
Informatics (LIPIcs), 41: 211-228, 2015 (02/10/2015). doi: 10.4230/LIPIcs.CSL.
2015.211.arXiv:1502.03097[quant-ph].
[6] Diederik Aerts et al. “Quantum Cognition Beyond Hilbert Space: Fundamentals and
Applications”. In: Lecture Notes in Computer Science (2017), pp. 81–98. issn: 1611-3349.
doi:10.1007/978-3-319-52289-0_7.
[7] Danel Ahman and Tarmo Uustalu. “Directed Containers as Categories”. In: EPTCS 207,
2016, pp. 89-98 (04/05/2016). doi: 10.4204/EPTCS.207.5. arXiv: 1604.01187
[cs.LO].
[8] Thosten Altenkirch, James Chapman, and Tarmo Uustalu. “Monads Need Not Be Endo-
functors”.In:LogicalMethodsinComputerScienceVolume11,Issue1(03/06/2015),p.928.
issn: 1860-5974. doi: 10.2168/LMCS-11(1:3)2015. url: https://lmcs.
episciences.org/928(visitedon10/16/2023).
[9] Shun-ichiAmari.“InformationGeometry”.In:ContemporaryMathematics.Ed.byHanna
Nencka and Jean-Pierre Bourguignon. Vol. 203. Providence, Rhode Island: American
Mathematical Society, 1997, pp. 81–95. isbn: 978-0-8218-0607-4 978-0-8218-7794-4. doi:
304
10.1090/conm/203/02554. url: http://www.ams.org/conm/203/
(visitedon12/23/2022).
[10] Shun’ichiAmari.InformationGeometryandItsApplications.AppliedMathematicalSciences
volume194.Japan:Springer,2016.374pp.isbn:978-4-431-55977-1.
[11] DanielJAmit.ModelingBrainFunction:TheWorldofAttractorNeuralNetworks.Cambridge
UniversityPress,1992.
[12] BrittAndersonetal.“CategoryTheoryforCognitiveScience”.In:ProceedingsoftheAnnual
MeetingoftheCognitiveScienceSociety.Vol.44.2022.
[13] Ludwig Arnold. Random Dynamical Systems. Springer Berlin Heidelberg, 1998. 612 pp.
isbn: 978-3-540-63758-5. doi: 10.1007/978-3-662-12878-7. url: https:
//doi.org/10.1007/978-3-662-12878-7.
[14] Robert Atkey. “Syntax and Semantics of Quantitative Type Theory”. In: Proceedings of
the33rdAnnualACM/IEEESymposiumonLogicinComputerScience.ACM,07/2018.doi:
10.1145/3209108.3209189.
[15] Robert J. Aumann. “Borel Structures for Function Spaces”. In: Illinois Journal of Math-
ematics 5.4 (12/01/1961). issn: 0019-2082. doi: 10.1215/ijm/1255631584. url:
https://projecteuclid.org/journals/illinois- journal-
of-mathematics/volume-5/issue-4/Borel-structures-for-
function - spaces / 10 . 1215 / ijm / 1255631584 . full (visited on
06/20/2023).
[16] JohnC.BaezandJamesDolan.“Higher-dimensionalAlgebraandTopologicalQuantum
Field Theory”. In: Journal of Mathematical Physics 36.11 (11/1995), pp. 6073–6105. issn:
0022-2488,1089-7658.doi:10.1063/1.531236.url:http://aip.scitation.
org/doi/10.1063/1.531236(visitedon12/23/2022).
[17] John C. Baez and James Dolan. “Higher-Dimensional Algebra III: N-Categories and the
Algebra of Opetopes”. In: Adv. Math. 135 (1998), 145-206. (02/10/1997). arXiv: q-alg/
9702014.
[18] JohnC.Baezetal.“NetworkModels”.In:TheoryandApplicationsofCategories,Vol.35,2020,
No.20,pp700-744 (10/31/2017).arXiv:1711.00037[math.CT].
[19] IgorBaković.“FibrationsofBicategories”.In:(2010).url:https://www2.irb.hr/
korisnici/ibakovic/groth2fib.pdf.
[20] MarcelloBarbieri,ed.IntroductiontoBiosemioticsTheNewBiologicalSynthesis.TheNew
BiologicalSynthesis.Springer,2007.isbn:978-1-4020-4814-2.
[21] A.M.Bastosetal.“CanonicalMicrocircuitsforPredictiveCoding”.In:Neuron76.4(11/2012),
pp.695–711.doi:10.1016/j.neuron.2012.10.038.pmid:23177956.
305
[22] Matthew J. Beal and Zoubin Ghahramani. “The Variational Bayesian EM Algorithm for
IncompleteData:WithApplicationtoScoringGraphicalModelStructures”.In:Bayesian
Statistics.Vol.7.Valencia:OxfordUniversityPress,2003.
[23] C. Glenn Begley and Lee M. Ellis. “Raise Standards for Preclinical Cancer Research”. In:
Nature483.7391(03/2012),pp.531–533.doi:10.1038/483531a.
[24] TimothyEJBehrensetal.“WhatIsaCognitiveMap?OrganizingKnowledgeforFlexible
Behavior”.In:Neuron100.2(2018),pp.490–509.
[25] Richard Bellman. “The Theory of Dynamic Programming”. In: Bulletin of the American
MathematicalSociety 60.6(1954),pp.503–515.issn:0273-0979,1088-9485.doi:10.1090/
S0002-9904-1954-09848-8.url:https://www.ams.org/bull/1954-
60-06/S0002-9904-1954-09848-8/(visitedon05/17/2023).
[26] JacobLSBellmundetal.“NavigatingCognition:SpatialCodesforHumanThinking”.In:
Science(NewYork,N.Y.) 362.6415(2018,2018-11),eaat6766.doi:10.1126/science.
aat6766.
[27] SilviaBernardietal.“TheGeometryofAbstractioninHippocampusandPre-FrontalCortex”.
In:(09/2018).doi:10.1101/408633.
[28] MartinBiehl,FelixA.Pollock,andRyotaKanai.“ATechnicalCritiqueoftheFreeEnergy
Principle as Presented in "Life as We Know It" and Related Works”. 01/12/2020. arXiv:
2001.06408v2[q-bio.NC].
[29] Achim Blumensath and Viktor Winschel. “A Compositional Coalgebraic Semantics of
StrategicGames”.12/22/2017.arXiv:1712.08381v1[cs.GT].
[30] R. F. Blute, J. R. B. Cockett, and R. A. G. Seely. “Differential Categories”. In: Math-
ematical Structures in Computer Science 16.06 (11/2006), p. 1049. doi: 10 . 1017 /
s0960129506005676.
[31] CristianBodnaretal.NeuralSheafDiffusion:ATopologicalPerspectiveonHeterophilyand
OversmoothinginGNNs.10/21/2022.arXiv:2202.04579[cs, math].url:http:
//arxiv.org/abs/2202.04579(visitedon12/23/2022).preprint.
[32] MBoerlinetal.“PredictiveCodingofDynamicalVariablesinBalancedSpikingNetworks”.
In:PLoScomputationalbiology 9.11(2013),e1003258.url:http://journals.plos.
org/ploscompbiol/article?id=10.1371/journal.pcbi.1003258.
[33] Rafal Bogacz. “A Tutorial on the Free-Energy Framework for Modelling Perception and
Learning”. In: Journal of Mathematical Psychology 76 (02/2017), pp. 198–211. doi: 10.
1016/j.jmp.2015.11.003.
[34] AaronBohannon,BenjaminCPierce,andJeffreyAVaughan.“RelationalLenses:ALanguage
forUpdatableViews”.In:ProceedingsoftheTwenty-FifthACMSIGMOD-SIGACT-SIGART
SymposiumonPrinciplesofDatabaseSystems.ACM.2006,pp.338–347.
306
[35] GuillaumeBoisseau.“StringDiagramsforOptics”.02/11/2020.arXiv:2002.11480v1
[math.CT].
[36] Joe Bolt, Jules Hedges, and Philipp Zahn. “Bayesian Open Games”. 10/08/2019. arXiv:
1910.03656v1[cs.GT].
[37] JoeBoltetal.“InteractingConceptualSpacesI:GrammaticalCompositionofConcepts”.In:
Springer,2019,2017,pp.151–181.arXiv:1703.08314[cs.LO].
[38] EvertA.BoonstraandHeleenA.Slagter.“TheDialecticsofFreeEnergyMinimization”.In:
FrontiersinSystemsNeuroscience13(09/10/2019),p.42.issn:1662-5137.doi:10.3389/
fnsys.2019.00042. url: https://www.frontiersin.org/article/
10.3389/fnsys.2019.00042/full(visitedon12/23/2022).
[39] Francis Borceux. Handbook of Categorical Algebra 2. Categories and Structures. Vol. 51.
EncyclopediaofMathematicsandItsApplications.CambridgeUniversityPress,Cambridge,
1994.isbn:978-0-521-44179-7.
[40] Tai-Danae Bradley. “Entropy as a Topological Operad Derivation”. In: Entropy 23.9
(09/09/2021), p. 1195. issn: 1099-4300. doi: 10.3390/e23091195. url: https:
//www.mdpi.com/1099-4300/23/9/1195(visitedon05/02/2023).
[41] DylanBraithwaiteandJulesHedges.DependentBayesianLenses:CategoriesofBidirectional
MarkovKernelswithCanonicalBayesianInversion.09/29/2022.arXiv:2209.14728[cs,
math, stat]. url: http://arxiv.org/abs/2209.14728 (visited on
12/17/2022).preprint.
[42] DylanBraithwaite,JulesHedges,andTobyStClereSmithe.TheCompositionalStructure
of Bayesian Inference. 05/10/2023. arXiv: 2305.06112 [cs, math]. url: http:
//arxiv.org/abs/2305.06112(visitedon05/11/2023).preprint.
[43] Dylan Braithwaite et al. Fibre Optics. 12/21/2021. arXiv: 2112.11145 [math.CT].
preprint.
[44] Michael M. Bronstein et al. Geometric Deep Learning: Grids, Groups, Graphs, Geodesics,
andGauges.05/02/2021.arXiv:2104.13478[cs, stat].url:http://arxiv.
org/abs/2104.13478(visitedon12/23/2022).preprint.
[45] Kenneth S. Brown. “Abstract Homotopy Theory and Generalized Sheaf Cohomology”.
In: Transactions of the American Mathematical Society 186 (1973), pp. 419–419. doi: 10.
1090/s0002-9947-1973-0341469-9. JSTOR: 1996573. url: https://
www.jstor.org/stable/1996573.
[46] N.G.deBruijn.AsymptoticMethodsinAnalysis.Dovered.NewYork:DoverPublications,
1981.200pp.isbn:978-0-486-64221-5.
[47] Iva K. Brunec and Ida Momennejad. “Predictive Representations in Hippocampal and
PrefrontalHierarchies”.In:bioRxiv:thepreprintserverforbiology (2019).doi:10.1101/
307
786434. eprint: https://www.biorxiv.org/content/early/2019/
09/30/786434.full.pdf.url:https://www.biorxiv.org/content/
early/2019/09/30/786434.
[48] Christopher L Buckley et al. “The Free Energy Principle for Action and Perception: A
MathematicalReview”.In:JournalofMathematicalPsychology 81(05/24/2017),pp.55–79.
doi:10.1016/j.jmp.2017.09.004.arXiv:1705.09156v1[q-bio.NC].
[49] Jerome R Busemeyer and Peter D Bruza. Quantum Models of Cognition and Decision.
CambridgeUniversityPress,2012.
[50] MatteoCapucci.SeeingDoublethroughDependentOptics.04/22/2022.arXiv:2204.10708
[math.CT].preprint.
[51] Matteo Capucci. “Diegetic Representation of Feedback in Open Games”. In: Electronic
Proceedings in Theoretical Computer Science. Applied Category Theory 2022. Vol. 380.
08/07/2023, pp. 145–158. doi: 10.4204/EPTCS.380.9. url: http://arxiv.
org/abs/2206.12338v3(visitedon09/29/2023).
[52] Matteo Capucci and Bruno Gavranović. “Actegories for the Working Amthematician”.
03/30/2022.arXiv:2203.16351[math.CT].
[53] MatteoCapucci,BrunoGavranović,andTobyStClereSmithe.“ParameterizedCategories
andCategoriesbyProxy”.In:CategoryTheory2021.CategoryTheory.Genoa,2021.url:
https://www.youtube.com/watch?v=lYs6Bs6JK9Q.
[54] Matteo Capucci et al. “Towards Foundations of Categorical Cybernetics”. In: Electronic
Proceedings in Theoretical Computer Science. Applied Category Theory 2021. Vol. 372.
11/03/2022, pp. 235–248. doi: 10.4204/EPTCS.372.17. url: http://arxiv.
org/abs/2105.06332v2(visitedon09/29/2023).
[55] Olivia Caramello. A Topos-Theoretic Approach to Stone-type Dualities. 03/17/2011. arXiv:
1103.3493[math].url:http://arxiv.org/abs/1103.3493(visitedon
05/17/2023).preprint.
[56] Henri Cartan. “Variétés Analytiques Complexes et Cohomologie”. In: Colloque Sur Les
Fonctions de Plusieurs Variables Tenu a Bruxelles. 1953. url: https://www.inp.
nsk.su/~silagadz/Cartan.pdf.
[57] HenriPaulCartanandSamuelEilenberg.HomologicalAlgebra.PrincetonLandmarksin
MathematicsandPhysics.Princeton,N.J:PrincetonUniversityPress,1956.390pp.isbn:
978-0-691-04991-5.
[58] GiovanniCarù.“LogicalandTopologicalContextualityinQuantumMechanicsandBeyond”.
University of Oxford / University of Oxford / University of Oxford, 2019. url: https:
//ora.ox.ac.uk/objects/uuid:9bc2335a-b627-463b-9526-
f4b881b0fbbf.
308
[59] EugeniaCheng.“WeakN-Categories:OpetopicandMultitopicFoundations”.04/21/2003.
arXiv:math/0304277.
[60] Kenta Cho and Bart Jacobs. “Disintegration and Bayesian Inversion via String Dia-
grams”. In: Math. Struct. Comp. Sci. 29 (2019) 938-971 (08/29/2017). doi: 10.1017/
S0960129518000488.arXiv:1709.00322v3[cs.AI].
[61] Kenta Cho et al. “An Introduction to Effectus Theory”. 2015. arXiv: 1512.05813
[cs.LO].
[62] CorinaCirstea.“AnAlgebra-CoalgebraFrameworkforSystemSpecification”.In:Electronic
NotesinTheoreticalComputerScience33(2000),pp.80–110.
[63] Bryce Clarke. “Internal Lenses as Functors and Cofunctors”. In: Electronic Proceedings
in Theoretical Computer Science 323 (09/15/2020), pp. 183–195. issn: 2075-2180. doi: 10.
4204/EPTCS.323.13. url: http://arxiv.org/abs/2009.06835v1
(visitedon12/23/2022).
[64] BryceClarkeandMatthewDiMeglio.AnIntroductiontoEnrichedCofunctors.09/02/2022.
arXiv: 2209.01144 [math]. url: http://arxiv.org/abs/2209.01144
(visitedon12/23/2022).preprint.
[65] BryceClarkeetal.“ProfunctorOptics,aCategoricalUpdate”.01/21/2020.arXiv:2001.
07488v1[cs.PL].
[66] Robin Cockett et al. “Reverse Derivative Categories”. In: CSL 2020. 28th International
Conference on Computer Science Logic. 2019-10-15, 2020. arXiv: 1910.07065v1
[cs.LO].
[67] BobCoecke.“TheMathematicsofTextStructure”.2019.arXiv:1904.03478.
[68] Bob Coecke and Aleks Kissinger. “Categorical Quantum Mechanics I: Causal Quantum
Processes”.10/19/2015.arXiv:1510.05468v3[quant-ph].
[69] BobCoeckeandAleksKissinger.“CategoricalQuantumMechanicsII:Classical-Quantum
Interaction”.05/27/2016.arXiv:1605.08617v1[quant-ph].
[70] BobCoecke,MehrnooshSadrzadeh,andStephenClark.“MathematicalFoundationsfora
CompositionalDistributionalModelofMeaning”.In:LambekFestschirft,specialissueof
LinguisticAnalysis,2010.(03/2010).eprint:1003.4394.url:https://arxiv.org/
abs/1003.4394.
[71] MatteoColomboandCoryWright.“FirstPrinciplesintheLifeSciences:TheFree-Energy
Principle, Organicism, and Mechanism”. In: Synthese 198.S14 (06/2021), pp. 3463–3488.
issn:0039-7857,1573-0964.doi:10.1007/s11229-018-01932-w.url:https:
//link.springer.com/10.1007/s11229-018-01932-w (visited on
12/23/2022).
309
[72] DavidCorfield.CoalgebraicModalLogic.2009.url:https://golem.ph.utexas.
edu/category/2009/09/coalgebraic_modal_logic.html.
[73] Lancelot Da Costa et al. “Reward Maximisation through Discrete Active Inference”.
07/11/2022.arXiv:2009.08111[cs.AI].
[74] GeoffreyS.H.Cruttwelletal.“CategoricalFoundationsofGradient-BasedLearning”.In:
Programming Languages and Systems. Springer International Publishing, 2022, pp. 1–28.
doi:10.1007/978-3-030-99336-8_1.
[75] JustinCurry.“Sheaves,CosheavesandApplications”.03/13/2013.arXiv:1303.3255v2
[math.AT].
[76] LancelotDaCostaetal.“ActiveInferenceonDiscreteState-Spaces:ASynthesis”.01/20/2020.
arXiv:2001.07203[q-bio.NC].
[77] Brian Day and Ross Street. “Monoidal Bicategories and Hopf Algebroids”. In: Advances
in Mathematics 129.1 (07/1997), pp. 99–157. issn: 00018708. doi: 10.1006/aima.
1997.1649. url: https://linkinghub.elsevier.com/retrieve/
pii/S0001870897916492(visitedon12/17/2022).
[78] PeterDayan.“ImprovingGeneralizationforTemporalDifferenceLearning:TheSuccessor
Representation”.In:NeuralComputation5.4(07/1993),pp.613–624.issn:1530-888X.doi:
10.1162/neco.1993.5.4.613.
[79] PeterDayanandLaurenceFAbbott.TheoreticalNeuroscience.Vol.806.Cambridge,MA:
MITPress,2001.
[80] PeterDayanetal.“TheHelmholtzMachine”.In:NeuralComputation7.5(09/1995),pp.889–
904. doi: 10.1162/neco.1995.7.5.889. url: http://dx.doi.org/10.
1162/neco.1995.7.5.889.
[81] Sophie Deneve. “Making Decisions with Unknown Sensory Reliability”. In: Frontiers in
neuroscience6(2012).url:http://www.ncbi.nlm.nih.gov/pmc/articles/
PMC3367295/.
[82] Sophie Denève and Christian K Machens. “Efficient Codes and Balanced Networks”. In:
Nature neuroscience 19.3 (02/2016), pp. 375–382. issn: 1546-1726. doi: 10.1038/nn.
4243.
[83] BertdeVriesandKarlJ.Friston.“AFactorGraphDescriptionofDeepTemporalActive
Inference”. In: Frontiers in Computational Neuroscience 11 (10/2017). doi: 10.3389/
fncom.2017.00095.
[84] A Ehresmann and J Vanbremeersch. “Hierarchical Evolutive Systems: A Mathematical
ModelforComplexSystems”.In:BulletinofMathematicalBiology 49.1(1987),pp.13–50.
issn:00928240.doi:10.1016/S0092-8240(87)80033-2.url:http://link.
springer.com/10.1016/S0092-8240(87)80033-2(visitedon12/23/2022).
310
[85] A.C.EhresmannandJ.P.Vanbremeersch.MemoryEvolutiveSystems;Hierarchy,Emergence,
Cognition.StudiesinMultidisciplinarity.ElsevierScience,2007.isbn:978-0-08-055541-6.
url:https://books.google.co.uk/books?id=OqcYQbY79GMC.
[86] AndréeC.EhresmannandJean-PaulVanbremeersch.“TheMemoryEvolutiveSystemsas
aModelofRosen’sOrganisms–(Metabolic,Replication)Systems”.In:Axiomathes16.1-2
(03/2006),pp.137–154.issn:1572-8390.doi:10.1007/s10516-005-6001-0.url:
http://link.springer.com/10.1007/s10516-005-6001-0.
[87] SamuelEilenbergandSaundersMacLane.“GeneralTheoryofNaturalEquivalences”.In:
TransactionsoftheAmericanMathematicalSociety 58.0(1945),pp.231–294.issn:0002-9947,
1088-6850. doi: 10.1090/S0002-9947-1945-0013131-6. url: https:
//www.ams.org/tran/1945-058-00/S0002-9947-1945-0013131-
6/(visitedon12/23/2022).
[88] RussellAEpsteinetal.“TheCognitiveMapinHumans:SpatialNavigationandBeyond”.
In:NatureNeuroscience20.11(10/2017),pp.1504–1513.doi:10.1038/nn.4656.
[89] Martín Escardó and Paulo Oliva. “Selection Functions, Bar Recursion and Backward
Induction”.In:MathematicalStructuresinComputerScience20.2(03/2010),pp.127–168.doi:
10.1017/s0960129509990351.
[90] Chris Fields, James F. Glazebrook, and Antonino Marciano. “The Physical Meaning of
the Holographic Principle”. In: Quanta 11.1 (11/21/2022), pp. 72–96. issn: 1314-7374.
doi: 10 . 12743 / quanta . v11i1 . 206. arXiv: 2210 . 16021 [gr-qc,
physics:hep-th, physics:quant-ph]. url: http://arxiv.org/
abs/2210.16021(visitedon12/23/2022).
[91] Chris Fields et al. “A Free Energy Principle for Generic Quantum Systems”. In: Progress
in Biophysics and Molecular Biology 173 (09/2022), pp. 36–59. doi: 10.1016/j.
pbiomolbio.2022.05.006.
[92] JohnRupertFirth.“ASynopsisofLinguisticTheory,1930-1955”.In:StudiesinLinguistic
Analysis.Oxford:BasilBlackwell,1957,pp.1–32.
[93] BrendanFong.“DecoratedCospans”.In:TheoryandApplicationsofCategories30.33(2015),
pp. 1096–1120. arXiv: 1502.00872. url: http://www.tac.mta.ca/tac/
volumes/30/33/30-33abs.html.
[94] BrendanFong.“TheAlgebraofOpenandInterconnectedSystems”.UniversityofOxford,
2016.
[95] Brendan Fong. “Causal Theories: A Categorical Perspective on Bayesian Networks”.
UniversityofOxford,2013-01-26,2013.arXiv:1301.6201v1[math.PR].url:http:
//arxiv.org/abs/1301.6201.
[96] Brendan Fong and Michael Johnson. “Lenses and Learners”. In: In: J. Cheney, H-S. Ko
(eds.):ProceedingsoftheEighthInternationalWorkshoponBidirectionalTransformations(Bx
311
2019),Philadelphia,PA,USA,June4,2019,publishedathttp://ceur-ws.org (03/05/2019).arXiv:
1903.03671v2[cs.LG].
[97] Brendan Fong and David I. Spivak. Seven Sketches in Compositionality: An Invitation to
AppliedCategoryTheory.2018.arXiv:1803.05316v3[math.CT].
[98] Brendan Fong and David I. Spivak. “Hypergraph Categories”. In: Journal of Pure and
Applied Algebra 223.11 (11/2019), pp. 4746–4777. issn: 00224049. doi: 10.1016/j.
jpaa.2019.02.014. arXiv: 1806.08304v3 [math.CT]. url: https://
linkinghub.elsevier.com/retrieve/pii/S0022404919300489
(visitedon12/17/2022).
[99] J. Nathan Foster et al. “Combinators for Bidirectional Tree Transformations”. In: ACM
TransactionsonProgrammingLanguagesandSystems29.3(05/2007),p.17.doi:10.1145/
1232420.1232424.
[100] K. Friston. “A Theory of Cortical Responses”. In: Philos. Trans. R. Soc. Lond., B, Biol.
Sci. 360.1456 (04/2005), pp. 815–836. doi: 10.1098/rstb.2005.1622. pmid:
15937014.
[101] K.Fristonetal.“VariationalFreeEnergyandtheLaplaceApproximation”.In:Neuroimage
34.1(01/2007),pp.220–234.doi:10.1016/j.neuroimage.2006.08.035.pmid:
17055746.
[102] KarlFriston.“AFreeEnergyPrincipleforaParticularPhysics”.06/24/2019.arXiv:1906.
10184v1[q-bio.NC].
[103] KarlFriston,LancelotDaCosta,andThomasParr.“SomeInterestingObservationsonthe
FreeEnergyPrinciple”.02/05/2020.arXiv:2002.04501v1[q-bio.NC].
[104] Karl Friston and Stefan Kiebel. “Predictive Coding under the Free-Energy Principle”.
In: Philosophical Transactions of the Royal Society B: Biological Sciences 364.1521 (2009),
pp. 1211–1221. doi: 10.1098/rstb.2008.0300. url: http://m.rstb.
royalsocietypublishing.org/content/364/1521/1211.
[105] KarlFristonetal.“GeneralisedFiltering”.In:MathematicalProblemsinEngineering 2010
(2010),pp.1–34.doi:10.1155/2010/621670.
[106] KarlJ.Friston,JeanDaunizeau,andStefanJ.Kiebel.“ReinforcementLearningorActive
Inference?” In: PLoS ONE 4.7 (07/2009). Ed. by Olaf Sporns, e6421. doi: 10.1371/
journal.pone.0006421.
[107] Karl J. Friston and Klaas E. Stephan. “Free-Energy and the Brain”. In: Synthese. An
InternationalJournalforEpistemology,MethodologyandPhilosophyofScience159.3(09/2007),
pp. 417–458. doi: 10.1007/s11229-007-9237-y. url: http://dx.doi.
org/10.1007/s11229-007-9237-y.
312
[108] Karl J. Friston et al. “Action and Behavior: A Free-Energy Formulation”. In: Biological
Cybernetics102.3(02/2010),pp.227–260.doi:10.1007/s00422-010-0364-z.
[109] Tobias Fritz. “A Synthetic Approach to Markov Kernels, Conditional Independence and
TheoremsonSufficientStatistics”.In:AdvancesinMathematics 370.107239(08/19/2019).
doi:10.1016/j.aim.2020.107239.arXiv:1908.07021v3[math.ST].
[110] TobiasFritzandPaoloPerrone.“BimonoidalStructureofProbabilityMonads”.In:Electronic
Notes in Theoretical Computer Science 341 (12/2018), pp. 121–149. issn: 15710661. doi:
10.1016/j.entcs.2018.11.007. arXiv: 1804.03527 [cs, math]. url:
http://arxiv.org/abs/1804.03527(visitedon06/20/2023).
[111] PengFu,KoheiKishida,andPeterSelinger.“LinearDependentTypeTheoryforQuantum
ProgrammingLanguages”.04/28/2020.arXiv:2004.13472[cs.PL].
[112] ChristopherA.Fuchs.“NotwithstandingBohr,theReasonsforQBism”.In:MindandMatter
15(2),245-300(2017)(05/09/2017).arXiv:1705.03483v2[quant-ph].
[113] ChristopherA.Fuchs,N.DavidMermin,andRuedigerSchack.“AnIntroductiontoQBism
with an Application to the Locality of Quantum Mechanics”. In: Am. J. Phys., Vol. 82,
(11/2013),No.8,August2014,749–754.eprint:1311.5253.
[114] ChristopherA.FuchsandRuedigerSchack.“AQuantum-BayesianRoutetoQuantum-State
Space”. 12/2009. doi: 10.1007/s10701-009-9404-8. arXiv: 0912.4252
[quant-ph].
[115] Maria Carla Galavotti. “Subjectivism, Objectivism and Objectivity in Bruno de Finetti’s
Bayesianism”.In:FoundationsofBayesianism.Ed.byDavidCorfieldandJonWilliamson.
Red.byDovM.GabbayandJonBarwise.Vol.24.Dordrecht:SpringerNetherlands,2001,
pp.161–174.isbn:978-90-481-5920-8978-94-017-1586-7.doi:10.1007/978-94-017-
1586-7_7. url: http://link.springer.com/10.1007/978-94-017-
1586-7_7(visitedon12/23/2022).
[116] MonaMGarvert,RaymondJDolan,andTimothyEJBehrens.“AMapofAbstractRelational
Knowledge in the Human Hippocampal–Entorhinal Cortex”. In: eLife 6 (04/2017). issn:
2050-084X.doi:10.7554/elife.17086.
[117] WulframGerstner.“Spike-ResponseModel”.In:Scholarpedia3.12(2008),p.1343.
[118] WulframGerstnerandWernerM.Kistler.“MathematicalFormulationsofHebbianLearning”.
In:BiologicalCybernetics87.5-6(12/2002),pp.404–415.issn:0340-1200.doi:10.1007/
s00422-002-0353-y. url: http://dx.doi.org/10.1007/s00422-
002-0353-y.
[119] NeilGhanietal.“CompositionalGameTheory”.In:Proceedingsofthe33rdAnnualACM/IEEE
SymposiumonLogicinComputerScience.LICS’18:33rdAnnualACM/IEEESymposiumon
LogicinComputerScience.OxfordUnitedKingdom:ACM,07/09/2018,pp.472–481.isbn:
313
978-1-4503-5583-4.doi:10.1145/3209108.3209165.url:https://dl.acm.
org/doi/10.1145/3209108.3209165(visitedon09/29/2023).
[120] MichèleGiry.“ACategoricalApproachtoProbabilityTheory”.In:CategoricalAspectsof
TopologyandAnalysis.Ed.byB.Banaschewski.Red.byA.DoldandB.Eckmann.Vol.915.
Berlin,Heidelberg:SpringerBerlinHeidelberg,1982,pp.68–85.isbn:978-3-540-11211-2
978-3-540-39041-1.doi:10.1007/BFb0092872.url:http://link.springer.
com/10.1007/BFb0092872(visitedon06/20/2023).
[121] Alexander Grothendieck. “Sur Quelques Points d’algèbre Homologique”. In: Tohoku
Mathematical Journal 9.2 (01/01/1957). issn: 0040-8735. doi: 10 . 2748 / tmj /
1178244839. url: https://projecteuclid.org/journals/tohoku-
mathematical- journal/volume- 9/issue- 2/Sur- quelques-
points - dalg % c3 % a8bre - homologique - I / 10 . 2748 / tmj /
1178244839.full(visitedon12/23/2022).
[122] Micah Halter et al. Compositional Scientific Computing with Catlab and SemanticModels.
06/29/2020.arXiv:2005.04831[cs, math].url:http://arxiv.org/abs/
2005.04831(visitedon12/23/2022).preprint.
[123] Jakob Hansen. “Laplacians of Cellular Sheaves: Theory and Applications”. PhD thesis.
UniversityofPennsylvania,2020.
[124] Jakob Hansen and Robert Ghrist. “Learning Sheaf Laplacians from Smooth Signals”. In:
ICASSP2019-2019IEEEInternationalConferenceonAcoustics,SpeechandSignalProcessing
(ICASSP).IEEE,05/2019.doi:10.1109/icassp.2019.8683709.
[125] JakobHansenandRobertGhrist.“OpinionDynamicsonDiscourseSheaves”.05/26/2020.
arXiv:2005.12798[math.DS].
[126] R. V. L. Hartley. “Transmission of Information 1”. In: Bell System Technical Journal 7.3
(07/1928), pp. 535–563. issn: 00058580. doi: 10.1002/j.1538-7305.1928.
tb01236.x.url:https://ieeexplore.ieee.org/document/6769394
(visitedon12/23/2022).
[127] DonaldOldingHebb.TheOrganizationofBehavior:ANeuropsychologicalApproach.John
Wiley&Sons,1949.
[128] Jules Hedges and Riu Rodríguez Sakamoto. “Value Iteration Is Optic Composition”.
06/09/2022.arXiv:2206.04547[math.CT].
[129] ConorHeinsetal.“SpinGlassSystemsasCollectiveActiveInference”.07/14/2022.arXiv:
2207.06970[cond-mat.dis-nn].
[130] ChrisHeunen,MehrnooshSadrzadeh,andEdwardGrefenstette,eds.QuantumPhysicsand
Linguistics: A Compositional, Diagrammatic Discourse. Oxford University Press, 02/2013.
isbn: 978-0-19-964629-6. url: http://ukcatalogue.oup.com/product/
9780199646296.do#.UPAFH4mLLqp.
314
[131] Chris Heunen et al. “A Convenient Category for Higher-Order Probability Theory”. In:
201732ndAnnualACM/IEEESymposiumonLogicinComputerScience(LICS)(2017-01-10,
2017-06).doi:10.1109/lics.2017.8005137.arXiv:1701.02547[cs.PL].
[132] SeppHochreiterandJürgenSchmidhuber.“LongShort-TermMemory”.In:NeuralCompu-
tation9.8(11/01/1997),pp.1735–1780.issn:0899-7667,1530-888X.doi:10.1162/neco.
1997.9.8.1735.url:https://direct.mit.edu/neco/article/9/8/
1735-1780/6109(visitedon12/17/2022).
[133] A.L.HodgkinandA.F.Huxley.“AQuantitativeDescriptionofMembraneCurrentand
Its Application to Conduction and Excitation in Nerve”. In: The Journal of Physiology
117.4 (08/1952), pp. 500–544. issn: 0022-3751. doi: 10.1113/jphysiol.1952.
sp004764. url: http://dx.doi.org/10.1113/jphysiol.1952.
sp004764.
[134] Matthew Hutson. “Artificial Intelligence Faces Reproducibility Crisis”. In: Science (New
York,N.Y.) 359.6377(02/2018),pp.725–726.issn:0036-8075,1095-9203.doi:10.1126/
science.359.6377.725. url: https://www.science.org/doi/10.
1126/science.359.6377.725.
[135] JohnP.A.Ioannidis.“ContradictedandInitiallyStrongerEffectsinHighlyCitedClinical
Research”.In:JAMA294.2(07/13/2005),p.218.issn:0098-7484.doi:10.1001/jama.
294.2.218. url: http://jama.jamanetwork.com/article.aspx?
doi=10.1001/jama.294.2.218(visitedon12/23/2022).
[136] EugeneMIzhikevich.“NeuralExcitability,SpikingandBursting”.In:InternationalJournal
of Bifurcation and Chaos 10.06 (06/2000), pp. 1171–1266. issn: 1793-6551. doi: 10 .
1142/s0218127400000840. url: http://dx.doi.org/10.1142/
S0218127400000840.
[137] Bart Jacobs. “Convexity, Duality and Effects”. In: Theoretical Computer Science. Ed. by
Cristian S. Calude and Vladimiro Sassone. Vol. 323. Berlin, Heidelberg: Springer Berlin
Heidelberg,2010,pp.1–19.isbn:978-3-642-15239-9978-3-642-15240-5.doi:10.1007/
978-3-642-15240-5_1.url:http://link.springer.com/10.1007/
978-3-642-15240-5_1(visitedon05/12/2023).
[138] Bart Jacobs. Introduction to Coalgebra. Vol. 59. Cambridge University Press, 2017.
isbn: 978-1-107-17789-5. url: https : / / www . cambridge . org / gb /
academic/subjects/mathematics/logic-categories-and-sets/
introduction-coalgebra-towards-mathematics-states-and-
observation?format=HB&isbn=9781107177895.
[139] BartJacobs.“FromProbabilityMonadstoCommutativeEffectuses”.In:JournalofLogical
and Algebraic Methods in Programming 94 (01/2018), pp. 200–237. doi: 10.1016/j.
jlamp.2016.11.006.
315
[140] Bart Jacobs. “A Recipe for State-and-Effect Triangles”. In: Logical Methods in Computer
Science13.2(2017-05-17,2017),pp.1860–5974.doi:10.23638/LMCS-13(2:6)2017.
arXiv:1703.09034[cs.LO].
[141] BartJacobsandBramWesterbaan.“AnEffect-TheoreticAccountofLebesgueIntegration”.
In: Electronic Notes in Theoretical Computer Science 319 (12/2015), pp. 239–253. doi: 10.
1016/j.entcs.2015.12.015.
[142] BartJacobsandFabioZanasi.“TheLogicalEssentialsofBayesianReasoning”.In:Foundations
of Probabilistic Programming. Ed. by Gilles Barthe, Joost-Pieter Katoen, and Alexandra
Silva.1sted.CambridgeUniversityPress,12/03/2020,pp.295–332.isbn:978-1-108-77075-0
978-1-108-48851-8. doi: 10.1017/9781108770750.010. url: https://www.
cambridge.org/core/product/identifier/9781108770750%23c9/
type/book_part(visitedon09/29/2023).
[143] AmirhosseinJafarianetal.“StructureLearninginCoupledDynamicalSystemsandDynamic
Causal Modelling”. In: Philosophical Transactions of the Royal Society A: Mathematical,
PhysicalandEngineeringSciences377.2160(10/2019),p.20190048.doi:10.1098/rsta.
2019.0048.
[144] Renaud Jardri and Sophie Deneve. “Computational Models of Hallucinations”. In: The
NeuroscienceofHallucinations.Springer,2013,pp.289–313.
[145] NilesJohnsonandDonaldYau.2-DimensionalCategories.06/17/2020.arXiv:2002.06055
[math]. url: http://arxiv.org/abs/2002.06055 (visited on 11/03/2022).
preprint.
[146] Renaud Jolivet, Timothy J., and Wulfram Gerstner. “The Spike Response Model: A
FrameworktoPredictNeuronalSpikeTrains”.In:LectureNotesinComputerScience(2003),
pp. 846–853. issn: 0302-9743. doi: 10.1007/3-540-44989-2_101. url: http:
//dx.doi.org/10.1007/3-540-44989-2_101.
[147] R.E.Kalman.“ANewApproachtoLinearFilteringandPredictionProblems”.In:Journalof
BasicEngineering 82.1(1960),p.35.doi:10.1115/1.3662552.url:http://dx.
doi.org/10.1115/1.3662552.
[148] Raphael Kaplan and Karl J. Friston. “Planning and Navigation as Active Inference”. In:
Biological Cybernetics 112.4 (03/2018), pp. 323–343. doi: 10.1007/s00422-018-
0753-2.
[149] SayashKapoorandArvindNarayanan.LeakageandtheReproducibilityCrisisinML-based
Science.07/14/2022.arXiv:2207.07048[cs, stat].url:http://arxiv.org/
abs/2207.07048(visitedon12/23/2022).preprint.
[150] RobertEKass,LukeTierney,andJosephBKadane.“TheValidityofPosteriorExpansions
Based on Laplace’s Method”. In: Bayesian and Likelihood Methods in Statistics and
Econometrics:EssaysinHonorofGeorgeA.Barnard.Ed.bySGeisseretal.ElsevierScience
PublishersB.V.(North-Holland),1990.
316
[151] RobertE.KassandAdrianE.Raftery.“BayesFactors”.In:JournaloftheAmericanStatistical
Association 90.430 (06/1995), pp. 773–795. issn: 0162-1459, 1537-274X. doi: 10.1080/
01621459.1995.10476572.url:http://www.tandfonline.com/doi/
abs/10.1080/01621459.1995.10476572(visitedon05/15/2023).
[152] Richard A. Kelsey. “A Correspondence between Continuation Passing Style and Static
SingleAssignmentForm”.In:Papersfromthe1995ACMSIGPLANWorkshoponIntermediate
Representations.POPL95:22ndACMSymposiumonPrinciplesofProgrammingLanguages.
San Francisco California USA: ACM, 03/1995, pp. 13–22. isbn: 978-0-89791-754-4. doi:
10.1145/202529.202532. url: https://dl.acm.org/doi/10.1145/
202529.202532(visitedon05/02/2023).
[153] AndreiKhrennikovetal.“QuantumModelsforPsychologicalMeasurements:AnUnsolved
Problem”.In:PLoSONE9.10(10/2014).Ed.byZhong-LinEditorLu,e110909.issn:1932-6203.
doi: 10.1371/journal.pone.0110909. url: http://dx.doi.org/10.
1371/journal.pone.0110909.
[154] DiederikPKingmaandMaxWelling.Auto-EncodingVariationalBayes.12/20/2013.arXiv:
1312.6114[stat.ML].preprint.
[155] DiederikP.Kingma.“VariationalInference&DeepLearning.ANewSynthesis”.PhDthesis.
University of Amsterdam, 2017. url: https://hdl.handle.net/11245.1/
8e55e07f-e4be-458f-a929-2f9bc2d169e8.
[156] Thomas N. Kipf and Max Welling. Variational Graph Auto-Encoders. 11/21/2016. arXiv:
1611.07308 [cs, stat]. url: http://arxiv.org/abs/1611.07308
(visitedon12/23/2022).preprint.
[157] ThomasN.KipfandMaxWelling.Semi-SupervisedClassificationwithGraphConvolutional
Networks. 02/22/2017. arXiv: 1609.02907 [cs, stat]. url: http://arxiv.
org/abs/1609.02907(visitedon12/23/2022).preprint.
[158] MichaelKirchhoffetal.“TheMarkovBlanketsofLife:Autonomy,ActiveInferenceandthe
FreeEnergyPrinciple”.In:JournalofTheRoyalSocietyInterface15.138(01/2018),p.20170792.
doi:10.1098/rsif.2017.0792.
[159] MichaelD.Kirchhoff.“Autopoiesis,FreeEnergy,andtheLife–MindContinuityThesis”.In:
Synthese195.6(2018),pp.2519–2540.issn:0039-7857,1573-0964.doi:10.1007/s11229-
016-1100-6. url: http://link.springer.com/10.1007/s11229-
016-1100-6(visitedon12/23/2022).
[160] David C Knill and Alexandre Pouget. “The Bayesian Brain: The Role of Uncertainty in
NeuralCodingandComputation”.In:TRENDSinNeurosciences27.12(2004),pp.712–719.
doi:10.1016/j.tins.2004.10.007.url:http://www.sciencedirect.
com/science/article/pii/S0166223604003352.
[161] MarkA.Kramer.“NonlinearPrincipalComponentAnalysisUsingAutoassociativeNeural
Networks”.In:AIChEJournal 37.2(02/1991),pp.233–243.issn:0001-1541,1547-5905.doi:
317
10.1002/aic.690370209.url:https://onlinelibrary.wiley.com/
doi/10.1002/aic.690370209(visitedon05/02/2023).
[162] Alexander Kurz. Logic Column 15: Coalgebras and Their Logics. 05/28/2006. arXiv: cs/
0605128.url:http://arxiv.org/abs/cs/0605128(visitedon12/17/2022).
preprint.
[163] PierreSimonLaplace.“MemoirontheProbabilityoftheCausesofEvents”.In:Statistical
Science 1.3(1986),pp.364–378.issn:08834237.JSTOR:2245476.url:http://www.
jstor.org/stable/2245476(visitedon05/15/2023).
[164] F.W.LawvereandS.H.Schnauel.ConceptualMathematics:AFirstIntroductiontoCategories.
Cambridge,UKNewYork:CambridgeUniversityPress,2009.isbn:978-0-511-80419-9.doi:
10.1017/CBO9780511804199.
[165] F.WilliamLawvere.“FunctorialSemanticsofAlgebraicTheories”.In:Proceedingsofthe
NationalAcademyofSciences 50.5(11/1963),pp.869–872.issn:0027-8424,1091-6490.doi:
10.1073/pnas.50.5.869. url: https://pnas.org/doi/full/10.
1073/pnas.50.5.869(visitedon12/23/2022).
[166] F.WilliamLawvere.“AnElementaryTheoryoftheCategoryofSets”.In:Proceedingsof
theNationalAcademyofSciences52.6(12/1964),pp.1506–1511.issn:0027-8424,1091-6490.
doi:10.1073/pnas.52.6.1506.url:https://pnas.org/doi/full/10.
1073/pnas.52.6.1506(visitedon12/23/2022).
[167] John M. Lee. “Smooth Manifolds”. In: Introduction to Smooth Manifolds. New York, NY:
Springer New York, 2012, pp. 1–31. isbn: 978-1-4419-9982-5. doi: 10.1007/978-1-
4419-9982-5_1.url:https://doi.org/10.1007/978-1-4419-9982-
5_1.
[168] Tom Leinster. Higher Operads, Higher Categories. London Mathematical Society Lecture
NoteSeries298.CambridgeUniversityPress,Cambridge,2004.isbn:0-521-53215-9.doi:
10.1017/CBO9780511525896.
[169] TomLeinster.EntropyandDiversity:TheAxiomaticApproach.1sted.CambridgeUniversity
Press,04/30/2021.isbn:978-1-108-96355-8978-1-108-83270-0978-1-108-96557-6.doi:10.
1017/9781108963558. url: https://www.cambridge.org/core/
product/identifier/9781108963558/type/book(visitedon09/29/2023).
[170] PantelisLeptourgosetal.“CircularInferenceinBistablePerception”.In:JournalofVision20.4
(04/21/2020),p.12.issn:1534-7362.doi:10.1167/jov.20.4.12.url:https://
jov.arvojournals.org/article.aspx?articleid=2765046 (visited
on12/23/2022).
[171] EugeneLermanandDavidI.Spivak.“AnAlgebraofOpenContinuousTimeDynamical
SystemsandNetworks”.02/02/2016.arXiv:1602.01017v2[math.DS].
318
[172] PaulBlainLevy.“LocallyGradedCategories”.UniversityofBirmingham.02/17/2019.url:
https://www.cs.bham.ac.uk/~pbl/papers/locgrade.pdf.
[173] Fosco Loregian and Emily Riehl. “Categorical Notions of Fibration”. 06/15/2018. arXiv:
1806.06129v2[math.CT].
[174] MartinLundfall.“ADiagramModelofLinearDependentTypeTheory”.06/25/2018.arXiv:
1806.09593[math.LO].
[175] SaundersMacLane.CategoriesfortheWorkingMathematician.2nded.GraduateTextsin
Mathematics5.NewYork:Springer-Verlag,1998.isbn:0-387-98403-8.
[176] DavidJ.C.MacKay.InformationTheory,Inference,andLearningAlgorithms.Cambridge,UK
;NewYork:CambridgeUniversityPress,2003.628pp.isbn:978-0-521-64298-9.
[177] SaundersMacLaneandIekeMoerdijk.SheavesinGeometryandLogic:AFirstIntroduction
toToposTheory.Springer,1992.isbn:0-387-97710-4.
[178] ShirleyMarketal.“TransferringStructuralKnowledgeacrossCognitiveMapsinHumans
andModels”.In:NatureCommunications11.1(09/2020).doi:10.1038/s41467-020-
18254-6.
[179] David Marr. Vision: A Computational Investigation into the Human Representation and
ProcessingofVisualInformation.HenryHoltandCo,1982.
[180] YoshihiroMaruyama.“MeaningandDuality:FromCategoricalLogictoQuantumPhysics”.
PhDthesis.UniversityofOxford/UniversityofOxford,2016.url:https://ora.ox.
ac.uk/objects/uuid:440a291d-7533-493d-b5aa-f6db30ca03cf.
[181] Michael V Mascagni, Arthur S Sherman, et al. “Numerical Methods for Neuronal
Modeling”. In: Methods in neuronal modeling 2 (1989). url: http://cox.iwr.
uni-heidelberg.de/teaching/numsimneuro_ss2011/mascagni_
sherman.pdf.
[182] ConorMcBride.“IGotPlentyo’Nuttin’”.In:AListofSuccessesThatCanChangetheWorld.
Springer International Publishing, 2016, pp. 207–233. doi: 10.1007/978-3-319-
30936-1_12.
[183] YaaredAl-Mehairi,BobCoecke,andMarthaLewis.“CompositionalDistributionalCogni-
tion”.In:InternationalSymposiumonQuantumInteraction.Springer,08/12/2016,pp.122–134.
doi:10.1007/978-3-319-52289-0_10.arXiv:1608.03785[cs.AI].
[184] Bartosz Milewski. Profunctor Optics: The Categorical View. 2017. url: https : / /
bartoszmilewski.com/2017/07/07/profunctor-optics-the-
categorical-view/.
319
[185] Beren Millidge and Christopher L. Buckley. Successor Representation Active Inference.
07/20/2022. arXiv: 2207.09897 [cs]. url: http://arxiv.org/abs/2207.
09897(visitedon12/23/2022).preprint.
[186] BerenMillidge,AlexanderTschantz,andChristopherLBuckley.“WhencetheExpected
FreeEnergy?”04/17/2020.arXiv:2004.08128[cs.AI].
[187] Beren Millidge et al. Predictive Coding: Towards a Future of Deep Learning beyond
Backpropagation? 02/18/2022. arXiv: 2202.09467 [cs]. url: http://arxiv.
org/abs/2202.09467(visitedon12/23/2022).preprint.
[188] Aaron Mobley et al. “A Survey on Data Reproducibility in Cancer Research Provides
InsightsintoOurLimitedAbilitytoTranslateFindingsfromtheLaboratorytotheClinic”.
In: PLoS ONE 8.5 (05/15/2013). Ed. by Hirofumi Arakawa, e63221. issn: 1932-6203. doi:
10.1371/journal.pone.0063221. url: https://dx.plos.org/10.
1371/journal.pone.0063221(visitedon12/23/2022).
[189] Joe Moeller and Christina Vasilakopoulou. “Monoidal Grothendieck Construction”. In:
TheoryandApplicationsofCategories35.31(2020),pp.1159–1207.arXiv:1809.00727v2
[math.CT].
[190] Jason Morton. “Belief Propagation in Monoidal Categories”. In: Proceedings of the 11th
WorkshoponQuantumPhysicsandLogic.Vol.172.EPTCS,12/28/2014,pp.262–269.doi:
10.4204/EPTCS.172.18.arXiv:1405.2618[math].url:http://arxiv.
org/abs/1405.2618(visitedon12/23/2022).
[191] DavidJazMyers.“DoubleCategoriesofOpenDynamicalSystems(ExtendedAbstract)”.In:
ElectronicProceedingsinTheoreticalComputerScience333(02/08/2021),pp.154–167.issn:
2075-2180. doi: 10.4204/EPTCS.333.11. arXiv: 2005.05956 [math]. url:
http://arxiv.org/abs/2005.05956(visitedon11/16/2022).
[192] DavidJazMyers.CategoricalSystemsTheory(Draft).2022.url:http://davidjaz.
com/Papers/DynamicalBook.pdf.
[193] LynnNadelandLloydMacDonald.“Hippocampus:CognitiveMaporWorkingMemory?”
In:BehavioralandNeuralBiology29.3(1980),pp.405–409.issn:0163-1047.doi:10.1016/
S0163-1047(80)90430-6. url: http://www.sciencedirect.com/
science/article/pii/S0163104780904306.
[194] Jet Nestruev. Smooth Manifolds and Observables. Second edition. Graduate Texts in
Mathematics 220. New York: Springer, 2020. 433 pp. isbn: 978-3-030-45649-8. doi: 10.
1007/978-3-030-45650-4.
[195] FrankNielsen.“AnElementaryIntroductiontoInformationGeometry”.08/17/2018.arXiv:
1808.08271[cs.LG].
[196] nLabauthors.EssentialImage.05/2023.url:https://ncatlab.org/nlab/show/
essential+image.
320
[197] H. Nyquist. “Certain Topics in Telegraph Transmission Theory”. In: Transactions of the
AmericanInstituteofElectricalEngineers47.2(04/1928),pp.617–644.issn:0096-3860.doi:
10.1109/T-AIEE.1928.5055024. url: http://ieeexplore.ieee.
org/document/5055024/(visitedon12/23/2022).
[198] JohnO’Keefe.“PlaceUnitsintheHippocampusoftheFreelyMovingRat”.In:Experimental
neurology 51.1 (1976), pp. 78–109. url: http://www.sciencedirect.com/
science/article/pii/0014488676900558.
[199] YannOllivier.“TheExtendedKalmanFilterIsaNaturalGradientDescentinTrajectory
Space”.01/03/2019.arXiv:1901.00696v1[math.OC].
[200] FrankW.J.Olver.AsymptoticsandSpecialFunctions.AKPClassics.Wellesley,Mass:A.K.
Peters,1997.572pp.isbn:978-1-56881-069-0.
[201] Open Science Collaboration. “Estimating the Reproducibility of Psychological Science”.
In: Science 349.6251 (08/28/2015), aac4716. issn: 0036-8075, 1095-9203. doi: 10.1126/
science.aac4716. url: https://www.science.org/doi/10.1126/
science.aac4716(visitedon12/23/2022).
[202] Srdjan Ostojic and Nicolas Brunel. “From Spiking Neuron Models to Linear-Nonlinear
Models”.In:PLoScomputationalbiology 7.1(01/2011).Ed.byPeterE.Latham,e1001056.
doi: 10.1371/journal.pcbi.1001056. url: http://dx.doi.org/10.
1371/journal.pcbi.1001056.
[203] EnsorRafaelPalaciosetal.“BiologicalSelf-organisationandMarkovBlankets”.In:(11/2017).
doi:10.1101/227181.
[204] ThomasParr,LancelotDaCosta,andKarlFriston.“MarkovBlankets,InformationGeometry
and Stochastic Thermodynamics”. In: Philosophical Transactions of the Royal Society A:
Mathematical,PhysicalandEngineeringSciences378.2164(12/2019),p.20190159.doi:10.
1098/rsta.2019.0159.
[205] ThomasParr,GiovanniPezzulo,andKarlJ.Friston.ActiveInference.TheFreeEnergyPrinciple
inMind,Brain,andBehavior.MITPress,2022,p.288.isbn:978-0-262-04535-3.
[206] EvanPatterson,DavidI.Spivak,andDmitryVagner.“WiringDiagramsasNormalForms
forComputinginSymmetricMonoidalCategories”.In:ElectronicProceedingsinTheoretical
ComputerScience 333(02/08/2021),pp.49–64.issn:2075-2180.doi:10.4204/EPTCS.
333.4. arXiv: 2101.12046 [cs]. url: http://arxiv.org/abs/2101.
12046(visitedon10/27/2022).
[207] DuskoPavlovic,MichaelMislove,andJamesBWorrell.“TestingSemantics:Connecting
ProcessesandProcessLogics”.In:InternationalConferenceonAlgebraicMethodologyand
Software Technology. Springer. Springer Berlin Heidelberg, 2006, pp. 308–322. doi: 10.
1007/11784180_24.
321
[208] JudeaPearl.“ReverendBayesonInferenceEngines:ADistributedHierarchicalApproach”.
In:ProbabilisticandCausalInference.Ed.byHectorGeffner,RinaDechter,andJosephY.
Halpern. 1st ed. New York, NY, USA: ACM, 1982, pp. 129–138. isbn: 978-1-4503-9586-1.
doi: 10.1145/3501714.3501727. url: https://dl.acm.org/doi/10.
1145/3501714.3501727(visitedon12/23/2022).
[209] StevenPhillipsandWilliamH.Wilson.“CategorialCompositionality:ACategoryTheory
ExplanationfortheSystematicityofHumanCognition”.In:PLoSComputationalBiology 6.7
(07/2010).Ed.byKarlJ.Friston,e1000858.doi:10.1371/journal.pcbi.1000858.
[210] BenjaminC.Pierce.BasicCategoryTheoryforComputerScientists.MITPress,1991.
[211] V I Piterbarg and V R Fatalov. “The Laplace Method for Probability Measures in
Banach Spaces”. In: Russian Mathematical Surveys 50.6 (12/31/1995), pp. 1151–1239.
issn: 0036-0279, 1468-4829. doi: 10 . 1070 / RM1995v050n06ABEH002635.
url: https : / / iopscience . iop . org / article / 10 . 1070 /
RM1995v050n06ABEH002635(visitedon05/16/2023).
[212] TomasoPoggioandThomasSerre.“ModelsofVisualCortex”.In:Scholarpedia8.4(2013),
p. 3516. issn: 1941-6016. doi: 10.4249/scholarpedia.3516. url: http://
www.scholarpedia.org/article/Models_of_visual_cortex(visited
on12/23/2022).
[213] The Univalent Foundations Program. Homotopy Type Theory: Univalent Foundations of
Mathematics.InstituteforAdvancedStudy:https://homotopytypetheory.org/book,2013.
eprint: http://saunders.phil.cmu.edu/book/hott-a4.pdf. url:
https://homotopytypetheory.org/book/.
[214] MartinL.Puterman.MarkovDecisionProcesses:DiscreteStochasticDynamicProgramming.
1st ed. Wiley Series in Probability and Statistics. Wiley, 04/15/1994. isbn: 978-0-471-
61977-2 978-0-470-31688-7. doi: 10.1002/9780470316887. url: https://
onlinelibrary.wiley.com/doi/book/10.1002/9780470316887
(visitedon12/23/2022).
[215] Maxwell J D Ramstead et al. “On Bayesian Mechanics: A Physics of and by Beliefs”.
05/23/2022.arXiv:2205.11543[cond-mat.stat-mech].
[216] R. P. Rao and D. H. Ballard. “Predictive Coding in the Visual Cortex: A Functional
InterpretationofSomeExtra-ClassicalReceptive-FieldEffects”.In:NatureNeuroscience2.1
(01/1999),pp.79–87.doi:10.1038/4580.pmid:10195184.
[217] MitchellRiley.“CategoriesofOptics”.09/03/2018.arXiv:1809.00738v2[math.CT].
[218] EdmundT.RollsandAlessandroTreves.NeuralNetworksandBrainFunction.1sted.Oxford
UniversityPress,USA,01/15/1998.isbn:0-19-852432-3.
[219] MarioRomán.“OpenDiagramsviaCoendCalculus”.04/09/2020.arXiv:2004.04526v2
[math.CT].
322
[220] RobertRosen.“TheRepresentationofBiologicalSystemsfromtheStandpointoftheTheory
of Categories”. In: The Bulletin of Mathematical Biophysics 20.4 (12/1958), pp. 317–341.
issn: 0007-4985, 1522-9602. doi: 10.1007/BF02477890. url: http://link.
springer.com/10.1007/BF02477890(visitedon12/23/2022).
[221] RobertRosenbaum.“OntheRelationshipbetweenPredictiveCodingandBackpropagation”.
In:PLOSONE 17.3(03/31/2022).Ed.byGennadyS.Cymbalyuk,e0266102.issn:1932-6203.
doi:10.1371/journal.pone.0266102.url:https://dx.plos.org/10.
1371/journal.pone.0266102(visitedon12/23/2022).
[222] DylanRupelandDavidI.Spivak.TheOperadofTemporalWiringDiagrams:Formalizing
aGraphicalLanguageforDiscrete-TimeProcesses.07/25/2013.arXiv:1307.6894[cs,
math, q-bio]. url: http://arxiv.org/abs/1307.6894 (visited on
09/19/2023).preprint.
[223] SaraSabour,NicholasFrosst,andGeoffreyEHinton.“DynamicRoutingBetweenCapsules”.
In:AdvancesinNeuralInformationProcessingSystems.Ed.byI.Guyonetal.Vol.30.Curran
Associates, Inc., 2017. url: https://proceedings.neurips.cc/paper/
2017/file/2cad8fa47bbef282badbb8de5374b894-Paper.pdf.
[224] DaltonARSakthivadivel.“TowardsaGeometryandAnalysisforBayesianMechanics”.
04/25/2022.arXiv:2204.11900[math-ph].
[225] DaltonA.R.Sakthivadivel.AConstraintGeometryforInferenceandIntegration.04/18/2022.
arXiv: 2203 . 08119 [cond-mat, physics:math-ph]. url: http : / /
arxiv.org/abs/2203.08119(visitedon12/23/2022).preprint.
[226] Ausra Saudargiene, Bernd Porr, and Florentin Wörgötter. “How the Shape of Pre- and
PostsynapticSignalsCanInfluenceSTDP:ABiophysicalModel.”In:Neuralcomputation16.3
(03/2004),pp.595–625.doi:10.1162/089976604772744929.pmid:15006093.
url:http://dx.doi.org/10.1162/089976604772744929.
[227] EvanS.Schaffer,SrdjanOstojic,andL.F.Abbott.“AComplex-ValuedFiring-RateModel
ThatApproximatestheDynamicsofSpikingNetworks”.In:PLoScomputationalbiology
9.10 (10/2013). Ed. by Bard Ermentrout, e1003301. doi: 10.1371/journal.pcbi.
1003301.url:http://dx.doi.org/10.1371/journal.pcbi.1003301.
[228] UrsSchreiber.“DifferentialCohomologyinaCohesiveInfinity-Topos”.10/29/2013.arXiv:
1310.7930[math-ph].
[229] GrégoireSergeant-Perthuis.RegionalizedOptimization.05/19/2022.arXiv:2201.11876
[cs, math]. url: http://arxiv.org/abs/2201.11876 (visited on
12/23/2022).preprint.
[230] C. E. Shannon. “A Mathematical Theory of Communication”. In: Bell System Technical
Journal 27.3 (07/1948), pp. 379–423. issn: 00058580. doi: 10.1002/j.1538-7305.
1948.tb01338.x. url: https://ieeexplore.ieee.org/document/
6773024(visitedon12/23/2022).
323
[231] BrandonShapiroandDavidI.Spivak.“DynamicCategories,DynamicOperads:FromDeep
LearningtoPredictionMarkets”.05/08/2022.arXiv:2205.03906[math.CT].
[232] Dan Shiebler. “Categorical Stochastic Processes and Likelihood”. In: Compositionality 3,
1 (2021) (05/10/2020). doi: 10.32408/compositionality-3-1. arXiv: 2005.
04735[cs.AI].
[233] Harel Shouval. “Models of Synaptic Plasticity”. In: Scholarpedia 2.7 (2007), p. 1605. issn:
1941-6016.doi:10.4249/scholarpedia.1605.url:http://dx.doi.org/
10.4249/scholarpedia.1605.
[234] Michael Shulman. “Homotopy Type Theory: The Logic of Space”. In: New Spaces for
Mathematics and Physics. Ed. by M. Anel and G. Catren. Cambridge University Press,
2017-03-08, 2017. arXiv: 1703.03007 [math.CT]. url: http://arxiv.org/
abs/1703.03007.
[235] David I Spivak and Nelson Niu. Polynomial Functors: A General Theory of Interac-
tion. (In press), 2021. url: https : / / raw . githubusercontent . com /
ToposInstitute/poly/main/Book-Poly.pdf.
[236] DavidI.Spivak.“FunctorialDataMigration”.In:InformationandComputation217(2012),
pp. 31–51. issn: 0890-5401. doi: 10.1016/j.ic.2012.05.001. url: https:
//doi.org/10.1016/j.ic.2012.05.001.
[237] David I. Spivak. The Operad of Wiring Diagrams: Formalizing a Graphical Language for
Databases,Recursion,andPlug-and-PlayCircuits.05/01/2013.arXiv:1305.0297[cs,
math]. url: http://arxiv.org/abs/1305.0297 (visited on 12/23/2022).
preprint.
[238] DavidI.Spivak.GeneralizedLensCategoriesviaFunctorsCOp→Cat.08/06/2019.arXiv:
1908.02202[math.CT].preprint.
[239] David I. Spivak. Poly: An Abundant Categorical Setting for Mode-Dependent Dynamics.
05/05/2020.arXiv:2005.01894[math.CT].preprint.
[240] DavidI.Spivak.“Learners’Languages”.In:ElectronicProceedingsinTheoreticalComputer
Science 372 (03/01/2021), pp. 14–28. doi: 10.4204/EPTCS.372.2. arXiv: 2103.
01189[math.CT].
[241] DavidI.Spivak.AReferenceforCategoricalStructuresonPoly.02/01/2022.arXiv:2202.
00534[math.CT].preprint.
[242] DavidI.Spivak.FunctorialAggregation.01/31/2022.arXiv:2111.10968[cs, math].
url:http://arxiv.org/abs/2111.10968(visitedon12/23/2022).preprint.
[243] DavidI.Spivak,PatrickSchultz,andDylanRupel.“StringDiagramsforTracedandCompact
CategoriesAreOriented1-Cobordisms”.In:J.PureAppl.Algebra221(2017),no.8,pp.2064-
324
2110 (08/05/2015). doi: 10.1016/j.jpaa.2016.10.009. arXiv:1508.01069
[math.CT].
[244] David I. Spivak and Joshua Tan. “Nesting of Dynamic Systems and Mode-Dependent
Networks”.02/25/2015.arXiv:1502.07380[math.DS].
[245] OlafSporns.“BrainConnectivity”.In:Scholarpedia2.10(2007),p.4695.issn:1941-6016.doi:
10.4249/scholarpedia.4695. url: http://dx.doi.org/10.4249/
scholarpedia.4695.
[246] MandyamVeerambudiSrinivasan,SimonBarryLaughlin,andADubs.“PredictiveCoding:
AFreshViewofInhibitionintheRetina”.In:ProceedingsoftheRoyalSocietyofLondon.Series
B.BiologicalSciences216.1205(11/22/1982),pp.427–459.issn:0080-4649,2053-9193.doi:
10.1098/rspb.1982.0085. url: https://royalsocietypublishing.
org/doi/10.1098/rspb.1982.0085(visitedon12/23/2022).
[247] TobyStClereSmithe.“RadicallyCompositionalCognitiveConcepts”.11/14/2019.arXiv:
1911.06602[q-bio.NC].
[248] Toby St Clere Smithe. Bayesian Updates Compose Optically. 05/31/2020. arXiv: 2006.
01631[math.CT].preprint.
[249] TobyStClereSmithe.“CompositionalActiveInference”.In:FindingtheRightAbstractions.
ToposInstitute,05/12/2021.
[250] TobyStClereSmithe.CompositionalActiveInferenceI:BayesianLenses.StatisticalGames.
09/09/2021.arXiv:2109.04461[math.ST].preprint.
[251] TobyStClereSmithe.“CyberKittens,orSomeFirstStepsTowardsCategoricalCybernetics”.
In:ElectronicProceedingsinTheoreticalComputerScience.AppliedCategoryTheory2020.
Vol. 333. 02/08/2021, pp. 108–124. doi: 10.4204/EPTCS.333.8. url: http://
arxiv.org/abs/2101.10483v1(visitedon09/29/2023).
[252] Toby St Clere Smithe. “Polynomial Life: The Structure of Adaptive Systems”. In: Fourth
International Conference on Applied Category Theory (ACT 2021). Ed. by K. Kishida.
Vol.EPTCS370.2021,pp.133–147.doi:10.4204/EPTCS.370.28.
[253] TobyStClereSmithe.“CompositionalActiveInferenceII:PolynomialDynamics.Approxi-
mateInferenceDoctrines”.08/25/2022.arXiv:2208.12173[nlin.AO].
[254] Toby St Clere Smithe. “Open Dynamical Systems as Coalgebras for Polynomial Func-
tors, with Application to Predictive Processing”. 06/08/2022. arXiv: 2206.03868
[math.CT].
[255] TobyStClereSmitheandSimonMStringer.“TheRoleofIdiotheticSignals,Landmarks,and
ConjunctiveRepresentationsintheDevelopmentofPlaceandHead-DirectionCells:ASelf-
OrganizingNeuralNetworkModel”.In:CerebralCortexCommunications 3.1(01/01/2022),
tgab052. issn: 2632-7376. doi: 10.1093/texcom/tgab052. url: https://
325
academic.oup.com/cercorcomms/article/doi/10.1093/texcom/
tgab052/6358621(visitedon12/23/2022).
[256] KimberlyLStachenfeld,MatthewBotvinick,andSamuelJGershman.“DesignPrinciplesof
theHippocampalCognitiveMap”.In:AdvancesinNeuralInformationProcessingSystems
27.Ed.byZ.Ghahramanietal.CurranAssociates,Inc.,2014,pp.2528–2536.url:http:
//papers.nips.cc/paper/5340-design-principles-of-the-
hippocampal-cognitive-map.pdf.
[257] Kimberly Lauren Stachenfeld, Matthew M Botvinick, and Samuel J Gershman. “The
HippocampusasaPredictiveMap”.In:(12/2016).doi:10.1101/097170.url:http:
//dx.doi.org/10.1101/097170.
[258] SamStaton.“CommutativeSemanticsforProbabilisticProgramming”.In:Programming
LanguagesandSystems.SpringerBerlinHeidelberg,2017,pp.855–879.doi:10.1007/
978-3-662-54434-1_32.
[259] DarioMaxmilianStein.“StructuralFoundationsforProbabilisticProgrammingLanguages”.
UniversityofOxford,2021.url:https://dario-stein.de/notes/thesis.
pdf.
[260] ChristopherSummerfield,FabriceLuyckx,andHannahSheahan.“StructureLearningand
thePosteriorParietalCortex”.In:ProgressinNeurobiology (10/2019),p.101717.doi:10.
1016/j.pneurobio.2019.101717.
[261] Richard S Sutton and Andrew G Barto. Reinforcement Learning: An Introduction. 2nd ed.
Vol.1.1.MITpressCambridge,2018.
[262] DGowanlockRTervo,JoshuaBTenenbaum,andSamuelJGershman.“TowardtheNeural
ImplementationofStructureLearning”.In:CurrentOpinioninNeurobiology 37(04/2016),
pp. 99–105. issn: 0959-4388. doi: 10.1016/j.conb.2016.01.014. url: http:
//dx.doi.org/10.1016/j.conb.2016.01.014.
[263] Luke Tierney and Joseph B. Kadane. “Accurate Approximations for Posterior Moments
andMarginalDensities”.In:JournaloftheAmericanStatisticalAssociation81.393(03/1986),
pp.82–86.issn:0162-1459,1537-274X.doi:10.1080/01621459.1986.10478240.
url: http://www.tandfonline.com/doi/abs/10.1080/01621459.
1986.10478240(visitedon05/15/2023).
[264] AlexanderTschantz,AnilK.Seth,andChristopherL.Buckley.“LearningAction-Oriented
ModelsthroughActiveInference”.In:(09/2019).doi:10.1101/764969.
[265] KaiUeltzhöffer.“DeepActiveInference”.In:BiologicalCybernetics112.6(2017-09-07,2018-
10), pp. 547–573. doi: 10.1007/s00422-018-0785-7. arXiv: 1709.02341
[q-bio.NC].
326
[266] Dániel Unyi et al. Utility of Equivariant Message Passing in Cortical Mesh Segmentation.
06/15/2022. arXiv: 2206.03164 [cs]. url: http://arxiv.org/abs/2206.
03164(visitedon12/23/2022).preprint.
[267] AadW.vanderVaart.AsymptoticStatistics.1.paperbacked.,8.printing.CambridgeSeriesin
StatisticalandProbabilisticMathematics.Cambridge:CambridgeUniv.Press,2007.443pp.
isbn:978-0-521-78450-4978-0-521-49603-2.
[268] DmitryVagner,DavidI.Spivak,andEugeneLerman.“AlgebrasofOpenDynamicalSystems
ontheOperadofWiringDiagrams”.In:TheoryandApplicationsofCategories 30(2015),
PaperNo.51,1793–1822.issn:1201-561X.
[269] MatthijsVákár.SyntaxandSemanticsofLinearDependentTypes.01/16/2015.arXiv:1405.
0033 [cs, math]. url: http://arxiv.org/abs/1405.0033 (visited on
12/17/2022).preprint.
[270] MatthijsVákárandLukeOng.OnS-FiniteMeasuresandKernels.10/03/2018.arXiv:1810.
01837[math.PR].preprint.
[271] Frank van der Meulen. Introduction to Automatic Backward Filtering Forward Guiding.
10/31/2022. arXiv: 2203.04155 [math, stat]. url: http://arxiv.org/
abs/2203.04155(visitedon12/23/2022).preprint.
[272] FrankvanderMeulenandMoritzSchauer.AutomaticBackwardFilteringForwardGuiding
forMarkovProcessesandGraphicalModels.10/31/2022.arXiv:2010.03509[stat].
url:http://arxiv.org/abs/2010.03509(visitedon12/23/2022).preprint.
[273] CarlvanVreeswijkandHaimSompolinsky.“ChaosinNeuronalNetworkswithBalanced
ExcitatoryandInhibitoryActivity”.In:Science(NewYork,N.Y.)274.5293(1996),pp.1724–
1726. doi: 10.1126/science.274.5293.1724. pmid: 8939866. url: http:
//www.ncbi.nlm.nih.gov/pubmed/8939866.
[274] F.G.Varela,H.R.Maturana,andR.Uribe.“Autopoiesis:TheOrganizationofLivingSystems,
ItsCharacterizationandaModel”.In:GeorgeJ.Klir.FacetsofSystemsScience.Boston,MA:
SpringerUS,1991,pp.559–569.isbn:978-1-4899-0720-2978-1-4899-0718-9.doi:10.1007/
978-1-4899-0718-9_40.url:http://link.springer.com/10.1007/
978-1-4899-0718-9_40(visitedon12/23/2022).
[275] YdeVenema.“AutomataandFixedPointLogic:ACoalgebraicPerspective”.In:Information
andComputation204.4(04/2006),pp.637–678.doi:10.1016/j.ic.2005.06.003.
[276] Pietro Vertechi. “Dependent Optics”. In: Electronic Proceedings in Theoretical Computer
Science.AppliedCategoryTheory2022.Vol.380.08/07/2023,pp.128–144.doi:10.4204/
EPTCS.380.8.arXiv:2204.09547[math.CT].url:http://arxiv.org/
abs/2204.09547v4(visitedon09/29/2023).
327
[277] AndreVidelaandMatteoCapucci.LensesforComposableServers.03/29/2022.arXiv:2203.
15633 [cs]. url: http://arxiv.org/abs/2203.15633 (visited on
12/17/2022).preprint.
[278] JamesC.R.WhittingtonandRafalBogacz.“AnApproximationoftheErrorBackpropagation
Algorithm in a Predictive Coding Network with Local Hebbian Synaptic Plasticity”. In:
Neural Computation 29.5 (05/01/2017), pp. 1229–1262. issn: 0899-7667, 1530-888X. doi:
10.1162/NECO_a_00949. url: https://direct.mit.edu/neco/
article/29/5/1229/8261/An-Approximation-of-the-Error-
Backpropagation(visitedon12/23/2022).
[279] James C. R. Whittington et al. “The Tolman-Eichenbaum Machine: Unifying Space and
RelationalMemorythroughGeneralisationintheHippocampalFormation”.In:(09/2019).
doi: 10.1101/770495. eprint: https://www.biorxiv.org/content/
biorxiv/early/2019/09/24/770495.full-text.pdf.
[280] C.K.I.WilliamsandD.Barber.“BayesianClassificationwithGaussianProcesses”.In:IEEE
TransactionsonPatternAnalysisandMachineIntelligence 20.12(12/1998),pp.1342–1351.
issn:01628828.doi:10.1109/34.735807.url:http://ieeexplore.ieee.
org/document/735807/(visitedon05/15/2023).
[281] DanielWilliams.“IstheBrainanOrganforFreeEnergyMinimisation?”In:Philosophical
Studies 179.5 (05/2022), pp. 1693–1714. issn: 0031-8116, 1573-0883. doi: 10.1007/
s11098-021-01722-0. url: https://link.springer.com/10.1007/
s11098-021-01722-0(visitedon12/23/2022).
[282] DonaldYau.OperadsofWiringDiagrams.Vol.2192.LectureNotesinMathematics.Cham:
SpringerInternationalPublishing,2018.isbn:978-3-319-95000-6978-3-319-95001-3.doi:
10.1007/978-3-319-95001-3. arXiv: 1512.01602 [math]. url: http:
//link.springer.com/10.1007/978-3-319-95001-3 (visited on
09/11/2023).
[283] J.S.Yedidia,W.T.Freeman,andY.Weiss.“ConstructingFree-EnergyApproximationsand
GeneralizedBeliefPropagationAlgorithms”.In:IEEETransactionsonInformationTheory
51.7(07/2005),pp.2282–2312.issn:0018-9448.doi:10.1109/TIT.2005.850085.
url: http://ieeexplore.ieee.org/document/1459044/ (visited on
12/23/2022).
[284] ErnstZermelo.“ÜberEineAnwendungDerMengenlehreAufDieTheorieDesSchachspiels”.
In: Proceedings of the Fifth International Congress of Mathematicians. Vol. 2. Cambridge
UniversityPress,1913,pp.501–504.
[285] JieZhouetal.“GraphNeuralNetworks:AReviewofMethodsandApplications”.12/20/2018.
arXiv:1812.08434v4[cs.LG].
328