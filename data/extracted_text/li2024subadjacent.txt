arXiv:2408.01345v1  [math.RA]  2 Aug 2024
ON THE SUB-ADJACENT HOPF ALGEBRA OF THE UNIVERSAL ENVELOPIN G
ALGEBRA OF A POST -LIE ALGEBRA
YUNNAN LI
Abstract. Recently the notion of post-Hopf algebra was introduced, w ith the universal envelop-
ing algebra of a post-Lie algebra as the fundamental example . A novel property is that any
cocommutative post-Hopf algebra gives rise to a sub-adjace nt Hopf algebra with a generalized
Grossman-Larson product. By twisting the post-Hopf produc t, we provide a combinatorial an-
tipode formula for the sub-adjacent Hopf algebra of the univ ersal enveloping algebra of a post-
Lie algebra. Relating to such a sub-adjacent Hopf algebra, w e also obtain a closed inverse
formula for the Oudom-Guin isomorphism in the context of pos t-Lie algebras. Especially as a
byproduct, we derive a cancellation-free antipode formula for the Grossman-Larson Hopf alge-
bra of ordered trees through a concrete tree-grafting expre ssion.
Contents
1. Introduction 1
2. The universal enveloping algebra of a post-Lie algebra 4
2.1. Post-Hopf algebras and their basic properties 4
2.2. The universal enveloping algebra of a post-Lie algebra as a post-Hopf algebra 5
2.3. A combinatorial antipode formula for the sub-adjacent structure 7
3. Gavrilov’s K-map and the Oudom-Guin isomorphism 11
3.1. A closed inverse formula for the Oudom-Guin isomorphis m 13
4. The Grossman-Larson Hopf algebra of ordered trees 15
4.1. Basic terminology 15
4.2. A cancellation-free antipode formula for the Grossman -Larson Hopf algebra 17
References 19
1. I ntroduction
The notion of post-Lie algebra was introduced by V allette in his study of operad theory [ 46].
Such an algebraic structure has important applications in t he study of classical Y ang-Baxter
equation [ 3], geometric numerical integration [ 12, 13, 37], and plays an important role recently
in the theory of regularity structure and planarly branched rough path for solving SPDEs [ 6, 11].
A pre-Lie algebra as a post-Lie algebra in which the Lie algeb ra is abelian [ 8] has its historical
origin from algebraic deformation theory, geometry and phy sics; see [ 7, 32] for detail reviews.
Key words and phrases. post-Hopf algebra, post-Lie algebra, the Grossman-Larson Hopf algebra, ordered tree
2020 Mathematics Subject Classiﬁcation. 16T30, 17B35, 17D 25, 05C05.
1
2 YUNNAN LI
Since then the studies of the universal enveloping algebras of a pre-Lie algebra as well as a
post-Lie algebra have attracted many attentions. The remar kable work [ 39] of Oudom and Guin
deﬁned a functor from the category of pre-Lie algebras to tha t of Hopf algebras by extending
the pre-Lie product of a pre-Lie algebra to its universal env eloping algebra. In [ 15] Ebrahimi-
Fard, Lundervold and Munthe-Kaas further extended the Oudo m-Guin construction to post-
Lie algebras. Notably, they found a new Hopf algebra structu re assembled from the universal
enveloping algebra U( g) of a post-Lie algebra g. W e call it the sub-adjacent Hopf algebra of
U(g) and denote it by U( g)⊲. Recently, the Oudom-Guin construction has become a crucia l
tool in constructing combinatorial Hopf algebras used to de scribe rough paths and regularity
structures [ 6].
Also, a post-Lie algebra g has a sub-adjacent Lie algebra structure g⊲. A Hopf algebra iso-
morphism between the enveloping algebra U( g⊲) and the sub-adjacent Hopf algebra U( g)⊲was
given in [ 15], and later shown in [ 16] to be related to the factorization of classical r-matrices
on Lie algebras. W e call such an isomorphism the Oudom-Guin i somorphism in the context of
post-Lie algebras. Particularly, the inverse of the Oudom- Guin isomorphism for the free post-
Lie algebra over a magma algebra is identiﬁed with Gavrilov’ s K-map introduced in his study
[23] on covariant derivatives and the double exponential; see [ 1, 21] for details.
Recently the notion of post-Hopf algebra was introduced in [ 31] by the author, Sheng and
T ang, with the universal enveloping algebra of a post-Lie al gebra as the prototype. The study
of post-Hopf algebras was initiated from the innovative con cept of Rota-Baxter operators on
groups introduced in [ 27]. Goncharov succeeded in deﬁning Rota-Baxter operators on cocom-
mutative Hopf algebras in [ 24]. One motivation to propose post-Hopf algebra in [ 31] is to gen-
eralize Goncharov’s Rota-Baxter Hopf algebras. It also gen eralizes the notion of D-bialgebra
in [ 33] for the study of integration of post-Lie algebras, and is fu rther applied to obtain the
formal integration of connected complete post-Lie algebra s, namely an intrinsic post-group
structure [ 2]. Signiﬁcantly, any cocommutative post-Hopf algebra give s rise to a sub-adjacent
Hopf algebra with a generalized Grossman-Larsson product. As another crucial ingredient of
the Hopf algebra structure, the antipode map of the sub-adja cent Hopf algebra of the universal
enveloping algebra of a post-Lie algebra has interesting co mbinatorial property, so intrigues us
to study it from the perspective of post-Hopf algebra.
Under the profound impact of Rota and his collaborators on th e development of algebraic
combinatorics, extensive combinatorial Hopf algebras aro se over the last few decades, provid-
ing a powerful algebraic framework for analyzing and solvin g problems in high energy physics,
control theory, dynamical systems, and numerical integrat ion methods. In [ 25] Grossman and
Larson introduced a family of combinatorial Hopf algebras o f trees associated with data struc-
tures and used it to give a new proof of Cayley’s enumeration o f ﬁnite rooted trees. The con-
struction of the Grossman-Larson Hopf algebra was also moti vated by some concern about
diﬀerential operators and di ﬀerential equations, in particular the Runge-Kutta method i n nu-
merical analysis [ 26]. Note that the classical Grossman-Larson product deﬁned i n the context
of trees has important applications in the studies of Magnus expansions [ 9] and Lie-Butcher
series [ 37, 38].
THE SUB-ADJACENT STRUCTURE ON THE UNIVERSAL ENVELOP OF A POS T -LIE ALGEBRA 3
The Grossman-Larson Hopf algebra of trees has close relatio nship with many other com-
binatorial Hopf algebras from di ﬀerent application areas. For example, authors in [ 28], [ 40]
observed that the Grossman-Larson Hopf algebra of (non-pla nar) rooted trees is graded dual
to the Connes-Kreimer Hopf algebra arose from the study on re normalization in perturbative
quantum ﬁeld theory [ 10]. On the other hand, the Grossman-Larson Hopf algebra of ord ered
trees is graded dual to the Munthe-Kaas-Wright Hopf algebra of ordered forests deﬁned in the
framework of Lie groups acting on manifolds and Lie group int egrators [ 38].
In [ 5, §3.4] Berland and Owren reviewed the antipode of the Grossm an-Larson Hopf algebra
of ordered trees, and said that an explicit formula for it see ms hard to derive in general. When
basic operations of combinatorial objects only deﬁne bialg ebra structures, to obtain Hopf al-
gebra structures, one may appeal to T akeuchi’s celebrated r esult [ 45], which states that every
graded, connected bialgebra is a Hopf algebra with a univers al antipode formula. However, this
formula is given by an alternating sum usually involving a la rge number of cancellations, so is
not optimal for producing combinatorial identities among t he elements of the Hopf algebra. For
combinatorial Hopf algebras, it is more meaningful to write down a cancellation-free antipode
formula with a reduced expansion in terms of a combinatorial basis. Here we intend to provide
a cancellation-free antipode formula for the Grossman-Lar son Hopf algebra of ordered trees,
by serving it as the sub-adjacent Hopf algebra of the univers al enveloping algebra of the free
post-Lie algebra on one generator. Concrete examples verif y its e ﬃcience for computation.
So far there have been plenty of work developing cancellatio n-free antipode formulas for vari-
ous combinatorial Hopf algebras, including the Hopf algebr a of graphs [ 29], permutations [ 47],
set operads [ 35] and also several variations of quasisymmetric functions [ 4, 30, 41, 48], etc.
For combinatorial Hopf algebras in mathematical physics, w e mention the following works.
In [ 18, 19] Figueroa and Gracia-Bondia calculated the antipode of Kre imer’s Hopf algebra of
Feynman diagrams by the Zimmermann forest formula. In [ 34] Menous and Patras generalized
such a forest formula to compute the cancellation-free anti pode formula for arbitrary right-
handed polynomial Hopf algebras, graded dual to the univers al enveloping algebras of pre-Lie
algebras. Recently, Foissy obtained an explicit antipode f ormula for the Connes-Moscovici
Hopf algebra of trees from the point of view of Com-PreLie Hop f algebras [ 20].
The paper is organized as follows. In Section 2, we ﬁrst recall the notion of post-Hopf alge-
bra and basic properties of a cocommutative post-Hopf algeb ra, then turn to post-Lie algebras.
W e focus on the tensor Hopf algebra over a magma algebra, as th e universal enveloping alge-
bra of a free post-Lie algebra. By twisting the post-Hopf pro duct and then analyzing it, we
provide a combinatorial antipode formula for its sub-adjac ent Hopf algebra (Propositions 2.12
and 2.15). Next we prove that such a formula indeed works for the unive rsal enveloping al-
gebra of an arbitrary post-Lie algebra. (Theorem 2.17). In Section 3, we ﬁrst use the same
twisted product to describe Gavrilov’s K-map combinatorially (Proposition 3.2), then deduce
a closed inverse formula for the Oudom-Guin isomorphism in t he context of post-Lie algebras
(Theorem 3.5). In Section 4, we speciﬁcally ﬁgure out a cancellation-free antipode for mula
for the Grossman-Larson Hopf algebra of ordered trees (Theo rem 4.6) together with a concrete
tree-grafting interpretation of the corresponding twiste d post-Hopf product (Proposition 4.4).
4 YUNNAN LI
Convention. In this paper, we ﬁx an algebraically closed ground ﬁeld k of characteristic 0.
Denote [ n] = {1,..., n} for any positive integer n. All the objects under discussion, including
vector spaces, algebras and tensor products, are taken over k by default.
For any unital algebra ( A,m,u) with multiplication m and the unit map u : k → A, let
m(0) = id and for n ≥ 1 we write
m(n) = (m ⊗id⊗(n−1) ) ··· (m ⊗id)m.
For any coalgebra ( C,∆,ε), we compress the Sweedler notation of the comultiplicatio n ∆as
∆(x) = x1 ⊗ x2
for simplicity. Furthermore, let ∆(0) = id and for n ≥ 1 we write
∆(n) (x) = (∆⊗id⊗(n−1) ) ··· (∆⊗id)∆(x) = x1 ⊗···⊗ xn+1 .
By convention, a Hopf algebra is denoted by H = (H,·,1,∆,ε, S ). For other basic notions of
Hopf algebras, we follow the textbooks [
36].
2. T he universal enveloping algebra of a post-Liealgebra
First we recall the notion of post-Hopf algebra introduced i n [ 31]. The universal enveloping
algebra of a post-Lie algebra is naturally a cocommutative p ost-Hopf algebra, which gives rise
to a sub-adjacent Hopf algebra. W e will deal with the free pos t-Lie algebra over a magma
algebra to derive a combinatorial formula for the antipode o f the corresponding sub-adjacent
Hopf algebra, and then induce it to the general situation for an arbitrary post-Lie algebra.
2.1. Post-Hopf algebras and their basic properties.
Deﬁnition 2.1. A post-Hopf algebra is a pair ( H,⊲), where H is a Hopf algebra and ⊲:
H ⊗H → H is a coalgebra homomorphism satisfying the following equal ities:
x ⊲(y ·z) = (x1 ⊲y) ·(x2 ⊲z),(1)
x ⊲(y ⊲z) = ( x1 ·(x2 ⊲y)) ⊲z,(2)
for any x,y,z ∈ H, and the left multiplication α⊲: H → End(H) deﬁned by
α⊲,x y = x ⊲y, ∀x,y ∈ H,
is convolution invertible in Hom( H,End(H)). Namely, there exists unique β⊲ : H → End(H)
such that
(3) α⊲,x1 ◦β⊲,x2 = β⊲,x1 ◦α⊲,x2 = ε(x)idH , ∀x ∈ H.
Moreover, we have the following properties.
Lemma 2.2 ([
31, Lemma 2.4]) . Let (H,⊲) be a post-Hopf algebra. Then for all x ,y ∈ H, we
have
x ⊲1 = ε(x)1,(4)
1 ⊲x = x,(5)
S (x ⊲y) = x ⊲S (y).(6)
THE SUB-ADJACENT STRUCTURE ON THE UNIVERSAL ENVELOP OF A POS T -LIE ALGEBRA 5
Theorem 2.3 ([31, Theorem 2.5]) . Let (H,⊲) be a cocommutative post-Hopf algebra. Then
H⊲≔ (H,∗⊲,1,∆,ε, S ⊲)
is a Hopf algebra, which is called the sub-adjacent Hopf algebra , where for all x ,y ∈ H,
x ∗⊲y ≔ x1 ·(x2 ⊲y),(7)
S ⊲(x) ≔ β⊲,x1 (S (x2 )),(8)
Furthermore, H is a left H ⊲-module bialgebra via the action ⊲.
Remark 2.4. (i) The product ( 7) generalizes the Grossman-Larsson product [ 25, 38, 39] deﬁned
in the context of (noncommutative) polynomials of ordered t rees and widely applied to the study
of Magnus expansions [ 9] and Lie-Butcher series [ 37, 38].
(ii) Since β⊲is the convolution inverse of α⊲and
α⊲,x1 α⊲,S ⊲(x2 )
(2),(7)
= α⊲,x1 ∗⊲S ⊲(x2 ) = α⊲,ε(x)1
(5)
= ε(x)id,
we have β⊲,x = α⊲,S ⊲(x) . Namely, Eq. ( 8) is rewritten as
(9) S ⊲(x) = S ⊲(x1) ⊲S (x2), ∀x ∈ H.
2.2. The universal enveloping algebra of a post-Lie algebra as a p ost-Hopf algebra. Recall
from [ 46] that a post-Lie algebra (g,[·,·]g,⊲) consists of a Lie algebra ( g,[·,·]g) and a binary
product ⊲: g⊗g → g such that
x ⊲[y,z]g = [x ⊲y,z]g +[y,x ⊲z]g,(10)
([x,y]g + x ⊲y −y ⊲x) ⊲z = x ⊲(y ⊲z) −y ⊲(x ⊲z).(11)
When ( g,[·,·]g) is abelian, ( g,[·,·]g,⊲) is a pre-Lie algebra . Any post-Lie algebra ( g,[·,·]g,⊲)
has a sub-adjacent Lie algebra g⊲:= (g,[·,·]g⊲) deﬁned by
(12) [ x,y]g⊲ ≔ x ⊲y −y ⊲x +[x,y]g, ∀x,y ∈ g.
The universal enveloping algebras of a pre-Lie algebra and a lso of a post-Lie algebra were
successively studied in [ 39, 15]. By [ 15, Proposition 3.1, Theorem 3.4], the binary product ⊲in
a post-Lie algebra ( g,[·,·]g,⊲) can be extended to its universal enveloping algebra and ind uces
a sub-adjacent Hopf algebra U( g)⊲, which is naturally isomorphic to the universal enveloping
algebra U( g⊲) of the sub-adjacent Lie algebra g⊲ by the Milnor-Moore structure theorem for
connected cocommutative Hopf algebras.
W e summarize the aforementioned result in the setting of pos t-Hopf algebras as follows.
Theorem 2.5 ([15, 39]). Let (g,[·,·]g,⊲) be a post-Lie algebra associated with the sub-adjacent
Lie algebra g⊲. Then (U(g),⊲) is a post-Hopf algebra with the product ⊲recursively deﬁned by
x ⊲1 = 0, x ⊲x1 ··· xr =
r∑
i=1
x1 ··· (x ⊲xi ) ··· xr ,
1 ⊲u = u, x1 ··· xr ⊲u = x1 ⊲(x2 ··· xr ⊲u) −(x1 ⊲x2 ··· xr ) ⊲u
for all x ,x1 ,..., xr ∈ gand u ∈ U(g) with r ≥ 1.
6 YUNNAN LI
Moreover , there is a Hopf algebra isomorphism φ : U( g⊲) → U(g)⊲deﬁned by
φ(x1 ··· xr ) = x1 ∗⊲···∗ ⊲xr , ∀x1 ,..., xr ∈ g.
W e call φ the Oudom-Guin isomorphism .
Remark 2.6. The theory of classical r-matrices provides a rich source of examples of post-Lie
algebras. A linear operator R on Lie algebra ( g,[·,·]g) is called a classical r-matrix on g, if
[x,y]R ≔ 1
2 ([Rx,y] +[x,Ry]), ∀x,y ∈ g
deﬁnes another Lie bracket on g. Then such a pair ( g,R) is called a double Lie algebra [43],
and naturally produces a post-Lie algebra ( g,⊲) such that the sub-adjacent Lie algebra g⊲ is
equal to gR = (g,[·,·]R) [ 3]. Correspondingly, the authors in [ 16] showed that the Oudom-Guin
isomorphism φ : U( g⊲) → U(g)⊲coincides with the linear isomorphism F : U( gR ) → U(g) in
[42] arose from the factorization of classical r-matrix R.
The above extension from ( g,⊲) to (U( g),⊲) can be realized ﬁrst on the tensor algebra T(g),
then induced to the quotient U( g). Especially the universal enveloping algebra of the free p ost-
Lie algebra over a magma algebra is explicitly constructed b y Foissy in [ 21] as follows.
Theorem 2.7 ([31, Theorem 2.9]) . Let (V,⊲) be a magma algebra. Extend the magma operation
⊲: V ⊗V → V on the vector space V to the coshu ﬄe Hopf algebra (T(V ),·,∆
/A1
,S ) (using the
same notation ⊲) as follows:
1 ⊲a = a,
x ⊲a = x ⊲a,
(x ⊗ x1) ⊲a = x ⊲(x1 ⊲a) −(x ⊲x1) ⊲a,
.
.
.
(x ⊗ x1 ⊗···⊗ xn) ⊲a = x ⊲( (x1 ⊗···⊗ xn ) ⊲a)
−
n∑
i=1
( x1 ⊗···⊗ xi−1 ⊗(x ⊲xi ) ⊗ xi+1 ⊗···⊗ xn
) ⊲a,
and
1 ⊲1 = 1,
x ⊲1 = 0,
X ⊲(a1 ⊗···⊗ am) = (X1 ⊲a1 ) ⊗···⊗ (Xm ⊲am),
where x ,x1 ,..., xn,a,a1,..., am ∈ V and X ∈ T(V ), ∆(m−1)
/A1
(X) = X1 ⊗ ··· ⊗ Xm . Then the
quintuple (T(V ),·,∆
/A1
,S ,⊲) is the universal enveloping algebra of the free post-Lie alg ebra
over the magma algebra (V,⊲), thus a post-Hopf algebra.
Convention. From now on, we call an element in V a letter, and write any pure tensor in T(V )
as a monomial with the tensor product ⊗ omitted for simplicity, so call it a word.
THE SUB-ADJACENT STRUCTURE ON THE UNIVERSAL ENVELOP OF A POS T -LIE ALGEBRA 7
2.3. A combinatorial antipode formula for the sub-adjacent stru cture. Consider the sub-
adjacent Hopf algebra
T(V )⊲= (T(V ),∗⊲,∆
/A1
,S ⊲)
of the post-Hopf algebra ( T(V ),·,∆
/A1
,S ,⊲) introduced in Theorem 2.7. Recall that the coshu ﬄe
coproduct ∆
/A1
is deﬁned by ∆
/A1
(x) = x ⊗1 +1 ⊗ x for any x ∈ V and the antipode S is given by
(13) S (x1 x2 ··· xm) = (−1)m xm xm−1 ··· x1, ∀x1 ,x2,..., xm ∈ V.
For the antipode S ⊲of the sub-adjacent Hopf algebra T(V )⊲, we give our ﬁrst result.
Theorem 2.8. F or any word X ∈ T(V ) with at most m letters in V (m ≥ 1),
(14) S ⊲(X) = (··· (S (X1 ) ⊲S (X2)) ⊲··· ) ⊲S (Xm).
Proof. First note that S ⊲(x) = S (x) = −x for any x ∈ V . So it is done for m = 1. When m > 1,
we can repeatedly apply Eq. ( 9) m −1 times to obtain that
S ⊲(X) = (··· (S ⊲(X1 ) ⊲S (X2)) ⊲··· ) ⊲S (Xm ).
Since X has at most m letters, any term in the iterated coproduct ∆(m−1)
/A1
(X) = X1 ⊗···⊗ Xm has all
tensor factors from V or at least one tensor factor from k. Then by Eq. ( 4), the leftmost tensor
factor X1 should be from k or V to make the term survive in the right-hand side of the above
equality. Hence, we get the desired formula for the antipode S ⊲of T(V )⊲. □
Example 2.9. Using Eq. ( 14), one can easily calculate S ⊲(x1 ··· xm) with x1,..., xm ∈ V for
small m. W e compute the results for m = 2,3 as a warm-up.
S ⊲(x1 x2) = S (x1 x2 ) +S (x1) ⊲S (x2) +S (x2) ⊲S (x1)
= x2 x1 + x1 ⊲x2 + x2 ⊲x1,
S ⊲(x1 x2 x3) = S (x1 x2 x3 ) +S (x1 ) ⊲S (x2 x3) +S (x2) ⊲S (x1 x3) +S (x3) ⊲S (x1 x2 )
+S ⊲(x1 x2 ) ⊲S (x3) +S ⊲(x1 x3) ⊲S (x2) +S ⊲(x2 x3 ) ⊲S (x1)
(2)
= −x3 x2 x1 −(x1 ⊲x3 )x2 − x3 (x1 ⊲x2 )
−(x2 ⊲x3)x1 − x3(x2 ⊲x1) −(x3 ⊲x2)x1 − x2(x3 ⊲x1 )
−(x1 ⊲x2) ⊲x3 − x2 ⊲(x1 ⊲x3 ) −(x1 ⊲x3) ⊲x2
−x3 ⊲(x1 ⊲x2 ) −(x2 ⊲x3) ⊲x1 − x3 ⊲(x2 ⊲x1 ).
Inspired by Eq. ( 9), we introduce the following product twisting the post-Hop f product ⊲by
the antipode S ⊲, which is a crucial tool for our study below .
Deﬁnition 2.10. Deﬁne a binary product ◮on T(V ) as follows,
(15) X ◮Y ≔ (−1)|X|β⊲,X Y = (−1)|X|S ⊲(X) ⊲Y
for any words X, Y ∈ T(V ), with |X|as the number of letters in X, i.e. its natural degree in T(V ).
8 YUNNAN LI
As we will see in Lemma 2.13, the sign ( −1)|X| in Eq. ( 15) is indispensable for the computa-
tion to avoid cancellations. Since the antipode S ⊲is a coalgebra endomorphism of the graded
coalgebra T(V ), Eq.( 1) implies that
X ◮Y Z = (X1 ◮Y )(X2 ◮Z)
for any words X,Y,Z ∈ T(V ). Correspondingly,
(16) X ◮Y = (X1 ◮y1 ) ··· (Xn ◮yn),
when Y = y1 ··· yn with y1,..., yn ∈ V .
Remark 2.11. For any words X,Y,Z ∈ T(V ), we have
X ◮(Y ◮Z)
(15)
= (−1)|X|+|Y |S ⊲(X) ⊲(S ⊲(Y ) ⊲Z)
(2),(7)
= (−1)|X|+|Y |(S ⊲(X) ∗⊲S ⊲(Y )) ⊲Z
= (−1)|X|+|Y |S ⊲(Y ∗⊲X) ⊲Z
(7)
= (−1)|X|+|Y1 |+|Y2 |S ⊲(Y1 (Y2 ⊲X)) ⊲Z
(15)
= (−1)|Y2 |Y1 (Y2 ⊲X) ◮Z.
Deﬁne a new product ∗◮on T(V ) by letting X ∗◮Y = (−1)|Y2 |Y1 (Y2 ⊲X). Then one can check
that T(V )◮= (T(V ),∗◮,∆
/A1
) is a Hopf algebra such that T(V ) is a module bialgebra over T(V )◮
via the action ◮. Since this property is not used in the paper, we will not disc uss it further.
Proposition 2.12. The following formula holds for the antipode S ⊲of T(V )⊲,
(17) S ⊲(x1 ··· xm) = (−1)m
∑
π
(xB1 ◮xb1 ) ··· (xB|π|−1 ◮xb|π|−1 ), ∀x1 ,..., xm ∈ V,
where the sum ranges over all partitions π of [m] into a tuple (B1,..., B|π|) of possibly empty
subsets such that B |π| = {b1 > ··· > b|π|−1 }. Also, we use the notation x I = xi1 ··· xir ∈ T(V ) for
any I = {i1 < ··· < ir } ⊆ [m]. In particular , x ∅ = 1.
Proof. First recall the iterated coshu ﬄe coproduct on T(V ). That is,
∆(r−1)
/A1
(x1 ··· xm) =
∑
π:|π|=r
xB1 ⊗···⊗ xBr
for any r ≥ 1, where the sum ranges over all partitions π of [ m] into a tuple ( B1,..., Br ) of r
possibly empty subsets.
Write X = x1 ··· xm, m ≥ 1, for short. For any word Y in T(V ), let Y op be its reverse. Then
S ⊲(X)
(9)
=
∑
π:|π|=2
S ⊲(xB1 ) ⊲S (xB2 )
(4),(13)
=
∑
π:|π|=2,B2/nequal∅
(−1)|B2 |S ⊲(xB1 ) ⊲xop
B2
(15)
= (−1)m
∑
π:|π|=2,B2/nequal∅
xB1 ◮xop
B2
THE SUB-ADJACENT STRUCTURE ON THE UNIVERSAL ENVELOP OF A POS T -LIE ALGEBRA 9
(16)
= (−1)m
∑
π
(xB1 ◮xb1 ) ··· (xB|π|−1 ◮xb|π|−1 ),
where the sum in the last equality ranges over all partitions πof [ m] under the stated condition.
Note that each term ( xB1 ◮xb1 ) ··· (xB|π|−1 ◮xb|π|−1 ) is a homogeneous polynomial in T(V ) of
degree |π|− 1. □
In order to apply Eq. ( 17) for concrete computation, we still need an explicit combin atorial
formula for the product ◮on T(V ). First we give the following key lemma.
Lemma 2.13. F or any letters x 1 ,..., xm ∈ V with m ≥ 2 and word Y ∈ T(V ), the following
recursive formula holds,
(18) x1 ··· xm ◮Y = x2 ··· xm ◮(x1 ⊲Y ) +
m∑
i=2
x2 ··· (x1 ⊲xi ) ··· xm ◮Y.
Proof. W e obtain the stated recursive formula as follows,
x1 ··· xm ◮Y
(
15)
= (−1)mS ⊲(x1 ··· xm ) ⊲Y
(7)
= (−1)mS ⊲(x1 ∗⊲(x2 ··· xm) − x1 ⊲(x2 ··· xm)) ⊲Y
(1)
= (−1)m(S ⊲(x2 ··· xm) ∗⊲S ⊲(x1 )) ⊲Y +(−1)m+1 S ⊲







m∑
i=2
x2 ··· (x1 ⊲xi) ··· xm






⊲Y
(
2),(7)
= (−1)mS ⊲(x2 ··· xm ) ⊲(S ⊲(x1 ) ⊲Y ) +(−1)m+1
m∑
i=2
S ⊲(x2 ··· (x1 ⊲xi ) ··· xm) ⊲Y
(13),(15)
= x2 ··· xm ◮(x1 ⊲Y ) +
m∑
i=2
x2 ··· (x1 ⊲xi ) ··· xm ◮Y. □
Deﬁnition 2.14. For any letters x1,..., xm ∈ V , word Y ∈ T(V ) and permutation w ∈ S m (with
one-word notation), we deﬁne a speciﬁc element
[x1 ,..., xm; Y ]w
in T(V ) by the following steps,
(i) Begin with the series xw(1) ··· xw(m) Y . First use a pair of parentheses to enclose x1 and
its right adjacent letter xw(w−1 (1)+1) or right adjacent word Y , then use the product ⊲to
merge them.
(ii) Next enclose the letter involving x2 and its right adjacent letter, or right adjacent word
involving Y by a pair of parentheses, and then use the product ⊲to merge them.
(iii) Iteratively carry on such a procedure for letters invo lving x3 ,..., xm successively, until
there have been m −1 pairs of parentheses and m symbols ⊲inserted. The so-obtained
element in T(V ) is [ x1 ,..., xm; Y ]w.
For example, we can obtain [ x1,..., x6; Y ]256314 as follows,
x2 x5 x6 x3 x1 x4 Y
(i)
⇝ x2 x5 x6 x3 (x1 ⊲x4 ) Y
10 YUNNAN LI
(ii)
⇝ (x2 ⊲x5 ) x6 x3 (x1 ⊲x4) Y
(iii)
⇝ (x2 ⊲x5 ) x6 (x3 ⊲(x1 ⊲x4 )) Y
⇝ (x2 ⊲x5 ) x6 ((x3 ⊲(x1 ⊲x4)) ⊲Y )
⇝ ((x2 ⊲x5) ⊲x6 ) (( x3 ⊲(x1 ⊲x4)) ⊲Y )
⇝ ((x2 ⊲x5) ⊲x6 ) ⊲((x3 ⊲(x1 ⊲x4 )) ⊲Y )
= [x1 ,..., x6; Y ]256314.
Now we are in the position to give the following combinatoria l formula.
Proposition 2.15. F or any letters x 1 ,..., xm ∈ V and word Y ∈ T(V ),
(19) x1 ··· xm ◮Y =
∑
w∈S m
[x1 ,..., xm; Y ]w.
Proof. Abbreviate ∑
w∈S m [x1 ,..., xm; Y ]w as {x1,..., xm; Y }. When m = 1, we clearly have
x1 ◮Y = {x1; Y } = x1 ⊲Y
by deﬁnition. For m ≥ 2,
{x1,..., xm; Y } =
∑
w∈S m
w(m)=1
[x1 ,..., xm; Y ]w +
m−1∑
i=1
∑
w∈S m
w(i)=1
[x1 ,..., xm; Y ]w
=
∑
σ∈S m−1
[x2 ,..., xm; x1 ⊲Y ]σ
+
m∑
j=2
∑
σ∈S m−1
[x2,..., x j−1 ,x1 ⊲x j ,x j+1,..., xm; Y ]σ
= {x2,..., xm; x1 ⊲Y }+
m∑
j=2
{x2 ,..., x j−1,x1 ⊲x j ,x j+1 ,..., xm; Y },
where the second equality is due to the following fact. For an y i ∈ [m − 1] and w ∈ S m with
w(i) = 1, there exists a unique σ ∈ S m−1 such that
σ(k) =







w(k) −1, 1 ≤ k < i,
w(k +1) −1, i ≤ k ≤ m −1,
and then [ x1,..., xm; Y ]w = [x2 ,..., x j−1,x1 ⊲x j ,x j+1 ,..., xm; Y ]σ for j = w(i + 1) by Deﬁni-
tion
2.14. Hence, {x1,..., xm; Y } satisﬁes the same recursive formula as x1 ··· xm ◮Y does in
Eq. ( 18), and the stated equality ( 19) holds. □
Next we generalize the antipode formula ( 17) to make it applicable for the universal envelop-
ing algebra of an arbitrary post-Lie algebra, not just the fr ee object over a magma algebra.
Proposition 2.16. Given a post-Lie algebra (g,[·,·]g,⊲), the product ◮on T(g) deﬁned as in
Eq. (15) can be induced on the universal enveloping algebra U(g) of g.
THE SUB-ADJACENT STRUCTURE ON THE UNIVERSAL ENVELOP OF A POS T -LIE ALGEBRA 11
Proof. Let J = (xy −yx −[x,y]g |x,y ∈ g) be the Hopf ideal of T(g) such that U( g) = T(g)/J.
Since the post-Lie product ⊲on g has been extended to U( g), we should have T(g) ◮J ⊆ J by
Eq. ( 15). It remains to show that J ◮T(g) = 0, then we obtain the induced product ◮on U( g).
Indeed, for any letters x,y ∈ g and words X,Y,Z ∈ T(g), we ﬁrst check that
(xy −yx −[x,y]g)Y ◮Z
(18)
= yY ◮(x ⊲Z) +(x ⊲y)Y ◮Z +y(x ⊲Y ) ◮Z
−xY ◮(y ⊲Z) −(y ⊲x)Y ◮Z − x(y ⊲Y ) ◮Z
−Y ◮([x,y]g ⊲Z) −([x,y]g ⊲Y ) ◮Z
(18)
= Y ◮(y ⊲(x ⊲Z)) +(y ⊲Y ) ◮(x ⊲Z) +Y ◮((x ⊲y) ⊲Z)
+((x ⊲y) ⊲Y ) ◮Z +(x ⊲Y ) ◮(y ⊲Z) +(y ⊲(x ⊲Y )) ◮Z
−Y ◮(x ⊲(y ⊲Z)) −(x ⊲Y ) ◮(y ⊲Z) −Y ◮((y ⊲x) ⊲Z)
−((y ⊲x) ⊲Y ) ◮Z −(y ⊲Y ) ◮(x ⊲Z) −(x ⊲(y ⊲Y )) ◮Z
−Y ◮([x,y]g ⊲Z) −([x,y]g ⊲Y ) ◮Z
= Y ◮(y ⊲(x ⊲Z) − x ⊲(y ⊲Z) +(x ⊲y −y ⊲x −[x,y]g) ⊲Z)
+((x ⊲y −y ⊲x −[x,y]g) ⊲Y +y ⊲(x ⊲Y ) − x ⊲(y ⊲Y )) ◮Z
(1),(11)
= Y ◮0 +0 ◮Z = 0.
For the generic case X(xy −yx −[x,y]g)Y ◮Z, one can iteratively apply Eqs. ( 10) and ( 18) |X|
times to reduce it to the previous situation, so that X(xy −yx −[x,y]g)Y ◮Z = 0. □
According to Propositions 2.12 and 2.16, we immediately have
Theorem 2.17. Given a post-Lie algebra (g,[·,·]g,⊲), the antipode S ⊲of the sub-adjacent Hopf
algebra U(g)⊲as a quotient of T(g)⊲is given by
(20) S ⊲(x1 ··· xm ) = (−1)m
∑
π
(xB1 ◮xb1 ) ··· (xB|π|−1 ◮xb|π|−1 ), ∀x1 ,..., xm ∈ g,
where the sum ranges over all partitions π of [m] into a tuple (B1,..., B|π|) of possibly empty
subsets such that B |π| = {b1 > ··· > b|π|−1 }. Also, x I ≔ xi1 ··· xir ∈ U(g) for any I = {i1 < ··· <
ir } ⊆ [m]. In particular , x ∅ = 1.
Remark 2.18. For any pre-Lie algebra ( g,⊲), U( g) is the symmetric algebra S (g) over g, and the
antipode formula ( 20) works for the sub-adjacent Hopf algebra S (g)⊲. W e take it as the graded-
dual formula of that for right-handed polynomial Hopf algeb ras given in [ 34, Theorem 8].
3. G avrilov’ s K-map and theOudom-Guin isomorphism
In [ 23] A. V . Gavrilov introduced the so-called K-map, which is crucial for building higher-
order covariant derivatives on a smooth manifold endowed wi th an a ﬃne connection (see also [ 22]
and references therein).
12 YUNNAN LI
From a post-Lie algebra point of view given in [ 1], Gavrilov’s K-map relates the two Hopf
algebra structures on the universal enveloping algebra of a free post-Lie algebra over a magma
algebra. W e restate this result as follows.
Proposition 3.1 ([
1, Theorem 3], [ 22, Prop. 1]) . F or the post-Hopf algebra (T(V ),·,∆
/A1
,⊲)
given in Theorem 2.7, there exists a Hopf algebra isomorphism K : T(V )⊲ → T(V ) called the
K-map and recursively deﬁned by
(21) K(x) = x and K (x1 ··· xn ) = x1 K(x2 ··· xn) −
n∑
i=2
K(x2 ··· xi−1 (x1 ⊲xi )xi+1 ··· xn)
for any x ,x1 ,..., xn ∈ V .
The closed formula for the inverse K−1 : T(V ) → T(V )⊲is given as follows (see [ 1, Prop. 6]).
(22) K−1 (x1 ··· xn) = x1 ∗⊲···∗ ⊲xn =
∑
π
x⊲
B1 ··· x⊲
B|π|, ∀x1 ,..., xn ∈ V,
where the sum ranges over all set partitions π = (B1,..., B|π|) of [ n] with blocks B1,..., B|π|
satisfying max B1 < ··· < max B|π|, and x⊲
I ≔ xi1 ⊲(xi2 ⊲··· (xir−1 ⊲xir ) ··· ) ∈ V for any
I = {i1 < ··· < ir } ⊆ [n].
However, as pointed out in [ 1], the recursive expression ( 21) does not deliver easily a closed
formula for the K-map K itself. Gavrilov tackled the problem from another angle in [ 23], by
solving a ﬁrst-order linear di ﬀerential equation. Here we utilize the twisted product ◮in Eq. ( 15)
to present a closed formula for K combinatorially.
Proposition 3.2. The K-map K : T(V )⊲→ T(V ) is given by
(23) K(x1 ··· xn ) =
∑
π
(−1)n−|π|x◮
B1 ··· x◮
B|π|, ∀x1 ,..., xn ∈ V,
where the sum ranges over all set partitions π = (B1,..., B|π|) of [n] with blocks B 1,..., B|π|
satisfying max B1 < ··· < max B|π|, and
x◮
I ≔ xi1 ··· xir−1 ◮xir
(19)
=
∑
w∈S r−1
[xi1 ,..., xir−1 ; xir ]w ∈ V
for any I = {i1 < ··· < ir } ⊆ [n], with the convention that x ◮
{i} = xi , ∀i ∈ [n].
Proof. Let R(x1 ··· xn ) be the RHS of Eq. (
23), and we prove this equality by induction on n.
When n = 1 we clearly have K(x1 ) = R(x1 ) = x1. For n ≥ 2, let π = (B1,..., B|π|) be any set
partition of [ n] satisfying the stated condition. Then B1 = {1}, or otherwise 1 ∈ Bk for some
block Bk such that |Bk | ≥ 2, and then Eq. ( 18) implies that
x◮
Bk = xi1 ··· xir−1 ◮xir = xi2 ··· xir−1 ◮(x1 ⊲xir ) +
r−1∑
j=2
xi2 ··· (x1 ⊲xi j ) ··· xir−1 ◮xir , (∗)
if Bk = {1 = i1 < i2 < ··· < ir }. Hence, we have
R(x1 ··· xn ) =
∑
π
(−1)n−|π|x◮
B1 ··· x◮
B|π|
THE SUB-ADJACENT STRUCTURE ON THE UNIVERSAL ENVELOP OF A POS T -LIE ALGEBRA 13
= x1
∑
π: B1={1}
(−1)n−|π|x◮
B2 ··· x◮
B|π| −
∑
π: B1/nequal{1}
(−1)n−1−|π|x◮
B1 ··· x◮
B|π|
(∗)
= x1R(x2 ··· xn ) −
n∑
i=2
R(x2 ··· xi−1 (x1 ⊲xi )xi+1 ··· xn)
= x1 K(x2 ··· xn) −
n∑
i=2
K(x2 ··· xi−1 (x1 ⊲xi)xi+1 ··· xn )
(21)
= K(x1 ··· xn ),
where the fourth equality is due to the induction hypothesis . □
Since the K-map K is a Hopf algebra isomorphism from T(V )⊲to T(V ), we can also compute
the antipode S ⊲on T (V )⊲via the equality
S ⊲(x1 ··· xn) = K−1 (S (K(x1 ··· xn))), ∀x1 ,..., xn ∈ V.
Note that the calculation involves no cancellation when one applies Eqs. ( 23), ( 13) and ( 22)
successively, and all monomials in K−1 (S (K(x1 ··· xn))) have integer coe ﬃcients of the same
sign ( −1)n . However, such an approach is somewhat oblique.
Example 3.3. W e compute the case when n = 3. There are 5 set partitions of [3], namely 123,
1|23, 12 |3, 2 |13, 1 |2|3, and
S ⊲(x1 x2 x3 ) = K−1 (S (K(x1 x2 x3 )))
(23)
= K−1 (S (x◮
1 x◮
2 x◮
3 − x◮
1 x◮
23 − x◮
12 x◮
3 − x◮
2 x◮
13 + x◮
123 ))
(
19)
= K−1 (S (x1 x2 x3 − x1 (x2 ⊲x3 ) −(x1 ⊲x2)x3 − x2(x1 ⊲x3) +(x1 ⊲x2 ) ⊲x3 + x2 ⊲(x1 ⊲x3)))
(13)
= −K−1 (x3 x2 x1 +(x2 ⊲x3 )x1 + x3 (x1 ⊲x2 ) +(x1 ⊲x3)x2 +(x1 ⊲x2 ) ⊲x3 + x2 ⊲(x1 ⊲x3 ))
(22)
= −x3 x2 x1 −(x3 ⊲x2)x1 − x3(x2 ⊲x1) − x2 (x3 ⊲x1 ) −(x2 ⊲x3)x1 − x3(x1 ⊲x2) −(x1 ⊲x3)x2
−x3 ⊲(x2 ⊲x1) −(x2 ⊲x3 ) ⊲x1 − x3 ⊲(x1 ⊲x2) −(x1 ⊲x3 ) ⊲x2 −(x1 ⊲x2 ) ⊲x3 − x2 ⊲(x1 ⊲x3).
So we get the same result as in Example 2.9.
3.1. A closed inverse formula for the Oudom-Guin isomorphism. Given a post-Lie algebra
(g,[·,·]g,⊲), the Oudom-Guin isomorphism φ : U( g⊲) → U(g)⊲in Theorem 2.5 is the unique
extension of the identity map id : g⊲ → g, and has exactly the same combinatorial expression
as K−1 : T(g) → T(g)⊲in ( 22) (see [ 16, Eq. (18)]). In fact, we have
Proposition 3.4. F or a post-Lie algebra (g,[·,·]g,⊲), the inverse K −1 : T(g) → T(g)⊲induces
the Oudom-Guin isomorphism φ : U( g⊲) → U(g)⊲,
Proof. Let J = (xy − yx − [x,y]g |x,y ∈ g) and J⊲ = (xy − yx − [x,y]g⊲|x,y ∈ g) be the Hopf
ideals of T(g) such that U( g) = T(g)/J and U( g⊲) = T(g)/J⊲respectively.
W e only need to show that K−1 (J⊲) ⊆ J. For any letters x,y ∈ gand words X,Y ∈ T(g),
K−1 (xy −yx −[x,y]g⊲)
(22)
= x ∗⊲y −y ∗⊲x −[x,y]g⊲
14 YUNNAN LI
(7),(12)
= (xy + x ⊲y) −(yx +y ⊲x) −(x ⊲y −y ⊲x +[x,y]g)
= xy −yx −[x,y]g,
and then
K−1 (X(xy −yx −[x,y]g⊲)Y ) = K−1 (X) ∗⊲K−1 (xy −yx −[x,y]g⊲) ∗⊲K−1 (Y )
= K−1 (X) ∗⊲(xy −yx −[x,y]g) ∗⊲K−1 (Y ) ∈ J,
as we have known that J is a Hopf ideal of T(V )⊲. Since φis invertible, K−1 (J⊲) = J indeed. □
Correspondingly, we obtain a closed inverse formula for the Oudom-Guin isomorphism φ.
Theorem 3.5. The inverse φ−1 : U( g)⊲→ U(g⊲) of the Oudom-Guin isomorphism is given by
(24) φ−1(x1 ··· xn ) =
∑
π
(−1)n−|π|[xB1 ] ··· [xB|π|], ∀x1 ,..., xn ∈ g,
where the sum ranges over all set partitions π = (B1,..., B|π|) of [n] with blocks B 1,..., B|π|
satisfying max B1 < ··· < max B|π|, and [xI ] ≔ ∑
w∈S r−1 [xi1 ,..., xir−1 ; xir ]w ∈ g for any I = {i1 <
··· < ir } ⊆ [n], with the convention that [x{i}] = xi , ∀i ∈ [n].
Proof. According to Proposition 3.4, the closed formula ( 23) for the K-map K is also available
for φ−1, but we need to add the following comment on it.
In general, the product ◮on T(g) can not be induced on U( g⊲), which is di ﬀerent from the
situation of U( g) in Proposition 2.16. Therefore, any element x◮
Bi
in ( 23) should be interpreted
by the combinatorial characterization ( 19) directly, and we rewrite it as [ xBi ]. □
Remark 3.6. Recall the Bell polynomial (see [ 14] for details)
Bn,k (x1 ,..., xl) =
∑
j1 +j2 +···+jl =k
j1 +2 j2 +···+l j l =n
n!
j1! ··· jl!
( x1
1!
) j1
···
( xl
l!
) jl
with l = n −k +1, the coe ﬃcient of x j1
1 ··· x jl
l in which is equal to the number of set partitions
of [ n] with jr blocks of size r for any r ∈ [l]. In particular,
Bn,k (0!,1!,..., (l −1)!) =
∑
j1 +j2 +···+jl =k
j1 +2 j2 +···+l j l =n
n!
j1! ··· jl !1 j1 ··· l jl
,
exactly the number of permutations in S n with a factorization into k disjoint cycles.
Hence, the number of terms of φ−1(x1 ··· xn ) when expanded as in Eq. ( 24) is
n∑
k=1
Bn,k (0!,1!,..., (l −1)!) = n!,
Actually, it can also be seen directly by induction on n from the recursive formula ( 21).
Example 3.7. There are 15 set partitions of [4] listed as follows,
1|2|3|4, 12|3|4, 2|13|4, 2|3|14, 1|23|4, 1|3|24, 1|2|34,
12|34, 13|24, 23|14, 1|234, 2|134, 3|124, 123|4, 1234.
THE SUB-ADJACENT STRUCTURE ON THE UNIVERSAL ENVELOP OF A POS T -LIE ALGEBRA 15
Then Eq. ( 24) shows that the expansion of φ−1(x1 x2 x3 x4 ) has 4! = 24 terms as follows,
φ−1(x1 x2 x3 x4 ) = [x1 ][x2][x3 ][x4 ]
−[x12 ][x3 ][x4 ] −[x2][x13 ][x4 ] −[x2 ][x3 ][x14 ] −[x1 ][x23 ][x4 ] −[x1][x3 ][x24 ] −[x1 ][x2 ][x34 ]
+[x12 ][x34 ] +[x13 ][x24 ] +[x23 ][x14 ] +[x1 ][x234 ] +[x2][x134 ] +[x3][x124 ] +[x123 ][x4 ] −[x1234 ]
= x1 x2 x3 x4 −(x1 ⊲x2)x3 x4 − x2 (x1 ⊲x3 )x4 − x2 x3(x1 ⊲x4)
− x1 (x2 ⊲x3 )x4 − x1 x3(x2 ⊲x4) − x1 x2(x3 ⊲x4 )
+(x1 ⊲x2 )(x3 ⊲x4) +(x1 ⊲x3 )(x2 ⊲x4) +(x2 ⊲x3 )(x1 ⊲x4 )
+ x1 ((x2 ⊲x3 ) ⊲x4) + x1 (x3 ⊲(x2 ⊲x4 )) + x2((x1 ⊲x3 ) ⊲x4 ) + x2(x3 ⊲(x1 ⊲x4 ))
+ x3 ((x1 ⊲x2 ) ⊲x4) + x3 (x2 ⊲(x1 ⊲x4 )) +((x1 ⊲x2 ) ⊲x3)x4 +(x2 ⊲(x1 ⊲x3))x4
−((x1 ⊲x2) ⊲x3 ) ⊲x4 −(x1 ⊲x3 ) ⊲(x2 ⊲x4) −(x2 ⊲(x1 ⊲x3 )) ⊲x4
−(x2 ⊲x3 ) ⊲(x1 ⊲x4 ) − x3 ⊲((x1 ⊲x2 ) ⊲x4) − x3 ⊲(x2 ⊲(x1 ⊲x4 )).
In the end of this section, we give a di ﬀerent perspective on the inverse of the Oudom-Guin
isomorphism φ. According to Theorem 2.3, U( g) is a U( g)⊲-module bialgebra via the action ⊲.
Correspondingly, we can twist ⊲by φto deﬁne a U( g⊲)-module bialgebra action ⇀ on U( g) by
X ⇀ Y ≔ φ(X) ⊲Y, ∀X ∈ U(g⊲), Y ∈ U(g).
Proposition 3.8. The inverse φ−1 : U( g) → U(g⊲) is a relative Rota-Baxter operator with
respect to ⇀in the sense of [31, Def. 3.1] . Namely, φ−1 is a coalgebra homomorphism satisfying
φ−1(X)φ−1 (Y ) = φ−1(X1 (φ−1(X2 ) ⇀ Y )), ∀X,Y ∈ U(g).
Proof. Applying φto both sides of the stated relative Rota-Baxter identity, o ne can see that it is
equivalent to Eq. ( 7) as φ is an algebra isomorphism from U( g⊲) to U( g)⊲. □
4. T he Grossman-LarsonHopfalgebra of ordered trees
In this section, we write down the cancellation-free antipo de formula for the Grossman-
Larson Hopf algebra of ordered trees via Eqs. ( 17) and ( 19). First review the Grossman-Larson
Hopf algebra of ordered trees deﬁned in [ 25]. For the deﬁnition of ordered trees (also called
planar rooted trees), see [ 44, page 573].
4.1. Basic terminology. Let OT be the set of isomorphism classes of ordered trees, which is
presented by
OT =
{
, , , , , , , , , , , , , , , , , , , , , , ,...
}
.
Let k{OT} be the free k-module generated by OT. Denote T(k{OT}) the tensor algebra over
k{OT}. W e identify T(k{OT}) with the free k-algebra generated by OT, and interpret its basis
of pure tensors of trees as the set of isomorphism classes of o rdered forests denoted by OF.
Namely, T(k{OT}) = k{OF}. In particular, the unit 1 is the empty forest ∅.
16 YUNNAN LI
Deﬁne the left grafting operator ↷: k{OT}⊗ k{OT} → k{OT} by
τ ↷ ω =
∑
s∈Nodes(ω)
τ◦s ω, ∀τ,ω ∈ OT,(25)
where τ◦s ωis the ordered tree resulting from attaching the root of τto the node s of the tree ω
from the left. For example, we have
↷ = + + + , ↷ = + + + .
Let B+ : k{OF} → k{OT} be the linear map producing an ordered tree τ from any ordered
forest τ1 ··· τm by grafting the m trees τ1 ,...,τ m on a new root in order. In particular, set
B+(1) = by convention. For example, we have
B+( ) = .
Let B− : k{OT} → k{OF} be the linear map producing an ordered forest from any ordere d
tree τby removing its root. For example, we have
B−( ) = .
Deﬁnition 4.1 ([25]). Denote the Grossman-Larson Hopf algebra of ordered trees by
HG L = (k{OT},◦G L,∆G L,S G L).
Therein, the Grossman-Larson product ◦G L on k{OT} is deﬁned by letting τ◦G L ωbe the partial
sum of τ1 ↷ (τ2 ↷ ··· (τm ↷ ω) ··· ) containing those trees with all τ1 ,...,τ m grafted only on
ω, when τ, ω ∈ OT such that τ = B+(τ1 ··· τm).
The coproduct ∆G L on k{OT} is given by
∆G L(τ) =
∑
I⊆[m]
τ+
I ⊗τ+
[m]\I
for any τ = B+(τ1 ··· τm ) ∈ OT , with the notation τ+
I = B+(∏
i∈I τi) for any ordered subset
I ⊆ [m].
Recall T akeuchi’s well-known recurrent antipode formula a s follows.
Theorem 4.2 ([
45]). Any graded, connected k-bialgebra (B,m,u,∆,ε) is a Hopf algebra with
its antipode S given by
(26) S =
∑
i≥0
(−1)i p⋆i =
∑
i≥0
(−1)i m(i−1) p⊗i ∆(i−1) ,
where ⋆ is the convolution product, u is the unit map, p ≔ id −uε, m (−1) ≔ u, and ∆(−1) ≔ ε.
Applying T akeuchi’s antipode formula (
26) to the graded, connected bialgebra ( k{OT},◦G L,∆G L),
one obtains the following formula of S G L (see e.g. [ 49, Lemma 3.1]),
S G L(τ) =
∑
π
(−1)|π|τ+
B1 ◦G L ···◦ G L τ+
B|π|
for τ = B+(τ1 ··· τm) ∈ OT, and the sum ranges over all set partitions π = (B1,..., B|π|) of [ m].
THE SUB-ADJACENT STRUCTURE ON THE UNIVERSAL ENVELOP OF A POS T -LIE ALGEBRA 17
4.2. A cancellation-free antipode formula for the Grossman-Lar son Hopf algebra. In the
rest of the paper, we aims to ﬁnd a cancellation-free antipod e formula for HG L.
The magma algebra ( k{OT},↷) given by Eq. ( 25) is the free magma algebra on one gener-
ator, namely a single root . Theorem 2.7 tells us that the left grafting operator ↷ extends to a
product ⊲on k{OF}, so that
(k{OF},·,∆
/A1
,S ,⊲)
is a post-Hopf algebra. Moreover, it is the universal envelo ping algebra of the free post-Lie
algebra on one generator. See [ 15, 21, 37] for more details about free post-Lie algebras and
their universal enveloping algebras.
As indicated in [ 39, Proposition 4.1] and [ 38], we notice that
Proposition 4.3. The sub-adjacent Hopf algebra k{OF}⊲= (k{OF},∗⊲,∆
/A1
,S ⊲) is isomorphic
to the Grossman-Larson Hopf algebra HG L of ordered trees via the root grafting operator B +.
Also, using the post-Hopf product ⊲, the multiplication ∗⊲can be given by
X∗⊲Y = B−(X⊲B+(Y)), ∀X,Y ∈ OF.
Equivalently,
τ◦G L ω = B−(τ) ⊲ω, ∀τ,ω ∈ OT.
By the deﬁnition ( 25) of the left grafting operator on ordered trees, the combina torial for-
mula ( 19) for the product ◮on k{OF} can be expressed more concretely as follows.
Proposition 4.4. Given any trees τ1 ,...,τ m,ω ∈ OT, the product
τ1 ··· τm ◮ω =
∑
w∈S m
[τ1 ,...,τ m; ω]w
is equal to the sum of all left graftings with rootstock ω and then scions τ1 ,...,τ m grafted in
any order but under the constraint that τi is left to τj for any i > j whenever they are attached
to the same node.
Proof. W e prove it by induction on the number m of scions. It is clear when m = 1, as τ1 ◮ω =
τ1 ↷ ω. When m > 1, we restate the recursive formula (
18) of the product ◮on k{OF} as
τ1 ··· τm ◮ω = τ2 ··· τm ◮(τ1 ↷ ω) +
m∑
i=2
τ2 ··· (τ1 ↷ τi ) ··· τm ◮ω.
By the deﬁnition ( 25) of ↷, it means that τ1 is attached to any node among τ2 ,...,τ m,ω ﬁrst,
and then if any one of τ2 ,...,τ m is latter attached to the same node as τ1 , it should be left to
τ1 . Moreover, each term in the above sum has only m −1 scions now , so the result follows by
induction hypothesis. □
Example 4.5. ◮ = ( ↷ ) ↷ + ↷ ( ↷ ) = + +2 +2 + + + + .
Theorem 4.6. The antipode S G L of HG L has the following cancellation-free formula,
(27) S G L(τ) = (−1)m
∑
π
B+( (τ−
B1 ◮τb1 ) ··· (τ−
B|π|−1 ◮τb|π|−1 )) , ∀τ = B+(τ1 ··· τm ) ∈ OT,
18 YUNNAN LI
where the sum ranges over all partitions π of [m] into a tuple (B1,..., B|π|) of possibly empty
subsets such that B |π| = {b1 > ··· > b|π|−1 }. Also, we use the notation τ−
I = τi1 ··· τir ∈ OF for
any I = {i1 < ··· < ir } ⊆ [m]. In particular , τ−
∅ = 1.
Proof. According to Prop.
4.3, B+ is a Hopf algebra isomorphism from k{OF}⊲ to HG L, so
S G L B+ = B+S ⊲, namely S G L = B+S ⊲B−. Hence, the desired formula of S G L is obtained as an
equivalent form of Eq. ( 17) for S ⊲.
Furthermore, the combinatorial formula ( 19) implies that each term ( τ−
B1
◮τb1 ) ··· (τ−
B|π|−1
◮
τb|π|−1 ) is homogeneous in k{OF}, of degree |π| − 1 and with positive integer coe ﬃcients. So
Eq. ( 27) is a cancellation-free formula for S G L. □
Remark 4.7. The graded Hopf dual of k{OF}⊲is the Munthe-Kaas-Wright Hopf algebra
HN = (k{OF},m
/A1
,∆N ,S N )
of ordered forests, as the natural setting of Lie-Butcher se ries. In [ 38, Prop. 3], the authors gave
a nonrecursive formula for the antipode S N of HN . Our closed formula ( 27) of S G L serves as its
graded-dual formula.
At last we give a simple illustration how to compute the antip ode S G L via Eq. ( 27).
Example 4.8. Let τ = . That is, τ1 = τ2 = , τ3 = such that τ = B+(τ1 τ2τ3 ).
T otally 10 appropriate partitions of [3] with the correspon ding sum of trees in the RHS of ( 27)
are listed as follows.
(∅,∅,∅,{3,2,1}) (1 ◮τ3 )(1 ◮τ2)(1 ◮τ1 ) = τ3τ2 τ1 ⇝
({1},∅,{3,2}) ( τ1 ◮τ3 )(1 ◮τ2) = (τ1 ↷ τ3)τ2 ⇝ +
(∅,{1},{3,2}) (1 ◮τ3 )(τ1 ◮τ2) = τ3 (τ1 ↷ τ2 ) ⇝
({2},∅,{3,1}) ( τ2 ◮τ3 )(1 ◮τ1) = (τ2 ↷ τ3)τ1 ⇝ +
(∅,{2},{3,1}) (1 ◮τ3 )(τ2 ◮τ1) = τ3 (τ2 ↷ τ1 ) ⇝
({3},∅,{2,1}) ( τ3 ◮τ2 )(1 ◮τ1) = (τ3 ↷ τ2)τ1 ⇝
(∅,{3},{2,1}) (1 ◮τ2 )(τ3 ◮τ1) = τ2 (τ3 ↷ τ1 ) ⇝
({1,2},{3}) τ1τ2 ◮τ3 = (τ1 ↷ τ2 ) ↷ τ3 +τ2 ↷ (τ1 ↷ τ3 ) ⇝ 2 +2 +2 + +
({1,3},{2}) τ1τ3 ◮τ2 = (τ1 ↷ τ3 ) ↷ τ2 +τ3 ↷ (τ1 ↷ τ2 ) ⇝ +2 +
({2,3},{1}) τ2τ3 ◮τ1 = (τ2 ↷ τ3 ) ↷ τ1 +τ3 ↷ (τ2 ↷ τ1 ) ⇝ +2 + .
Now adding up all of them, we have
S G L( ) = − −3 − −2 −2 −4 −2 −6 − −3 .
Acknowledgements. This work is supported by Natural Science Foundation of Chin a (12071094,
12171155) and Guangdong Basic and Applied Basic Research Fo undation (2022A1515010357).
THE SUB-ADJACENT STRUCTURE ON THE UNIVERSAL ENVELOP OF A POS T -LIE ALGEBRA 19
References
1. M. J. H. Al-Kaabi, K. Ebrahimi-Fard, D. Manchon and H. Munt he-Kaas, Algebraic aspects of connections:
from torsion, curvature, and post-Lie algebras to Gavrilov ’s double exponential and special polynomials, J.
Noncomm. Geom. (2023), https://doi.org/10.4171/JNCG/539, online ﬁrst. 2, 12
2. C. Bai, L. Guo, Y . Sheng and R. T ang, Post-groups, (Lie-)Bu tcher groups and the Y ang-Baxter equation. Math.
Ann. 388 (2024), 3127–3167. 2
3. C. Bai, L. Guo and X. Ni, Nonabelian generalized Lax pairs, the classical Y ang-Baxter equation and PostLie
algebras, Comm. Math. Phys. 297 (2010), 553–596. 1, 6
4. C. Benedetti and B. Sagan, Antipodes and involutions, J. Combin. Theory Ser . A 148 (2017), 275–315. 3
5. H. Berland and B. Owren, Algebraic structures on ordered r ooted trees and their signiﬁcance to Lie group
integrators, Group theory and numerical analysis, 49–63, C RM Proc. Lecture Notes, 39, Amer. Math. Soc.,
Providence, RI, 2005. 3
6. Y . Bruned and F . Katsetsiadis, Post-Lie algebras in regul arity structures, F orum Math. Sigma 11 (2023), Paper
No. e98. 1, 2
7. D. Burde, Left-symmetric algebras, or pre-Lie algebras i n geometry and physics, Cent. Eur . J. Math. 4 (2006),
323–357. 1
8. F . Chapoton and M. Livernet, Pre-Lie algebras and the root ed trees operad, Int. Math. Res. Not. 8 (2001),
395-408. 1
9. F . Chapoton and F . Patras, Enveloping algebras of preLie a lgebras, Solomon idempotents and the Magnus
formula, Internat. J. Algebra Comput. 23 (4) (2013), 853–861. 2, 5
10. A. Connes and D. Kreimer, Hopf algebras, renormalizatio n and noncommutative geometry, Comm. Math.
Phys. 199 (1) (1998), 203–242. 3
11. C. Curry, K. Ebrahimi-Fard, D. Manchon and H. Munthe-Kaa s, Planarly branched rough paths and rough
diﬀerential equations on homogeneous spaces, J. Di ﬀerential Equations 269 (2018),. 1
12. C. Curry, K. Ebrahimi-Fard and H. Munthe-Kaas, What is a p ost-Lie algebra and why is it useful in geomet-
ric integration, Numerical mathematics and advanced appli cations-ENUMA TH 2017, 429–437, Lect. Notes
Comput. Sci. Eng., 126, Springer, Cham, 2019. 1
13. C. Curry, K. Ebrahimi-Fard and B. Owren, The Magnus expan sion and post-Lie algebras, Math. Comput. 89
(326) (2020), 2785–2799. 1
14. K. Ebrahimi-Fard, A. Lundervold and D. Manchon, Noncomm utative Bell polynomials, quasideterminants
and incidence Hopf algebras, Internat. J. Algebra Comput. 24 (5) (2014), 671–705. 14
15. K. Ebrahimi-Fard, A. Lundervold and H. Munthe-Kaas, On t he Lie enveloping algebra of a post-Lie algebra,
J. Lie Theory 25 (2015), 1139–1165. 2, 5, 17
16. K. Ebrahimi-Fard, I. Mencattini and H. Munthe-Kaas, Pos t-Lie algebras and factorization theorems, J. Geom.
Phys. 119 (2017), 19–33. 2, 6, 13
17. K. Ebrahimi-Fard and L. Rahm, A survey on the Munthe-Kaas -Wright Hopf algebra, arXiv:2306.04381v3.
18. H. Figueroa and J. M. Gracia-Bondia, On the antipode of Kr eimer’s Hopf algebra, Modern Phys. Lett. A 16
(22) (2001), 1427–1434. 3
19. H. Figueroa and J. M. Gracia-Bondia, Combinatorial Hopf algebras in quantum ﬁeld theory. I. Rev . Math.
Phys. 17 (8) (2005), 881–976. 3
20. L. Foissy, The antipode of of a Com-PreLie Hopf algebra, a rXiv:2406.01120. 3
21. L. Foissy, Extension of the product of a post-Lie algebra and application to the SISO feedback transformation
group, Abel Symp. 13 (2018), 369–399. 2, 6, 17
22. A. V . Gavrilov, The Leibniz formula for the covariant der ivative and some of its applications, Sib. Adv . Math.
22 (2) (2012), 80–94. 11, 12
23. A. V . Gavrilov, Algebraic properties of the covariant de rivative and composition of exponential maps, Sib. Adv .
Math. 16 (3) (2006), 54–70. 2, 11, 12
24. M. Goncharov, Rota-Baxter operators on cocommutative H opf algebras, J. Algebra 582 (2021), 39–56. 2
20 YUNNAN LI
25. R. Grossman and R. Larson, Hopf-algebraic structure of f amilies of trees, J. Algebra 126 (1) (1989), 184–210.
2, 5, 15, 16
26. R. Grossman and R. Larson, Hopf-algebraic structure of c ombinatorial objects and di ﬀerential operators, Israel
J. Math. 72 (1) (1990), 109–117. 2
27. L. Guo, H. Lang and Y . Sheng, Integration and geometrizat ion of Rota-Baxter Lie algebras, Adv . Math. 387
(2021), 107834. 2
28. M. E. Ho ﬀman, Combinatorics of rooted trees and Hopf algebras, T rans. Amer . Math. Soc. 355 (9) (2003),
3795–3811. 3
29. B. Humpert and J. L. Martin, The incidence Hopf algebra of graphs, SIAM J. Discrete Math. 26 (2) (2012),
555–570. 3
30. Y . Li, On weak peak quasisymmetric functions, J. Comb. Theory Ser . A 158 (2018), 449–491. 3
31. Y . Li, Y . Sheng and R. T ang, Post-Hopf algebras, relative Rota-Baxter operators and solutions to the Y ang-
Baxter equation, J. Noncomm. Geom. 18 (2) (2024), 605–630. 2, 4, 5, 6, 15
32. D. Manchon, A short survey on pre-Lie algebras, Noncommu tative Geometry and Physics: Renormalisation,
Motives, Index Theory, (2011), 89–102. 1
33. I. Mencattini, A. Quesney and P . Silva, Post-symmetric b races and integration of post-Lie algebras, J. Algebra
556 (2020), 547–580. 2
34. F . Menous, F . Patras, Right-handed Hopf algebras and the preLie forest formula, Ann. Inst. Henri P oincar´ e D
5 (1) (2018), 103–125. 3, 11
35. M. M ´ endez, J. Liendo, An antipode formula for the natura l Hopf algebra of a set operad, Adv . in Appl. Math.
53 (2014), 112–140. 3
36. S. Montgomery, Hopf algebras and Their Actions on Rings, Amer. Math. Soc., Regional Conf. Ser. in Math.,
82, 1993. 4
37. H. Z. Munthe-Kaas and A. Lundervold, On post-Lie algebra s, Lie-Butcher series and moving frames, F ound.
Comput. Math. 13 (4) (2013), 583–613. 1, 2, 5, 17
38. H. Z. Munthe-Kaas and W . M. Wright, On the Hopf algebraic s tructure of Lie group integrators, F ound.
Comput. Math. 8 (2) (2008), 227–257. 2, 3, 5, 17, 18
39. J.-M. Oudom and D. Guin, On the Lie enveloping algebra of a pre-Lie algebra, J. K-Theory 2 (2008), 147–167.
2, 5, 17
40. F . Panaite, Relating the Connes-Kreimer and Grossman-L arson Hopf algebras built on rooted trees, Lett. Math.
Phys. 51 (3) (2000), 211–219. 3
41. R. Patrias, Antipode formulas for some combinatorial Ho pf algebras, Electron. J. Combin. 23 (4) (2016), Paper
4.30. 3
42. N. Reshetikhin and M. A. Semenov-Tian-Shansky, Quantum R-matrices and factorization problems, J. Geom.
Phys. 5 (1988), 533–550. 6
43. M. Semonov-Tian-Shansky , What is a classical r-matrix? Funct. Anal. Appl. 17 (1983), 259–272. 6
44. R. Stanley, Enumerative combinatorics, vol. 1, Second E dition, Cambridge Studies in Advanced Mathematics
49, Cambridge University Press, Cambridge, 2012. 15
45. M. T akeuchi, Free Hopf algebras generated by coalgebras , J. Math. Soc. Japan 23 (1971), 561–582. 3, 16
46. B. V allette, Homology of generalized partition posets, J. Pure Appl. Algebra 208 (2007), 699–725. 1, 5
47. D. Xu and H. Y u, On the cancellation-free antipode formul a for the Malvenuto-Reutenauer Hopf algebra,
European J. Combin. 113 (2023), Paper No. 103745, 18 pp. arXiv:2208.06841. 3
48. H. Y u, L. Guo and J.-Y . Thibon, W eak quasi-symmetric func tions, Rota-Baxter algebras and Hopf algebras,
Adv . Math. 344 (2019), 1–34. 3
49. W . Zhao, A noncommutative symmetric system over the Gros sman-Larson Hopf algebra of labeled rooted
trees, J. Algebraic Combin. 28 (2) (2008), 235–260. 16
School ofMathematics andInformationScience, G uangzhouUniversity, G uangzhou510006, C hina
Email address : ynli@gzhu.edu.cn