IEEETRANSACTIONSONCOGNITIVEANDDEVELOPMENTALSYSTEMS,VOL.14,NO.3,SEPTEMBER2022 1245
Buddy System: An Adaptive Mental State Support
System Based on Active Inference
and Free-Energy Principles
Motoko Iwashita and Makiko Ishikawa
Abstract—To support a healthy human mental state, control- and should hold the potential to be extended to everyday life
lingtheenvironmentisoneofthebest-knownsolutions.However, to improve the QoL.
it is difficult to design an environmental control system because
A mental support system requires two functional features,
of the uniqueness of individual preferences and mental state
namely, the recognition of a person’s mental state, and the
fluctuations. Here, we propose “Buddy system” as an adaptive
mental state support solution that controls devices in the envi- capacity to positively affect it, which underpins key technolo-
ronment, depending on the recognized user’s mental state at the gies in terms of human–computer interactions.
time and how it could be improved, serving a role similar to To recognize mental states, researchers have utilized deep-
a “buddy” to individuals. The recognition of mental states and
learning techniques [2] and sophisticated brain scanning tech-
thelocusofactionstocontrolone’ssurroundingenvironmentare
nologies [3]. However, both techniques possess unresolved
implemented on the basis of a brain-derived theory of computa-
tionknownasactiveinferenceandfree-energyprinciples,which problems. The main problem with the former technique is
provide biologically plausible computations for perceptions and their accuracy, which is highly demanding on the learning
behavior in a changing world. For the generation of actions, data sets. Especially for mental recognition by facial expres-
we modify the general calculations of active inference to adjust
sions, some commercially available algorithms showed that
to individual environmental preferences. In the experiments, the
the accuracies differed among different data sets. When the
Buddy system sought to maintain the participants’ concentra-
tionwhileacalculationtaskwasconducted.Asaresult,thetask Acted Facial Expressions in the Wild data set, containing
performance for most of the participants was improved through close to natural facial expressions, was tested, the accuracies
theaidoftheBuddysystem.TheresultsindicatedthattheBuddy were ∼0.2–0.6, while when Surrey Audio–Visual Expressed
system can adaptively support to improve the mental states of
Emotiondataset,acquiredfromnonprofessionalactorsinlab-
individual users.
oratory settings, was tested, it increased to ∼0.4–0.7 [4]. The
Index Terms—Active inference, human–system interaction, results indicated that current techniques still needed to be
mental support system.
improved for high accuracy with more natural facial data.
In contrast, the primary issue with the latter technique is
the stability of brain patterns. In other words, brain pat-
terns exhibit differential variations among individuals that
I. INTRODUCTION
the system must account for. Even in the same individual,
RECENTadvancesintechnologyhavemademanyaspects
there can be differences depending on the situation. The
ofhumanlifeeasier.Forinstance,workingconditionsfor
nature of these fluctuations in complex mental state dynam-
manymaypermanentlyshifttotelework,aidedbyinformation
icsresultsindifficultiesinapplyingthemforreal-timemental
technology, given the sudden demand in the wake of the
detection [5].
COVID-19 pandemic. Even though information technology
The other key component of a mental support system is
improves the Quality of Life (QoL), a study showed that
the capacity to control the mental state and navigate it to
the stressors associated with telework can lead to a reduction
a desired one. So far, many biofeedback schemes have been
in well-being [1], eventually diminishing work performance.
developed and utilized to improve mental states by informing
Thus, a mental support system is necessary to maintain well-
users of their current heart rate and blood pressure [6], [7].
being, but it should not be limited to one’s working situation
Some biofeedback technologies entail users to learn how to
voluntarilycontroltheirinvoluntaryphysiologicalresponsesto
Manuscript received 15 February 2021; revised 29 June 2021; accepted enhance their mental states. Although such technologies have
1 August 2021. Date of publication 6 August 2021; date of current version
performed well, learning to control physiological processes
9September2022.(Correspondingauthor:MotokoIwashita.)
Thisworkinvolvedhumansubjectsoranimalsinitsresearch.Approvalof requires considerable time and effort on the part of users [7].
allethicalandexperimentalproceduresandprotocolswasgrantedbyDENSO Alternative methods for controlling the mental state include
CORPORATIONunderApplicationNo.20-001.
the use of the physical environment. Environmental factors,
MotokoIwashitaiswiththeAIRandIDivision,DENSOCORPORATION,
Nisshin4700111,Japan(e-mail:moko0927@gmail.com). such as room temperature and sound volume, can indirectly
MakikoIshikawaiswithDENSOCORPORATION,Tokyo1080075,Japan. affect the mental state for short periods [8]. Moreover, mak-
Color versions of one or more figures in this article are available at
ing use of environmental factors does not require efforts by
https://doi.org/10.1109/TCDS.2021.3102993.
DigitalObjectIdentifier10.1109/TCDS.2021.3102993 the user and can work in real time [9].
ThisworkislicensedunderaCreativeCommonsAttribution4.0License. Formoreinformation,seehttps://creativecommons.org/licenses/by/4.0/
1246 IEEETRANSACTIONSONCOGNITIVEANDDEVELOPMENTALSYSTEMS,VOL.14,NO.3,SEPTEMBER2022
Overall, both the recognition and improvement of mental According to this theory, organisms must minimize the vari-
states by controlling the environment in real time are required ational free energy to keep themselves in a restricted and
to develop an effective mental support system. Although most limited state within the varying environment. The active
previousresearchershaveseparatelydevelopedthesetechnolo- inference is an extended form of FEP that accounts for
gies, combining them into a single system appears to be chal- actions [14]. The general concept of FEP and active inference
lenging. With the existing methods for real-time mental state are described here.
recognition, the recognition models/classifiers are adjusted to
thestatisticalaveragespanningmanypeople[10], [11],assum- A. FEP
ing that it is difficult to control environments in accordance
The underlying idea of the FEP framework is that agents
with individual proclivities through the models/classifiers.
possessaprobabilisticgenerativemodeloftheirenvironments
Untilnow,fewapproacheshavebeendevisedthatcombinethe
and seek to minimize the occurrence of atypical observa-
recognition of mental states and control of the environment in
tions(sensations),i.e.,theyaimtominimizesurprises.Agents
real time for improving mental status [12].
measure the environment by encoding beliefs about environ-
In this study, we propose to apply a recent neurobiologi-
mental causes (hidden states) to inform their sensations. Such
cal theory called free-energy principles (FEPs) and a derived
beliefs correspond to the posterior probability of the causes
scheme called active inference [13], [14] to develop a mental
attributed to the sensations. Thus, perception is regarded as
supportsystemthatisabletorecognizeandimproveaperson’s
a Bayesian inference that refers to optimizing belief about
mental state by controlling the environment while conforming
hidden states through maximizing the Bayesian evidence (and
to individual users. Active inference offers adaptive real-time
minimizing the free energy) [20], [21].
perceptionandbehaviorcontrolwithinasingularscheme[15]. Accordingly, perception of the hidden state χ is formulated
Until recently, FEP and its extended form of active inference using the observed sensory inputs ρ as follows:
wereevaluatedanddiscussedinthecontextofsimulatedenvi-
p(ρ|χ)p(χ)
ronments [16], [17]. However, active inference schemes are p(χ|ρ)= (1)
just starting to be adopted in the robotics field to develop
p(ρ)
the capacity to estimate and control adaptive states, which are where p(ρ|χ) is the likelihood of the sensory input ρ being
neededbyrobotsoperatingindynamicallychangingandnoisy caused by the hidden state χ, and p(χ) is the prior proba-
real-world setting [18], [19]. These studies have shown the bility corresponding to the belief about hidden states before
advantages of utilizing active inference to adapt to dynam- receivingsensoryobservations(observedsensoryinput)ρ.The
ically changing and noisy environments. In accordance, the likelihood p(ρ|χ) is usually parameterized by θ, described as
mental state is also dynamic and fluctuating, and therefore, p(ρ|χ;θ),butisomittedforthesimplicityofdescription.The
thefree-energyframeworkwouldhaveadvantagesinamental joint density p(ρ,χ;θ)=p(ρ|χ;θ)p(χ) of the sensory input
supportsystem.Herein,wecallourmentalsupportsolutionthe ρ and hidden states χ, parameterized by θ, is called a gen-
“Buddy system.” The Buddy system is designed to adaptively erative model [θ is omitted in (2) and (3) but described as
supporttheimprovementofthementalstateinindividualswith needed].Tocalculatetheposteriorprobabilityp(χ|ρ),wemust
a similar architecture for perception and behavioral control as evaluate p(ρ). However, p(ρ) includes a hard integral, and
a human. hence, a variational Bayes method is introduced in the FEP to
Thecontributionofthisstudyisthedevelopmentofamental approximately determine p(χ|ρ). In the variational Bayesian
supportsysteminwhichFEPandactiveinferenceareapplied. method, the approximated distribution of p(χ|ρ), which is
Inoursystem,themethodforadaptivecontrollingoftheenvi- substituted by the recognition density q(χ), is determined by
ronmenttotheindividualuserwasdevelopedandimplemented minimizingtheKullback–LeiblerdivergenceDKLbetweenthe
in an active inference scheme. For recognition of the mental trueposteriorp(χ|ρ)andq(χ)[20].DKLiswrittenasfollows:
(cid:2)
state levels, we only used a simple linear function with a sin-
q(χ)
gle input. However, we accounted for how to overcome this DKL(q(χ)||p(χ|ρ))= dχq(χ)ln
p(χ|ρ)
simplicity to generate an effective environmental control and
=F+lnp(ρ) (2)
to be functioning in real time, and then presented a proof of
concept for the Buddy system. where F, defined as the free energy, is expressed as follows:
(cid:2)
Section II describes the general mathematical formulas of
q(χ)
FEPandactiveinferenceforperceptionandaction.SectionIII F = dχq(χ)ln . (3)
p(χ,ρ)
then describes the structure and algorithm incorporated by the
Buddy system. In Section IV, the experimental evaluations Thus, minimizing the free energy F allows the recognition
are described. Finally, in Sections V and VI, the relevance density q(χ) to be close to the true posterior.
of the Buddy system to mental support tools is discussed and The Kullback–Leibler divergence DKL is always greater
conclusions are drawn. than zero, and so the following is derived as follows:
F ≥−lnp(ρ) (4)
II. FEPFRAMEWORK where −lnp(ρ) is the negative logarithmic model evidence
FEP is an account of how biological organisms adap- (i.e., surprise). Thus, minimizing the free energy F also
tivelyperceiveandinteractwiththeirenvironments[13], [14]. contributes to a minimization of surprise.
IWASHITAANDISHIKAWA:BUDDYSYSTEM:ADAPTIVEMENTALSTATESUPPORTSYSTEM 1247
In the variational approach, it is common to approxi- III. BUDDYSYSTEMWITHACTIVEINFERENCEAND
mate the recognition density q(χ) as a Gaussian distribution LAPLACEAPPROXIMATION
N(χ|μ,(cid:5)), which is called the Laplace approximation and it
The Buddy system is designed to feature the same archi-
peaks at its mean value μ with variance (cid:5) [22], [23]. The
tecture for perception and behavior control as a human and is
mean μ represents the internal belief about the χ. Under the
expected to support mental states in an adaptive way for indi-
Laplace approximation, μ is optimized by minimizing F. F
viduals. In this section, we outline greater details regarding
can be simplified as
the Buddy system’s formula.
1
F ≈−lnp(ρ,χ;θ)| μ − ln2π(cid:5). (5)
2
A. Problem Formulation
As in [21], a simpler derivation could be to assume that the
The Buddy system improves a given mental state, for
variance of recognition density (cid:5) tends to zero by approxi-
instance, concentration or relaxation. A relevant mental state
mating q(χ) by means of Dirac delta. Then, F can be further
is scaled here as numerical mental level.
simplified as
AschematicoftheBuddysystemisdepictedinFig.1.The
F ≈−lnp(ρ,χ;θ)| μ =−lnp(ρ,μ;θ). (6) greenovalcontainstheuser’smentalstateprocessing.Thered
ovalcontainstheBuddysystem’sprocesses.Itcanbeseenthat
The optimized belief is calculated by updating μ through the Buddy system estimates the user’s mental state level μ
a gradient descendant method with sensory input ρ of the user’s biological signals collected
∂F from a sensor (the pink dotted box) by minimizing the free
μ˙ =−κ ∂μ (7) energy F, which comprises the prediction error between ρ
and the predicted sensory input ρe. The estimated μ is biased
where κ is the learning rate. to μd, which is the desired state, and hence, the predicted
sensory input ρe always differs from the sensory inputs ρ,
B. Active Inference and therefore, the prediction error is always produced unless
Theactiveinferenceisaframeworkthatassertsthatnatural the mental state level reaches the desired one. To minimize
agents act so as to sample preferred observations and fulfill
thepredictionerror(=minimizingF),actionsa,controlorders
prior beliefs about their preferred world with less surprise. for environmental devices are generated. The white boxes are
Thus, under active inference, action results from minimizing functions of the general active inference scheme, whereas the
free energy F [24], [25]. yellow boxes are those we specifically modified or added the
TheactiondoesnotexplicitlyappearintheFEPformulation function to adapt the fluctuating nature of the user’s mental
F,butthesensoryinputcanbechangedbyactionstominimize state and preferences.
F.Thereafter,usingtherelationshipfortheactionandsensory The Buddy system infers the user’s mental state level μ
input, ρ = ρ(a), and the chain rule, the gradient of F with fromasinglesensoryinputρ andexecutesactionsatocontrol
respect to the action was described as follows: the various environmental devices, leading the sensory inputs
∂F ∂ρ∂F to being close to the preferred ones and fulfilling prior beliefs
= (8) regarding the desired mental state level.
∂a ∂a ∂ρ
The Buddy system receives the user’s biological signals as
where a represents the action’s value. single sensory input ρ ∈ R. The reason for using a single
Therefore, in the dynamic system, the action value is sensory input is for the sake of simplicity, so that the system
calculated by the gradient descendant scheme as follows: can work in real time (see Section III-D for further details).
∂ρ∂F Here, biological signals comprise autonomic nervous activity,
a˙ =−κ a∂a ∂ρ (9) whose relationship to mental state has been extensively stud-
ied[27]andmanycommercialsensorstocollectdataonitare
where κ a is the learning rate. available. The belief of the mental state level, which under-
went optimization during the mental state estimation process,
C. Learning Generative Model Parameters encoded inthesystemisμ∈R.Todescribetheagent’s belief
MinimizingthefreeenergyFwithrespecttotheparameters regarding the dynamics of the mental state level,
μ(cid:6)
is also
of the generative model can better account for the sensory encodedinthegenerativemodel.Actiona∈Rn isavectorfor
input [26]. The learning could be regarded as a parameter n environmental devices (a 1 ,a 2 ,a 3 ,...,a n ) to be controlled
inference (i.e., the optimizing parameter) within the Bayesian by the Buddy system.
inference framework.
The generative model parameters are then optimized by
B. Generative Model
updating them thorough the gradient descendant method as
Thesystemencodesthelikelihoodp(ρ|μ)andpriorp(μ(cid:6)|μ)
shown in [20], [21]
as a generative model for the sensory inputs. Here, the likeli-
θ˙ =−κ θ
∂F
(10) hood p(ρ|μ) determines how the mental state level μ induces
∂θ the sensory input ρ, and the prior p(μ(cid:6)|μ) is a belief in the
where κ θ is the learning rate. user’s dynamic mental state level. The likelihood p(ρ|μ) is
1248 IEEETRANSACTIONSONCOGNITIVEANDDEVELOPMENTALSYSTEMS,VOL.14,NO.3,SEPTEMBER2022
Fig.1. StructureoftheBuddysystemequippedwithactiveinference.
defined as follows: Usually,μdisastaticvalue,forinstance,thetargetposition
of the robot arm manipulator [18], [19]. However, consider-
p(ρ|μ)=f(ρ;g(μ;θ), (cid:5) ) (11)
z ing the human mental state, the desired mental state level
where f(ρ;g(μ;θ), (cid:5) ) denotes the density of a normal should flexibly change for the following reason. For instance,
z
distribution with mean g(μ;θ) and variance (cid:5) . g(μ;θ) is when people wish to concentrate, they usually do not try to
z
a generative mapping between the mental state level μ and enterdeepconcentrationimmediatelyandratherinitiallyspend
expectedsinglesensoryinputρe,parametrizedbyθ.Themen- some time in shallow concentration, i.e., focused on a reach-
tal state level μ is translated into the expected sensory input able target, whether consciously or not. After achieving the
ρe via g(μ;θ). Here, we adopted a simple linear function for reachable target, they update their next reachable target and
g(μ;θ) as g(μ;θ)=αμ+β, θ =(α,β) for the sake of sim- repeat the process until the true goal of deep concentration
has been attained. We implemented this mental process in the
plicity with a few parameters so as to function in real time
Buddy system, wherein the desired mental state level μd was
(see Section III-D for further details on why the linear model
updatedateverysamplingcyclebytakingthemaximumvalue
was adopted).
The dynamics of belief of the user’s mental state level μ from the last three mental state levels, adding random noise,
which is as described in
were defined so that the user’s mental state level was evolv-
ing to be stable around the desired mental state level μd.
Accordingly,wedefinedthedynamicsofthementalstatelevel μd =max{μ t−3 ,μ t−2 ,μ t−1 }+noise (13)
up tothethirdorder,following theexample described in[20],
where t is the current time and the noise is a portion of
as follows:
μ(cid:6) = dμ =h(μ)+ω=−μ+μd+ω a s T ta h n e da p r r d ior de p v ( i μ at (cid:6) i | o μ n ) b is et d w e e s e c n rib μ e t d −3 a , s μ fo t− ll 2 o , w a s n : d μ t−1 .
dt (cid:3) (cid:4) (cid:3) (cid:4)
μ(cid:6)(cid:6) =h (cid:6)(μ)+ω(cid:6)(cid:6) =−μ(cid:6)+ω(cid:6)(cid:6) p μ(cid:6)|μ =f μ(cid:6);h(μ;μd), (cid:5) ω (14)
μ(cid:6)(cid:6)(cid:6) =h (cid:6)(cid:6)(μ)+ω(cid:6)(cid:6)(cid:6) =ω(cid:6)(cid:6)(cid:6) (12)
wheref(μ(cid:6);h(μ;μd),(cid:5)
ω
)denotesthedensityofanormaldis-
where h(μ) = −μ+μd and ω, ω(cid:6)(cid:6) , and ω(cid:6)(cid:6)(cid:6) represent the tributionwithmeanh(μ;μd)andvariance(cid:5) ω [forh(μ; μd);
Gaussian noise. see (12)].
IWASHITAANDISHIKAWA:BUDDYSYSTEM:ADAPTIVEMENTALSTATESUPPORTSYSTEM 1249
C. Perceptual Inference of the Mental State Level Some of these, such as sound, lighting, and temperature, are
known to influence the mental state [8], [28]–[30]. Therefore,
Given the generative model, the free energy F (6) is
action a of the Buddy system represents the environmental
calculated as follows:
(cid:5) (cid:6)
devices with controllable values, such as the sound volume,
1 1 1 1
F = 2 (cid:5) z ((cid:12) z )2+ (cid:5) ω ((cid:12) ω )2+ (cid:5) ω(cid:6) ((cid:12) ω(cid:6) )2 (15) l s i e g n h s t o c ry olo in r p , u a t nd ρ t c e h m a p n e g r e a s tu b r y e. a U ct n io d n er a a , c d ti e v s e cr i i n b f e e d re a n s ce ρ , h = ow ρ( t a h ) e ,
where (cid:12) z =ρ−ρe,(cid:12) ω =μ(cid:6)−h(μ), and (cid:12) ω(cid:6) =μ(cid:6)(cid:6)−h (cid:6)(μ) . (cid:12) z , must be defined in order to determine action a. Here, we
(cid:12) ω,and(cid:12) ω(cid:6) arepredictionerrors,where(cid:12) z istheerrorobtained adopt the inverse U-shaped function for ρ =ρ(a) for the fol-
between the sensory input ρ and estimated sensory input ρe, lowing reasons. The sensory input (i.e., the user’s biological
and (cid:12) ω and (cid:12) ω(cid:6) represent thedifferences between theexpected signals) ρ changes depending on environmental conditions.
μ(cid:6)
and
μ(cid:6)(cid:6)
from each prior belief, respectively. For instance, loud sounds increase the activity of the sym-
Using the gradient descendant method for estimating the pathetic nerves. However, too low or too high settings do
mental state level in a dynamical system, following the exam- not effectively improve mental states. Such relationships are
ple described in [20], the updating
μ(cid:6)
,
μ(cid:6)(cid:6)
, and
μ(cid:6)(cid:6)(cid:6)
are describedastheinverse-Ufunction,whichisconceptuallysim-
described as follows: ilar to the Yerkes–Dodson law, which states that performance
(cid:5) (cid:6)
μ˙ =μ(cid:6)−κ − (cid:12) z + (cid:12) ω peaks in the middle range of the arousal level [31]. We then
μ (cid:5) (cid:5) implemented the inverse-U-shaped knowledge in the relation-
(cid:5) z ω(cid:6)
(cid:12) (cid:12) ship between ρ and a, that is, extremely low and high control
μ˙(cid:6) =μ(cid:6)(cid:6)−κ ω + ω(cid:6)
μ values for environmental devices, such as too loud and too
(cid:5) (cid:5)
ω ω(cid:6)
(cid:12) low sound volume, do not positively affect the sensory input
μ˙(cid:6)(cid:6) =−κ μ ω(cid:6) (16) (the user’s biological signal). In mathematic formulaic terms,
(cid:5)
ω(cid:6)
the optimized/desired sensory input is peaked in the quadratic
where κ μ is the learning rate. function. Then, the ρ =ρ(a) is defined as
(cid:7) (cid:8)
D. Learning of the Generative Model ρ =γ
(a
1
+δ
1
)2+(a
2
+δ
2
)2
+ρd (18)
+···+(a +δ )2
Here, we adopt a linear function for the generative model n n
g(μ;θ),amappingbetweentheexpectedsensoryinputρeand where γ is the negative value of the coefficient and
the mental state level μ. Typically, the biological signal is not (−δ ,−δ ,−δ ,...,−δ , ρd) is the vertex of the formula,
1 2 3 n
simple but rather noisy and fluctuating in a context-dependent and ρd is the expected sensory input when the status attains
manner, and therefore, a linear function for the generative the desired state level μd; i.e., ρd = g(μd). Here, multiple
modelg(μ;θ)seemstobetoosimpletobevalid.Toprecisely
environmental devices were assumed to be additive effects.
describe the generative model g(μ;θ), it is best to determine Given(18),thefreeenergyF withrespecttoactionausing
all of the factors affecting the mental state and implement (8) is described as follows:
these factors’ effects in the generative model. In that case, ∂F ∂ρ ∂F 2γα(a +δ)(ρ−μ)
multiplesensorswouldberequiredtoaccuratelydeterminethe = = i i
state through the generative model g(μ;θ). However, to use
∂a
i
∂a
i
∂ρ (cid:5)z
i=1,2,3,...,n. (19)
multiple sensory inputs, a more complex formula for g(μ;θ)
is required, yielding the increasing time needed for the turn- Here,calculating∂F/a =0tominimizeFyieldsoptimized
i
ing/learning parameters and making it difficult to work in real actions a ∗ as shown in
i
time.Therefore,asmallernumberofsensorsandconsequently
simpler models are better. Although the simple linear model a ∗ i =−δ i . (20)
easily loses the accuracy of calculating the sensory input, fre- ∗
Therefore, the vertex values for action a of (18) indicate
quent updating of the linear generative model based on the i
optimized action values.
current data could offer a locally better estimation of the sen-
The update rule for the action is described, using (19), as
sory input from the estimated mental state level. Therefore,
follows:
we utilized the frequent online learning of the parameters θ
of g(μ;θ) in every sampling cycle. Using (10), the updated a˙ =−κ
∂F
=−κ
2γα(a
i
+δ
i
)(ρ−μ)
(21)
equationsoftheparametersθ =(α,β)aredefinedasfollows:
i a∂a
i
a (cid:5)z
∂F ρ−αμ−β where κ
a
is the learning rate.
α˙ =−κ =−κ
α ∂α α (cid:5) In general, in the FEP, ρ = ρ(a) is not updated, because
z
β˙ =−κ β
∂F
=−κ β
ρ−αμ−β
(17)
t
F
h
o
e
r i
r
n
e
s
la
ta
ti
n
o
c
n
e
s
,
h
i
i
n
p
r
o
o
f
bo
t
t
h
ic
e
s,
se
th
n
e
so
r
r
e
y
lat
i
i
n
o
p
n
u
s
t
hi
a
p
n
o
d
f
a
th
c
e
tio
a
n
rm
is
ve
s
l
t
o
a
c
b
i
l
t
e
y
.
∂β (cid:5)
z observed by the sensor and arm’s movement has a stable rela-
where κ α and κ β are the learning rate. tionship. However, in terms of the sensory input of biological
signals, the relationship between the sensory input and action
E. Active Inference for Action Control
isnotstablebecausetheuser’sbiologicalactivitiesoftheauto-
The Buddy system was designed to be capable of utiliz- nomic nervous system are not only affected by environmental
ingseveralenvironmentaldevicestoimprovethementalstate. factors but also by the ongoing statuses of the internal organs
1250 IEEETRANSACTIONSONCOGNITIVEANDDEVELOPMENTALSYSTEMS,VOL.14,NO.3,SEPTEMBER2022
and brain [32], [33]. Again, because we only utilize a sin- devices, with which the user made change in large amounts.
gle sensory input, the relationship between actions and the In practice, we updated −δ(i=1,2,...,n) using a rate bias
i
sensory input is susceptible to the other factors, and there- R calculatedfromthemostrecentmanipulationhistoryofthe
i
fore easily deviates from the true one. However, instead of user. R is defined as follows:
i
detecting all signals from the internal organs and brain and |(cid:15)a|
having a sophisticated formula for ρ = ρ(a), we adopted R i = (cid:9) i (23)
a strategy of utilizing the simple quadratic function described
(cid:15)a2
1
+(cid:15)a2
2
+···+(cid:15)a2
n
above[formula(18)]andupdatingtheparameterseverycycle. where (cid:15)a(i = 1,2,...,n) are the most recent modulations
i
In the presence of undefined factors that influence the sen-
of the environmental devices’ values under the user’s control.
sory input (i.e., the user’s biological signal), the same actions
Given the current action and sensory input
could change the sensory input in the opposite fashion. For (a ,a ,...,a ,ρ) and the most recently changed amounts
1 2 n
instance, with the same sound volume, sympathetic nervous (cid:15)a, we then updated the −δ to accommodate the following
i i
activity sometimes increases and decreases. As a mathematic
equation. Note that the determination of the exact value for
formula, this corresponds to that the axis of the symmetry −δ was performed by the rule described in (22)
of the quadratic function relative to the current point (a,ρ) i
differs in the presence of the other factors, such as the ongo- |−δ i −a i |=R i r (24)
√
ing states of internal organs and brain. To adjust the axis of where r = (ρ−ρd)/γ represents theradius of the n-sphere
symmetry (a
∗,a ∗,...,a ∗,ρd)
denoted in (18) and (20), the
1 2 n [see (18)]. In this updating rule, when the user changes the
currentpoint(a 1,t ,a 2,t ,...,a n,t ,ρ t )and themostrecentpoint intensity of the device significantly, it results in a large dif-
(a 1,t−1 ,a 2,t−1 ,...,a n,t−1 ,ρ t−1 ) are used. Here, depending on ference between the current setting a and the optimized
whetherornotthesensoryinputρ t isincreasedwiththegiven setting a ∗ . At this point, the Buddy syst i em can enact signifi-
environmental changes, (cid:15)a i = a i,t −a i,t−1 , a ∗ i relative to a i,t cant chan i ges in relevant devices, corresponding to the user’s
is determined by the conditions below, fulfilling passage of
change.
the point (a 1,n,t ,ρ t )
if (cid:15)a i >0 and ρ t >ρ t−1 , then a ∗ i >a i,t IV. EXPERIMENTALEVALUATIONS
if (cid:15)a i <0 and ρ t <ρ t−1 , then a ∗ i >a i,t The Buddy system was evaluated through experiments with
if (cid:15)a i >0 and ρ t <ρ t−1 , then a ∗ i <a i,i nine participants, in which the desired mental state was con-
if (cid:15)a i <0 and ρ t >ρ t−1 , then a ∗ i <a i,t . (22) c 2 e 5 nt s r q a u ti a o r n e . ( P C a 2 rt 5 ic S i ) pa g n a t m s e we fo re r a 4 s 5 ke m d in to i p n er a f n or e m nv t i h ro e n c m ou en n t td w ow it n h
The parameter γ is held constant. three devices, namely, sound speaker, aroma diffuser, and
lighting while sympathetic nervous activity was measured.
F. Personal Adaptation of the Function for Mapping the In this section, the Buddy system settings for the concen-
Sensory Input and Environmental Device Control Actions tration task are first described, followed by the experimental
tasks,setup, design, and statisticalmethods, respectively. This
We hypothesize that the user changes the environment in
is followed by the results and discussion.
amannerthats/hebelievesisbestforachievinghis/herdesired
mental state. The combination of the environmental devices
A. Buddy System Settings
controlledbytheuserreflectstheaffectivesetsofdevicesand
their values to attain the desired mental state; in other words, TheBuddysystemwasinstalledtoimprovetheparticipants’
the preference of the user’s environmental settings for achiev- concentration, which was numerically scaled as a mental
ing the desired state. For instance, some people modulate the state level. The Buddy system inferred the participants’ con-
sound volume, and others want to change the lighting condi- centration level μ from their sympathetic nervous activity,
tions in order to concentrate on a task. Implementing these which changes in relation to the task that requires concentra-
user preferences in the ρ = ρ(a) helps the Buddy system to tion[34].Thesympatheticnervousactivity[35]wasmeasured
generate more effective actions to decrease the need for user via the nasal temperature ρ as detailed in [36], and actions
control. a(i = 1,2,3) were performed to control the environmen-
i
In our formula and calculation method for action gen- tal devices to sample the preferred nasal temperature, which
eration (see Section III-E), when the current environmental fulfilled prior beliefs regarding the desired level of concen-
settings are far from optimized, the environmental changes tration. Here, actions a(i = 1,2,3) included sound volume,
i
are large and when the settings are close to the optimized aroma volume, and illumination color, which influence the
value, the environmental changes are small. Therefore, the sympathetic nerve activity [37]–[39].
extent to which environmental devices are changed depends The Buddy system first inferred the current mental level μ
t
on how great the differences are between the current setting bymeansoftheaveragednasalskintemperaturesρ thatwere
t
∗
a and optimized setting a . To implement the user’s prefer- recorded for 2 min. The nasal skin temperature was normal-
i i
ence in our action generation scheme, we updated the values, ized by subtracting the forehead temperature. The normalized
−δ(i = 1,2,...,n), which are the vertex values represent- nasal skin temperature was observed to decrease when the
i
ing the optimal action values a ∗(i = 1,2,...,n) [see (20)], sympathetic nervous activity increased [36]. Next, if the cur-
i
so that the Buddy system could exert substantial change to rentnormalizednasalskintemperatureρ washigherthan98%
t
IWASHITAANDISHIKAWA:BUDDYSYSTEM:ADAPTIVEMENTALSTATESUPPORTSYSTEM 1251
Fig.2. C25Scalculationsgame.(a)Calculationsbeginwhenthestartbuttonisclicked.Aquestionisansweredbyclickingthenumberontheright-hand
panel.(b)Answershouldbegivenwithin5s;otherwise,alossisregistered.When25calculationsofthegamearecompleted,thescore,elapsedtime,and
totalpointsareshownontheright-handpanel.
of the latest ρ t−1 , the system generated the actions for con- again until the 45 min total had elapsed. The content of
trolling the devices in order to change the environment. If the game was refreshed each time by clicking the start but-
not, the system did not generate any actions. Thus, the gen- ton. Participants were allowed to perform shoulder and arm
eration of actions depended on the changes in the normalized stretches between game sessions to reduce the fatigue caused
nasalskintemperatureρ,whichwasexpectedtoavoidcausing by long-term mouse operation. The score of each game was
annoyance to the participants due to too many environmen- termed the “Points” [Fig. 2(b)] and calculated with the fol-
tal changes. The series of procedures described above were lowing equation, considering the time elapsed per game and
performed every 2 min in cycles. 2 min is enough time that the correct answer rate:
sympatheticnerveactivitywouldbereflectedinthenasalskin
temperature [36], [40]. Points=C/25∗100+108507/T (25)
B. Experimental Tasks where C is the number of correct answers and T is the time
To evaluate the system for concentration, a long-term task (in sec) elapsed per game.
(45 min) that requires concentration but causes boredom or
distraction without sleepiness is desirable because this would
C. Experimental Setup
allow us to evaluate the efficacy of the proposed system on
concentration. Before the experimental trials, a preliminary Nine healthy males aged 18–42, who were all employees
experimentwasconductedwiththreeotherparticipantstocon- of DENSO CORPORATION, participated in the experiment.
firm that C25S did not cause moderate or heavy sleepiness. Theexperimentwasapprovedbythelocalethicscommitteeat
The C25S calculation shown in Fig. 2 is one of the tasks. the DENSO CORPORATION. After receiving detailed writ-
C25S is a PC game/educational-free application consisting of ten and oral instructions, participants provided their informed
simple 25 summation or subtraction calculations. Participants written consent to participate in the study.
completedaquestionnaireregardingtheirsleepinessattheend Fig. 3 displays the experimental setup. The environmen-
ofeachexperiment,andweconfirmedthatC25Sdidnotcause tal devices that were manipulated by both participants and
moderate or heavy sleepiness. systems were a natural sound speaker (a smartphone applica-
C25S is available at https://nll.red/masu100/index_S.html. tion),anaromaemitter(byAromaJoinCorporation),andthree
We obtained permission from the developer to use it. Once smart light bulbs (by PHILIPS). The participants selected two
a participant started the game by clicking on the start button, of five natural sounds (wave, rain, café, village, and magma)
s/he then had to calculate an equation, which was randomly as preferences beforehand. The two natural sound volumes,
selected by the system from 25 possible calculations, and the aroma intensity, and the light color were controlled by the
to then input the answer value by clicking the number dis- device controller application [Fig. 3(b)]. The sound volumes
played on the right side of the screen [Fig. 2(a)] within 5 s. were scaled as 0–100, corresponding to about 15–70 dB. The
If the participant could not answer correctly within 5 s, it volumes of the two sounds could be separately specified. The
was counted as a “fail” and the next equation was randomly aromaintensitywasscaledas0–5,representingthespraytime
selected.Aftercalculatingall25equations(i.e.,agameends), from 0 to 5 s, increased by 1 s. The light color was scaled as
participants repeated the game by clicking the start button 0–100, corresponding to red to purple.
1252 IEEETRANSACTIONSONCOGNITIVEANDDEVELOPMENTALSYSTEMS,VOL.14,NO.3,SEPTEMBER2022
condition. Participants had priority for control of the environ-
mental devices, even if the system attempted to control them
at the same time. Under all conditions, the participants could
only manipulate the controller before starting each round of
the game.
The participants partook in three experiments under three
different conditions at three different morning hours. Every
experiment was executed at least one day apart. When the
participants finished all three experiments, they ranked their
preferencesforeachday.Here,theexecutionorderofthethree
conditions was randomized for each participant. Participants
were neither informed about the functional detail of the three
different conditions nor which condition was to be executed
on each day. However, the participants were only informed of
whether or not the system automatically controlled the envi-
ronment in the relevant experimental sessions for the sake of
Fig. 3. Experimental setup and device controller display. (a) Experimental
reducing their surprise with respect to the automatic changes
setup equipped with sound speakers, aroma diffuser, and three smart lights.
(b) Device controller implemented on a smartphone. (a) and (b) are reused in the environment during the sessions.
withpermissionfromFront.Comput.Sci.3:702069. The sample size of n=9 was estimated using the freeware
G*Power (ver 3.1.9.7) [41] with the following parameters:
paired Wilcoxon test, effect size (dz)=1.0, alpha error prob-
The Buddy system’s output was a 1 as the sound volume ability = 0.05, and detection power = 0.80 under one-tail test
of a larger one, a as the aroma intensity, which was con-
2 (enhancedperformancewasexpectedbasedonthepreliminary
verted to a 0–100 scale from a 0–5 scale displayed on the
experiment).
controller [Fig. 3(b)], and a as the light color. The smaller
3
sound was determined by a with the volume ratio of two
1
E. Statistical Methods
sounds. The volume ratio was based on the volumes set by
the participants at the beginning of the experiment. When the Toevaluate thetaskperformance, atimeseriesofeach par-
participantschangedthesoundvolumeduringtheexperiment, ticipant’s game points were fitted to the linear model and the
the volume ratio was also changed, accordingly. slope of the trend line was calculated. The task performance
Both the nasal and forehead skin temperatures were mea- wasthenanalyzedbymeansofastatisticalcomparisonamong
sured using Polymate I, a biological signal recorder (by the three conditions (User, With Random, and With Buddy)
Miyuki Giken Corporation). using a nonparametric repeated method (Freidman test) and
Wilcoxon’s signed-rank tests. The post-hoc Bonferroni cor-
D. Experimental Design rection was then applied.
To evaluate the functional effect of the system on the sen-
The participants played the C25S calculations game for
sory input, we specifically noted all of the events where
45 min under three different conditions, with or without the
the normalized nasal temperature was increasing in 2 min,
aid of the Buddy system (see below for the three conditions).
because the Buddy system was designed to execute envi-
During the first 8 min, the participants played the game under
ronmental changes when the nasal temperature increased in
the initial environmental settings of the three devices, which
2 min. The degree of change in the nasal temperature in the
were set by the participants based on their preferences just
2 min was added up and compared among the three condi-
before first C25S calculations were begun. For the remaining
tions. Statistical analyses using Wilcoxon’s signed-rank tests
time, participants played the game under one of three con-
to compare the temperature increases among all conditions
ditions: 1) under user-only control (User); 2) under random
were then performed.
control(WithRandom);and3)inconjunctionwiththeBuddy
To analyze the subjective evaluation of system preferences,
system (With Buddy). Under the condition User, environmen-
differences in preference ranking data among the three con-
talchangeswereallcontrolledbyparticipants’manipulations,
ditions were tested by means of ordinal logistic regression,
without the aid of any system. Under the condition With
which is a statistical test used to predict a single ordered
Random,thesystem’sactionswererandomlydetermined.The
categorical variable.
actions were set to execute with a 50% chance rate across
all action determination timings (every 2 min, which was the
F. Results and Discussion
same as with the Buddy system) and the degree of chang-
ing values of the devices were randomly selected. Under As for the results, under the With Buddy condition, seven
the condition With Buddy, the Buddy system controlled the out of nine participants improved their game points during
environment based on the normalized nasal skin tempera- the experiment. One participant from the nine improved his
ture, as described in Section IV-A. Under the condition With gamepointsundertheUsercondition.Theresultindicatesthat
Random and With Buddy, the participants could control the our proposed system was able to support most participants in
environmental devices whenever they wanted, as in the User maintaining their concentration during the 45 min.
IWASHITAANDISHIKAWA:BUDDYSYSTEM:ADAPTIVEMENTALSTATESUPPORTSYSTEM 1253
Fig.4. Exampleofaparticipant’sresultsoftimecoursesfornasaltemperature,environmentalmanipulations,andtaskperformance.(a)–(c)Timecourses
forthenasaltemperatureandenvironmentalmanipulationsforthesoundvolume,aromavolume,andlightcolorunderthreeconditions(User,WithRandom,
andWithBuddy).(d)–(f)TimecoursesforthetaskperformancesmeasuredbypointsineachC25Sgame.Thetrendlines(thedottedline)andapproximation
formulasarealsoshown.(a)–(f)arereusedwithpermissionfromFront.Comput.Sci.3:702069.
the condition With Buddy, the slope value was significantly
high compared to that of the User condition (Wilcoxon test,
Z = 2.3,P = 0.0391, adjusted by the Bonferroni correction,
Effect size dz = 1.35). Under the With Random condition,
the slope value was not significantly different compared to
the User condition (Wilcoxon test, Z = 0.7,P = 0.5703,
adjustedbyBonferronicorrection).Typically,peopleexpectto
be able to efficiently control environmental devices to attain
the desired mental state level. The experimental result shows
theoppositethough,suggestingthatpeopledonotknowthem-
selvesaswellastheymightexpect.Overall,theBuddysystem
successfully improved the task performance, which required
concentration,suggestingtheBuddysystemwasbeneficialfor
Fig.5. Effectsofthethreeconditionsontaskperformance.Theerrorbars improving it.
representthestandarderrorofthemean(SEM)oftheslopeofthetrendline.
Next, we analyzed the functional effect of the system on
nasal temperature to see whether the Buddy system could
contribute to diminish the increase in the nasal temperature.
The results of each statistics are discussed as follows. Fig.6showsthesummationofthechangesinthenasaltemper-
1) Evaluation of the Buddy System Against Participants: ature, which increased over 2 min. Although not statistically
As an example, the sensory input and environmental change significant, the nasal temperature under the condition With
results of a participant are shown in Fig. 4(a)–(c), whereas Buddy better diminished with the increasing trend than the
the task performance of the C25S calculations is shown in other conditions [Freidman test: Chi-square (df = 2) = 1.6,
Fig. 4(d)–(f).
P=0.4594].
The task performance was evaluated by the slope of the Fig. 7 shows the evaluation of the participants’ preferences
trend line of the time series of game points. The points for each of the conditions. The participants were asked to
tended to increase under the condition With Buddy but not ranktheirpreferencesregardingthethreeconditions.TheWith
under the other conditions [Fig. 4(d)–(f)]. Fig. 5 shows the Buddy condition was mostly ranked first or second. The With
averaged slope of the trend line of the points for all partici- Random condition was mainly ranked as first or third. The
pants under the three conditions. The differences between the Userconditionwasprimarilyrankedassecondorthird.These
conditions were statistically significant, as determined by the resultsshowthatthepreferencetendedtobehighintheuseof
Freidmantest[Chi-square(df=2)=6.2,P=0.0446].Under the Buddy system (ordered logit: Chi-square (df = 2) = 5.0,
1254 IEEETRANSACTIONSONCOGNITIVEANDDEVELOPMENTALSYSTEMS,VOL.14,NO.3,SEPTEMBER2022
valuesofthesymmetricalaxisofρ =ρ(a)[see (18) and (20)],
was updated whenever the latest environmental manipulation
by the Buddy system was not effective for decreasing the
nasal skin’s temperature. Fig. 9(b)–(d) shows an example of
the time courses of the optimized action values under the
Buddysystemforcontrol.Forinstance,whenthelatestaction
a 1,t−1 was an increase of the sound volume but the nasal
∗
skin temperature did not decrease, the axis of symmetry a
1
was flipped around the current value a 1,t , and then the new
action a 1,t was to decrease the sound volume. The updat-
∗
ing of a continued as long as the nasal skin temperature was
1
increasing[indicatedinthesecondandfourthredshadedboxes
in Fig. 9(b)–(d)].
Fig.6. Effectsofthethreeconditionsonnasaltemperature.Theerrorbars ρ = ρ(a) was also designed to update in accordance
representtheSEMofthesumoftheelevatednasaltemperature.
with the participants’ preferences. By making use of the
participants’ device manipulation histories, ρ = ρ(a) was
updated through the rule described in (24). As is shown in
Fig. 9(b)–(d), after the participant manipulated the devices
of sound and light after around 30 min [indicated as the
blue-shaded box in Fig. 9(b) and (d)], the Buddy system
changed the sound volume and light color and the aroma vol-
ume less significantly [as indicated by the fourth red shaded
box in Fig. 9(b)–(d)] while updating the axis of symmetry of
ρ =ρ(a) in accordance with the participant’s manipulations.
Overall, the experiments showed that the Buddy system
Fig.7. Preferencesofthethreeconditions. technically functioned in the way it was designed for.
P=0.0819). The With Random condition had a mixed rank, V. DISCUSSION
which suggests that the random controls sometimes appeared Herein, we applied the FEP/Active inference scheme to the
to be good and bad for participants. so-called Buddy system we designed, which is intended to
On the basis of the experimental results outlined above, improve human mental states by controlling the environment
the improvements in task performance were most prominent based on individual preferences. Within this framework, the
in the With Buddy condition. However, as is shown in Fig. 8, Buddysystemfeaturesaprobabilisticmodeloftheuser’smen-
someexamplesfeaturedlessimprovementintaskperformance talstate.Oneofthebenefitsofhavingaprobabilisticmodelis
under the condition. The slope of trend line 0.0457 under the the capacity to perform perceptual inferences with little bio-
WithBuddyconditionisindicativeoflessimprovementinthe logicalsensoryinput.Typically,afewsensorsmakeitdifficult
later period of the experimental session. However, when we to gain an accurate and complete generative model of men-
comparedtheslopeofthetrendlineundertheUsercondition, tal states; however, the functional aim of the active inference
the slope of the trend line under the With Buddy condition framework described here is to make adaptive actions rather
was greater by more than 0.2. Therefore, the Buddy system than utilizing a complete generative model [15]. The internal
still contributed to improved task performances. Overall, it modeloftheBuddysystemisnotdesignedtofeatureanentire
successfully improved the participants’ concentration. complexmodelbutisenoughtomodelthevicinityofthecur-
Infutureworks,we willaim toextend toa larger and more rent state by frequently updating the model’s parameters, and
diverse sample size than that in the present study. enoughtogenerateappropriateactionsonline.Ourexperimen-
2) System Dynamics: As for the desired mental state level, tal results showed that the environmental settings controlled
the Buddy system was designed to update it depending on the by the Buddy system reduced participants’ overall nasal skin
mental state-level history, as described in [13]. As is shown temperature, suggesting that the Buddy system was able to
in Fig. 9(a), the desired state level was always somewhat undertake appropriate actions in terms of control of the envi-
largerthantherecentmentalstatelevels.Therefore,theBuddy ronmental devices, and led participants’ mental states to the
system functioned as desired. desired condition. While with the current generative model,
As for the actions relating to environmental control, the the evolution of belief of the mental state level μ is defined
Buddy system controlled the environmental devices in order arbitrarily to be stable around the desired level μd [see (12)].
to reduce the nasal temperature when the nasal skin tempera- Therefore, the evolution of belief regarding the mental state
ture rose. The action values were calculated by the mapping levelisnotmodeledforitstrueinhumans.Therefore,thecur-
function between the environmental settings and the nasal rentsystemisunabletopredicttruefuturementalstatelevels.
skin temperature ρ = ρ(a). As described in Section III-E, If the system had a dynamic model close to the true mental
each optimized action value a
∗,a ∗
, and a
∗
, which are also state level’s evolution instead of having a model (12), it could
1 2 3
IWASHITAANDISHIKAWA:BUDDYSYSTEM:ADAPTIVEMENTALSTATESUPPORTSYSTEM 1255
Fig.8. Exampleofaparticipant’sresultsoftimecoursesfornasaltemperature,environmentalsettings,andtaskperformance.(a)–(c)Timecoursesforthe
nasaltemperatureandenvironmentalmanipulationsforthesoundvolume,aromavolume,andlightcolorunderthethreeconditions(User,WithRandom,and
WithBuddy).(d)–(f)TimecoursesforthetaskperformancesmeasuredbythepointcalculatedineveryCD25Sgame.Thetrendlines(thedottedline)and
approximationformulasarealsoshown.
Fig. 9. Example of a participant’s results for the time courses regarding a desired state level, current state level, and environmental manipulations, and
those of the optimized action value with the Buddy system control. (a) Time courses for the desired mental state level, current mental state level, and
environmental manipulations for the sound volume, aroma volume, and light color. (b)–(d) Time courses for the environmental manipulations of the sound
volume,aromavolume,andlightcolor,andtheiroptimizedvalues.
predict true future state levels and use them to generate more strengthening future state prediction, the system will be able
effective actions. Future work will develop a system that can to behave proactively with respect to the user’s mental state,
predict true future mental states and generate more effective which may also enhance their preference to use the Buddy
actions by minimizing the future free energy F [42]. Then, by system.
1256 IEEETRANSACTIONSONCOGNITIVEANDDEVELOPMENTALSYSTEMS,VOL.14,NO.3,SEPTEMBER2022
With the Buddy system, personalized action generation is REFERENCES
implemented by fitting the sensory-action mapping function
[1] M.Molinoetal.,“WellbeingcostsoftechnologyuseduringCovid-19
ρ = ρ(a) to individuals, taking into account that optimal
remote working: An investigation using the Italian translation of the
environmental settings differ among individuals. For instance, technostress creators scale,” Sustainability, vol. 12, no. 15, pp.1–20,
a high sound volume that is favorable to one may not always 2020,doi:10.3390/SU12155911.
[2] D. Demekas, T. Parr, and K. J. Friston, “An investigation of the free
havethesameeffectonanother.Therefore,personalizedaction
energy principle for emotion recognition,” Front. Comput. Neurosci.,
generation is expected to enhance the effectiveness and pref- vol.14,pp.1–17,Apr.2020,doi:10.3389/fncom.2020.00030.
erences regarding the use of our proposed system. Here, [3] K. A. Lindquist, T. D. Wager, H. Kober, E. Bliss-Moreau, and
ρ = ρ(a) is modeled as a multivariate quadratic function to L. F. Barrett, “The brain basis of emotion: A meta-analytic
review,” Behav. Brain Sci., vol. 35, no. 3, pp.121–143, 2012,
express the inverse-U shape, taking into account the knowl- doi:10.1017/S0140525X11000446.
edgethatsuboptimalenvironmentalsettings,suchastoomuch [4] M. Mariya, M. Artemyev, A. Belyaev, and O. Perepelkina,
or too little sound volume, are not conducive to the desired Overview of the Advancements in Automatic Emotion Recognition:
ComparativePerformanceofCommercialAlgorithms.PsyArXiv,2019,
mental state, but the middle value is the most optimal. The
doi:10.31234/osf.io/x7bvd.
value of the vertex of the quadratic function will then be [5] F.Lotte,“AtutorialonEEGsignalprocessingtechniquesformentalstate
adjusted to individuals based on the relationship between how recognitioninbrain-computerinterfaces,”inGuidetoBrain-Computer
MusicInterfacing.London,U.K.:Springer,2014,pp.133–161.
they changed the environment and how the sensory input
[6] A. P. Sutarto, M. N. A. Wahab, and N. M. Zin, “Resonant breathing
changed (see Section III-F). Finally, the experimental results biofeedback training for stress reduction among manufacturing opera-
indicatedhighertaskperformanceandhigherpreferenceunder tors,” Int. J. Occup. Safety Ergon., vol. 18, no. 4, pp.549–561, 2012,
doi:10.1080/10803548.2012.11076959.
the With Buddy condition.
[7] D.L.Frank,L.Khorshid,J.F.Kiffer,C.S.Moravec,andM.G.McKee,
Inordertoincreasetheeffectivenessandpreferenceofusing “Biofeedbackinmedicine:Who,when,whyandhow?”MentalHealth
the system more, the addition of more environmental devices FamilyMed.,vol.7,no.2,pp.85–91,2010.
such as air temperature controls could be helpful. The Buddy [8] K. T. Ferguson and G. W. Evans, “The built environment
and mental health,” in Encyclopedia of Environmental Health,
systemcouldeasilyaccommodatesuchanincreaseinthenum-
vol. 80. Amsterdam, The Netherlands: Elsevier, 2019, pp.465–469,
berofdevices.Thesensory-actionmappingfunctionρ =ρ(a)
doi:10.1016/B978-0-12-409548-9.11009-7.
could still be formulated as a multivariate quadratic function [9] G. Becerra and R. Kremer, “Ambient intelligent environments
and environmental decisions via agent-based systems,” J. Ambient
(18) with more devices, and therefore adjusting it to individ-
Intell. Humaniz. Comput., vol. 2, no. 3, pp.185–200, 2011,
uals is merely a matter of adjusting the value of the vertex doi:10.1007/s12652-011-0056-0.
of the quadratic function using (23) and (24) while refer- [10] R.ElKalioubyandP.Robinson,“Real-timeinferenceofcomplexmen-
tal states from facial expressions and head gestures,” in Proc. IEEE
ring to a user’s manipulations of devices in the environment.
Comput.Soc.Conf.Comput.Vis.PatternRecognit.Workshop,vol.10.
Therefore, the proposed system could easily add environmen- Washington,DC,USA,Jan.2004,p.154,doi:10.1109/CVPR.2004.427.
tal devices to its control interface to more effectively improve [11] R. Richer, N. Zhao, J. Amores, B. M. Eskofier, and J. A. Paradiso,
the user’s mental state. “Real-time mental state recognition using a wearable EEG,” in Proc.
40th Annu. Int. Conf. IEEE Eng. Med. Biol. Soc. (EMBC), Honolulu,
HI,USA,2018,pp.5495–5498,doi:10.1109/EMBC.2018.8513653.
VI. CONCLUSION [12] A. Rodrigues, L. Lopes, C. Costa, and D. Cabral, “LightStress:
Targeting stress reduction through affective objects,” in Proc.
This article presented a biologically inspired framework for ACM Int. Joint Conf. Pervasive Ubiquitous Comput. Int. Symp.
a mental state-supportive system, namely, the Buddy system. Wearable Comput., 2019, pp.191–193. [Online]. Available:
http://doi.acm.org/10.1145/3341162.3343773
We adopted the FEP/Active inference scheme for the Buddy
[13] K.Friston,“Thefree-energyprinciple:Aunifiedbraintheory?”Nat.Rev.
system for the sake of gaining adaptive control for men- Neurosci.,vol.11,no.2,pp.127–138,2010,doi:10.1038/nrn2787.
tal states, which innately fluctuate. Based on the general [14] K. J. Friston, J. Daunizeau, J. Kilner, and S. J. Kiebel, “Action and
FEP/Active inference scheme, we modified two of its func- behavior: A free-energy formulation,” Biol. Cybern., vol. 102, no. 3,
pp.227–260,2010,doi:10.1007/s00422-010-0364-z.
tions.Onewasthatthedesiredmentalstatelevelμdexpressed
[15] A.Tschantz,A.K.Seth,andC.L.Buckley,“Learningaction-oriented
in the prior probability of generative model was designed to models through active inference,” PLoS Comput. Biol., vol. 16, no. 4,
bechangeabledependingonrecentmentalstatelevels.Similar pp.1–30,2020,doi:10.1371/journal.pcbi.1007805.
[16] L.Pio-Lopez,A.Nizard,K.Friston,andG.Pezzulo,“Activeinference
to the human dynamics of improving their mental state levels
androbotcontrol:Acasestudy,”J.Roy.Soc.Interface,vol.13,no.122,
step by step, the Buddy system was designed to appropriately 2016,Art.no.20160616,doi:10.1098/rsif.2016.0616.
updatethedesiredmentalstatelevelbasedontheuser’scurrent [17] B. Millidge, “Implementing predictive processing and active
and recent mental state levels. The other modified function of inference: Preliminary steps and results,” PsyArXiv, 2019,
doi:10.31234/osf.io/4hb58.
the Buddy system is its online updating of the sensory-action
[18] C. Pezzato, R. Ferrari, and C. H. Corbato, “A novel adaptive
mapping function ρ = ρ(a) to meet individuals’ preferences. controller for robot manipulators based on active inference,” IEEE
Theexperimentalresultsreportedhereprovideaproofofcon- Robot. Autom. Lett., vol. 5, no. 2, pp.2973–2980, Apr. 2020,
doi:10.1109/LRA.2020.2974451.
cept for the Buddy system, by which task performance was
[19] G. Oliverz, P. Lanillosz, and G. Chengz, “Active inference body per-
improved, the sensory data was optimally controlled, and the ception and action for humanoid robots,” 2019. [Online]. Available:
preferences of the Buddy system were high. arXiv:1906.03022.
[20] C.L.Buckley,C.S.Kim,S.McGregor,andA.K.Seth,“Thefreeenergy
principle for action and perception: A mathematical review,” J. Math.
ACKNOWLEDGMENT Psychol.,vol.81,pp.55–79,Dec.2017,doi:10.1016/j.jmp.2017.09.004.
[21] R. Bogacz, “A tutorial on the free-energy framework for modelling
The authors would like to thank Enago (www.enago.jp) for
perception and learning,” J. Math. Psychol., vol. 76, pp.198–211,
their English language reviewing services. Feb.2017,doi:10.1016/j.jmp.2015.11.003.
IWASHITAANDISHIKAWA:BUDDYSYSTEM:ADAPTIVEMENTALSTATESUPPORTSYSTEM 1257
[22] K.J.Friston,N.Trujillo-Barreto,andJ.Daunizeau,“DEM:Avariational [33] R. P. Dum, D. J. Levinthal, and P. L. Strick, “Motor, cognitive, and
treatmentofdynamicsystems,”Neuroimage,vol.41,no.3,pp.849–885, affective areas of the cerebral cortex influence the adrenal medulla,”
2008,doi:10.1016/j.neuroimage.2008.02.054. Proc.Nat.Acad.Sci.U.S.A.,vol.113,no.35,pp.9922–9927,2016,
[23] K. Friston, “Hierarchical models in the brain,” PLoS doi:10.1073/pnas.1605044113.
Comput. Biol., vol. 4, no. 11, 2008, Art. no. e1000211, [34] Z. B. Moses, L. J. Luecken, and J. C. Eason, “Measuring task-
doi:10.1371/journal.pcbi.1000211. related changes in heart rate variability,” in Proc. 29th Annu. Int.
[24] K.Friston,T.FitzGerald,F.Rigoli,P.Schwartenbeck,andG.Pezzulo, Conf. IEEE Eng. Med. Biol. Soc., Lyon, France, 2007, pp.644–647,
“Active inference: A process theory,” Neural Comput., vol. 29, no. 1, doi:10.1109/IEMBS.2007.4352372.
pp.1–49,Jan.2017,doi:10.1162/NECO_a_00912. [35] B.G.Wallin,“Sympatheticnerveactivityunderlyingelectrodermaland
[25] K. Friston, Q. Square, and J. Kilner, “Action understanding and cardiovascular reactions in man,” Psychophysiology, vol. 18, no. 4,
activeinference,”Biol.Cybern.,vol.104,no.1–2,pp.137–160,2011. pp.470–476,1981.
[Online].Available:https://doi.org/10.1007/s00422-011-0424-z. [36] A. Nozawa and M. Tacano, “Correlation analysis on alpha attenuation
[26] K.Friston,“Learningandinferenceinthebrain,”NeuralNetw.,vol.16, andnasalskintemperature,”J.Stat.Mech.TheoryExp.,vol.2009,no.1,
no.9,pp.1325–1352,2003,doi:10.1016/j.neunet.2003.06.005. 2009,Art.no.P01007,doi:10.1088/1742-5468/2009/01/P01007.
[27] S. D. Kreibig, “Autonomic nervous system activity in emotion:
[37] S.KoelschandL.Jancke,“Musicandtheheart,”Eur.HeartJ.,vol.36,
A review,” Biol. Psychol., vol. 84, no. 3, pp.394–421, 2010,
no.44,pp.3043–3048,2015,doi:10.1093/eurheartj/ehv430.
doi:10.1016/j.biopsycho.2010.03.010.
[38] M. J. Ross, P. Guthrie, and J.-C. Dumont, “The impact of modulated,
[28] P. Valdez and A. Mehrabian, “Effects of color on emotions,”
coloredlightontheautonomicnervoussystem,”Adv.MindBodyMed.,
J. Exp. Psychol. Gen., vol. 123, no. 4, pp.394–409, 1994,
vol.27,no.4,pp.7–16,2013.
doi:10.1037/0096-3445.123.4.394.
[39] T. Hongratanaworakit, “Physiological effects in aromather-
[29] J. A. Benfield, B. D. Taff, P. Newman, and J. Smyth,
apy,” Songklanakarin J. Sci. Technol., vol. 26, pp.117–125,
“Natural sound facilitates mood recovery,” Ecopsychology,
2004.
vol. 6, no. 3, pp.183–188, 2014. [Online]. Available:
https://www.liebertpub.com/doi/10.1089/eco.2014.0028 [40] T.M.BandY.Kume,“Developmentofaglasses-likewearabledevice
[30] S. Warrenburg, “Effects of fragrance on emotions: Moods and to measure nasal skin temperature,” in Proc. Int. Conf. Hum. Comput.
physiology,” Chem. Sens., vol. 30, no. s1, pp.248–249, 2005, Interact.,vol.1,2015,pp.727–732,doi:10.1007/978-3-319-21380-4.
doi:10.1093/chemse/bjh208. [41] E. Erdfelder, F. Faul, A. Buchner, and A.-G. Lang, “Statistical power
[31] J.D.Dodson,“Therelationofstrengthofstimulustorapidityofhabit- analysesusingG*Power3.1:Testsforcorrelationandregressionanal-
formation in the kitten,” J. Anim. Behav., vol. 5, no. 4, pp.330–336, yses,” Behav. Res. Methods, vol. 41, no. 4, pp.1149–1160, 2009,
1915,doi:10.1037/h0073415. doi:10.3758/BRM.41.4.1149.
[32] J. B. Furness, “The organisation of the autonomic nervous system: [42] K. Friston, F. Rigoli, D. Ognibene, C. Mathys, T. Fitzgerald, and
Peripheralconnections,”Auton.Neurosci.BasicClin.,vol.130,no.1–2, G. Pezzulo, “Active inference and epistemic value,” Cogn. Neurosci.,
pp.1–5,2006,doi:10.1016/j.autneu.2006.05.003. vol.6,no.4,pp.187–214,2015,doi:10.1080/17588928.2015.1020053.