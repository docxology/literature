Accepted for publication in the 2020 International Conference on Robotics and Automation (ICRA)
Cognitive and motor compliance in intentional human-robot interaction
Hendry F. Chameâ€  and Jun Taniâ€ 
Abstractâ€”Embodimentandsubjectiveexperienceinhuman- of Fristonâ€™s free energy principle theory [8], according to
robot interaction are important aspects to consider when whichthebrainattemptstoresolveconflictspossiblyappear-
studying both natural cognition and adaptive robotics to hu- ing between the top-down information flow, developed by a
man environments. Although several researches have focused
generative model, and the bottom-up sensory flow, through
on nonverbal communication and collaboration, the study of
minimizing free energy as a statistical quantity.
autonomous physical interaction has obtained less attention.
From the perspective of neurorobotics, we investigate the Our research is interested in the study of harmonious
relation between intentionality, motor compliance, cognitive (or coherent) and disharmonious (or incoherent) interaction
compliance,andbehavioremergence.Weproposeavariational between the human and the robot. Thus, an important
modelinspiredbytheprinciplesofpredictivecodingandactive
distinction is established between physical (or motor) and
inference to study intentionality and cognitive compliance, and
cognitive (or representational) compliance. The former is an intermittent control concept for motor deliberation and
compliance based on torque feed-back. Our experiments with defined as the capacity to be driven by external physical
the humanoid Torobo portrait interesting perspectives for the action, which can be conforming or conflicting with the
bio-inspired study of developmental and social processes. intended action; whereas the later involves the flexibility in
modifying the generative process according to information
I. INTRODUCTION
fromtheascendingprocess,thatis,thecapacitytobedriven
Our society is probably changing into a world populated
by sensory evidence (the inference process).
by natural and artificial beings, where we will coexist with
After having established the previous considerations, we
robots at home and the office. However, at present, there is
claim that the originality and main contribution of our
still an important gap to be overcome, in particular, when
research is to study the relation between physical and cog-
we pause to contemplate the amazing complexity of natural
nitive compliance in purposeful motor interaction. Within
behavior. This sort of sophistication is related to important
the perspective of neurorobotics, we propose a variational
properties, among which are autonomy and intentionality.
model, inspired by the principles of predictive coding and
When studying motor interaction between a human and
active inference [9], to study intentionality and cognitive
a robot, some works have focused on goal-directed collab-
compliance. We propose an intermittent control concept
oration (e.g. mediated by physical objects [1], and behavior
for the study of motor deliberation and compliance that
improvement [2]), leaving aside the social dimension of the
takes into account torque feed-back. From the analysis of
interaction with the robot partner. With some exceptions,
interaction and behavior emergence in experiments with the
direct contact in autonomous behavior has been avoided
human-sized Torobo platform, we illustrate the relevance of
[3]. Moreover, in social robotics, the non-verbal aspects of
our work to the study of direct interaction, with interesting
interaction have been studied from diverse modalities (e.g.
perspectives for the bio-inspired approach to developmental
facial expressions [4] and touch [5]), though motor clues in
and social robotics.
direct contact have attracted less attention.
In psychology, physical interaction is considered an in- II. RELATEDWORK
tuitive means of communication during human early life, Although independently developed, our research has been
which underlies the acquisition and development of social consistent with the free energy principle theory [9]. In
and cognitive skills [6]. Hence, it is paramount for human [10] a deterministic hierarchical neural network architecture
development, and it is relevant for studying learning from operating on different time scales (i.e. a Multiple Timescale
the perspective of developmental robotics [7]. Recurrent Neural Network, or MTRNN) was proposed for
Intentional motor interaction is certainly a broad phe- learning temporal sequences. Inspired by these ideas, be-
nomenon that ought to be delimited. Thus, by taking inspi- havior imitation was studied from visual and proprioceptive
rationonneuroscienceresearch,weholdtheassumptionthat representations (e.g. in [11]).
intentionalityinvolvesanoptimizationprocessinhierarchical Inordertoimprovegeneralization,stochasticmodelinghas
representation structures, in which a top-down information beenadoptedwhereuncertaintyintrainingdataislearnedas
flowcharacterizestheagencyofpurposefulactionsinagiven a Gaussian distribution in the output layer [12]. However, a
context, whereas a bottom-up information flow accounts for limitation of this approach is the fact that the context layers
theirconsequences.Weinvestigatethiswithintheperspective in the hierarchy remained deterministic.
The emergence of the variational Bayes auto-encoder
â€  CognitiveNeuroroboticsResearchUnit(CNRU),OkinawaInstituteof
(VAE) framework [13] paved the way for optimizing in-
ScienceandTechnology(OIST),Okinawa,Japan904-0495.
E-mail:{hendryfchame,tani1216jp}@gmail.com ference and learning probabilistic distributions in latent
0202
nuJ
03
]OR.sc[
4v35710.1191:viXra
variables, by re-parameterizing the variational lower bound. A two-layer PV-RNN architecture
This framework has been extended for studying on-line ErrorRegression(inference) Generation(prediction)
interaction,asforexampleanticipatinghumanbehavior[14]. ğ›q,ğ›”q ğš ,ğš ğ›œ ğ›q,ğ›”q ğš ,ğš ğ›œ ğ›p,ğ›”p ğ›œ
Î¼ Ïƒ Î¼ Ïƒ
The predictive-coding-inspired variational recurrent neu-
ral network (PV-RNN) [15] has been proposed recently ğ³ ğ³ ğ³
in our lab. It is a variational model capable of learning High
probabilistic structures in fluctuating temporal patterns, by â‹¯ ğ ğ ğ â‹¯
modifying dynamically the stochasticity of the represented
latentstates.DifferentfromVAEs,inputsarenotpropagated ğ›q,ğ›”q ğš ,ğš ğ›œ ğ›q,ğ›”q ğš ,ğš ğ›œ ğ›p,ğ›”p ğ›œ
Î¼ Ïƒ Î¼ Ïƒ
inthenetworkduringforwardcomputations.Instead,predic-
tion errors are back propagated through time (BPTT). ğ³ ğ³ ğ³
Unlike [11], where the robot imitates the human behavior Low
from visual input, our work is focused on direct physical â‹¯ ğ ğ ğ â‹¯
interactionbasedexclusivelyontheproprioceptivesourceof
information. Since our interest is to investigate autonomous Output ğ± ğ± ğ±
and possibly conflicting interaction, different from [14], our
study does not focus on predicting the human behavior, but ğ ğ
ontheinferenceprocessoverproprioceptiverepresentations.
Evidence ğ² ğ²
Thus, the agent receives the human intentions through how
its body posture is changed within the interaction, which
Time â‹¯ ğ‘¡âˆ’1 ğ‘¡ ğ‘¡+1 â‹¯
characterizes a form of primary intersubjective experience
[16], as studied in embodied social cognition (ESC) theory.
Fig. 1: The notation has been simplified for clarity, so the ğ‘˜
and ğ‘¡ indexes have been dropped. The time constant ğœ„ğ‘˜ (see
III. COGNITIVECOMPLIANCE Eq. (2)) is greater in the High layer than in the Low layer.
Since the High layer is the top on the hierarchy, the term
As a variational framework, PV-RNN includes a gener- ğ–ğ‘˜ğ‘˜+1ğğ‘˜+1 is removed, analogously, the term ğ–ğ‘˜ğ‘˜âˆ’1ğğ‘˜âˆ’1
dd ğ‘¡âˆ’1 dd ğ‘¡âˆ’1
ative and an inference model (see Fig. 1). The generative is removed for the Low layer. The top-down process flow is
model involves the prior distributions. It does hierarchical representedbygrayarrows.Redarrowsillustratethebottom-
predictions on the output layer following a top-down flow. upprocessflow,whereerrorisbackpropagatedthroughtime.
That is, the prediction is generated from the information The on-line inference process computed in a sliding time
represented in the latent state. The inference model involves window is named Error Regression [10].
posterior distributions, so the information flow goes in the
bottom-up sense. Predictions are done starting from the evi-
dence(i.e.,agivenobservation),andthelatentrepresentation
is modified in order to approximate the evidence.
ğ®ğ‘˜ =ğ–ğ‘˜ğ‘˜ğğ‘˜ +ğ–ğ‘˜ğ‘˜âˆ’1ğğ‘˜âˆ’1+ğ–ğ‘˜ğ‘˜+1ğğ‘˜+1+ğ–ğ‘˜ğ‘˜ğ³ğ‘˜
Let1 the generative model ğ‘ƒ be defined from the pa- ğ‘¡ ( dd ğ‘¡âˆ’)1 dd ğ‘¡âˆ’1 dd ğ‘¡âˆ’1 dd ğ‘¡
rameters ğœ™, distributed among ğœ™ the components: generated ğ¡ğ‘˜ ğ‘¡ = 1âˆ’ ğœ„ 1 ğ¡ğ‘˜ ğ‘¡âˆ’1 + ğœ„ 1ğ®ğ‘˜ ğ‘¡ .
(ğ‘˜ ) ğ‘˜
predictionğ±,stochasticğ³andthedeterministicğlatentstates. ğğ‘˜ =tanh ğ¡ğ‘˜
ğ‘¡ ğ‘¡
For a prediction ğ± = (ğ± ,ğ± ,...,ğ± ), and considering the (2)
parameters ğœ™ x , ğœ™ z , 1âˆ¶ a ğ‘‡ nd ğœ™ d , 1 ğ‘ƒ ğœ™ 2 facto ğ‘‡ rizes such that: sia T n h w e i p th rio d r ia d g i o st n r a ib l u c t o io v n ar ğ‘ƒ ia ğœ™ nzc ( e ğ³ ğ‘¡ m | ğ a ğ‘¡ t âˆ’ ri 1 x ) , i s s u m ch od th e a le t dasaGaus-
ğ‘ƒ ğœ™ ( ğ± 1âˆ¶ğ‘‡ ,ğ³ 1âˆ¶ğ‘‡ ,ğ 1âˆ¶ğ‘‡| ğ³ 0 ,ğ 0 ) = ğ‘ƒ ğœ™ z ( ğ³ ğ‘¡| ğ ğ‘¡âˆ’1 ) =îˆº ( ğ³ ğ‘¡ ;ğ› p ğ‘¡ ,ğ›” p ğ‘¡ ) , (3)
âˆ ğ‘‡ ( ) ( ) ( ) (1) where ğ› p and ğ›” p are, respectively, the mean and standard
ğ‘ƒ ğœ™ x ğ± ğ‘¡| ğ ğ‘¡ ğ‘ƒ ğœ™ z ğ³ ğ‘¡| ğ ğ‘¡âˆ’1 ğ‘ƒ ğœ™ d ğ ğ‘¡| ğ ğ‘¡âˆ’1 ,ğ³ ğ‘¡ deviation ğ‘¡ of ğ³ = ğ‘¡ ğ› p +ğ›” p âˆ—ğ›œ, with ğ›œ sampled from îˆº(0,1).
ğ‘¡=1 ğ­ ğ‘¡ ğ‘¡
The variables [ğ› p,log (ğ›” p )] = ğ‘“ (ğ ) are obtained with
Let the deterministic states be defined according to a ğ‘“ (.) the one lay ğ‘¡ er feed-f ğ‘¡ orward ğœ™ nğ‘§eur ğ‘¡âˆ’ a 1 l network, such that
ğœ™
ğ‘§
MTRNN structure. For the ğ‘˜th context layer at time ğ‘¡, with
( )
timescale ğœ„ğ‘˜, the internal dynamics are represented such that ğ› p
ğ‘¡
,ğ‘˜
(
=tan
)
h ğ–ğ‘˜
Î¼d
ğ‘˜ğğ‘˜
ğ‘¡âˆ’1
+ğ› p
Î¼
,ğ‘˜
. (4)
log ğ›” p,ğ‘˜ =ğ–ğ‘˜ğ‘˜ğğ‘˜ +ğ› p,ğ‘˜
ğ‘¡ Ïƒd ğ‘¡âˆ’1 Ïƒ
1Notation: layerâ€™s latent states are denoted bold low-case, biases are
denoted ğ›, weight connexion are denoted ğ– with subscripts indicating Let the inference model ğ‘„ ğœ‹ (the approximate posterior)
the origin and destination of the connection (e.g., ğ–
zd
are the weights be defined from the parameters ğœ‹, such that
connecting ğ³ to ğ units). Superscripts ğ‘˜ indicate the level in the MTRNN
hierarchy.Finally,thesuperscriptspandqareusedtodistinguishbetween
variablesthatbelongtothepriorandposteriordistributions,respectively. ğ‘„
ğœ‹
(ğ³
ğ‘¡|
ğ
ğ‘¡âˆ’1
,ğ
ğ‘¡âˆ¶ğ‘‡
)=îˆº ( ğ³
ğ‘¡
;ğ› q
ğ‘¡
,ğ›” q
ğ‘¡
) , (5)
where ğ› q and ğ›” q are, respectively, the mean and standard Computational theories of human control have pointed
ğ‘¡ ğ‘¡
deviation of ğ³ =ğ› q +ğ›” q âˆ—ğ›œ, with ğ›œ sampled from îˆº(0,1). out the plausibility of continuous and intermittent control
ğ­ ğ‘¡ ğ‘¡
Thevariables[ğ› q,log(ğ›” q )]=ğ‘“ (ğ ,ğšxÌ„)areobtainedwith systemsinthebrain,withthelatterbeingpossiblydrivenby
ğ‘“ (.) the one la ğ‘¡ yer feed ğ‘¡ -forwar ğœ‹ dğ‘§ne ğ‘¡âˆ’ u 1 ral network, such that events [18]. Intermittent control is related to the prefrontal
ğœ‹
ğ‘§ cortex, the premotor cortex, and the basal ganglia areas, it
( )
ğ› q,ğ‘˜ =tanh ğ–ğ‘˜ğ‘˜ğğ‘˜ +ğšxÌ„,ğ‘˜+ğ› q,ğ‘˜ has been studied in the context of postural regulation [19].
ğ‘¡ ( ) Î¼d ğ‘¡âˆ’1 Î¼,ğ‘¡ Î¼ . (6) We model motor control as a hybrid intermittent process
log ğ›” q ğ‘¡ ,ğ‘˜ =ğ–ğ‘˜ Ïƒ ğ‘˜ d ğğ‘˜ ğ‘¡âˆ’1 +ğš Ïƒ xÌ„, , ğ‘˜ ğ‘¡ +ğ› q Ïƒ ,ğ‘˜ driven by intentionality and social interaction. The rationale
behind this is the following. When contact between the
TheparametersğšxÌ„ areintroducedtoprovidethenetwork
1âˆ¶ğ‘‡ human and the robot is established, their intended motion
with information about the prediction error in relation to
may complement or be to some extent incongruent. Thus,
a given pattern ğ±Ì„. Thus, ğšxÌ„ is changed back propagating
1âˆ¶ğ‘‡ in both the human and the robot cases, the body posture
through time the prediction error ğ , so information about
ğ‘¡âˆ¶ğ‘‡ must be adapted to the otherâ€™s influence to preserve a safe
the future steps of ğ±Ì„ , and existing dependencies with the
ğ‘¡âˆ¶ğ‘‡ interaction. Expressed in other terms, once external forces
current time step ğ‘¡, are captured. These terms are defined by
acting on the body induce significant joint torques, the joint
ğšxÌ„,ğ‘˜ =ğšxÌ„,ğ‘˜+ğ›¼ ğœ•ğ¿ should exhibit viscoelasticity, so it becomes compliant to
Î¼,ğ‘¡ Î¼,ğ‘¡ ğœ•ğš Î¼ xÌ„, , ğ‘˜ ğ‘¡ . (7) the external force. Once the external constraints cease to be
ğšxÌ„,ğ‘˜ =ğšxÌ„,ğ‘˜+ğ›¼ ğœ•ğ¿ relevant, active control should be resumed from a gradual
Ïƒ,ğ‘¡ Ïƒ,ğ‘¡ ğœ•ğš Ïƒ xÌ„, , ğ‘˜ ğ‘¡ transition to the desired state. Hence, in this hybrid view,
with ğ›¼ denoting the learning rate. eachrobotarticulationiscontrollableinstantaneouslybyone
Let the Variational Evidence Lower Bound (ELBO) of two possible schemes: a compliant and an active scheme.
ğ¿(ğœ™,ğœ‹) be defined by Let the switching between the compliant and the active
modes of joint ğ‘— at time ğ‘¡ rely on a continuous observation
ğ¿(ğœ™,ğœ‹)= âˆ‘ ğ‘‡ ( ğ¸ q Ï€ [ log ( ğ± ğ‘¡| ğÌƒ ğ‘¡ ,ğ³ ğ‘¡ )] âˆ’ (8) p d in r y o n t c h a e e m ss i i n cs o te f ğœ ra ğ‘— a t , c c h ğ‘¡ t t e . io T t n o h r e i q s e u s s e u ti c m ğœÌ‚ h ğ‘— a ,ğ‘¡ t t , h io a a n t nd of th th e e p e r x e t d e i r c n t a io l n tor o q n ue th i e nd b u o c d ed y
[ ğ‘¡=1 ])
ğ‘¤KL ğ‘„
Ï€
( ğ³
ğ‘¡|
ğÌƒ
ğ‘¡âˆ’1
,ğ
ğ‘¡âˆ¶ğ‘‡
)
â€–
ğ‘ƒ
ğœ™ ğ‘§
( ğ³
ğ‘¡|
ğÌƒ
ğ‘¡âˆ’1
) .
ğœÌ‚ext =ğœÌ‚ âˆ’ğœact. (11)
ğ‘—,ğ‘¡ ğ‘—,ğ‘¡ ğ‘—,ğ‘¡
Since ğ is deterministic given ğ and ğ³, ğÌƒ denotes the
centerof ğ‘¡ aDiracdistribution.The ğ‘¡ fi âˆ’ r 1 stterm ğ‘¡ atth ğ‘¡ erightofthe Thus, switching to the compliant mode occurs once | ğœÌ‚ ğ‘— e , x ğ‘¡ t | >
equationisareconstructioncomponent,itcorrespondstothe ğœth exceeds a threshold ğœth.
ğ‘— ğ‘—
expected log-likelihood under the posterior distribution ğ‘„ . Let the joint position ğœƒ ğ‘—,ğ‘¡ be regulated by the active
The second therm is a regulation component, it correspond Ï€ s control scheme in charge of tracking a reference position
to the Kullback-Leibler (KL) divergence between the prior ğœƒnet, intended by the agent (i.e. it is generated by the
ğ‘—,ğ‘¡
and the posterior distributions of the latent variables. The neural network). The target position ğœƒğ‘ğ‘ğ‘¡ , in relation to
ğ‘—,ğ‘¡+1
meta-parameterğ‘¤adjuststheoptimizationweightinlearning the observation ğœƒÌ‚ , is obtained from a discrete proportional
ğ‘—,ğ‘¡
the posterior and the prior distributions. After dropping the control law, such that
random variable notation to improve readability, the KL
( )
component can be expressed as ğœƒğ‘ğ‘ğ‘¡ =ğœ‚a ğœƒnet âˆ’ğœƒÌ‚ . (12)
ğ‘—,ğ‘¡+1 ğ‘—,ğ‘¡ ğ‘—,ğ‘¡ ğ‘—,ğ‘¡
KL [ ğ‘„ Ï€â€– ğ‘ƒ ğœ™ ğ‘§ ] =log ( ğ›” ğ›” p q ) + (ğ›pâˆ’ 2 ğ› ( q ğ›” )2 p) + 2 (ğ›”q)2 âˆ’ 1 2 (9) c p S o r i o n m p c p e o l r i t a ğœƒ i n o ğ‘—, t n ğ‘¡ a s l m c g h a a e y i m n e d ğœ‚ , i a ff i e n i r s o s c e r o d t n e a r s s i t d t h o e e ra c a b v o l o s y i i n d e fr a t o r b m a r n u s p ğœƒ i t t ğ‘— n i , o e ğ‘¡ m t n o m u ti n o o d d n e u s r , la t t te h h d e e
ğ‘—,ğ‘¡
Finally, the variable ğ± , related to the ğ‘–th dimension of by |ğœƒnet âˆ’ğœƒÌ‚ |, from a minimum to a maximum gain.
ğ‘–,ğ‘¡ | ğ‘—,ğ‘¡ ğ‘—,ğ‘¡|
the output space, is defined such that L|et the join|t position ğœƒ be regulated by the compliant
ğ‘—,ğ‘¡
control scheme in charge of following the torque induced
( )
ğ± =softmax ğ– ğ0+ğ› . (10) by the human. A discrete time proportional integral (PI)
ğ‘–,ğ‘¡ dxğ‘– ğ‘¡ xğ‘–
feedback control law with gains ğœ‚p and ğœ‚i is adopted, so
Unlike [15], we do not include in ğ± connections from the ğ‘— ğ‘—
ğ‘–,ğ‘¡ ( )
stochastic latent distributions at the Low level.
ğœƒext =ğœƒÌ‚ +ğœ‚pğœÌ‚ext +ğ‘“ ğœ‚i âˆ‘ ğœÌ‚ext . (13)
IV. MOTORCOMPLIANCE ğ‘—,ğ‘¡+1 ğ‘—,ğ‘¡ ğ‘— ğ‘—,ğ‘¡ ğ‘— ğ‘—,ğ‘¡
ğ‘¡
In conformity with the principles of ethics in robotics In both the active and the compliant schemes the target
experiments, inspired by the famous Asimovâ€™s three laws of correction is saturated to preserve safety in behavior. Thus,
robotics[17],motorcomplianceisstudiedwithinthecontext the function ğ‘“(.) acts as a reset windup to the integral term.
of social ethical conventions. Thus, the human and the robot Asexplainedbefore,duetothefactthatthecontrolisdone
actions must preserve each otherâ€™s integrity and safety. inthejointspace,aninterestingsituationemergeswherethe
joints may be set to different control schemes. Hence, the Hybrid motor control in Torobo
h
jo
u
i
m
nt
a
s
n
, w
pr
h
o
i
v
le
id
r
e
e
s
ce
fe
iv
ed
in
b
g
ac
f
k
ee
t
d
o
b
t
a
h
c
e
k
ro
ab
b
o
ot
ut
th
t
r
h
o
e
ug
ro
h
b
t
o
h
t
e
â€™s
c
i
o
n
m
te
p
n
l
t
i
i
a
o
n
n
t
ğ‘†ğ‘¡ğ‘ğ‘Ÿğ‘¡ Network ğœƒ ğ‘— n , e ğ‘¡ t
ğœƒÌ‚
H ğ‘—,ğ‘¡ ybrid ğœƒ ğ‘— âˆ— ,ğ‘¡+1 Planner ğ›‰â€  ğ‘—,ğ‘¡+1 Driver Hardwar
ğœÌ‚
e ğ‘—,ğ‘¡
from the active joints. However, it is also interesting to
include soft impedance in the compliant joints in order to
ğœact
enhance the interaction experience. Thus, the target position ğ‘—,ğ‘¡ Inversedynamicmodel
in the compliant scheme is obtained such that
ğœƒğ‘ğ‘œğ‘š =ğœƒext +ğœ‚nğ‘  ( ğœƒnet âˆ’ğœƒÌ‚ ) , (14) Fig. 2: The Network block includes the PV-RNN model,
ğ‘—,ğ‘¡+1 ğ‘—,ğ‘¡+1 ğ‘— ğ‘—,ğ‘¡ ğ‘—,ğ‘¡ it computes the desired position ğœƒnet based on the current
with ğœ‚
ğ‘—
n a gain parameter and ğ‘ (.) a saturation function. estimationğœƒÌ‚ .FrommeasuredğœÌ‚ ğ‘— a , n ğ‘¡ destimatedtorqueğœact
ğ‘—,ğ‘¡ ğ‘—,ğ‘¡ ğ‘—,ğ‘¡
V. METHODOLOGY (by inverse dynamics), the Hybrid controller computes the
Ontherobotside,thevariablesstudiedwereintentionality next target ğœƒ
ğ‘—
âˆ—
,ğ‘¡+1
. The Planner calculates a trajectory for the
(desired behavior in relation to the humanâ€™s actions) and target in open-loop via intermediate positions ğ›‰â€  . Lately,
ğ‘—,ğ‘¡+1
compliance in the physical (or motor, M) and the represen- the robot Driver manages the Hardware plant.
tational (or cognitive, C) dimensions. As shown in Table I,
severalprofilesweredefinedtostudycompliance.Regarding
The experimental and simulation environments
themotordimension,theexclusivelycompliantmodeM
teach
was employed for kinesthetic demonstration of the behavior
primitives, and the interaction mode M was set based on
inter
the hybrid controller (including the active and the compliant
schemes). Concerning the cognitive dimension, the profiles
C , C , and C were defined corresponding, respec-
rigid mod flex
tively, to a rigid, a moderate, and a flexible agent.
TABLE I: The cognitive and motor profiles.
Profile Description
M Kinestheticteaching(withthecomplianceschemeonly)
teach
M Interaction(withtheactiveandcompliantschemes)
inter
C Strongintentionality(ğ‘¤=0.01)
rigid
C Moderateintentionality(ğ‘¤=0.001)
mod
C Lowintentionality(ğ‘¤=0.0001)
flex
The implementation of hybrid motor control in Torobo is
illustrated in Fig. 2. A dataset was constituted with three
behavior primitives (see Fig. 3), sampled at 4 Hz, during 90
timesteps.ThecognitiveprofilesinTableIweremodeledin
thePV-RNNarchitecture(seeFig.1).ItincludedaLowlayer
(40dunits,4zunits,andğœ„=2)andaHighlayer(10dunits,
1 z unit, and ğœ„ = 10). All learnable variables were updated
during the training phase, whereas in interaction mode only
the terms ğš were updated (see Eqs. (6)(7)). Conforming to
Table I, specific values for ğ‘¤ (Eq. (8)) were selected for A B C
training (50K epochs). For interaction ğ‘¤=1.0eâˆ’5 was set
for all the profiles, since it produced the best results. Fig. 3: The primitives visualized in the Gazebo simulator
Onthehumanside,thevariablesunderstudyareintention- were captured by kinesthetic demonstration with Torobo.
ality (desired behavior in relation to the robotâ€™s actions) and
engagement(physicaleffortsinvestedinthetask).Finally,on
the mutual interaction side, the variable behavior emergence Experimental protocol: Six scenarios were portrayed
(how similar the robotâ€™s posture is to the known primitives) conforming the pairs AB, AC, BA, BC, CA, CB; with the
is studied through a regression observer. Since the motion left term representing the robotâ€™s intended behavior, and the
primitives were reasonably different from one another, a right term corresponding to the human intended behavior
feed-forwardmodelwasdesigned(12Input,150Hidden ,15 (thesubjectwasinstructedtoinduceagivenprimitiveinthe
1
Hidden ,3Output,withtanhactivationforthehiddenlayers robot behavior). For example, AB means the robot wants to
2
and sigmoid activation for the output layer), and trained by doAandthehumanwantstodoB.Atotalof54trialswere
supervisedlearningwiththejointinstantaneouspositions.A registered for the experimental subject (6 pairs x 3 cognitive
success rate of 100% was achieved in the test set. models x 3 times), during 300 time steps each.
Software platform: The open-source implementation
of the models is provided by the neural robotics library
[20]. From previous experiences [21], C++ was chosen as
the base programming language. The programs run in the
Robot Operative System (ROS) Kinetic Kane over Ubuntu
16.04 LTS. The Network block (Fig. 2) ran at 4 Hz in the
host computer (Alienware Aurora R7, 12 IntelÂ® Coreâ„¢ i7-
8700K CPU at 3.70GHz, and 31.1 GiB RAM memory).
In interaction mode, BPTT was computed within a sliding
window (20 time steps) during 28 epochs. The models
learned 12 degrees of freedom (6 for each arm), constant
desiredreferencesweregiventothetorsoandtheheadjoints.
VI. RESULTS
The training results are shown in Fig. 4. As noticed,
althoughthereconstructioncomponentoftheELBO(seeEq.
(8)) approached to zero in all cases, which indicates good
predictions from the posterior distribution; the smaller the
meta-parameter ğ‘¤ was set (right plot), the more dissimilar
the posterior and the prior distributions were, which implies
more stochasticity in the generative process.
0.8
0.6
0.4
0.2
0.0
0 1 2 3 4 5 n Ã— 104
noitcurtsnoceR
103
Ã—
Crigid 1.5
Cmod
Cflex
1.0
0.5
0.0
0 1 2 3 4 5 n Ã— 104
noitalugeR
Reconstruction Regulation 104
Ã—
Crigid
Cmod
Cflex
Fig. 4: Training during 50k epochs. The reconstruction and
the regulation terms of the ELBO (see Eq. (8)).
A. Simulations
Two preliminary studies were conducted. The first one
investigated the accuracy of the generative process. For this,
theprimitivesweregeneratedduring90timesteps(thesame
length of the captured sequences in the dataset) by each
cognitive model (see Table I). The comparison is done by
calculating at each time step the mean squared error (MSE)
between the reference ğ±Ì„ and the generated ğ± sequences. The
models C and C performed similarly well (see Fig.
rigid mod
5), whereas C had a more stochastic generative process.
flex
200
100
0
0 20 40 60 80
Timestep
gedniESM
The second study analyzed cognitive compliance through
thelatentstateğ.Figure6presentsacomparisonontwoprin-
cipal component analysis (PCA) for the generation process
oftheprimitivesA,B,andC(leftcolumn),andtheinference
process (right column). Errors were BPTT by taking the
differencebetweenthemodelâ€™spredictionandrecordedjoint
positions of A, B, and C. What is being analyzed is the
possibility of transition from the generation of one primitive
to another, given the evidence. That is, to what extent
stochasticity from the hidden random distributions, received
through the parameters ğš (see Eqs. (6)(7)), is allowed to
affect the contextual representation during on-line inference.
All transitions could be obtained, except from BC with
C . As noticed, C representations were simpler, and
rigid flex
converged faster to conform the evidence.
Generation process Inference process
4 4
A BA 3 B 3 BB
2 C 2 BC
1 1
0 0
1 1
âˆ’ âˆ’
âˆ’ 2 C rigid âˆ’ 2 C rigid
2 0 2 4 2 0 2 4 âˆ’ âˆ’
4 4
A BA
3 B 3 BB
2 C 2 BC
1 1
0 0
1 1
âˆ’ âˆ’ C C 2 mod 2 mod âˆ’ âˆ’
2 0 2 4 2 0 2 4 âˆ’ âˆ’
4 4
A BA
3 B 3 BB
2 C 2 BC
1 1
0 0
1 1 âˆ’ âˆ’
âˆ’ 2 C flex âˆ’ 2 C flex
2 0 2 4 2 0 2 4 Iniâˆ’tialstate âˆ’
Finalstates
Fig. 6: Two-PCA High layerâ€™s states ğ. Agents were set to
generateB(intention),butreceivedA,B,andCasevidence.
B. Experiments
Theperformanceoftheintermittentcontrollerforcongru-
Generative process accuracy ent and incongruent interaction is shown in Fig. 7. As no-
ticed, smooth trajectories resulted from tracking the network
A Crigid
B Cmod signalwhilecomplyingtotheexternaltorqueinducedbythe
C Cflex
human. Table II compares emergent behavior to the robotâ€™s
intended behavior for the three cognitive agents, based on
the regression observerâ€™s evaluation. Table III shows the
meanandstandarddeviationoftheestimatedexternaltorque
during the experiment. In Fig. 8, emergent behavior for the
pair BC is compared to the intended behavior of the robot2.
Fig. 5: Comparison between the references constituting the
training dataset and the learned generation.
2Theexperimentvideoisavailableat:https://youtu.be/f4TXmB7HV-s
Motor control performance
TABLEII:Probabilityoftherobotintendingğ¼ andbehaving
ğµ, according to the desired motions induced by the human.
1
0 ğ‚ ğ‚ ğ‚
rigid mod flex
Data ğ‘(ğ¼) ğ‘(ğµ) ğ‘(ğ¼) ğ‘(ğµ) ğ‘(ğ¼) ğ‘(ğµ)
âˆ’ âˆ’ 2 1 e Î˜ Î˜ ğœƒ ğœƒ ğœ Ë† Ì‚ Ì‚ e nn x ee t tt Congruentinteraction S E i x m p. ul t a r t i i a o l n 1 0 0 . . 4 1 6 2 6 2 0 0 . . 4 3 6 6 7 5 0 0 . . 7 5 6 6 1 2 0 0 . . 7 5 5 8 9 8 0 0 . . 8 2 4 4 3 5 0 0 . . 8 3 4 9 1 3
Exp.trial2 0.274 0.476 0.705 0.686 0.394 0.451
0 10000 20000 30000 40000 50000 60000 70000 Exp.trial3 0.302 0.498 0.590 0.619 0.405 0.501
4
2
0 TABLE III: External torque âˆ‘ ğ‘—| ğœÌ‚ ğ‘— e , x ğ‘¡ t | in Nm for trials.
âˆ’ 2 e Î˜ğœƒ ğœÌ‚e nn x ee t tt
âˆ’ 4 Î˜ğœƒË†Ì‚ Incongruentinteraction ğ‚ rigid ğ‚ mod ğ‚ flex
Case ğ‘‡ ğ‘‡ ğ‘‡ ğ‘‡ ğ‘‡ ğ‘‡ ğ‘‡ ğ‘‡ ğ‘‡
0 10000 20000 30000 40000 50000 60000 70000 1 2 3 M 1 ean 2 3 1 2 3
Timeinms
AB 2.0 1.4 1.9 1.9 1.8 1.8 2.0 2.0 1.9
Fig. 7: Toroboâ€™s right elbow follows a sinusoidal limit cycle AC 2.4 2.0 1.1 2.2 1.8 1.7 2.4 2.0 2.2
reference. Torque in Nm, angle in rad. BA 1.9 1.6 1.4 1.6 1.4 1.6 1.7 1.4 1.4
BC 2.2 2.0 1.4 2.1 1.9 2.0 2.3 1.8 2.2
CA 1.9 2.2 1.9 2.0 1.5 2.1 1.8 1.9 2.2
CB 1.9 2.1 1.8 1.9 1.9 1.8 2.0 2.2 2.1
Emergent behavior vs. intention (3rd BC trial) StandardDeviation
5 C rigid AB 0.9 0.8 0.9 1.0 1.0 0.9 1.1 1.0 1.0
0 AC 1.2 0.9 0.7 1.0 0.9 0.8 1.1 1.0 1.1
BA 1.0 0.9 0.7 0.9 0.9 0.8 0.9 0.8 0.8
5 PrimitiveB PrimitiveA C rigid BC 1.0 0.9 0.8 1.0 0.9 1.0 1.2 0.9 1.0
0 CA 0.9 0.9 0.8 1.0 1.0 1.3 0.9 0.9 1.0
CB 0.8 1.0 0.8 0.9 1.0 0.8 1.0 1.1 0.9
5 C mod
0
5 PrimitiveB PrimitiveC C mod
0
hybridmotorcontrolscheme.Consideringtheflexibleagent,
5 C flex it likely adopted the desired posture shape, but efforts were
0
required to keep consistent interaction. It was challenging
5 PrimitiveB PrimitiveC C flex to induce gradual changes in behavior, due to erraticness
0
and loss of bilateral symmetry, which would explain the
0 50 100 150 200 250 300
Timestep disparity of simulated and experimental results. In relation
to the moderate agent, smoother interactions were obtained
Fig. 8: Two-PCA, emergent behavior: green, intention: red.
and less efforts appeared to be invested, since the agent was
able to both change the posture and generate the behavior
consistently.Finally,inagreementwith[7],learningprobably
C. Discussion occurred on the human side, since both ğ‘(ğ¼) and ğ‘(ğµ) were
The results supported the plausibility to model distinct generally larger from the first to the third trials.
cognitive styles through the meta parameter ğ‘¤. Thus, by
VII. CONCLUSIONSANDFUTUREWORK
learning to strongly approximate the prior and posterior
distributions(seeFig4),therigidagentwasabletogenerate This work focused on the study of physical interaction
accurate behavior (see Fig 5), but it was less sensitive to between a human and a robot, and considered both co-
evidence.Indeed,itobtainedgreater differencesbetweenthe herent and incoherent scenarios. An important distinction
intended and observed behaviors (see Table II). Contrarily, was established between motor and cognitive compliance.
theflexibleagentwastrainedinvestinglesseffortsinlearning A variational model, inspired by the principles of predictive
toapproximatethesedistributions,whichresultedinstochas- codingandactiveinference,wasproposedtomodelcognitive
tic or hesitating behavior. The moderate agent presented a complianceasthecapacitytobedrivenbysensoryevidence.
good balance between accuracy and cognitive flexibility. Anintermittentcontrolconceptwasproposedtostudymotor
Whenanalyzingthehumanengagementintheinteraction, deliberation while adapting to the human interaction, based
qualitativedifferencescanbeobservedamongtheagents(see on torque feed-back. The experiments results pointed out
Table III, the lowest mean values per trial are highlighted in a trade-off between cognitive compliance and refinement
bold). Since the subject was instructed to induce as long in autonomous motion. We believe that this trade-off can
as possible a certain behavior, with the rigid agent efforts be explored in developmental robotics to investigate on-line
were probably more invested in modifying the robot posture learning[7].Fromtheperspectiveofhuman-robotinteraction
to encourage the generation of the desired primitive, given research,ourresultswouldalsoopeninterestingpossibilities
theagentâ€™sreluctancetochange.Hence,theinteractionswere forthestudyofsocialcognitioninhumanscience,including
arduousandreliedmostlyonthecompliantcomponentofthe topics in motivation [22] and intersubjectivity [20].
REFERENCES robotandahumanbyusingthepredictivecodingframework,â€IEEE
TransactionsonSystems,Man,andCybernetics:Systems,2018.
[1] S. Pellegrinelli, H. Admoni, S. Javdani, and S. Srinivasa, â€œHuman- [12] S.Murata,J.Namikawa,H.Arie,S.Sugano,andJ.Tani,â€œLearning
robot shared workspace collaboration via hindsight optimization,â€ in toreproducefluctuatingtimeseriesbyinferringtheirtime-dependent
2016 IEEE/RSJ International Conference on Intelligent Robots and stochasticproperties:Applicationinrobotlearningviatutoring,â€IEEE
Systems(IROS). IEEE,2016,pp.831â€“838. Transactions on Autonomous Mental Development, vol. 5, no. 4, pp.
[2] C. T. Landi, F. Ferraguti, C. Fantuzzi, and C. Secchi, â€œA passivity- 298â€“310,2013.
basedstrategyforcoachinginhuman-robotinteraction,â€in2018IEEE [13] D. P. Kingma and M. Welling, â€œAuto-encoding variational bayes,â€
InternationalConferenceonRoboticsandAutomation(ICRA). IEEE, arXivpreprintarXiv:1312.6114,2013.
2018,pp.1â€“6. [14] J.BÃ¼tepage,H.KjellstrÃ¶m,andD.Kragic,â€œAnticipatingmanyfutures:
[3] M. Kollmitz, D. BÃ¼scher, T. Schubert, and W. Burgard, â€œWhole- Online human motion prediction and generation for human-robot
body sensory concept for compliant mobile robots,â€ in 2018 IEEE interaction,â€in2018IEEEInternationalConferenceonRoboticsand
InternationalConferenceonRoboticsandAutomation(ICRA). IEEE, Automation(ICRA). IEEE,2018,pp.1â€“9.
2018,pp.1â€“5. [15] A.AhmadiandJ.Tani,â€œAnovelpredictive-coding-inspiredvariational
[4] C. T. Ishi, T. Minato, and H. Ishiguro, â€œAnalysis and generation rnnmodelforonlinepredictionandrecognition,â€Neuralcomputation,
of laughter motions, and evaluation in an android robot,â€ APSIPA vol.31,no.11,pp.2025â€“2074,2019.
TransactionsonSignalandInformationProcessing,vol.8,2019. [16] S.Spaulding,â€œIntroductiontodebatesonembodiedsocialcognition,â€
[5] Y.HuandG.Hoffman,â€œUsingskintexturechangetodesignemotion PhenomenologyandtheCognitiveSciences,vol.11,no.4,pp.431â€“
expression in social robots,â€ in 2019 14th ACM/IEEE International 448,2012.
Conference on Human-Robot Interaction (HRI). IEEE, 2019, pp. [17] I.Asimov,I,robot. GnomePress,1950,vol.1.
2â€“10. [18] P.Gawthrop,I.Loram,M.Lakie,andH.Gollee,â€œIntermittentcontrol:
[6] L.S.Vygotsky,Mindinsociety:Thedevelopmentofhigherpsycho- acomputationaltheoryofhumancontrol,â€Biologicalcybernetics,vol.
logicalprocesses. Harvarduniversitypress,1980. 104,no.1-2,pp.31â€“51,2011.
[7] S. Ikemoto, H. B. Amor, T. Minato, B. Jung, and H. Ishiguro, [19] H.Tanabe,K.Fujii,Y.Suzuki,andM.Kouzaki,â€œEffectofintermittent
â€œPhysical human-robot interaction: Mutual learning and adaptation,â€ feedbackcontrolonrobustnessofhuman-likeposturalcontrolsystem,â€
IEEERoboticsAutomationMagazine,vol.19,no.4,pp.24â€“35,Dec Scientificreports,vol.6,p.22446,2016.
2012. [20] H. F. Chame, A. Ahmadi, and J. Tani, â€œTowards hybrid primary
[8] K.Friston,â€œThefree-energyprinciple:aunifiedbraintheory?â€Nature intersubjectivity: a neural robotics library for human science,â€ arXiv
reviewsneuroscience,vol.11,no.2,p.127,2010. preprintarXiv:2006.15948,2020.
[9] K.Friston,J.Mattout,andJ.Kilner,â€œActionunderstandingandactive [21] H. F. Chame and C. Chevallereau, â€œGrounding humanoid visually
inference,â€ Biological cybernetics, vol. 104, no. 1-2, pp. 137â€“160, guided walking: From action-independent to action-oriented knowl-
2011. edge,â€InformationSciences,vol.352,pp.79â€“97,2016.
[10] J.Tani,â€œLearningtogeneratearticulatedbehaviorthroughthebottom- [22] H. F. Chame, F. P. Mota, and S. S. da Costa Botelho, â€œA dynamic
upandthetop-downinteractionprocesses,â€NeuralNetworks,vol.16, computationalmodelofmotivationbasedonself-determinationtheory
no.1,pp.11â€“23,2003. andCANN,â€InformationSciences,vol.476,pp.319â€“336,2019.
[11] J. Hwang, J. Kim, A. Ahmadi, M. Choi, and J. Tani, â€œDealing with
large-scalespatio-temporalpatternsinimitativeinteractionbetweena