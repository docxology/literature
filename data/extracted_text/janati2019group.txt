Group level MEG/EEG source imaging via
optimal transport: minimum Wasserstein
estimates
H. Janati1, T. Bazeille1, B. Thirion1, M. Cuturi2, A. Gramfort1
1 INRIA, CEA Neurospin, France
2 Google and CREST ENSAE
Abstract. Magnetoencephalography (MEG) and electroencephalogra-
phy (EEG) are non-invasive modalities that measure the weak electro-
magnetic ﬁelds generated by neural activity. Inferring the location of
the current sources that generated these magnetic ﬁelds is an ill-posed
inverse problem known as source imaging. When considering a group
study, a baseline approach consists in carrying out the estimation of
these sources independently for each subject. The ill-posedness of each
problem is typically addressed using sparsity promoting regularizations. A
straightforward way to deﬁne a common pattern for these sources is then
to average them. A more advanced alternative relies on a joint localization
of sources for all subjects taken together, by enforcing some similarity
across all estimated sources. An important advantage of this approach
is that it consists in a single estimation in which all measurements are
pooled together, making the inverse problem better posed. Such a joint
estimation poses however a few challenges, notably the selection of a
valid regularizer that can quantify such spatial similarities. We propose
in this work a new procedure that can do so while taking into account
the geometrical structure of the cortex. We call this procedure Minimum
Wasserstein Estimates (MWE). The beneﬁts of this model are twofold.
First, joint inference allows to pool together the data of diﬀerent brain
geometries, accumulating more spatial information. Second, MWE are
deﬁned through Optimal Transport (OT) metrics which provide a tool
to model spatial proximity between cortical sources of diﬀerent subjects,
hence not enforcing identical source location in the group. These beneﬁts
allow MWE to be more accurate than standard MEG source localization
techniques. To support these claims, we perform source localization on
realistic MEG simulations based on forward operators derived from MRI
scans. On a visual task dataset, we demonstrate how MWE infer neural
patterns similar to functional Magnetic Resonance Imaging (fMRI) maps.
Keywords: Brain · Inverse modeling· EEG / MEG source imaging
1 Introduction
Magnetoencephalography (MEG) measures the components of the magnetic ﬁeld
surrounding the head, while Electroencephalography (EEG) measures the electric
arXiv:1902.04812v1  [stat.ML]  13 Feb 2019
2 H. Janati, T. Bazeille, B. Thirion, M. Cuturi, A. Gramfort
potential at the surface of the scalp. Both can do so with a temporal resolution
of less than a millisecond. Localizing the underlying neural activity on a high
resolution grid of the cortex, a problem known as source imaging, is inherently
an “ill-posed” linear inverse problem: Indeed, the number of potential sources is
larger than the number of MEG and EEG sensors, which implies that, even in
the absence of noise, diﬀerent neural activity patterns could result in the same
electromagnetic ﬁeld measurements.
To limit the set of possible solutions, prior hypotheses on the nature of
the source distributions are necessary. The minimum-norm estimates (MNE)
for instance are based onℓ2 Tikhonov regularization which leads to a linear
solution [11]. An ℓ1 norm penalty was also proposed by [34], modeling the
underlyingneuralpatternasasparsecollectionoffocaldipolarsources,hencetheir
name “Minimum Current Estimates” (MCE). These methods have inspired a series
of contributions in source localization techniques relying on noise normalization
[6,28] to correct for the depth bias [1] or block-sparse norms [30,10] to leverage the
spatio-temporal dynamics of MEG signals. While such techniques have had some
success, source estimation in the presence of complex multi-dipole conﬁgurations
remains a challenge. In this work we aim to leverage the anatomical and functional
diversity of multi-subject datasets to improve localization results.
Related work. This idea of using multi-subject information to improve statistical
estimation has been proposed before in the neuroimaging literature. In [20] it is
showed that diﬀerent anatomies across subjects allow for point spread functions
that agree on a main activation source but diﬀer elsewhere. Averaging across
subjects thereby increases the accuracy of source localization. On fMRI data,
[35] proposed a probabilistic dictionary learning model to infer activation maps
jointly across a cohort of subjects. A similar idea led [19] to introduce a Bayesian
framework to account for functional intersubject variability. To our knowledge,
the only contribution formulating the problem as a multi-task regression model
employs a Group Lasso with anℓ21 block sparse norm [21]. Yet this forces every
potential neural source to be either active for all subjects or for none of them.
Contribution. The assumption of identical functional activity across subjects
is clearly not realistic. Here we investigate several multi-task regression models
that relax this assumption. One of them is the multi-task Wasserstein (MTW)
model [15]. MTW is deﬁned through an Unbalanced Optimal Transport (UOT)
metric that promotes support proximity across regression coeﬃcients. However,
applying MTW to group level data assumes that the signal-to-noise ratio is the
same for all subjects. We propose to build upon MTW and alleviate this problem
by inferring estimates of both sources and noise variance for each subject. To do
so, we follow similar ideas that lead to the concomitant Lasso [27,31,25] or the
multi-task Lasso [24].
This paper is organized as follows. Section 2 introduces the multi-task re-
gression source imaging problem. Section 3 presents some background on UOT
metrics and explains how MWE are carried out. Section 4 presents the results of
our experiments on both simulated and MEG datasets.
MWE: Minimum Wasserstein Estimates 3
Notation. We denote by1p the vector of ones inRp and byJqK the set{1,...,q }
for any integerq∈N. The set of vectors inRp with non-negative (resp. positive)
entries is denoted byRp
+ (resp. Rp
++). On matrices,log, exp and the division
operator are applied elementwise. We use⊙for the elementwise multiplication
between matrices or vectors. IfX is a matrix,Xi. denotes itsith row andX.j
its jth column. We deﬁne the Kullback-Leibler (KL) divergence between two
positive vectors byKL(x,y) = ⟨x,log(x/y)⟩+ ⟨y −x,1p⟩with the continuous
extensions 0 log(0/0) = 0 and 0 log(0) = 0. We also make the conventionx ̸= 0 ⇒
KL(x|0) = +∞. The entropy ofx ∈Rn is deﬁned asH(x) = −⟨x,log(x) −1p⟩.
The same deﬁnition applies for matrices with an element-wise double sum.
2 Source imaging as a multi-task regression problem
We formulate in this section the inverse problem of interest in this paper, and
recall how a multi-task formulation can be useful to carry out a joint estimation
of all these parameters through regularization.
Source modeling.Using a volume segmentation of the MRI scan of each subject,
the positions of potential sources are constructed as a set of coordinates uniformly
distributed on the cortical surface of the gray matter. Moreover, synchronized
currents in the apical dendrites of cortical pyramidal neurons are thought to be
mostly responsible for MEG signals [26]. Therefore, the dipole orientations are
usually constrained to be normal to the cortical surface. We model the current
density as a set of focal current dipoles with ﬁxed positions and orientations.
The purpose of source localization is to infer their amplitudes. The ensemble of
possible candidate dipoles forms thesource space.
Forward modeling.Let n denote the number of sensors (EEG and/or MEG) and
p the number of sources. Following Maxwell’s equations, at each time instant,
the measurements B ∈ Rn are a linear combination of the current density
x ∈Rp : B = Lx. However, we observe noisy measurementsY ∈Rn given by:
Y = B + ε= Lx + ε , (1)
where ε is the noise vector. The linear forward operatorL ∈Rn×p is called the
leadﬁeld or gain matrix, and can be computed by solving Maxwell’s equations
using the Boundary element method [12]. Up to a whitening pre-processing step,
ε can be assumed Gaussian distributedN(0,σIn).
Source localization.Source localization consists in solving inx the inverse problem
(1) which can be cast as a least squares problem:
x⋆ = arg min
x∈Rp
∥Y −Lx∥2
2 . (2)
Since n≪p, problem(2) is ill-posed and additional constraints on the solution
x⋆ are necessary. When analyzing evoked responses, one can promote source
4 H. Janati, T. Bazeille, B. Thirion, M. Cuturi, A. Gramfort
conﬁgurations made of a few focal sources, e.g. using theℓ1 norm. This regu-
larization leads to problem(3) called minimum current estimates (MCE), also
known in the machine learning community as the Lasso [32].
x⋆ = arg min
x∈Rp
1
2n∥Y −Lx∥2
2+λ∥x∥1 , (3)
where λ> 0 is a tuning hyperparameter.
Common source space. Here we propose to go beyond the classical pipeline
and carry out source localization jointly forS subjects. First, dipole positions
(features) must correspond to each other across subjects. To do so, the source
space of each subject is mapped to a high resolution average brain using morphing
where the sulci and gyri patterns are matched in an auxiliary spherical inﬂating
of each brain surface [8]. The resulting leadﬁeldsL(1),..., L(S) have therefore
the same shape(n×p) with aligned columns.
Multi-task framework. Jointly estimating the current densityx(s) of each subject
s can be expressed as a multi-task regression problem where some coupling prior
is assumed onx(1),..., x(S) through a penaltyΩ:
min
x(1),...,x(S)∈Rp
1
2n
S∑
s=1
∥Y(s) −L(s)x(s)∥2
2 + Ω(x(1),..., x(S)) . (4)
Following the work of [15], we propose to deﬁneΩ using an UOT metric.
3 Minimum Wassertein Estimates
We start this section with background material on UOT. Consider the ﬁnite
metric space (E,d) where each element of E = {1,...,p }corresponds to a
vertex of the source space. LetM be the matrix whereMij corresponds to the
geodesic distance between verticesi and j. Kantorovich [16] deﬁned a distance
for normalized histograms (probability measures) onE. However, it can easily
be extended to non-normalized measures by relaxing marginal constraints [4].
Marginal relaxation. Let a,b be two normalized histograms onE. Assuming
that transporting a fraction of massPij from ito j is given byPijMij, the total
cost of transport is given by⟨P,M⟩= ∑
ijPijMij. Minimizing this total cost
with respect toP must be carried out on the set of feasible transport plans with
marginals a and b. The (normalized) Wasserstein-Kantorovich distance reads:
WK(a,b) = min
P∈R+
p×p
P1=a,P⊤1=b
⟨P,M⟩. (5)
In practice, ifa and b are positive and normalized current densities, WK(a,b)
will quantify the geodesic distance between their supports along the curved
MWE: Minimum Wasserstein Estimates 5
geometry of the cortex. This property makes OT metrics adequate for assessing
the proximity of functional patterns across subjects. To allowa,b to be non-
normalized, the marginal constraints in(5) can be relaxed using a KL divergence:
min
P∈R+p×p
⟨P,M⟩+ γKL(P1|a) + γKL(P⊤1|b) , (6)
where γ >0 is a hyperparameter that enforces a ﬁt to the marginals.
Entropy regularization.Entropy regularization was introduced by [5] to propose a
faster and more robust alternative to the direct resolution of the linear program-
ming problem(5). Formally, this amounts to minimizing the loss⟨P,M⟩−εH(P)
where ε >0 is a tuning hyperparameter. This penalized loss function can be
written: εKL(P,e−M
ε ) up to a constant [3]. Combining entropy regularization
with marginal relaxation in(6), we get the unbalanced Wasserstein distance as
introduced by [4]:
W(a,b) = min
P∈R+p×p
εKL(P|e−M
ε ) + γKL(P1|a) + γKL(P⊤1|b) , (7)
Generalized Sinkhorn.Problem (7) can be solved as follows. LetK = e−M
ε and
ψ= γ/(γ+ ϵ). Starting from two vectorsu,v set to1 and iterating the scaling
operations u ←(a/Kv)ψ , v ←
(
b/K⊤u
)ψ
until convergence, the minimizer of
(7) can be computed asP⋆ = (uiKijvj)i,j∈JpK . This algorithm is a generalization
of the Sinkhorn algorithm [18]. Since it involves matrix-matrix operations, it
beneﬁts from parallel hardware, such as GPUs.
Extension toRp. We extend next the Wasserstein distance to signed measures.
We adopt a similar idea to what was suggested in [23,29,15] using a decomposition
into positive and negative parts,x(s) = x(s)+ −x(s)− where x(s)+ = max(x(s)+ ,0)
and x(s)− = max(−x(s)+ ,0). For any vectorsa,b ∈Rp, we deﬁne the generalized
Wasserstein distance as:
˜W(a,b)
def
= W(a+,b+) + W(a−,b−) . (8)
Note thatW(0,0) = 0 (see [15] for a proof), thus on positive measures˜W = W.
For the sake of convenience, we refer to˜W in (8) by the Wasserstein distance,
even though it does not verify indiscernability. In practice, this extension allows
to compare current dipoles across subjects according to their polarity which could
be either towards the deep or superﬁcial layers of the cortex.
The MTW model.The multi-task Wasserstein model is the speciﬁc case of(4)
with a penaltyΩ promoting both sparsity and supports’ proximity:
ΩMTW(x(1),..., x(S))
def
= µmin
¯x∈Rp
1
S
S∑
s=1
˜W(x(s),¯x) + λ∥x(s)∥1 , (9)
where µ,λ ≥0 are tuning hyperparameters. The OT term in(9) can be seen
as a spatial variance. Indeed, the minimizer¯x corresponds to the Wasserstein
barycenter with respect to the distance˜W.
6 H. Janati, T. Bazeille, B. Thirion, M. Cuturi, A. Gramfort
Algorithm 1MWE algorithm
Input: σ0, µ,ϵ,γ,λ and cost matrixM. data(Y(s))s(L(s))s.
Output: MWE: (x(s)), minimizers of (10).
repeat
for s= 1 to S do
Update x(s)+ with proximal coordinate descent to solve (12).
Update x(s)−with proximal coordinate descent to solve (12).
Update σ(s) with (11).
end for
Update left marginalsm(1)+,..., m(S)+ and ¯x+ with generalized Sinkhorn.
Update left marginalsm(1)−..., m(S)−and ¯x−with generalized Sinkhorn.
until convergence
Minimum Wasserstein Estimates.One of the drawbacks of MTW is thatλ is
common to all subjects. Indeed, the loss considered in MTW implicitly assumes
that the level of noise is the same across subjects. Following the work of [25] on
the smoothed concomitant Lasso, we propose to extend MTW by inferring the
speciﬁc noise standard deviationσ(s) along with the regression coeﬃcientx(s) of
each subject. This allows to scale the weight of theℓ1 according to the level of
noise. The Minimum Wasserstein Estimates (MWE) model reads:
min
x(1),...,x(S)∈Rp
σ(1),...,σ(S)∈[σ0,+∞]
S∑
s=1
1
2nσ(s) ∥Y(s) −L(s)x(s)∥2
2 +σ(s)
2 + ΩMTW(x(1),..., x(S)) ,
(10)
where σ0 is a pre-deﬁned constant. This lower bound constraint avoids numerical
issues whenλ→0 and therefore the standard deviation estimate also tends to 0.
In practiceσ0 can be set for example using prior knowledge on the variance of
the data or as a small fraction of the initial estimate of the standard deviation
σ0 = αmins
∥Y(s)∥√n . In practice we adopt the second option and setα= 0.01.
Algorithm. By combining (7), (8) and (10), we obtain an objective function
taking as arguments
(
(x(s)+)s,(x(s)−)s,(P(s)+)s,(P(s)−)s,¯x+,¯x−,(σ(s))s
)
. This
function restricted to all parameters except(σ(s))s is jointly convex [15]. Moreover,
each σ(s) is only coupled with the variablex(s). The restriction on every pair
(x(s),σ(s)) is also jointly convex [25]. Thus the problem is jointly convex in all its
variables. We minimize it by alternating optimization. To justify the convergence
of such an algorithm, one needs to notice that the non-smoothℓ1 norms in the
objective are separable [33]. The update with respect to eachσ(s) is given by
solving the ﬁrst order optimality condition (Fermat’s rule):
σ(s) ←∥Y(s) −L(s)x(s)∥2√n ∧σ0 , (11)
MWE: Minimum Wasserstein Estimates 7
which also corresponds to the empirical estimator of the standard deviation when
the constraint is not active. To update the remaining variables, we follow the same
optimization procedure laid out in [15] and adapted to MWE in Algorithm 1.
Brieﬂy, letm(s)+ def
= P(s)+1 (resp. m(s)+ def
= P(s)+1), when minimizing with
respect to onex(s)+ (resp. x(s)−), the resulting problem can be written (dropping
the exponents for simplicity):
min
x∈Rp
+
1
2n∥Y −Lx∥2
2+µγ
S (⟨x,1⟩−⟨log(x),m⟩) + λσ∥x∥1 , (12)
whichcanbesolvedusingproximalcoordinatedescent[ 7].Notethattheadditional
inference of a speciﬁcσ(s) for each subject allows to scale the Lasso penalty
depending on their particular level of noise. The ﬁnal update with respect to
((P(s)+)s,(P(s)−)s,¯x+,¯x−) can be cast as two Wasserstein barycenter problems,
carried out using generalized Sinkhorn iterations [4]. Note that we do not need
to compute the transport plansP(s) since inferring every source estimatex only
requires the knowledge of the left marginalm = P1 which does not require
storing P in memory.
4 Experiments
Benchmarks: Dirty models and Multi-level Lasso.As discussed in introduction,
standard sparse source localization solvers are based on anℓ1 norm regularization,
applied to the data of each subject independently. We use the independent
Lasso estimator as a baseline. We compare MWE to the Group-Lasso estimator
[37,2] which was proposed in this context to promote functional consistency
across subjects [21]. It falls in the multi-task framework of(4) where the joint
penalty is deﬁned through anℓ21 mixed norm∥X∥21= ∑p
j=1
√∑S
s=1 x(s)
j
2
where
X = ( x(s)
j )(j,s) ∈ Rp×S. We also evaluate the performance of more ﬂexible
block sparse models where only a fraction of the source estimates are shared
across all tasks: Dirty models [14] and the multivel lasso [22]. In Dirty models
source estimates are written as a sum of two parts which are penalized with
diﬀerent norms. One common to all subjects (penaltyℓ21) and one speciﬁc for
each subject (penaltyℓ1). The Multi-level Lasso (MLL) [22] applies the same
idea using instead a product decomposition and a Lasso penalty on both parts.
We also compare MWE with MTW to evaluate the beneﬁts of inferring noise
levels adaptively.
Simulation data and MEG/fMRI datasets.We use the public dataset DS117 [36]
which provides MEG, EEG and fMRI data of 16 healthy subjects to whom were
presented images of famous, unfamiliar and scrambled faces. Using the MRI scan
of each subject, we compute a source space and its associated leadﬁeld comprising
around 2500 sources per hemisphere [9]. Keeping only MEG gradiometer channels,
we haven= 204 observations per subject.
8 H. Janati, T. Bazeille, B. Thirion, M. Cuturi, A. Gramfort
Fig. 1. Left:3 labels from
the aparc.a2009s parcellation.
Right: Simulated activations
for S = 6 subjects. Each color
corresponds to a subject. Dif-
ferent radiuses are used to dis-
tinguish overlapping sources.
0.4
0.6
0.8Same Leadfield
AUC
2
4
6
EMD in cm
5
10
15
1e 3
 MSE
2 4 6 8 10 16
# subjects
0.4
0.6
0.8Different Leadfields
MTW MLL Dirty GL Lasso MWE
2 4 6 8 10 16
# subjects
2
4
6
2 4 6 8 10 16
# subjects
5
10
15
1e 3
Fig. 2.Performance of diﬀerent models over 30 trials in terms of AUC, EMD
and MSE using the same leadﬁeld for all subjects (randomly selected in each
trial) (top) and speciﬁc leadﬁelds (bottom).
For realistic data simulation, we use the actual leadﬁelds from all subjects,
yet restricted to the left hemisphere. We thus have 16 leadﬁelds withp= 2500.
We simulate an inverse solutionxs with q sources (q-sparse vector) by randomly
selecting one source per label amongq pre-deﬁned labels using theaparc.a2009s
parcellation of the Destrieux atlas. To model functional consistency, 50% of the
subjects share sources at the same locations, the remaining 50% have sources
randomly generated in the same labels (see Figure 1). Their amplitudes are taken
uniformly between 20 and 30 nAm. Their sign is taken at random with a Bernoulli
distribution (0.5) for each label. We simulateY using the forward model with a
variance matrixσIn. We setσso as to have an average signal-to-noise ratio across
subjects equal to 4 (SNR
def
= ∑S
s=1
∥L(s)x(s)∥
Sσ ). We evaluate the performance of all
models knowing the ground truth by comparing the best estimates in terms of
three metrics: the mean squared error (MSE) to quantify accuracy in amplitude
estimation, AUC and a generalized Earth mover distance (EMD) to assess
supports estimation. We generalize the PR-AUC (Area under the curve Precision-
recall) by deﬁning AUC(ˆx,x⋆) = 1
2 PR-AUC(ˆx+,x⋆+) + 1
2 PR-AUC(ˆx−,x⋆−)
where PR-AUC is computed between the estimated coeﬃcients and the true
MWE: Minimum Wasserstein Estimates 9
Lasso
Fig. 3.Support of source estimates. Each color corresponds to a subject. Diﬀerent
radiuses are displayed for a better distinction of sources. The fusiform gyrus is
highlighted in green. Increasingµpromotes functional consistency across subjects.
supports. We compute EMD between normalized values of sources: EMD(ˆx,x⋆) =
1
2 WK( ˆx+
ˆx+1 , x⋆+
x⋆+1 ) + 1
2 WK( ˆx−
ˆx−1 , x⋆−
x⋆−1 ). SinceM is expressed in centimeters, WK
can be seen as an expectation of the geodesic distance between sources. The
mean across subjects is reported for all metrics.
Simulation results. We set the number of sources to 3 and vary the number of
subjects under two conditions: (1) using one leadﬁeld for all subjects, (2) using
individual leadﬁelds. Each model is ﬁtted on a grid of hyperparameters and the
best AUC/MSE/EMD scores are reported. We perform 30 diﬀerent trials (with
diﬀerent true activations and noise, diﬀerent common leadﬁeld for condition (1))
and report the mean within a 95% conﬁdence interval in Figure 2.
Various observations can be made. The Group Lasso performs poorly – even
compared to independent Lasso – which is expected since sources are not common
for all subjects. Non-convexity allows MLL to be very eﬀective with less than
2-4 subjects. Its performance yet degrades with more subjects. OT-based models
(MWE and MTW) however beneﬁt from the presence of more subjects by
leveraging spatial proximity. They reduce the average error distance from 4
cm (Lasso) to less than 1 cm and reach an AUC of 0.9. One can also observe
that the estimation of the noise standard deviation in the MTW model does
improve performance. Finally, we can appreciate the improvement of multi-task
models when increasing the number subjects, especially when using diﬀerent
leadﬁeld matrices. We argue that the diﬀerent folding patterns of the cortex
across subjects lead to diﬀerent dipole orientations thereby increasing the chances
of source identiﬁcation.
Results on MEG/fMRI dataThe fusiform face area specializes in facial recognition
and activates around 170ms after stimulus [17,13]. To study this response, we
perform MEG source localization using Lasso and MWE. We pick the time point
with the peak response for each subject within the interval 150-200 ms after
visual presentation of famous faces. For both models, we select the smallestℓ1
tuning parameterλ for which less than 10 sources are active for each subject.
Figure 3 shows how UOT regularization favors activation in the ventral pathway
10 H. Janati, T. Bazeille, B. Thirion, M. Cuturi, A. Gramfort
0.25
0.50
0.75
1.00max
= 5%
Left hemisphere
 Right hemisphere
0.25
0.50
0.75
1.00max
= 10%
0.25
0.50
0.75
1.00max
= 15%
0 10 20 30 40 50 60 70 80 90 100
OT regularization 
0.25
0.50
0.75
1.00max
= 20%
Lasso fMRI MWE
0 10 20 30 40 50 60 70 80 90 100
OT regularization 
Fig. 4.Ratio of maximum absolute amplitude in the fusiform gyrus over maxi-
mum absolute amplitude in the hemisphere. The mean across the 16 subjects is
reported for diﬀerentℓ1 norm regularization weightsλ.
0.00  0.417 0.834 1.25  1.67  2.08  2.50  2.92  
time=0.170s
0.417 0.834 1.25  1.67  2.08  2.50  2.92  0.00  
0.00  0.172 0.343 0.515 0.687 0.858 1.03  1.20  
time=0.170s
0.172 0.343 0.515 0.687 0.858 1.03  1.20  0.00  
0.00  1.36  2.72  4.08  5.43  6.79  8.15  9.51  9.51  1.36  2.72  4.08  5.43  6.79  8.15  0.00  
Fig. 5.Neural patterns of subject 2. Absolute amplitudes of MEG source esti-
mates (in nAm) given by Lasso (Left) and MWE (Middle). Absolute values of
fMRI Z-scores. (Right). The fusiform gyrus is highlighted in green.
of the visual cortex. The Lasso solutions in Figure 3 show signiﬁcant diﬀerences
between subjects. Since no ground truth exists, one could argue that MWE
promotes consistency at the expense of individual signatures. To address this
concern we compute the standardized fMRI Z-score of the conditionsfamous
vs scrambled faces. We compare Lasso, MWE and fMRI by computing for each
subject the ratiolargest value in fusiform gyrus/ largest absolute value. We report
the mean across all subjects in Figure 4. Note that for all subjects, the fMRI
Z-score reaches its maximum in the fusiform gyrus, and that MWE regularization
leads to more agreement between MEG and fMRI. Figure 5 shows MEG with
MWE and fMRI results for subject 2.
MWE: Minimum Wasserstein Estimates 11
Conclusion
We proposed in this work a novel approach to promote functional consistency
through a convex model deﬁned using an Unbalanced Optimal Transport reg-
ularization. Using a public MEG and fMRI dataset, we presented experiments
demonstrating that MWE outperform multi-task sparse models in both amplitude
and support estimation. We have shown in these experiments that MWE can
close the gap between MEG and fMRI source imaging by gathering data from
diﬀerent subjects.
References
1. Ahlfors, S.P., Ilmoniemi, R.J., Hämäläinen, M.S.: Estimates of visually evoked
cortical currents. Electroencephalography and Clinical Neurophysiology 82(3),
225–236 (2018/11/20 1992)
2. Argyriou, A., Evgeniou, T., Pontil, M.: Multi-task feature learning. In: NIPS (2007)
3. Benamou, J., Carlier, G., Cuturi, M., Nenna, L., Peyré, G.: Iterative Bregman
Projections For Regularized Transportation Problems. Society for Industrial and
Applied Mathematics (2015)
4. Chizat, L., Peyré, G., Schmitzer, B., Vialard, F.X.: Scaling Algorithms for Unbal-
anced Transport Problems. arXiv:1607.05816 [math.OC] (2017)
5. Cuturi, M.: Sinkhorn Distances: Lightspeed Computation of Optimal Transport.
NIPS (2013)
6. Dale, A.M., Liu, A.K., Fischl, B.R., Buckner, R.L., Belliveau, J.W., Lewine, J.D.,
Halgren, E.: Dynamic statistical parametric mapping. Neuron26(1), 55–67 (2000)
7. Fercoq, O., Richtárik, P.: Accelerated, parallel and proximal coordinate descent.
SIAM Journal on Optimization25, 1997–2023 (2015)
8. Fischl, B., Sereno, M.I., Dale, A.M.: Cortical surface-based analysis: Ii: Inﬂation,
ﬂattening, and a surface-based coordinate system. NeuroImage9, 195 – 207 (1999),
mathematics in Brain Imaging
9. Gramfort, A., Luessi, M., Larson, E., Engemann, D.A., Strohmeier, D., Brodbeck,
C., Parkkonen, L., Hämäläinen, M.: MNE software for processing MEG and EEG
data. NeuroImage86 (10 2013)
10. Gramfort, A., Strohmeier, D., Haueisen, J., Hämäläinen, M., Kowalski, M.: Time-
frequency mixed-norm estimates: Sparse M/EEG imaging with non-stationary
source activations. NeuroImage70(0), 410 – 422 (2013)
11. Hämäläinen, M.S., Ilmoniemi, R.J.: Interpreting magnetic ﬁelds of the brain: mini-
mum norm estimates. Medical & Biological Engineering & Computing32(1), 35–42
(Jan 1994)
12. Hämäläinen, M.S., Sarvas, J.: Feasibility of the homogeneous head model in the
interpretation of neuromagnetic ﬁelds. Physics in Medicine and Biology32(1), 91
(1987)
13. Henson, R.N., Wakeman, D.G., Litvak, V., Friston, K.J.: A parametric empirical
bayesian framework for the EEG/MEG inverse problem: Generative models for
multi-subject and multi-modal integration. Frontiers in human neuroscience5, 76;
76–76 (08 2011)
14. Jalali, A., Ravikumar, P., Sanghavi, S., Ruan, C.: A Dirty Model for Multi-task
Learning. NIPS (2010)
12 H. Janati, T. Bazeille, B. Thirion, M. Cuturi, A. Gramfort
15. Janati,H.,Cuturi,M.,Gramfort,A.:Wassersteinregularizationforsparsemulti-task
regression. Arxiv. preprint (2018)
16. Kantorovic, L.: On the translocation of masses. C.R. Acad. Sci. URSS (1942)
17. Kanwisher, N., McDermott, J., Chun, M.M.: The fusiform face area: A module in
human extrastriate cortex specialized for face perception. Journal of Neuroscience
17(11), 4302–4311 (1997)
18. Knopp, P., Sinkhorn, R.: Concerning nonnegative matrices and doubly stochastic
matrices. . Paciﬁc Journal of Mathematics1(2), 343–348 (1967)
19. Kozunov, V.V., Ossadtchi, A.: Gala: group analysis leads to accuracy, a novel
approach for solving the inverse problem in exploratory analysis of group MEG
recordings. Frontiers in Neuroscience9, 107 (2015)
20. Larson, E., Maddox, R.K., Lee, A.K.C.: Improving spatial localization in meg inverse
imaging by leveraging intersubject anatomical diﬀerences. Frontiers in Neuroscience
8, 330 (2014)
21. Lim, M., Ales, J., Cottereau, B.M., Hastie, T., Norcia, A.M.: Sparse eeg/meg source
estimation via a group lasso. PLOS (2017)
22. Lozano, A., Swirszcz, G.: Multi-level Lasso for Sparse Multi-task Regression. ICML
(2012)
23. Mainini, E.: A description of transport cost for signed measures. Journal of Mathe-
matical Sciences181(6), 837–855 (Mar 2012)
24. Massias, M., Fercoq, O., Gramfort, A., Salmon, J.: Generalized concomitant multi-
task lasso for sparse multimodal regression. Proceedings of Machine Learning
Research, vol. 84, pp. 998–1007. PMLR (09–11 Apr 2018)
25. Ndiaye, E., Fercoq, O., Gramfort, A., Leclère, V., Salmon, J.: Eﬃcient smoothed
concomitant lasso estimation for high dimensional regression. Journal of Physics:
Conference Series904(1), 012006 (2017)
26. Okada, Y.: Empirical bases for constraints in current-imaging algorithms. Brain
Topography p. 373–377
27. Owen, A.B.: A robust hybrid of lasso and ridge regression. Contemporary Mathe-
matics 443, 59–72 (2007)
28. Pascual-Marqui, R.: Standardized low-resolution brain electromagnetic tomography
(sloreta): technical details. Methods Find Exp Clin Pharmacol24, D:5–12 (2002)
29. Profeta, A., Sturm, K.T.: Heat ﬂow with dirichlet boundary conditions via optimal
transport and gluing of metric measure spaces (2018)
30. Strohmeier, D., Bekhti, Y., Haueisen, J., Gramfort, A.: The iterative reweighted
mixed-norm estimate for spatio-temporal MEG/EEG source reconstruction. IEEE
Transactions on Medical Imaging35(10), 2218–2228 (Oct 2016)
31. Sun, T., Zhang, C.H.: Scaled sparse linear regression. Biometrika99, 879–898 (2012)
32. Tibshirani, R.: Regression Shrinkage and Selection via the Lasso. Journal of the
Royal Statistical Society58(1), 267–288 (1996)
33. Tseng, P.: Convergence of a block coordinate descent method for nondiﬀerentiable
minimization. J. Optim. Theory Appl.109(3), 475–494 (2001)
34. Uutela, K., Hämäläinen, M.S., Somersalo, E.: Visualization of magnetoencephalo-
graphic data using minimum current estimates. NeuroImage10(2), 173–180 (1999)
35. Varoquaux, G., Gramfort, A., Pedregosa, F., Michel, V., Thirion, B.: Multi-subject
dictionarylearningtosegmentanatlasofbrainspontaneousactivity.In:Information
Processing in Medical Imaging. vol. 6801, pp. 562–573. Springer (2011)
36. Wakeman, D., Henson, R.: A multi-subject, multi-modal human neuroimaging
dataset. Scientiﬁc Data2(150001) (2015)
37. Yuan, M., Lin, Y.: Model selection and estimation in regression with grouped
variables. Journal of the Royal Statistical Society68(1), 49–67 (2006)