arXiv:1004.2868v3  [astro-ph.IM]  31 Aug 2010
Inference with minimal Gibbs free energy in information ﬁel d theory
Torsten A. Enßlin and Cornelius Weig
Max-Planck-Institut f¨ ur Astrophysik, Karl-Schwarzschi ld-Str. 1, 85741 Garching, Germany
(Dated: October 23, 2018)
Non-linear and non-Gaussian signal inference problems are diﬃcult to tackle. Renormalization
techniques permit us to construct good estimators for the po sterior signal mean within information
ﬁeld theory (IFT), but the approximations and assumptions m ade are not very obvious. Here we
introduce the simple concept of minimal Gibbs free energy to IFT, and show that previous renor-
malization results emerge naturally. They can be understoo d as being the Gaussian approximation
to the full posterior probability, which has maximal cross i nformation with it. We derive optimized
estimators for three applications, to illustrate the usage of the framework: (i) reconstruction of a
log-normal signal from Poissonian data with background cou nts and point spread function, as it
is needed for gamma ray astronomy and for cosmography using p hotometric galaxy redshifts, (ii)
inference of a Gaussian signal with unknown spectrum and (ii i) inference of a Poissonian log-normal
signal with unknown spectrum, the combination of (i) and (ii ). Finally we explain how Gaussian
knowledge states constructed by the minimal Gibbs free ener gy principle at diﬀerent temperatures
can be combined into a more accurate surrogate of the non-Gau ssian posterior.
I. INTRODUCTION
A. Abstract inference problem
Measurements provide information on the signals we
are interested in, encoded in the delivered data. How
can this information be best retrieved? Is there a generic
and simple principle from which optimal data analysis
strategies derive? Can an information energy be con-
structed which – if minimized – provides us with the cor-
rect knowledge state given the data and prior informa-
tion? And if this exists, how can this information ground
state be found at least approximatively?
An information energy, to be minimized, would be very
useful to have, since many of the existing minimization
techniques, analytical and numerical, can then be ap-
plied to it. A number of such functions to be extremized
to solve inference problems were proposed in the liter-
ature, like the likelihood, the posterior, or the entropy.
The likelihood is the probability that the data has re-
sulted from some signal. The posterior is the reverse, it
is the probability that given the data some signal was the
origin of it. Extremizing either of them certainly makes
sense, but often ignores the presence of slightly less prob-
able, but much more numerous possibilities in the signal
phase space. Those have a much larger entropy and are
therefore favored by maximum entropy methods. How-
ever, maximum entropy alone can not be the inference
determining criterion, since it favors states of complete
lack of knowledge, irrespective of the data. Thus some
counteracting energy is required which provides the right
amount of force to the inference solution. Here, we ar-
gue that the ideal information energy is provided by the
Gibbs free energy, which combines both maximum en-
tropy and maximum a posteriori (MAP) principles.
The Gibbs free energy has to be regarded as a func-
tional over the space of possible probability density func-
tions (PDF) of the signal given the data. The result of
the minimization is therefore a PDF itself, and not a sin-
gle signal estimate. Minimizing the Gibbs free energy
maximizes the entropy within the constraints given by
the internal energy. The latter is understood as the av-
erage of the negative logarithm of the joint probability
function of signal and data weighted with the PDF.
The usage of thermodynamical concepts for inference
problems is not new, see e.g. [1, 2]. What is new here,
is that we develop this for signals which are ﬁelds, spa-
tially distributed quantities with an inﬁnite number of
degrees of freedom, while using an approximate Gaus-
sian ansatz for the PDF to be inferred. We thereby con-
nect information ﬁeld theory (IFT) [3–10], as a statistical
ﬁeld theory dealing with a huge number of microscopic
degrees of freedom, to thermodynamics, as a means to
generate simpliﬁed, but macroscopic descriptions of our
knowledge. Thereby we ﬁnd that former IFT results ob-
tained with complex renormalization schemes in [9, 11]
can easily be reproduced, and even be extended to more
complicated measurement situations.
In the remainder of Sect. I we brieﬂy introduce to
IFT, MAP, and Maximum Entropy. This motivates the
minimal Gibbs free energy principle, which we formally
derive in Sect. II, and show its equivalence to maximal
cross information. The application of this principle to
optimize approximations of the posterior of concrete in-
ference problems is provided in Sect. III. There, the
log-normal Poisson problem (Sect. III A) and the prob-
lem to reconstruct without known signal power spectrum
(Sect. III B), as well as their combination (Sect. III C)
are addressed. Finally, we show how approximate poste-
riors obtained at diﬀerent temperatures can be combined
into a better posterior surrogate in Sect. IV before we
conclude Sect. V.
B. Information ﬁeld theory
Information theory describes knowledge states with
probabilities. If Ω is the complete set of possibilities,
2
and A ⊂ Ω is a subset, then P(A) ∈ [0,1] describes the
plausibility of A being the case, with P(A) = 1 denot-
ing A being assumed to be sure, P(A) = 0 denoting A
being (assumed to be) impossible, and 0 < P(A) < 1
describing uncertainty about the truth of A. Obviously
P(Ω) = 1 and P(∅) = 0. The usual rules of proba-
bility theory apply, and generalize the binary logic of
Aristotle to diﬀerent degrees of certainty or uncertainty
[12, 13]. In case the set of possibilities is a continuum,
it makes sense to introduce a PDF P(ψ) over Ω, so that
P(A) =
∫
A dψP(ψ). Each possible state ψ can be a
multi-component vector, containing all aspects of reality
which are in the focus of our inference problem.
We might be interested in a sub-aspect of ψ which
we call our signal s = s(ψ). The induced signal PDF
is retrieved from a functional or path integral over all
the phase spaces of the possibilities of ψ via P(s) =∫
DψP(ψ) δ(s− s(ψ)). If s is a ﬁeld, a function over
a physical space V, then s= ( sx)x∈V might be a vector
in the Hilbert space Ω of all L2-integrable functions over
V and P(s) is then a probability density functional. In-
formation theory for sbecomes IFT, which is a statistical
ﬁeld theory.
Inference on the signal s from data d is done from the
posterior probability P(s|d), which can be constructed
from the joint PDF of signal and data P(d,s) via
P(s|d) = P(d,s)
P(d) = e−β H (d,s )
Zβ
⏐
⏐
⏐
⏐
β =1
, (1)
where P(d,s) =
∫
Ω DψP(d|ψ) δ(s − s(ψ)) P(ψ) =
P(d|s) P(s) and P(d) =
∫
DsP(d,s). The second equal-
ity in (1) is just a renaming of the numerator and denomi-
nator of the ﬁrst fraction, which highlights the connection
to statistical mechanics. Thus we deﬁne the information
Hamiltonian
H(d,s) = − log P(d,s), (2)
the partition function including a moment generating
source term J
Zβ (d,J) =
∫
Dse−β (H(d,s )+J†s), (3)
and the inverse temperature β = 1 /T as usual in statis-
tical mechanics. Here s† is the transposed and complex
conjugated signal vector s, leading to a scalar product
j†s =
∫
V dx¯jxsx. The ad-hoc notion of temperature is
as in standard simulated annealing practice. It permits
to narrow (for T <1) or widen (for T >1) the explored
phase space region with respect to the one of the joint
PDF and therefore is a useful auxiliary parameter. We
show in Sect. II A that the well known thermodynamical
equipartition theorem holds:
⟨H(s, d)⟩(s|d) − H(m, d) ≈ 1
2 Ndgf T. (4)
where Ndgf is the number of degrees of freedom and m
is the mean signal ﬁeld as deﬁned below in (5), which
deﬁnes the ground state energy. This relation can e.g. be
used to check the correctness of an implementation of a
signal phase-space sampling algorithm.
C. Maximum a posteriori
The ﬁrst guess for a suitable energy to be minimized
to obtain the information state might be the Hamilto-
nian. Minimizing the Hamiltonian with respect to s,
while keeping d at their observed values, is equivalent
to maximizing the joint probability P(d,s) and also the
posterior P(s|d). The classical ﬁeld emerging from this is
called the MAP signal reconstruction in signal process-
ing. For a detailed discussion of the usage of the MAP
principle in IFT see [10]. The MAP ﬁeld is often a very
good approximation of the mean ﬁeld
m= ⟨s⟩(s|d) ≡
∫
Dss P(s|d), (5)
which is the optimal estimator of the signal in a statistical
L2 error norm sense:
m= argmin ˜s
⟨∫
V
dx(sx − ˜sx)2
⟩
(s|d)
. (6)
The MAP estimator on the other hand can be shown
to optimize the statistical L0 norm1, the result of which
may strongly deviate from the mean m, if the posterior
is highly asymmetric around its maximum. Thus we can
regard the MAP estimator as a good reference point, but
not as the solution we are seeking in general. It is, how-
ever, accurate (in the L2 error norm sense) in case the
posterior around its maximum is close to a Gaussian. In
this case, the MAP ﬁeld can easily be augmented with
some uncertainty information from the Hessian of the
Hamiltonian
H = δ2H(d,s)
δsδs†
⏐
⏐
⏐
⏐
s=m
, (7)
as an approximation of the two point function of the sig-
nal uncertainty
D≡
⟨
(s− m) (s− m)†⟩
(s|d) . (8)
Thus we set D≈ H −1 in
P(s|d) ≈ ˜P(s|d) = G(s− m,D), (9)
where we introduced the Gaussian
G(φ,D) ≡ 1
|2πD|
1
2
e− 1
2 φ †D−1φ . (10)
Unfortunately, the MAP estimator can perform subop-
timally in cases where the Gaussian approximation does
not hold, see e.g. [11].
1 The L0 norm measures the amount of exact agreement via
∥f∥0 = limε→ 0 1
ε
∫
dx θ(f2(x) − ε2), with θ denoting the Heavi-
side function.
3
D. Maximum Entropy
1. Image entropy
Another quantity often extremized in image recon-
struction problems is the so-called image entropy (iE)
[14–25]. In classical maximum (image) entropy (MiE
here, usually ME) methods the iE is deﬁned for a strictly
positive signal via
SiE(s) = −
∫
V
dxsx log(sx/˜sx) ≡ − s† log(s/˜s), (11)
where ˜sx is the reference image, which is used to model
some prior information. In the second equality we have
deﬁned the component-wise application of functions on
ﬁelds, e.g. ( f(s))x = f(sx), which we use throughout
this work.
We note, that the iE is actually not a physical entropy.
Usually its usage is argued for by ad hoc assumptions on
the distribution entropy of photon packages in the image
plane, rather than being a well motivated description of
the signal prior knowledge (or lack thereof). In the fol-
lowing we will reveal the implicitly assumed prior of MiE
methods.
The data enter the MiE method in form of an image
energy, which is ideally chosen to be the negative log-
likelihood,
E(d|s) = − log
(
P(d|s)
)
, (12)
in order to ensure the best imprint of the data on the
reconstruction. The entropy is then maximized with the
energy constraint given by minimizing
EiE(d,s) = E(d|s) − TSiE(s) (13)
with respect to s. Here T is some adjustable
temperature-like parameter, permitting us to choose the
relative weight of image entropy and image energy. Low
temperature means that the MiE map follows the data
closely, high temperature that the map space wants to be
more uniformly occupied by the signal reconstruction.
The prior information on the signal, P(s), does not
enter the MiE formalism explicitly. Actually, an implicit
prior can be identiﬁed, assuming that MiE is actually
a MAP principle. In that case the implicitly assumed
Hamiltonian is HiE(d,s) ∼
= EiE(d,s), where ∼
= denotes
equality up to an irrelevant, since s-independent, additive
constant, and we ﬁnd
PiE(s) ∝ eT S iE(s) ∝
∏
x
( sx
˜sx
) −T s x
. (14)
This is not a general prior, but a very speciﬁc PDF. Al-
though there is some ﬂexibility to adopt its functional
form by choosing ˜s, T, and the image space (pixel space,
Fourier space, wavelet space, etc.) in which (11) holds,
PiE(s) can not be regarded as being generic. The MiE
prior strongly suppresses large values in the MiE map. If
a data feature can be either explained by a single map
pixel exhibiting a peak value or by several pixels dividing
that value among themselves, MiE will usually prefer the
second option, leading to blurred reconstructed images.
We conclude, that the term maximum entropy com-
monly used in image reconstruction is very misleading. A
more accurate term would be minimal dynamical range,
since the implicitly assumed prior states that pixels car-
rying larger than average signal sx are extremely unlikely.
2. Physical entropy
A physical entropy should measure the distribution
spread of a PDF using a phase space integral over its
phase space. In fact, the latter is given by the Boltzmann
entropy as given by the negative Shannon information,
SB = −
∫
DsP(s|d) log P(s|d), (15)
which is a functional of the signal posterior, SB =
SB[P(s|d)], and not of the signal map. Inserting (1)
yields
SB = ⟨H(d,s)⟩(s|d) + log Z1(d,0) = U − F, (16)
where we introduced the internal energy U =
⟨H(d,s)⟩(s|d) and the Helmholtz free energy F = F1(d,0)
with
Fβ (d,J) = − 1
β log Zβ (d,J). (17)
The fully J-dependent Helmholtz free energy provides
the ﬁeld expectation value via
m= ⟨s⟩(s|d) = ∂Fβ (d,J)
∂J
⏐
⏐
⏐
⏐
β =1,J =0
. (18)
The entropy is also given in terms of the free energy via
SB = ∂Fβ (d,J)
∂β
⏐
⏐
⏐
⏐
β =1,J =0
. (19)
The entropy as well as the free energy are functionals of
the posterior and not of the signal. Maximizing or min-
imizing them does not provide a signal estimator, but
singles out a PDF. If we restrict the space of PDFs to
the ones we can handle analytically, namely Gaussians
as given in (9) and (10), we might obtain a suitable ap-
proximation scheme to the full ﬁeld theoretical inference
problem.
Maximizing the entropy alone does not lead to a suit-
able algorithm, since the maximal entropy state is that of
complete lack of knowledge, with a uniform probability
for every signal possibility. The internal energy, however,
favors knowledge states close to the posterior maximum
and would return the MAP solution if extremized alone.
4
Thus the right combination of entropy and internal en-
ergy is to be extremized. We would expect a free energy
of the form U − TSB to be this function, in analogy to
the energy (13) used in MiE methods. Thermodynamics
teaches us that the Gibbs free energy is the quantity to
be minimized (which is identical to the Helmholtz free
energy in case J = 0). Since we are going to calculate
this for an approximation of the real PDF, it is necessary
to go through the derivation in order to make sure we do
this in the right fashion and understand all implications.
II. THERMODYNAMICAL INFERENCE
A. Tempered Posterior
In order to take full advantage of the existing ther-
modynamical machinery we want to construct the Gibbs
free energy for information problems. To this end, we
introduce a temperature and a source function into the
PDF of the signal posterior as suggested by the deﬁnition
of the partition function (3) by deﬁning
P(s|d,T,J ) = e−β (H(s,d )+J†s)
Zβ (d,J) = (P(d,s) e−J†s)β
∫
Ds′ (P(d,s′) e−J†s′
)β .
(20)
With the temperature we can broaden (for T >1) or nar-
row (for T <1) the posterior. Three temperature values
are of special importance, namely T = 0, which modi-
ﬁes the PDF into a delta peak located at the posterior
maximum, T = 1, which returns the original posterior,
and T = ∞, leading to the maximum entropy state of an
uniform PDF. The source function J permits us to shift
the mean of the PDF to any possible signal conﬁguration
m= m(d,T,J ).
The modiﬁed PDF will be approximated by a Gaussian
with identical mean and variance:
P(s|d,T,J ) ≈ G (s− m,D) = ˜P(s|m,D), (21)
where also D= D(d,T,J ).
We will see, that the width D of this Gaussian ap-
proximation of the PDF increases with increasing tem-
perature. At low temperature ( T ≪ 1) the center of
the PDF is probed and modeled, while at large tempera-
tures ( T ≫ 1) the focus is on its asymptotic tails. Since
the Gaussian in (21) is an approximation, it is not even
guaranteed that T = 1 provides the best recipe for sig-
nal reconstruction. E.g. in [9] a case is shown, where
signal reconstruction using T = 0 .5 slightly outperforms
both, T = 0 and T = 1. Since working at multiple tem-
peratures can reveal diﬀerent aspects of the same non-
Gaussian PDF (i.e. its central or asymptotic behavior),
the question appears how the diﬀerently retrieved Gaus-
sian approximations can be combined into a single and
more accurate representation of the original PDF. This
will be addressed in Sect. IV. For the moment we ap-
proximate our posterior by a single Gaussian as in (21).
In this case, the partition function can be calculated
explicitly and reads
˜Zβ (d, J) =
⏐
⏐
⏐
⏐
2π
β D
⏐
⏐
⏐
⏐
1/ 2
exp
( J†DJ
2β + J†m− βH(m, d)
)
.
With standard thermodynamics procedure we calculate
⟨H⟩(s|d) ≈ − δ
δβ
˜Zβ (d, J)
⏐
⏐
⏐
⏐
J=0
= Ndgf
2 T + H(m, d)
(22)
where Ndgf is the dimension of the signal vector. This
result is the re-phrased equipartition theorem (4) from
classical thermodynamics and further motivates the no-
tion of temperature in IFT.
B. Internal, Helmholtz and Gibbs energy
The next step is to calculate the Helmholtz free energy.
In case it can be calculated explicitly from (17), the in-
ference problem is basically solved, since any (connected)
moment of the signal posterior can directly be calculated
from it by taking derivatives with respect to the moment
generating function J, e.g. see (18). This will, however,
only be the case for a very restricted class of Hamilto-
nians, like the free ones, which are only quadratic in s.
In the more interesting case the Helmholtz free energy
can not be calculated explicitly, we can use the thermo-
dynamical relation of the Helmholtz free energy with the
internal energy and entropy.
First, we note that the internal energy of the modiﬁed
posterior is given by
U(d,T,J ) = ⟨H(s,d)⟩(s|d,T,J )
≈ ⟨ H(s,d)⟩(s|m,D ) = ˜U(d,m,D ), (23)
where m and D are still functions of d, T, and J. The
average in the second line has to be understood to be
performed over a Gaussian with mean m and dispersion
D: ⟨f(s)⟩(s|m,D ) =
∫
Dsf(s) G(s− m,D).
Further, we need to calculate the entropy for the mod-
iﬁed PDF, which for a Gaussian depends only on D:
SB[G(s− m,D)] = 1
2 Tr
(
1 + log(2 πD)
)
= ˜SB(D). (24)
For the full modiﬁed posterior, (20), the entropy is cal-
culated via (15) to be
SB = β
(
U + J†m− F
)
, (25)
where m = m(d,T,J ) = ⟨s⟩(s|d,T,J ), U is given by (23),
and F by (17). Solving (25) for the Helmholtz free energy
yields
Fβ (d,J) = U − TSB + J†m. (26)
This expresses the Helmholtz free energy in terms of in-
ternal energy and entropy. Unfortunately, this expression
5
contains the term J†m, where mdepends on J implicitly
through (18). In order to get rid of this term, we Leg-
endre transform with respect to J and thereby use (18),
which provides us with the Gibbs free energy
Gβ (d,m) = F − J† δF
δJ = U − TSB. (27)
The Gibbs energy depends solely on m and not on J. It
can be constructed approximatively, in case approxima-
tions of the internal energy and the entropy are available.
For our Gaussian approximation of the modiﬁed poste-
rior we therefore write
˜Gβ (d,m,D ) = ˜U(d,m,D ) − T ˜SB(D). (28)
We know from thermodynamics that the minimum of the
Gibbs free energy with respect to variations in mprovides
the expectation value ⟨s⟩(s|d) of our ﬁeld:
δG(d,m,D )
δm
⏐
⏐
⏐
⏐
m=⟨s⟩(s|d)
= 0 (29)
Thus, the Gibbs energy is the information energy we were
looking for in the introduction.
Minimizing the Gibbs free energy for a Gaussian PDF
with respect to m yields
0 = δ˜G
δm =
∫
DsH(d,s) δG(s− m,D)
δm
= −D−1 ⟨φHm(d,φ)⟩(φ |D) , (30)
with Hm(d,φ) = H(d,m + φ), which implies
m=
⟨sH(d,s)⟩(s|m,D )
⟨H(d,s)⟩(s|m,D )
=
⟨sH(d,s)⟩(s|m,D )
˜U(m,D)
. (31)
The optimal map is therefore the ﬁrst signal moment of
the full Hamiltonian weighted with the approximating
Gaussian.
Thermodynamics teaches us further that the propaga-
tor, the uncertainty dispersion of the ﬁeld, is provided
by the second derivative of the Gibbs free energy around
this location, thanks to the well known relation
( δ2G
δmδm†
) −1⏐
⏐
⏐
⏐
⏐
m=⟨s⟩(s|d)
= − δ2F
δJδJ †
⏐
⏐
⏐
⏐
J=0
= βD. (32)
This relation closes the set of equations by providing D.
Evaluating (32) with our approximate Gibbs energy (28)
and using (29) yields
TD −1 = δ2 ˜G
δmδm†
⏐
⏐
⏐
⏐
⏐
m=⟨s⟩(s|d)
= −D−1 ˜U(d,m,D )
+ D−1 ⟨
φφ†Hm(d,φ)
⟩
(φ |D) D−1.
Thus the propagator is the second moment of the Gaus-
sian weighted Hamiltonian,
D=
⟨
φφ†Hm(φ)
⟩
(φ |D)
˜U(d,m,D ) + T
. (33)
This equation seems to suggest that the propagator eval-
uated at higher temperature is narrower, since T appears
in the denominator. However, the opposite is the case
due to the presence of D in all terms, as a test with a
free Hamiltonian will show in (44).
C. Cross information
The Gibbs free energy at T = 1 is directly related to
the cross information between the posterior and its Gaus-
sian approximation. The cross information (or negative
relative entropy) of a PDF ˜P with respect to another
one P is measured by the so called Kullback-Leibler di-
vergence [26]:
dKL[ ˜P,P] =
∫
Ds ˜P(s|d) log
( ˜P(s|d)
P(s|d)
)
. (34)
The Kullback-Leibler divergence characterizes the dis-
tance between a surrogate and target PDF in an informa-
tion theoretical sense. It is an asymmetric distance mea-
sure, reﬂecting that the roles of the two involved PDF
diﬀer. The equivalence of Gibbs free energy and cross in-
formation with respect to inference problems can easily
be seen:
˜G(m,D) = ⟨H(d,s) + log( G(s− m,D))⟩(s|m,D )
=
∫
DsG(s− m,D) log
( G(s− m,D)
P(s,d)
)
∼
=
∫
DsG(s− m,D) log
( G(s− m,D)
P(s|d)
)
= d KL[ ˜P,P]. (35)
In the second last step we added the term log P(d), which
is irrelevant here, since m- and D-independent, and in
the last step we introduced the Kullback-Leibler diver-
gence between posterior P(s|d) and its Gaussian sur-
rogate ˜P(s|d) = G(s− m,D). Minimal Gibbs free en-
ergy therefore seems to corresponds to minimal Kullback-
Leibler divergence, and therefore to maximal cross infor-
mation of the surrogate with the exact posterior.
However, we have only minimized the Gibbs free en-
ergy so far with respect to m, the mean ﬁeld, degrees of
freedom of our Gaussian, not with respect to the ones pa-
rameterizing the uncertainty dispersion D. We have de-
termined this using the thermodynamical relation (29).
If we want that our surrogate PDF has maximal cross in-
formation with the posterior with respect to all degrees
of freedom of our Gaussian, we also have to minimizing
the Gibbs energy with respect to D. A short calculation
6
shows that this actually yields a result which is equivalent
to the thermodynamical relation (32):
0 = δ˜G
δD =
∫
DφHm(d,φ) δG(φ,D)
δD − T δ ˜SB(D)
δD
= D−1
2
[ ⟨
φφ†Hm(d,φ)
⟩
(φ |D) − D
( ˜U(m,D) + T
) ]
D−1,
from which also (33) follows. Thus, we can regard both,
the map m and its uncertainty covariance D, as param-
eters for which the Gibbs energy should be minimized.
We will refer to this as the maximal cross information
principle.
We further note that the maximal cross information
principle also holds if the Gaussian is replaced by some
other model function, G[ ˜P(s|d)] ∼
= dKL[ ˜P,P], a property
we will use later in Sect. IV.
Note, that the minimal cross information and the ther-
modynamical relations yield exactly the same results for
m and D only if ˜G(m,D) is calculated exactly. In case
there are approximations involved, the resulting algo-
rithms diﬀer slightly, and this diﬀerence can be used to
monitor the impact of the approximation made. In the
following, we use the minimal cross information principle
for our examples.
D. Calculating the internal energy
In order to calculate the approximative Gibbs energy,
we need to estimate the internal energy, for which we
have to specify the exact Hamiltonian. We assume that
it can be Taylor-Fr´ echet expanded as
H(d,s) =
∞∑
n=0
1
n! Λ (n)
x1...x n sx1 · · · sxn
  
Λ (n)(s,...s )
, (36)
where repeated coordinates are thought to be integrated
or summed over. The approximative internal energy is
then
˜U(m,D) = U[ ˜P(s|d)] =
∫
DsH(d,s) ˜P(s|d)
=
∞∑
n=0
1
n!
⣨
Λ (n)(s,...s )
⟩
(s|m,D )
. (37)
The Gaussian n-point correlation functions in this equa-
tion can actually be calculated analytically. For this, we
again use the shifted ﬁeld φ = s− m, which has the
Hamiltonian
Hm(d,φ) =
∞∑
n=0
1
n! Λ (n)
m (φ,...φ ), with (38)
Λ (n)
m (φ,...φ ) =
∞∑
k=0
1
k! Λ (n+k)(φ,...φ

 
n
,m,...m  
k
).
We assume that the interaction coeﬃcients Λ (n)
x1...x n are
symmetric with respect to index permutations, since they
resulted from a Taylor-Fr´ echet expansion.
The internal energy can then be calculated via the
Wick theorem and the fact that all odd moments of φ
vanish:
˜U(m,D) =
∞∑
n=0
1
n!
⣨
Λ (n)
m (φ,...φ )
⟩
(φ |D)
(39)
=
∞∑
n=0
1
2n n! Λ (2n)
m (
n
  
D⊗ · · · D)
=
∞∑
n,k =0
Λ (2n+k)(
n
  
D⊗ · · · D⊗
k
  
m⊗ · · · m)
2n n! k! .
Here, we deﬁned the symmetrized tensor product
(
T ⊗
T′)
x1...x n
≡ ∑
π ∈Sn
1
n! Txπ (1)...x π (k) ·T′
xπ (k+1)...x π (n) by aver-
aging over all permutations in Sn, the symmetric group.
Having obtained the internal energy with (39), and
entropy with (25) approximatively, we can construct the
Gibbs free energy according to (28) which we use for our
inference.
E. Minimizing
In order to get our optimal Gaussian approximation
to the posterior, we have to minimize ˜Gβ (m,D) with
respect to m and D. Minimizing for m is equivalent to
minimizing the internal energy, since the entropy does
not depend on m. This yields
0 = δ˜U(m,D)
δm (40)
=
∞∑
n,k =0
Λ (2n+k+1)(
n
  
D⊗ · · · D⊗
k
  
m⊗ · · · m,·)
2n n! k! ,.
which has to be solved for mfor any given D. The prop-
agator derives from (32) or from
0 = δ˜G(m,D)
δD ⇒ (41)
TD −1 =
∞∑
n,k =0
Λ (2n+k+2)(·,·,
n
  
D⊗ · · · D⊗
k
  
m⊗ · · · m)
2n n! k! .
which also depends on m. Thus, (40) and (41) have to
be solved simultaneously.
A simple example should be in order. The simplest
case is that of the original Hamiltonian being quadratic.
The approximated one should then match this exactly. A
quadratic or free Hamiltonian is equivalent to a Gaussian
7
posterior, P(s|d) = G(s− m∗,D∗). We get
H(d,s) ∼
= 1
2 (s− m∗)†D−1
∗ (s− m∗)
∼
= Λ (1)
x sx + 1
2 Λ (2)
xy sxsy with (42)
Λ (1) = −D−1
∗ m∗, and
Λ (2) = D−1
∗ .
Inserting this into (40) and (41) yields
0 = Λ (1)(·) + Λ (2)(m,·) = D−1
∗ (m− m∗)
⇒ m= m∗, (43)
TD −1 = Λ (2)(·,·) = D−1
∗
⇒ D= TD∗, (44)
which indeed recovers the original coeﬃcients for T = 1,
and a narrower or wider uncertainty dispersion for T <1
or T >1, respectively. In the following, we will see that
also in case of interacting Hamiltonians the minimal free
energy principle provides the correct results. We show
this by reproducing (and extending) signal estimators de-
rived previously in IFT using renormalization techniques.
III. APPLICATION EXAMPLES
A. Poissonian log-normal data
1. Separable case
Many inference problems have to deal with Poissonian
noise, like X-ray and γ-ray astronomy as well as recon-
struction of the cosmic large-scale structure from galaxy
counts. Let us assume that the mean count rate λ of
photons or galaxies is proportional to an exponentiated
Gaussian random ﬁeld s with covariance S =
⟨
ss†⟩
(s)
according to
λ(s) = κeb s . (45)
Here, κ is the expected counts for s= 0, which may de-
pend on the spatial position. The scalar b permits us to
change conveniently the strength of the non-linearity of
the problem without changing the signal statistics. This
log-normal model for the cosmic large-scale structures as
an approximative description is actually supported ob-
servationally [27, 28] and theoretically [29–34].
As a starting point, we assume a local response, so that
the Poisson statistics for the actual counts dx at location
x are
P(dx|λx) = λdx
x
dx! e−λ x , (46)
and the full likelihood is well separable into local ones:
P(d|s) =
∏
x
P(dx|λx(sx)). (47)
The corresponding Hamiltonian was shown in [9] to be
H(d,s) ∼
= 1
2s†S−1s− d†bs + κ†eb s . (48)
Reconstruction methods for this data model were devel-
oped by [9, 35–37].
The internal energy of our Gaussian approximation can
be calculated analytically,
˜U(m,D) ∼
= 1
2 m†S−1m+ 1
2 Tr(DS−1) − d†bm
+ κ†eb m+ b2
2 ˆD (49)
where ˆD denotes the vector of diagonal elements of D.
Minimizing ˜G(m,D) = ˜U(m,D) − T ˜SB(D) with re-
spect to m and D yields
m = Sb
(
d− κm+ b
2 ˆD
)
, and
D = T
(
S−1 + b2 ˆκm+ b
2 ˆD
) −1
, (50)
respectively. Here we have deﬁned κt = κexp(bt) and
denote a diagonal matrix by putting a hat onto a vector
of its diagonal elements ( ˆλ)xy = λx δxy. This result is
identical with the one found in [9] using a lengthy renor-
malization calculation. There it was found by numerical
experiment, that using T = 0 .5 in (50) seems to produce
slightly better results than T = 0 and T = 1.
2. Entangled case
So far, we assumed that the response provides a one to
one correspondence between locations in signal and data
space. However, for most measurements this is not ex-
actly true. X- and γ-ray telescopes typically exhibit point
spread functions, which map a single signal space location
onto several detectors, of which each detects events com-
ing from several indistinguishable directions. Also galaxy
redshifts do not provide accurate distance information,
since redshift distortions and measurement errors lead to
eﬀective point spread functions.
In the following, we generalize to the case of a known
and ﬁxed, but non-local measurement response. Fixed
means, that the response is independent of the signal.
This excludes the treatment of galaxy redshift distortions
with this case (e.g. see [38] for this), but still includes
photometric redshift errors of galaxy catalogs as well as
X- and γ-ray telescope data. Such problems have been
approached in the past via the MAP principle [39–42].
The point spread function is modeled by the response
matrix R = ( Rix) which describes how emissivity at lo-
cation x is expected to be observed in data channel i.
The expected count rate is now
λ(s) = Reb s , (51)
8
and the likelihood does not separate any more with re-
spect to x
P(d|s) =
∏
i
P(di|λi(s)), (52)
since λi(s) entangles the signal from several locations,
whereas in (47) it depends only on the local signal value.
We recover the former case for a diagonal response Rix =
κx δix. The resulting Hamiltonian
H(s|d) ∼
= 1
2 s†S−1s+ 1†Reb s − d† log(Reb s ) (53)
reduces to (48) for R being diagonal.
The internal energy of our surrogate Gaussian
˜P(s|d) = G(s− m,D) is then
˜U(m,D) = 1
2 m†S−1m+ 1
2Tr(DS−1) + 1 †Reb m+ b2
2 ˆD
−
∑
i
di
∫
Dφ log
(
R†
i eb (m+φ )
)
G(φ,D)
  
Ii
.(54)
This integral Ii can not be calculated in closed from due
to the logarithm in the integrand. We expand the loga-
rithm around R†
i em, since we will see that this recovers
the result of the separable case most easily for R being
diagonal. We get
Ii = log
(
R†
i eb m
)
+
⟨
log
(
R†
i eb (m+φ )
R†
i eb m
)⟩
(φ |D)
.(55)
In case R is diagonal, the ﬁrst term reduces to bm +
log Ri, the second vanishes as ⟨log(exp(bφ))⟩(φ |D) =
⟨bφ⟩(φ |D) = 0, and we recover the Hamiltonian of the
separable case.
In the general case of an entangling response we Taylor
expand the logarithm of the second term
Ii = log
(
R†
i eb m
)
−
∞∑
n=1
(−1)n
n
⣨(
r†
i eb φ − 1
) n⟩
(φ |D)
  
IIi n
, with (56)
ri = Rieb m
R†
i eb m
or ri(x) = Ri(x) eb m(x)
∫
dx′ Ri(x′) eb m(x′) .
We note that r†
i 1 =
∫
dxrix = 1 by construction.
The expansion coeﬃcients II i n can be worked out one
by one. We provide here the ﬁrst few, namely
IIi 1 = r†
i e
1
2 b2 ˆD − 1,
IIi 2 = rixriy e
1
2 b2(Dxx+Dyy +2Dxy ) − 2r†
i e
1
2 b2 ˆD + 1,
IIi 3 = rixriyriz exp

b2
2
∑
a,b ∈{x,y,z }
Dab


− 3 rixriy exp

b2
2
∑
a,b ∈{x,y }
Dab


+ 3 r†
i e
1
2 b2 ˆD − 1. (57)
These coeﬃcients stay small if b2 D ≪ 1, which means
that the expansion can be truncated if the signal is known
within a few ten percent or if non-Gaussianity is small.
Large uncertainties in the signal strength do not nec-
essarily lead to large coeﬃcients if they are located at
positions without instrumental sensitivity ( Rix small) or
much lower expected count rates ( mx small). In both
cases mostly prior information and extrapolation from
regions with more informative data will determine the
solution at such locations.
In case some of these coeﬃcients are large, substan-
tial signal uncertainty at the locations to which they are
sensitive must be present. In this case an accurate recon-
struction for these locations can not be expected. Thus,
if we simplify the Hamiltonian by dropping such terms,
even if they are relatively large, the quality of the recon-
struction will not suﬀer too much since only regions are
aﬀected, which are poorly constrained by the data any-
way. Therefore, truncating the expansion should already
provide usable algorithms.
3. Zeroth order solution
To zeroth order, we ignore all II i n -terms and ﬁnd for
the approximative free energy
˜G(m,D) ≈ 1
2 m†S−1m+ 1
2 Tr(DS−1)
+
∑
i
[
R†
i eb m+ b2
2 ˆD − di log
(
R†
i eb m
)]
− T
2 Tr (1 + log(2 πD)) . (58)
Minimizing this with respect to m and D yields
m = Sb
∑
i
Ri eb m
(
di
R†
i eb m
− e
1
2 b2 ˆD
)
= Sb
(
d†r− κ′(m+ b ˆD/2)
)
, and
D = T
(
S−1 + b2 ˆκ′(m+ b ˆD/2)
) −1
, with
κ′(t) =
∑
i
Ri eb t . (59)
This is very similar to (50) and reduces to it for a diagonal
response.
4. First order correction
First order corrections are included by keeping the
IIi1-term in the approximative free energy, but ignoring
9
higher terms. The resulting equations are
m = Sb
( ∑
i
di
(
1 + r†
i e
b2
2 ˆD
)
ri − κ′′(m+ b ˆD/2)
)
D = T
(
S−1 + b2 ˆκ′′(m+ b ˆD/2)
) −1
, with
κ′′(t) =
∑
i
Ri eb t
(
1 + di
R†
i eb m
)
. (60)
This is a slight modiﬁcation with respect to (59) in two
aspects. The map changes a bit, but the sign of the
changes depends on the details of the point spread func-
tion, since there are two new terms of similar order, but
with opposite signs. The uncertainty variance is reduced,
since the term added to the inverse propagator is always
positive.
5. Observation with background
The observation may suﬀer from a background, events
in data space, which do not contribute to our signal
knowledge. For example γ-ray astronomy has to suppress
cosmic ray events as much as possible, since charged par-
ticles do not point back to the same sources as neutral
photons due to cosmic magnetic ﬁelds. Fortunately, cos-
mic rays have diﬀerent signatures in data space due to the
diﬀerences in hadronic and electromagnetic interactions.
However, not for all measured events is the distinction
clearly cut and we have to use prior knowledge to sup-
press the background events.
Therefore we should extend our formalism to also take
such unwanted backgrounds into account. Actually a
reinterpretation of the above formula will do. We ex-
tend our signal space by the quantity f determining the
logarithm of the background count rate, s→ s′ = ( s,f).
fz might be a ﬁeld over the same physical space as sx, or
just a single number as a total isotropic cosmic ray ﬂux.
In any case, the x− and z−coordinates are regarded to be
over diﬀerent spaces, or distinct areas of the joint space
over which f and s live. The joint covariance reads
S′ =
(
S 0
0 F
)
(61)
due to the independence of signal and background. Here,
F =
⟨
ff †⟩
(f) is the log-background covariance. The re-
sponse R→ R′ has to be extended to map also the back-
ground space into the data space. Whether the response
images of signal and background events in data space are
well separated or whether they overlap decides about the
background discriminating power of the instrument.
The combined map and covariance of signal and log-
background can now be obtained, e.g. from (59) or
(60) with the appropriate replacements for S,R,m,D →
S′,R′,m′,D′. Our joint map can be split into a sig-
nal and log-background part m′ = (˜s, ˜f). Since we
are usually not interested in the background proper-
ties, we marginalize over it. This is especially simple
in the Gaussian approximation of our joint posterior
P(s′|d) ≈ G (s′ − m′,D′), with s′ = ( s,f), m′ = (˜s, ˜f),
m ≈
∫
Ds′ sG(s′ − m′,D′) = ˜s, and (62)
Dxy ≈
∫
Ds′ (s− ˜s)x (s− ˜s)y G(s′ − m′,D′) = D′
xy.
Although this does not look too diﬀerent from the for-
mula for the case without background, the eﬀect of the
background entered through the joint covariance matrix
D′, which mixes the contribution from the signal and
background events appropriately.
B. Reconstruction without spectral knowledge
1. Eﬀective theory
The reconstruction of the signal in the Poisson log-
normal model in the previous section assumed that the
signal covariance is known a priori. In case it is unknown,
it has to be extracted from the same data used for the
signal inference [43–47]. However, the optimal way to do
this was usually not derived from ﬁrst principles, maybe
except in [48–50]. A rigorous approach to such prob-
lems is given by the computationally expensive Gibbs-
sampling technique, which investigates the joint space of
signal realizations and power spectra [51–54], which can
then easily be marginalized over the power spectra to
obtain a generic signal reconstruction. This problem was
also addressed approximatively for the case of linear re-
sponse data from a Gaussian signal subject to Gaussian
noise using the MAP principle as well as by the help of
parameter uncertainty renormalized estimation by [11].
We re-address this problem here using the minimal free
energy approach.
We assume the covariance S =
⟨
ss†⟩
(s) of our Gaus-
sian signal s to be diagonal within some known function
basis Okx, e.g. the Fourier basis with Okx = ei k x . We
model the power spectrum (in this basis) as being a lin-
ear combination of a number of positive basis functions
fi(k) with disjoint supports (the spectral bands), so that
Ps(k) =
∑
i
pifi(k) (63)
is positive for all k(all coeﬃcients of p= ( pi)i are positive
and the spectral bands cover the full k-space domain).
We deﬁne
(Si)xy = ( O† ˆfiO)xy =
Ok x fi(k) Ok y (64)
to be the i-th spectral band matrix and S−1
i to be its
pseudo-inverse. Thus, we write our signal covariance as
S =
∑
i
piSi, (65)
10
with p = ( pi) the vector of unknown spectral parame-
ters. We further assume that the individual signal-band
amplitudes pi have an independent prior distribution,
P(p) =
∏
i
P(pi), (66)
with the individual priors being inverse-gamma distribu-
tions, power-laws with exponential low amplitude cutoﬀ
at qi :
P(pi) = 1
qi Γ(αi − 1)
( pi
qi
) −α i
exp
(
− qi
pi
)
. (67)
For αi ≫ 1 this is an informative prior, where qi/αi
determines the preferred value. A non-informative prior
would be given by Jeﬀreys prior with αi = 1 and qi = 0. 2
For a linear data model
d= Rs + n, (68)
with Gaussian noise with covariance N =
⟨
nn†⟩
(n), the
parameter marginalized eﬀective Hamiltonian is accord-
ing to [11]
H(d,s) ∼
= 1
2 s†Ms − j†s+
∑
i
γi log
(
qi + 1
2 s†S−1
i s
)
.
(69)
Here M = R†N−1R, j = R†N−1d, γi = αi − 1 + ̺i/2,
and ̺i = Tr[ S−1
i Si] the number of spectral degrees of
freedom within the band i.
2. Free energy expansion
The internal energy of a Gaussian posterior-ansatz is
then
˜U(m,D) ∼
= 1
2 m†Mm + 1
2 Tr(DM) − j†m
+
∑
i
γi
⟨
log
(
qi + 1
2 s†S−1
i s
)⟩
(s|m,D )
  
Ii
.(70)
Again we have to deal with a Gaussian average over a
logarithm, which we expand as
Ii = log(˜qi) −
∞∑
k=1
(−1)k
k(˜qi)k
⟨(
qi + 1
2 s†S−1
i s− ˜qi
) k⟩
(s|m,D )
  
IIik
,
with ˜qi = qi + 1
2 Tr((mm† + δD)S−1
i ). (71)
2 Since this would result in an improperly normalized prior, we
understand this asαi = 1 +ǫ, qi = ǫ, and limǫ→ 0 at the end of
the calculation.
Here we have introduced a parameter δ to be ﬁxed soon.
The ﬁrst two expansion coeﬃcients are
IIi1 = 1
2 (1 − δ)Tr(DS−1
i )
IIi2 = II 2
i1 + Tr
((
mm† + 1
2 D
)
S−1
i DS−1
i
)
.(72)
3. Zeroth order solution
To zeroth order we ﬁnd by minimizing the free energy
while ignoring the II-corrections
m = D′ j, D= TD ′, and
D′ =
(
M +
∑
i
p−1
i S−1
i
) −1
. (73)
This means that the map is the Wiener ﬁltered data,
where the spectral coeﬃcients are assumed to be
pi = ˜qi
γi δ = 1
γi δ
(
qi + 1
2 Tr((mm† + δD)S−1
i )
)
. (74)
For δ = 0 this yields pi = ∞ and therefore D = M−1
if M is (pseudo)-invertible. The resulting ﬁlter provides
a noise weighted deconvolution, however is unable to ex-
trapolate into unobserved regions of the signal space. It
is widely used for map making in the ﬁeld of cosmic mi-
crowave background observations. For δ = 1 we recover
the critical estimator of [11]. Since there it was shown
that the latter performs signiﬁcantly better than the for-
mer, and also since II i1 = 0 and II i2 is minimal for δ= 1,
we adopt this in the following. For Jeﬀreys prior we ﬁnd
pi = Tr(Bi)
̺i
, (75)
with Bi = ( mm† + D)S−1
i .
4. Second order correction
Including higher order corrections should improve the
reconstruction. The ﬁrst order corrections vanish for δ =
1. The second order correction yields
m = D′ j, D= T
[
D′−1 −
∑
i
γi
˜q2
i
S−1
i mm†S−1
i
] −1
,
D′ =
[
M +
∑
i
γi
˜qi
Xi S−1
i
] −1
, (76)
Xi = 1 + 1
˜q2
i
Tr
(
(mm† + 1
2 D) S−1
i DS−1
i
)
− 1
˜qi
S−1
i D.
The operator D′, which is applied to j to generate the
map, and the uncertainty dispersion D are not identi-
cal any more. Neither of them can still be expressed as
11
(M+∑
i p−1
i S−1
i )−1, due to the operator structure of the
S−1
i D and S−1
i mm† terms. This was also found in [11].
However, if we can assume that this operator processes
any channel in the i-th band in a similar way, we can re-
place S−1
i DS−1
i and S−1
i mm†S−1
i by their channel aver-
aged values Tr( DS−1
i ) S−1
i /̺i and Tr(mm†S−1
i ) S−1
i /̺i,
respectively. This permits to identify spectral coeﬃ-
cients of D = ( M + ∑
i p−1
i S−1
i )−1 and D′ = ( M +∑
i p′
i
−1S−1
i )−1. For Jeﬀreys prior they become
pi = Tr(Bi)
̺i

1 − 2
̺i
(
Tr
(
mm†S−1
i
)
Tr(Bi)
) 2

−1
, and
p′
i = Tr(Bi)
̺i
[
1 + 2
̺i
Tr
(
mm†S−1
i
)
Tr
(
DS−1
i
)
(Tr(Bi))2
] −1
,(77)
where m, D, and Bi = ( mm† + D)S−1
i all depend on p.
It is obvious, that the second order correction increases
pi by some margin compared to (75), meaning that the
reconstruction uncertainty increases. It is less obvious
how p′
i develops, since at ﬁrst glance it seems to be cor-
rected downwards. Note however, that an increased pi
implies an increased Tr( Bi), since D grows (spectrally)
with increasing pi.
The fact that we get two diﬀering sets of spectral coeﬃ-
cients, pi and p′
i, reminds us to regard them as auxiliary
variables of our signal reconstruction algorithm, rather
than as optimal spectrum estimates.
C. Poisson log-normal distribution with unknown
spectrum
The combined problem, reconstructing a Poisson log-
normal signal with unknown spectrum, can now be
treated approximatively. The combined free energy for
the Gaussian posterior approximation to zeroth order is
˜G(m,D) ≈
∑
i
[
R†
i eb m+ b2
2 ˆD − di log
(
R†
i eb m
)]
+
∑
i
γi log
(
qi + 1
2 Tr
(
(mm† + D) S−1
i
) )
− T
2 Tr (1 + log(2 πD)) . (78)
The resulting map and uncertainty dispersion are pro-
vided by (59) with the addition that S = ∑
i pi Si and
the pis are provided by (74). Higher order corrections can
be included in a similar way as in the individual prob-
lems. Also background counts with known or unknown
covariance structure can be included in the same way
they were treated in Sect. III A 5.
IV. INFORMATION SYNTHESIS
A. Multi-temperature posterior
Although the obtained Gaussian knowledge states from
minimal free energy estimation are approximative and
therefore of limited accuracy, they might permit us to
construct more accurate models of the posterior. The
idea is to combine several Gaussian distributions to a
more accurate approximation of the true non-Gaussian
posterior probability, and to measure the mean map and
its uncertainty dispersion from this combination.
We recall that Gaussian approximations of the poste-
rior obtained at low temperatures ( T ≪ 1) mostly carry
information on its peak region, while those obtained at
large temperatures ( T ≫ 1) information on its asymp-
totics. Also the canonical T = 1 does not provide a
perfect representation of the posterior, as a Gaussian ap-
proximation for a non-Gaussian PDF never can. How-
ever, by combining such diﬀerent approximations in an
appropriate way, we should obtain an improved repre-
sentation of the correct PDF, which permits much easier
calculation of moments like the signal mean and its un-
certainty variance.
To this end we postulate the existence of a temperature
distribution function P(T), such that
P(s|d) =
∫ ∞
0
dTG(s− m(d,T ),D(d,T )) P(T) (79)
combines the diﬀerent Gaussians with means m(d,T ) and
dispersions D(d,T ) to synthesize the right posterior prob-
ability. A formal proof of the existence of P(T), and the
necessary conditions for this is beyond the scope of this
work. It should be noted, that e.g. multi-peaked distri-
butions cannot accurately be represented by approximate
Gaussians obtained at diﬀerent temperatures. They can,
however, often be well approximated by Gausians cen-
tered on those peaks. The recipes described below do
not depend on the way the diﬀerent Gaussians used in
the mixture model were obtained, and therefore can also
be used in such cases.
In the following we provide a recipe to construct P(T)
in practice. We assume that mi = m(d,T i) and Di =
D(d,T i) have been computed for a number NT of temper-
atures Ti. The temperatures are best chosen to sample
well the diﬀerent part of the posterior, its peak by having
some Ti ≪ 1, the bulk of the PDF with Ti = 1, and the
PDF tails with Ti ≫ 1.
The surrogate probability function we want to con-
struct, and which should resemble the exact one as closely
as possible, is therefore of the form
˜P(s|d) =
NT∑
i=1
G(s− mi,Di) Pi. (80)
˜P(s|d) should be as close as possible to P(s|d) in an infor-
mation theoretical sense. The natural choice for the dis-
tance measure is the Kullback-Leibler divergence, which
12
measures the cross-information of ˜P(s|d) on P(s|d), and
which is practically identical to the free energy ˜G[ ˜P(s|d)]
of our surrogate posterior according to (34). Introducing
un-normalized probabilities pi as our degrees of freedom,
and setting Pi = pi/Zp with Zp = ∑
j pj in order to
enforce the proper normalization, ∑
i Pi = 1, this reads
˜G(p) =
∑
i
pi
Zp
(Ui − ˜Ui(p)) − F. (81)
We have introduced the here irrelevant, since p-
independent, free energy F = − log Zd of the original
problem and the energies Ui and ˜Ui(p) with respect to
the template distributions Gi(s) = G(s− mi,Di):
Ui = ⟨H(d,s)⟩Gi =
∫
Ds Gi(s) H(d,s) and
˜Ui(p) =
⣨
˜Hp(s)
⟩
Gi
, with (82)
˜Hp(s) = − log(
∑
i
pi Gi(s)/Zp).
B. Minimizing the Gibbs energy
1. Analytical scheme
Now one has to minimize ˜G(p) with respect to p. The
problem to calculate the path integrals deﬁning the en-
ergies was already addressed in this work. A system-
atic way is to Taylor-Fr´ echet expand the Hamiltonians
around the centers of the Gaussians mi and then use the
known moments of Gi(s) to approximate the energies.
For the surrogate energies this yields up to second order
in φi = s− mi
˜Ui(p) = − log gi + 1
2
∑
j
gj i
gi
Tr(D−1
j Di) (83)
+ 1
2
∑
j k
gj i
gi
( gk i
gi
− δjk
)
m†
ijD−1
j Di D−1
k mik,
with
gj i = pj Gj (mi)/Zp, and
gi =
Nj∑
j=1
gj i , and (84)
mij = mi − mj .
2. Monte-Carlo scheme
Alternatively, one can approximate the average
⟨X[s]⟩Gi of a quantity X[s] by sums over Ni sampling
points {s(j)
i }j, which can easily be drawn from Gi(s):
⟨X[s]⟩Gi ≈
∑
j
X[s(j)
i ]/Ni. (85)
This way, ˜G(p) can be approximated, and minimized with
a suitable optimization scheme. The sampling points,
their Gaussian probabilities G(j)
k i = Gk(s(j)
i ), as well as
the energies Ui need only be calculated once, but the sur-
rogate energies Ui(p) = log Zp − ∑
j log(∑
k pk G(j)
k i )/Ni
have to be updated at any step of the scheme.
One might argue, that if we use stochastic methods
to build ˜P(s|d), one could have used a Markov-Chain
Monte-Carlo (MCMC) method right from the beginning
for the signal inference problem. However, we expect that
the here described posterior synthesis method should re-
produce the correct posterior better than a sample point
cloud, since we are using well adapted Gaussians as our
building blocks and not delta functions as the direct
MCMC approach uses. Furthermore, the analytical and
sampling method can be combined, in that the analyti-
cal estimates are combined with the sampling estimates
of the contributions of the neglected terms in the Taylor-
Fr´ echet expansions of (83). And ﬁnally, since our scheme
draws samples from Gaussians, it can be trivially paral-
lelized, which is not easily possible with MCMC schemes.
C. Maps and moments
Once the minimum of ˜G(p) with respect to pis found,
one has synthesized a posterior approximation with a
Gaussian mixture model. From this, any moment of the
distribution function can easily be calculated. The mean
map can be expressed as
m≈ ⟨s⟩˜P (s) =
∑
i
Pi ⟨s⟩Gi(s) =
∑
i
Pi mi, (86)
as well as the uncertainty dispersion as
D≈
⟨
(s− m) (s− m)†⟩
˜P (s) =
∑
i
Pi (Di+mi m†
i )−mm†.
(87)
We leave the veriﬁcation and application of the informa-
tion synthesis method for future work.
V. CONCLUSIONS
We have shown that the minimal free Gibbs energy
principle in information ﬁeld theory can be used to ob-
tain approximate knowledge states with maximal cross-
information to the exact posterior. The construction of
such knowledge states with Gaussian PDF is relatively
straightforward:
1. The joint PDF of signal and data P(d,s) has to
be speciﬁed, e.g. by specifying a data likelihood
P(d|s) and signal prior P(s), and using P(d,s) =
P(d|s) P(s).
2. The information Hamiltonian His the negative log-
arithm of this, H(d,s) = − log(P(d,s)).
13
3. A suitably parametrized PDF as a surrogate for the
posterior has to be speciﬁed, e.g. a Gaussian with
its mean and dispersion as degrees of freedom.
4. The internal energy U and entropy SB of this
PDF have to be calculated as the PDF-average of
the Hamiltonian and the negative log-PDF, respec-
tively.
5. The Gibbs free energy, G= U − TSB, has then to
be minimized with respect to all degrees of freedom
of the surrogate PDF.
6. Any statistical summary like mean and variance
can now be extracted from the surrogate PDF.
The minimal free energy principle is therefore well suited
to tackle statistical inference problems. We have demon-
strated this with two diﬀerent problems and their com-
bination: reconstructing a log-normal ﬁeld from Poisson
data subject to a point spread function and reconstruc-
tion without prior knowledge on the signal power spec-
trum. Earlier results from renormalization calculations
in [9, 11] have been reproduced. The there used renor-
malization schemes can therefore be understood as aim-
ing for a surrogate Gaussian PDF which has maximal
cross information to the correct posterior. Since these
results were previously shown to reconstruct well, also
the here proposed method for the more complicated com-
bined case can be expected to work. However, a detailed
implementation and veriﬁcation of this was left for future
work.
Finally we have sketched how Gaussian knowledge
states obtained at diﬀerent thermodynamical tempera-
tures can be combined into a more accurate representa-
tion of the posterior, from which moments of the signal
uncertainty distributions can easily be extracted.
The minimal Gibbs energy and maximal cross informa-
tion principle introduced here to IFT should allow the
construction of novel reconstruction schemes for statis-
tical inference problems on spatially distributed signals.
The thermodynamical language may help to clarify con-
cepts and to simplify applications of IFT, since it permits
us to tackle non-linear inverse problems without the need
to use diagrammatic perturbation theory and renormal-
ization schemes.
Acknowledgments
We thank Mona Frommert, Jens Jasche, Niels Opper-
mann, Gerhard B¨ orner, and three referees for discussions
and comments on the manuscript.
[1] E. T. Jaynes, Physical Review 106, 620 (1957).
[2] E. T. Jaynes, Physical Review 108, 171 (1957).
[3] J. N. Fry, ApJ 289, 10 (1985).
[4] E. Bertschinger, ApJ 323, L103 (1987).
[5] W. Bialek and A. Zee, Physical Review Letters 58, 741
(1987).
[6] W. Bialek and A. Zee, Physical Review Letters 61, 1512
(1988).
[7] W. Bialek, C. G. Callan, and S. P. Strong, Physical Re-
view Letters 77, 4693 (1996), arXiv:cond-mat/9607180.
[8] J. C. Lemm, ArXiv Physics e-prints (1999),
physics/9912005.
[9] T. A. Enßlin, M. Frommert, and F. S. Kitaura,
Phys. Rev. D 80, 105005 (2009), 0806.3474.
[10] J. C. Lemm, Bayesian Field Theory (Johns Hopkins Uni-
versity Press, 2003).
[11] T. A. Enßlin and M. Frommert, ArXiv e-prints (2010),
1002.2928.
[12] R. T. Cox, American Journal of Physics 14, 1 (1946).
[13] R. T. Cox, American Journal of Physics 31, 66 (1963).
[14] S. F. Gull and G. J. Daniell, Nature 272, 686 (1978).
[15] J. Skilling, A. W. Strong, and K. Bennett, MNRAS 187,
145 (1979).
[16] R. K. Bryan and J. Skilling, MNRAS 191, 69 (1980).
[17] S. F. Burch, S. F. Gull, and J. Skilling, Computer Vision
Graphics and Image Processing 23, 113 (1983).
[18] S. F. Gull and J. Skilling, in Indirect Imaging. Measure-
ment and Processing for Indirect Imaging (1983), p. 267.
[19] S. Sibisi, J. Skilling, R. G. Brereton, E. D. Laue, and
J. Staunton, Nature 311, 446 (1984).
[20] D. M. Titterington and J. Skilling, Nature 312, 381
(1984).
[21] J. Skilling and R. K. Bryan, MNRAS 211, 111 (1984).
[22] R. K. Bryan and J. Skilling, Journal of Modern Optics
33, 287 (1986).
[23] S. F. Gull, in Maximum Entropy and Bayesian Meth-
ods, edited by J. Skilling (Kluwer Academic Publishers,
Dordtrecht, 1989), pp. 53–71.
[24] S. F. Gull and J. Skilling, The MEMSYS5 User’s Man-
ual (Maximum Entropy Data Consultants Ltd, Royston,
1990).
[25] J. Skilling, in Maximum Entropy and Bayesian Methods ,
edited by G. J. Erickson, J. T. Rychert, and C. R. Smith
(1998), p. 1.
[26] S. Kullback and R. Leibler, Annals of Mathematical
Statistics 22 (1) , 79 (1951).
[27] E. Hubble, ApJ 79, 8 (1934).
[28] F. S. Kitaura, J. Jasche, C. Li, T. A. Enßlin, R. B. Met-
calf, B. D. Wandelt, G. Lemson, and S. D. M. White,
MNRAS 400, 183 (2009), 0906.3978.
[29] D. Layzer, AJ 61, 383 (1956).
[30] P. Coles and B. Jones, MNRAS 248, 1 (1991).
[31] R. K. Sheth, MNRAS 277, 933 (1995), astro-
ph/9511096.
[32] I. Kayo, A. Taruya, and Y. Suto, ApJ 561, 22 (2001),
arXiv:astro-ph/0105218.
[33] R. Vio, P. Andreani, and W. Wamsteker, PASP 113,
1009 (2001), arXiv:astro-ph/0105107.
[34] M. C. Neyrinck, I. Szapudi, and A. S. Szalay, ApJ 698,
L90 (2009), 0903.4693.
14
[35] J. Jasche and F. S. Kitaura, ArXiv e-prints (2009),
0911.2496.
[36] J. Jasche, F. S. Kitaura, C. Li, and T. A. Enßlin, ArXiv
e-prints (2009), 0911.2498.
[37] F. Kitaura, J. Jasche, and R. B. Metcalf, MNRAS 403,
589 (2010), 0911.1407.
[38] C. Weig and T. A. Enßlin, ArXiv e-prints (2010),
1003.1311.
[39] T. J. Hebert and R. Leahy, IEEE Transactions on Signal
Processing 40, 2290 (1992).
[40] T. J. Cornwell and K. F. Evans, A&A 143, 77 (1985).
[41] G. Wang, L. Fu, and J. Qi, Physics in Medicine and
Biology 53, 593 (2008).
[42] C. Oh and B. Roy Frieden, Optics Communications 282,
2489 (2009).
[43] D. H. Roberts, J. Lehar, and J. W. Dreher, AJ 93, 968
(1987).
[44] G. B. Rybicki and W. H. Press, ApJ 398, 169 (1992).
[45] J. Li and P. Stoica, IEEE Transactions on Signal Pro-
cessing 44, 1469 (1996).
[46] P. Stoica, H. Li, and J. Li, IEEE Signal Processing Let-
ters 6, 205 (1999).
[47] P. Stoica, E. G. Larsson, and J. Li, AJ 120, 2163 (2000).
[48] P. K. Kitanidis, Water Resources Research 22, 499
(1986).
[49] G. Rydbeck, ApJ 675, 1304 (2008).
[50] U. Seljak, ApJ 503, 492 (1998), astro-ph/9710269.
[51] B. D. Wandelt, D. L. Larson, and A. Lakshmi-
narayanan, Phys. Rev. D 70, 083511 (2004), arXiv:astro-
ph/0310080.
[52] H. K. Eriksen, I. J. O’Dwyer, J. B. Jewell, B. D. Wan-
delt, D. L. Larson, K. M. G´ orski, S. Levin, A. J. Ban-
day, and P. B. Lilje, ApJS 155, 227 (2004), arXiv:astro-
ph/0407028.
[53] J. Jewell, S. Levin, and C. H. Anderson, ApJ 609, 1
(2004), arXiv:astro-ph/0209560.
[54] J. Jasche, F. S. Kitaura, B. D. Wandelt, and T. A. Enßlin,
MNRAS 406, 60 (2010), 0911.2493.