2202
guA
21
]CN.oib-q[
3v66620.1112:viXra
Emergence of sensory attenuation based upon the
free-energy principle
HayatoIdei1∗, Wataru Ohata2, YuichiYamashita1, TetsuyaOgata3 and JunTani2∗
1DepartmentofInformationMedicine,NationalCenterofNeurologyandPsychiatry,Tokyo,Japan
2CognitiveNeuroroboticsResearchUnit,OkinawaInstituteofScienceandTechnology,Okinawa,Japan
3DepartmentofIntermediaArtandScience,WasedaUniversity,Tokyo,Japan
∗Correspondenceto:jun.tani@oist.jporidei@ncnp.go.jp
August15, 2022
ThismanuscripthasbeenacceptedforpublicationinScientificReports.
Abstract
The brain attenuates its responses to self-produced exteroceptions (e.g., we
cannot tickleourselves). Isthisphenomenon, known assensory attenuation, en-
abledinnately, oracquiredthroughlearning? Here,oursimulationstudyusinga
multimodalhierarchicalrecurrentneuralnetworkmodel,basedonvariationalfree-
energyminimization,showsthatamechanismforsensoryattenuationcandevelop
throughlearningoftwodistincttypesofsensorimotorexperience, involvingself-
producedorexternallyproducedexteroceptions. Foreachsensorimotorcontext,a
particularfree-energystateemergedthroughinteractionbetweentop-downpredic-
tionwithprecisionandbottom-upsensorypredictionerrorfromeachsensoryarea.
The executive area in the network served as an information hub. Consequently,
shiftsbetweenthetwosensorimotorcontextstriggeredtransitionsfromonefree-
energystatetoanother inthenetworkviaexecutivecontrol, whichcausedshifts
betweenattenuatingandamplifyingprediction-error-inducedresponsesinthesen-
soryareas.Thisstudysituatesemergenceofsensoryattenuation(orself-otherdis-
tinction)indevelopmentofdistinctfree-energystatesinthedynamichierarchical
neuralsystem.
Introduction
Thebraincouplesitsstructurewiththeoutsideworldviasensorimotorexperiences(1).
Aposterioridevelopmentofneuralprocessinggraduallyformsourperceptualphenom-
ena, with a priorinature determinedby genes. It yields well-defined self-experience
and helps to confidently situate self in relation to others. In general, we face two
primarytypes of sensorimotorexperience, self-movementsand sensory eventsin the
1
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
outside world, which may or may not be correlated. Recognition of the difference
isthoughtto underlieself-otherdistinctions, senseofself, andsubsequentattribution
ofagency(2,3), butthe differencecannotbe knowna priori. The brainmay acquire
thecapacitytomodulateneuralresponsesviasensorimotorlearning,dependingonthe
context.
Aphenomenoncalledsensoryattenuation,isrecognizedasoneofthebasesofthe
sense of self, especially the sense of agency (2,4). Sensory attenuation refers to an
experienceinwhichanexteroceptionproducedbyaself-movementislesssalientthan
oneproducedexternally(5).Aperfectexampleisthedifficultyofticklingourselves.In
addition,theabilitytoignorevisualchangesduringeyeorheadmovementsisthought
tohelpmaintainstabilityofthevisualscene. Attheneurallevel,sensoryattenuation
isobservedasreducedbrainresponses,suchasbloodoxygenlevel-dependent(BOLD)
responses, especially in sensory areas (6–8). A line of research shows that sensory
attenuationisassociatedwithpredictedsensorimotorcorrelationandisdiminishedby
temporalorspatialmismatchbetweenamovementandtheresultantexteroception(e.g.,
atemporaldelayoratrajectoryrotation)(9–11).Therearesomesuggestionsofunder-
lying neural functions, such as an efference copy of the motor command (9,12) and
neuromodulation(e.g., dopaminergictransmission) (13). However, despite intensive
workfordecades,a fundamentalquestionremainsunclear: Issensoryattenuationen-
abledinnatelyorisitacquiredthroughlearning?
Here, we provide a computational explanation, suggesting that a mechanism for
sensoryattenuationcanbeself-organizedthroughlearning.Wefocusonthefollowing
factors. If a self-movement and a sensory event in the outside world are not corre-
lated,theresultantproprioceptionandexteroceptionoccurseparately. Thebrainmay
efficiently use individual sensory areas to represent these individual sensations. On
the other hand, if proprioception and exteroception are correlated, they can be best
explained as being generated by the same latent cause, i.e., self, rather than being
generated by two independent latent states, i.e., self and other. In that case, if the
braincan developa predictivemodelaboutthe spatio-temporalsensorimotorcorrela-
tion, it is reasonableto representthe sensorimotorcouplingusinga multimodalasso-
ciationarea,andneuralresponsesinindividualsensoryareascanbeattenuated. That
is, throughsensorimotorlearning, the brain may developthe capacity to predictively
modulatesensory-informationflowandprocessinginsidehierarchicalneuralnetworks,
dependingon the context, i.e., self generatedversusother generated. To test this hy-
pothesis, we conducteda robotic simulation experimentusing a variationalrecurrent
neuralnetwork(RNN)modelbasedonBayesianbraintheoryorfree-energyminimiza-
tion(1,14–17).
Results
Computational model
Ourdailysensorimotorbehaviorgenerallyhassomesortofregularity,e.g.,aset-point
of body posture and dynamic movement patterns, and randomness, e.g., free move-
ment with fluctuations (18). Therefore, we considered how a robot agent controlled
2
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
by an RNN developssensory attenuationthrough such spontaneoussensorimotorex-
periences(Fig. 1). Arobotrepeatedlygeneratedarandombehavior(imprecisemove-
ment)andthenreturnedtotheset-posture(precisemovement)withinfiveseconds(20
timestepsfortherobot),wheretherobot’smotionandamovementofanexternalred
object were correlated (self-produced context) or uncorrelated (externally produced
context). Thereceivedsensationswere3-dimensionalproprioceptionforjointangles
and2-dimensionalexteroceptionforthepositionoftheobject.Previousbrainimaging
studiesshowthatsensoryattenuationinvolveshierarchicalinteractionsamongmultiple
brainregions,includingsensoryareas,anassociationarea(parietalarea),andahigher
cognitivearea(prefrontalorsupplementarymotorarea)(19–21). TheRNNinsidethe
robothasacorrespondinghierarchicalstructure,referredtoassensory(exteroceptive
andproprioceptive),association,andexecutiveareas(Fig. 1a). ThehierarchicalRNN
is a generative model that predicts sensations as well as inferring hidden causes of
sensationsviavariationalfree-energyminimization(16,17). Eachareahasindividual
latentvariablesz representingeachlevelofbeliefaboutthehiddencauseofsensation
t
intheformofGaussiandistributions. Eachlatentvariablehaspriorzp andposterior
t
zq distributionsthatcorrespondtoestimatedhiddencausesbeforeandafterobserving
t
sensations,respectively. Thepriorsandposteriorsoflatentvariablesaretime-varying
in sensoryand associationareas, while the executivearea maintainsa constantposte-
riorstateduringsequentialpredictiongenerationwithinatimewindow(Supplementary
Fig. S1-2). Weassumedthattheexecutiveareacontrols(andswitches)sequentialpat-
ternsoflower-levelnetworkbehavior,liketheprefrontalorsupplementarymotorarea
in a biological brain (22,23). At each time step, the RNN generates predictions xˆ
t
aboutthenextexteroceptiveandproprioceptivesensationsx fromlatentvariablesvia
t
recurrentunitsd ,representingdynamicsoftheenvironment. Variationalfree-energy
t
F can be calculated as the sum of predictionerror and Kullback-Leiblerdivergence
t
betweentheposteriorandpriorateachlthnetworklevel.
3
1
F = (x −xˆ )2+ W(l)D [q(z(l)|e )||p(z(l)|d(l) )]. (1)
t 2 t t KL t t:T t t−1
l=1
Predictionerror X Influenceofpriorbeliefs
This describe|s inte{gzration}of sensory i | nformation, i.e. { , z prediction error } e , and prior
t
knowledge,i.e.,priorbeliefzp,uponaposteriorzq update,althoughsynapticweights
t t
are also updated during the learning process. The decomposition of variational free-
energyintheequation(1)canalsobethoughtofintermsofaccuracy(predictionerror)
andcomplexity(thedivergencebetweenposteriorandpriorbeliefs).Aposteriorisonly
adjustedtominimizepredictionerrorsunderthe influenceofthe prior. A weakprior
(with low precision) leads to a sensitive posterior update in response to a prediction
error,whileastrongprior(withhighprecision)leadstodiscountingoftheprediction
error. In other words, prediction errors have a greater effect on posterior beliefs in
thepresenceofaweak, i.e., impreciseprior. Thestrengthofthepriorineachareais
parameterizedbythestandarddeviationofaGaussianpriorthatisdynamicallymodu-
latedtominimizethepathintegraloffree-energy.Inotherwords,weequipthemodel
with the capacity to infer differencesin prior precision in a way that lends the influ-
ence ofprior beliefsa contextsensitivity. From the available physiologicalevidence,
3
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
it may engagelocal GABAergicmechanismsor neuromodulators,e.g., acetylcholine
ordopamine(14,24,25). Inaddition,weintroduceahyper-parametercalledthemeta-
priorW(l),whichcontrolsthemeta-levelbalancebetweenthepredictionerrorandthe
divergencebetweentheposteriorandthepriorateachnetworklevel. Previousstudies
haveshownthatalargemeta-priorcausesanintrinsicallystrongprior,whereasasmall
meta-priorcausesanintrinsicallyweakprior(16,17).Theinclusionofmeta-priorsmay
seemsuperfluous,giventhattheprecision,i.e.,inversevariance,ofvariousbeliefsare
inferredadaptively.However,meta-priorsofferanopportunitytomodelafailuretoin-
fercontextsensitivechangesinprecision.Thisparticularfailureofsensoryattenuation
may be an important explanation for several neuropsychiatric conditions: see below.
We assumed that the meta-prior represents an innately equippedcharacteristic in the
biologicalbrain. Inthebaselinemodel,wesetthemeta-priortothesamevalueforall
networklevels(W(1) = W(2) = W(3) = 0.005)toavoidbiasintheprediction-error
flow.
Emergence ofsensory attenuation
This experimentcompriseslearning and test phases. In the learning phase, the robot
learnedtoreproducethetwotypesofsensorimotorpatterns(Fig. 1b). Targetsensori-
motorsequenceswerepreparedinadvancefromhumanspontaneousbehaviorsthrough
manualmanipulationsofaphysicalrobot.Weprepared24trainingsetsforeachsetof
self-producedandexternallyproducedcontexts. Weensuredthateachofthe24move-
mentpatternsoftherobotwasthesameforbothcontexts(seeFig. 1band“Learning"
section in the Methods). The RNN updated posteriors and synaptic weights to mini-
mizethepathintegraloffree-energy(SupplementaryFig. S1).
In the test phase, the trained robotwas required to generate actions by itself and
to recognize an environmental context by updating only posteriors to minimize the
free-energy, with fixed synaptic weights (Fig. 2a and Supplementary Fig. S2). Ac-
tion generation of the robot was performed by proportional-integral-derivative(PID)
control.APIDcontrollerreceivesproprioceptivepredictionsastargetjointanglesand
itchangesthejointangles(proprioception)tominimizetheerrorbetweenthecurrent
state and target. In this regard,the PID controllerimplementsactive inferenceunder
the free-energy principle by realizing posterior predictions about movementtrajecto-
ries(15). Fig. 2b-eshowsanexampleof a testtrial(SupplementaryVideoS1). The
testtrialconsistsofaself-producedcontextduringtimesteps0-100andanexternally
producedcontextduringtimesteps100-200.
In the self-produced context, the robot moved the external object by itself, and
the object position matched the robot’s hand position (Fig. 2e). The trained RNN
successfullyreproducedthestochasticpropertyoflearnedsensorimotorsequencesby
modulatingtheassociation-levellatentmeanµ(2),suchthattheestimatedsigmaσ(2)
washighduringrandombehaviorgeneration,butlowwhenreturningtotheset-posture
(Fig. 2c). Here,µandσcorrespondtothemeanandstandarddeviationofaGaussian
posteriororprior. Inotherwords,theyplaytheroleofsufficientstatisticsofapproxi-
mateposteriorbeliefsandpriorbeliefsthatareoptimizedduringlearning.Modulation
ofthelatentmeaninexteroceptiveandproprioceptiveareasµ(1) wassmall,withlow
estimatedsigmaσ(1) (Fig. 2d),suggestingreducedprediction-errorflowintosensory
4
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
areaswith highprecisionin itsprior. These resultsindicatethatthe RNN minimized
predictionerrorsproducedbyself-movementsmainlybyadjustingtheposteriorinthe
associationarea,sincetheposteriorinsensoryareascannotbeeasilyadjustedbecause
ofthestrongprior.
Then,attimestep100,theenvironmentwasshiftedtoexternallyproducedcontexts,
wherethe objectpositionwas givenfromtest data that were notusedin the learning
phase. The object position and hand position became uncorrelated (Fig. 2e). The
environmentalchangecausedastepwisechangeintheexecutive-levellatentstateµ(3)
(Fig. 2b). At the same time, in sensory areas, modulation in the latent mean µ(1)
wasamplifiedandsigmaσ(1) increased,showingperiodicmodulation(Fig. 2d),like
theassociation-levellatentstate. ThisshowsthattheRNNminimizedpredictionerrors
fromexternallyproducedsensationsbyadjustingtheposteriorinsensoryareas,aswell
asintheassociationarea.
Collectively, the hierarchical RNN attenuated neural responses in sensory areas
for the self-producedcontextandamplified them for the externallyproducedcontext
by proactively controlling precision of the prior at each network level in which the
posteriorintheexecutiveareaworkedastheinformationhubforswitchingthelower-
level precision structure and the prediction error flow (Fig. 3). Furthermore, free-
energyconvergedintodifferentstatesfordistinctsensorimotorcontexts(Fig. 3). This
suggeststhata particularfree-energyminimumwasdevelopedforeachsensorimotor
contextandthetransitionofthefree-energystateinthenetwork,inducedbytheabrupt
contextshift,underlaythequalitativechangeinthefree-energyminimization.
For quantitative analysis, we prepared 10 trained networks with different initial
synapticweightsandconducted8testtrialsforeachtrainednetwork.Fig.4ashowsthe
changeinthesensory-levelposteriormeanµ(1),qpertimestepforthetwocontexts.In
thisstudy,itisreferredtoasasensory-levelposteriorresponse.Apairedt-testreported
thattheposteriorresponsewassignificantlysmallerintheself-producedcontextthan
intheexternallyproducedcontext(t(9)=−3.38,p=0.0082).Inaddition,apairedt-
testshowedthatthesensory-levelpriorsigmaσ(1),p intheself-producedcontextwas
significantly lower than that in the externally produced context (t(9) = −3.32,p =
0.0089)(Fig. 4b).
Furthermore,weanalyzedhowattenuationofneuralresponsesinsensoryareasde-
velopedduringthe learningprocess. The RNN firstincreasedsensory-levelposterior
responsestoreconstructtargetsensorimotorsequences(Fig. 4c). Then,sensory-level
posteriorresponsesintheself-producedcontextweregraduallyattenuatedinbothexte-
roceptiveandproprioceptiveareas. Thesensory-levelpriorsigmadiminishedmorein
theself-producedcontextthanintheexternallyproducedcontextthroughthelearning
process(Fig. 4d). Weconfirmedthatposteriorresponsesintheassociationareawere
similarinself-producedandexternallyproducedcontexts(SupplementaryFig. S3a-b),
indicatingreducedtotalneuralresponseintheself-producedcontext. Thissensoryat-
tenuationwasaccompaniedbyrecognitionofbothcontextsintheexecutivearea(Sup-
plementaryFig. S3c-d). Theseresultsdemonstrateemergenceofsensoryattenuation
throughalearningprocessviafree-energyminimization.Additionalanalysesindicated
that developmentof sensory attenuation was diminished by removingneuronsin the
associationorexecutivearea(SupplementaryFig. S4),suggestingtheimportanceofa
higher-levelrepresentationofsensorimotorcorrelation.
5
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
Inaddition,weinvestigatedeffectsbymodulationofthemeta-priorateachnetwork
level(SupplementaryFig. S5-7). Inparticular,asmallmeta-priorinsensoryareasor
alargemeta-priorintheassociationarealedtoadeficitinattenuationofthesensory-
levelposteriorresponse,aswellasthesensory-levelpriorsigma,intheself-produced
context.Thissuggeststhatinnatelydecreasedprediction-errorflowintotheassociation
areacomparedtosensoryareasdisrupteddevelopmentofsensoryattenuation.
Discussion
Thecurrentmodelstudy,usingahierarchicallyorganizedvariationalRNN,illustrated
thepossibilitythatasensoryattenuationmechanismcandevelopthroughlearning. In
the learningtask, the robotalternately repeatedimprecise movement(randombehav-
ior) and precise movement (returning to the set-posture) in both self-produced and
externally produced contexts. The RNN developed a hierarchical generative model
abouthowproprioceptiveandexteroceptiveinputsaregeneratedfromthelatentcauses
andalsorepresentedthestochasticpropertybydynamicallymodulatingprecisionsof
hierarchicallatentvariables,whichareindividuallyallocatedtoeachareaoftheRNN.
We found that for dealing with two distinct types of sensorimotor contexts, namely
self-produced and externally produced contexts, the network developed two distinct
free-energy states (minima) through learning, wherein each free-energy state corre-
spondstoeachsensorimotorcontext(Fig. 3and4c-d). Inthedevelopednetwork,the
top-down and bottom-up pathways functioned as follows. In the top-down pathway,
theposteriorintheexecutiveareapredictedthepriorprecisionoftheassociationarea
andsensoryareas. Inthebottom-uppathway,predictionerrordeterminedtheposterior
of sensory areas, the association area, and the executive area under the constraint of
thepriorprecisionexpectedateachareabythetop-downpathway. Here,weseethat
thetop-downpathwayandthebottom-uppathwaycreatedaclosedcircuitinwhichthe
posteriorintheexecutiveareaservedastheinformationhub.Intheclosedcircuit,apar-
ticularfree-energystatecorrespondedtothecharacteristictop-downprecisioncontrol
andbottom-upprediction-errorflowinsidethehierarchicalRNN.
Intheself-producedcontext,sensoryattenuationwasachievedbyminimizingthe
free-energy to the corresponding free-energy state. In this context, the posterior in
theexecutiveareadevelopedtoaparticularvalue,andinducedhighpriorprecisionin
sensory areas and low prior precision in the association area, which resulted in less
adaptationinitsposteriorinsensoryareasandmoreadaptationintheassociationarea
using the bottom-up error signal. Less adaptation in the posterior in sensory areas
correspondstosensoryattenuation.Thedetailmechanismisasbelow.Thehierarchical
RNNrecognizedthatproprioceptiveandexteroceptiveinputsweregeneratedfromthe
samelatentcause,i.e.,self,andthelatentcause,includingitsstochasticproperty,was
representedinthehigher-levelareas(associationareaandexecutivearea).Inthiscase,
sensory areas were not needed to represent the latent cause at all. Indeed, Fig. 2
showsthattheRNNcanreconstructsensoryinputsbasedonthedynamicmodulation
oflatentvariablesonlyintheassociationarea.Then,highprecision(nearly0sigma)of
latentvariablesinthesensoryareasisthoughttobedevelopedtominimizevariational
free-energy by reducing prediction error due to random sampling and reducing KL
6
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
divergencebetweentheposteriorandtheprior.
Inanexternallyproducedcontext,theprocesswastheotherwayaround,wherein
theposteriorinsensoryareasadaptedgreatlybecauseofthelowprecisioninitsprior
regulated by the executive area. This corresponds to sensory amplification. In this
context,proprioceptiveandexteroceptiveinputsweregeneratedfromindividualcauses,
i.e.,self,andother.ThehierarchicalRNNneededtorepresentnotonlythehigher-level
context, i.e., externally produced context, using the association and executive areas,
butalso unresolvedlower-levelinformationduetoindividualcausesusingindividual
sensoryareas.Thatiswhy,precisionsoflatentvariablesinthesensoryareasaswellas
theassociationareaweremodulateddynamically.
Furthermore,the errorinducedby the changeof the sensorimotorcontextflowed
bottom-uptotheexecutiveareaanddeterminedtheposteriorintheexecutiveareawith
its prior set to a neutral value. It triggered the transition from one free-energy state
toanother,i.e., fromsensoryattenuationtosensoryamplificationandverse-versa. In
short,precisionstructuresforsensoryattenuationinself-producedcontextsandsensory
amplificationin externallyproducedcontextswere self-organizedin one hierarchical
RNNandwereswitchedviaexecutivecontrol.ThissuggeststhatthehierarchicalRNN
developedatypeoffunctionalityofswitchingbetweenquasi-deterministicandhighly
stochastic dynamics in each local area, in which sensory attenuation was character-
izedbyquasi-deterministicprocessing(nearly0sigma)inthesensoryareasandhighly
stochasticprocessinginthe associationarea, while sensoryamplificationwas charac-
terized by highly stochastic processing in both the sensory areas and the association
area.Thissortofdevelopmentandtransitionsofdistinctfree-energystatesprovidesin-
sightsintohowperceptualphenomenaemergefromdynamicbrain-body-environment
interactioninthefaceofuncertainty.
Sensoryattenuationobservedinourmodelisanemergentpropertybasedonvari-
ational free-energyminimization, rather than a consequenceguaranteed by the equa-
tionsusedintheproposedmodel. Indeed,asmallmeta-priorinsensoryareasledtoa
deficitindevelopmentofsensoryattenuation,inwhichpredictionerrorandfree-energy
for training data were smaller than those of the baseline model (see Supplementary
Fig. S5 and S8). This shows that sensory attenuationwas notnecessarily developed
even if proprioceptiveand exteroceptivesensory inputs are correlated and the model
precisely reconstructs the sensory inputs based on variational free-energy minimiza-
tion. Instead, developmentof sensory attenuation depends on a generative model of
theworldself-organizedbythehierarchicalRNN. Inparticular,thefollowingfactors
suggestthatdevelopmentofsensoryattenuationrequiredasortofabstract-levelrecog-
nitionthatproprioceptiveandexteroceptiveinputsaregeneratedfromthesamelatent
cause, i.e., sensorimotor coupling, which was achieved by a balanced interaction be-
tweenthetop-downpredictionwithprecisionandthebottom-uppredictionerror.First,
reducednumbersoflatentvariablesintheassociationareaorexecutiveareadisrupted
developmentofsensoryattenuation(SupplementaryFigureS4). Second,alargemeta-
priorintheassociationareaaswellasasmallmeta-priorinthesensoryareas,i.e.,re-
ducedprediction-errorflowintotheassociationarea,ledtoadeficitindevelopmentof
sensoryattenuation(SupplementaryFig. S5-6). Theseshowtheimportanceofhigher-
levelstructurelearningfordevelopingsensoryattenuation.Furthermore,thedifference
inthedimensionsofproprioception(3-dimensionaljointangle)andexteroception(2-
7
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
dimensionalobjectposition)requiredanabstract-levelrepresentationforrecognizing
the sensorimotor coupling. Such an abstraction of sensorimotor informationmay be
a reasonableconsequencegiventheefficientcoding,butit isnotnecessarilyobvious
giventheself-organizationbythehierarchicalRNNitselfthroughlearning. Thiskind
ofemergentphenomenonself-organizedthroughlearninghasnotthoroughlybeenin-
vestigatedinpreviousstudiesbasedonthefree-energyprinciple. Thus,wethinkthat
thiscomplexpropertyemphasizesthesignificanceofourneuroroboticapproach.
There have been prior model proposals to account for sensory attenuation. One
proposal(13) postulates that sensory attenuation is caused by reducing the precision
of the prediction error bottom-upto the sensory area duringmovementby following
the free-energyprinciple. This model, however,does not explainthe involvementof
thehigherexecutivearea,asevidencedby(19,20). Weconfirmedthatremovalofthe
executiveareadiminishedthedevelopmentofsensoryattenuation(SupplementaryFig.
S4b),emphasizingthecontributionofthefrontalfunction. Thisisconsistentwithbio-
logicalstudiessuggestingthatsignalsfromthefrontalarea,suchasthesupplementary
motorarea,predictablycontroltherelativeprecisionorintensityofsensations. Their
disruptioncausesdiminishedsensoryattenuation(19,26). Furthermore,the previous
modelintermixestwophenomena:sensoryattenuationandsensorygating.Sensoryat-
tenuationcomparestheintensityofself-producedsensationswithexternallyproduced
sensations, or the distinction between the self and others. On the other hand, sen-
sorygatingreferstoasuppressionprocessinwhichexteroceptionsfeelweakerduring
movement than at rest (27). In our learning experiment, movements of the robot in
self-producedcontextsand externallyproducedcontextswerethe same, avoidingthe
confusionwithsensorygating. Inthissense,ourmodelconsideredonlysensoryatten-
uation(self-otherdistinction).
Accordingtoanotherleadinghypothesis,thepathwayofanefferencecopyofthe
motorcommandisthoughttooriginatefromtop-downsignals(19,26).Incontrast,our
modelsuggeststhatsignalsfromtheexecutive(frontal)areamayrepresentpredictive
signalsforcontrollingprediction-errorflowinsidethehierarchicalnetwork,ratherthan
a copyofthe motorcommand. We showedthatthefunctionality,in whichtop-down
signalshierarchicallycontrolbottom-upprediction-errorflowinsidethenetwork(that
modulatestop-downsignals),canbeself-organizedthroughlearning.
Theperspectivethatthesensoryattenuationmechanismisaconsequenceoflearn-
ing instead of an innate function, may be indirectly supportedby a recentstudy sug-
gestingthatatargetstimulusofsensoryattenuationcanbeadaptivelychangedthrough
rapidlearning(28). Inaddition,ourresult(Fig. 4c)explainsincreasedsensoryatten-
uation with age in adults (20). Furthermore, our modelsuggests that proprioception,
aswellasexteroception,canbeattenuatedwhenaself-movementproducesexterocep-
tion. Infact,aneuroimagingstudyobserveslesscerebellaractivitywhenamovement
producesatactilestimulus,thanwhenitdoesnot(6).
Therehavebeensomerecentadvancesinourunderstandingofmovement-related
suppressionprocesses, includingthe findingof a differencebetweensensoryattenua-
tion and sensorygating. One of the discussionsis abouta differencebetween “phys-
iological sensory attenuation" and “perceptual sensory attenuation". A recent study
suggeststhat“physiologicalsensoryattenuation"and“perceptualsensoryattenuation"
have different neurophysiological correlates (29). In a recent study, “physiological
8
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
sensoryattenuation"wasmeasuredasadecreaseintheamplitudeofprimaryandsec-
ondarycomponentsofthesomatosensoryevokedpotential(SEP)bycomparingitdur-
ing movementand at rest; thus, it may be related with sensory gating. On the other
hand, “perceptual sensory attenuation" was measured in a force-matching paradigm
and was suggestedto be related with a decrease in prediction-error-relatedneuralac-
tivity, such as gamma-oscillatory activity. Importantly, “perceptual sensory attenua-
tion"negativelycorrelatedwithscoresofdelusionalideation(ameasureofschizotypy)
whilenosignificantcorrelationswerefoundbetweenattenuationofSEPcomponents
and scores of delusional ideation. In our experiment, we focus on an attenuation of
prediction-error-relatedresponse of the posterior; thus, our model may explain “per-
ceptualsensoryattenuation"anditsneurocomputationalmechanism. Inaddition,our
model of sensory attenuation suggests that a decrease in prediction-error-related ac-
tivityand“perceptualsensoryattenuation"mayrepresentself-otherdistinction,which
hasimplicationsformechanismsunderlyingdelusionalideation.
In addition, a recentstudy demonstratedan enhancement,notsuppression, of the
intensity of predicted action outcomes by investigating effects of action on intensity
oftactilestimulusreportedbyparticipantsintheforce-judgmentparadigm(30). First,
theauthorsreplicatedtypicalfindingsthatself-producedtactilestimuliareratedasless
intense than externally produced stimuli when an active contact with a button gener-
atesa tactile stimulus. However,thiseffectreversedwhenthere was noactive finger
contactwitha button. Inadditionalexperiments,theycontrolledthepredictabilityof
tactileactionoutcomesandfoundthatexpectedeventswereperceivedmore,notless,
intenselythanunexpectedevents.Notethatthisadditionalexperimentcomparedcases
with more predictableand less predictableoutcomesproducedby own action. Since
this comparison did not compare stimuli produced by own action and other’s action,
this additionalexperimentalresult does not conflict with our claim. These results in
the previousstudy (30)may show that when sensoryattenuation doesnotappear, an
action can enhance expected touch. This enhancement effect is consistent with the
basic Bayesianidea thata predictivebrainfocusesonprecise (predictable)stimulito
ignoreuninformative(uncertain)noise.Inthissense,thepreviousstudysuggeststhata
theoryofsensoryattenuationrequiresanadditionalthoughtbeyondthebasicBayesian
oractive inferenceframework. Here, ourmodelprovidesa particularmechanismfor
sensory attenuation beyond the basic Bayesian theory. Specifically, our results sug-
gestthatsensoryattenuationrequiresanabstract-levelrecognitionthatproprioceptive
andexteroceptiveinputsaregeneratedfromthesame latentcause, i.e., self, whichis
developedthroughcontext-sensitiveoptimizationofhierarchicallatentvariables. This
emphasizestheimportanceofdevelopmentalaspectsofhierarchicalpredictiveprocess-
ing.
Alterationsindevelopmentofsensoryattenuationwereinducedbymodulationof
the meta-prior,a hyper-parameterdeterminingthe intrinsicstrengthof thepriorcom-
paredto the predictionerrorat each networklevel. In the basic Bayesian model, the
practitioner must manually set the prior, including its precision, to compute the pos-
terior. However, in our model, the prior in each network area is epigenetically self-
organizedthroughlearning,withtheinfluenceofthehighermeta-levelparameter,i.e.,
themeta-prior. Weassumedthatthemeta-priorisaninnatecharacteristicdetermining
developmentalfeaturesofthepriorandprediction-errorflowinthebiologicalbrain,al-
9
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
thoughitsneuralsubstrateremainsunspecified. Inourexperiment,alargemeta-prior
intheassociationarea,i.e., anintrinsicallystrongpriorintheassociationarea, ledto
reduced sensory attenuation, i.e., a weak prior in sensory areas, while a small meta-
priorintheassociationarea,i.e.,anintrinsicallyweakpriorintheassociationarea,did
notimpairdevelopmentofsensoryattenuation(SupplementaryFig. S6). Theseresults
may provideinsights into relationshipsbetween strongprior hypothesesand reduced
sensory attenuation in schizophrenia(9,13,31,32) and between weak prior hypothe-
ses and normal sensory attenuation in autism spectrum disorder (33–37). It will be
importanttoseekcorrespondingneurologicalevidenceoftheproposedcomputational
mechanismfordevelopmentofsensoryattenuationandtoexploreitsrelevancetopsy-
chiatricdisordersinfuturestudies.
In summary, we have shown that sensory attenuation is an emergent property of
free-energyminimizationinactiveinference. Sensoryattenuationisaubiquitousphe-
nomenon in psychology and psychophysics. Furthermore, it is receiving increasing
attentionincomputationalpsychiatry,inwhichafailureofsensoryattenuationmayex-
plainseveralneuropsychiatricconditions,rangingfromParkinson’sdiseasetoschizophre-
nia and autism (13,34). Technically, we have simulated behavior in terms of active
inference, which can be thoughtof as a generalizationof controland planning as in-
ference. Crucially, we trained our robots to perform active inference by optimizing
connectionweights(w)andadaptivevariables(a)in hierarchicallyorganizedRNNs,
whichplayedtheroleofahierarchicalgenerativemodel. Theimplicitlearningofcon-
nectionstrengthscan be thoughtof as “amortization"or “learningto infer". In other
words,byminimizing(thepathortimeintegralof)variationalfree-energy,robotswere
able to learn the mapping from sensory inputs to posterior beliefs about the causes
of their sensory inputs. These posterior beliefs recognize the context in which they
are operatingand generate proprioceptivepredictionsthat are realized by a PID con-
troller. Becausecertainbeliefsconcernprecisionofinferredsensorimotortrajectories,
thisenablesa contextsensitiveoptimizationofcertainprecisionsthatunderwritesen-
sory attenuation. Put simply, when robotsrecognizedthat the proprioceptiveand ex-
teroceptiveinputsarebestexplainedbyexternallygeneratedmovement,theyreduced
theprecisionaffordedrepresentationsofselfgeneratedsensations. Conversely,when
proprioceptiveandexteroceptivesensoryinputswerebestexplainedbyself-generated
sensations, precision of these explanations increased, thereby reducing the influence
of sensory prediction errors. This is the basis of sensory attenuation. Note that this
context-sensitive optimization of precision, i.e., encoding of uncertainty, is an emer-
gentpropertyofminimizingthe pathintegraloffree-energy. Inotherwords,sensory
attenuation emerges from a generative model that provides the best explanation for
proprioceptiveandexteroceptiveinputs,whenaccumulatingfree-energyormodelevi-
dence(a.k.a.,marginallikelihood)overtime.
10
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
Methods
Neural network model
Tosimulatedevelopmentofsensoryattenuation,weutilizedapredictive-coding-inspired
variationalrecurrentneuralnetwork(PV-RNN),whichrepresentsagenerativeprocess
ofsensationfromahiddencauseintheenvironment,basedonthefree-energyprinciple
(FEP) (16,17). It consists of sensory (exteroceptiveand proprioceptive),association,
andexecutiveareasinwhichtherearedeterministicneuronsandlatent(stochastic)neu-
rons.LatentneuronsrepresentbeliefaboutthecauseofsensationasGaussiandistribu-
tions(forsimplicity).Eachlatentstatehaspriorandposteriorprobabilitydistributions
that correspondto estimated hidden causes before and after observingsensations, re-
spectively. Based on the latent states, the PV-RNN generates predictions about next
sensationsinatop-downway. Here,deterministicneuronstransformlatentstatesinto
sensorypredictionsviasynapticconnectionsthatrepresentrelationshipsbetweensen-
sationsandtheircauses. ThePV-RNNusesamultipletimescaleRNN(MTRNN)(38)
as the transformationfunction. An RNN representstemporalprocessing of the brain
inthatneuralactivityisdeterminedbythepasthistoryofneuralstates. Owingtotheir
capacityto learn to reproducecomplexdynamicbehaviors, RNNs have beenused in
computationalmodelinganddevelopmentalneuroroboticstudiestounderstandcortical
processingandcognitivefunctions,includingpsychiatricsymptoms(38–43). Inaddi-
tion,MTRNNshaveamultipletimescalepropertyinneuralactivation,whichenables
themto representatemporalhierarchyintheenvironment,asobservedinthebiolog-
ical brain (44). By using a PV-RNN, we can learn complex sensorimotor behaviors
thathavebothtemporalregularityandstochasticity(16,17). Toperformspontaneous
behaviorslikedailyhumanbehaviors,aneuralnetwork-controllingrobotwasrequired
toprocessshort-termrandommovementsandalong-termperiodicpattern,asintheex-
perimentinwhichthemultipletimescalepropertyisthoughttofacilitatesensorimotor
learning. Inthefollowingsections,wedescribethemathematicaldetailsoftop-down
predictiongenerationandbottom-upparameterupdatesbythePV-RNN (Supplemen-
taryFig. S1-2).
Predictiongeneration
Predictiongenerationisperformedin atop-downwaythroughthenetworkhierarchy.
Theinternalstateh(s) andoutputd(s) oftheithdeterministicneuronofthesthtarget
t,i t,i
11
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
sequenceattimestept(t≥1)iscalculatedas
1 1
w d(s) + w z(s)+ w z(s)+b + 1− h(s) (i∈I ),
τ ij t−1,j ij t,j ij t,j i τ t−1,i Ad
 ! !
h( t, s i ) =

τ
1
j
j X
∈
∈
X I
I
A
Ed
d
w ij d( t− s) 1,j +
j
j
X ∈
X ∈
I
I
E
A
z
z
w ij z t ( , s j ) +
j
j
X ∈
X ∈
I
I
A
C
d
z
w ij d( t, s j ) +b i
!
+ 1− τ
1
!
h( t− s) 1,i (i∈I Ed ),

τ
1
j
X
∈IPd
w
ij
d(
t−
s)
1,j
+
j
X
∈IPz
w
ij
z
t
(
,
s
j
)+
j
X
∈IAd
w
ij
d(
t,
s
j
)+b
i
!
+ 1−
τ
1
!
h(
t−
s)
1,i
(i∈
(
I
2
P
)
d
).
d(s) =tanh h(s) (i∈I ,I ,I ). (3)
t,i t,i Ed Pd Ad
(cid:16) (cid:17)
Here, I , I , and I are index sets of deterministic neurons in the exteroceptive
Ed Pd Ad
area, proprioceptive area, and association area, respectively. I , I , I , and I
Ez Pz Az Cz
are index sets of latent neuronsin the exteroceptive,proprioceptive,association, and
executiveareas,respectively.w istheweightofthesynapticconnectionfromthejth
ij
neurontotheithneuron;z(s)istheoutputofjthlatent(posterior)neuronattimestept;
t,j
τ isthetimeconstantoftheneuron;andb isthebiasoftheithneuron.Adeterministic
i
neuronwithasmalltimeconstantτ hasatendencytochangeitsactivityrapidly,while
thatwithalargetimeconstanthasatendencytochangeitsactivityslowly. Wesetthe
initialinternalstatesofthedeterministicneuronsh(s)(i∈I ,I ,I )to0(d(s) is
0,i Ed Pd Ad 0,i
also0).
The latent variable z in each area is assumed to follow a multivariate Gaussian
distributionwithadiagonalcovariancematrix,meaningz(s) andz(s) areindependent
t,i t,j
(i,j ∈ I ,I ,I ∧i 6= j). Here, the mean µ(s),p and sigma (standarddeviation)
Ez Pz Az t,i
σ(s),pofthepriordistributionp(z(s) )intheexteroceptive,proprioceptive,andassocia-
t,i t,i
tionareasarecalculatedfromthepreviousdeterministicstate(priorexperience)ofthe
samearea.
p(z(s))=p(z(s)|d(s) )=N(z(s);µ(s),p,σ(s),p ). (4)
t,i t,i t−1,j t,i t,i t,i
µ(s),p =tanh w d(s) , (5)
t,i j ij t−1,j
σ(s),p =exp (cid:16) P w d(s) (cid:17) . (6)
t,i j ij t−1,j
(cid:16) (cid:17)
P
Here,(i∈I ∧j ∈I )∨(i∈I ∧j ∈I )∨(i∈I ∧j ∈I ). Notebyopti-
Ez Ed Pz Pd Az Ad
mizingtheweightsw,withrespecttothepathintegraloffree-energy,weareeffectively
optimizingpriorbeliefsaboutsensorimotorcontingenciesandcontexts.Thiscanbere-
garded as a form of structure learning through experience. The executivearea has a
12
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
priordistributionas N(0,1) onlyat the initial step (t = 1) becauseit has a constant
posteriorstateduringsequentialpredictiongeneration,withtheobjectiveofassigning
aspecificexecutive-levelposteriortoeachtargetsequence.
Theposteriordistributionineachareaiscalculatedas,
q(z(s) |e(s) )=q(z(s)|e(s) )=N(z(s);µ(s),q,σ(s),q ) (i∈I ),
t−1,i t−1:T(s) 1,i 1:T(s) 1,i 1,i 1,i Cz
q(z(s)|e(s) )=
t,i t:T(s) 
N(z(s);µ(s),q,σ(s),q ) (i∈I ,I ,I ).
t,i t,i t,i Ez Pz Az
 (7)
µ(s),q =tanh a(s),µ , (8)
t,i t,i
σ(s),q =exp (cid:16) a(s),σ (cid:17) , (9)
t,i t,i
z(s) =µ(s),q + (cid:16) σ(s),q(cid:17) ×ǫ. (10)
t,i t,i t,i
Here, T(s) representsthe lengthofthesthtargetsequence. aisthe adaptiveinternal
stateofneuronsrepresentingposteriordistributionsanditisupdatedateachtimestep
and for each target sequence during the learning process (or each time step through
online inference). Note that equations (8) and (9) mean that the adaptive variables
implicitly encode both posterior expectationsand precision, such that optimizing the
adaptive variables with respect to variational free-energy implicitly optimizes poste-
riorexpectationsandtheposteriorconfidenceorprecisionaffordedthoseexpectations.
Adaptivevariablesa aredeterminedbypredictionerrorsignalse propagatedbya
t t:T
back-propagation-through-time(BPTT)algorithm,meaningthattheposteriorofthela-
tentstatecanbeconsideredaprediction-error-relatedneuralstate. Adaptivevariables
a are initialized by the correspondinginitial internal states of the neurons represent-
ingpriordistributionsbeforethelearningorinferenceprocess. Basedontheposterior
calculation,thelatentstatez(s)isobtainedbysamplingǫfromN(0,1).
t,i
Finally,predictionsaboutexteroceptiveandproprioceptivesensationsareindividu-
allygeneratedfromexteroceptiveandproprioceptiveareas,respectively.
tanh w d(s) (i∈I ),
  ij t,j Eo
xˆ(
t,
s
i
) =


j
X
∈IEd

tanh w d(s) (i∈I ).
 

j
X
∈IPd
ij t,j

Po
(11)
Here,I andI areindexsetsofoutputneuronsforexteroceptiveandproprioceptive
Eo Po
predictions,respectively.
13
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
Parameterupdatesviafree-energyminimization
TheconceptofFEP(14)derivesfromthefundamentalfactthatself-organizingbiolog-
icalagentsmustmaintainalimitedrepertoireofsensorystatestoremainalive,e.g.,a
humanstaysontheground,notinthesea. Basedoninformationtheory,thisnotioncan
be formulatedassuppressionof the surprise(or the negativelog-evidence)forsensa-
tionsxovertime. InthePV-RNN,thesurpriseoveralltimestepsandtargetsequences
canbewrittenas:
−logp(x(s) )= −log p(x(s) ,z(s) )dz(s) (12)
1:T(s) 1:T(s) 1:T(s) 1:T(s)
s
X
∈IS s
X
∈IS (cid:20) Z (cid:21)
T(s)
= −log
p(x(s) |d(s) )p(z(s) |d(s)
)
dz(s)
. (13)
 t t t t−1 1:T(s)
s X ∈IS Z t Y =1h i
 
Here,I denotestheindexsetoftargetsequences.However,surprisecannotbedirectly
S
evaluatedbytheagentbecauseitneedstoknowallhiddenstateszoftheenvironment
that cause sensations, as described on the right side of the equation(12). Here, FEP
introducesatractablequantity,free-energy,thatboundsthesurprise,andminimization
ofthesurpriseisreplacedbyminimizationofthefree-energy.Theboundofthesurprise
inthePV-RNNcanbederivedbyutilizingJensen’sinequalityforaconcavefunction
f: f(E[x]) ≥ E[f(x)]. For clarity, summation over targetsequencesis temporarily
omittedinthefollowingequations.Then,equation(13)canbedeformedasfollowsby
introducingadummydistributionforz ,q(z ).
1 1
−logp(x )
1:T
T
1
=−log dz 1 q(z 1 ) dz 2:T q(z ) [p(x t |d t )p(z t |d t−1 )] (14)
Zz1 Zz2:T 1 t=1
Y
T
1
≤− dz 1 q(z 1 )log dz 2:T q(z ) [p(x t |d t )p(z t |d t−1 )]. (15)
Zz1 Zz2:T 1 t=1
Y
In equation (15), we use Jensen’s inequality for a logarithmic function. The same
procedureisdonefort=2:T.
T
−logp(x )≤− dz q(z )··· dz q(z )log
p(x t |d t )p(z t |d t−1 )
(16)
1:T 1 1 T T q(z )
Zz1 ZzT t=1(cid:20) t (cid:21)
Y
T
q(z )
=− dz q(z )··· dz q(z ) logp(x |d )−log t . (17)
Zz1 1 1 ZzT T T X t=1 A t t p(z t |d t−1 ) 
 
 B 
| {z } 
| {z }
14
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
Thefirstterminexpression(17)istheexpectednegativelog-likelihoodunderq given
thatd dependsonz .
t 1:t
T
A = − dz q(z )··· dz q(z ) logp(x |d ) (18)
1 1 T T t t
Zz1 ZzT t=1
X
T
= − E [logp(x |d )]. (19)
q(z1:t) t t
t=1
X
In addition, the second term can be deformed into forms of Kullback-Leibler diver-
gence(KLD)betweenq(z t )andp(z t |d t−1 )while beingcarefultoensurethatd 0 is
independentfromz .
1:T
T
q(z )
t
B = dz q(z )··· dz q(z ) log (20)
Zz1 1 1 ZzT T T t=1 p(z t |d t−1 )
X
q(z )
= dz q(z )log 1
1 1 p(z |d )
Zz1 1 0
T
q(z )
t
+ dz q(z )··· dz q(z ) log (21)
Zz1 1 1 ZzT T T t=2 p(z t |d t−1 )
X
T
= D KL [q(z 1 )||p(z 1 |d 0 )]+ E q(z 1:t−1) [D KL [q(z t )||p(z t |d t−1 )]]. (22)
t=2
X
A dummydistributionq(z ) canbe replacedbythe posteriordistributiondetermined
t
by the back-propagatedprediction error q(z |e ). Thus, using equations (19) and
t t:T
(22),theboundofthesurprisecanbewrittenas,
T
−logp(x )≤− E [logp(x |d )]+D [q(z |e )||p(z |d )]+
1:T q(z1:t|et:T) t t KL 1 1:T 1 0
t=1
X
T
E q(z 1:t−1|et−1:T) [D KL [q(z t |e t:T )||p(z t |d t−1 )]].
t=2
X
(23)
Intheexperiment,weresolvecalculationoftheexpectationsofnegativelog-likelihood
andKLDunderqbyconsideringsinglesamplingtoreducecomputationalcosts.
T
−logp(x 1:T ) ≤ (−logp(x t |d t )+D KL [q(z t |e t:T )||p(z t |d t−1 )]).(24)
t=1
X
Eventually,by introducingthe meta-priorandconsideringthe summationoverdiffer-
enttargetsequences,thefree-energyF (theboundofthe surprise)in thePV-RNN is
15
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
formulatedas:
T(s)
F = F(s) (25)
t
s
X
∈ISX t=1
F(s)
=
−logp(x(s)|d(s))+
t t t
Accuracy
3
| {z }
W(l) D [q(z(l),(s)|e(s))||p(z(l),(s)|d(l),(s))] . (26)
KL t t:T t t−1
X l=1 (cid:16) (cid:17)
Complexity
Here, W(l) denotes the meta-|prior at lth network le{vzel. The first term in}expression
(26)(negativeaccuracyterm)isthenegativelog-likelihood.Forsimplicity,weassume
that each sensory state follows a Gaussian distribution with unit variance. Then, the
first term becomesjust the predictionerror betweenthe
realx(s)
and
predictedxˆ(s)
t t
sensations(plusaconstantterm,omittedhere).
1 2
−Accuracy= x(s) −xˆ (s) . (27)
2 t,i t,i
i∈I XEo∨IPo (cid:16) (cid:17)
Thisassumptionsetstheprecisionofthepredictionerrortoaconstantvalueandmakes
iteasytoconsidertherelativeprecisionofpriorbeliefscomparedtopredictionerrors.
Intheexperiment,wedividedtheaccuracytermbythedimensionofeachexteroceptive
andproprioceptivesensation.
Ontheotherhand,thesecondterm(complexityterm)istheKLDbetweenthepos-
teriorandpriordistributionsofthelatentvariables.Notethatvariablesoftheposterior
areupdatedthroughboththeaccuracyandcomplexityterms,butthoseofthepriorare
updatedonlythroughthecomplexityterm. Therefore,thecomplexitytermrepresents
onlytheinfluenceofpriorbeliefs,whicharecontrolledbythemeta-priorW.Underthe
assumptionthatthepriorandposteriordistributionsfollowamultivariateGaussiandis-
tributionwithadiagonalcovariancematrix,asdescribedabove,theKLDiscomputed
analyticallyas(16,17),
σ(s),p (µ(s),p −µ(s),q )2+(σ(s),q )2 1
Complexity= log t,i + t,i t,i t,i − . (28)
σ(s),q 2(σ(s),p )2 2 !
i t,i t,i
X
Here, i ∈ I ∨I (if l = 1), i ∈ I (if l = 2), and i ∈ I (if l = 3). In the
Ez Pz Az Cz
experiment, we divided the complexityterm by the dimension of latent variables for
eacharea. Notethatifl = 3(executivearea),thecomplexitytermexitsonlyatt = 1,
althoughwewritetheequationinageneralwayforsimplicity.
In the learning phase (SupplementaryFig. S1), synaptic weightsw and adaptive
variablesa are updatedto minimizethe free-energyoveralltime stepsand targetse-
quencesas,
T(s)
F = F(s). (29)
t
s
X
∈ISX t=1
16
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
Inthetestphaseafterlearning(SupplementaryFig. S2),onlyadaptivevariablesaare
updated,whilesynapticweightsarefixed. Inthisphase,thefree-energywithinashort
timewindowH issummedas
t
F = F t′. (30)
t′ =Xt−H+1
Usingthesummedfree-energy,adaptivevariablesa t−H+1:t withinthetimewindow
ofallareasareupdated,whereasthetimewindowslidesasthenetworktimesteptis
incremented.
In both learningand test phases, we used the Adam optimizer(45)forparameter
updates,wherethepartialderivativeofthefree-energywithrespecttoeachparameter
iscalculatedbytheBPTTalgorithm.
Experimental environment
Weseta3-axisroboticarminasimulatedsquarespace[−1,1]×[−1,1].Thelengthsof
therobot’slinksare0.1,0.3,and0.5.Eachjointanglewaslimitedtorangefrom0toπ
[rad]andnormalizedtorangefrom−0.8to0.8tomatchtherangeoftheneuralnetwork
output. In addition, the PV-RNN receivesthe 2-dimensionalposition of a red object
asanexteroceptivesensation.Duringtaskexecution,therobotreceives5-dimensional
sensationsevery250ms.
Learning
ThePV-RNNlearnedtoreproducetargetsensorimotorsequencespreparedinadvance.
First, we recorded24sequencesofjointangleswhile theexperimentermanuallyma-
nipulatedtheleftarmofaphysicalrobot(Rakuda,developedbyRobotis).Foreachse-
quence,theexperimenterperformed10repetitionsgeneratingarandommovementand
returningtothesetposturewithinfiveseconds(20timesteps). Therefore,thelength
ofeachsequenceis200timesteps. Weusedjointanglesfromleftshoulderpitch,left
shoulderroll,andtheleftelbowofRakudaas3-dimensionalproprioceptiondataofthe
simulated robot arm. Next, we prepared exteroception data for a self-produced con-
textbysettingtheobjectpositionasthehandpositionofthesimulatedarmrobotthat
wascalculatedbyforwardkinematicsusingtherecordedjointangledata. Inthisfash-
ion,weobtained24targetsequencesforself-producedcontextsinwhichexteroceptive
andproprioceptivesensationsarecorrelated.Finally,wepreparedtargetsequencesfor
externally produced contexts by shuffling the combination of exteroceptive and pro-
prioceptivesequences. By doingthis, we obtained24 targetsequencesforexternally
produced contexts in which exteroceptive and proprioceptive sensations are not cor-
related. This shufflingprocedureensuresthattotalnumbersof changesin sensations
arethesameforself-producedandexternallyproducedcontextsinthelearningphase.
The PV-RNN learned to reproduce the prepared 48 training datasets via free-energy
minimization.
17
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
Onlineinference
Wepreparedanadditional8exteroceptivesequencesastestdatathatwereusedinex-
ternallyproducedcontextsinthetestphase.Beforeatesttrial,initialstatesofadaptive
variablesa inallareasweresettothemedianvaluesobtainedfor24trainingdatasets
1
oftheself-producedcontextdevelopedthroughlearning.Basedontheinitialposterior
states correspondingto self-producedcontexts, the robotfirst movedthe objectby it-
selfduringtimesteps0-100. Therobotcontrolleditsjointanglesviaactiveinference
usingthePIDcontroller,forwhichproprioceptivepredictionswereusedastargetjoint
angles. Then,duringtimesteps100-200,theenvironmentalcontextwasshiftedtothe
externallyproducedcontext,althoughtherobotkeptgeneratingspontaneousbehaviors
by itself via active inference. In the externally producedcontext, the objectposition
wassetfromtestdata. Thegoaloftherobotwastoflexiblyrecognizetheenvironmen-
tal change by updating adaptive variables via free-energy minimization. The online
inferenceprocesswasperformedbasedonaninteractionbetweentop-downprediction
generation and bottom-up posterior updates. In the top-down prediction generation
process,thePV-RNNgeneratedsensorypredictionsxˆ t−H+1:t correspondingtotime
steps from t−H +1 to t, based on the posterior of latent states z t−H+1:t . In the
bottom-up modulation process, the free-energyat each time step in time window H
wascalculatedusingpredictionerrorsforexteroceptionandproprioception,forwhich
target sensations were the real object position and joint angles from t−H +1 to t.
Adaptivevariablesa t−H+1:t inthetimewindowwereupdatedtominimizethefree-
energysummedovertimesteps,andsensorypredictionswithinthetimewindowwere
re-generatedusingtheupdatedposteriorstates. Byrepeatingtop-downpredictiongen-
erationandbottom-upposteriorupdatesforacertainduration,thePV-RNNgenerated
theprioroflatentstatesfortimestept+1. Thegeneratedpriorwasusedtoinitialize
theposteriorfortime stept+1, andpredictionsaboutsensationsfortimestep t+1
weregeneratedfromtheposterior.Usingproprioceptivepredictionsfortimestept+1
asthetargetjointangles,therobotmovedthejointanglesusingthePIDcontroller.At
the same time, the robot received exteroceptive sensations at time step t+1. After
that, the robot’stime step wasincrementedand the onlineinferenceprocesswas per-
formedforthenewlyreceivedsensations.Thisinferenceprocess,inwhichrecognition
andpredictioninthepastarereconstructedfromcurrentsensations, correspondstoa
“postdiction"process.
Parametersettings
Thedimensionoflatentvariableszintheexteroceptiveandproprioceptiveareaswas1,
andthatintheassociationareawas3. Therefore,thetotaldimensionoflatentneurons
in sensoryandassociationareaswas the same as the sensorydimension. The dimen-
sion of latent variables in executive area was 1. A preliminary experiment showed
that a smaller number of latent neurons in the association area led to a lower level
of sensory attenuation, supportingthe idea that sensory attenuation is a consequence
of representing sensorimotor correlation in the association area (Supplementary Fig.
S4a). Inaddition,weconfirmedthatnoexecutive-levellatentstateresultedinahighly
decreasedlevelofsensory attenuation,suggestingan importantrole of the executive-
18
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
level latent state (Supplementary Fig. S4b). The numbers of deterministic neurons
in the exteroceptive, proprioceptive, and association areas were all 15. In a prelimi-
naryexperiment,we evaluateddevelopmentofsensory attenuationfor settingsof 10,
15, or 20 deterministic neuronsand confirmedthat the setting of 15 neuronsshowed
the largest sensory attenuation (Supplementary Fig. S9a). We set the time constant
τ to half the number of deterministic neurons (8 neurons) to 2 and that of the other
neurons(7neurons)to4, asthe simplestmultipletimescalesetting. We setthesame
multipletimescalepropertyforboththesensoryandassociationareas. Thisisbecause
wethoughtthatthePV-RNNcontrolledwhichlevelsofthenetworkhierarchyshould
beusedtorepresentsensations,dependingonthecontext. Actually,theexperimental
results show that the PV-RNN mainly used the association area in the self-produced
contextandboththe sensoryandassociationareasin anexternallyproducedcontext,
in whichthetimescale propertyincludedinsensationswasthe same forthetwo con-
texts. In a preliminary experiment, we confirmed that the multiple timescale setting
led to greatersensoryattenuationcomparedto the single timescale setting τ = 2 for
alldeterministicneurons(SupplementaryFig. S9b). Synapticweightswereinitialized
withrandomvaluesusingthedefaultmethodimplementedbyPytorch.Biasesofdeter-
ministicneuronswereinitializedwithandfixedtorandomvaluesfollowingaGaussian
distributionN(0,10), forwhichthevarianceof biasesisclose tothe firingthreshold
variabilityfoundin biologicalneurons(46), aswellas the optimalvalueina spiking
neuralnetworkmodel(47)andarecurrentneuralnetworkmodel(41). Wetrained10
networks with different initial synaptic weights for each hyper-parametersetting for
quantitativeevaluations. Inthelearningphase,parametersincludingsynapticweights
wandadaptivevariablesawereupdated200,000timeswiththeAdamoptimizer.We
usedthe sameparametersettingofAdam asin theoriginalpaper: α = 0.001(learn-
ing rate), β = 0.9, and β = 0.999. In the test phase, adaptive variables a were
1 2
updated50timesateachtimestepforatimewindowoflengthH =10withα=0.09.
We chose the optimal parameter setting in the test phase from the combinations of
α={0.001,0.005,0.01,0.03,0.05,0.07,0.09,0.1,0.2,0.3,0.4,0.5}×H={10,15}
by evaluating levels of prediction error in the baseline meta-prior setting (W(1) =
W(2) =W(3) =0.005).
Statisticalanalysis
We used paired t-tests for statistical analyses of network behaviors, such as the pos-
terior response and the level of the prior sigma. All statistical tests were two-tailed,
and the significance levelwas set at p < 0.05. The currentstudy conductedan orig-
inal unprecedented computational simulation experiment. Thus, it is difficult to es-
timate the effect size, and no statistical methods were used to pre-determine sample
size. Consideringthehighreproducibilityofcomputationalsimulation,wesetthemin-
imumsamplesizethatseemedstatisticallytestable(10samples). Indeed,evenfor10
samples, paired t-tests reported clear differences between self-produced context and
externally producedcontext (e.g., t(9) = −3.38;p = 0.0082 for posterior response
andt(9)=−3.32;p=0.0089forpriorsigma). Therefore,weconcludedthatalarger
sample size would not have significantly influenced our main result. Data analyses
wereconductedusingRsoftware(version3.3.2).
19
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
References
1. Clark, A. Whatever next? predictive brains, situated agents, and the fu-
ture of cognitive science. Behavioral and Brain Sciences 36, 181–204, DOI:
10.1017/S0140525X12000477(2013).
2. Braun, N. et al. The senses of agency and ownership: A review. Frontiers in
Psychology9,535,DOI:10.3389/fpsyg.2018.00535(2018).
3. Legaspi,R.&Toyoizumi,T. Abayesianpsychophysicsmodelofsenseofagency.
NatureCommunications10,4250,DOI:10.1038/s41467-019-12170-0(2019).
4. Dewey, J. A. & Knoblich, G. Do implicit and explicit measures of the
sense of agency measure the same thing? PLOS ONE 9, e110118, DOI:
10.1371/journal.pone.0110118(2014).
5. Weiskrantz, L., Elliot, J. & Darlington, C. Preliminary observations on tickling
oneself. Nature230,598–599,DOI:10.1038/230598a0(1971).
6. Blakemore, S.-J., Wolpert, D. M. & Frith, C. D. Central cancellation of self-
producedticklesensation. NatureNeuroscience1, 635–640,DOI:10.1038/2870
(1998).
7. Bäß,P.,Jacobsen,T.&Schröger,E. Suppressionoftheauditoryn1event-related
potentialcomponentwithunpredictableself-initiatedtones: Evidenceforinternal
forwardmodelswithdynamicstimulation. InternationalJournalofPsychophysi-
ology70,137–143,DOI:10.1016/j.ijpsycho.2008.06.005(2008).
8. Arikan, B. E. et al. Perceiving your hand moving: Bold suppression in sensory
corticesandtheroleofthecerebelluminthedetectionoffeedbackdelays.Journal
ofVision19(14),DOI:10.1167/19.14.4(2019).
9. Blakemore, S.-J., Wolpert, D. & Frith, C. Why can’tyou tickle yourself? Neu-
roReport11,R11–R16(2000).
10. Bays,P.M.,Wolpert,D.M.&Flanagan,J.R. Perceptionoftheconsequencesof
self-actionistemporallytunedandeventdriven. CurrentBiology15,1125–1128,
DOI:10.1016/j.cub.2005.05.023(2005).
11. Kilteni, K., Andersson, B. J., Houborg,C. & Ehrsson, H. H. Motor imagery in-
volves predicting the sensory consequences of the imagined movement. Nature
Communications9,1–9,DOI:10.1038/s41467-018-03989-0(2018).
12. Wolpert,D.M.,Ghahramani,Z.&Jordan,M.I. Aninternalmodelforsensorimo-
torintegration. Science269,1880–1882,DOI:10.1126/science.7569931(1995).
13. Brown, H., Adams, R. A., Parees, I., Edwards, M. & Friston, K. Active infer-
ence,sensoryattenuationandillusions. CognitiveProcessing14,411–427,DOI:
10.1007/s10339-013-0571-3(2013).
20
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
14. Friston, K. The free-energyprinciple: a unified brain theory? Nature Reviews
Neuroscience11,127–138,DOI:10.1038/nrn2787(2010).
15. Adams, R. A., Shipp, S. & Friston, K. J. Predictions not commands: active in-
ference in the motor system. Brain Structure and Function 218, 611–643, DOI:
10.1007/s00429-012-0475-5(2013).
16. Ahmadi, A. & Tani, J. A novelpredictive-coding-inspiredvariationalrnnmodel
foronlinepredictionandrecognition. NeuralComputation31,2025–2074,DOI:
10.1162/neco_a_01228(2019).
17. Ohata, W. & Tani, J. Investigation of the sense of agency in social cognition,
based on frameworks of predictive coding and active inference: A simulation
studyonmultimodalimitativeinteraction. FrontiersinNeurorobotics14:61,DOI:
10.3389/fnbot.2020.00061(2020).
18. Inoue, K., Nakajima, K. & Kuniyoshi, Y. Designing spontaneous behav-
ioral switching via chaotic itinerancy. Science Advances 6, eabb3989, DOI:
10.1126/sciadv.abb3989(2020).
19. Haggard, P. & Whitford, B. Supplementary motor area provides an efferent
signal for sensory suppression. Cognitive Brain Research 19, 52–58, DOI:
10.1016/j.cogbrainres.2003.10.018(2004).
20. Wolpe, N. et al. Ageing increases reliance on sensorimotor prediction through
structuralandfunctionaldifferencesinfrontostriatalcircuits. NatureCommunica-
tions7,13034,DOI:10.1038/ncomms13034(2016).
21. Boehme,R.,Hauser,S.,Gerling,G.J.,Heilig,M.&Olausson,H. Distinctionof
self-producedtouchandsocialtouchatcorticalandspinalcordlevels.Proceedings
oftheNationalAcademyofSciences116,2290,DOI:10.1073/pnas.1816278116
(2019).
22. Eagleman,D.M.Thewhereandwhenofintention.Science303,1144–1146,DOI:
10.1126/science.1095331(2004).
23. Leek,E.C.&Johnston,S.J. Functionalspecializationinthesupplementarymo-
torcomplex. NatureReviewsNeuroscience10,78–78,DOI:10.1038/nrn2478-c1
(2009).
24. Yu, A. J. & Dayan, P. Uncertainty, neuromodulation,and attention. Neuron 46,
681–692,DOI:10.1016/j.neuron.2005.04.026(2005).
25. Corlett, P., Taylor, J., Wang, X.-J., Fletcher, P. & Krystal, J. Toward a
neurobiology of delusions. Progress in Neurobiology 92, 345–369, DOI:
10.1016/j.pneurobio.2010.06.007(2010).
26. Pynn, L. K. & DeSouza, J. F. The function of efference copy signals: Im-
plications for symptoms of schizophrenia. Vision Research 76, 124–133, DOI:
10.1016/j.visres.2012.10.019(2013).
21
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
27. Kilteni, K. & Ehrsson, H. H. Predictive attenuation of touch and tac-
tile gating are distinct perceptual phenomena. iScience 25, 104077, DOI:
https://doi.org/10.1016/j.isci.2022.104077(2022).
28. Kilteni, K., Houborg, C. & Ehrsson, H. H. Rapid learning and unlearning
of predicted sensory delays in self-generated touch. eLife 8, e42888, DOI:
10.7554/eLife.42888(2019).
29. Palmer, C. E., Davare, M. & Kilner, J. M. Physiological and perceptual sen-
sory attenuation have different underlying neurophysiological correlates. Jour-
nalofNeuroscience36,10803–10812,DOI:10.1523/JNEUROSCI.1694-16.2016
(2016). https://www.jneurosci.org/content/36/42/10803.full.pdf.
30. Thomas, E. R., Yon, D., de Lange, F. P. & Press, C. Action enhancespredicted
touch. Psychological Science 33, 48–59, DOI: 10.1177/09567976211017505
(2022). PMID:34878943,https://doi.org/10.1177/09567976211017505.
31. Powers, A. R., Mathys, C. & Corlett, P. R. Pavlovianconditioning–inducedhal-
lucinationsresultfromoverweightingofperceptualpriors. Science357,596–600,
DOI:10.1126/science.aan3458(2017).
32. Corlett,P.R.etal. Hallucinationsandstrongpriors. TrendsinCognitiveSciences
23,114–127,DOI:10.1016/j.tics.2018.12.001(2019).
33. Blakemore,S.-J.etal. Tactilesensitivityinaspergersyndrome. BrainandCogni-
tion61,5–13,DOI:10.1016/j.bandc.2005.12.013(2006).
34. Lawson,R.P.,Rees,G.&Friston,K.J. Anaberrantprecisionaccountofautism.
Front.Hum.Neurosci.8,302,DOI:10.3389/fnhum.2014.00302(2014).
35. Haker, H., Schneebeli, M. & Stephan, K. E. Can bayesian theories of autism
spectrumdisorderhelpimproveclinicalpractice? FrontiersinPsychiatry7(2016).
36. Palmer, C. J., Lawson, R. P. & Hohwy, J. Bayesian approaches to autism: To-
wardsvolatility,action,andbehavior. PsychologicalBulletin143,521–542,DOI:
10.1037/bul0000097(2017).
37. Finnemann,J.J.,Plaisted-Grant,K.,Moore,J.,Teufel,C.&Fletcher,P.C. Low-
level, prediction-based sensory and motor processes are unimpaired in autism.
Neuropsychologia 156, 107835, DOI: 10.1016/j.neuropsychologia.2021.107835
(2021).
38. Yamashita,Y.&Tani,J.Emergenceoffunctionalhierarchyinamultipletimescale
neural network model: A humanoid robot experiment. PLoS Comput. Biol. 4,
e1000220(2008).
39. Yamashita,Y.&Tani,J. Spontaneouspredictionerrorgenerationinschizophrenia.
PLoSONE7,e37843–e37843,DOI:10.1371/journal.pone.0037843(2012).
22
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
40. Idei, H. et al. A neurorobotics simulation of autistic behavior induced
by unusual sensory precision. Computational Psychiatry 2, 164–182, DOI:
10.1162/CPSY_a_00019(2018).
41. Idei,H., Murata,S., Yamashita,Y.&Ogata,T. Homogeneousintrinsicneuronal
excitabilityinducesoverfittingto sensorynoise: A robotmodelof neurodevelop-
mentaldisorder. FrontiersinPsychiatry11:762,DOI:10.3389/fpsyt.2020.00762
(2020).
42. Idei, H., Murata, S., Yamashita, Y. & Ogata, T. Paradoxical sensory reactivity
inducedbyfunctionaldisconnectioninarobotmodelofneurodevelopmentaldis-
order.NeuralNetworks138,150–163,DOI:10.1016/j.neunet.2021.01.033(2021).
43. Finkelstein, A. et al. Attractor dynamics gate cortical information
flow during decision-making. Nature Neuroscience 24, 843–850, DOI:
10.1038/s41593-021-00840-6(2021).
44. Newell, K., Liu,Y. &Mayer-Kress,G. Timescalesinmotorlearninganddevel-
opment. Psychologicalreview1081,57–82(2001).
45. Kingma, D. P. & Ba, J. Adam: A method for stochastic optimization (2017).
1412.6980.
46. Azouz,R.&Gray,C.M. Dynamicspikethresholdrevealsamechanismforsynap-
ticcoincidencedetectionincorticalneuronsinvivo. ProceedingsoftheNational
AcademyofSciences97,8110–8115,DOI:10.1073/pnas.130200797(2000).
47. Mejias, J. F. & Longtin, A. Optimal heterogeneity for coding in spik-
ing neural networks. Physical Review Letters 108, 228102–1–5, DOI:
10.1103/PhysRevLett.108.228102(2012).
Acknowledgements
ThisworkwaspartiallysupportedbyanunrestrictedgiftfromGoogleandsupported
by a JSPS Grant-in-Aid (Nos. JP19J20281, JP22J01708), JST Moonshot R&D (No.
JPMJMS2031),andJSTCRESTgrants(Nos. JPMJCR16E2,JPMJCR21P4).
Author contributions statement
Conceptualization:HI,JT
Methodology:HI,YY,JT
Investigation:HI,WO
Visualization:HI,YY,JT
Fundingacquisition:HI,YY,TO,JT
Projectadministration:JT
Supervision:JT
Writing–originaldraft:HI
23
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
Writing–review&editing:HI,WO,YY,TO,JT
Additional information
DataAvailability:
Alldataisavailableinthemanuscriptandthesupplementaryinformation.
CodeAvailability:
ComputercodefortheneuralnetworkmodelwaswrittenusingPytorch(alibraryfor
deeplearning)andisavailableonline(https://github.com/h-idei/pvrnn_sa.git).
Competing interests:
Authorsdeclarethattheyhavenocompetinginterests.
24
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
a
Level 3 !!"#
Executive area Generative process
Error propagation
Level 2 "!$# !!$#
Association area
Posterior belief
!!
Level 1 !!%# "!%# "!%# !!%# KLD
Sensory areas
!"
Prior belief
Prediction #$ #$ (PE L -r a e t l e a n te t d v a re ri s a p b o le nse)
PE Acquisition of proprioception data
Observation # +, ! - " . # $ $ ’ %& #/ ’ ( $ & ( 0 # )# )& )& * *1 2 +3 %& & ( )* % # ) / & 4 ’ * $ 5 ( 6$ #)& 01 * # by manual robot manipulation
b
Self-produced
context
Externally produced
context
Time
Figure 1: Training setting. (a) Hierarchical recurrent network updating of synaptic
weightsandposteriorbeliefsinallareasviaminimizationoffree-energydeterminedby
thepredictionerror(PE)andKullback-Leiblerdivergence(KLD)betweentheposterior
andtheprior.(b)Spontaneoussensorimotorpatternslearnedbytherecurrentnetwork.
25
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
a
!"#"$%&
’(")*+,#"%)-.+/-$
Level 2
Association
Level 1 Level 1
Exteroception Proprioception
PID
controller
Object position Joint angles
Action
Self-produced
Externally (steps 0-100)
produced
(steps 100-200)
Test data
noitareneg
noitcA
&
noitciderP
Inference
of latent
states
b
"!%#
!!%#
#!%#
c Solid: "!$# Posterior !!$# D
Pr
o
io
tt
r
ed:
#!$#
d "!"# Extero Proprio
!!"# Solid:
Posterior
#!"# Dotted: Prior
e Extero
$%
Proprio
! Object
Hand
Time step
Figure2:Testsettingandanexampleoftheresult.(a)Onlineinferenceoflatentstates
andactiongenerationbyaPIDcontroller,withsynapticweightsfixed. (b)Executive-
levelposteriordistribution. (c)Association-levelposteriorandpriordistributions. (d)
Sensory-levelposterior and priordistributionsin exteroceptiveand proprioceptivear-
eas. (e)Predictionerror(PE)andrealsensationsforexteroceptionandproprioception.
Forclarity,proprioceptionisrepresentedasthe2-dimensionalhandposition,although
theactualproprioceptioncomprises3-dimensionaljointangles.
26
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
Sensory attenuation in Sensory amplification in
Context shift
self-produced context externally produced context
Neutral Neutral
KLD KLD KLD
!&"# !&"$ !&"# !&"$ !&"# !&"$
Top-down Top-down Top-down
control control control
Low precision Low precision
KLD KLD KLD
!%"# !%"$ !%"# !%"$ !%"# !%"$
Prior < PE Prior < PE
"’%( "’%( "’%(
High precision Low precision
KLD KLD KLD
!!"# !!"$ !!"# !!"$ !!"# !!"$
Prior > PE Prior < PE
"’!( "’!( "’!(
Bottom-up Bottom-up Bottom-up
PE signal PE signal PE signal
ygrene
eerF
Time step
Figure 3: The self-organized mechanism for the transition between sensory attenua-
tion in self-produced contexts and sensory amplification in externally produced con-
texts. Foreachsensorimotorcontext,aparticularfree-energyminimuminthenetwork
was developed through learning, which was characterized by the corresponding top-
down precision control and bottom-up prediction-error (PE) flow. Consequently, in
self-producedcontexts,therecurrentnetworkmainlyadjustedonlytheposteriorinthe
associationareaz(2),q tominimizepredictionerrorsbyincreasingprecisionofpriors
insensoryareasz(1),p anddecreasingprecisionofpriorintheassociationareaz(2),p.
Ontheotherhand,inexternallyproducedcontexts,itadjustedposteriorsinbothsen-
soryandassociationareas(z(1),q andz(2),q)bydecreasingprecisionofpriorsinboth
sensory and association areas. The shift of the sensorimotorcontexttriggeredmodu-
lation of the posterior in the executivearea z(3),q as well as the transition from one
free-energystatetoanotherinthenetwork(bottomtimeseries). Thisinducedaquali-
tativechangeinthenetworkbehaviorandashiftbetweenattenuatingandamplifying
prediction-error-inducedresponsesinsensoryareas. Theblacklineinthetimeseries
of the free-energy describes the 20-step moving average (values within the first 19
stepsarecalculatedasaveragesfromtheinitialtothecurrentstep). Theredlineisthe
averageoverthe first 100 steps, i.e., self-producedcontext, or the last 100 steps, i.e.,
externallyproducedcontext. Values are averagesover80 test trials performedby 10
differentnetworks.
27
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
Context
Learning epoch (!5000)
#"!
!fo
esnopseR
$"!
"
fo
leveL
a b
!!
0.8 34<
0.7 34;
0.6 34:
0.5 349
0.4 348
0.3 347
0.2 346
0.1 345
0.0 343
Self-produced Externally produced !"#$%&’()*+") ,-."’/0##12&’()*+")
Context
c d
Learning epoch (!5000)
#"!
!fo
esnopseR
1.0 2
0.5 1
0.0 0
0 10 20 30 40
$"!
"
fo
leveL
!!
Self-produced context
Externally produced context
Solid: Extero, Dotted: Proprio
0 10 20 30 40
Figure 4: Sensory-levelneural response in the test phase and its developmentin the
learning phase. (a) Box-and-whiskers plots showing the difference in sensory-level
posteriorresponsebetweenself-producedandexternallyproducedcontexts. (b)Box-
and-whiskersplotsshowingthedifferenceinthesensory-levelpriorsigmabetweenthe
twocontexts. In(a)and(b),eachplotisanaverageof100timesteps,2sensoryareas,
and8testtrialsbyeachof10trainednetworks(centerline,median;cross,mean;box
limits,upperandlowerquartiles;whiskers,1.5xinterquartilerange). **p < 0.01. (c)
Developmentof the posterior response for the two contexts in the exteroceptive and
proprioceptiveareas. (d)Developmentofsensory-levelpriorsigma.In(c)and(d),the
valueisaveragedover200timesteps, 24trainingdatasets, and10differentnetworks
ineachlearningepoch.
28
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
Supplementary Figures:
Level 3: KLD
Executive area $ ! %"& $ ! %"# $ $ %"# $ % %"# !!! Generative process
Error propagation
Level 2: KLD KLD KLD
Association area $$"& $$"# $$"& $$"# $$"& $$"#
! ! $ $ % %
0 # ! $ # $ $ # % $ !!!
Level 1: KLD KLD KLD
$!"& $!"# $!"& $!"# $!"& $!"#
Sensory area ! ! $ $ % %
0 #! #! #! !!!
! $ %
Prediction !" !" !" !!!
! $ %
PE
Observation ! ! ! !!!
! $ %
Time
0 1 2 3
SupplementaryFigure S 1: Temporalprocessing of the recurrentneuralnetwork. In
thelearningphase,therecurrentnetworkupdatestheposteriorsoflatentvariablesinall
areas(z(1),q,z(2),q,andz(3),q)andtime-constantsynapticweightsviaminimization
1:T 1:T 1
offree-energyoverthetimelength(T)oftrainingdata. Initialdeterministicstatesd
0
inallareasaresetto0. Theinitialpriordistributionzp intheexecutiveareaissettoa
1
unitGaussiandistributionN(0,1). Forsimplicity,thedistributedstructureofsensory
areasisomitted. PE:Predictionerror. KLD:Kullback-Leiblerdivergencebetweenthe
posteriorandtheprioroflatentvariable.
29
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
!!"# !!"# !!! !!"#
!$"% !$"# !$"% !$"# !$"% !$"#
!!!
"&$’ "&$’ "&$’
!("% !("# !("% !("# !("% !("#
!!!
"&(’ "&(’ "&(’
#$ #$ !!! #$
# # !!! #
Time
t-H t–H+1 t–H+2 t
SupplementaryFigureS2: Onlineinferenceinthetestphase. Therecurrentnetwork
updates the posterior (z(1),q , z(2),q , and z(3),q ) via minimization of the
t−H+1:t t−H+1:t t−H+1
free-energyoveracertaintimewindow(H).Synapticweightsarefixed.Forsimplicity,
thedistributedstructureofsensoryareasisomitted.
30
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
!!"#
ytilibaborP
a
d
Learning epoch = 0 Learning epoch = 10000 Learning epoch = 50000
Self-produced context
Externally produced context
Learning epoch = 100000 Learning epoch = 200000
#"$!fo
esnopseR
1.0 2
0.5 1
0.0 0
0 10 20 30 40 0 10 20 30 40
fo
ecnereffiD
#"!!ni
stxetnoc
2
Self-produced context
Externally produced context
1
0
0 10 20 30 40
Learning epoch (!5000) Learning epoch (!5000)
%"$"
fo
leveL
b c
Learning epoch (!5000)
Learning epoch = 150000
Supplementary Figure S 3: Development of higher-level latent variables. (a-b) De-
velopmentof a posteriorresponse and a prior sigma in the association area. At each
learning epoch, the value is averaged over 200 time steps, 24 training datasets, and
10 networks. (c) Developmentof the difference between self-producedcontexts and
externally produced contexts in the executive area. In the learning phase, the recur-
rentnetworkdevelopeda posterior state in the executivearea for each of 48 training
datasets(24forself-producedcontextsand24forexternallyproducedcontexts). The
figureshowsthedistancebetweenmedianvaluesofposteriorstatesforself-produced
andexternallyproducedcontexts. Ateachlearningepoch,thevalueisaveragedover
10 networks. (d) An example of developmentof the executive-levelposterior. Each
figure shows the distribution of 24 executive-level posterior states corresponding to
self-producedor externally produced contexts. The figure shows that recognition of
different sensorimotor experiences was gradually developed through a learning pro-
cess. Notethatwedidnotprovideanyexplicitlabelindicatingthedifferencebetween
thetwocontexts.
31
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
b
0.8 !$+
0.7 !$*
0.6 !$)
0.5 !$(
0.4 !$’
0.3 !$&
0.2 !$%
0.1 !$"
0.0 !$!
-0.1 #!$"
1 2 3 ! "
Number of association-level Number of executive-level
latent neurons latent neurons
level
noitaunettA
a
Supplementary Figure S 4: Neural-response attenuation varying with the number of
latent neurons. The attenuation levelwas calculated by subtracting the sensory-level
posteriorresponseinaself-producedcontextfromthatinanexternallyproducedcon-
textwhilereproducingtrainingdata. Valueswerefor10trainednetworkswithdiffer-
ent initial synaptic weights. (a) A larger number of association-level latent neurons
ledtoalargerattenuationlevel,suggestingthatrepresentingsensorimotorcorrelation
requiredenoughassociation-levellatent neurons. (b) When there were no executive-
levellatentneurons,theattenuationlevelwasgreatlyreduced.Thissuggeststheimpor-
tanceofexecutive-levelcontrolforsensoryattenuation. In(a)and(b),thesettingof3
association-leveland1executive-levellatentneuronswasthesamebaselinemodel.
32
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
a
E
#"!!fo
esnopseR
0 10 20 30 40
Learning epoch (!5000)
$"!"
fo
leveL
0 10 20 30 40
Learning epoch (!5000)
0 10 20 30 40
Learning epoch (!5000)
#"!!fo
esnopseR
0 10 20 30 40
Learning epoch (!5000)
c
$"!"
fo
leveL
b
1.0 2
Self-produced context
Externally produced context
Solid: Extero, Dotted: Proprio
Small
0.5 1
! ! " #$##%
0.0 0
d
1.0 2
Large
0.5 1
! ! " #$#&’
0.0 0
SupplementaryFigure S 5: Effectsof shifts in the meta-priorin sensory areas. (a-b)
Developmentof a sensory-levelposterior response and prior sigma through learning
in a small sensory-levelmeta-priorsetting (W(1) = 0.001,W(2) = W(3) = 0.005),
describedasinFig. 4c-d. Asmallsensory-levelmeta-priorledtoreducedattenuation
of the sensory-level posterior response, as well as the sensory-level prior sigma, in
the self-produced context. (c-d) Development of a sensory-level posterior response
andapriorsigmainalargesensory-levelmeta-priorsetting(W(1) = 0.025,W(2) =
W(3) = 0.005). Alargesensory-levelmeta-priorledtohighlyreducedsensory-level
posteriorresponsesinbothself-producedandexternallyproducedcontexts.
33
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
0 10 20 30 40
Learning epoch (!5000)
#"!!fo
esnopseR
#"!!fo
esnopseR
2
Small
1
! ! " #$##%
0
0 10 20 30 40
Learning epoch (!5000)
0 10 20 30 40
Learning epoch (!5000)
$"!"
fo
leveL
$"!"
fo
leveL
a b
1.0
Self-produced context
Externally produced context
Solid: Extero, Dotted: Proprio
0.5
0.0
c d
1.0 2
Large
0.5 1
! ! " #$#&’
0.0 0
0 10 20 30 40
Learning epoch (!5000)
SupplementaryFigureS6:Effectsofshiftsinthemeta-priorintheassociationarea.(a-
b)Developmentofasensory-levelposteriorresponseandpriorsigmathroughlearning
inasmallassociation-levelmeta-priorsetting(W(2) =0.001,W(1) =W(3) =0.005),
describedasinFig. 4c-d.Asmallassociation-levelmeta-priordidnothavealargeim-
pact on development of sensory attenuation. (c-d) Development of a sensory-level
posterior response and a prior sigma in a large association-level meta-prior setting
(W(2) = 0.025,W(1) = W(3) = 0.005). A large association-level meta-prior led
toreducedattenuationofthe sensory-levelposteriorresponse, aswellasthe sensory-
levelpriorsigma,intheself-producedcontext.
34
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
a
#"!!
fo
leveL
Learning epoch (!5000)
$"!"fo
esnopseR
b
1.0
0.5
0.0
0 10 20 30 40 0 10 20 30 40
Learning epoch (!5000)
d
#"!!
fo
leveL
2
1
0
$"!"fo
esnopseR
Self-produced context
Externally produced context
Solid: Extero, Dotted: Proprio
Small
! ! " #$##%
c
1.0 2
Large
0.5 1
! ! " #$#&’
0.0 0
0 10 20 30 40 0 10 20 30 40
Learning epoch (!5000) Learning epoch (!5000)
SupplementaryFigureS7: Effectsofshiftsinthemeta-priorintheexecutivearea. (a-
b)Developmentofasensory-levelposteriorresponseandpriorsigmathroughlearning
inasmallexecutive-levelmeta-priorsetting(W(3) = 0.001,W(1) = W(2) = 0.005),
described as in Fig. 4c-d. (c-d) Development of a sensory-level posterior response
andapriorsigmainalargeexecutive-levelmeta-priorsetting(W(3) =0.025,W(1) =
W(2) =0.005).Neithersmallnorlargeexecutive-levelmeta-priorshadalargeimpact
ondevelopmentofthesensory-levelposteriorresponseorthepriorsigma.
35
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
rorre
noitciderP
a c
!"!#( !"!#(
!"!#’ !"!#’
!"!#& !"!#&
!"!#$ !"!#$
!"!#! !"!#!
!"!!( !"!!(
!"!!’ !"!!’
!"!!& !"!!&
!"!!$ !"!!$
!"!!! !"!!!
!"!!# !"!!$% !"!!% !"!# !"!$% !"!!# !"!!$% !"!!% !"!# !"!$%
! ! ! "
rorre
noitciderP
!"!’
!"!%
!"!&
!"!)
!"!$
!"!#
!"!!
!"!!# !"!!$% !"!!% !"!# !"!$%
ygrene
eerF
b
!"!’
!"!%
!"!&
!"!)
!"!$
!"!#
!"!!
!"!!# !"!!$% !"!!% !"!# !"!$%
ygrene
eerF
d
! ! ! "
Supplementary Figure S 8: Training results. (a-b) Prediction error and free-energy
for training data under each meta-prior setting in sensory areas (W(2) = W(3) =
0.005). A small sensory-levelmeta-priorled to decreases in the predictionerrorand
free-energy, although development of sensory attenuation was disrupted. (c-d) The
predictionerrorandfree-energyfortrainingdataundereachmeta-priorsettinginthe
associationarea(W(1) = W(3) = 0.005). In(a)-(d),thesettingofW(1) = W(2) =
W(3) =0.005wasthesamebaselinemodel.
36
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
Number of deterministic neurons
level
noitaunettA
a b
0.8 ,-5
0.7 ,-4
0.6 ,-3
0.5 ,-2
0.4 ,-1
0.3 ,-0
0.2 ,-/
0.1 ,-.
0.0 ,-,
-0.1 +,-.
10 15 20 !"#$%& ’(%)"*%&
Timescale property
SupplementaryFigure S9: Neural-responseattenuationvariedwith settingsof deter-
ministicneurons.Theattenuationlevelwascalculatedbysubtractingthesensory-level
posterior response in the self-produced context from that in the externally produced
contextwhilereproducingtrainingdata. Valueswerefor10trainednetworkswithdif-
ferentinitialsynapticweights. (a)Arecurrentnetworkwith15deterministicneurons
showedthelargestaverage(andmedian)attenuationlevel. (b)Multipletimescaleset-
tings (τ = 2 for 8 neuronsand τ = 4 for 7 neurons)increased the attenuation level
comparedto the singletimescale setting(τ = 2foralldeterministicneurons). In(a)
and(b),thesettingof15deterministicneuronsandmultipletimescalepropertywasthe
sameasthebaselinemodel.
37
Emergenceofsensoryattenuationbaseduponthefree-energyprinciple
Caption for Supplementary Video:
SupplementaryVideoS1. Robotbehaviorandneuralresponsesinthebaselinemodel.
RelatedtoFig.2b-e.Redandbluecrossesintheleftimageindicatepredictedpositions
oftheexternalobjectandrobothand,respectively.
38