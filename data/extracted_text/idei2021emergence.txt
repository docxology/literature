arXiv:2111.02666v3  [q-bio.NC]  12 Aug 2022
Emergence of sensory attenuation based upon the
free-energy principle
Hayato Idei 1∗, W ataru Ohata 2, Y uichi Y amashita1, T etsuya Ogata 3 and Jun T ani 2∗
1Department of Information Medicine, National Center of Neu rology and Psychiatry, T okyo, Japan
2Cognitive Neurorobotics Research Unit, Okinawa Institute of Science and T echnology, Okinawa, Japan
3Department of Intermedia Art and Science, W aseda Universit y, T okyo, Japan
∗ Correspondence to: jun.tani@oist.jp or idei@ncnp.go.jp
August 15, 2022
This manuscript has been accepted for publication in Scientiﬁc Reports.
Abstract
The brain attenuates its responses to self-produced extero ceptions (e.g., we
cannot tickle ourselves). Is this phenomenon, known as sens ory attenuation, en-
abled innately , or acquired through learning? Here, our sim ulation study using a
multimodal hierarchical recurrent neural network model, b ased on variational free-
energy minimization, shows that a mechanism for sensory att enuation can develop
through learning of two distinct types of sensorimotor expe rience, involving self-
produced or externally produced exteroceptions. For each s ensorimotor context, a
particular free-energy state emerged through interaction between top-down predic-
tion with precision and bottom-up sensory prediction error from each sensory area.
The executive area in the network served as an information hu b. Consequently ,
shifts between the two sensorimotor contexts triggered tra nsitions from one free-
energy state to another in the network via executive control , which caused shifts
between attenuating and amplifying prediction-error-ind uced responses in the sen-
sory areas. This study situates emergence of sensory attenu ation (or self-other dis-
tinction) in development of distinct free-energy states in the dynamic hierarchical
neural system.
Introduction
The brain couples its structure with the outside world via se nsorimotor experiences ( 1).
A posteriori development of neural processing gradually fo rms our perceptual phenom-
ena, with a priori nature determined by genes. It yields well -deﬁned self-experience
and helps to conﬁdently situate self in relation to others. I n general, we face two
primary types of sensorimotor experience, self-movements and sensory events in the
1
Emergence of sensory attenuation based upon the free-energ y principle
outside world, which may or may not be correlated. Recogniti on of the difference
is thought to underlie self-other distinctions, sense of se lf, and subsequent attribution
of agency ( 2, 3 ), but the difference cannot be known a priori. The brain may a cquire
the capacity to modulate neural responses via sensorimotor learning, depending on the
context.
A phenomenon called sensory attenuation, is recognized as o ne of the bases of the
sense of self, especially the sense of agency ( 2, 4 ). Sensory attenuation refers to an
experience in which an exteroception produced by a self-mov ement is less salient than
one produced externally ( 5). A perfect example is the difﬁculty of tickling ourselves. In
addition, the ability to ignore visual changes during eye or head movements is thought
to help maintain stability of the visual scene. At the neural level, sensory attenuation
is observed as reduced brain responses, such as blood oxygen level-dependent (BOLD)
responses, especially in sensory areas ( 6–8 ). A line of research shows that sensory
attenuation is associated with predicted sensorimotor cor relation and is diminished by
temporal or spatial mismatch between a movement and the resu ltant exteroception (e.g.,
a temporal delay or a trajectory rotation) ( 9–11 ). There are some suggestions of under-
lying neural functions, such as an efference copy of the moto r command ( 9, 12 ) and
neuromodulation (e.g., dopaminergic transmission) ( 13). However, despite intensive
work for decades, a fundamental question remains unclear: I s sensory attenuation en-
abled innately or is it acquired through learning?
Here, we provide a computational explanation, suggesting t hat a mechanism for
sensory attenuation can be self-organized through learnin g. W e focus on the following
factors. If a self-movement and a sensory event in the outsid e world are not corre-
lated, the resultant proprioception and exteroception occ ur separately. The brain may
efﬁciently use individual sensory areas to represent these individual sensations. On
the other hand, if proprioception and exteroception are cor related, they can be best
explained as being generated by the same latent cause, i.e., self, rather than being
generated by two independent latent states, i.e., self and o ther. In that case, if the
brain can develop a predictive model about the spatio-tempo ral sensorimotor correla-
tion, it is reasonable to represent the sensorimotor coupli ng using a multimodal asso-
ciation area, and neural responses in individual sensory ar eas can be attenuated. That
is, through sensorimotor learning, the brain may develop th e capacity to predictively
modulate sensory-information ﬂow and processing inside hi erarchical neural networks,
depending on the context, i.e., self generated versus other generated. T o test this hy-
pothesis, we conducted a robotic simulation experiment usi ng a variational recurrent
neural network (RNN) model based on Bayesian brain theory or free-energy minimiza-
tion ( 1, 14–17 ).
Results
Computational model
Our daily sensorimotor behavior generally has some sort of r egularity, e.g., a set-point
of body posture and dynamic movement patterns, and randomne ss, e.g., free move-
ment with ﬂuctuations ( 18). Therefore, we considered how a robot agent controlled
2
Emergence of sensory attenuation based upon the free-energ y principle
by an RNN develops sensory attenuation through such spontan eous sensorimotor ex-
periences (Fig. 1). A robot repeatedly generated a random be havior (imprecise move-
ment) and then returned to the set-posture (precise movemen t) within ﬁve seconds (20
time steps for the robot), where the robot’s motion and a move ment of an external red
object were correlated (self-produced context) or uncorre lated (externally produced
context). The received sensations were 3-dimensional prop rioception for joint angles
and 2-dimensional exteroception for the position of the obj ect. Previous brain imaging
studies show that sensory attenuation involves hierarchic al interactions among multiple
brain regions, including sensory areas, an association are a (parietal area), and a higher
cognitive area (prefrontal or supplementary motor area) ( 19–21 ). The RNN inside the
robot has a corresponding hierarchical structure, referre d to as sensory (exteroceptive
and proprioceptive), association, and executive areas (Fi g. 1a). The hierarchical RNN
is a generative model that predicts sensations as well as inf erring hidden causes of
sensations via variational free-energy minimization ( 16, 17 ). Each area has individual
latent variables zt representing each level of belief about the hidden cause of s ensation
in the form of Gaussian distributions. Each latent variable has prior zp
t and posterior
zq
t distributions that correspond to estimated hidden causes b efore and after observing
sensations, respectively. The priors and posteriors of lat ent variables are time-varying
in sensory and association areas, while the executive area m aintains a constant poste-
rior state during sequential prediction generation within a time window (Supplementary
Fig. S1-2). W e assumed that the executive area controls (and switches) sequential pat-
terns of lower-level network behavior, like the prefrontal or supplementary motor area
in a biological brain ( 22, 23 ). At each time step, the RNN generates predictions ˆxt
about the next exteroceptive and proprioceptive sensation s xt from latent variables via
recurrent units dt, representing dynamics of the environment. V ariational fr ee-energy
Ft can be calculated as the sum of prediction error and Kullback -Leibler divergence
between the posterior and prior at each lth network level.
Ft = 1
2 (xt − ˆxt)2
  
Prediction error
+
3∑
l=1
W (l) DKL [q(z(l)
t |et:T )||p(z(l)
t |d(l)
t− 1)]
  
Inﬂuence of prior beliefs
. (1)
This describes integration of sensory information, i.e., p rediction error et, and prior
knowledge, i.e., prior belief zp
t , upon a posterior zq
t update, although synaptic weights
are also updated during the learning process. The decomposi tion of variational free-
energy in the equation (1) can also be thought of in terms of ac curacy (prediction error)
and complexity (the divergence between posterior and prior beliefs). A posterior is only
adjusted to minimize prediction errors under the inﬂuence o f the prior. A weak prior
(with low precision) leads to a sensitive posterior update i n response to a prediction
error, while a strong prior (with high precision) leads to di scounting of the prediction
error. In other words, prediction errors have a greater effe ct on posterior beliefs in
the presence of a weak, i.e., imprecise prior. The strength o f the prior in each area is
parameterized by the standard deviation of a Gaussian prior that is dynamically modu-
lated to minimize the path integral of free-energy. In other words, we equip the model
with the capacity to infer differences in prior precision in a way that lends the inﬂu-
ence of prior beliefs a context sensitivity. From the availa ble physiological evidence,
3
Emergence of sensory attenuation based upon the free-energ y principle
it may engage local GABAergic mechanisms or neuromodulator s, e.g., acetylcholine
or dopamine ( 14, 24, 25 ). In addition, we introduce a hyper-parameter called the me ta-
prior W (l), which controls the meta-level balance between the predict ion error and the
divergence between the posterior and the prior at each netwo rk level. Previous studies
have shown that a large meta-prior causes an intrinsically s trong prior, whereas a small
meta-prior causes an intrinsically weak prior ( 16,17 ). The inclusion of meta-priors may
seem superﬂuous, given that the precision, i.e., inverse va riance, of various beliefs are
inferred adaptively. However, meta-priors offer an opport unity to model a failure to in-
fer context sensitive changes in precision. This particula r failure of sensory attenuation
may be an important explanation for several neuropsychiatr ic conditions: see below .
W e assumed that the meta-prior represents an innately equip ped characteristic in the
biological brain. In the baseline model, we set the meta-pri or to the same value for all
network levels ( W (1) = W (2) = W (3) = 0.005) to avoid bias in the prediction-error
ﬂow .
Emergence of sensory attenuation
This experiment comprises learning and test phases. In the l earning phase, the robot
learned to reproduce the two types of sensorimotor patterns (Fig. 1b). T arget sensori-
motor sequences were prepared in advance from human spontan eous behaviors through
manual manipulations of a physical robot. W e prepared 24 tra ining sets for each set of
self-produced and externally produced contexts. W e ensure d that each of the 24 move-
ment patterns of the robot was the same for both contexts (see Fig. 1b and “Learning"
section in the Methods). The RNN updated posteriors and syna ptic weights to mini-
mize the path integral of free-energy (Supplementary Fig. S 1).
In the test phase, the trained robot was required to generate actions by itself and
to recognize an environmental context by updating only post eriors to minimize the
free-energy, with ﬁxed synaptic weights (Fig. 2a and Supple mentary Fig. S2). Ac-
tion generation of the robot was performed by proportional- integral-derivative (PID)
control. A PID controller receives proprioceptive predict ions as target joint angles and
it changes the joint angles (proprioception) to minimize th e error between the current
state and target. In this regard, the PID controller impleme nts active inference under
the free-energy principle by realizing posterior predicti ons about movement trajecto-
ries ( 15). Fig. 2b-e shows an example of a test trial (Supplementary V ideo S1). The
test trial consists of a self-produced context during time s teps 0-100 and an externally
produced context during time steps 100-200.
In the self-produced context, the robot moved the external o bject by itself, and
the object position matched the robot’s hand position (Fig. 2e). The trained RNN
successfully reproduced the stochastic property of learne d sensorimotor sequences by
modulating the association-level latent mean µ (2), such that the estimated sigma σ (2)
was high during random behavior generation, but low when ret urning to the set-posture
(Fig. 2c). Here, µ and σ correspond to the mean and standard deviation of a Gaussian
posterior or prior. In other words, they play the role of sufﬁ cient statistics of approxi-
mate posterior beliefs and prior beliefs that are optimized during learning. Modulation
of the latent mean in exteroceptive and proprioceptive area s µ (1) was small, with low
estimated sigma σ (1) (Fig. 2d), suggesting reduced prediction-error ﬂow into se nsory
4
Emergence of sensory attenuation based upon the free-energ y principle
areas with high precision in its prior. These results indica te that the RNN minimized
prediction errors produced by self-movements mainly by adj usting the posterior in the
association area, since the posterior in sensory areas cann ot be easily adjusted because
of the strong prior.
Then, at time step 100, the environment was shifted to extern ally produced contexts,
where the object position was given from test data that were n ot used in the learning
phase. The object position and hand position became uncorre lated (Fig. 2e). The
environmental change caused a stepwise change in the execut ive-level latent state µ (3)
(Fig. 2b). At the same time, in sensory areas, modulation in t he latent mean µ (1)
was ampliﬁed and sigma σ (1) increased, showing periodic modulation (Fig. 2d), like
the association-level latent state. This shows that the RNN minimized prediction errors
from externally produced sensations by adjusting the poste rior in sensory areas, as well
as in the association area.
Collectively, the hierarchical RNN attenuated neural resp onses in sensory areas
for the self-produced context and ampliﬁed them for the exte rnally produced context
by proactively controlling precision of the prior at each ne twork level in which the
posterior in the executive area worked as the information hu b for switching the lower-
level precision structure and the prediction error ﬂow (Fig . 3). Furthermore, free-
energy converged into different states for distinct sensor imotor contexts (Fig. 3). This
suggests that a particular free-energy minimum was develop ed for each sensorimotor
context and the transition of the free-energy state in the ne twork, induced by the abrupt
context shift, underlay the qualitative change in the free- energy minimization.
For quantitative analysis, we prepared 10 trained networks with different initial
synaptic weights and conducted 8 test trials for each traine d network. Fig. 4a shows the
change in the sensory-level posterior mean µ (1),q per time step for the two contexts. In
this study, it is referred to as a sensory-level posterior re sponse. A paired t-test reported
that the posterior response was signiﬁcantly smaller in the self-produced context than
in the externally produced context ( t(9) =−3.38, p = 0.0082). In addition, a paired t-
test showed that the sensory-level prior sigma σ (1),p in the self-produced context was
signiﬁcantly lower than that in the externally produced con text ( t(9) = −3.32, p =
0.0089) (Fig. 4b).
Furthermore, we analyzed how attenuation of neural respons es in sensory areas de-
veloped during the learning process. The RNN ﬁrst increased sensory-level posterior
responses to reconstruct target sensorimotor sequences (F ig. 4c). Then, sensory-level
posterior responses in the self-produced context were grad ually attenuated in both exte-
roceptive and proprioceptive areas. The sensory-level pri or sigma diminished more in
the self-produced context than in the externally produced c ontext through the learning
process (Fig. 4d). W e conﬁrmed that posterior responses in t he association area were
similar in self-produced and externally produced contexts (Supplementary Fig. S3a-b),
indicating reduced total neural response in the self-produ ced context. This sensory at-
tenuation was accompanied by recognition of both contexts i n the executive area (Sup-
plementary Fig. S3c-d). These results demonstrate emergen ce of sensory attenuation
through a learning process via free-energy minimization. A dditional analyses indicated
that development of sensory attenuation was diminished by r emoving neurons in the
association or executive area (Supplementary Fig. S4), sug gesting the importance of a
higher-level representation of sensorimotor correlation .
5
Emergence of sensory attenuation based upon the free-energ y principle
In addition, we investigated effects by modulation of the me ta-prior at each network
level (Supplementary Fig. S5-7). In particular, a small met a-prior in sensory areas or
a large meta-prior in the association area led to a deﬁcit in a ttenuation of the sensory-
level posterior response, as well as the sensory-level prio r sigma, in the self-produced
context. This suggests that innately decreased prediction -error ﬂow into the association
area compared to sensory areas disrupted development of sen sory attenuation.
Discussion
The current model study, using a hierarchically organized v ariational RNN, illustrated
the possibility that a sensory attenuation mechanism can de velop through learning. In
the learning task, the robot alternately repeated imprecis e movement (random behav-
ior) and precise movement (returning to the set-posture) in both self-produced and
externally produced contexts. The RNN developed a hierarch ical generative model
about how proprioceptive and exteroceptive inputs are gene rated from the latent causes
and also represented the stochastic property by dynamicall y modulating precisions of
hierarchical latent variables, which are individually all ocated to each area of the RNN.
W e found that for dealing with two distinct types of sensorim otor contexts, namely
self-produced and externally produced contexts, the netwo rk developed two distinct
free-energy states (minima) through learning, wherein eac h free-energy state corre-
sponds to each sensorimotor context (Fig. 3 and 4c-d). In the developed network, the
top-down and bottom-up pathways functioned as follows. In t he top-down pathway,
the posterior in the executive area predicted the prior prec ision of the association area
and sensory areas. In the bottom-up pathway, prediction err or determined the posterior
of sensory areas, the association area, and the executive ar ea under the constraint of
the prior precision expected at each area by the top-down pat hway. Here, we see that
the top-down pathway and the bottom-up pathway created a clo sed circuit in which the
posterior in the executive area served as the information hu b. In the closed circuit, a par-
ticular free-energy state corresponded to the characteris tic top-down precision control
and bottom-up prediction-error ﬂow inside the hierarchica l RNN.
In the self-produced context, sensory attenuation was achi eved by minimizing the
free-energy to the corresponding free-energy state. In thi s context, the posterior in
the executive area developed to a particular value, and indu ced high prior precision in
sensory areas and low prior precision in the association are a, which resulted in less
adaptation in its posterior in sensory areas and more adapta tion in the association area
using the bottom-up error signal. Less adaptation in the pos terior in sensory areas
corresponds to sensory attenuation. The detail mechanism i s as below . The hierarchical
RNN recognized that proprioceptive and exteroceptive inpu ts were generated from the
same latent cause, i.e., self, and the latent cause, includi ng its stochastic property, was
represented in the higher-level areas (association area an d executive area). In this case,
sensory areas were not needed to represent the latent cause a t all. Indeed, Fig. 2
shows that the RNN can reconstruct sensory inputs based on th e dynamic modulation
of latent variables only in the association area. Then, high precision (nearly 0 sigma) of
latent variables in the sensory areas is thought to be develo ped to minimize variational
free-energy by reducing prediction error due to random samp ling and reducing KL
6
Emergence of sensory attenuation based upon the free-energ y principle
divergence between the posterior and the prior.
In an externally produced context, the process was the other way around, wherein
the posterior in sensory areas adapted greatly because of th e low precision in its prior
regulated by the executive area. This corresponds to sensor y ampliﬁcation. In this
context, proprioceptive and exteroceptive inputs were gen erated from individual causes,
i.e., self, and other. The hierarchical RNN needed to repres ent not only the higher-level
context, i.e., externally produced context, using the asso ciation and executive areas,
but also unresolved lower-level information due to individ ual causes using individual
sensory areas. That is why, precisions of latent variables i n the sensory areas as well as
the association area were modulated dynamically.
Furthermore, the error induced by the change of the sensorim otor context ﬂowed
bottom-up to the executive area and determined the posterio r in the executive area with
its prior set to a neutral value. It triggered the transition from one free-energy state
to another, i.e., from sensory attenuation to sensory ampli ﬁcation and verse-versa. In
short, precision structures for sensory attenuation in sel f-produced contexts and sensory
ampliﬁcation in externally produced contexts were self-or ganized in one hierarchical
RNN and were switched via executive control. This suggests t hat the hierarchical RNN
developed a type of functionality of switching between quas i-deterministic and highly
stochastic dynamics in each local area, in which sensory att enuation was character-
ized by quasi-deterministic processing (nearly 0 sigma) in the sensory areas and highly
stochastic processing in the association area, while senso ry ampliﬁcation was charac-
terized by highly stochastic processing in both the sensory areas and the association
area. This sort of development and transitions of distinct f ree-energy states provides in-
sights into how perceptual phenomena emerge from dynamic br ain-body-environment
interaction in the face of uncertainty.
Sensory attenuation observed in our model is an emergent pro perty based on vari-
ational free-energy minimization, rather than a consequen ce guaranteed by the equa-
tions used in the proposed model. Indeed, a small meta-prior in sensory areas led to a
deﬁcit in development of sensory attenuation, in which pred iction error and free-energy
for training data were smaller than those of the baseline mod el (see Supplementary
Fig. S5 and S8). This shows that sensory attenuation was not n ecessarily developed
even if proprioceptive and exteroceptive sensory inputs ar e correlated and the model
precisely reconstructs the sensory inputs based on variati onal free-energy minimiza-
tion. Instead, development of sensory attenuation depends on a generative model of
the world self-organized by the hierarchical RNN. In partic ular, the following factors
suggest that development of sensory attenuation required a sort of abstract-level recog-
nition that proprioceptive and exteroceptive inputs are ge nerated from the same latent
cause, i.e., sensorimotor coupling, which was achieved by a balanced interaction be-
tween the top-down prediction with precision and the bottom -up prediction error. First,
reduced numbers of latent variables in the association area or executive area disrupted
development of sensory attenuation (Supplementary Figure S4). Second, a large meta-
prior in the association area as well as a small meta-prior in the sensory areas, i.e., re-
duced prediction-error ﬂow into the association area, led t o a deﬁcit in development of
sensory attenuation (Supplementary Fig. S5-6). These show the importance of higher-
level structure learning for developing sensory attenuati on. Furthermore, the difference
in the dimensions of proprioception (3-dimensional joint a ngle) and exteroception (2-
7
Emergence of sensory attenuation based upon the free-energ y principle
dimensional object position) required an abstract-level r epresentation for recognizing
the sensorimotor coupling. Such an abstraction of sensorim otor information may be
a reasonable consequence given the efﬁcient coding, but it i s not necessarily obvious
given the self-organization by the hierarchical RNN itself through learning. This kind
of emergent phenomenon self-organized through learning ha s not thoroughly been in-
vestigated in previous studies based on the free-energy pri nciple. Thus, we think that
this complex property emphasizes the signiﬁcance of our neu rorobotic approach.
There have been prior model proposals to account for sensory attenuation. One
proposal ( 13) postulates that sensory attenuation is caused by reducing the precision
of the prediction error bottom-up to the sensory area during movement by following
the free-energy principle. This model, however, does not ex plain the involvement of
the higher executive area, as evidenced by ( 19, 20 ). W e conﬁrmed that removal of the
executive area diminished the development of sensory atten uation (Supplementary Fig.
S4b), emphasizing the contribution of the frontal function . This is consistent with bio-
logical studies suggesting that signals from the frontal ar ea, such as the supplementary
motor area, predictably control the relative precision or i ntensity of sensations. Their
disruption causes diminished sensory attenuation ( 19, 26 ). Furthermore, the previous
model intermixes two phenomena: sensory attenuation and se nsory gating. Sensory at-
tenuation compares the intensity of self-produced sensati ons with externally produced
sensations, or the distinction between the self and others. On the other hand, sen-
sory gating refers to a suppression process in which exteroc eptions feel weaker during
movement than at rest ( 27). In our learning experiment, movements of the robot in
self-produced contexts and externally produced contexts w ere the same, avoiding the
confusion with sensory gating. In this sense, our model cons idered only sensory atten-
uation (self-other distinction).
According to another leading hypothesis, the pathway of an e fference copy of the
motor command is thought to originate from top-down signals (19, 26). In contrast, our
model suggests that signals from the executive (frontal) ar ea may represent predictive
signals for controlling prediction-error ﬂow inside the hi erarchical network, rather than
a copy of the motor command. W e showed that the functionality , in which top-down
signals hierarchically control bottom-up prediction-err or ﬂow inside the network (that
modulates top-down signals), can be self-organized throug h learning.
The perspective that the sensory attenuation mechanism is a consequence of learn-
ing instead of an innate function, may be indirectly support ed by a recent study sug-
gesting that a target stimulus of sensory attenuation can be adaptively changed through
rapid learning ( 28). In addition, our result (Fig. 4c) explains increased sens ory atten-
uation with age in adults ( 20). Furthermore, our model suggests that proprioception,
as well as exteroception, can be attenuated when a self-move ment produces exterocep-
tion. In fact, a neuroimaging study observes less cerebella r activity when a movement
produces a tactile stimulus, than when it does not ( 6).
There have been some recent advances in our understanding of movement-related
suppression processes, including the ﬁnding of a differenc e between sensory attenua-
tion and sensory gating. One of the discussions is about a dif ference between “phys-
iological sensory attenuation" and “perceptual sensory at tenuation". A recent study
suggests that “physiological sensory attenuation" and “pe rceptual sensory attenuation"
have different neurophysiological correlates ( 29). In a recent study, “physiological
8
Emergence of sensory attenuation based upon the free-energ y principle
sensory attenuation" was measured as a decrease in the ampli tude of primary and sec-
ondary components of the somatosensory evoked potential (S EP) by comparing it dur-
ing movement and at rest; thus, it may be related with sensory gating. On the other
hand, “perceptual sensory attenuation" was measured in a fo rce-matching paradigm
and was suggested to be related with a decrease in prediction -error-related neural ac-
tivity, such as gamma-oscillatory activity. Importantly, “perceptual sensory attenua-
tion" negatively correlated with scores of delusional idea tion (a measure of schizotypy)
while no signiﬁcant correlations were found between attenu ation of SEP components
and scores of delusional ideation. In our experiment, we foc us on an attenuation of
prediction-error-related response of the posterior; thus , our model may explain “per-
ceptual sensory attenuation" and its neurocomputational m echanism. In addition, our
model of sensory attenuation suggests that a decrease in pre diction-error-related ac-
tivity and “perceptual sensory attenuation" may represent self-other distinction, which
has implications for mechanisms underlying delusional ide ation.
In addition, a recent study demonstrated an enhancement, no t suppression, of the
intensity of predicted action outcomes by investigating ef fects of action on intensity
of tactile stimulus reported by participants in the force-j udgment paradigm ( 30). First,
the authors replicated typical ﬁndings that self-produced tactile stimuli are rated as less
intense than externally produced stimuli when an active con tact with a button gener-
ates a tactile stimulus. However, this effect reversed when there was no active ﬁnger
contact with a button. In additional experiments, they cont rolled the predictability of
tactile action outcomes and found that expected events were perceived more, not less,
intensely than unexpected events. Note that this additiona l experiment compared cases
with more predictable and less predictable outcomes produc ed by own action. Since
this comparison did not compare stimuli produced by own acti on and other’s action,
this additional experimental result does not conﬂict with o ur claim. These results in
the previous study ( 30) may show that when sensory attenuation does not appear, an
action can enhance expected touch. This enhancement effect is consistent with the
basic Bayesian idea that a predictive brain focuses on preci se (predictable) stimuli to
ignore uninformative (uncertain) noise. In this sense, the previous study suggests that a
theory of sensory attenuation requires an additional thoug ht beyond the basic Bayesian
or active inference framework. Here, our model provides a pa rticular mechanism for
sensory attenuation beyond the basic Bayesian theory. Spec iﬁcally, our results sug-
gest that sensory attenuation requires an abstract-level r ecognition that proprioceptive
and exteroceptive inputs are generated from the same latent cause, i.e., self, which is
developed through context-sensitive optimization of hier archical latent variables. This
emphasizes the importance of developmental aspects of hier archical predictive process-
ing.
Alterations in development of sensory attenuation were ind uced by modulation of
the meta-prior, a hyper-parameter determining the intrins ic strength of the prior com-
pared to the prediction error at each network level. In the ba sic Bayesian model, the
practitioner must manually set the prior, including its pre cision, to compute the pos-
terior. However, in our model, the prior in each network area is epigenetically self-
organized through learning, with the inﬂuence of the higher meta-level parameter, i.e.,
the meta-prior. W e assumed that the meta-prior is an innate c haracteristic determining
developmental features of the prior and prediction-error ﬂ ow in the biological brain, al-
9
Emergence of sensory attenuation based upon the free-energ y principle
though its neural substrate remains unspeciﬁed. In our expe riment, a large meta-prior
in the association area, i.e., an intrinsically strong prio r in the association area, led to
reduced sensory attenuation, i.e., a weak prior in sensory a reas, while a small meta-
prior in the association area, i.e., an intrinsically weak p rior in the association area, did
not impair development of sensory attenuation (Supplement ary Fig. S6). These results
may provide insights into relationships between strong pri or hypotheses and reduced
sensory attenuation in schizophrenia ( 9, 13, 31, 32 ) and between weak prior hypothe-
ses and normal sensory attenuation in autism spectrum disor der ( 33–37 ). It will be
important to seek corresponding neurological evidence of t he proposed computational
mechanism for development of sensory attenuation and to exp lore its relevance to psy-
chiatric disorders in future studies.
In summary, we have shown that sensory attenuation is an emer gent property of
free-energy minimization in active inference. Sensory att enuation is a ubiquitous phe-
nomenon in psychology and psychophysics. Furthermore, it i s receiving increasing
attention in computational psychiatry, in which a failure o f sensory attenuation may ex-
plain several neuropsychiatric conditions, ranging from P arkinson’s disease to schizophre-
nia and autism ( 13, 34 ). T echnically, we have simulated behavior in terms of activ e
inference, which can be thought of as a generalization of con trol and planning as in-
ference. Crucially, we trained our robots to perform active inference by optimizing
connection weights ( w) and adaptive variables ( a) in hierarchically organized RNNs,
which played the role of a hierarchical generative model. Th e implicit learning of con-
nection strengths can be thought of as “amortization" or “le arning to infer". In other
words, by minimizing (the path or time integral of) variatio nal free-energy, robots were
able to learn the mapping from sensory inputs to posterior be liefs about the causes
of their sensory inputs. These posterior beliefs recognize the context in which they
are operating and generate proprioceptive predictions tha t are realized by a PID con-
troller. Because certain beliefs concern precision of infe rred sensorimotor trajectories,
this enables a context sensitive optimization of certain pr ecisions that underwrite sen-
sory attenuation. Put simply, when robots recognized that t he proprioceptive and ex-
teroceptive inputs are best explained by externally genera ted movement, they reduced
the precision afforded representations of self generated s ensations. Conversely, when
proprioceptive and exteroceptive sensory inputs were best explained by self-generated
sensations, precision of these explanations increased, th ereby reducing the inﬂuence
of sensory prediction errors. This is the basis of sensory at tenuation. Note that this
context-sensitive optimization of precision, i.e., encod ing of uncertainty, is an emer-
gent property of minimizing the path integral of free-energ y. In other words, sensory
attenuation emerges from a generative model that provides t he best explanation for
proprioceptive and exteroceptive inputs, when accumulati ng free-energy or model evi-
dence (a.k.a., marginal likelihood) over time.
10
Emergence of sensory attenuation based upon the free-energ y principle
Methods
Neural network model
T o simulate development of sensory attenuation, we utilize d a predictive-coding-inspired
variational recurrent neural network (PV -RNN), which repr esents a generative process
of sensation from a hidden cause in the environment, based on the free-energy principle
(FEP) ( 16, 17 ). It consists of sensory (exteroceptive and proprioceptiv e), association,
and executive areas in which there are deterministic neuron s and latent (stochastic) neu-
rons. Latent neurons represent belief about the cause of sen sation as Gaussian distribu-
tions (for simplicity). Each latent state has prior and post erior probability distributions
that correspond to estimated hidden causes before and after observing sensations, re-
spectively. Based on the latent states, the PV -RNN generate s predictions about next
sensations in a top-down way. Here, deterministic neurons t ransform latent states into
sensory predictions via synaptic connections that represe nt relationships between sen-
sations and their causes. The PV -RNN uses a multiple timesca le RNN (MTRNN) ( 38)
as the transformation function. An RNN represents temporal processing of the brain
in that neural activity is determined by the past history of n eural states. Owing to their
capacity to learn to reproduce complex dynamic behaviors, R NNs have been used in
computational modeling and developmental neurorobotic st udies to understand cortical
processing and cognitive functions, including psychiatri c symptoms ( 38–43 ). In addi-
tion, MTRNNs have a multiple timescale property in neural ac tivation, which enables
them to represent a temporal hierarchy in the environment, a s observed in the biolog-
ical brain ( 44). By using a PV -RNN, we can learn complex sensorimotor behav iors
that have both temporal regularity and stochasticity ( 16, 17 ). T o perform spontaneous
behaviors like daily human behaviors, a neural network-con trolling robot was required
to process short-term random movements and a long-term peri odic pattern, as in the ex-
periment in which the multiple timescale property is though t to facilitate sensorimotor
learning. In the following sections, we describe the mathem atical details of top-down
prediction generation and bottom-up parameter updates by t he PV -RNN (Supplemen-
tary Fig. S1-2).
Prediction generation
Prediction generation is performed in a top-down way throug h the network hierarchy.
The internal state h(s)
t,i and output d(s)
t,i of the ith deterministic neuron of the sth target
11
Emergence of sensory attenuation based upon the free-energ y principle
sequence at time step t (t ≥ 1) is calculated as
h(s)
t,i =





































1
τ
( ∑
j∈ IAd
wij d(s)
t− 1,j +
∑
j∈ IAz
wijz(s)
t,j +
∑
j∈ ICz
wij z(s)
t,j + bi
)
+
(
1 − 1
τ
)
h(s)
t− 1,i (i ∈ IAd) ,
1
τ
( ∑
j∈ IEd
wij d(s)
t− 1,j +
∑
j∈ IEz
wij z(s)
t,j +
∑
j∈ IAd
wij d(s)
t,j + bi
)
+
(
1 − 1
τ
)
h(s)
t− 1,i (i ∈ IEd) ,
1
τ
( ∑
j∈ IPd
wij d(s)
t− 1,j +
∑
j∈ IPz
wij z(s)
t,j +
∑
j∈ IAd
wij d(s)
t,j + bi
)
+
(
1 − 1
τ
)
h(s)
t− 1,i (i ∈ IPd) .
(2)
d(s)
t,i = tanh
(
h(s)
t,i
)
(i ∈ IEd, IPd, IAd) . (3)
Here, IEd, IPd, and IAd are index sets of deterministic neurons in the exteroceptiv e
area, proprioceptive area, and association area, respecti vely. IEz, IPz, IAz, and ICz
are index sets of latent neurons in the exteroceptive, propr ioceptive, association, and
executive areas, respectively. wij is the weight of the synaptic connection from the jth
neuron to the ith neuron; z(s)
t,j is the output of jth latent (posterior) neuron at time step t;
τ is the time constant of the neuron; and bi is the bias of the ith neuron. A deterministic
neuron with a small time constant τ has a tendency to change its activity rapidly, while
that with a large time constant has a tendency to change its ac tivity slowly. W e set the
initial internal states of the deterministic neurons h(s)
0,i (i ∈ IEd, IPd, IAd) to 0 (d(s)
0,i is
also 0).
The latent variable z in each area is assumed to follow a multivariate Gaussian
distribution with a diagonal covariance matrix, meaning z(s)
t,i and z(s)
t,j are independent
(i, j ∈ IEz, IPz, IAz ∧ i ̸= j). Here, the mean µ(s),p
t,i and sigma (standard deviation)
σ(s),p
t,i of the prior distribution p(z(s)
t,i ) in the exteroceptive, proprioceptive, and associa-
tion areas are calculated from the previous deterministic s tate (prior experience) of the
same area.
p(z(s)
t,i ) =p(z(s)
t,i |d(s)
t− 1,j ) =N (z(s)
t,i ; µ(s),p
t,i , σ(s),p
t,i ). (4)
µ(s),p
t,i = tanh
( ∑
j wij d(s)
t− 1,j
)
, (5)
σ(s),p
t,i = exp
( ∑
j wij d(s)
t− 1,j
)
. (6)
Here, (i ∈ IEz ∧ j ∈ IEd) ∨ (i ∈ IPz ∧ j ∈ IPd) ∨ (i ∈ IAz ∧ j ∈ IAd). Note by opti-
mizing the weights w, with respect to the path integral of free-energy, we are eff ectively
optimizing prior beliefs about sensorimotor contingencie s and contexts. This can be re-
garded as a form of structure learning through experience. T he executive area has a
12
Emergence of sensory attenuation based upon the free-energ y principle
prior distribution as N (0, 1) only at the initial step ( t = 1) because it has a constant
posterior state during sequential prediction generation, with the objective of assigning
a speciﬁc executive-level posterior to each target sequenc e.
The posterior distribution in each area is calculated as,
q(z(s)
t,i |e(s)
t:T (s) ) =









q(z(s)
t− 1,i |e(s)
t− 1:T (s) ) =q(z(s)
1,i |e(s)
1:T (s) ) =N (z(s)
1,i ; µ(s),q
1,i , σ(s),q
1,i ) ( i ∈ ICz) ,
N (z(s)
t,i ; µ(s),q
t,i , σ(s),q
t,i ) ( i ∈ IEz, IPz, IAz) .
(7)
µ(s),q
t,i = tanh
(
a(s),µ
t,i
)
, (8)
σ(s),q
t,i = exp
(
a(s),σ
t,i
)
, (9)
z(s)
t,i = µ(s),q
t,i + σ(s),q
t,i × ǫ. (10)
Here, T (s) represents the length of the sth target sequence. a is the adaptive internal
state of neurons representing posterior distributions and it is updated at each time step
and for each target sequence during the learning process (or each time step through
online inference). Note that equations (8) and (9) mean that the adaptive variables
implicitly encode both posterior expectations and precisi on, such that optimizing the
adaptive variables with respect to variational free-energ y implicitly optimizes poste-
rior expectations and the posterior conﬁdence or precision afforded those expectations.
Adaptive variables at are determined by prediction error signals et:T propagated by a
back-propagation-through-time (BPTT) algorithm, meanin g that the posterior of the la-
tent state can be considered a prediction-error-related ne ural state. Adaptive variables
a are initialized by the corresponding initial internal stat es of the neurons represent-
ing prior distributions before the learning or inference pr ocess. Based on the posterior
calculation, the latent state z(s)
t,i is obtained by sampling ǫ from N (0, 1).
Finally, predictions about exteroceptive and propriocept ive sensations are individu-
ally generated from exteroceptive and proprioceptive area s, respectively.
ˆx(s)
t,i =





















tanh

∑
j∈ IEd
wij d(s)
t,j

 (i ∈ IEo) ,
tanh

∑
j∈ IPd
wij d(s)
t,j

 (i ∈ IPo) .
(11)
Here, IEo and IPo are index sets of output neurons for exteroceptive and propr ioceptive
predictions, respectively.
13
Emergence of sensory attenuation based upon the free-energ y principle
Parameter updates via free-energy minimization
The concept of FEP ( 14) derives from the fundamental fact that self-organizing bi olog-
ical agents must maintain a limited repertoire of sensory st ates to remain alive, e.g., a
human stays on the ground, not in the sea. Based on informatio n theory, this notion can
be formulated as suppression of the surprise (or the negativ e log-evidence) for sensa-
tions x over time. In the PV -RNN, the surprise over all time steps and target sequences
can be written as:
∑
s∈ IS
− log p(x(s)
1:T (s) ) =
∑
s∈ IS
[
− log
∫
p(x(s)
1:T (s) , z(s)
1:T (s) )dz(s)
1:T (s)
]
(12)
=
∑
s∈ IS

− log
∫ T (s)
∏
t=1
[
p(x(s)
t |d(s)
t )p(z(s)
t |d(s)
t− 1)
]
dz(s)
1:T (s)

. (13)
Here, IS denotes the index set of target sequences. However, surpris e cannot be directly
evaluated by the agent because it needs to know all hidden sta tes z of the environment
that cause sensations, as described on the right side of the e quation (12). Here, FEP
introduces a tractable quantity, free-energy, that bounds the surprise, and minimization
of the surprise is replaced by minimization of the free-ener gy. The bound of the surprise
in the PV -RNN can be derived by utilizing Jensen’s inequalit y for a concave function
f: f(E[x]) ≥ E[f(x)]. For clarity, summation over target sequences is temporari ly
omitted in the following equations. Then, equation (13) can be deformed as follows by
introducing a dummy distribution for z1, q(z1).
− log p(x1:T )
= − log
∫
z1
dz1q(z1)
∫
z2:T
dz2:T
1
q(z1)
T∏
t=1
[p(xt|dt)p(zt|dt− 1)] (14)
≤ −
∫
z1
dz1q(z1) log
∫
z2:T
dz2:T
1
q(z1)
T∏
t=1
[p(xt|dt)p(zt|dt− 1)] . (15)
In equation (15), we use Jensen’s inequality for a logarithm ic function. The same
procedure is done for t = 2 :T .
− log p(x1:T ) ≤ −
∫
z1
dz1q(z1) · · ·
∫
zT
dzT q(zT ) log
T∏
t=1
[ p(xt|dt)p(zt|dt− 1)
q(zt)
]
(16)
= −
∫
z1
dz1q(z1) · · ·
∫
zT
dzT q(zT )
T∑
t=1




log p(xt|dt)
 
A
− log q(zt)
p(zt|dt− 1)  
B




. (17)
14
Emergence of sensory attenuation based upon the free-energ y principle
The ﬁrst term in expression (17) is the expected negative log -likelihood under q given
that dt depends on z1:t.
A = −
∫
z1
dz1q(z1) · · ·
∫
zT
dzT q(zT )
T∑
t=1
log p(xt|dt) (18)
= −
T∑
t=1
Eq(z1:t ) [log p(xt|dt)] . (19)
In addition, the second term can be deformed into forms of Kul lback-Leibler diver-
gence (KLD) between q(zt) and p(zt|dt− 1) while being careful to ensure that d0 is
independent from z1:T .
B =
∫
z1
dz1q(z1) · · ·
∫
zT
dzT q(zT )
T∑
t=1
log q(zt)
p(zt|dt− 1) (20)
=
∫
z1
dz1q(z1) log q(z1)
p(z1|d0)
+
∫
z1
dz1q(z1) · · ·
∫
zT
dzT q(zT )
T∑
t=2
log q(zt)
p(zt|dt− 1) (21)
= DKL [q(z1)||p(z1|d0)] +
T∑
t=2
Eq(z1:t− 1) [DKL [q(zt)||p(zt|dt− 1)]] . (22)
A dummy distribution q(zt) can be replaced by the posterior distribution determined
by the back-propagated prediction error q(zt|et:T ). Thus, using equations (19) and
(22), the bound of the surprise can be written as,
− log p(x1:T ) ≤ −
T∑
t=1
Eq(z1:t |et:T ) [log p(xt|dt)] +DKL [q(z1|e1:T )||p(z1|d0)]+
T∑
t=2
Eq(z1:t− 1|et− 1:T ) [DKL [q(zt|et:T )||p(zt|dt− 1)]] .
(23)
In the experiment, we resolve calculation of the expectatio ns of negative log-likelihood
and KLD under q by considering single sampling to reduce computational cos ts.
− log p(x1:T ) ≤
T∑
t=1
(− log p(xt|dt) +DKL [q(zt|et:T )||p(zt|dt− 1)]) . (24)
Eventually, by introducing the meta-prior and considering the summation over differ-
ent target sequences, the free-energy F (the bound of the surprise) in the PV -RNN is
15
Emergence of sensory attenuation based upon the free-energ y principle
formulated as:
F =
∑
s∈ IS
T (s)
∑
t=1
F (s)
t (25)
F (s)
t = − log p(x(s)
t |d(s)
t )  
Accuracy
+
3∑
l=1
W (l)
(
DKL [q(z(l),(s)
t |e(s)
t:T )||p(z(l),(s)
t |d(l),(s)
t− 1 )]
)
  
Complexity
. (26)
Here, W (l) denotes the meta-prior at lth network level. The ﬁrst term in expression
(26) (negative accuracy term) is the negative log-likeliho od. For simplicity, we assume
that each sensory state follows a Gaussian distribution wit h unit variance. Then, the
ﬁrst term becomes just the prediction error between the real x(s)
t and predicted ˆx(s)
t
sensations (plus a constant term, omitted here).
−Accuracy =
∑
i∈ IEo∨ IPo
1
2
(
x(s)
t,i − ˆx(s)
t,i
) 2
. (27)
This assumption sets the precision of the prediction error t o a constant value and makes
it easy to consider the relative precision of prior beliefs c ompared to prediction errors.
In the experiment, we divided the accuracy term by the dimens ion of each exteroceptive
and proprioceptive sensation.
On the other hand, the second term (complexity term) is the KL D between the pos-
terior and prior distributions of the latent variables. Not e that variables of the posterior
are updated through both the accuracy and complexity terms, but those of the prior are
updated only through the complexity term. Therefore, the co mplexity term represents
only the inﬂuence of prior beliefs, which are controlled by t he meta-prior W . Under the
assumption that the prior and posterior distributions foll ow a multivariate Gaussian dis-
tribution with a diagonal covariance matrix, as described a bove, the KLD is computed
analytically as ( 16, 17 ),
Complexity =
∑
i
(
log
σ(s),p
t,i
σ(s),q
t,i
+
(µ(s),p
t,i − µ(s),q
t,i )2 + (σ(s),q
t,i )2
2(σ(s),p
t,i )2
− 1
2
)
. (28)
Here, i ∈ IEz ∨ IPz (if l = 1), i ∈ IAz (if l = 2), and i ∈ ICz (if l = 3). In the
experiment, we divided the complexity term by the dimension of latent variables for
each area. Note that if l = 3(executive area), the complexity term exits only at t = 1,
although we write the equation in a general way for simplicit y.
In the learning phase (Supplementary Fig. S1), synaptic wei ghts w and adaptive
variables a are updated to minimize the free-energy over all time steps a nd target se-
quences as,
F =
∑
s∈ IS
T (s)
∑
t=1
F (s)
t . (29)
16
Emergence of sensory attenuation based upon the free-energ y principle
In the test phase after learning (Supplementary Fig. S2), on ly adaptive variables a are
updated, while synaptic weights are ﬁxed. In this phase, the free-energy within a short
time window H is summed as
F =
t∑
t′ =t− H+1
Ft′ . (30)
Using the summed free-energy, adaptive variables at− H+1:t within the time window
of all areas are updated, whereas the time window slides as th e network time step t is
incremented.
In both learning and test phases, we used the Adam optimizer ( 45) for parameter
updates, where the partial derivative of the free-energy wi th respect to each parameter
is calculated by the BPTT algorithm.
Experimental environment
W e set a 3-axis robotic arm in a simulated square space [−1, 1]×[−1, 1]. The lengths of
the robot’s links are 0.1, 0.3, and 0.5. Each joint angle was l imited to range from 0 to π
[rad] and normalized to range from −0.8 to 0.8 to match the range of the neural network
output. In addition, the PV -RNN receives the 2-dimensional position of a red object
as an exteroceptive sensation. During task execution, the r obot receives 5-dimensional
sensations every 250 ms.
Learning
The PV -RNN learned to reproduce target sensorimotor sequen ces prepared in advance.
First, we recorded 24 sequences of joint angles while the exp erimenter manually ma-
nipulated the left arm of a physical robot (Rakuda, develope d by Robotis). For each se-
quence, the experimenter performed 10 repetitions generat ing a random movement and
returning to the set posture within ﬁve seconds (20 time step s). Therefore, the length
of each sequence is 200 time steps. W e used joint angles from l eft shoulder pitch, left
shoulder roll, and the left elbow of Rakuda as 3-dimensional proprioception data of the
simulated robot arm. Next, we prepared exteroception data f or a self-produced con-
text by setting the object position as the hand position of th e simulated arm robot that
was calculated by forward kinematics using the recorded joi nt angle data. In this fash-
ion, we obtained 24 target sequences for self-produced cont exts in which exteroceptive
and proprioceptive sensations are correlated. Finally, we prepared target sequences for
externally produced contexts by shufﬂing the combination o f exteroceptive and pro-
prioceptive sequences. By doing this, we obtained 24 target sequences for externally
produced contexts in which exteroceptive and propriocepti ve sensations are not cor-
related. This shufﬂing procedure ensures that total number s of changes in sensations
are the same for self-produced and externally produced cont exts in the learning phase.
The PV -RNN learned to reproduce the prepared 48 training dat asets via free-energy
minimization.
17
Emergence of sensory attenuation based upon the free-energ y principle
Online inference
W e prepared an additional 8 exteroceptive sequences as test data that were used in ex-
ternally produced contexts in the test phase. Before a test t rial, initial states of adaptive
variables a1 in all areas were set to the median values obtained for 24 trai ning datasets
of the self-produced context developed through learning. B ased on the initial posterior
states corresponding to self-produced contexts, the robot ﬁrst moved the object by it-
self during time steps 0-100. The robot controlled its joint angles via active inference
using the PID controller, for which proprioceptive predict ions were used as target joint
angles. Then, during time steps 100-200, the environmental context was shifted to the
externally produced context, although the robot kept gener ating spontaneous behaviors
by itself via active inference. In the externally produced c ontext, the object position
was set from test data. The goal of the robot was to ﬂexibly rec ognize the environmen-
tal change by updating adaptive variables via free-energy m inimization. The online
inference process was performed based on an interaction bet ween top-down prediction
generation and bottom-up posterior updates. In the top-dow n prediction generation
process, the PV -RNN generated sensory predictions ˆxt− H+1:t corresponding to time
steps from t − H + 1to t, based on the posterior of latent states zt− H+1:t. In the
bottom-up modulation process, the free-energy at each time step in time window H
was calculated using prediction errors for exteroception a nd proprioception, for which
target sensations were the real object position and joint an gles from t − H + 1to t.
Adaptive variables at− H+1:t in the time window were updated to minimize the free-
energy summed over time steps, and sensory predictions with in the time window were
re-generated using the updated posterior states. By repeat ing top-down prediction gen-
eration and bottom-up posterior updates for a certain durat ion, the PV -RNN generated
the prior of latent states for time step t + 1. The generated prior was used to initialize
the posterior for time step t + 1, and predictions about sensations for time step t + 1
were generated from the posterior. Using proprioceptive pr edictions for time step t + 1
as the target joint angles, the robot moved the joint angles u sing the PID controller. At
the same time, the robot received exteroceptive sensations at time step t + 1. After
that, the robot’s time step was incremented and the online in ference process was per-
formed for the newly received sensations. This inference pr ocess, in which recognition
and prediction in the past are reconstructed from current se nsations, corresponds to a
“postdiction" process.
Parameter settings
The dimension of latent variables z in the exteroceptive and proprioceptive areas was 1,
and that in the association area was 3. Therefore, the total d imension of latent neurons
in sensory and association areas was the same as the sensory d imension. The dimen-
sion of latent variables in executive area was 1. A prelimina ry experiment showed
that a smaller number of latent neurons in the association ar ea led to a lower level
of sensory attenuation, supporting the idea that sensory at tenuation is a consequence
of representing sensorimotor correlation in the associati on area (Supplementary Fig.
S4a). In addition, we conﬁrmed that no executive-level late nt state resulted in a highly
decreased level of sensory attenuation, suggesting an impo rtant role of the executive-
18
Emergence of sensory attenuation based upon the free-energ y principle
level latent state (Supplementary Fig. S4b). The numbers of deterministic neurons
in the exteroceptive, proprioceptive, and association are as were all 15. In a prelimi-
nary experiment, we evaluated development of sensory atten uation for settings of 10,
15, or 20 deterministic neurons and conﬁrmed that the settin g of 15 neurons showed
the largest sensory attenuation (Supplementary Fig. S9a). W e set the time constant
τ to half the number of deterministic neurons (8 neurons) to 2 a nd that of the other
neurons (7 neurons) to 4, as the simplest multiple timescale setting. W e set the same
multiple timescale property for both the sensory and associ ation areas. This is because
we thought that the PV -RNN controlled which levels of the net work hierarchy should
be used to represent sensations, depending on the context. A ctually, the experimental
results show that the PV -RNN mainly used the association are a in the self-produced
context and both the sensory and association areas in an exte rnally produced context,
in which the timescale property included in sensations was t he same for the two con-
texts. In a preliminary experiment, we conﬁrmed that the mul tiple timescale setting
led to greater sensory attenuation compared to the single ti mescale setting τ = 2 for
all deterministic neurons (Supplementary Fig. S9b). Synap tic weights were initialized
with random values using the default method implemented by P ytorch. Biases of deter-
ministic neurons were initialized with and ﬁxed to random va lues following a Gaussian
distribution N(0, 10), for which the variance of biases is close to the ﬁring thresh old
variability found in biological neurons ( 46), as well as the optimal value in a spiking
neural network model ( 47) and a recurrent neural network model ( 41). W e trained 10
networks with different initial synaptic weights for each h yper-parameter setting for
quantitative evaluations. In the learning phase, paramete rs including synaptic weights
w and adaptive variables a were updated 200, 000 times with the Adam optimizer. W e
used the same parameter setting of Adam as in the original pap er: α = 0.001 (learn-
ing rate), β1 = 0.9, and β2 = 0.999. In the test phase, adaptive variables a were
updated 50 times at each time step for a time window of length H = 10with α = 0.09.
W e chose the optimal parameter setting in the test phase from the combinations of
α = {0.001, 0.005, 0.01, 0.03, 0.05, 0.07, 0.09, 0.1, 0.2, 0.3, 0.4, 0.5} × H = {10, 15}
by evaluating levels of prediction error in the baseline met a-prior setting ( W (1) =
W (2) = W (3) = 0.005).
Statistical analysis
W e used paired t-tests for statistical analyses of network b ehaviors, such as the pos-
terior response and the level of the prior sigma. All statist ical tests were two-tailed,
and the signiﬁcance level was set at p < 0.05. The current study conducted an orig-
inal unprecedented computational simulation experiment. Thus, it is difﬁcult to es-
timate the effect size, and no statistical methods were used to pre-determine sample
size. Considering the high reproducibility of computation al simulation, we set the min-
imum sample size that seemed statistically testable (10 sam ples). Indeed, even for 10
samples, paired t-tests reported clear differences betwee n self-produced context and
externally produced context (e.g., t(9) = −3.38; p = 0.0082 for posterior response
and t(9) =−3.32; p = 0.0089 for prior sigma). Therefore, we concluded that a larger
sample size would not have signiﬁcantly inﬂuenced our main r esult. Data analyses
were conducted using R software (version 3.3.2).
19
Emergence of sensory attenuation based upon the free-energ y principle
References
1. Clark, A. Whatever next? predictive brains, situated age nts, and the fu-
ture of cognitive science. Behavioral and Brain Sciences 36, 181–204, DOI:
10.1017/S0140525X12000477 (2013).
2. Braun, N. et al. The senses of agency and ownership: A review . Frontiers in
Psychology 9, 535, DOI: 10.3389/fpsyg.2018.00535 (2018).
3. Legaspi, R. & T oyoizumi, T . A bayesian psychophysics mode l of sense of agency.
Nature Communications 10, 4250, DOI: 10.1038/s41467-019-12170-0 (2019).
4. Dewey, J. A. & Knoblich, G. Do implicit and explicit measur es of the
sense of agency measure the same thing? PLOS ONE 9, e110118, DOI:
10.1371/journal.pone.0110118 (2014).
5. W eiskrantz, L., Elliot, J. & Darlington, C. Preliminary o bservations on tickling
oneself. Nature 230, 598–599, DOI: 10.1038/230598a0 (1971).
6. Blakemore, S.-J., W olpert, D. M. & Frith, C. D. Central can cellation of self-
produced tickle sensation. Nature Neuroscience 1, 635–640, DOI: 10.1038/2870
(1998).
7. Bäß, P ., Jacobsen, T . & Schröger, E. Suppression of the aud itory n1 event-related
potential component with unpredictable self-initiated to nes: Evidence for internal
forward models with dynamic stimulation. International Journal of Psychophysi-
ology 70, 137–143, DOI: 10.1016/j.ijpsycho.2008.06.005 (2008).
8. Arikan, B. E. et al. Perceiving your hand moving: Bold suppression in sensory
cortices and the role of the cerebellum in the detection of fe edback delays. Journal
of V ision 19(14), DOI: 10.1167/19.14.4 (2019).
9. Blakemore, S.-J., W olpert, D. & Frith, C. Why can’t you tic kle yourself? Neu-
roReport 11, R11–R16 (2000).
10. Bays, P . M., W olpert, D. M. & Flanagan, J. R. Perception of the consequences of
self-action is temporally tuned and event driven. Current Biology 15, 1125–1128,
DOI: 10.1016/j.cub.2005.05.023 (2005).
11. Kilteni, K., Andersson, B. J., Houborg, C. & Ehrsson, H. H . Motor imagery in-
volves predicting the sensory consequences of the imagined movement. Nature
Communications 9, 1–9, DOI: 10.1038/s41467-018-03989-0 (2018).
12. W olpert, D. M., Ghahramani, Z. & Jordan, M. I. An internal model for sensorimo-
tor integration. Science 269, 1880–1882, DOI: 10.1126/science.7569931 (1995).
13. Brown, H., Adams, R. A., Parees, I., Edwards, M. & Friston , K. Active infer-
ence, sensory attenuation and illusions. Cognitive Processing 14, 411–427, DOI:
10.1007/s10339-013-0571-3 (2013).
20
Emergence of sensory attenuation based upon the free-energ y principle
14. Friston, K. The free-energy principle: a uniﬁed brain th eory? Nature Reviews
Neuroscience 11, 127–138, DOI: 10.1038/nrn2787 (2010).
15. Adams, R. A., Shipp, S. & Friston, K. J. Predictions not co mmands: active in-
ference in the motor system. Brain Structure and Function 218, 611–643, DOI:
10.1007/s00429-012-0475-5 (2013).
16. Ahmadi, A. & T ani, J. A novel predictive-coding-inspire d variational rnn model
for online prediction and recognition. Neural Computation 31, 2025–2074, DOI:
10.1162/neco_a_01228 (2019).
17. Ohata, W . & T ani, J. Investigation of the sense of agency i n social cognition,
based on frameworks of predictive coding and active inferen ce: A simulation
study on multimodal imitative interaction. Frontiers in Neurorobotics 14:61, DOI:
10.3389/fnbot.2020.00061 (2020).
18. Inoue, K., Nakajima, K. & Kuniyoshi, Y . Designing sponta neous behav-
ioral switching via chaotic itinerancy. Science Advances 6, eabb3989, DOI:
10.1126/sciadv.abb3989 (2020).
19. Haggard, P . & Whitford, B. Supplementary motor area prov ides an efferent
signal for sensory suppression. Cognitive Brain Research 19, 52–58, DOI:
10.1016/j.cogbrainres.2003.10.018 (2004).
20. W olpe, N. et al. Ageing increases reliance on sensorimotor prediction thro ugh
structural and functional differences in frontostriatal c ircuits. Nature Communica-
tions 7, 13034, DOI: 10.1038/ncomms13034 (2016).
21. Boehme, R., Hauser, S., Gerling, G. J., Heilig, M. & Olaus son, H. Distinction of
self-produced touch and social touch at cortical and spinal cord levels. Proceedings
of the National Academy of Sciences 116, 2290, DOI: 10.1073/pnas.1816278116
(2019).
22. Eagleman, D. M. The where and when of intention. Science 303, 1144–1146, DOI:
10.1126/science.1095331 (2004).
23. Leek, E. C. & Johnston, S. J. Functional specialization i n the supplementary mo-
tor complex. Nature Reviews Neuroscience 10, 78–78, DOI: 10.1038/nrn2478-c1
(2009).
24. Y u, A. J. & Dayan, P . Uncertainty, neuromodulation, and a ttention. Neuron 46,
681–692, DOI: 10.1016/j.neuron.2005.04.026 (2005).
25. Corlett, P ., T aylor, J., W ang, X.-J., Fletcher, P . & Krys tal, J. T oward a
neurobiology of delusions. Progress in Neurobiology 92, 345–369, DOI:
10.1016/j.pneurobio.2010.06.007 (2010).
26. Pynn, L. K. & DeSouza, J. F . The function of efference copy signals: Im-
plications for symptoms of schizophrenia. V ision Research 76, 124–133, DOI:
10.1016/j.visres.2012.10.019 (2013).
21
Emergence of sensory attenuation based upon the free-energ y principle
27. Kilteni, K. & Ehrsson, H. H. Predictive attenuation of to uch and tac-
tile gating are distinct perceptual phenomena. iScience 25, 104077, DOI:
https://doi.org/10.1016/j.isci.2022.104077 (2022).
28. Kilteni, K., Houborg, C. & Ehrsson, H. H. Rapid learning a nd unlearning
of predicted sensory delays in self-generated touch. eLife 8, e42888, DOI:
10.7554/eLife.42888 (2019).
29. Palmer, C. E., Davare, M. & Kilner, J. M. Physiological an d perceptual sen-
sory attenuation have different underlying neurophysiolo gical correlates. Jour-
nal of Neuroscience 36, 10803–10812, DOI: 10.1523/JNEUROSCI.1694-16.2016
(2016). https://www .jneurosci.org/content/36/42/1080 3.full.pdf .
30. Thomas, E. R., Y on, D., de Lange, F . P . & Press, C. Action en hances predicted
touch. Psychological Science 33, 48–59, DOI: 10.1177/09567976211017505
(2022). PMID: 34878943, https://doi.org/10.1177/095679 76211017505 .
31. Powers, A. R., Mathys, C. & Corlett, P . R. Pavlovian condi tioning–induced hal-
lucinations result from overweighting of perceptual prior s. Science 357, 596–600,
DOI: 10.1126/science.aan3458 (2017).
32. Corlett, P . R. et al. Hallucinations and strong priors. T rends in Cognitive Sciences
23, 114–127, DOI: 10.1016/j.tics.2018.12.001 (2019).
33. Blakemore, S.-J. et al. T actile sensitivity in asperger syndrome. Brain and Cogni-
tion 61, 5–13, DOI: 10.1016/j.bandc.2005.12.013 (2006).
34. Lawson, R. P ., Rees, G. & Friston, K. J. An aberrant precis ion account of autism.
Front. Hum. Neurosci. 8, 302, DOI: 10.3389/fnhum.2014.00302 (2014).
35. Haker, H., Schneebeli, M. & Stephan, K. E. Can bayesian th eories of autism
spectrum disorder help improve clinical practice? Frontiers in Psychiatry 7 (2016).
36. Palmer, C. J., Lawson, R. P . & Hohwy, J. Bayesian approach es to autism: T o-
wards volatility, action, and behavior. Psychological Bulletin 143, 521–542, DOI:
10.1037/bul0000097 (2017).
37. Finnemann, J. J., Plaisted-Grant, K., Moore, J., T eufel , C. & Fletcher, P . C. Low-
level, prediction-based sensory and motor processes are un impaired in autism.
Neuropsychologia 156, 107835, DOI: 10.1016/j.neuropsychologia.2021.107835
(2021).
38. Y amashita, Y . & T ani, J. Emergence of functional hierarc hy in a multiple timescale
neural network model: A humanoid robot experiment. PLoS Comput. Biol. 4,
e1000220 (2008).
39. Y amashita, Y . & T ani, J. Spontaneous prediction error ge neration in schizophrenia.
PLoS ONE 7, e37843–e37843, DOI: 10.1371/journal.pone.0037843 (201 2).
22
Emergence of sensory attenuation based upon the free-energ y principle
40. Idei, H. et al. A neurorobotics simulation of autistic behavior induced
by unusual sensory precision. Computational Psychiatry 2, 164–182, DOI:
10.1162/CPSY_a_00019 (2018).
41. Idei, H., Murata, S., Y amashita, Y . & Ogata, T . Homogeneo us intrinsic neuronal
excitability induces overﬁtting to sensory noise: A robot m odel of neurodevelop-
mental disorder. Frontiers in Psychiatry 11:762, DOI: 10.3389/fpsyt.2020.00762
(2020).
42. Idei, H., Murata, S., Y amashita, Y . & Ogata, T . Paradoxic al sensory reactivity
induced by functional disconnection in a robot model of neur odevelopmental dis-
order. Neural Networks 138, 150–163, DOI: 10.1016/j.neunet.2021.01.033 (2021).
43. Finkelstein, A. et al. Attractor dynamics gate cortical information
ﬂow during decision-making. Nature Neuroscience 24, 843–850, DOI:
10.1038/s41593-021-00840-6 (2021).
44. Newell, K., Liu, Y . & Mayer-Kress, G. Time scales in motor learning and devel-
opment. Psychological review 108 1, 57–82 (2001).
45. Kingma, D. P . & Ba, J. Adam: A method for stochastic optimi zation (2017).
1412.6980.
46. Azouz, R. & Gray, C. M. Dynamic spike threshold reveals a m echanism for synap-
tic coincidence detection in cortical neurons in vivo . Proceedings of the National
Academy of Sciences 97, 8110–8115, DOI: 10.1073/pnas.130200797 (2000).
47. Mejias, J. F . & Longtin, A. Optimal heterogeneity for cod ing in spik-
ing neural networks. Physical Review Letters 108, 228102–1–5, DOI:
10.1103/PhysRevLett.108.228102 (2012).
Acknowledgements
This work was partially supported by an unrestricted gift fr om Google and supported
by a JSPS Grant-in-Aid (Nos. JP19J20281, JP22J01708), JST M oonshot R&D (No.
JPMJMS2031), and JST CREST grants (Nos. JPMJCR16E2, JPMJCR 21P4).
Author contributions statement
Conceptualization: HI, JT
Methodology: HI, YY , JT
Investigation: HI, WO
V isualization: HI, YY , JT
Funding acquisition: HI, YY , TO, JT
Project administration: JT
Supervision: JT
Writing – original draft: HI
23
Emergence of sensory attenuation based upon the free-energ y principle
Writing – review & editing: HI, WO, YY , TO, JT
Additional information
Data A vailability:
All data is available in the manuscript and the supplementar y information.
Code A vailability:
Computer code for the neural network model was written using Pytorch (a library for
deep learning) and is available online ( https://github.com/h-idei/pvrnn_sa.git).
Competing interests:
Authors declare that they have no competing interests.
24
Emergence of sensory attenuation based upon the free-energ y principle
Level 2 
Association area 
Error propagation 
Level 3 
Executive area 
Level 1 
Sensory areas 
Generative process 
Prediction 
KLD 
Prior belief 
Posterior belief 
Time 
Self-produced 
context 
Externally produced 
context 
Acquisition of proprioception data 
by manual robot manipulation 
a
b
Observation 
!!"#
"!$# !!$#
"!%# "!%#!!%# !!%#
# $ # $
Latent variable 
(PE-related response) 
!"#$%&'$(#)&* 
+,-.$'#/(&0)#)&*1 
2%&(%)&'$(#)&* 
+3&)*#/4*56$01 # #
!!
!"
PE 
Figure 1: Training setting. (a) Hierarchical recurrent network updating of synaptic
weights and posterior beliefs in all areas via minimization of free-energy determined by
the prediction error (PE) and Kullback-Leibler divergence (KLD) between the posterior
and the prior. (b) Spontaneous sensorimotor patterns learned by the recurren t network.
25
Emergence of sensory attenuation based upon the free-energ y principle
Object position 
a
Test data 
PID 
controller 
!"#"$%& 
'(")*+,#"%)-.+/-$ 
Level 2 
Association 
Level 1 
Exteroception 
Level 1 
Proprioception 
Joint angles 
Self-produced 
(steps 0-100) Externally 
produced 
(steps 100-200) 
Action 
Prediction & Action generation 
Inference of latent states 
!!"#
!!$#
!!%#
!
"!"#
#!"#
$% 
"!$#
#!$#
#!%#
Time step 
Solid: 
Posterior 
Dotted: 
Prior 
Extero 
Proprio 
Object 
Hand 
Solid: 
Posterior 
Dotted: 
Prior 
Extero 
Proprio 
b
c
d
e
"!%#
Figure 2: T est setting and an example of the result. (a) Online inference of latent states
and action generation by a PID controller, with synaptic wei ghts ﬁxed. (b) Executive-
level posterior distribution. (c) Association-level posterior and prior distributions. (d)
Sensory-level posterior and prior distributions in extero ceptive and proprioceptive ar-
eas. (e) Prediction error (PE) and real sensations for exteroceptio n and proprioception.
For clarity, proprioception is represented as the 2-dimens ional hand position, although
the actual proprioception comprises 3-dimensional joint a ngles.
26
Emergence of sensory attenuation based upon the free-energ y principle
High precision 
Prior > PE 
Bottom-up 
PE signal 
Low precision 
Prior < PE 
Sensory attenuation in 
self-produced context Context shift Sensory amplification in 
externally produced context 
! ! "# ! ! "$
! % "# ! % "$
! & "$
"'!(
"'%(
KLD 
KLD 
! & "#
KLD 
Neutral 
Bottom-up 
PE signal 
! ! "# ! ! "$
! % "# ! % "$
! & "$
"'!(
"'%(
KLD 
KLD 
! & "#
KLD 
Bottom-up 
PE signal 
! ! "# ! ! "$
! % "# ! % "$
! & "$
"'!(
"'%(
KLD 
KLD 
! & "#
KLD 
Neutral 
Low precision 
Low precision 
Prior < PE 
Prior < PE 
Top-down 
control 
Top-down 
control 
Top-down 
control 
Free energy 
Time step 
Figure 3: The self-organized mechanism for the transition b etween sensory attenua-
tion in self-produced contexts and sensory ampliﬁcation in externally produced con-
texts. For each sensorimotor context, a particular free-en ergy minimum in the network
was developed through learning, which was characterized by the corresponding top-
down precision control and bottom-up prediction-error (PE ) ﬂow . Consequently, in
self-produced contexts, the recurrent network mainly adju sted only the posterior in the
association area z(2),q to minimize prediction errors by increasing precision of pr iors
in sensory areas z(1),p and decreasing precision of prior in the association area z(2),p.
On the other hand, in externally produced contexts, it adjus ted posteriors in both sen-
sory and association areas ( z(1),q and z(2),q) by decreasing precision of priors in both
sensory and association areas. The shift of the sensorimoto r context triggered modu-
lation of the posterior in the executive area z(3),q as well as the transition from one
free-energy state to another in the network (bottom time ser ies). This induced a quali-
tative change in the network behavior and a shift between att enuating and amplifying
prediction-error-induced responses in sensory areas. The black line in the time series
of the free-energy describes the 20-step moving average (va lues within the ﬁrst 19
steps are calculated as averages from the initial to the curr ent step). The red line is the
average over the ﬁrst 100 steps, i.e., self-produced contex t, or the last 100 steps, i.e.,
externally produced context. V alues are averages over 80 te st trials performed by 10
different networks.
27
Emergence of sensory attenuation based upon the free-energ y principle
Learning epoch ( !5000) 
Context 
Response of ! ! "#
Level of " ! "$
Self-produced Externally produced 
0.0 
0.1 
0.2 
0.3 
0.4 
0.5 
0.6 
0.7 
0.8 
!! 
!"#$%&'()*+") ,-."'/0##12&'()*+") 
343 
345 
346 
347 
348 
349 
34: 
34; 
34< 
Context 
Learning epoch ( !5000) 
a b
c d
Response of ! ! "#
1.0 
0.0 
0.5 
0 10 20 30 40 
2
0
1
Level of " ! "$
0 10 20 30 40 
!! 
Solid: Extero, Dotted: Proprio 
Self-produced context 
Externally produced context 
Figure 4: Sensory-level neural response in the test phase an d its development in the
learning phase. (a) Box-and-whiskers plots showing the difference in sensory- level
posterior response between self-produced and externally p roduced contexts. (b) Box-
and-whiskers plots showing the difference in the sensory-l evel prior sigma between the
two contexts. In (a) and (b), each plot is an average of 100 tim e steps, 2 sensory areas,
and 8 test trials by each of 10 trained networks (center line, median; cross, mean; box
limits, upper and lower quartiles; whiskers, 1.5x interqua rtile range). ** p < 0.01. (c)
Development of the posterior response for the two contexts i n the exteroceptive and
proprioceptive areas. (d) Development of sensory-level prior sigma. In (c) and (d), th e
value is averaged over 200 time steps, 24 training datasets, and 10 different networks
in each learning epoch.
28
Emergence of sensory attenuation based upon the free-energ y principle
Supplementary Figures:
Time 
! "!
#!
!
!!
$!
! "#
#$
! #%
!
$$
! "& $$
! "#
! "$ ! "%
!$ !%
$!
! "&
#!
$ #$
$
#%
$
$%
! "& $%
! "#
$!
$ "# $$
$ "& $$
$ "#$!
$ "& $%
$ "& $%
$ "#
$!
% "# $$
% "#$!
% "& $%
% "#
0
0
!!! 
!!! 
!!! 
!!! 
!!! 
0
Level 3: 
Executive area 
Level 2: 
Association area 
Level 1: 
Sensory area 
Prediction 
Observation 
KLD 
1 2 3
PE 
Error propagation 
Generative process 
KLD 
KLD KLD 
KLD KLD 
KLD 
Supplementary Figure S 1: T emporal processing of the recurr ent neural network. In
the learning phase, the recurrent network updates the poste riors of latent variables in all
areas ( z(1),q
1:T , z(2),q
1:T , and z(3),q
1 ) and time-constant synaptic weights via minimization
of free-energy over the time length (T) of training data. Ini tial deterministic states d0
in all areas are set to 0. The initial prior distribution zp
1 in the executive area is set to a
unit Gaussian distribution N (0, 1). For simplicity, the distributed structure of sensory
areas is omitted. PE: Prediction error. KLD: Kullback-Leib ler divergence between the
posterior and the prior of latent variable.
29
Emergence of sensory attenuation based upon the free-energ y principle
Time 
tt-H t–H+1 t–H+2 
!!! 
!!! 
!!! 
!!! 
!!! 
! ! "# ! ! "# ! ! "#
! $ "% ! $ "# ! $ "% ! $ "# ! $ "% ! $ "#
"&$' "&$'
"&$'
! ( "% ! ( "# ! ( "% ! ( "# ! ( "% ! ( "#
"&(' "&(' "&('
# $ # $ # $
# # #
Supplementary Figure S 2: Online inference in the test phase . The recurrent network
updates the posterior ( z(1),q
t− H+1:t, z(2),q
t− H+1:t, and z(3),q
t− H+1) via minimization of the
free-energy over a certain time window (H). Synaptic weight s are ﬁxed. For simplicity,
the distributed structure of sensory areas is omitted.
30
Emergence of sensory attenuation based upon the free-energ y principle
! ! "#
Probability 
a
Learning epoch = 0 Learning epoch = 10000 Learning epoch = 50000 
Learning epoch = 100000 Learning epoch = 200000 
Self-produced context 
Externally produced context 
d
Response of ! $ "#
0 10 20 30 40 0 10 20 30 40 
2
0
1
1.0 
0.5 
0.0 
Difference of 
contexts in ! ! "#
Learning epoch ( !5000) Learning epoch ( !5000) 
Self-produced context
Externally produced context
0 10 20 30 40 
2
0
1
Level of " $ "%
Learning epoch ( !5000) 
b c
Learning epoch = 150000 
Supplementary Figure S 3: Development of higher-level late nt variables. (a-b) De-
velopment of a posterior response and a prior sigma in the ass ociation area. At each
learning epoch, the value is averaged over 200 time steps, 24 training datasets, and
10 networks. (c) Development of the difference between self-produced conte xts and
externally produced contexts in the executive area. In the l earning phase, the recur-
rent network developed a posterior state in the executive ar ea for each of 48 training
datasets (24 for self-produced contexts and 24 for external ly produced contexts). The
ﬁgure shows the distance between median values of posterior states for self-produced
and externally produced contexts. At each learning epoch, t he value is averaged over
10 networks. (d) An example of development of the executive-level posterior . Each
ﬁgure shows the distribution of 24 executive-level posteri or states corresponding to
self-produced or externally produced contexts. The ﬁgure s hows that recognition of
different sensorimotor experiences was gradually develop ed through a learning pro-
cess. Note that we did not provide any explicit label indicat ing the difference between
the two contexts.
31
Emergence of sensory attenuation based upon the free-energ y principle
Number of association-level 
latent neurons 
1 2 3
-0.1 
0.0 
0.1 
0.2 
0.3 
0.4 
0.5 
0.6 
0.7 
0.8 
b
! "
#!$" 
!$! 
!$" 
!$% 
!$& 
!$' 
!$( 
!$) 
!$* 
!$+ 
Number of executive-level 
latent neurons 
Attenuation level 
a
Supplementary Figure S 4: Neural-response attenuation var ying with the number of
latent neurons. The attenuation level was calculated by sub tracting the sensory-level
posterior response in a self-produced context from that in a n externally produced con-
text while reproducing training data. V alues were for 10 tra ined networks with differ-
ent initial synaptic weights. (a) A larger number of association-level latent neurons
led to a larger attenuation level, suggesting that represen ting sensorimotor correlation
required enough association-level latent neurons. (b) When there were no executive-
level latent neurons, the attenuation level was greatly red uced. This suggests the impor-
tance of executive-level control for sensory attenuation. In (a) and (b), the setting of 3
association-level and 1 executive-level latent neurons wa s the same baseline model.
32
Emergence of sensory attenuation based upon the free-energ y principle
a E
Response of ! ! "#
0 10 20 30 40 
Learning epoch ( !5000) 
Level of " ! "$
Learning epoch ( !5000) 
0 10 20 30 40 
Learning epoch ( !5000) 
0 10 20 30 40 
Response of ! ! "#
c
Learning epoch ( !5000) 
0 10 20 30 40 
Level of " ! "$
d
1.0 
0.5 
0.0 
1.0 
0.5 
0.0 
2
0
1
2
0
1
Small 
! ! " #$##% 
Large 
! ! " #$#&' 
Solid: Extero, Dotted: Proprio 
Self-produced context 
Externally produced context 
b
Supplementary Figure S 5: Effects of shifts in the meta-prio r in sensory areas. (a-b)
Development of a sensory-level posterior response and prio r sigma through learning
in a small sensory-level meta-prior setting ( W (1) = 0.001, W (2) = W (3) = 0.005),
described as in Fig. 4c-d. A small sensory-level meta-prior led to reduced attenuation
of the sensory-level posterior response, as well as the sens ory-level prior sigma, in
the self-produced context. (c-d) Development of a sensory-level posterior response
and a prior sigma in a large sensory-level meta-prior settin g ( W (1) = 0.025, W (2) =
W (3) = 0.005). A large sensory-level meta-prior led to highly reduced se nsory-level
posterior responses in both self-produced and externally p roduced contexts.
33
Emergence of sensory attenuation based upon the free-energ y principle
Learning epoch ( !5000) 
0 10 20 30 40 
Response of ! ! "#Response of ! ! "#
0 10 20 30 40 
Learning epoch ( !5000) 
Small 
! ! " #$##% 
2
0
1
Learning epoch ( !5000) 
0 10 20 30 40 
Level of " ! "$Level of " ! "$
Learning epoch ( !5000) 
0 10 20 30 40 
a b
c d
Large 
! ! " #$#&' 
1.0 
0.5 
0.0 
1.0 
0.5 
0.0 
2
0
1
Solid: Extero, Dotted: Proprio 
Self-produced context 
Externally produced context 
Supplementary Figure S 6: Effects of shifts in the meta-prio r in the association area. (a-
b) Development of a sensory-level posterior response and prio r sigma through learning
in a small association-level meta-prior setting ( W (2) = 0.001, W (1) = W (3) = 0.005),
described as in Fig. 4c-d. A small association-level meta-p rior did not have a large im-
pact on development of sensory attenuation. (c-d) Development of a sensory-level
posterior response and a prior sigma in a large association- level meta-prior setting
(W (2) = 0.025, W (1) = W (3) = 0.005). A large association-level meta-prior led
to reduced attenuation of the sensory-level posterior resp onse, as well as the sensory-
level prior sigma, in the self-produced context.
34
Emergence of sensory attenuation based upon the free-energ y principle
a
Level of ! ! "#
Learning epoch ( !5000) 
Response of " ! "$
0 10 20 30 40 
1.0 
0.5 
0.0 
b
Learning epoch ( !5000) 
0 10 20 30 40 
d
Level of ! ! "#
2
0
1
Response of " ! "$
c
0 10 20 30 40 
Learning epoch ( !5000) 
1.0 
0.5 
0.0 
Learning epoch ( !5000) 
0 10 20 30 40 
2
0
1
Small 
! ! " #$##% 
Large 
! ! " #$#&' 
Solid: Extero, Dotted: Proprio 
Self-produced context 
Externally produced context 
Supplementary Figure S 7: Effects of shifts in the meta-prio r in the executive area. (a-
b)Development of a sensory-level posterior response and prio r sigma through learning
in a small executive-level meta-prior setting ( W (3) = 0.001, W (1) = W (2) = 0.005),
described as in Fig. 4c-d. (c-d) Development of a sensory-level posterior response
and a prior sigma in a large executive-level meta-prior sett ing ( W (3) = 0.025, W (1) =
W (2) = 0.005). Neither small nor large executive-level meta-priors had a large impact
on development of the sensory-level posterior response or t he prior sigma.
35
Emergence of sensory attenuation based upon the free-energ y principle
Prediction error 
a c
!"!!# !"!!$% !"!!% !"!# !"!$% 
!"!!! 
!"!!$ 
!"!!& 
!"!!' 
!"!!( 
!"!#! 
!"!#$ 
!"!#& 
!"!#' 
!"!#( 
! !
!"!!# !"!!$% !"!!% !"!# !"!$% 
!"!!! 
!"!!$ 
!"!!& 
!"!!' 
!"!!( 
!"!#! 
!"!#$ 
!"!#& 
!"!#' 
!"!#( 
! "
Prediction error 
!"!!# !"!!$% !"!!% !"!# !"!$% 
!"!! 
!"!# 
!"!$ 
!"!) 
!"!& 
!"!% 
!"!' 
Free energy 
b
!"!!# !"!!$% !"!!% !"!# !"!$% 
!"!! 
!"!# 
!"!$ 
!"!) 
!"!& 
!"!% 
!"!' 
Free energy 
! ! ! "
d
Supplementary Figure S 8: Training results. (a-b) Prediction error and free-energy
for training data under each meta-prior setting in sensory a reas ( W (2) = W (3) =
0.005). A small sensory-level meta-prior led to decreases in the p rediction error and
free-energy, although development of sensory attenuation was disrupted. (c-d) The
prediction error and free-energy for training data under ea ch meta-prior setting in the
association area ( W (1) = W (3) = 0.005). In (a)-(d), the setting of W (1) = W (2) =
W (3) = 0.005 was the same baseline model.
36
Emergence of sensory attenuation based upon the free-energ y principle
Number of deterministic neurons 
Attenuation level 
Timescale property 
a b
10 15 20 
-0.1 
0.0 
0.1 
0.2 
0.3 
0.4 
0.5 
0.6 
0.7 
0.8 
!"#$%& '(%)"*%& 
+,-. 
,-, 
,-. 
,-/ 
,-0 
,-1 
,-2 
,-3 
,-4 
,-5 
Supplementary Figure S 9: Neural-response attenuation var ied with settings of deter-
ministic neurons. The attenuation level was calculated by s ubtracting the sensory-level
posterior response in the self-produced context from that i n the externally produced
context while reproducing training data. V alues were for 10 trained networks with dif-
ferent initial synaptic weights. (a) A recurrent network with 15 deterministic neurons
showed the largest average (and median) attenuation level. (b) Multiple timescale set-
tings ( τ = 2 for 8 neurons and τ = 4 for 7 neurons) increased the attenuation level
compared to the single timescale setting ( τ = 2 for all deterministic neurons). In (a)
and (b), the setting of 15 deterministic neurons and multipl e timescale property was the
same as the baseline model.
37
Emergence of sensory attenuation based upon the free-energ y principle
Caption for Supplementary Video:
Supplementary V ideo S1. Robot behavior and neural response s in the baseline model.
Related to Fig. 2b-e. Red and blue crosses in the left image in dicate predicted positions
of the external object and robot hand, respectively.
38