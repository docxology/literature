An active inference implementation of phototaxis∗
Manuel Baltieri, Christopher L. Buckley
Evolutionary and Adaptive Systems Group, Department of Informatics,
University of Sussex, Brighton, UK
m.baltieri@sussex.ac.uk
Abstract
Active inference is emerging as a possible unifying theory of
perception and action in cognitive and computational neuro-
science. On this theory, perception is a process of inferring
the causes of sensory data by minimising the error between
actual sensations and those predicted by an inner generative
(probabilistic) model. Action on the other hand is drawn as a
process that modiﬁes the world such that the consequent sen-
sory input meets expectations encoded in the same internal
model. These two processes, inferring properties of the world
and inferring actions needed to meet expectations, close the
sensory/motor loop and suggest a deep symmetry between
action and perception. In this work we present a simple
agent-based model inspired by this new theory that offers in-
sights on some of its central ideas. Previous implementations
of active inference have typically examined a “perception-
oriented” view of this theory, assuming that agents are en-
dowed with a detailed generative model of their surround-
ing environment. In contrast, we present an “action-oriented”
solution showing how adaptive behaviour can emerge even
when agents operate with a simple model which bears little
resemblance to their environment. We examine how various
parameters of this formulation allow phototaxis and present
an example of a different, “pathological” behaviour.
Introduction
Brains must operate in an uncertain world, with noisy sen-
sors that provide only incomplete and often ambiguous in-
formation. Recent developments in cognitive and compu-
tational neuroscience have suggested that the brain meets
this challenge by operating as a Bayesian inference ma-
chine. This idea is usually traced back to work by Helmholtz
(V on Helmholtz, 1867) and his theory of unconscious infer-
ence. On this view, perception is cast as an ongoing pro-
cess of updating an inner generative model so that it can
best recapitulate (or “predict”) noisy and ambiguous incom-
ing sensory input and thus infer the hidden (i.e. not directly
accessible by the brain) causes of such data (Dayan et al.,
1995; Rao and Ballard, 1999; Knill and Pouget, 2004; Fris-
∗This work is licensed to the public under a Creative Commons
Attribution- NonCommercial-NoDerivatives 4.0 license (interna-
tional): http://creativecommons.org/licenses/by-nc-nd/4.0/
ton et al., 2006; Clark, 2013; Hohwy, 2013; Bogacz, 2015;
Buckley et al., 2017).
Predictive Coding models represent one concrete instan-
tiation of this inferential process and have been used, for
instance, to account for the neural dynamics underlying per-
ception in the visual cortex (Rao and Ballard, 1999). These
ideas have been signiﬁcantly extended by the Free Energy
Principle (FEP) (Friston et al., 2006; Friston, 2010), which
also provides a mechanistic account of action within the
same framework. Speciﬁcally, under the FEP, while per-
ception (“perceptual inference”) is a process of updating an
inner model to best account for sensory data, actions change
the world to make sensory input better accord with predic-
tions made by the same model (“active inference”). It has
been suggested that the interplay between these two pro-
cesses acting to satisfy a generative model that encodes con-
straints (“priors”) conducive to an agent’s survival can form
the foundations of adaptive behaviour (Friston et al., 2012).
The vast majority of models implemented using this
framework have assumed that agents are endowed with a
detailed generative model of their surrounding environment.
These “perception-oriented” approaches subordinate motor
actions to the accurate and comprehensive perception of the
environmental causes of sensory data (Hohwy, 2013) and
thus have often brought the FEP and active inference into di-
rect conﬂict with more enactivist views of cognition (Clark,
2015; Bruineberg et al., 2016; Allen and Friston, 2016). In
contrast, others have suggested that complex adaptive be-
haviour could emerge from the interplay between an agent
acting on the basis of simpler, more frugal generative models
and the environment (Clark, 2015). This “action-oriented”
perspective could underpin a more ecological and embod-
ied reading of the FEP (Seth, 2014; Clark, 2015; Bruineberg
et al., 2016; Allen and Friston, 2016).
In this work we show an example of a simple wheeled
agent performing phototaxis under active inference and
present it as a proof of principle of an “action-oriented”
reading on the FEP. We also examine how phototaxis de-
pends on various parameters settings and how this could be
used as a generic model of different emergent behaviours.
arXiv:1707.01806v1  [q-bio.NC]  6 Jul 2017
The Free Energy Principle (FEP) and Active
Inference
Bayesian accounts of perception hold that a central goal of
agentive systems is to infer the hidden environmental causes
of sensory data (Knill and Pouget, 2004). Formally, this can
be written as a process of Bayesian inference in terms of the
causes xof sensory input ρ:
P(x|ρ) =P(ρ|x)P(x)
P(ρ) (1)
where P(x|ρ) is the posterior probability of hidden causesx
given observed sensory dataρ. P(ρ|x) is the likelihood, cor-
responding to the organism’s assumptions about how sen-
sory input ρrelates to hidden causes x. P(x) is the prior,
encoding the agent’s “beliefs” about hidden causes before it
receives ρ and P(ρ) is the marginal likelihood, a normali-
sation factor obtained by marginalising P(ρ|x) over all pos-
sible causes x. To calculate the posterior probability it is
necessary to evaluate the marginal likelihood (also called
“surprisal”, Friston (2010)) P(ρ), which is often difﬁcult
if not practically intractable (Bishop, 2006; Buckley et al.,
2017). Variational Free Energy represents an approximate
technique for Bayesian inference (Bishop, 2006) that has
been argued to be compatible with a neurally plausible im-
plementation of this Bayesian scheme (Friston, 2008). The
method involves optimising an auxiliary probability density
Q(x), referred to as arecognition density, so that it becomes
a good approximation of the posterior P(x|ρ). This can be
achieved by minimising a measure of the difference between
these two densities, quantiﬁed as the Kullback-Leibler (KL)
divergence (Kullback and Leibler, 1951)
DKL(Q(x)||P(x|ρ)) =
∫
Q(x) ln Q(x)
P(x|ρ)dx (2)
and while we cannot evaluate this expression directly since
it still involves the unknown posterior, we can rewrite it as
DKL(Q(x)||P(x|ρ)) =F + lnP(ρ) (3)
where we deﬁned the “variational free energy” as
F ≡
∫
Q(x) ln Q(x)
P(x,ρ)dx (4)
Unlike equation (2), the free energy F can be evaluated be-
cause it only involves the recognition density, which we are
free to specify, and a model of the world dynamics in terms
of a prior and a likelihood which we assume an agent has, i.e.
P(x,ρ) =P(ρ|x)P(x). The second term on the right-hand
side in equation (3) is independent of the recognition density
Q(x) (it only depends on sensory input ρ). Thus, minimis-
ing equation (4) with respect to Q(x) will minimise the KL
divergence between the recognition density and the true pos-
terior. The result of this minimisation will make Q(x) ap-
proach the true posteriorP(x|ρ). Optimising free energy for
arbitrary recognition densities can be complex, so a common
assumption is to restrict the form ofQ(x) to a tightly peaked
Gaussian distribution, i.e. the Laplace approximation (Fris-
ton et al., 2006, 2008; Bogacz, 2015; Buckley et al., 2017).
Variablesxare then replaced by parameters µx representing
the ﬁrst order sufﬁcient statistics (i.e. the mean(s)) of this
Gaussian distribution. Effectively, µx represent a parametri-
sation of an agent’s beliefs or best guesses of the most likely
causes x. It can be shown (Friston et al., 2008; Bogacz,
2015; Buckley et al., 2017) that under these assumptions the
free energy term simpliﬁes to
F = −ln P(ρ,µx) +constants (5)
where P(ρ,µx) = P(ρ|µx)P(µx) is the generative den-
sity comprising of a likelihood P(ρ|µx) and a prior P(µx)
in terms of parametrised beliefs about hidden causes µx.
In sum, changing beliefs µx to minimise the free en-
ergy F, constrained by sensory data ρ, makes µx the best
guess/estimate of hidden causes x.
Under this framework it is suggested that perception is
implemented as the minimisation of free energy with respect
to beliefs µx following a gradient descent scheme:
˙µx = −∂F
∂µx
(6)
This equation updates µx and converges when the minimum
of the free energy F is reached, i.e. when ∂F
∂µx
= 0.
In contrasts to perception, action is deﬁned as a process
of changing the world such that sensory data better accords
with predictions of the generative model (Fig. 1b). Speciﬁ-
cally, in terms of the formalism presented above, while per-
ception minimises the ﬁrst term of equation (3), action opti-
mises the second one by updating sensations ρ. To achieve
this, an agent must know (or at least have an approximation
of) how ρdepend on motor action a(i.e. ρ = f(a)) (Fris-
ton et al., 2010; Buckley et al., 2017). Given this, action
can similarly be cast as a gradient descent on the free energy
with respect to the variable a
˙a= −∂F
∂a = −∂F
∂ρ
∂ρ
∂a (7)
Thus action and perception can be described as the min-
imisation of the same quantity, with the simultaneous
implementation of both processes closing the action-
perception loop.
The Model
To present some of the core ideas behind the FEP and active
inference we implement phototaxis on a simple wheeled ve-
hicle. We simulate an agent with circular body, 2 noisy light
sensors and 2 noiseless motors, see Fig. 1a. For simplic-
ity we do not simulate occlusion of the light source by the
agent’s body.
(a)
(b)
Figure 1: (a) The wheeled vehicle used in our simula-
tions. The agent receives input from two exteroceptors read-
ing light intensity ( ρl1 ,ρl2 ) and two proprioceptors reading
wheel velocity (ρm1 ,ρm2 ). Variables µl1 ,µl2 ,µm1 ,µm2 are
part of the generative model of the agent. The red lines rep-
resent the relations between the agent’s prior beliefs on the
dynamics of the world, very distant from how the real dy-
namics work. (b) A schematic of the FEP. Two types of
sensations, exteroceptive (light intensity,ρl) and propriocep-
tive (motor velocity, ρm), represent the sensory input of the
agent (blue arrows). Beliefs on causes µl and µm are up-
dated (red arrows) within the generative model through per-
ception. The dashed red arrow denotes the lack of update of
the generative model due to proprioceptive prediction errors,
necessary for phototaxis. This update is introduced later on
to show “pathological behaviour”. Action asolves the dis-
crepancy between predictions of the generative model and
sensations from the world by engaging with the latter.
In previous agent-based simulations of the FEP it is typ-
ically assumed that an agent possesses a rich and detailed
model of its environment (see for example Friston et al.
(2010)). For instance if we were to take this approach
here, we would perhaps start by assuming that the agent
has a representation of the locations of both itself and the
light source. However a more action-oriented interpretation
of the FEP suggests that adaptive behaviour could emerge
from generative models that are more frugal and parsimo-
nious (Seth, 2014; Clark, 2015; Bruineberg et al., 2016;
Allen and Friston, 2016). To examine this, we endow our
agent with a minimal model of its surrounding environ-
ment. Speciﬁcally, our agent receives four inputs: two from
exteroceptors sensitive to light ρl1 ,ρl2 and two from pro-
prioceptors ρm1 ,ρm2 sensing motor velocity, see Fig. 1a.
We then assume that it only models four hidden causes
x = {l1,l2,m1,m2}, one for each input, parametrised by
beliefs µx = {µl1 ,µl2 ,µm1 ,µm2 }. In table 1 we list the
variables used in our model.
Variable Meaning
ρ Set of sensory inputs
{ρl1 ,ρl2 ,ρm1 ,ρm2 }
ρl1 ,ρl2
Readings of luminance from
sensors 1 and 2 (exteroceptors)
ρm1 ,ρm2
Readings of velocity from mo-
tors 1 and 2 (proprioceptors)
µx
Set of parametrised beliefs on
causes x{µl1 ,µl2 ,µm1 ,µm2 }
µl1 ,µl2
(Parametrised) Beliefs about ex-
teroceptive sensory readings
µm1 ,µm2
(Parametrised) Beliefs about
proprioceptive sensory readings
z,w
Gaussian noise representing un-
certainty of the agent on sensory
input and beliefs about the input,
respectively
Table 1: Variables used in our deﬁnition of the generative
model.
To specify the agent’s generative density (equation (5))
P(ρ,µx) = P(ρ|µx)P(µx) we must ﬁrst introduce a like-
lihood, P(ρ|µx) and a prior P(µx) in terms of the agent’s
beliefs µx. In order to do so we ﬁrst deﬁne a model of how
exteroceptive sensations (light intensity) are generated ac-
cording to the agent:
ρl1 = µl1 + zl1 , ρ l2 = µl2 + zl2 , (8)
and similarly for the proprioceptors, representing readings
of the velocity of each motor:
ρm1 = µm1 + zm1 , ρ m2 = µm2 + zm2 (9)
where we have assumed sensory reading are linearly
related to their causes, with some additive zero-mean
Gaussian noise z = {zl1 ,zl2 ,zm1 ,zm2 } with variance
σ2
z = {σ2
zl1
,σ2
zl2
,σ2
zm1
,σ2
zm2
}. The agent’s priors on
hidden causes are then speciﬁed in terms of the relation
P(µm,µl) = P(µm|µl)P(µl), with variables µm1 ,µm2
only depending on µl1 ,µl2 . We then write a model of the
priors as:
µm1 = µl2 + wm1 , µ m2 = µl1 + wm2 (10)
where w= {wm1 ,wm2 }is some zero-mean Gaussian noise
with variance σ2
w = {σ2
wm1
,σ2
wm2
}. Effectively, we de-
scribe the underlying dynamics in terms of a contralateral re-
lationship between beliefs about sensors µl and motors µm.
As we will see, this beliefs’ structure makes our agent func-
tionally consistent with Braitenberg vehicle 2b, the “aggres-
sor” (Braitenberg, 1986). We also assume uniform priors
on beliefs about exteroceptors P(µl), thus eliminating them
from our formulation.
Under the assumption that random variables
z are Gaussian with zero mean, N(0,σ2) =
1/
√
2πσ2 exp (−z2/(2σ2)), by rewriting them as
zl1 = ρl1 −µl1 , z l2 = ρl2 −µl2 (11)
zm1 = ρm1 −µm1 , z m2 = ρm2 −µm2 (12)
we can deﬁne the likelihood functions as
P(ρl|µl) = 1√
2πσ2zl
exp
(
−(ρl−µl)2
(2σ2zl )
)
P(ρm|µm) = 1√
2πσ2zm
exp
(
−(ρm−µm)2
(2σ2zm )
)
(13)
where l = {l1,l2}and m = {m1,m2}. Similarly, with
Gaussian noise wthe priors become
P(µm1 |µl2 ) = 1√
2πσ2wm1
exp
(−(µm1 −µl2 )2
(2σ2wm1
)
)
P(µm2 |µl1 ) = 1√
2πσ2wm2
exp
(−(µm2 −µl1 )2
(2σ2wm2
)
)
(14)
As a result of the assumption for bothzand wto be Gaus-
sian, the free energy reduces to (without any constant):
F = 1
2
(∑
iπzi (ρi −µi)2 + πwm1 (µm1 −µl2 )2 +
+πwm2 (µm2 −µx1 )2 + ∑
iln πzi + ∑
jln πwj
)
(15)
with i∈{l1,l2,m1,m2}and j ∈{m1,m2}and where πzi
and πwj are the inverse variances of noise terms zi and wj
respectively, also called “precisions”. Precision parameters
weight predictions errors based on the agent’s conﬁdence on
a certain belief. High precisions imply low variances and
thus high conﬁdence, and vice versa. These parameters al-
low for different emphases on the minimisation of free en-
ergy, for example an agent could focus more on predictions
weighted by πwj or rely more on sensations from the envi-
ronment when πzi are large. Some of the implications of
this weighting mechanism will be developed in more detail
for this model with our simulations.
With the expression for the free energy we can now derive
the equations that will implement perception (equation (6)):
˙µl1 = −k
(
πzl1
(µl1 −ρl1 ) +πwm2 (µl1 −µm2 )
)
˙µl2 = −k
(
πzl2
(µl2 −ρl2 ) +πwm1 (µl2 −µm1 )
)
˙µm1 = −k
(
πzm1 (µm1 −ρm1 ) +πwm1 (µm1 −µl2 )
)
˙µm2 = −k
(
πzm1 (µm2 −ρm2 ) +πwm2 (µm2 −µl1 )
)
(16)
and action (equation (7)):
˙a1 = −k
(
πzm1 (ρm1 −µm1 )∂ρm1
∂a1
+
+πzm2 (ρm2 −µm2 )∂ρm2
∂a1
)
˙a2 = −k
(
πzm1 (ρm1 −µm1 )∂ρm1
∂a2
+
+πzm2 (ρm2 −µm2 )∂ρm2
∂a2
)
(17)
where kis the learning rate used for the gradient descent.
To implement action according to equation (7) we must
ﬁrst deﬁne the partial derivative ∂ρ/∂a to implement the
agent’s model of the relationship between actions and per-
cepts. Here we assume that actions ( a1,a2) can only in-
ﬂuence proprioceptive sensations ρm1 ,ρm2 . As explained
in Friston et al. (2010), active inference dispenses the tra-
ditional notion of forward/inverse models for motor control
in favour of a more general generative (forward) model in-
verted through Bayesian inference. In this framework, in-
verse models are thought to be implicitly encoded in pre-
dictions about proprioceptive consequences that are imple-
mented through simple reﬂex arcs thought to be embodied
in an agent. In our model the inverse model corresponds to
the partial derivatives ∂ρ/∂a’s, encoded as
[∂ρm1
∂a1
∂ρm2
∂a1
∂ρm1
∂a2
∂ρm2
∂a2
]
=
[1 0
0 1
]
(18)
to specify at a proprioceptive level cross relations between
sensors and motors. Motor reﬂex arcs are implemented with
the assumption that each motor takes as an input one of the
actions produced through the minimisation of free energy
v1 = a1, v 2 = a2. (19)
where v1,v2 are the actual motor velocities of the vehicle.
Simulations
Phototaxis
The behaviour of agents operating under the FEP can be
shown to depend on the value of precision parameters. In
our ﬁrst simulation we adjust the precisions to implement
phototaxis. Priors in the generative model implement linear
−60 −40 −20 0 20 40 60
0
10
20
30
40
50
60
70
Trajectory
(a)
0
50
100
150
200Luminance
Exteroceptor ρl1 , /uni03BCl1
Sensory reading ρl1
Belief about sensory reading /uni03BCl1
0.0 0.5 1.0 1.5 2.0 2.5 3.0
Time (s)
0
50
100
150
200Luminance, Motor velocity
Beliefs /uni03BCl1 , /uni03BCμ2
Belief about sensory reading /uni03BCl1
Belief about motor reading /uni03BCμ2 (b)
0.000 0.025 0.050 0.075 0.100 0.125 0.150 0.175 0.200
Time (s)
0
2000
4000
6000
8000
10000
12000
Free Energy (c)
−60 −40 −20 0 20 40 60
10
20
30
40
50
60
70
Trajectory
(d)
0
20
40
60Luminance
Exteroceptor ρl1 , /uni03BCl1
Sensory reading ρl1
Belief about sensory reading /uni03BCl1
0.0 0.5 1.0 1.5 2.0 2.5 3.0
Time (s)
0
20
40
60Luminance, Motor velocity
Beliefs /uni03BCl1 , /uni03BCμ2
Belief about sensory reading /uni03BCl1
Belief about motor reading /uni03BCμ2 (e)
0.000 0.025 0.050 0.075 0.100 0.125 0.150 0.175 0.200
Time (s)
0
10000
20000
30000
40000
50000
60000
70000
Free Energy (f)
Figure 2: First row: Phototaxis under the FEP/Active Inference. (a) Trajectory of the vehicle over 5 seconds of simulation.
The red dot represents the initial position (with orientation parallel to the vertical axis), the yellow circle is the light source. (b)
Inference of belief µl1 about sensory input ρl1 . (c) Coupling of belief on left sensor µl1 with belief on right motor µm2 . (d)
Free energy over the ﬁrst 0.2 seconds. The vehicle performs phototaxis akin to Braitenberg vehicle 2b, by accelerating close to
the light. However the free energy (only shown for the agent describing the blue trajectory) is minimised long before (≈0.05s)
this agent gets close to the light source (≈2s), since the generative model only encodes conditions on sensory-motor coupling
(e.g. no speciﬁcation of a light level as a target). The only requirement for this agent is to fulﬁll the coupling between sensors
and motors speciﬁed by its generative model.
Second row: Example of “pathological” behaviour under the FEP/Active Inference (akinesia). Same layout as above.
Here movements are inhibited (Fig. 2d) by high precisions on proprioceptive prediction errors and low precisions on the priors.
This prevents the appropriate coupling between beliefs about sensors and motors necessary for phototaxis (Fig. 2e bottom).
Each row shows the simulation of 10 different vehicles with random initial conditions (position and orientation of the
agent). We also added Gaussian noise to each precision parameter (mean varying up to ±20% of the value of each precision
parameter, variance 1) to conﬁrm the robustness of the solution.
contralateral relations between beliefs µl and µm (see equa-
tion (10)). In this setup, our agent needs to accurately infer
µl from its readings on luminance ρl (Fig. 2b top). Beliefs
µl are then mapped to beliefs about proprioceptive inputµm
(Fig. 2b bottom) and projected to the motors via fast (instan-
taneous in our simulations) reﬂex arcs, i.e. ρm = µm. To do
so, precisions on proprioceptive sensations (πzm ) need to be
much lower relatively to those on the priors ( πwm ), in turn
smaller than the precisions on exteroceptors (πzl ).
This enables the sensory-motor ﬂow we described: 1) in-
ference of exteroceptive sensations, 2) coupling between be-
liefs about light levels and motor velocities and 3) actuation
of the motors based on the agent’s beliefs about propriocep-
tive input (dictated by the light intensity). In table 2 we
show how the the formulation of perception and action set
out in equation (16) and equation (17) respectively is sim-
pliﬁed by these assumptions in the left-sensor/right-motor
relation, {µl1 ,µm2 }(the same goes for {µl2 ,µm1 }).
Fig. 2a shows the “aggressor-like” behaviour of our agent,
which speeds up close to the light and slows down away
from it. At the beginning of our simulation we initialise
all beliefs to zero. Fig. 2c shows how, after a brief tran-
sient due to these initial conditions, the free energy rapidly
approaches a minimum value exhibiting ﬂuctuations only
driven by noise on exteroceptive input. This minimum is
reached in less than 0.1 seconds even though it takes the
agent ≈2 seconds to reach the light, see Fig. 2b top. This is
because the generative model we deﬁne does not encode ex-
plicit priors on light levels and thus does not specify a target
luminance. Instead the agent minimises free energy by sim-
ply satisfying a mapping between beliefs about light levels
and motor velocities. Phototaxis emerges as a consequence
of the relationships between beliefs µl and µm, not because
of an explicitly encoded goal. We will come back to this
idea in the discussion.
Pathological behaviour
The sensitivity of behaviour to precisions has been used
extensively to develop hypotheses and computational mod-
els for phenomena including for instance psychosis and
schizophrenia (Adams et al., 2013; Friston et al., 2016), sen-
sory attenuation (Brown et al., 2013) and attention (Feldman
and Friston, 2010). Here we present an interpretation of the
role of precisions for our agent inspired by these accounts.
If the balance of precisions on proprioceptive inputs πzm
and on priors πwm is altered, with an increase of the for-
mer and a decrease of the latter, the behaviour of our vehicle
is severely affected by the change. The sensory-motor ﬂow
necessary for phototaxis is disrupted and while the agent still
infers light levels through µl (Fig. 2e top), these beliefs are
not mapped to µm (Fig. 2e bottom) since the agent’s preci-
sions about their relation πwm are dominated by precisions
on proprioceptive input πzm (equation II in table 2).
This behaviour is consistent with interpretations under the
FEP of motor control disorders where movements are lim-
ited (hypokinesia) or entirely absent (akinesia) (Brown et al.,
2013). In active inference terms, decreasing proprioceptive
prediction errors precisions,πzm in our case, is thought to be
a necessary condition to actuate motor commands (Brown
et al., 2013). Failing to reduce them generates atypical
behaviour corresponding to an agent completely unable to
move as in the case we discussed when precisions on propri-
oceptive input πzm are larger than precisions πwm (Fig. 2d),
or having limited motor capabilities when πzm and πwm are
closer in magnitude (not shown here).
Other vehicles
In the previous sections we showed that different precisions
within the same generative model can qualitatively affect the
behaviour of an agent, going from performing phototaxis to
a catatonic state by just regulating some of these weights.
In this section we explore how different priors, encoding in
our case the relationships between exteroceptive and propri-
oceptive inputs (see equation (10)) can also be used to gener-
ate new emergent behaviour. As we saw in our “Model” sec-
tion during the deﬁnition of our generative model, vehicles
Phototaxis
I. ˙µl1 ≈−πzl1
(µl1 −ρl1 )
II. ˙µm2 ≈−πwm2 (µm2 −µl1 )
III. ˙a2 ≈−πzm2 (ρm2 −µm2 )
Pathological
I. ˙µl1 ≈−πzl1
(µl1 −ρl1 )
II. ˙µm2 ≈−πzm2 (µm2 −ρm2 )
III. ˙a2 ≈−πzm2 (ρm2 −µm2 )
Table 2: Approximations of equation (16) and equation (17)
after taking different assumptions on precisions. Equations
for both phototaxis and a possible pathological behaviour
are presented for the left-sensor/right-motor coupling.
in Fig. 2a described trajectories consistent with Braitenberg
vehicle 2b. Simple modiﬁcations to the priors can easily re-
produce behaviours analogous to other vehicles, for instance
2a (the “coward”), 3a (the “lover”) and 3b (the “explorer”).
In more detail, models of the priors were updated to:
• for the coward vehicle, rapidly running away from the
light to then slow down once distance is gained,
µm1 = µl1 + wm1 , µ m2 = µl2 + wm2 (20)
• for the lover vehicle, quickly approaching the light while
decreasing its speed close to the source,
µm1 = lmax −µl1 + wm1 , µ m2 = lmax −µl2 + wm2 (21)
• for the explorer vehicle, repelled by the light, moving
slowly in its vicinity and speeding up away from it,
µm1 = lmax −µl2 + wm1 , µ m2 = lmax −µl1 + wm2 (22)
with lmax representing the highest light intensity in the
agents’ environment.
Discussion
In this work we presented an implementation of phototaxis
within an emerging framework in computational and cogni-
tive neuroscience, the Free Energy Principle (FEP). Accord-
ing to the FEP, processes like perception, learning and action
can be deﬁned in biological systems as the minimisation of a
quantity deﬁned as (variational) free energy (Friston, 2010).
Most of the simulations proposed so far have focused on
“perception-oriented” interpretations of the FEP, where gen-
erative models play the role of accurate descriptions of the
dynamics of the world they represent. These models can
capture the intrinsic properties of an agent’s sensations and
reconstruct the causes of these sensations to a great degree of
detail. On this view, a model is assessed on how accurately it
can predict incoming sensations, behaviour only emerges as
a consequence of reliable information encoded by the agent.
−60 −40 −20 0 20 40 60 80
−50
−25
0
25
50
75
100
125
Trajectory
(a)
0.000 0.025 0.050 0.075 0.100 0.125 0.150 0.175 0.200
Time (s)
0
2000
4000
6000
8000
10000
Free Energy (b)
−60 −40 −20 0 20 40 60
−20
0
20
40
60
80
100
Trajectory
(c)
0.000 0.025 0.050 0.075 0.100 0.125 0.150 0.175 0.200
Time (s)
0
50000
100000
150000
200000
250000
300000
Free Energy (d)
−600 −400 −200 0 200 400 600
−400
−200
0
200
400
600
Trajectory
(e)
0.000 0.025 0.050 0.075 0.100 0.125 0.150 0.175 0.200
Time (s)
0
50000
100000
150000
200000
250000
300000
Free Energy (f)
Figure 3: Different behaviours are obtained by updating the
priors of the agent. Fig. 3a shows the “coward”-like be-
haviour of Braitenberg vehicle 2a, Fig. 3c is akin to vehi-
cle 3a, the “lover”, while Fig. 3e behaves as vehicle 3b, the
“explorer”. Ten simulations were performed for each setup,
with random initial conditions (position and orientation of
the agent). We also added Gaussian noise to each precision
parameter (mean varying up to ±20% of the value of each
precision parameter, variance 1) to conﬁrm the robustness of
the solution. The free energy (only shown for the agent de-
scribing the blue trajectory) is minimised in all cases as soon
as the conditions described by the agents’ priors are met.
Our model on the other hand, represents an example
of “action-oriented” interpretations of the FEP framework
(Seth, 2014; Clark, 2015; Bruineberg et al., 2016; Allen and
Friston, 2016), with a focus on minimal generative models.
In this case, models are evaluated based on their ability to
allow an agent to perform a task or achieve a certain goal.
The information recapitulated in these models is only apt to
perform ecologically relevant behaviour: inferring and en-
coding more properties of the world dynamics is not an ad-
vantage for an agent. This idea is described within the for-
malism of the FEP as the complexity-accuracy trade off. It
is possible in fact to rewrite equation (4) in information the-
oretical terms as a combination of measures of complexity
and accuracy (Friston et al., 2006; Friston, 2010). According
to this alternative reading, minimising free energy is equiva-
lent to maximising the predictive power (i.e. accuracy) of
a generative model while minimising its complexity. An
agent, according to the FEP, is then mandated to encode only
relevant information to avoid unnecessary complex models
that don’t improve its performances.
The generative model in our agent represents a set of vari-
ables, µx = {µl1 ,µl2 ,µm1 ,µm2 }acting as beliefs about
the hidden causes xof sensations ρ= {ρl1 ,ρl2 ,ρm1 ,ρm2 }.
In our implementation, these variables are not strongly re-
lated to how sensory data ρ’s are actually generated i.e. they
contain no information about, for example, the details of
the agent’s body or environment. It could be argued that
this agent does not even possess a generative model in its
purest sense since it cannot generate predictions in line with
sensory data. Our interpretation aligns with Clark (2015);
Bruineberg et al. (2016) in saying that, as already men-
tioned above, a generative model in the context of embodied
agents should be assessed based on its ability to allow the
agent to perform a task (action-oriented), rather than on how
well it can reconstruct and accurately predict sensory input
(perception-oriented).
In our investigations we ﬁrst provided an account of pho-
totaxis functionally consistent with vehicle 2b (Braitenberg,
1986), and how it could be implemented under the FEP. To
allow for such behaviour we endowed our agent with beliefs
on exteroceptive readings (i.e. light intensity) and mapped
them to proprioceptive ones (i.e. motor velocity) using sim-
ple linear contralateral relations. In addition, this agent
needs to implement high and low precisions on exterocep-
tive and proprioceptive inputs respectively, with precisions
on their interaction placed somewhere in between. This
agent performs phototaxis through active inference without
explicitly encoding information about a target end-point in
the generative model, i.e. it does not specify a light inten-
sity to achieve. The beliefs’ structure of this agent encodes
a target “state of affairs” rather than a ﬁnal goal. This agent
thus minimises its free energy by complying with this state
of affairs, not by achieving an explicit goal state. Phototaxis
is just a consequence of how priors relating light levels to
motor velocities are implemented.
We then explored behaviours deﬁned as “pathological”,
inspired by work on the FEP for motor disorders, psychosis
and schizophrenia among others (Adams et al., 2013; Friston
et al., 2016). Some pathologies, it has been suggested, can
be recapitulated under the FEP when different weighting pa-
rameters in a generative model (precisions) are altered. Our
simulations investigated a case where a combination of high
precisions on proprioceptive prediction errors and low pre-
cisions on the relation between extero- and proprioceptive
beliefs resulted in a reduced (or complete lack of) ability to
move. A similar idea was presented in Brown et al. (2013)
where decreasing the conﬁdence (precision) of sensations
about self-generated movements is thought to be a necessary
condition for the initiation of action.
We ﬁnally explored how simple changes in priors can pro-
duce new emergent behaviours, for example an alternative
version of phototaxis and two types of photophobia, in line
with vehicles 2a and 3a-b (Braitenberg, 1986).
The implementation of phototaxis we presented here is
admittedly rather complicated. However, it constitutes a
complete example of an agentive system operating on the
basis of the FEP and we would argue that models like this
will be vital if the potential of the FEP and active inference is
to be fully understood. The action-oriented model we imple-
mented has also begun to address some of the concerns about
the FEP (Clark (2015); Bruineberg et al. (2016)), essentially
worrying that interpretations of this framework have been
so far too dependent on a perception-oriented account of be-
haviour. We would argue that the FEP is neutral on the im-
plementation details of agentive behaviour and is thus com-
patible with many different cognitive frameworks. Indeed
this neutrality is perhaps a central strength of the FEP as it
may provide a uniﬁed formalism within which to examine
different understandings of cognitive systems.
Future directions
This presentation constitutes only a simple proof of concept
of action-oriented approaches to the FEP, with a more com-
plete analysis of our minimal generative models left for fu-
ture work. In the future we will start by investigating the
possible functional beneﬁts of this architecture based on the
FEP. For instance, preliminary results comparing standard
Braitenberg vehicles and our implementation already sug-
gest a higher robustness of the latter in very noisy envi-
ronments because of low-pass ﬁlters implemented by equa-
tion (16) and equation (17). A second direction will address
generative models with a less minimal set of assumptions,
including for example prior beliefs for exteroceptive input
(a target light intensity to achieve?) and the exploration of
behaviours that can only be performed with the implemen-
tation of such mechanisms (maintaining a certain distance
from the light source?). This will allow us to investigate the
implications for the perception- vs. action-oriented debate
on the interpretation of the FEP (Clark, 2015; Bruineberg
et al., 2016; Allen and Friston, 2016) for more complex
adaptive behaviours.
References
Adams, R., Stephan, K., Brown, H., Frith, C., and Friston, K.
(2013). The computational anatomy of psychosis. Frontiers
in Psychiatry, 4:47.
Allen, M. and Friston, K. J. (2016). From cognitivism to au-
topoiesis: Towards a computational framework for the em-
bodied mind. Synthese, pages 1–24.
Bishop, C. M. (2006). Pattern recognition. Machine Learning.
Bogacz, R. (2015). A tutorial on the free-energy framework for
modelling perception and learning. Journal of Mathematical
Psychology.
Braitenberg, V . (1986).Vehicles: Experiments in synthetic psychol-
ogy. MIT press.
Brown, H., Adams, R. A., Parees, I., Edwards, M., and Friston, K.
(2013). Active inference, sensory attenuation and illusions.
Cognitive processing, 14(4):411–427.
Bruineberg, J., Kiverstein, J., and Rietveld, E. (2016). The antici-
pating brain is not a scientist: the free-energy principle from
an ecological-enactive perspective. Synthese, pages 1–28.
Buckley, C. L., Kim, C. S., McGregor, S., and Seth, A. K. (2017).
The free energy principle for action and perception: A math-
ematical review. arxiv preprint arXiv:1705.09156v1.
Clark, A. (2013). Whatever next? predictive brains, situated
agents, and the future of cognitive science. Behavioral and
Brain Sciences, 36(03):181–204.
Clark, A. (2015). Radical predictive processing. The Southern
Journal of Philosophy, 53(S1):3–27.
Dayan, P., Hinton, G. E., Neal, R. M., and Zemel, R. S. (1995).
The helmholtz machine. Neural computation, 7(5):889–904.
Feldman, H. and Friston, K. (2010). Attention, uncertainty, and
free-energy. Frontiers in human neuroscience, 4:215.
Friston, K. (2008). Hierarchical models in the brain. PLoS Com-
putational Biology, 4(11).
Friston, K. (2010). The free-energy principle: a uniﬁed brain the-
ory? Nature reviews. Neuroscience, 11(2):127–138.
Friston, K., Brown, H. R., Siemerkus, J., and Stephan, K. E. (2016).
The dysconnection hypothesis (2016). Schizophrenia Re-
search, 176(2):83–94.
Friston, K., Kilner, J., and Harrison, L. (2006). A free energy prin-
ciple for the brain. Journal of Physiology-Paris, 100(1):70–
87.
Friston, K., Thornton, C., and Clark, A. (2012). Free-energy min-
imization and the dark-room problem. Frontiers in psychol-
ogy, 3:130.
Friston, K. J., Daunizeau, J., Kilner, J., and Kiebel, S. J. (2010).
Action and behavior: A free-energy formulation. Biological
Cybernetics, 102(3):227–260.
Friston, K. J., Trujillo-Barreto, N., and Daunizeau, J. (2008).
DEM: A variational treatment of dynamic systems.NeuroIm-
age, 41(3):849–885.
Hohwy, J. (2013). The predictive mind. OUP Oxford.
Knill, D. C. and Pouget, A. (2004). The bayesian brain: the role
of uncertainty in neural coding and computation. TRENDS in
Neurosciences, 27(12):712–719.
Kullback, S. and Leibler, R. A. (1951). On information and sufﬁ-
ciency. The annals of mathematical statistics, 22(1):79–86.
Rao, R. P. and Ballard, D. H. (1999). Predictive coding in the vi-
sual cortex: a functional interpretation of some extra-classical
receptive-ﬁeld effects. Nature neuroscience, 2(1):79–87.
Seth, A. K. (2014). The cybernetic bayesian brain. In Open MIND.
Open MIND. Frankfurt am Main: MIND Group.
V on Helmholtz, H. (1867). Handbuch der physiologischen Optik,
volume 9. V oss.