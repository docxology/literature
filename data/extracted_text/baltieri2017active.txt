An active inference implementation of phototaxis ∗
ManuelBaltieri,ChristopherL.Buckley
EvolutionaryandAdaptiveSystemsGroup,DepartmentofInformatics,
UniversityofSussex,Brighton,UK
m.baltieri@sussex.ac.uk
Abstract tonetal.,2006;Clark,2013;Hohwy,2013;Bogacz,2015;
Buckleyetal.,2017).
Activeinferenceisemergingasapossibleunifyingtheoryof
Predictive Coding models represent one concrete instan-
perceptionandactionincognitiveandcomputationalneuro-
tiation of this inferential process and have been used, for
science. Onthistheory, perceptionisaprocessofinferring
thecausesofsensorydatabyminimisingtheerrorbetween instance,toaccountfortheneuraldynamicsunderlyingper-
actualsensationsandthosepredictedbyaninnergenerative ceptioninthevisualcortex(RaoandBallard,1999). These
(probabilistic)model.Actionontheotherhandisdrawnasa ideas have been significantly extended by the Free Energy
processthatmodifiestheworldsuchthattheconsequentsen-
Principle (FEP) (Friston et al., 2006; Friston, 2010), which
sory input meets expectations encoded in the same internal
also provides a mechanistic account of action within the
model.Thesetwoprocesses,inferringpropertiesoftheworld
andinferringactionsneededtomeetexpectations,closethe same framework. Specifically, under the FEP, while per-
sensory/motor loop and suggest a deep symmetry between ception(“perceptualinference”)isaprocessofupdatingan
action and perception. In this work we present a simple innermodeltobestaccountforsensorydata,actionschange
agent-basedmodelinspiredbythisnewtheorythatoffersin-
the world to make sensory input better accord with predic-
sightsonsomeofitscentralideas.Previousimplementations
tions made by the same model (“active inference”). It has
of active inference have typically examined a “perception-
oriented” view of this theory, assuming that agents are en- been suggested that the interplay between these two pro-
dowed with a detailed generative model of their surround- cessesactingtosatisfyagenerativemodelthatencodescon-
ingenvironment.Incontrast,wepresentan“action-oriented” straints(“priors”)conducivetoanagent’ssurvivalcanform
solution showing how adaptive behaviour can emerge even
thefoundationsofadaptivebehaviour(Fristonetal.,2012).
whenagentsoperatewithasimplemodelwhichbearslittle
resemblancetotheirenvironment. Weexaminehowvarious The vast majority of models implemented using this
parametersofthisformulationallowphototaxisandpresent framework have assumed that agents are endowed with a
anexampleofadifferent,“pathological”behaviour. detailedgenerativemodeloftheirsurroundingenvironment.
These “perception-oriented” approaches subordinate motor
actionstotheaccurateandcomprehensiveperceptionofthe
Introduction
environmental causes of sensory data (Hohwy, 2013) and
Brains must operate in an uncertain world, with noisy sen- thushaveoftenbroughttheFEPandactiveinferenceintodi-
sors that provide only incomplete and often ambiguous in- rectconflictwithmoreenactivistviewsofcognition(Clark,
formation. Recent developments in cognitive and compu- 2015;Bruinebergetal.,2016;AllenandFriston,2016). In
tational neuroscience have suggested that the brain meets contrast, others have suggested that complex adaptive be-
this challenge by operating as a Bayesian inference ma- haviour could emerge from the interplay between an agent
chine.ThisideaisusuallytracedbacktoworkbyHelmholtz actingonthebasisofsimpler,morefrugalgenerativemodels
(VonHelmholtz,1867)andhistheoryofunconsciousinfer- and the environment (Clark, 2015). This “action-oriented”
ence. On this view, perception is cast as an ongoing pro- perspective could underpin a more ecological and embod-
cess of updating an inner generative model so that it can iedreadingoftheFEP(Seth,2014;Clark,2015;Bruineberg
bestrecapitulate(or“predict”)noisyandambiguousincom- etal.,2016;AllenandFriston,2016).
ingsensoryinputandthusinferthehidden(i.e. notdirectly
In this work we show an example of a simple wheeled
accessible by the brain) causes of such data (Dayan et al.,
agent performing phototaxis under active inference and
1995;RaoandBallard,1999;KnillandPouget,2004;Fris-
present it as a proof of principle of an “action-oriented”
reading on the FEP. We also examine how phototaxis de-
∗ThisworkislicensedtothepublicunderaCreativeCommons
Attribution- NonCommercial-NoDerivatives 4.0 license (interna- pendsonvariousparameterssettingsandhowthiscouldbe
tional):http://creativecommons.org/licenses/by-nc-nd/4.0/ usedasagenericmodelofdifferentemergentbehaviours.
7102
luJ
6
]CN.oib-q[
1v60810.7071:viXra
TheFreeEnergyPrinciple(FEP)andActive arbitraryrecognitiondensitiescanbecomplex,soacommon
Inference assumptionistorestricttheformofQ(x)toatightlypeaked
Gaussiandistribution,i.e. theLaplaceapproximation(Fris-
Bayesian accounts of perception hold that a central goal of
tonetal.,2006,2008;Bogacz,2015;Buckleyetal.,2017).
agentivesystemsistoinferthehiddenenvironmentalcauses
Variablesxarethenreplacedbyparametersµ representing
ofsensorydata(KnillandPouget,2004). Formally,thiscan x
the first order sufficient statistics (i.e. the mean(s)) of this
bewrittenasaprocessofBayesianinferenceintermsofthe
Gaussiandistribution. Effectively,µ representaparametri-
causesxofsensoryinputρ: x
sationofanagent’sbeliefsorbestguessesofthemostlikely
P(ρ|x)P(x) causes x. It can be shown (Friston et al., 2008; Bogacz,
P(x|ρ)= (1)
P(ρ) 2015;Buckleyetal.,2017)thatundertheseassumptionsthe
freeenergytermsimplifiesto
whereP(x|ρ)istheposteriorprobabilityofhiddencausesx
givenobservedsensorydataρ.P(ρ|x)isthelikelihood,cor- F =−lnP(ρ,µ )+constants (5)
x
responding to the organism’s assumptions about how sen-
sory input ρ relates to hidden causes x. P(x) is the prior, where P(ρ,µ x ) = P(ρ|µ x )P(µ x ) is the generative den-
encodingtheagent’s“beliefs”abouthiddencausesbeforeit sity comprisingof a likelihood P(ρ|µ x ) and aprior P(µ x )
receives ρ and P(ρ) is the marginal likelihood, a normali- in terms of parametrised beliefs about hidden causes µ x .
sationfactorobtainedbymarginalisingP(ρ|x)overallpos- In sum, changing beliefs µ x to minimise the free en-
sible causes x. To calculate the posterior probability it is ergy F, constrained by sensory data ρ, makes µ x the best
necessary to evaluate the marginal likelihood (also called guess/estimateofhiddencausesx.
“surprisal”, Friston (2010)) P(ρ), which is often difficult Under this framework it is suggested that perception is
if not practically intractable (Bishop, 2006; Buckley et al., implementedastheminimisationoffreeenergywithrespect
2017). Variational Free Energy represents an approximate tobeliefsµ x followingagradientdescentscheme:
technique for Bayesian inference (Bishop, 2006) that has
∂F
beenarguedtobecompatiblewithaneurallyplausibleim- µ˙ =− (6)
x ∂µ
plementationofthisBayesianscheme(Friston,2008). The x
methodinvolvesoptimisinganauxiliaryprobabilitydensity Thisequationupdatesµ andconvergeswhentheminimum
x
Q(x),referredtoasarecognitiondensity,sothatitbecomes ofthefreeenergyF isreached,i.e. when ∂F =0.
agoodapproximationoftheposteriorP(x|ρ). Thiscanbe In contrasts to perception, action is defi ∂ n µ e x d as a process
achievedbyminimisingameasureofthedifferencebetween ofchangingtheworldsuchthatsensorydatabetteraccords
thesetwodensities,quantifiedastheKullback-Leibler(KL) withpredictionsofthegenerativemodel(Fig.1b). Specifi-
divergence(KullbackandLeibler,1951) cally,intermsoftheformalismpresentedabove,whileper-
(cid:90) Q(x) ceptionminimisesthefirsttermofequation(3),actionopti-
D KL (Q(x)||P(x|ρ))= Q(x)ln P(x|ρ) dx (2) misesthesecondonebyupdatingsensationsρ. Toachieve
this,anagentmustknow(oratleasthaveanapproximation
andwhilewecannotevaluatethisexpressiondirectlysince of) how ρ depend on motor action a (i.e. ρ = f(a)) (Fris-
itstillinvolvestheunknownposterior,wecanrewriteitas ton et al., 2010; Buckley et al., 2017). Given this, action
cansimilarlybecastasagradientdescentonthefreeenergy
D (Q(x)||P(x|ρ))=F +lnP(ρ) (3)
KL withrespecttothevariablea
wherewedefinedthe“variationalfreeenergy”as
∂F ∂F ∂ρ
a˙ =− =− (7)
(cid:90) Q(x) ∂a ∂ρ ∂a
F ≡ Q(x)ln dx (4)
P(x,ρ)
Thus action and perception can be described as the min-
Unlikeequation(2),thefreeenergyF canbeevaluatedbe- imisation of the same quantity, with the simultaneous
causeitonlyinvolvestherecognitiondensity,whichweare implementation of both processes closing the action-
freetospecify,andamodeloftheworlddynamicsinterms perceptionloop.
ofapriorandalikelihoodwhichweassumeanagenthas,i.e.
TheModel
P(x,ρ)=P(ρ|x)P(x). Thesecondtermontheright-hand
sideinequation(3)isindependentoftherecognitiondensity TopresentsomeofthecoreideasbehindtheFEPandactive
Q(x)(itonlydependsonsensoryinputρ). Thus, minimis- inferenceweimplementphototaxisonasimplewheeledve-
ingequation(4)withrespecttoQ(x)willminimisetheKL hicle. Wesimulateanagentwithcircularbody,2noisylight
divergencebetweentherecognitiondensityandthetruepos- sensors and 2 noiseless motors, see Fig. 1a. For simplic-
terior. The result of this minimisation will make Q(x) ap- ity we do not simulate occlusion of the light source by the
proachthetrueposteriorP(x|ρ).Optimisingfreeenergyfor agent’sbody.
nious (Seth, 2014; Clark, 2015; Bruineberg et al., 2016;
Allen and Friston, 2016). To examine this, we endow our
agent with a minimal model of its surrounding environ-
ment. Specifically,ouragentreceivesfourinputs: twofrom
exteroceptors sensitive to light ρ ,ρ and two from pro-
l1 l2
prioceptors ρ ,ρ sensing motor velocity, see Fig. 1a.
m1 m2
We then assume that it only models four hidden causes
x = {l ,l ,m ,m }, one for each input, parametrised by
1 2 1 2
(a) beliefs µ x = {µ l1 ,µ l2 ,µ m1 ,µ m2 }. In table 1 we list the
variablesusedinourmodel.
Variable Meaning
Set of sensory inputs
ρ
{ρ ,ρ ,ρ ,ρ }
l1 l2 m1 m2
Readings of luminance from
ρ ,ρ
l1 l2
sensors1and2(exteroceptors)
Readings of velocity from mo-
ρ ,ρ
m1 m2
tors1and2(proprioceptors)
Set of parametrised beliefs on
µ
x
causesx{µ ,µ ,µ ,µ }
l1 l2 m1 m2
(Parametrised)Beliefsaboutex-
µ ,µ
(b)
l1 l2
teroceptivesensoryreadings
Figure 1: (a) The wheeled vehicle used in our simula- µ ,µ (Parametrised) Beliefs about
tions.Theagentreceivesinputfromtwoexteroceptorsread-
m1 m2
proprioceptivesensoryreadings
inglightintensity(ρ ,ρ )andtwoproprioceptorsreading
l1 l2 Gaussian noise representing un-
wheelvelocity(ρ ,ρ ). Variablesµ ,µ ,µ ,µ are
m1 m2 l1 l2 m1 m2
z,w
certaintyoftheagentonsensory
partofthegenerativemodeloftheagent. Theredlinesrep-
inputandbeliefsabouttheinput,
resenttherelationsbetweentheagent’spriorbeliefsonthe
respectively
dynamics of the world, very distant from how the real dy-
namics work. (b) A schematic of the FEP. Two types of
Table 1: Variables used in our definition of the generative
sensations,exteroceptive(lightintensity,ρ )andpropriocep-
l model.
tive(motorvelocity,ρ ),representthesensoryinputofthe
m
agent (blue arrows). Beliefs on causes µ and µ are up-
l m
To specify the agent’s generative density (equation (5))
dated(redarrows)withinthegenerativemodelthroughper-
P(ρ,µ ) = P(ρ|µ )P(µ ) we must first introduce a like-
ception. Thedashedredarrowdenotesthelackofupdateof x x x
lihood, P(ρ|µ ) and a prior P(µ ) in terms of the agent’s
thegenerativemodelduetoproprioceptivepredictionerrors, x x
beliefsµ . Inordertodosowefirstdefineamodelofhow
necessaryforphototaxis. Thisupdateisintroducedlateron x
exteroceptive sensations (light intensity) are generated ac-
toshow“pathologicalbehaviour”. Actionasolvesthedis-
cordingtotheagent:
crepancy between predictions of the generative model and
sensationsfromtheworldbyengagingwiththelatter.
ρ =µ +z , ρ =µ +z , (8)
l1 l1 l1 l2 l2 l2
and similarly for the proprioceptors, representing readings
Inpreviousagent-basedsimulationsoftheFEPitistyp-
ofthevelocityofeachmotor:
ically assumed that an agent possesses a rich and detailed
model of its environment (see for example Friston et al. ρ =µ +z , ρ =µ +z (9)
m1 m1 m1 m2 m2 m2
(2010)). For instance if we were to take this approach
here, we would perhaps start by assuming that the agent where we have assumed sensory reading are linearly
has a representation of the locations of both itself and the related to their causes, with some additive zero-mean
lightsource. Howeveramoreaction-orientedinterpretation Gaussian noise z = {z ,z ,z ,z } with variance
l1 l2 m1 m2
of the FEP suggests that adaptive behaviour could emerge σ2 = {σ2 ,σ2 ,σ2 ,σ2 }. The agent’s priors on
z zl1 zl2 zm1 zm2
from generative models that are more frugal and parsimo- hidden causes are then specified in terms of the relation
P(µ ,µ ) = P(µ |µ )P(µ ), with variables µ ,µ Withtheexpressionforthefreeenergywecannowderive
m l m l l m1 m2
only depending on µ ,µ . We then write a model of the theequationsthatwillimplementperception(equation(6)):
l1 l2
priorsas:
(cid:16) (cid:17)
µ˙ =−k π (µ −ρ )+π (µ −µ )
µ =µ +w , µ =µ +w (10)
l1 zl1 l1 l1 wm2 l1 m2
m1 l2 m1 m2 l1 m2 (cid:16) (cid:17)
µ˙ =−k π (µ −ρ )+π (µ −µ )
wherew ={w ,w }issomezero-meanGaussiannoise
l2 zl2 l2 l2 wm1 l2 m1
m1 m2 (cid:16) (cid:17)
with variance σ2 = {σ2 ,σ2 }. Effectively, we de- µ˙ =−k π (µ −ρ )+π (µ −µ )
w wm1 wm2 m1 zm1 m1 m1 wm1 m1 l2
scribetheunderlyingdynamicsintermsofacontralateralre-
(cid:16) (cid:17)
lationshipbetweenbeliefsaboutsensorsµ l andmotorsµ m . µ˙ m2 =−k π zm1 (µ m2 −ρ m2 )+π wm2 (µ m2 −µ l1 )(16)
Aswewillsee,thisbeliefs’structuremakesouragentfunc-
tionallyconsistentwithBraitenbergvehicle2b,the“aggres- andaction(equation(7)):
sor” (Braitenberg, 1986). We also assume uniform priors
(cid:16)
onbeliefsaboutexteroceptorsP(µ l ),thuseliminatingthem a˙ 1 = −k π zm1 (ρ m1 −µ m1 ) ∂ ∂ ρ a m 1 1 +
fromourformulation. (cid:17)
Under the assumption that random variables +π zm2 (ρ m2 −µ m2 ) ∂ ∂ ρ a m 1 2
z are Gaussian with zero mean, N(0,σ2) = (cid:16)
1/ √ 2πσ2exp(−z2/(2σ2)),byrewritingthemas a˙ 2 = −k π zm1 (ρ m1 −µ m1 ) ∂ ∂ ρ a m 2 1 +
(cid:17)
z l1 =ρ l1 −µ l1 , z l2 =ρ l2 −µ l2 (11) +π zm2 (ρ m2 −µ m2 ) ∂ ∂ ρ a m 2 2 (17)
z =ρ −µ , z =ρ −µ (12)
m1 m1 m1 m2 m2 m2 wherekisthelearningrateusedforthegradientdescent.
To implement action according to equation (7) we must
wecandefinethelikelihoodfunctionsas
first define the partial derivative ∂ρ/∂a to implement the
(cid:16) (cid:17)
P(ρ |µ )= √ 1 exp −(ρl−µl)2 agent’s model of the relationship between actions and per-
l l 2πσ z 2 l (2σ z 2 l ) cepts. Here we assume that actions (a 1 ,a 2 ) can only in-
(cid:16) (cid:17)
P(ρ m |µ m )= √ 2π 1 σ z 2 m exp −(ρ (2 m σ − z 2 m µm ) )2 (13) fl in ue F n r c is e to p n ro e p t r a io l. ce (2 p 0 ti 1 v 0 e ), se a n c s t a iv ti e on in s fe ρ r m en 1 c , e ρ m d 2 is . pe A n s se e s x t p h l e ain tr e a d -
ditionalnotionofforward/inversemodelsformotorcontrol
where l = {l ,l } and m = {m ,m }. Similarly, with
1 2 1 2 in favour of a more general generative (forward) model in-
Gaussiannoisewthepriorsbecome
verted through Bayesian inference. In this framework, in-
P P ( ( µ µ m m 1 2 | | µ µ l l 2 1 ) ) = = (cid:113) (cid:113) 2 2 π π 1 1 σ σ w w 2 2 m m 1 2 e e x x p p (cid:16) (cid:16) − − ( ( µ µ ( ( 2 2 m m σ σ 1 2 w w 2 2 − − m m µ µ 1 2 l l ) ) 2 1 ) ) 2 2 (cid:17) (cid:17) (14) v d m i t n h e ic e e r a t n s p i n e t o a e n a r d m g t s i e o t a a h n d l b r t e d o o . l e u u s I r g t n i a v h p r o a e r s t u o i i r v t p m h e m r o p s io u o l ∂ e c g d ρ e h e r p / e l t t ∂ fl t i t v h a o e e e x ’s b i c , a e n o e r v c n n i e m s s c r e o s t p q h e d l u o i e m c e u d i n g o t a l c h d y s e t e s e l to n t c h c o b a o r t e r d e a e e s r d m p e o i b i n n m o d d p p s i r l e t e e d o - -
sia A n, s t a he re f s r u e l e t e o n f e th rg e y a r s e s d u u m c p e t s io to n ( f w or it b h o o t u h t z an an y d co w n t s o ta b n e t) G : aus- (cid:34)∂ ∂ ρ a m 1 1 ∂ ∂ ρ a m 1 2 (cid:35) = (cid:20) 1 0 (cid:21) (18)
∂ρm1 ∂ρm2 0 1
F = 1
(cid:16)
(cid:80) π (ρ −µ )2+π (µ −µ )2+
∂a2 ∂a2
2 i zi i i wm1 m1 l2
to specify at a proprioceptive level cross relations between
(cid:17)
+π (µ −µ )2+ (cid:80) lnπ + (cid:80) lnπ (15) sensorsandmotors. Motorreflexarcsareimplementedwith
wm2 m2 x1 i zi j wj
theassumptionthateachmotortakesasaninputoneofthe
withi ∈ {l ,l ,m ,m }andj ∈ {m ,m }andwhereπ actionsproducedthroughtheminimisationoffreeenergy
1 2 1 2 1 2 zi
and π are the inverse variances of noise terms z and w
respec w ti j vely, alsocalled“precisions”. Precisionpa i rameter j s v 1 =a 1 , v 2 =a 2 . (19)
weightpredictionserrorsbasedontheagent’sconfidenceon
wherev ,v aretheactualmotorvelocitiesofthevehicle.
a certain belief. High precisions imply low variances and 1 2
thus high confidence, and vice versa. These parameters al-
Simulations
low for different emphases on the minimisation of free en-
Phototaxis
ergy,forexampleanagentcouldfocusmoreonpredictions
weightedbyπ orrelymoreonsensationsfromtheenvi- The behaviour of agents operating under the FEP can be
wj
ronment when π are large. Some of the implications of shown to depend on the value of precision parameters. In
zi
thisweightingmechanismwillbedevelopedinmoredetail our first simulation we adjust the precisions to implement
forthismodelwithoursimulations. phototaxis. Priorsinthegenerativemodelimplementlinear
Trajectory
200
70
150
60 100
50 50
40 0
30
20
10
0
−60 −40 −20 0 20 40 60
(a)
ecnanimuL
Exteroceptor ρl1 , μl1
Sensory reading ρl1
Belief about sensory reading μl1
200
150
100 50
0
0.0 0.5 1.0 1.5 2.0 2.5 3.0
Time (s)
yticolev
rotoM
,ecnanimuL
Free Energy
12000
10000
8000
Beliefs μl1 , μμ2 6000
4000
2000 Belief about sensory reading μl1
Belief about motor reading μμ2 0
0.0000.0250.0500.0750.1000.1250.1500.1750.200
Time (s)
(b) (c)
Trajectory
70 60
40
60
20
50
0
40
30
20
10
−60 −40 −20 0 20 40 60
(d)
ecnanimuL
Exteroceptor ρl1 , μl1
Sensory reading ρl1
Belief about sensory reading μl1
60
40
20
0
0.0 0.5 1.0 1.5 2.0 2.5 3.0
Time (s)
yticolev
rotoM
,ecnanimuL
Free Energy
70000
60000
50000
40000
Beliefs μl1 , μμ2
30000
20000
Belief about sensory reading μl1 10000
Belief about motor reading μμ2 0
0.0000.0250.0500.0750.1000.1250.1500.1750.200
Time (s)
(e) (f)
Figure 2: First row: Phototaxis under the FEP/Active Inference. (a) Trajectory of the vehicle over 5 seconds of simulation.
Thereddotrepresentstheinitialposition(withorientationparalleltotheverticalaxis),theyellowcircleisthelightsource. (b)
Inference of belief µ about sensory input ρ . (c) Coupling of belief on left sensor µ with belief on right motor µ . (d)
l1 l1 l1 m2
Freeenergyoverthefirst0.2seconds. ThevehicleperformsphototaxisakintoBraitenbergvehicle2b,byacceleratingcloseto
thelight. Howeverthefreeenergy(onlyshownfortheagentdescribingthebluetrajectory)isminimisedlongbefore(≈0.05s)
thisagentgetsclosetothelightsource(≈2s),sincethegenerativemodelonlyencodesconditionsonsensory-motorcoupling
(e.g. nospecificationofalightlevelasatarget). Theonlyrequirementforthisagentistofulfillthecouplingbetweensensors
andmotorsspecifiedbyitsgenerativemodel.
Second row: Example of “pathological” behaviour under the FEP/Active Inference (akinesia). Same layout as above.
Heremovementsareinhibited(Fig.2d)byhighprecisionsonproprioceptivepredictionerrorsandlowprecisionsonthepriors.
Thispreventstheappropriatecouplingbetweenbeliefsaboutsensorsandmotorsnecessaryforphototaxis(Fig.2ebottom).
Each row shows the simulation of 10 different vehicles with random initial conditions (position and orientation of the
agent). WealsoaddedGaussiannoisetoeachprecisionparameter(meanvaryingupto±20%ofthevalueofeachprecision
parameter,variance1)toconfirmtherobustnessofthesolution.
contralateralrelationsbetweenbeliefsµ andµ (seeequa- liefsaboutlightlevelsandmotorvelocitiesand3)actuation
l m
tion(10)). Inthissetup,ouragentneedstoaccuratelyinfer ofthemotorsbasedontheagent’sbeliefsaboutpropriocep-
µ fromitsreadingsonluminanceρ (Fig.2btop). Beliefs tive input (dictated by the light intensity). In table 2 we
l l
µ arethenmappedtobeliefsaboutproprioceptiveinputµ show how the the formulation of perception and action set
l m
(Fig.2bbottom)andprojectedtothemotorsviafast(instan- out in equation (16) and equation (17) respectively is sim-
taneousinoursimulations)reflexarcs,i.e. ρ =µ . Todo plified by these assumptions in the left-sensor/right-motor
m m
so,precisionsonproprioceptivesensations(π )needtobe relation,{µ ,µ }(thesamegoesfor{µ ,µ }).
zm l1 m2 l2 m1
much lower relatively to those on the priors (π ), in turn
wm Fig.2ashowsthe“aggressor-like”behaviourofouragent,
smallerthantheprecisionsonexteroceptors(π ).
zl which speeds up close to the light and slows down away
Thisenablesthesensory-motorflowwedescribed: 1)in- from it. At the beginning of our simulation we initialise
ferenceofexteroceptivesensations,2)couplingbetweenbe- all beliefs to zero. Fig. 2c shows how, after a brief tran-
sientduetotheseinitialconditions, thefreeenergyrapidly Phototaxis
approaches a minimum value exhibiting fluctuations only I.µ˙ ≈−π (µ −ρ )
driven by noise on exteroceptive input. This minimum is II.µ˙ l1 ≈− z π l1 l1 (µ l1 −µ )
reached in less than 0.1 seconds even though it takes the III.a˙ m2 ≈−π wm ( 2 ρ m − 2 µ l1 )
agent≈2secondstoreachthelight,seeFig.2btop. Thisis
2 zm2 m2 m2
becausethegenerativemodelwedefinedoesnotencodeex- Pathological
plicitpriorsonlightlevelsandthusdoesnotspecifyatarget
I.µ˙
l1
≈−π
zl1
(µ
l1
−ρ
l1
)
luminance. Insteadtheagentminimisesfreeenergybysim-
II.µ˙
m2
≈−π
zm2
(µ
m2
−ρ
m2
)
ply satisfying a mapping between beliefs about light levels
III.a˙
2
≈−π
zm2
(ρ
m2
−µ
m2
)
andmotorvelocities. Phototaxisemergesasaconsequence
oftherelationshipsbetweenbeliefsµ andµ ,notbecause Table2: Approximationsofequation(16)andequation(17)
l m
of an explicitly encoded goal. We will come back to this aftertakingdifferentassumptionsonprecisions. Equations
ideainthediscussion. for both phototaxis and a possible pathological behaviour
arepresentedfortheleft-sensor/right-motorcoupling.
Pathologicalbehaviour
The sensitivity of behaviour to precisions has been used
inFig.2adescribedtrajectoriesconsistentwithBraitenberg
extensively to develop hypotheses and computational mod-
vehicle2b. Simplemodificationstothepriorscaneasilyre-
els for phenomena including for instance psychosis and
producebehavioursanalogoustoothervehicles,forinstance
schizophrenia(Adamsetal.,2013;Fristonetal.,2016),sen-
2a(the“coward”),3a(the“lover”)and3b(the“explorer”).
soryattenuation(Brownetal.,2013)andattention(Feldman
Inmoredetail,modelsofthepriorswereupdatedto:
andFriston,2010). Herewepresentaninterpretationofthe
roleofprecisionsforouragentinspiredbytheseaccounts. • for the coward vehicle, rapidly running away from the
Ifthebalanceofprecisionsonproprioceptiveinputsπ lighttothenslowdownoncedistanceisgained,
zm
and on priors π is altered, with an increase of the for-
wm µ =µ +w , µ =µ +w (20)
merandadecreaseofthelatter,thebehaviourofourvehicle m1 l1 m1 m2 l2 m2
isseverelyaffectedbythechange. Thesensory-motorflow
• forthelovervehicle,quicklyapproachingthelightwhile
necessaryforphototaxisisdisruptedandwhiletheagentstill
decreasingitsspeedclosetothesource,
inferslightlevelsthroughµ (Fig.2etop),thesebeliefsare
l
notmappedtoµ (Fig.2ebottom)sincetheagent’spreci-
m µ =l −µ +w , µ =l −µ +w (21)
sions abouttheir relation π are dominatedby precisions
m1 max l1 m1 m2 max l2 m2
wm
onproprioceptiveinputπ (equationIIintable2).
zm • for the explorer vehicle, repelled by the light, moving
Thisbehaviourisconsistentwithinterpretationsunderthe
slowlyinitsvicinityandspeedingupawayfromit,
FEP of motor control disorders where movements are lim-
ited(hypokinesia)orentirelyabsent(akinesia)(Brownetal., µ =l −µ +w , µ =l −µ +w (22)
m1 max l2 m1 m2 max l1 m2
2013). Inactiveinferenceterms, decreasingproprioceptive
predictionerrorsprecisions,π inourcase,isthoughttobe with l representing the highest light intensity in the
zm max
a necessary condition to actuate motor commands (Brown agents’environment.
et al., 2013). Failing to reduce them generates atypical
behaviour corresponding to an agent completely unable to Discussion
moveasinthecasewediscussedwhenprecisionsonpropri- Inthisworkwepresentedanimplementationofphototaxis
oceptiveinputπ zm arelargerthanprecisionsπ wm (Fig.2d), withinanemergingframeworkincomputationalandcogni-
orhavinglimitedmotorcapabilitieswhenπ zm andπ wm are tiveneuroscience,theFreeEnergyPrinciple(FEP).Accord-
closerinmagnitude(notshownhere). ingtotheFEP,processeslikeperception,learningandaction
canbedefinedinbiologicalsystemsastheminimisationofa
Othervehicles
quantitydefinedas(variational)freeenergy(Friston,2010).
Intheprevioussectionsweshowedthatdifferentprecisions Most of the simulations proposed so far have focused on
withinthesamegenerativemodelcanqualitativelyaffectthe “perception-oriented”interpretationsoftheFEP,wheregen-
behaviourofanagent,goingfromperformingphototaxisto erative models play the role of accurate descriptions of the
a catatonic state by just regulating some of these weights. dynamics of the world they represent. These models can
Inthissectionweexplorehowdifferentpriors,encodingin capturetheintrinsicpropertiesofanagent’ssensationsand
ourcasetherelationshipsbetweenexteroceptiveandpropri- reconstructthecausesofthesesensationstoagreatdegreeof
oceptiveinputs(seeequation(10))canalsobeusedtogener- detail.Onthisview,amodelisassessedonhowaccuratelyit
atenewemergentbehaviour.Aswesawinour“Model”sec- canpredictincomingsensations,behaviouronlyemergesas
tionduringthedefinitionofourgenerativemodel, vehicles aconsequenceofreliableinformationencodedbytheagent.
lent to maximising the predictive power (i.e. accuracy) of
Trajectory Free Energy
125
a generative model while minimising its complexity. An
100 10000
75 8000 agent,accordingtotheFEP,isthenmandatedtoencodeonly
50 6000 relevant information to avoid unnecessary complex models
25
0 4000 thatdon’timproveitsperformances.
−25 2000 Thegenerativemodelinouragentrepresentsasetofvari-
−50 0
−60 −40 −20 0 20 40 60 80 0.0000.0250.0500.075 Tim 0. e 1 0 ( 0 s) 0.1250.1500.1750.200 ables, µ x = {µ l1 ,µ l2 ,µ m1 ,µ m2 } acting as beliefs about
(a) (b) thehiddencausesxofsensationsρ = {ρ ,ρ ,ρ ,ρ }.
l1 l2 m1 m2
In our implementation, these variables are not strongly re-
Trajectory Free Energy
100 300000 latedtohowsensorydataρ’sareactuallygeneratedi.e. they
80 250000
contain no information about, for example, the details of
60 200000
40 150000 the agent’s body or environment. It could be argued that
20 100000 this agent does not even possess a generative model in its
0 50000 purestsensesinceitcannotgeneratepredictionsinlinewith
−20 0
−60 −40 −20 0 20 40 60 0.0000.0250.0500.0750.1000.1250.1500.1750.200 sensory data. Our interpretation aligns with Clark (2015);
Time (s)
(c) (d) Bruineberg et al. (2016) in saying that, as already men-
tionedabove,agenerativemodelinthecontextofembodied
Trajectory Free Energy
600 300000 agents should be assessed based on its ability to allow the
400 250000 agenttoperformatask(action-oriented),ratherthanonhow
200 200000 wellitcanreconstructandaccuratelypredictsensoryinput
0 150000
100000 (perception-oriented).
−200
−400 50000 Inourinvestigationswefirstprovidedanaccountofpho-
0
−600 −400 −200 0 200 400 600 0.0000.0250.0500.0750.1000.1250.1500.1750.200 totaxisfunctionallyconsistentwithvehicle2b(Braitenberg,
Time (s)
(e) (f) 1986),andhowitcouldbeimplementedundertheFEP.To
allowforsuchbehaviourweendowedouragentwithbeliefs
on exteroceptive readings (i.e. light intensity) and mapped
Figure3: Differentbehavioursareobtainedbyupdatingthe
themtoproprioceptiveones(i.e. motorvelocity)usingsim-
priors of the agent. Fig. 3a shows the “coward”-like be-
ple linear contralateral relations. In addition, this agent
haviour of Braitenberg vehicle 2a, Fig. 3c is akin to vehi-
needs to implement high and low precisions on exterocep-
cle3a,the“lover”,whileFig.3ebehavesasvehicle3b,the
tive and proprioceptive inputs respectively, with precisions
“explorer”. Tensimulationswereperformedforeachsetup,
on their interaction placed somewhere in between. This
with random initial conditions (position and orientation of
agentperformsphototaxisthroughactiveinferencewithout
theagent). WealsoaddedGaussiannoisetoeachprecision
explicitly encoding information about a target end-point in
parameter (mean varying up to ±20% of the value of each
the generative model, i.e. it does not specify a light inten-
precisionparameter,variance1)toconfirmtherobustnessof
sitytoachieve. Thebeliefs’structureofthisagentencodes
thesolution. Thefreeenergy(onlyshownfortheagentde-
atarget“stateofaffairs”ratherthanafinalgoal. Thisagent
scribingthebluetrajectory)isminimisedinallcasesassoon
thusminimisesitsfreeenergybycomplyingwiththisstate
astheconditionsdescribedbytheagents’priorsaremet.
ofaffairs,notbyachievinganexplicitgoalstate. Phototaxis
is just a consequence of how priors relating light levels to
Our model on the other hand, represents an example motorvelocitiesareimplemented.
of “action-oriented” interpretations of the FEP framework We then explored behaviours defined as “pathological”,
(Seth,2014;Clark,2015;Bruinebergetal.,2016;Allenand inspiredbyworkontheFEPformotordisorders,psychosis
Friston,2016),withafocusonminimalgenerativemodels. andschizophreniaamongothers(Adamsetal.,2013;Friston
In this case, models are evaluated based on their ability to et al., 2016). Some pathologies, it has been suggested, can
allow an agent to perform a task or achieve a certain goal. berecapitulatedundertheFEPwhendifferentweightingpa-
Theinformationrecapitulatedinthesemodelsisonlyaptto rametersinagenerativemodel(precisions)arealtered. Our
perform ecologically relevant behaviour: inferring and en- simulationsinvestigatedacasewhereacombinationofhigh
codingmorepropertiesoftheworlddynamicsisnotanad- precisions on proprioceptive prediction errors and low pre-
vantageforanagent. Thisideaisdescribedwithinthefor- cisions on the relation between extero- and proprioceptive
malismoftheFEPasthecomplexity-accuracytradeoff. It beliefsresultedinareduced(orcompletelackof)abilityto
ispossibleinfacttorewriteequation(4)ininformationthe- move. AsimilarideawaspresentedinBrownetal.(2013)
oretical terms as a combination of measures of complexity where decreasing the confidence (precision) of sensations
andaccuracy(Fristonetal.,2006;Friston,2010).According aboutself-generatedmovementsisthoughttobeanecessary
tothisalternativereading,minimisingfreeenergyisequiva- conditionfortheinitiationofaction.
Wefinallyexploredhowsimplechangesinpriorscanpro- Braitenberg,V.(1986).Vehicles:Experimentsinsyntheticpsychol-
duce new emergent behaviours, for example an alternative ogy. MITpress.
versionofphototaxisandtwotypesofphotophobia,inline
Brown,H.,Adams,R.A.,Parees,I.,Edwards,M.,andFriston,K.
withvehicles2aand3a-b(Braitenberg,1986). (2013). Activeinference, sensoryattenuationandillusions.
The implementation of phototaxis we presented here is Cognitiveprocessing,14(4):411–427.
admittedly rather complicated. However, it constitutes a
Bruineberg,J.,Kiverstein,J.,andRietveld,E.(2016). Theantici-
complete example of an agentive system operating on the patingbrainisnotascientist: thefree-energyprinciplefrom
basis of the FEP and we would argue that models like this anecological-enactiveperspective. Synthese,pages1–28.
willbevitalifthepotentialoftheFEPandactiveinferenceis
Buckley,C.L.,Kim,C.S.,McGregor,S.,andSeth,A.K.(2017).
tobefullyunderstood.Theaction-orientedmodelweimple- Thefreeenergyprincipleforactionandperception:Amath-
mentedhasalsobeguntoaddresssomeoftheconcernsabout ematicalreview. arxivpreprintarXiv:1705.09156v1.
theFEP(Clark(2015);Bruinebergetal.(2016)),essentially
Clark, A. (2013). Whatever next? predictive brains, situated
worrying that interpretations of this framework have been agents, andthefutureofcognitivescience. Behavioraland
sofartoodependentonaperception-orientedaccountofbe- BrainSciences,36(03):181–204.
haviour. WewouldarguethattheFEPisneutralontheim-
Clark, A. (2015). Radical predictive processing. The Southern
plementationdetailsofagentivebehaviourandisthuscom-
JournalofPhilosophy,53(S1):3–27.
patible with many different cognitive frameworks. Indeed
Dayan, P., Hinton, G. E., Neal, R. M., and Zemel, R. S. (1995).
this neutrality is perhaps a central strength of the FEP as it
Thehelmholtzmachine. Neuralcomputation,7(5):889–904.
may provide a unified formalism within which to examine
differentunderstandingsofcognitivesystems. Feldman, H. and Friston, K. (2010). Attention, uncertainty, and
free-energy. Frontiersinhumanneuroscience,4:215.
Futuredirections
Friston,K.(2008). Hierarchicalmodelsinthebrain. PLoSCom-
Thispresentationconstitutesonlyasimpleproofofconcept putationalBiology,4(11).
ofaction-orientedapproachestotheFEP,withamorecom- Friston,K.(2010). Thefree-energyprinciple: aunifiedbrainthe-
pleteanalysisofourminimalgenerativemodelsleftforfu- ory? Naturereviews.Neuroscience,11(2):127–138.
ture work. In the future we will start by investigating the
Friston,K.,Brown,H.R.,Siemerkus,J.,andStephan,K.E.(2016).
possiblefunctionalbenefitsofthisarchitecturebasedonthe The dysconnection hypothesis (2016). Schizophrenia Re-
FEP. For instance, preliminary results comparing standard search,176(2):83–94.
Braitenberg vehicles and our implementation already sug-
Friston,K.,Kilner,J.,andHarrison,L.(2006). Afreeenergyprin-
gest a higher robustness of the latter in very noisy envi- cipleforthebrain. JournalofPhysiology-Paris,100(1):70–
ronmentsbecauseoflow-passfiltersimplementedbyequa- 87.
tion(16)andequation(17). Aseconddirectionwilladdress
Friston,K.,Thornton,C.,andClark,A.(2012). Free-energymin-
generative models with a less minimal set of assumptions,
imizationandthedark-roomproblem. Frontiersinpsychol-
including for example prior beliefs for exteroceptive input ogy,3:130.
(a target light intensity to achieve?) and the exploration of
Friston, K. J., Daunizeau, J., Kilner, J., and Kiebel, S. J. (2010).
behaviours that can only be performed with the implemen-
Actionandbehavior: Afree-energyformulation. Biological
tation of such mechanisms (maintaining a certain distance Cybernetics,102(3):227–260.
fromthelightsource?). Thiswillallowustoinvestigatethe
Friston, K. J., Trujillo-Barreto, N., and Daunizeau, J. (2008).
implications for the perception- vs. action-oriented debate
DEM:Avariationaltreatmentofdynamicsystems.NeuroIm-
on the interpretation of the FEP (Clark, 2015; Bruineberg age,41(3):849–885.
et al., 2016; Allen and Friston, 2016) for more complex
Hohwy,J.(2013). Thepredictivemind. OUPOxford.
adaptivebehaviours.
Knill,D.C.andPouget,A.(2004). Thebayesianbrain: therole
References ofuncertaintyinneuralcodingandcomputation.TRENDSin
Neurosciences,27(12):712–719.
Adams, R., Stephan, K., Brown, H., Frith, C., and Friston, K.
(2013). Thecomputationalanatomyofpsychosis. Frontiers Kullback,S.andLeibler,R.A.(1951). Oninformationandsuffi-
inPsychiatry,4:47. ciency. Theannalsofmathematicalstatistics,22(1):79–86.
Allen, M. and Friston, K. J. (2016). From cognitivism to au- Rao,R.P.andBallard,D.H.(1999). Predictivecodinginthevi-
topoiesis: Towards a computational framework for the em- sualcortex:afunctionalinterpretationofsomeextra-classical
bodiedmind. Synthese,pages1–24. receptive-fieldeffects. Natureneuroscience,2(1):79–87.
Bishop,C.M.(2006). Patternrecognition. MachineLearning. Seth,A.K.(2014).Thecyberneticbayesianbrain.InOpenMIND.
OpenMIND.FrankfurtamMain:MINDGroup.
Bogacz, R. (2015). A tutorial on the free-energy framework for
modellingperceptionandlearning. JournalofMathematical VonHelmholtz,H.(1867). HandbuchderphysiologischenOptik,
Psychology. volume9. Voss.