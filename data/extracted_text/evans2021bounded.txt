Bounded rationality for relaxing best response and mutual
consistency: The Quantal Hierarchy model of decision-making
Benjamin Patrick Evans∗ Mikhail Prokopenko
CentreforComplexSystems,TheUniversityofSydney,Sydney,NSW2006,Australia
Abstract
While game theory has been transformative for decision-making, the assumptions made can be
overly restrictive in certain instances. In this work, we investigate some of the underlying assump-
tions of rationality, such as mutual consistency and best response, and consider ways to relax these
assumptions using concepts from level-k reasoning and quantal response equilibrium (QRE) respec-
tively. Specifically, we propose an information-theoretic two-parameter model called the Quantal
Hierarchymodel,whichcanrelaxbothmutualconsistencyandbestresponsewhilestillapproximat-
ing level-k, QRE, or typical Nash equilibrium behavior in the limiting cases. The model is based
on a recursive form of the variational free energy principle, representing higher-order reasoning as
(pseudo) sequential decision-making in extensive-form game tree. This representation enables us to
treatsimultaneousgamesinasimilarmannertosequentialgames,wherereasoningresourcesdeplete
throughout the game-tree. Bounds in player processing abilities are captured as information costs,
wherefuturebranchesofreasoningarediscounted,implyingahierarchyofplayerswherelower-level
players have fewer processing resources. We demonstrate the effectiveness of the Quantal Hierarchy
model in several canonical economic games, both simultaneous and sequential, using out-of-sample
modelling.
1 Introduction
A crucial assumption made in Game Theory is that all players behave perfectly rationally. Nash Equi-
librium (Nash, 1951) is a key concept that arises based on all players being rational and assuming other
players will also be rational, requiring correct and consistent beliefs amongst players. However, despite
being the traditional economic assumption, perfect rationality is incompatible with many human pro-
cessing tasks, with models of limited rationality better matching human behaviour than fully rational
models(G¨achter,2004;Camerer,2010;Gabaixetal.,2006). Further,ifanopponentisirrational,thenit
would be rational for the subject to play “irrationally” (Raiffa and Luce, 1957). That is, “[Nash equilib-
rium] is consistent with perfect foresight and perfect rationality only if both players play along with it.
But there are no rational grounds for supposing they will” (Koppl and Barkley Rosser Jr, 2002). These
assumptions of perfect foresight and rationality often lead to contradictions and paradoxes (Cournot,
1838; Morgenstern, 1928; Hoppe, 1997; Glasner, 2020).
Alternate formulations have been proposed that relax some of these assumptions and model bound-
edly rational players, better approximating actual human behaviour and avoiding some of these para-
doxes(Simon,1976). Forexample, relaxingmutualconsistencyallowsplayerstoformdifferentbeliefsof
other players (Stahl and Wilson, 1995; Camerer et al., 2004) avoiding the infinite self-referential higher-
order reasoning which emerges as the result of interaction between rational players (Knudsen, 1993)
(I have a model of my opponent who has a model of me ... ad infinitum (Morgenstern, 1935)) and
non-computability of best response functions (Rabin, 1957; Koppl and Barkley Rosser Jr, 2002). The
ability to break at various points in the higher-order reasoning chain can be considered as “partial self-
reference” (L¨ofgren, 1990; Mackie, 1971). Importantly, rather than implicating negation (Prokopenko
etal.,2019), thistypeofself-referencerepresentshigher-orderreasoningasalogicallynon-contradictory
chain of recursion (reasoning about reasoning...). Hence, bounded rationality arises from the ability to
break at various points in the chain, discarding further branches. “Breaking” the chain on an other-
wise potentially infinite regress of reasoning about reasoning can be seen as the players limitations in
information processing, determining when to end the recursion.
∗benjamin.evans@sydney.edu.au
1
3202
raM
51
]TG.sc[
5v44851.6012:viXra
Anotherexampleofboundedrationalitybasedoninformationprocessingconstraintsistherelaxation
of the best response assumption of players, which allows for erroneous play, with deviations from the
best response governed by a resource parameter (Haile et al., 2008; Goeree et al., 2005).
In this work, we adopt an information-theoretic perspective on reasoning (decision-making). By
enforcing potential constraints on information processing, we are able to relax both mutual consistency
and best response, and hence, players do not necessarily act perfectly rational. The proposed approach
provides an information-theoretic foundation for level-k reasoning and a generalised extension where
players can make errors at each of the k levels.
Specifically, in this paper, we focus on three main aspects:
• Playersreasoningabilitiesdecreasethroughoutrecursioninawidevarietyofgames, motivatingan
increasing error rate at deeper levels of recursion. That is, it becomes more and more difficult to
reason about reasoning about reasoning ... (necessitating a relaxation in best response decisions).
• Finite higher-order reasoning can be captured by discounting future chains of recursion and ul-
timately discarding branches once resources run out. This representation introduces an implicit
hierarchy of players, where a player assumes they have a higher level of processing abilities than
other players, motivating relaxation of mutual consistency.
• Existing game-theoretic models can be explained and recovered in limiting cases of the proposed
approach. Thisfillsanimportantgapbetweenmethodsrelaxingbestresponseandmethodsrelaxing
mutual consistency.
The proposed approach features only two parameters, β and γ, where β quantifies relaxation of
players’ best response, and γ governs relaxation of mutual consistency between players. In the limit,
β → ∞ best response can be recovered, and in the limit γ = 1 mutual consistency can be recovered.
Equilibrium behaviour is recovered in the limit of both β → ∞,γ = 1. For other values of β and γ,
interesting out-of-equilibrium behaviour can be modelled which concurs with experimental data, and
furthermore, in repeated games that converge to Nash equilibrium, player learning can be captured in
the model with increases in β and γ. Importantly, we also show how fitted values of β and γ also
generalise well to out-of-sample data.
The remainder of the paper is organised as follows. Section 2 analyses bounded rationality in the
contextofdecision-makingandgametheory,Section3introducesinformation-theoreticboundedrational
decision-making, Section 4 extends the idea to capture higher-order reasoning in game theory. We then
use canonical examples highlighting the use of information-constrained players in addressing bounded
rational behaviour in games in Section 5. We draw conclusions and outline future work in Section 6.
2 Background and Motivation
While a widespread assumption in economics, perfect rationality is incompatible with the observed
behaviour in many experimental settings, motivating the use of bounded rationality (Camerer, 2011).
Bounded rationality offers an alternative perspective, by acknowledging that players may not have a
perfect model of each other or may not play perfectly rationally. In this section, we explore some
common approaches to modelling bounded rational decision-making.
2.1 Mutual Consistency
Equilibrium models assume mutual consistency of beliefs and choices (Camerer et al., 2003; Camerer,
2003), however, this is often violated in experimental settings (Polonio and Coricelli, 2019) where “dif-
ferences in belief arise from the different iterations of strategic thinking that players perform” (Chong
et al., 2005).
Level-k reasoning (Stahl and Wilson, 1995) is one attempt at incorporating bounded rationality by
relaxingmutualconsistency,whereplayersareboundtosomelevelkofreasoning. Aplayerassumesthat
other players are reasoning at a lower level than themselves, for example, due to over-confidence. This
relaxes the mutual consistency assumption, as it implicitly assumes other players are not as advanced
as themselves. Players at level 0 are not assumed to perform any information processing, and simply
choose uniformly over actions (i.e., a Laplacian assumption due to the principle of insufficient reason),
although alternate level-0 configurations can be considered (Wright and Leyton-Brown, 2019). Level-1
players then exploit these level-0 players and act based on this. Likewise, level-2 players act based on
2
other players being level-1, and so on and so forth for level-k players acting as if the other players are at
level-(k−1). Various extensions have also been proposed (Levin and Zhang, 2019).
A similar approach to level-k is that of Cognitive Hierarchies (CH) (Camerer et al., 2004), where
again it is assumed other players have lower reasoning abilities. However, rather than assuming that the
otherplayersareatk−1,playerscanbedistributedacrossthek levelsofcognitionaccordingtoPoisson
distribution with mean and variance τ. The validation of the Poisson distribution has been provided
in Chong et al. (2005), where an unconstrained general distribution offered only marginal improvement.
Again,variousextensionshavebeenproposed(Chongetal.,2016;KoriyamaandOzkes,2021)andthere
are many examples of successful applications of such depth-limited reasoning in literature, for example,
Goldfarb and Xiao (2011).
Endogenous depth of reasoning (EDR) is a similar approach to level-k and CH, but it separates the
player’scognitiveboundsfromtheirbeliefsoftheiropponent’sreasoning(AlaouiandPenta,2016). EDR
captures player reasoning as if they are following a cost-benefit analysis (Alaoui and Penta, 2022), with
cognitive abilities (costs) and payoffs (benefits).
One fundamental similarity across these methods is that they all maintain best-response. That is,
they best respond based on the lower-level play assumptions. The following section introduces methods
that instead maintain mutual consistency, but relax the best-response assumption.
2.2 Best response
Alternateapproachesassumethataplayermaymakeerrorswhendecidingwhichstrategytoplay,rather
than playing perfectly rationally. That is, they relax the best response assumption. Quantal Response
Equilibrium (McKelvey and Palfrey, 1995, 1998) (QRE) is a well-known example, where rather than
choosing the best response with certainty, players choose noisily based on the payoff of the strategies
and a resource parameter controlling this sensitivity. Another method of capturing this erroneous play
is Noisy Introspection (Goeree and Holt, 2004). Utility proportional beliefs (Bach and Perea, 2014) is
another method that relaxes the best response assumption, where the authors note that “possibly, the
requirement that only rational choices are considered and zero probability is assigned to any irrational
choiceistoostronganddoesnotreflecthowrealworld[players]reason”,givingmerittotherelaxationof
best-response. Byallowingforerrorsindecision-making,thesemethodsofferamorerealisticperspective
on how individuals make choices.
2.3 Infinite-Regress
When considering reasoning about reasoning, infinite regress can emerge Knudsen (1993). The problem
of infinite regress can be formulated as a sequence
A,f(A),f(f(A)),f(f(f(A)))
where the player is first confronted with an initial choice of an action a from the set of actions A, or a
computationf(A). Iftheactionischosen, thedecisionprocessiscomplete. If, instead, thecomputation
is chosen, the outcome of f(A) must be calculated, and the player is then faced with another choice
between the obtained result or yet another computation. This process is repeated until the player
chooses the result, as opposed to performing an additional computation. Lipman (1991) investigates
whether such sequence converges to a fixed point. A similar approach by Mertens and Zamir (1985)
formally approximates Harsanyi’s infinite hierarchies of beliefs (Harsanyi, 1967, 1968) with finite states.
2.4 Contributions of our work
In contrast to existing works, we propose an information-theoretic approach to higher-order reasoning,
where each level or hierarchy corresponds to additional information processing for the player. While
Alaoui and Penta (2016) capture the trade-off between additional reasoning and payoff, by measuring
thefirstintersectionoftheplayers’payoffimprovement(fromk tok+1),andthecostofperformingthis
additional reasoning c(k+1). This cost function c has to be determined (for all c(k)), for example, with
maximum likelihood estimation to estimate the average cost of performing this extra level of reasoning
(Alaoui and Penta, 2022). In contrast, we propose capturing this trade-off with information processing
costs by using the Kullback-Leibler divergence to constrain the overall change in action probabilities at
each stage of reasoning.
3
Ourapproachconstrainstheoverallamountofinformationprocessingavailabletotheplayers,leading
to potential errors at each stage of reasoning, which is not present in existing level-k type approaches.
By doing so, we establish a foundation for “breaking” the chain of higher-order reasoning based on the
depletion of players’ information processing resources.
This results in a principled information-theoretic explanation for decision-making in games involving
higher-order reasoning. Best response is relaxed with β <∞ (linking to Quantal Response Equilibrium)
andmutualconsistencyisrelaxedwithγ <1(linkingtolevel-k typemodels). Bestresponseandmutual
consistency are recovered with β → ∞ and γ = 1. This contributes to the existing literature on game
theory and decision-making by adopting an information-theoretic perspective on bounded rationality,
quantified by information processing abilities. A key benefit of the proposed approach is while level-k
modelsrelaxmutualconsistency,butretainbestresponse,andQREmodelsrelaxbestresponsebutretain
mutualconsistency(Chongetal.,2005),theproposedapproachisabletorelaxeitherassumptionthrough
the introduction of two tunable parameters. We apply this model to various games, demonstrating the
usefulness of the proposed approach for capturing human behaviour when compared to these existing
approaches.
3 Technical Preliminaries: Information-Theoretic Bounded Ra-
tionality
Informationtheoryprovidesanaturalwaytoreasonaboutlimitationsinplayercognition,asitabstracts
awayspecifictypesofcosts(Wolpert,2006;Harr´e,2021). Thismeansthatwecanassumetheexistenceof
cognitive limitations without speculating about the underlying behavioural foundations. As pointed out
by Sims (2003), an information-theoretic treatment may not be desirable for a psychologist, as this does
not give insights to where the costs arise from, however, for an economist, reasoning about optimisation
rather than specific psychological details may be preferable, for example, in the Shannon model (Caplin
etal.,2019). Suchmodelshaveseenconsiderablesuccessinavarietyofareasforinformationprocessing,
for example, embodied intelligence (Polani et al., 2007), self-organisation (Ay et al., 2012) and adaptive
decision-making of agents (Tishby and Polani, 2011) based on the information bottleneck formalism
(Tishby et al., 1999).
In this work, we adopt the information-theoretic representation of bounded rational decision-making
proposed by Ortega and Braun (2013), which has been further developed in (Ortega and Braun, 2011;
Braun and Ortega, 2014; Ortega and Stocker, 2016; Gottwald and Braun, 2019). This approach has
a solid theoretical foundation based on the (negative) free energy principle and has been successfully
applied to several tasks (Evans and Prokopenko, 2021). We begin by providing an overview of single-
step decisions and then sequential decisions, before discussing extensions for capturing the relationship
between processing limitations and higher-order reasoning.
3.1 Single-step Decisions
A boundedly-rational decision maker who is choosing an action a ∈ A with payoff U[a] is assumed to
follow the following negative free energy difference when moving from a prior belief p[a], e.g., a default
action, to a (posterior) choice f[a], given by:
(cid:18) (cid:19)
(cid:88) 1 (cid:88) f[a]
−∆F[f[a]]= f[a]U[a]− f[a]log (1)
β p[a]
a∈A a∈A
The first term represents the expected payoff, while the second term represents a cost of information
acquisition that is regularised by the parameter β. Formally, the second term quantifies information
acquisition as the Kullback-Leibler (KL) divergence from the prior belief p[a]. Parameter β, therefore,
serves as the resource allowance for a decision-maker.
By taking the first order conditions of Eq. (1) and solving for the decision function f[a], we obtain
the equilibrium distribution:
1
f[a]= p[a]eβU[a] (2)
Z
where Z = (cid:80) p[a(cid:48)]eβU[a(cid:48),x] is the partition function. This representation is equivalent to the logit
a(cid:48)∈A
function (softmax) commonly used in QRE models, and relates to control costs derived in economic
literature (Stahl, 1990; Mattsson and Weibull, 2002).
4
The parameter β serves as a resource allowance for the decision-maker, modulating the cost of in-
formation acquisition from the prior belief. Low values of β correspond to high costs of information
acquisition (and high error play), while as β →∞, information becomes essentially free to acquire, and
the perfectly rational homo economicus player is recovered.
3.2 Sequential Decisions
This free energy definition can be extended to sequential decision-making by considering a recursive
negative free energy difference, as described in (Ortega and Braun, 2013, 2014). This corresponds to
a nested variational problem, and involves introducing new inverse temperature parameters β for K
k
sequential decisions, which allows for different reasoning at different depths of recursion to choose a
sequence of K actions a .
≤K
Therefore, for sequential decision-making, Eq. (1) can be represented as:
K (cid:18) (cid:19)
−∆F[f]= (cid:88) f[a ] (cid:88) U[a |a ]− 1 log f[a k |a <k ] (3)
≤K k <k β p[a |a ]
k k <k
a≤K k=1
where a abbreviates the history a ,..,a of decisions. We can expand the sum:
<k o k−1
(cid:18)
= (cid:88) f[a ] U[a ]− 1 f[a ]log f[a 1 ] +
1 1 β 1 p[a ]
1 1
a1
(cid:18)
(cid:88) f[a |a ] U[a |a ]− 1 f[a |a ]log f[a 2 |a 1 ] +
2 1 2 1 β 2 1 p[a |a ]
2 2 1 (4)
a2
...
(cid:18) (cid:19)(cid:19)
+ (cid:88) f[a |a ] U[a |a ]− 1 f[a |a ]log f[a K |a <K ]
K <K K <K β K <K p[a |a ]
K K <K
aK
which we can see as first choosing an action a at k = 1, while considering that in order to choose this
1
action, we must consider the future stages by analysing the result at k = 2 given the choice a , and so
1
forth. To compute this, we can solve the innermost sum first:
1
f[a |a ]= p[a |a ]eβKU[aK|a<K] (5)
K <K Z K <K
K
which recovers Eq. (2) with the introduction of conditioning on decision histories. This represents the
base-case for recursion. For steps where k <K, we get the following equilibrium solution for sequential
decisions:
(cid:18) (cid:19)
1 1
f[a |a ]= p[a |a ]exp β (U[a |a ]+ logZ )
k <k Z k <k k k <k β k+1
k k+1
1 (6)
=
Z k
p
(cid:124)
[a
k (cid:123)
|
(cid:122)
a
<k (cid:125)
]× Z
(cid:124) k
β
+
k
(cid:123)
/
1 (cid:122)
βk+
(cid:125)
1 ×e
(cid:124)
βkU[
(cid:123)
a
(cid:122)
k|a<k
(cid:125)
]
PriorBelief FutureContribution CurrentPayoff
wheredecisionsarenowdependentonthehistoryofdecisionsaswellasonarecursivecomponentbased
on the future contribution of each decision. Here
Z
k
= (cid:88) p[a
k
|a
<k
]Z
k
β
+
k/
1
βk+1eβkU[ak|a<k] (7)
ak
where Z =1, i.e., the base-case for recursion at the final level.
K
3.3 Extension
With this formal and generic treatment of information-processing costs for sequential decision-making,
it is desirable to use this to capture bounded rational reasoning of an agent making sequential or simul-
taneous decisions in games. By representing reasoning as an extensive-form game tree, these two can
be captured in a similar manner. Simultaneous decisions can be treated as if they are pseudo-sequential
decisions, considering possible repercussions for various choices.
5
To model higher-order reasoning, we extend the information-theoretic formulation for sequential de-
cisionsdiscussedinSection3.2. Thisinvolvesrepresentingreasoningasa(pseudo)sequenceofdecisions,
where each decision corresponds to a ”level” of reasoning. At each level, players may play incorrectly,
producing a level-k play that is modulated by β . A high β corresponds to an exact level-k thinker,
k k
while a low β corresponds to an error-prone level-k thinker. We can formalise this chain of reasoning
k
as an extensive-form game tree, where at the root node, a player is faced with a decision to choose from
a set of available options A or perform additional processing f(A) to acquire new information on the
beliefsandrepercussionsofeachchoice. Iftheplayerchoosesnottoprocessadditionalinformation,each
branch is terminated early, and the player makes a decision based solely on the immediately available
information. However, iftheplayerchoosestoprocessadditionalinformation, eachactionbranchis(po-
tentially) extended to analyze the possible repercussions of taking an action, and a higher level thinker
canexaminetheserepercussions. Thisprocesscontinuesuntiltheplayerrunsoutofprocessingresources
or, in a finite problem, converges to a solution. For example, in the p-beauty contest analyzed in later
sections, convergence occurs once the guess hits 0.
This extensive-form game tree representation means reasoning about simultaneous decisions can
be treated in the same manner as decisions in sequential games. However, the key issue here is the
requirement of Eq. (6) to have K information processing parameters for each step or level of reasoning.
In order to analyse the purpose of these parameters, we consider a simple case, setting β =β for all k,
k
giving discrete control (Braun et al., 2011):
1
f[a
k
|x,a
<k
]=
Z
p[a
k
|a
<k
]Z
k+1
eβU[ak,x|a<k] (8)
k
whichclarifiesthattheboundednessappliestothecomputationofpayoffU,butthedepthofreasoning(or
recursion-depth) is dependent on the length of the sequence (or level) K, not on β. To represent higher-
order reasoning more succinctly, it would be desirable to implicitly base the sequence length K on the
resourceparameterβratherthankeepingthemseparate. Thiswouldallowustotreatrecursivereasoning
ininformation-theoreticterms. Forinstance, whenβ →∞, K →∞, whichcaptures(potential)infinite-
regress, while β =0 would imply K =0, leaving the player with no information processing abilities.
In order to achieve this, β must be reduced at each level k. This reduction in β at each level
is related to the relaxation of mutual consistency, reflecting how a player perceives other (lower-level)
players’reasoningabouttheproblem. Inthenextsection,weoutlineourproposedapproachformodelling
this. This extension allows us to reason directly about resource constraints instead of sequential level-k
thinking.
4 Proposed Approach
The proposed approach implicitly enforces the assumption that, in sequential games, it becomes more
difficult to reason to later stages in the game (e.g. in chess, it is difficult to reason 5 steps-ahead), and
likewise in simultaneous games, it is difficult to perform the level of higher-order reasoning required to
arriveattheequilibriumsolution. Thefurtheraplayermentallytriestoreason, themorelikelyanerror
is to occur, as the processing resources deplete. This assumption is captured under the proposed model
in a generic information-theoretic sense.
The key concept is that it becomes more difficult to reason about reasoning, that is the further one
tries to explore through the extensive-form tree. This overall process is visualised Fig. 1, where the
players reasoning error increases throughout the steps of reasoning. This representation can be thought
of as a hierarchy of players noisily responding to lower level players, or as a sequential decision with
increasing noise at each step. Once a player’s resources deplete, the later depths simply echo the prior
beliefs as the noise obstructs the payoffs.
4.1 Quantal Hierarchy Model
To model higher-order reasoning with processing costs, we propose a more flexible and succinct ap-
proachthansimplysettingamaximumdepthK andcorrespondingparametersβ inapseudo-sequential
k
decision-making task. Instead, we introduce an overall information processing parameter β, which cap-
tures the available information processing resources for a player, and a discount parameter γ ∈ [0,1],
which controls the reduction in player rationality throughout the reasoning chain. This approach allows
for heterogeneous bounds on player reasoning, relaxing the assumptions of best response and mutual
6
...
Depth 1 Depth 2 Depth 3 Depth K
Figure1: Theeffect ofdiscounting resourcesovertime. Inthebeginning, theplayerhas β resourcesand
may make some error (red bars). Parameter γ controls how this error grows over time and, implicitly,
how the player believes lower-level players will respond. A low γ means the errors increase drastically
at each level, assuming opponents with much lower reasoning abilities. As βγk →0, the noise increases,
and the recursion eventually stops once the utilities become indistinguishable (i.e., the player can not
reason any deeper).
consistency. We refer to this approach as the Quantal Hierarchy (QH) model, as it shares formal sim-
ilarities with Quantal Response Equilibrium and Cognitive Hierarchy models, as discussed in previous
sections.
4.1.1 Formulation
We represent reasoning as information-constrained sequential decision-making. The proposed formula-
tion features only two parameters, β and γ ∈ [0,1] (as opposed to the vector β and number of levels
k
K). Reasoning resources are then set as
β =βγk
k
i.e., β is β discounted based on γ and the current depth of reasoning. This can be represented by the
k
following recursive free energy difference:
∞ (cid:18) (cid:19)
−∆F[f]= (cid:88) f[a ] (cid:88) U[a |a ]− 1 log f[a k |a <k ] (9)
≤K k <k βγk p[a |a ]
k <k
a≤K k=0
where we have represented the sequence as an infinite-sum. The sum converges due to the discount
parameter as the later (inner-most sums) simply echo the prior beliefs once the player’s computational
resources are exhausted. This formalisation draws parallels with the reinforcement learning (RL) meth-
ods, wheresuchrepresentationsarecommonforreasoningaboutfuturestatesfortheplayer. InRL,γ is
usedtodiscountfuturetimesteps. Here,γ isusedtodiscountfuturechainsofreasoningaboutreasoning
(i.e., the depth of recursion is governed by β discounted by γ), and to represent the limited resources
that we believe other players have. We have represented this as in infinite sum with k →∞, however, in
variousproblems(suchassequentialgames)K canbeassumedtobefinite. Thesolutionforthedecision
function f[a |a ] with the discounted β becomes:
k <k

1 p[a |a ], if βγk ≈0
 Z
Z 1
k
k
(cid:124)
p (cid:124)
P
[a
ri
k
k
or
(cid:123)
(cid:123) |
(cid:122)
(cid:122)
B
a
e
<
<
lie
k
k
f
(cid:125)
(cid:125) ]× e (cid:124) βU[a (cid:123) k (cid:122) |a<k (cid:125) ] , if γ =0
f[a k |a <k ]= PriorBelief CurrentPayoff (10)

Z 1 k p (cid:124)
P
[a
ri
k
or
(cid:123) | (cid:122)
B
a
e
<
lie
k
f
(cid:125) ]×
Future
Z (cid:124)
C
(cid:123) k
o
1 (cid:122)
n
+ /
t
γ (cid:125) 1
ribution
×e (cid:124)
C
β
u
γ
r
k
re
U
n
(cid:123) [
t
a (cid:122) k
P
|
a
a
y
<
o
k
ff
(cid:125) ], otherwise
which aims to capture decisions based on the beliefs of other players reasoning at later stages. With the
assumption of a discount rate γ, we can see the recursion is now depth-bound based on the (discounted)
7
resource parameter. Once βγk → 0 1, the recursion will stop since the result will simply echo the prior
beliefasnofocuswillbeplacedonthepayoff, becomingthebasecaseforrecursion(the“naive”player).
This means that in the new implicit limit K 2 (denoted by the case where β ≈0), reasoning about the
k
future provides no new information, which recovers the original form of Eq. (5) (when γ = 1) with the
introduction of conditioning on histories.
With the proposed representation, what was previously thought of in the context of sequential deci-
sions,canbeextendedandmodifiedtothinkabouthierarchiesofbeliefs. Theinformationallyconstrained
players “break” the chain of reasoning due to depleting their cognitive or computational capabilities as
bounded by β and γ. Formally, this is represented as a (potentially) infinite-sum that converges based
on γ. By discounting future computation in a chain of recursion, we can approximate higher-order
reasoning, where players become increasingly limited as the reasoning chain progresses, making it more
challenging to reason about reasoning.
4.1.2 Parameters
Resource Parameter The resource parameter β quantifies the amount of processing a player can
perform. Perfect utility maximisation behaviour is recovered with β → ∞. With β < ∞, players are
assumed to be limited in computational resources and must now balance the trade-off between their
computation cost and payoff. With β → 0, players have no processing resources, and choose based on
their prior beliefs (default actions). Anti-rational (or adversarial) play can be modelled with β →−∞.
Discount ParameterThediscountparameterγ quantifiesotherplayersmentalprocessingabilities
in terms of level-k thinking. A high γ assumes other players play at a relatively similar cognitive level,
whereas a low γ assumes other players have less playing ability. With γ < 1, Eq. (10) is guaranteed to
converge to a finite sequence of decisions, where the ability to process information decreases the further
wegetthroughthesequence. Thiscapturesthebelief aboutplayatlaterstagesofreasoning,whereother
playersareassumedtobelessrational(andthus,morenoisy)asgovernedbyγ. Thecaseγ <1implicitly
relaxes mutual consistency as lower-level thinkers are then governed by a lower resource parameter, and
allows for players to believe that players at later nodes behave more noisily. In the case of otherwise
infinite regress (where backward induction can not be used), the limited foresight approach proposed
converges to a finite approximation of the sequence by relaxing the assumption of mutual consistency.
In tractable problems, we recover an approximation of backward induction where the player performing
such induction may make errors at each step due to limited computational processing abilities. With
γ =1,werecovermutualconsistency,asweassumeotherplayersarejustasrationalasourselves,andin
thespecialcasewithuniformpriorbeliefsandγ =1,wecollapsetoalogitformofagentQRE(McKelvey
and Palfrey, 1998; Turocy, 2010). The special case for γ =0 exists in Eq. (10) as in this case, no future
processing will be performed.
In the limit, with β → ∞,γ = 1, perfect backward induction is recovered (see Appendix B.1).
Crucially,theproposedQHmodelallowsforageneralrepresentation,relaxingtheperfectrationalityas-
sumption (with β <∞,γ <1), which can model out-of-equilibrium behaviour compatible with observed
experimentaldata. Weexploretheroleoftheseparametervaluesinmoredetailinthefollowingsection.
Parameter Interactions In Fig. 2 we visualise how β and γ interact in a general setting. For
β → ∞ and γ = 1, we approach payoff maximisation behaviour, i.e., the perfectly rational (Nash
Equilibrium)playerisrecovered. Forβ →−∞andγ =1,payoffminimisationbehaviour(anadversarial
player) is recovered. In between, we can see how γ adjusts β. It is these values in between random play
(β = 0) and perfect payoff maximisation behaviour which are particularly interesting, as they give rise
to out-of-equilibrium behaviour not predicted by traditional methods.
4.2 Explanation
We work through a generic example of the QH model on an extensive-form game tree. A player is
given decision-making resources, governed by β, to make a decision f. At each stage of reasoning k, the
player’s resources are discounted by γ. Ultimately, the player’s resources become depleted (at K, i.e.,
once βγk ≈0), and the game tree is considered terminated, and the naive player chooses based on their
prior belief (which we assume to be uniform). This decision is then propagated backwards, and becomes
thepriorbeliefatthehigherstageofreasoningp[a ],wheretheplayerhasprocessingresourcesβγK−1,
K−1
and hence, noisily responds to the lower-level play based on these resources. This process is continued,
1e.g. whenβγk<(cid:15)where(cid:15)issomesmallenoughtermwherethepayoffsbecomeindistinguishable,here,(cid:15)=10−8
2incontrasttolevel-k,hereK indicatesthelevelwiththelowestresources
8
Perfectly Rational
β
→∞
β=0 Uniform
β
→−∞
γ=0 γ=1 Anti Rational
Figure 2: A heatmap visualising the resulting players expected payoff based on the values of β and γ.
Theyellowcolourrepresentsthemaximalexpectedpayoff,andthepurplecolourrepresentstheminimum
expected payoff. When either parameter is 0, the result is a random choice amongst the actions.
with noisy responses from the lower-level thinker captured by the resource constraint. Finally, once all
results have been recursively propagated, the higher-level players’ decision is made (which may still be
noisy, as captured by β). That is, their decision is made recursively, starting from the most basic level
of player reasoning (the naive player) and reasoning upwards.
4.2.1 Basic Example
To help illustrate the proposed approach, we will use a simplified version of the Ultimatum game (see
Appendix C.4) as a specific example. In this game, a player must decide what percentage of a pie to
take. We assume that there are uniform priors among the available options at each stage.
At the first stage, Player 1 must request the percentage of the pie they want to take, denoted by
a ∈[0,100],with100givingthehighestpayoff(i.e.,theyreceivetheentirepie). However,atthesecond
1
stage, Player 1 encounters a fairness calculator (Player 2). Player 2 decides whether or not to approve
Player 1’s request, denoted by A ={accept,reject}. The decisions are based on the following utilities:
2
U [a ]=a ×f [accept|a ]
1 1 1 2 1
U [accept |a ]=100−a (11)
2 2 1 1
U [reject |a ]=50
2 2 1
where U corresponds to Player n’s payoff, and f the probability with which Player n chooses the
n n
action. Aplayerwhohasnolook-ahead,i.e.,onewhoassignszeroweighttofuturedecisions(orassumes
that their opponent has zero processing abilities), can be represented with β → ∞ and γ = 0. Such a
player simply looks at the first stage and sees that it is in their best interest to request 100% of the pie.
However, this player fails to take into account the repercussions of their chosen action, as they did not
consider the future decisions. They did not compute f [a | a ], and thus assumed that f [a | a ] is
2 2 1 2 2 1
uniform and that their opponent would be indifferent to accepting or rejecting their request regardless
of the value of a .
1
A perfectly rational player with unlimited computational resources, i.e., β = ∞ and γ = 1, would
request 49 (assuming integer requests). They assign weight to the future of their actions, and can see
that for any a > 50, the fairness calculator will deny their request, and they will be left with nothing
(at a=50, the calculator will be indifferent to accepting or rejecting their request). This corresponds to
the subgame perfect equilibrium, where the player performed backward induction. That is, the player
examined the future until they reached the end of the game and then reasoned backwards to request the
optimal choice.
Aplayerwithlimitedcomputationalresources, i.e., β <∞, requeststhebestactiontheycansubject
to their resource constraint. For example, they may only request a=40, as they are unable to complete
thesearchfora=49. Aplayerwithnoinformationprocessingabilities,i.e.,β =0,cannotsearchforany
optimal choices and therefore chooses based on the prior distribution, which we assumed to be uniform.
Therefore, the player is equally likely to choose any a∈A.
An interesting question that arises is what if we assume that the ”fairness” calculator may make
errors, and that it is not necessarily defined by a step function that rejects all requests above 50 and
9
accepts all below. For example, there may be a range where 100 will get rejected, but perhaps 75 would
not. This can be captured with βγ <∞, where the calculator is assumed to make errors for low values,
and for βγ → ∞, it is assumed to be perfectly rational. If the fairness calculator is broken and is
indifferent to accepting or rejecting values, this can be represented with γ =0, which gives 0 processing
ability to the calculator. This means f [accept | a ] = f [reject | a ] = 0.5, and therefore, a rational
2 2 1 2 2 1
Player 1 should request a =100.
1
Thisexampleshowstheusefulnessoftheproposedapproach,andhowmodifyingβ andγ cancapture
a variety of heterogeneous behaviours between the two players.
5 Results
Inthissection,weperformout-of-samplecomparisonsacrossvariouscanonicaleconomicgames,including
both sequential and simultaneous games. We compare the proposed Quantal Hierarchy model against
well-known approaches to capturing bounded rational reasoning, including QRE, level-K and Cognitive
Hierarchy,aswellastheNashequilibriumpredictedsolutions. Toassesstheperformanceofeachmethod,
we fit the corresponding parameter values to experimental data and then evaluate the performance on
hold-out data. For the Quantal Hierarchy method, these parameter values are β and γ. For QRE, the
parameter value is λ, which serves a similar purpose as β in our approach, i.e., relaxing best response.
Forlevel-k,theparametervalueisthestepsofreasoningk. ForCognitiveHierarchy,theparametervalue
is τ, corresponding to the Poisson distribution of level-k thinkers. Further information on model fitting
is given in Appendix A.
Weshowhowtheproposedapproachconvincinglycaptureshumanbehaviourandgeneralisesbeyond
the training examples, outperforming existing approaches on a wide range of games.
5.1 Performance on Canonical Games
For this work, we use various experimental data from canonical economic sequential and simultaneous
games. Specifically, for simultaneous games, we analyse market entrance and beauty contest games, and
for sequential games, centipede, and bargaining games.
Formarketentrancegames,weusethedataofCamerer(2011),originallypresentedin(Sundalietal.,
1995). Forthebeautycontestgame,weusep-beautycontestresultsfrom(Bosch-Domenechetal.,2002).
For the Centipede games, we use the four and six-level data from (McKelvey and Palfrey, 1992). For
the sequential bargaining games, we use the Ultimatum game and two-stage game from Binmore et al.
(2002) (Game 1 and 3 in their paper). Further discussion on game specifics, utilities, and experimental
analysis is given in Appendix C.
For each game, we perform 5x2 repeated cross-fold validation (Dietterich, 1998), analysing the out-
of-sample performance. This analysis ensures that the inclusion of an additional parameter does not
overfit to the original training data, and instead, ensures the approach generalises well to unseen data.
We present the average RMSE on the unseen data and the resulting rankings (Demˇsar, 2006) of each
method in Table 1. The rankings account for the independence of the games, and the inability to
compare errors directly across game classes. A visualisation of the resulting ranks in Fig. 3. By using
theseevaluationmetrics,weareabletodeterminetheeffectivenessoftheproposedmethodincomparison
to existing approaches for predicting (out-of-sample) human behaviour on a range of canonical games.
TheproposedQuantalHierarchymethodconsistentlyperformswellacrossthevariousgamestrialled,
resultinginthebest(lowest)overallrank(Table1),aswellasthemostconsistent(narrowestdistribution
of results, Fig. 3), always performing in the top 2. These results validate the modelling assumption that
itbecomesmoredifficulttoreasonatdeeperlevelsofreasoning,andthus,thereasoningprocessbecomes
moreerroneous. ThismotivatestheusageoftheQuantalHierarchymodelforcapturinghumandecision-
making in a wide-range of settings.
In the following subsections, we analyse the game results in more detail.
5.2 Simultaneous Games
Market Entrance Inthemarketentrancegame,playersmustsimultaneouslydecidewhethertoenter
or stay out of a market, where the payoff depends on the decisions of the other players and market
capacity c (see Appendix C.1). Experimental data show that player behaviour in market games is
inconsistent with either mixed or pure Nash equilibria, although, with repeated play, players begin to
approach the mixed strategy equilibrium (Duffy and Hopkins, 2005).
10
Quantal Cognitive QuantalResponse
Level-k Nash
Hierarchy Hierarchy Equilibrium
Market Entrance Block1 0.565(2) 1.503(5) 0.725(3) 0.564(1) 1.242(4)
Block2 0.426(1) 2.115(5) 1.077(4) 0.442(2) 0.726(3)
Block3 0.387(1) 2.230(5) 1.283(4) 0.406(2) 0.548(3)
Block4 0.493(2) 2.344(5) 1.365(4) 0.431(1) 0.559(3)
Block5 0.489(1) 2.513(5) 1.387(4) 0.519(2) 0.574(3)
AverageRank 1.4 5 3.8 1.6 3.2
Beauty Contest Lab 0.020(1) 0.191(4) 0.175(3) 0.027(2) 0.194(5)
Classroom 0.042(2) 0.188(4) 0.162(3) 0.019(1) 0.190(5)
TakeHome 0.056(2) 0.188(4) 0.162(3) 0.020(1) 0.192(5)
Internet 0.053(2) 0.180(4) 0.149(3) 0.024(1) 0.181(5)
Newspaper 0.061(2) 0.186(4) 0.149(3) 0.024(1) 0.187(5)
Theorists 0.071(2) 0.171(4) 0.135(3) 0.040(1) 0.172(5)
AverageRank 1.83 4 3 1.17 5
Centipede 4-levelCentipede 0.469(1) 1.774(4) 0.611(3) 0.606(2) 3.715(5)
6-levelCentipede 0.350(1) 1.950(4) 0.439(2) 1.120(3) 2.837(5)
AverageRank 1 4 2.5 2.5 5
Bargaining Ultimatum
-(10,10) 0.051(1.5) 0.098(3.5) 0.098(3.5) 0.051(1.5) 0.197(5)
-(10,60) 0.030(1) 0.093(3.5) 0.093(3.5) 0.057(2) 0.192(5)
-(70,10) 0.048(2) 0.090(3.5) 0.090(3.5) 0.047(1) 0.187(5)
Two-stageBargaining
-D=0.9 0.040(1) 0.096(3.5) 0.096(3.5) 0.084(2) 0.198(5)
-D=0.8 0.054(1) 0.095(3.5) 0.095(3.5) 0.076(2) 0.198(5)
-D=0.7 0.048(1) 0.099(3.5) 0.099(3.5) 0.075(2) 0.197(5)
-D=0.6 0.067(1) 0.128(3.5) 0.128(3.5) 0.095(2) 0.197(5)
-D=0.5 0.037(1) 0.111(3.5) 0.111(3.5) 0.054(2) 0.190(5)
-D=0.4 0.030(1) 0.105(3.5) 0.105(3.5) 0.039(2) 0.191(5)
-D=0.3 0.024(1.5) 0.081(3.5) 0.081(3.5) 0.024(1.5) 0.192(5)
-D=0.2 0.052(2) 0.117(3.5) 0.117(3.5) 0.050(1) 0.196(5)
AverageRank 1.27 3.5 3.5 1.73 5
Overall Rank 1.37 4.12 3.2 1.75 4.55
Table1: Averageout-of-sample(5x2-foldcross-validation)error. Resultingranksareindicatedinbrack-
ets. In both cases, lower is better. Tied values receive the average rank between the ranks which would
have been achieved had there been no ties. The overall rank is determined as the mean rank of the
average rank across the game classes, meaning each game has an equal weighting in the overall rank,
and the number of experiments for a game class does not affect this overall weight.
These deviations from equilibrium are captured well by the proposed Quantal Hierarchy model
(Fig. 4). We see that in the beginning (before learning, Fig. 4a), the players overestimate for low c
and underestimate for high c. Towards the final rounds (after learning, e.g. Fig. 4e), the behaviour
approaches equilibrium, and the proposed QH model approximates this well using an increase in pro-
cessing resources β and/or γ (see Table 2) to capture this player “learning”. These changes highlight an
importantpropertyoftheQHmodel. Ifaplayerislearning,i.e.,becomingclosertorational,thisshould
correspond to an increase in β (and/or an increase in γ).
The level-k model fails to capture the overall trend, and in fact, is best fitted with k =0, performing
worse than the mixed strategy equilibrium (and all other alternatives). The reason for this is simple.
Level-k (k ≥ 1) implies a step function, where for c > T where T is some threshold, the player enters
withcertainty, andforc≤T, theplayerstaysoutwithcertainty. Thedistancetotheexperimentaldata
from this step function is greater than the uniform case (k = 0), so the uniform case is chosen. The
cognitivehierarchymodelimprovesuponlevel-k,byfittingadistributionofk thinkers,ableto“smooth”
out this step function, with the line shown in Fig. 4. While this captures the qualitative trend (over
entry for low c, under entry for high c, near equilibrium for mid c), quantitatively, the approach is not
as strong as QRE, Quantal Hierarchy, or even the mixed-strategy equilibrium in most cases.
The QRE model is also a good fit here, however, due to the representation is constrained to linear
lines. In contrast, the QH representation can capture such “S” shape curves, better approximating the
experimental data in 3 out of the 5 blocks. QRE and QH significantly outperform the approaches which
just relax mutual consistency (level-k and CH), motivating the relaxation of best-response in addition
11
5.0
4.0
3.0
2.0
1.0
Quantal Level-k Cognitive Quantal Nash
Hierarchy Hierarchy Response Equilibrium
Figure 3: Overall rankings for out-of-sample errors across the various game classes trialled. The bars
indicate the range of achieved ranks (worst achieved to best achieved ranking), with the middle bar
indicating the median ranking. A lower ranking is better (with 1=best).
Quantal Level-k Cognitive Quantal Response
Hierarchy Hierarchy Equilibrium Nash
β, γ k τ λ
Market Entrance Block 1 0.43, 0.24 0.0 0.72 10.39
Block 2 0.67, 0.18 0.0 0.68 34.56
Block 3 0.62, 0.28 0.0 0.65 59.44
Block 4 0.32, 0.54 0.0 0.69 83.51
Block 5 0.75, 0.19 0.2 0.72 80.8
Beauty Contest Lab 0.08, 0.76 1.2 5.45 1.21
Classroom 0.1, 0.69 1.7 5.52 1.9
Take Home 0.06, 0.79 2.4 5.36 2.2
Internet 0.07, 0.72 3.3 5.67 2.31
Newspaper 0.08, 0.64 6.3 5.76 2.8
Theorists 0.05, 0.67 5.6 5.84 3.02
Centipede 4-level Centipede 12.43, 0.22 0.0 1.82 2.09
6-level Centipede 19.1, 0.14 0.3 2.3 1.09
Bargaining Ultimatum
- (10, 10) 0.08, 0.92 0.0 4.36 0.08
- (10, 60) 0.2, 0.32 0.0 4.84 0.09
- (70, 10) 0.06, 0.88 0.0 3.68 0.06
Two-stage Bargaining
-D=0.9 0.24, 0.13 0.0 4.07 0.04
-D=0.8 0.2, 0.22 0.0 4.29 0.05
-D=0.7 0.22, 0.28 0.0 3.73 0.06
-D=0.6 0.52, 0.2 0.0 3.89 0.08
-D=0.5 0.2, 0.36 0.0 2.97 0.11
-D=0.4 0.19, 0.38 0.0 3.78 0.1
-D=0.3 0.13, 0.49 0.0 3.69 0.08
-D=0.2 0.17, 0.52 0.0 8.02 0.11
Table 2: Average fitted parameter values for each approach. Explanation of the parameters and the
fitting procedure is given in Appendix A.
to mutual consistency.
p-Beauty contest In the p-beauty contest (Moulin, 1986), players must try and guess p times the
average guess (in the range [0,100]) of other competitors (see Appendix C.2). The Nash equilibrium is
for all players to guess 0, however, experimentally, we see large deviations from this behaviour.
Analysing the experimental results (Fig. 5), we see very strong performance for the QH model when
modelling the less experienced players, e.g. in the Lab experiments. The QH model fits the data well,
12
1.0 1.0 1.0 1.0 1.0
qh
ch
level-k
0.8 q na re sh 0.8 0.8 0.8 0.8
target
0.6 0.6 0.6 0.6 0.6
0.4 0.4 0.4 0.4 0.4
0.2 0.2 0.2 0.2 0.2
0.0 1 3 5 7 9 11 13 15 17 19 0.0 1 3 5 7 9 11 13 15 17 19 0.0 1 3 5 7 9 11 13 15 17 19 0.0 1 3 5 7 9 11 13 15 17 19 0.0 1 3 5 7 9 11 13 15 17 19
(a) Block 1 (b) Block 2 (c) Block 3 (d) Block 4 (e) Block 5
Figure4: MarketEntranceGame. Thedarkerlinesindicatethemeanresultfromthe5x2cross-validation.
The shaded regions indicate ± one standard deviation. The out-of-sample data are shown as the black
circles. The proposed Quantal Hierarchy model is the purple line. Quantal Response Equilibrium is the
orange line, level-k is the blue line, and Cognitive Hierarchy is the green line. The Nash equilibrium
solution is indicated as the diagonal dashed grey line.
capturingtheoveralldistributionandachievingthelowesterrorrate. However,fortheotherexperiments
composed of more experienced players or players with more time (take home, newspaper), we see the
distribution is better approximated by QRE.
The reason for this performance is because under the proposed approach, as a player becomes more
rational, the distribution of choices narrows in to the optimal choice (see Fig. 6). However, under these
experimental settings, even in the theorist case, there is bounded rational (and in fact, anti-rational)
behaviour. These deviations are captured well by QRE. However, it is difficult for the QH model to
capture the wide distribution of choices, as well as the bulk probability mass around the optimal case.
For example, in Fig. 6 we show the proposed approach approximating level-k. As k increases, the
distribution narrows. Here, this narrowing of the distribution makes it difficult to capture the entire
prediction range for the more advanced subjects, due to the fact there are many sub-rational choices
mixed in. As a result, we see similar fitted models for each case, despite the fact that the theorists
clearly have a higher level of reasoning. If, instead, we tried to approximate the average player for each
case, we could capture this increase in reasoning effort, and it would reflect an increase in β and/or γ as
expected.
Nevertheless, in all cases, the model still significantly outperforms level-k, Cognitive Hierarchy, and
the mixed strategy equilibrium. The level-k model predicts some of the representative spikes in the
experimental data (e.g., with k = 1 guesses of 33, k = 2 of 22, etc.). However, we can see that the
players do not necessarily choose according to level-k, and may make errors around the best response
suggested by level-k reasoning. Level-k thinking presupposes that players will predict a multiple of p,
i.e., with p = 2, we get p×50,p2×50,...,pk ×50, as the players at each level are best responding to
3
lower-level players. In the proposed QH model, level-k reasoning can be recovered if β = ∞ for t ≤ k
t
and β = 0 for t > k. However, with β < ∞, the proposed QH model produces a distribution around
t t
these best-responding values anticipating potential errors in player reasoning, with these errors growing
throughout the chain of reasoning.
Thecognitivehierarchymodelcanimproveuponthelevel-k approachherebyweightingthe“spikes”
of the level-k model differently, however, this still fails to capture the underlying distribution. A large
reason for this is that certain predictions in the p-beauty contest are considered irrational, for example,
any prediction over 67. However, we can see experimentally that such predictions occur, for example,
in Fig. 5. If a player believes that other players would choose the maximal offer of 100, then the player
shouldchoose 2100= 67. Level-korcognitivehierarchymodelscannotcapturesuchirrationalbehaviour
3
where players choose > 67. That is, there is no distribution of level-k thinkers that would predict 100.
However,thisfeaturecanbecaptureddirectlyundertheproposedQHandQREmodelsduetotheerrors
in play, again motivating the usefulness of relaxing best response in addition to mutual consistency.
In summary, we see that under the lab experiment, the QH approach is the best fit. However, QRE
is a better fit in other cases of the beauty contest game.
13
0.030
qh
0.025 qre 0.025
target 0.025
0.020 nash 0.020 0.020
0.015 0.015 0.015
0.010 0.010 0.010
0.005 0.005 0.005
0.000 0.000 0.000
0 20 40 60 80 100 0 20 40 60 80 100 0 20 40 60 80 100
(a) Lab (b) Classroom (c) Internet
0.030 0.030 0.035
0.025 0.025 0.030
0.020 0.020 0.025
0.020
0.015 0.015
0.015
0.010 0.010
0.010
0.005 0.005 0.005
0.000 0.000 0.000
0 20 40 60 80 100 0 20 40 60 80 100 0 20 40 60 80 100
(d) Newspaper (e) Take Home (f) Theorists
Figure5: Beautycontestgames. Thedarkerlinesindicatethemeanresultfromthe5x2cross-validation.
The shaded regions indicate ± one standard deviation. The out-of-sample data are shown as the black
line. The proposed Quantal Hierarchy model is the purple line. Quantal Response Equilibrium is the
orange line. The level-k and Cognitive Hierarchy plots are shown in Fig. 12 due to the large difference
in scales, distorting the figure. The Nash equilibrium solution is indicated as the diagonal dashed grey
line.
Level-1. β= 27 , γ=0.01
Level-2. β= 26 , γ=0.22
0.4 Level-3. β= 59 , γ=0.32
Level-4. β= 64 , γ=0.46
0.3 Level-5. β= 95 , γ=0.52
Level-6. β= 93 , γ=0.61
Level-7. β= 99 , γ=0.73
0.2 Level-8. β= 99 , γ=0.85
0.1
0.0
0 10 20 30 40 50
Figure 6: Example comparing the decisions of level-k (dashed vertical lines) to the proposed QH model
(solid lines) in the p-beauty contest for various settings.
5.2.1 Sequential Games
Centipede Games In the centipede game (see Appendix C.3), “two players alternately get a chance
to take the larger portion of a continually escalating pile of money. As soon as one person takes, the
gameendswiththatplayergettingthelargerportionofthepile,andtheotherplayergettingthesmaller
portion” (McKelvey and Palfrey, 1992).
The subgame perfect equilibrium of the centipede game is for each player to immediately take the
potwithoutproceedingtoanyfurtherrounds, however, weseethisisnotthecaseexperimentally, where
playersbehavefarfromthesubgameperfectequilibrium(Fig.14). Ingeneral,manyplayerstaketowards
the middle of the game. The proposed QH model can capture this trend well, with QRE and Cognitive
Hierarchy generally over-weighting the earlier nodes and under-weighting the later modes (Fig. 7).
The Quantal Hierarchy model provides the best fit for both the four and six-level centipede games,
capturingrealisticbeliefs. Whenmodellingthisreasoningprocess,theplayerbelievestheyarereasoning
at a higher level than their opponent, but in addition, it is as if the player overestimates how noisy
their own play will be when faced with a decision at later nodes. This overestimation is because once
actually faced with the decision, there will be a smaller game tree for the player to consider. This
reasoningprocesswasshowntoapproximatetheexperimentalresultswell,motivatingthediscountingof
information processing resources for capturing future beliefs. When comparing the resulting parameters
(β and γ) from the four and six-level variants (Table 2), we note that the six-level variant results in
additional information processing costs for the player (larger β and γ). The additional processing costs
14
1.0 qh 1.0 qh
qre qre
level-k level-k
0.8 ch 0.8 ch
nash nash
0.6 0.6
0.4 0.4
0.2 0.2
0.0 0.0
1 2 3 4 5 1 2 3 4 5 6 7
(a) Four Move. (b) Six Move.
Figure 7: Four and Six-level Centipede Games. The darker lines indicate the mean result from the
5x2 cross-validation. The shaded regions indicate ± one standard deviation. The out-of-sample data
are shown in the dark grey bars. The proposed Quantal Hierarchy model is the purple line. Quantal
Response Equilibrium is the orange line, level-k is the blue line, and Cognitive Hierarchy is the green
line. The Nash equilibrium solution is indicated as the light grey bar at the first move.
result from the longer chain of reasoning, requiring higher processing resources.
The significantly improved performance over quantal response equilibrium on both games motivates
the usefulness of relaxing mutual consistency in addition to best response. By relaxing mutual consis-
tency,wecapturedtheperceived“lapse”inreasoningwhenconsideringthefullextensiveformgametree
by reducing the information processing resources the further the player tries to reason through the tree.
Bargaining Games In bargaining games, players alternately bargain over how to divide a sum (see
AppendixC.4). Weexaminetwotypes,single-stage(Ultimatum)andtwo-stagebargaininggames. These
are extensions of the example game considered in Section 4.2.1.
Ultimatum The results are presented in Fig. 8 for the ultimatum game. We see the QH model
explainsimportantfeaturesoftheobservedexperimentalbehaviour. Forexample,withhigherV ,Player
1
1 is likely to make a larger initial request (Fig. 8c vs Fig. 8a). Perfect rationality does not capture this
(withtheNashequilibriumremainingunchanged),whereastheQHmodelsuggestshigherinitialrequests
(due to higher V if the request is rejected). The QRE model and the QH model behave similarly here.
1
The reason for this similar behaviour is because the ultimatum game is nearly a single-stage decision,
meaningtheQHmodel“collapses”toQRE.ThisisalsoconfirmedinthefittedparametersTable2,with
the(10,10)and(70,10)havingalmostidenticalvaluesforβ andλ,andQHhavingrelativelyhighvalues
of γ, meaning the differences between Player 1 and Player 2 processing resources are small. However,
something interesting happens in the (10,60) case, where QRE cannot capture the distribution. For
example, if we look to the right of the rational rejection region for Player 2 (Fig. 16), we do not see
any acceptances in (10,10) or (70,10). Whereas, if we look in the rational rejection region of (10,60),
we see several acceptances. This behaviour is irrational, because if the player rejected the request, they
would have received a higher payoff. In contrast, Player 1’s initial requests are relatively rational, with
the peak occurring around the rational request of 40. This mismatch in player rationality is captured
under the proposed model with a small γ, i.e., a large discount in processing resources. This mismatch
in rationality cannot be captured with the standard QRE, which assumes a fixed β for both players.
Theseresultsmotivatethediscountingofplayerresources,whichcancaptureheterogeneousinformation
processing resources between the two players. Alternate forms of QRE, such as Heterogenous QRE have
also been proposed to deal with such dilemmas (Rogers et al., 2009), however, this is captured natively
by the QH model.
The level-k model fails to capture any of the trends, with the uniform level-0 case being the best fit.
Thecognitivehierarchymodelpredictsarepresentativespikeattherationalcapacityinthe(70,10)and
(10,60) cases, however, it is still clearly outperformed by both QRE and QH.
TheseresultsconfirmtheusefulnessofQH.Whenbothplayersbehavewithsimilarlevelsofrationality,
this can be captured with γ → 1, and the model acts the same as QRE. However, when there is a
mismatch in player rationality, this heterogeneity can be captured directly with γ < 1, which became
most pronounced in the (10,60) case.
Two-stageWhilewesawsimilarbehaviourbetweenQREandQHintheultimatumgame,underthe
two-stagegame,thedifferencesbetweentheapproachesbecomemorepronouncedduetothelongergame
15
0.030 t q a h rget 0.035 0.035
0.025 q l c e h r v e el-k 0 0 . . 0 0 2 3 5 0 0 0 . . 0 0 2 3 5 0
0.020 nash 0.020 0.020
0.015 0.015 0.015
0.010 0.010 0.010
0.005 0.005 0.005
0.000 0.000 0.000
0 20 40 60 80 100 0 20 40 60 80 100 0 20 40 60 80 100
(a) (10,10) (b) (10,60) (c) (70,10)
Figure8: Ultimatumgame. Thedarkerlinesindicatethemeanresultfromthe5x2cross-validation. The
shaded regions indicate ± one standard deviation. The out-of-sample data are shown as the black line.
The proposed Quantal Hierarchy model is the purple line. Quantal Response Equilibrium is the orange
line, level-k is the blue line, and Cognitive Hierarchy is the green line. The Nash equilibrium solution is
indicated as the vertical dashed grey line.
0 0 0 0 . . . . 0 0 0 0 2 2 3 3 0 5 0 5 t q q l c n e a h a h r v r e s g e h e l- t k 0 0 0 0 . . . . 0 0 0 0 2 2 3 3 0 5 0 5 0 0 0 0 . . . . 0 0 0 0 2 2 3 3 0 5 0 5 0 0 0 0 . . . . 0 0 0 0 4 5 6 7
0.015 0.015 0.015 0.03
0.010 0.010 0.010 0.02
0.005 0.005 0.005 0.01
0.000 0.000 0.000 0.00
0 20 40 60 80 100 0 20 40 60 80 100 0 20 40 60 80 100 0 20 40 60 80 100
(a) D=0.9 (b) D=0.8 (c) D=0.7 (d) D=0.6
0.06
0.04 0.030
0.04 0.025 0.05
0.03 0.03 0.020 0.04
0.02 0.02 0.015 0.03
0.010 0.02
0.01 0.01 0.005 0.01
0.00 0.00 0.000 0.00
0 20 40 60 80 100 0 20 40 60 80 100 0 20 40 60 80 100 0 20 40 60 80 100
(e) D=0.5 (f) D=0.4 (g) D=0.3 (h) D=0.2
Figure 9: Two-stage bargaining game. The darker lines indicate the mean result from the 5x2 cross-
validation. The shaded regions indicate ± one standard deviation. The out-of-sample data are shown as
theblackline. TheproposedQuantalHierarchymodelisthepurpleline. QuantalResponseEquilibrium
istheorangeline,level-kistheblueline,andCognitiveHierarchyisthegreenline. TheNashequilibrium
solution is indicated as the vertical dashed grey line.
tree. Undersuchconditions,theusefulnessofdiscountingfuturepaths(andrelaxingmutualconsistency)
becomesmorenoticeable. TheQHmodelconvincinglyoutperformsQREacrosstheexperimentalresults
with the small disagreement penalties 3 (i.e., D > 0.5), and still generally outperforms QRE for the
larger disagreement penalties (i.e., D ≤0.5), although the two methods become closer.
With the larger disagreement penalties (i.e. smaller D), the experimental data are closer to the
perfectly rational case, as indicated with the peaks corresponding roughly to the rational request in
Fig. 9. This distribution around the rational request is precisely the premise QRE is founded on, so
QRE achieves adequate performance. However, with the smaller disagreement penalties (larger D, top
row of Fig. 9), the distribution is not centred around the rational request, meaning QRE struggles to
capture such phenomena. In contrast, the QH approach is robust to this shift due to the relaxation
of mutual consistency, and is able to capture the varying distributions regardless of whether they are
approximating the best-response case.
5.3 Results Summary
The Quantal Hierarchy method consistently performed well out-of-sample in all games, ranking the
best overall and achieving either the first or second position in every game. The results analysis was
categorisedintotwogametypes: sequentialandsimultaneousgames,wherereasoningisrepresentedasan
3These are referred to as “discount” rates in Binmore et al. (2002). We have used the term disagreement penalties to
avoidconfusionwiththeinformationprocessing“discount”parameterγ.
16
extensive-form game tree with depleting information-processing resources. Although the representation
worked well in both game types, it showed more improvement over alternative methods in sequential
games. Thisimprovementinsequentialgamescanbeattributedtothediscountparameterthatcaptures
the heterogeneity of players, allowing for different information processing resources between the players
at each stage, relaxing mutual consistency, which was crucial in bargaining games.
On the other hand, in simultaneous games, the approach aims to fit a representative distribution
of the entire group, but it can struggle to capture the entire distribution of players, particularly when
they exhibit widely varying levels of rationality, as in certain versions of the beauty-contest game. This
highlights a potential limitation of the approach when attempting to capture multimodal distributions
withvaryinglevelsofrationality,suchasabi-modaldistributionwithbeginnersandexperts. Toaddress
this limitation, multiple versions of the model may need to be fitted, such as one for beginners and
one for experts, as modelling more rational play narrows the distribution to the rational prediction and
modelling less rational play widens the distribution to account for larger errors, as demonstrated in
Fig. 6. However, despite this potential limitation, the method still performed exceptionally well overall.
6 Discussion and Conclusions
The assumption of perfect rationality amongst players is violated in numerous experimental settings,
particularly in non-repeated games. In this work, we utilised experimental datasets for several games,
showing that the equilibrium behaviour is often a poor predictor of the observed actions. The proposed
Quantal Hierarchy model offers a concise alternative representation, relaxing some traditional game-
theoretic assumptions underlying rationality. The model is a good fit for experimentally observed be-
haviouronarangeofcanonicaleconomicgames, outperformingexistingboundedrationalityapproaches
on out-of-sample validation.
IntheQHmodel,werepresenthigher-orderreasoningaspseudo-sequentialdecision-making. Ateach
level, players may reason erroneously, and this error grows the deeper one reasons (i.e., it becomes more
difficult to reason about reasoning). The magnitude of the errors is governed by β, with β =0, players
donotperformanyreasoning,andwithβ →∞playersreasonperfectly. Parameterβ,therefore, relaxes
the best response assumption of players at each level of reasoning.
Decreasing β at each level of reasoning was shown to work well on a wide variety of games, rein-
forcing the assumption that players cognitive abilities decrease throughout the depth of reasoning. This
reduction in player cognition is captured with γ, introducing an implicit hierarchy of players, relaxing
the mutual consistency assumption. Representing this hierarchy of players as extensive-form game trees
allowedforaninformation-theoreticrepresentation, wherelower-levelplayersareassumedtomakemore
significant playing errors (constrained by lower information processing resources). With a single-step
decision, this recovers the Quantal Response Equilibrium model. With multi-stage decisions, we recover
an approximation of a generalised level-k formulation, where at each step, players are assumed to have
higher resources and reasoning ability than players below themselves, but may still play erroneously.
SimilartoQRE,theresourceparameterβisproblemdependent,anddependsonthepayoffmagnitude
(McKelvey et al., 2000). This opens an area of research analysing whether a normalised β can be used
to measure problem difficulty, or whether some relationship holds between the the experimentally fitted
β and the β which corresponds to the Nash solution. For example, a question arises if a normalised β
can provide insights across games, and if so, can this average distance to the Nash solution be generally
useful across games. A similar consideration is given to whether such payoff perturbations in QRE can
be related across different games (Haile et al., 2008), and whether the boundedness parameter can be
endogenised (Friedman, 2020).
There is a clear relationship between the decision-making components proposed in this work and the
decision-making in multi-agent systems, such as agent-based models (ABMs) and multi-agent reinforce-
mentlearning(RL)approaches. Forexample,Wenetal.(2020)outlineanovelframeworkforhierarchical
reasoning RL agents, which allows agents to best respond to other less sophisticated agents based upon
level-ktypemodels. Likewise,L(cid:32) ateketal.(2009)proposearecursionbasedboundedrationalityapproach
for ABMs. Replacing the agents in these multi-agent approaches with the informationally constrained
agents presented in our work provides a distinct area of future research, where we could examine the
resulting dynamics and out-of-equilibrium behaviour from heterogeneous QH agents.
In summary, we proposed an information-theoretic model for capturing higher-order reasoning for
boundedlyrationalplayers. Boundedrationalityisachievedinthemodelbytherelaxationoftwocentral
assumptions underlying rationality, namely, mutual consistency between players and best response deci-
sions. Through relaxing these assumptions, we showed how the predictions from the proposed Quantal
17
Hierarchy model align well with the experimentally observed human behaviour in a variety of canonical
economic games.
References
Alaoui, L. and Penta, A. (2016). Endogenous depth of reasoning. The Review of Economic Studies,
83(4):1297–1333.
Alaoui, L. and Penta, A. (2022). Cost-benefit analysis in reasoning. Journal of Political Economy,
130(4):881–925.
Anufriev, M., Duffy, J., and Panchenko, V. (2022). Learning in two-dimensional beauty contest games:
Theory and experimental evidence. Journal of Economic Theory, 201:105417.
Arthur, W. B. (1994). Inductive reasoning and bounded rationality. The American economic review,
84(2):406–411.
Aumann, R. J. (1992). Irrationality in game theory. Economic analysis of markets and games, pages
214–227.
Ay, N., Bernigau, H., Der, R., and Prokopenko, M. (2012). Information-driven self-organization: the
dynamical system approach to autonomous robot behavior. Theory in Biosciences, 131(3):161–179.
Bach, C. W. and Perea, A. (2014). Utility proportional beliefs. International Journal of Game Theory,
43(4):881–902.
Bergstra, J., Yamins, D., and Cox, D. (2013). Making a science of model search: Hyperparameter
optimizationinhundredsofdimensionsforvisionarchitectures.InInternationalconferenceonmachine
learning, pages 115–123. PMLR.
Binmore, K. (1987). Modeling rational players: Part I. Economics & Philosophy, 3(2):179–214.
Binmore, K. (1988). Modeling rational players: Part II. Economics & Philosophy, 4(1):9–55.
Binmore, K., McCarthy, J., Ponti, G., Samuelson, L., and Shaked, A. (2002). A backward induction
experiment. Journal of Economic theory, 104(1):48–88.
Bosch-Domenech, A., Montalvo, J. G., Nagel, R., and Satorra, A. (2002). One, two,(three), infinity,...:
Newspaper and lab beauty-contest experiments. American Economic Review, 92(5):1687–1701.
Botev, Z. I., Grotowski, J. F., and Kroese, D. P. (2010). Kernel density estimation via diffusion. The
annals of Statistics, 38(5):2916–2957.
Braun, D. A. and Ortega, P. A. (2014). Information-theoretic bounded rationality and ε-optimality.
Entropy, 16(8):4662–4676.
Braun, D. A., Ortega, P. A., Theodorou, E., and Schaal, S. (2011). Path integral control and bounded
rationality. In 2011 IEEE symposium on adaptive dynamic programming and reinforcement learning
(ADPRL), pages 202–209. IEEE.
Breitmoser, Y. (2012). Strategic reasoning in p-beauty contests. Games and Economic Behavior,
75(2):555–569.
Camerer, C., Ho, T., and Chong, K. (2003). Models of thinking, learning, and teaching in games.
American Economic Review, 93(2):192–195.
Camerer, C. F. (2003). Behavioral game theory: Plausible formal models that predict accurately. Be-
havioral and Brain Sciences, 26(2):157–158.
Camerer, C. F. (2010). Behavioural game theory. In Behavioural and Experimental Economics, pages
42–50. Springer.
Camerer,C.F.(2011).Behavioralgametheory: Experimentsinstrategicinteraction.Princetonuniversity
press.
18
Camerer,C.F.,Ho,T.-H.,andChong,J.-K.(2004).Acognitivehierarchymodelofgames.TheQuarterly
Journal of Economics, 119(3):861–898.
Caplin, A., Dean, M., and Leahy, J. (2019). Rational inattention, optimal consideration sets, and
stochastic choice. The Review of Economic Studies, 86(3):1061–1094.
Challet, D., Marsili, M., Zhang, Y.-C., et al. (2013). Minority games: interacting agents in financial
markets. OUP Catalogue.
Chong, J.-K., Camerer, C. F., and Ho, T.-H. (2005). Cognitive hierarchy: A limited thinking theory
in games. In Zwick, R. and Rapoport, A., editors, Experimental Business Research, pages 203–228,
Boston, MA. Springer US.
Chong, J.-K., Ho, T.-H., and Camerer, C. (2016). A generalized cognitive hierarchy model of games.
Games and Economic Behavior, 99:257–274.
Cournot, A. A. (1838). Recherches sur les principes math´ematiques de la th´eorie des richesses. L.
Hachette.
Demˇsar, J.(2006). Statisticalcomparisonsofclassifiersovermultipledatasets. The Journal of Machine
learning research, 7:1–30.
Dietterich, T. G. (1998). Approximate statistical tests for comparing supervised classification learning
algorithms. Neural computation, 10(7):1895–1923.
Duffy, J. andHopkins, E.(2005). Learning, information, andsortingin marketentry games: theory and
evidence. Games and Economic behavior, 51(1):31–62.
Evans,B.P.andProkopenko,M.(2021).Amaximumentropymodelofboundedrationaldecision-making
with prior beliefs and market feedback. Entropy, 23(6):669.
Friedman, E. (2020). Endogenous quantal response equilibrium. Games and Economic Behavior,
124:620–643.
Gabaix, X., Laibson, D., Moloche, G., and Weinberg, S. (2006). Costly information acquisition: Exper-
imental analysis of a boundedly rational model. American Economic Review, 96(4):1043–1068.
G¨achter,S.(2004). Behavioralgametheory. Blackwell handbook of judgment and decision making,pages
485–503.
Georgalos, K. (2020). Comparing behavioral models using data from experimental centipede games.
Economic Inquiry, 58(1):34–48.
Glasner, D. (2020). Hayek, Hicks, Radner and four equilibrium concepts: Perfect foresight, sequential,
temporary, and rational expectations. The Review of Austrian Economics, pages 1–23.
Goeree, J. K. and Holt, C. A. (2004). A model of noisy introspection. Games and Economic Behavior,
46(2):365–382.
Goeree, J. K. and Holt, C. A. (2005). An explanation of anomalous behavior in models of political
participation. American political science Review, 99(2):201–213.
Goeree,J.K.,Holt,C.A.,andPalfrey,T.R.(2005). Regularquantalresponseequilibrium. Experimental
Economics, 8(4):347–367.
Goeree,J.K.,Holt,C.A.,andPalfrey,T.R.(2016). Quantalresponseequilibrium. InQuantalResponse
Equilibrium. Princeton University Press.
Goldfarb, A. and Xiao, M. (2011). Who thinks about the competition? managerial ability and strategic
entry in us local telephone markets. American Economic Review, 101(7):3130–61.
Gottwald,S.andBraun,D.A.(2019). Boundedrationaldecision-makingfromelementarycomputations
that reduce uncertainty. Entropy, 21(4):375.
Haile, P. A., Horta¸csu, A., and Kosenok, G. (2008). On the empirical content of quantal response
equilibrium. American Economic Review, 98(1):180–200.
19
Harr´e, M. S. (2021). Information theory for agents in artificial intelligence, psychology, and economics.
Entropy, 23(3):310.
Harsanyi, J. C. (1967). Games with incomplete information played by “Bayesian” players. Part I. The
basic model. Management science, 14(3):159–182.
Harsanyi, J. C. (1968). Games with incomplete information played by “Bayesian” players. Part II.
Bayesian equilibrium points. Management Science, 14(5):320–334.
Ho, T.-H. and Su, X. (2013). A dynamic level-k model in sequential games. Management Science,
59(2):452–469.
Hoppe, H.-H. (1997). On certainty and uncertainty, or: how rational can our expectations be? The
Review of Austrian Economics, 10(1):49–78.
Johnson, E. J., Camerer, C., Sen, S., and Rymon, T. (2002). Detecting failures of backward induction:
Monitoring information search in sequential bargaining. Journal of Economic Theory, 104(1):16–47.
Kawagoe, T. and Takizawa, H. (2012). Level-k analysis of experimental centipede games. Journal of
Economic Behavior & Organization, 82(2-3):548–566.
Ke, S. (2019). Boundedly rational backward induction. Theoretical Economics, 14(1):103–134.
Keynes,J.M.(1937). Thegeneraltheoryofemployment. Thequarterlyjournalofeconomics,51(2):209–
223.
Keynes, J. M. (2018). The general theory of employment, interest, and money. Springer.
Knudsen,C.(1993). Rationalityandtheproblemofself-referenceineconomics! Rationality,Institutions,
and Economic Methodology, 2:133.
Koppl, R. and Barkley Rosser Jr, J. (2002). All that I have to say has already crossed your mind.
Metroeconomica, 53(4):339–360.
Koriyama, Y. and Ozkes, A. I. (2021). Inclusive cognitive hierarchy. Journal of Economic Behavior &
Organization, 186:458–480.
Krockow, E.M., Pulford, B.D., andColman, A.M.(2018). Farbutfinitehorizonspromotecooperation
in the centipede game. Journal of Economic Psychology, 67:191–199.
L(cid:32) atek, M., Axtell, R., and Kaminski, B. (2009). Bounded rationality via recursion. In Proceedings of
Eighth International Conference on Autonomous Agents and Multi-Agent Systems (AAMAS 2009),
pages 457–464.
Levin,D.andZhang,L.(2019).Bridginglevel-ktonashequilibrium.ReviewofEconomicsandStatistics,
pages 1–44.
Lipman,B.L.(1991).Howtodecidehowtodecidehowto...: Modelinglimitedrationality.Econometrica:
Journal of the Econometric Society, pages 1105–1125.
L¨ofgren,L.(1990).Onthepartialityofself-reference,pages47–64.GordonandBreachSciencePublishers.
Mackie, J. (1971). What can we learn from the paradoxes? part II. Cr´ıtica: Revista Hispanoamericana
de Filosof´ıa, pages 35–54.
Mattsson, L.-G. and Weibull, J. W. (2002). Probabilistic choice and procedurally bounded rationality.
Games and Economic Behavior, 41(1):61–78.
McKelvey,R.D.andPalfrey,T.R.(1992). Anexperimentalstudyofthecentipedegame. Econometrica:
Journal of the Econometric Society, pages 803–836.
McKelvey, R. D. and Palfrey, T. R. (1995). Quantal response equilibria for normal form games. Games
and economic behavior, 10(1):6–38.
McKelvey, R. D. and Palfrey, T. R. (1998). Quantal response equilibria for extensive form games.
Experimental economics, 1(1):9–41.
20
McKelvey, R. D., Palfrey, T. R., and Weber, R. A. (2000). The effects of payoff magnitude and het-
erogeneity on behavior in 2×2 games with unique mixed strategy equilibria. Journal of Economic
Behavior & Organization, 42(4):523–548.
Mertens, J.-F. and Zamir, S. (1985). Formulation of Bayesian analysis for games with incomplete infor-
mation. International Journal of Game Theory, 14(1):1–29.
Morgenstern, O. (1928). Wirtschaftsprognose: Eine Untersuchung ihrer Voraussetzungen und
M¨oglichkeiten. Springer.
Morgenstern, O. (1935). Vollkommene voraussicht und wirtschaftliches gleichgewicht. Zeitschrift fu¨r
National¨okonomie/Journal of Economics, pages 337–357.
Moulin, H. (1986). Game theory for the social sciences. NYU press.
Nagel, R. (1995). Unraveling in guessing games: An experimental study. The American Economic
Review, 85(5):1313–1326.
Nash, J. (1951). Non-cooperative games. Annals of mathematics, pages 286–295.
Ortega, D. A. and Braun, P. A. (2011). Information, utility and bounded rationality. In International
Conference on Artificial General Intelligence, pages 269–274. Springer.
Ortega,P.A.andBraun,D.A.(2013).Thermodynamicsasatheoryofdecision-makingwithinformation-
processingcosts. ProceedingsoftheRoyalSocietyA:Mathematical,PhysicalandEngineeringSciences,
469(2153):20120683.
Ortega, P. A. and Braun, D. A. (2014). Generalized Thompson sampling for sequential decision-making
and causal inference. Complex Adaptive Systems Modeling, 2(1):1–23.
Ortega, P. A. and Stocker, A. A. (2016). Human decision-making under limited time. In Advances in
Neural Information Processing Systems, pages 100–108.
Polani, D., Sporns, O., and Lungarella, M. (2007). How information and embodiment shape intelligent
information processing. In 50 Years of Artificial Intelligence, pages 99–111. Springer.
Polonio,L.andCoricelli,G.(2019). Testingthelevelofconsistencybetweenchoicesandbeliefsingames
using eye-tracking. Games and Economic Behavior, 113:566–586.
Prokopenko,M.,Harr´e,M.,Lizier,J.,Boschetti,F.,Peppas,P.,andKauffman,S.(2019). Self-referential
basis of undecidable dynamics: From the liar paradox and the halting problem to the edge of chaos.
Physics of life reviews, 31:134–156.
Rabin, M. O. (1957). Effective computability of winning strategies. Contributions to the Theory of
Games, 3(39):147–157.
Raiffa, H. and Luce, R. D. (1957). Games and Decisions: Introduction and Critical Survey. John Wiley,
New York.
Rapoport, A., Seale, D. A., Erev, I., and Sundali, J. A. (1998). Equilibrium play in large group market
entry games. Management Science, 44(1):119–141.
Rogers, B. W., Palfrey, T. R., and Camerer, C. F. (2009). Heterogeneous quantal response equilibrium
and cognitive hierarchies. Journal of Economic Theory, 144(4):1440–1467.
Scott, D. W. (2015). Multivariate density estimation: theory, practice, and visualization. John Wiley &
Sons.
Silverman, B. W. (2018). Density estimation for statistics and data analysis. Routledge.
Simon, H. A. (1976). From substantive to procedural rationality. In 25 years of economic theory, pages
65–86. Springer.
Sims,C.A.(2003). Implicationsofrationalinattention. Journal of monetary Economics,50(3):665–690.
21
Stahl,D.O.(1990).Entropycontrolcostsandentropicequilibria.InternationalJournalofGameTheory,
19(2):129–138.
Stahl, D. O. (1993). Evolution of smart players. Games and Economic Behavior, 5(4):604–617.
Stahl, D. O. and Wilson, P. W. (1995). On players’ models of other players: Theory and experimental
evidence. Games and Economic Behavior, 10(1):218–254.
Sundali, J. A., Rapoport, A., and Seale, D. A. (1995). Coordination in market entry games with
symmetric players. Organizational behavior and Human decision processes, 64(2):203–218.
Tishby, N., Pereira, F. C., and Bialek, W. (1999). The information bottleneck method. In Proc. of the
37-th Annual Allerton Conference on Communication, Control and Computing, pages 368–377.
Tishby, N. and Polani, D. (2011). Information theory of decisions and actions. In Perception-action
cycle, pages 601–636. Springer.
Turocy,T.L.(2010). Computingsequentialequilibriausingagentquantalresponseequilibria. Economic
Theory, 42(1):255–269.
Webster, T. J. (2013). A note on the ultimatum paradox, bounded rationality, and uncertainty. Inter-
national Advances in Economic Research, 19(1):1–10.
Wen, Y., Yang, Y., and Wang, J. (2020). Modelling bounded rationality in multi-agent interactions by
generalized recursive reasoning. In Bessiere, C., editor, Proceedings of the Twenty-Ninth International
Joint Conference on Artificial Intelligence, IJCAI-20, pages 414–421. International Joint Conferences
on Artificial Intelligence Organization. Main track.
Wolpert, D. H. (2006). Information theory—the bridge connecting bounded rational game theory and
statistical physics. In Complex Engineered Systems, pages 262–290. Springer.
Wright, J. R. and Leyton-Brown, K. (2019). Level-0 models for predicting human behavior in games.
Journal of Artificial Intelligence Research, 64:357–383.
22
A Model Fitting
Each model is fit to the training portion of the data (from 5x2 cross-fold validation), using Bayesian
hyperparameter optimisation (Bergstra et al., 2013). Every model is given 1000 evaluations for a fair
comparison. With level-k, due to the integer parameter, rather than Bayesian optimisation, we instead
perform an exhaustive search for k ∈ [0,1,...,100], noting that this is an extensive range of k, easily
capturing standard k’s reported in the literature. The fitted parameter values with the lowest mean
squared error between the predictions and the training values are selected. The out-of-sample (testing)
portion is never seen by the optimisation process and is only used for evaluation after the parameter
optimisation has been complete.
For Quantal Response Equilibrium and Quantal Hierarchy, we sample from the range 0 ≤ β < 100.
While β is unbounded, we find this upper bound to be more than enough with no fitted values coming
close to this upper threshold. For γ, this is bounded 0 ≤ γ ≤ 1. For Cognitive Hierarchy, we sample
from the range 0 ≤ τ < 10, which despite τ being unbounded, again provides a more than sufficient
range for the experimental data, and covers common τ’s reported in literature (Camerer, 2010; Camerer
et al., 2004).
For the beauty contest games, as well as the bargaining games, due to the large action space (a ∈
[0,...,100]), rather than using the raw data directly, a fitted Gaussian kernel density estimate of the
training and testing data is used to account for the large action space and the relatively small number
of observations. Scott’s rule is used to determine the bandwidth automatically (Scott, 2015), and we
validate the robustness of this rule choice in Appendix D.2. The same kernel density estimates are
used across all methods to ensure fair comparisons. For the remaining game classes, the action space is
sufficiently well sampled from the observations, so no density approximation is required.
B Special Cases
B.1 Backwards Induction
Backwards induction can be recovered as a limiting case of the proposed model. We can see this as
follows from Eq. (10) (and the expansion process from Eq. (4)), noting that softmax eβU[a]/Z converges
to argmax with β →∞:
1
f[a
k
|a
<k
]=
Z k
× Z
(cid:124)(cid:123) k
1
(cid:122) +
/γ
(cid:125) 1
×e
(cid:124)
βγkU
(cid:123)
[a
(cid:122)
k|a<k
(cid:125)
]
CurrentPayoff
FutureContribution
  (12)
=argmaxU[a |a ] + V 
 k <k k+1 
ak∈Ak (cid:124) (cid:123)(cid:122) (cid:125) (cid:124)(cid:123)(cid:122)(cid:125)
CurrentPayoff FutureContribution
where V is derived recursively based on choosing a . Backward induction assumes that all future
k+1 k
decisions will be rational, i.e., at each stage, players choose rationally.
C Canonical Games and Experimental Data
C.1 Market Entrance/El Farol Bar Problem
The market entrance game was outlined in the context of cognitive hierarchies in Camerer et al. (2004),
and has also been considered in prior studies, e.g., Rapoport et al. (1998). This game is fundamentally
similar to the El Farol bar problem of Arthur (1994), and minority games of Challet et al. (2013). A
player will profit (enjoy) in the market (bar) if less than d×N,d ∈ [0,1] players also enter the same
market (bar).
For this work, we use the experimental data from Camerer (2011), specifically the results originally
presented in Sundali et al. (1995). The payoff for staying out is fixed
U[stay out ]=1 (13)
k
23
However,thepayoffsforenteringaredependentonthetotaldemandfromtheother(lower-level)players
and a preferential capacity c=d×N:
U[enter ]=1+2(c−f[enter ]) (14)
k k+1
There were N =20 subjects, and various c’s trialled c∈[1,3,5...,19].
C.1.1 Comparison Methods
We can represent this pseudo-sequential structure (Camerer et al., 2004) as an extensive-form game,
with each level of reasoning forming a new node in the game tree.
Level-k Under this configuration, a level-0 player is assumed to randomise, i.e., enter or stay out with
equalprobability(thesamelevel-0configurationisusedforthenaiveplayerintheQHmodel). Alevel-1
player exploits this and attends the bar if d > 0.5, or stay home with d < 0.5, at d = 0.5 the player
is indifferent and would attend with 50% probability. Level-2 players then base their decision assuming
other players are level-1, and enter only if the level-1 players underestimated the expected capacity.
Likewise, level-3 players base their decision on reasoning about level-2. Level-k behaviour necessitates
stepfunctionsintheresponse,whereplayersonlyenteratacapacityciftheybelievelower-levelthinkers
have over or under entered.
Cognitive Hierarchy Ratherthanassumingallplayersareatk−1,thecognitivehierarchymodelfits
a distribution to these k players, and best responds according to this distribution of lower level thinkers.
Following Camerer et al. (2004), we use the Poisson distribution.
QuantalResponseEquilibrium Toderivethe(mixedstrategy)quantalresponseequilibrium,weuse
thelogisticfunctionofthedifferencesinpayoffs(betweenenterandstayout)asthedistributionfunction,
withnumericestimationsforthefixed-pointsolutionsincenoanalyticalsolutionexists,followingGoeree
et al. (2016) (Section 2.2.2 and Section 8) and Goeree and Holt (2005).
1.0 1.0 1.0 1.0 1.0
0.8 0.8 0.8 0.8 0.8
0.6 0.6 0.6 0.6 0.6
0.4 0.4 0.4 0.4 0.4
0.2 0.2 0.2 0.2 0.2
0.0 5 10 15 0.0 5 10 15 0.0 5 10 15 0.0 5 10 15 0.0 5 10 15
(a) Block 1 (b) Block 2 (c) Block 3 (d) Block 4 (e) Block 5
Figure 10: Market Entrance game at various blocks using the experimental data from Sundali et al.
(1995). Weseeovertime, theexperimentaldatabecomesclosertotheequilibriumofperfectattendance
(dotted gray line).
C.2 Beauty Contest
Keynes (1937, 2018) originally formulated the beauty contest game as follows. Contestants are asked
to vote for the six prettiest faces out of a selection of 100. The winner is the contestant who most
closely picks the overall consensus. A naive (level-0) strategy is to choose based on personal preference.
A level-1 strategy is to choose as if everyone is choosing on personal preference, so the player chooses
whom they think others will find most desirable. A level-2 strategy is then for players to choose whom
they think that others will think others will choose, and so on (with Keynes believing there are players
who “practise the fourth, fifth, and higher” levels). The game was originally outlined to highlight how
investors are not necessarily driven by fundamentals but rather by anticipating the thoughts of others.
An extension of the game is the p-beauty contest of Moulin (1986), where contestants are asked to
guess fraction p ∈ [0...1] (commonly p = 2) of the average value of the other competitors guesses
3
24
within the range [0,...100]. The Nash equilibrium dictate that every player should choose 0. However,
experimentallythisisnotthecase,andplayersactboundedlyrational(Nagel,1995). Suchagameshows
out-of-equilibrium behaviour and motivates the modelling of such decisions in a finite-depth manner
(Aumann, 1992; Stahl, 1993; Binmore, 1987, 1988).
We use the experimental data provided by Bosch-Domenech et al. (2002) with p= 2. The resulting
3
guesses are visualised in Fig. 11.
The utilities are represented as follows:
(cid:80)
a ×f[a ]
g =p×
ak+1 k+1 k+1
k (cid:80) ak+1 f[a k+1 ] (15)
U[a ]=|a −g |
k k k
where g represents the predicted goal, i.e., 2/3’s of the average weighted prediction of the lower level
k
thinkers. The utilities for each choice then become the distance to the goal.
C.2.1 Comparison Methods
Level-k Level-0 competitors are assumed to guess randomly between [0,100] (the same level-0 config-
uration is used for the naive player in the QH model). Level-1 players then anticipate this and guess
p×50(50beingtheaveragefromthelevel-0players),level-2playersthenguessp×(p×50)andsoforth.
As the levels increase, the guesses, therefore, approach 0, coinciding with the perfectly rational choice.
Cognitive Hierarchy Ratherthanassumingallplayersareatk−1,thecognitivehierarchymodelfits
a distribution to these k players, and best responds according to this distribution of lower level thinkers.
Again, following the convention of Camerer et al. (2004), we use the Poisson distribution.
Quantal response equilibrium Forthequantalresponseequilibrium, weusethelogitrulefollowing
Breitmoser (2012) estimated using fixed point iteration (see also Section F4.1 of the supplementary
material for Anufriev et al. (2022)).
0.08
0.06
0.04
0.02
0.00 0 20 40 60 80 100
Guess
noitroporP
0.14
Avg=35.14 0.12
0.10
0.08
0.06
0.04
0.02
0.00 0 20 40 60 80 100
Guess
(a) Lab
noitroporP
0.16
Avg=26.82 0.14
0.12
0.10
0.08
0.06
0.04
0.02
0.00 0 20 40 60 80 100
Guess
(b) Classroom
noitroporP
Avg=22.16
(c) Internet
0.06
0.05
0.04
0.03
0.02
0.01
0.00 0 20 40 60 80 100
Guess
noitroporP
0.07
Avg=23.05 0.06
0.05
0.04
0.03
0.02
0.01
0.00 0 20 40 60 80 100
Guess
(d) Newspaper
noitroporP
0.200
Avg=25.18 0.175
0.150
0.125
0.100
0.075
0.050
0.025
0.000 0 20 40 60 80 100
Guess
(e) Take Home
noitroporP
Avg=17.14
(f) Theorists
Figure 11: Visualisation of various experimental p-beauty contests. The dotted vertical line indicates
the average for the given dataset. Datasets source: Bosch-Domenech et al. (2002).
C.3 Centipede Game
With perfectly rational backward induction, the subgame perfect equilibrium of the centipede game is
for each player to immediately take the pot without proceeding to any further rounds. However, this is
a poor predictor of what happens experimentally (Ho and Su, 2013), where players are shown to “grow”
25
0.175 ch 0.175 1.0
0.150 l t e a v rg e e l- t k 0.150 0.8
0.125 nash 0.125
0.100 0.100 0.6
0.075 0.075 0.4
0.050 0.050
0.2
0.025 0.025
0.000 0.000 0.0
0 20 40 60 80 100 0 20 40 60 80 100 0 20 40 60 80 100
(a) Lab (b) Classroom (c) Internet
1.0
0.150 0.150
0.8
0.125 0.125
0.100 0.6 0.100
0.075 0.075
0.4
0.050 0.050
0.025 0.2 0.025
0.000 0.0 0.000
0 20 40 60 80 100 0 20 40 60 80 100 0 20 40 60 80 100
(d) Newspaper (e) Take Home (f) Theorists
Figure 12: Beauty contest games (extended). The darker lines indicate the mean result from 5x2 cross-
validation. The shaded regions indicate ± one standard deviation. The out-of-sample data are shown as
the black line. The level-k model is shown as the blue line. The Cognitive Hierarchy model as the green
line. The Nash equilibrium solution is indicated as the diagonal dashed grey line.
PASS PASS PASS PASS PASS PASS
TAKE TAKE TAKE TAKE TAKE TAKE TAKE
0.4 0.2 1.6 0.8 6.4 3.2 25.6
0.1 0.8 0.4 3.2 1.6 12.8 6.4
Figure 13: The six move extensive-form centipede Game. Green (orange) circles highlight Player 1(2)’s
turn, and the top (bottom) row of the boxes highlights Player 1(2)s payoff. The four-move game is
equivalent until the fourth node, however, the payoffs for the fifth node become the “PASS” payoffs for
Node 4.
the money pile by playing for several rounds before taking (Ke, 2019). Again, there are multiple reasons
proposed to explain players deviation from the predicted unique subgame equilibrium (Kawagoe and
Takizawa, 2012; Krockow et al., 2018; Georgalos, 2020).
In this work, we use the experimental data of McKelvey and Palfrey (1992) (from their Appendix C)
for four and six-level centipede games. The utilities are represented as:
U [take ]=0.4
1 1
U [pass ]=0.2×f[take ]+V ×f[pass ]
1 1 2 1 2
U [take ]=0.8 (16)
2 2
U [pass ]=0.4×f[take ]+V ×f[pass ]
2 2 3 2 3
...
where V ,V are derived as the average expected return for the remainder of the moves. These payoffs
1 2
are also visualised in Fig. 13. The conditioning on the history of decisions is implicit here, as to take an
action a at n>1, all previous actions must have been to pass (otherwise the game would have ended).
n
26
1.0
0.8
0.6
0.4
0.2
0.0
1 2 3 4 5
Move
noitroporP
1.0
0.8
0.6
0.4
0.2
0.0
1 2 3 4 5 6 7
Move
(a) Four Move.
noitroporP
(b) Six Move.
Figure 14: Four and six-level Centipede Games using the dataset from McKelvey and Palfrey (1992).
C.3.1 Comparison Methods
Level-k Under the level-k framework, we assume a level-0 agent is equally as likely to take or pass
at each stage of the game (the same configuration is used as the naive player under the proposed
Quantal Hierarchy approach). A level-1 player then takes at the node which maximises the expected
utility subject to this, and so on and so forth. A full analysis of level-k framework in centipede games
is presented in Kawagoe and Takizawa (2012), but this configuration used (referred to as Random
Behavioral strategy (RBS) in Kawagoe and Takizawa (2012)) was shown to be the best specification for
matching the experimental data (for both level-k and cognitive hierarchy).
Cognitive Hierarchy Ratherthanassumingallplayersareatk−1,thecognitivehierarchymodelfits
a distribution to these k players, and best responds according to this distribution of lower level thinkers.
Again, the Poisson distribution was used, which was shown to be the best experimental fit in Kawagoe
and Takizawa (2012).
Quantal Response Equilibirum An agent-form of the QRE (McKelvey and Palfrey, 1998) is used
here , where at each node, the agent choices nosily based on resource parameter β, and assuming their
opponentisalsooperatingunderthesameresourceconstraintβ. Thisiscalculatedrecursivelyfollowing
(McKelvey and Palfrey, 1998).
C.4 Sequential Bargaining
We examine the experimental results of the Ultimatum Game (one-stage) and two-stage alternating-
offer bargaining games (Binmore et al., 2002), which consistently demonstrate violations of backward
induction (Webster, 2013), even when accounting for “fairness” in the system (Johnson et al., 2002).
C.4.1 Ultimatum Game
For the ultimatum game, we use the experimental data of Game 1 from Binmore et al. (2002). In the
ultimatum game, the players are faced with the following payoffs:
U [a ]=a ×f[accept|a ]+V ×f[reject|a ]
1 1 1 1 1 1
U [accept |a ]=100−a (17)
2 2 1 1
U [reject |a ]=V
2 2 1 2
where V ,V are the rejection payoffs for Player 1 and Player 2.
1 2
Ifopponents (Player2) arerational, thenPlayer1, being rational, should requestnomore thantheir
opponent’s rejection payoff V . However, if opponents are not believed to be rational, then there is
2
potential for Player 1 to exploit this fact and request higher (or lower) amounts. That is, it becomes
rational for Player 1 to play as if Player 2 is not perfectly rational.
A rational opponent implies a step function, where for a , with payoff 100−a > V the player
1 1 2
accepts with probability 1, and for payoffs below V the player reject with certainty as shown in Fig. 16.
2
However, from Fig. 16 we can see deviations from rationality in the observed play. This is directly
27
0 x 100
ACCEPT REJECT
x
100-x
0 x 100
0 y 100
ACCEPT REJECT
ACCEPT REJECT
x V1 Dy 0
100-x V2 D(100-y) 0
(a) Ultimatum (One-stage) (b) Two-Stage
Figure 15: Example extensive-form sequential bargaining games. In the ultimatum game (Fig. 15a),
Player 1 makes a request x ∈ [0,100]. If Player 2 accepts the request, Player 2 receives a payoff of
100−x, and Player 1 receives x. If Player 2 declines the request, they each receive the rejection payoff
(V or V ). In the two-stage game, if Player 2 rejects, they can come back with a counteroffer y. Now
1 2
the process repeats, and it is up to Player 1 to accept or reject. If Player 1 accepts, Player 2 gets a
disagreement penalised (D) payoff of D(100−y), and Player 1 gets a payoff of Dy. However, if both
decline they each get a payoff of 0.
shown by non-deterministic outputs, where the players may or may not accept the request based on
the requested value, as well as violations where the players reject or accept with probability 1 even if a
rational actor would do the opposite.
1.0
0.8
0.6
0.4
0.2
0.0
0 20 40 60 80 100
Player 1 Request
ytilibaborP
noitcejeR
2
reyalP
1.0
0.8
0.6
0.4
0.2
0.0
0 20 40 60 80 100
Player 1 Request
(a) (V =10, V =10)
1 2
ytilibaborP
noitcejeR
2
reyalP
1.0
0.8
0.6
0.4
0.2
0.0
0 20 40 60 80 100
Player 1 Request
(b) (V =10, V =60)
1 2
ytilibaborP
noitcejeR
2
reyalP
(c) (V =70, V =10)
1 2
Figure16: ObservedrejectionratesfromexperimentaldataofBinmoreetal.(2002). Arationalopponent
is governed by the step function (black line), where a rational player would reject in the red area and
accept in the green area. The observed points show deviations from rationality.
Now,knowingtheopponenthaspotentialboundsontheirrationality,arationalplayerwouldrespond
accordingly. Fig. 17 plots the distribution of Player 1 requests. We observe that Player 1’s request
still deviates from perfect rationality. Perfect rationality would imply a Dirac delta function with the
probability mass situated at the optimal request. The observed deviation from rationality may be due
to uncertainty in their opponent’s abilities (reflected in the probabilities from Fig. 16), or limitations of
Player 1’s reasoning.
C.4.2 Two-stage Bargaining
Next, we examine a two-stage bargaining game (shown in Fig. 15b). Now, if Player 2 rejects Player
1’s request, they can come back with a counteroffer of their own. If the players can not come to an
agreement,theybothreceive0. Itis,therefore,inbothplayersbestinteresttoreachanagreement. This
28
7
6
5
4
3
2
1
00 20 40 60 80 100
Request
tnuoC
(10, 10)
Equilibrium 10
8
6
4
2
00 20 40 60 80 100
Request
(a) (V =10, V =10)
1 2
tnuoC
(10, 60)
6
5
4
3
2
1
00 20 40 60 80 100
Request
(b) (V =10, V =60)
1 2
tnuoC
(70, 10)
(c) (V =70, V =10)
1 2
Figure17: Player1requestsintheUltimatumgame,withexperimentaldatafromBinmoreetal.(2002).
Theblacklineindicatestheperfectlyrationalchoice(whenassumingopponentisperfectlyrational),i.e.,
a rational opponent would reject any lower request (left of the black line), and would accept any value
above their rejection payoff (right of the black line).
is represented with the following utilities:
U [a ]=a ×f[accept|a ]+V ×f[reject|a ]
1 1 1 1 1 1
U [accept |a ]=100−a
2 2 1 1
U [reject |a ]=V
2 2 1 2 (18)
U [a ]=D(100−a )×f[accept|a ]
2 3 3 3
U [accept |a ]=D×a
1 4 3 3
U [reject |a ]=0
1 4 3
where now V and V are derived from the expected payoff of the rejection branch. Conditioning on
1 2
past decisions are excluded from U [a ] as it is implicit that this can only occur when Player 2 rejects
2 3
Player 1’s request. We use experimental data of Game 3 from Binmore et al. (2002), considering all
disagreement penalties D ∈ [0.2,0.3,...,0.9]. For discussion sake, here we assume D = 0.9. With
perfect rationality, it is in Player 1’s best interest to accept any counteroffer greater than the rejection
payoffof0(seeFig.15b). Therefore, ifprompted, Player2shouldprovideacounterofferofy =1, which
gives Player 2 a payoff of D(100−y) = 89.1, and Player 1 a payoff of Dy = 0.9. Since Dy > 0 (the
rejection payoff), Player 1 should prefer this to the alternative and accept. With this in mind, Player 1
now knows the payoff for the rejection branch for Player 2 is 89.1, so if they request x > 10 (assuming
integer requests), Player 2 will reject this request since 100−x<89.1 if x>10. Therefore, the rational
Player 1 requests x=10, maximising their payoff, assuming Player 2 is rational.
0 20 40 60 80 100
1.0
0.8
0.6
0.4
0.2
0.0
0 20 40 60 80 100
Player 1 Request
ytilibaborP
noitcejeR
2
reyalP
Rational Player 1 Request
Irrational Player 1 Request
Perfectly Rational Player 1 Request
Rational Counteroffer
Figure18: Two-stageBargainingwithdisagreementpenaltyD =0.9. Initialrequestsareshownasblack
circles. The y-position gives the rejection rate of these requests. For rejected requests, the counteroffers
are shown as a purple star (linked to their original request by a line), where again, the y-position shows
the rejection rate of the counteroffer. The perfectly rational initial request would be x=10 (black line),
asanyrequestsintheredregionwouldberejectedbyarationalopponent. Afterarejection,theperfectly
rational counteroffer would be y =1 (purple line). Deviations from the subgame perfect equilibrium are
clear, with no player performing perfect backward induction.
However, from Fig. 18 which summarises results from the experiments presented by Binmore et al.
(2002), we can see substantial deviations from the subgame perfect equilibrium for both players. No
29
3.0
2.5
2.0
1.5
1.0
0.5
0.0
0 20 40 60 80 100
Player 1 Request
tnuoC
100
Equilibirum
80
60
40
20
0
0 20 40 60 80 100
Player 1 Request
(a) Player 1 Requests
refforetnuoC
2
reyalP
Experimental Counteroffers
Equilibirum Counteroffer
(b) Player 2 Counteroffers
Figure 19: Initial requests and counteroffers in the two-stage bargaining game with D =0.9.
Player 1 requests x<10 or the perfectly rational request x=10. Furthermore, no Player 2 requests the
rational counteroffer of y =1. The distribution of initial and counteroffers is visualised in Fig. 19.
C.4.3 Comparison Methods
Level-k Under the level-k model, level-0 players are assumed to be indifferent to all choices, and
chooose uniformly. Level-1 players exploit this, and choose based on their opponent being a level-0
player, and so on.
Cognitive Hierarchy Similartotheothergameclasses,againratherthanassumingallplayersareat
k−1, the cognitive hierarchy model fits a distribution to these k players, and best responds according
to this distribution of lower level thinkers. Again, the Poisson distribution is used.
Quantal Response Equilibrium For the Quantal Response Equilibrium, again, an agent form of
QRE is used to account for players noisily responding at each level, which is calculated recursively from
the final step.
D Sensitivity
To ensure the method’s robustness, we check the sensitivity of the proposed results to various fac-
tors that may affect the outcome. Specifically, we carried this testing out with respect to the conver-
gence/termination parameter (cid:15) and the fitted density estimates.
D.1 Termination parameter
For the bargaining and centipede games, the reasoning naturally ends at the end of the extensive-
form game. However, for the market entry and beauty contest games (with no defined end point), the
reasoning continues until the resources are depleted, i.e., βγk <(cid:15). We have used the threshold (cid:15)=10−8
to determine termination. To check the robustness of the method to (cid:15), here we perform sensitivity
analysis across the range 10−7 < (cid:15) < 10−9, i.e. ± one order of magnitude from the default value. We
sample 1000 points uniformly from this range, presenting the results in Fig. 20.
In both cases, we can see the approach is robust to these large changes in (cid:15), with an order of mag-
nitude change only having slight effects on the resulting outcomes. These results show that (cid:15) does not
need to be treated as a hyperparameter to optimise (as β/γ), but rather as a fixed parameter to deter-
mine “convergence” towards 0 and termination, the choice of which depends on computational/numeric
requirements. We recommend using as small value as possible (e.g. (cid:15) ≤ 10−8) while still achieving
reasonable convergence speed.
D.2 Density Estimates
Weevaluatehowtheresultingrankingswouldchangewithdifferentdensityestimationmethods. Specif-
ically, we analyse the resulting average (out-of-sample) ranks when using Scott’s rule (Scott, 2015) (as
presented),Silverman’srule(Silverman,2018),andthe(improved)Sheather&Jones(Botevetal.,2010)
30
0.9
†=10−7
†=10−8 0.8
0.020 †=10−9
0.7
0.015 0.6
0.5
0.010 0.4
0.3
0.005 0.2
0.1
0 20 40 60 80 100 0 2 4 6 8
(a) Beauty Contest (b) Market
Figure20: Terminationparameter(cid:15)sensitivity. Theoutcomeforthedefaultvalueisdisplayedasthered
line. The outcome for the upper (lower) threshold is the dashed blue (green) bar. Intermediary values
are displayed as light grey lines.
forautomaticbandwidthidentification. Whilethisdoesnotprovideanexhaustivelist,itcoversthemost
common rules used in literature. Density estimates are only used for the bargaining and beauty contest
games, so these are the two game classes analysed here.
InTable3, weseenochangeinaveragerankingbetweenScott’sandSilverman’srulesforthebeauty
contest games. However, when using Sheather & Jones, the rankings between Level-k and Nash change,
going from 4 and 5, respectively, to 4.33 and 4.67. This rank change does not alter any of the claims
made within the paper, so we can confirm the robustness of the resulting rankings to density estimates
for the beauty game.
Forthebargaininggames,weseeslightimprovementfortheproposedmethodwhencomparingScott’s
rulewithSilverman’sandSheather&Jones—inbothcases,goingfrom1.27withScott’sruleto1.23. At
the same time, QREs rank worsens from 1.73 to 1.77. The remaining methods keep the same ranking.
These rank changes strengthen the claims made in the paper, showing not only robustness to the rule
used but also improvements for the proposed approach when utilising alternative rules for bandwidth
estimation.
Table 3: Robustness to changes in density estimation. Average rankings are computed using the results
from various automatic bandwidth determination methods. Scott’s is the method we present in the
paper.
Quantal Hierarchy Level-k Cognitive Hierarchy QRE Nash
Scott’s 1.83 4.00 3.00 1.17 5.00
Beauty Contests Silverman’s 1.83 4.00 3.00 1.17 5.00
Sheather & Jones 1.83 4.33 3.00 1.17 4.67
Scott’s 1.27 3.50 3.50 1.73 5.00
Bargaining Games Silverman’s 1.23 3.50 3.50 1.77 5.00
Sheather & Jones 1.23 3.50 3.50 1.77 5.00
31