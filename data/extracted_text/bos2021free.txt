Free Energy Principle for State and Input Estimation of a Quadcopter
Flying in Wind
Fred Bos 1, Ajith Anil Meera 2, Dennis Benders 3 and Martijn Wisse 4
Abstract— The free energy principle from neuroscience pro-
vides a brain-inspired perception scheme through a data-
driven model learning algorithm called Dynamic Expectation
Maximization (DEM). This paper aims at introducing an exper-
imental design to provide the ﬁrst experimental conﬁrmation
of the usefulness of DEM as a state and input estimator for
real robots. Through a series of quadcopter ﬂight experiments
under unmodelled wind dynamics, we prove that DEM can
leverage the information from colored noise for accurate state
and input estimation through the use of generalized coordinates.
We demonstrate the superior performance of DEM for state es-
timation under colored noise with respect to other benchmarks
like State Augmentation, SMIKF and Kalman Filtering through
its minimal estimation error. We demonstrate the similarities
in the performance of DEM and Unknown Input Observer
(UIO) for input estimation. The paper concludes by showing
the inﬂuence of prior beliefs in shaping the accuracy-complexity
trade-off during DEM’s estimation.
I. INTRODUCTION
The widespread use of unmanned aerial vehicles (UA V) as
delivery drones has increased the need for robust state and
input estimators, mainly owing to its safety during uncertain
events such as strong wind. We take a step in this direction by
evaluating the usefulness of an approach from neuroscience
to handle the wind during estimation.
In literature, a wide range of approaches have been used
for the state estimation of linear time invariant (LTI) systems.
However, most of them assume the noise to be white [1],
which is often a wrong assumption in practice [2]. For
example, Kalman ﬁlter (KF) [3] ensures optimality when the
noises are white [4], but it is suboptimal when the noises
are colored. An interesting approach from neuroscience
called the Free Energy Principle (FEP) uses the concept
called generalized coordinates that can leverage the noise
derivative information in the brain signals for perception. The
FEP based perception scheme called Dynamic Expectation
Maximization (DEM) [5] was recently reformulated into a
state and input observer for LTI systems with colored noise,
and was shown to outperform the KF in simulation [6]. In
this paper, we aim to provide the experimental validation of
the DEM observer for a quadrotor under wind conditions
using the setup given in Figure 1. The main contributions of
the paper are:
1) Introduce an experimental design with real robots to
provide the proof of concept for DEM as a state and
input observer.
All the authors are with the Cognitive Robotics department at TU Delft,
The Netherlands. Corresponding author: ajitham1994@gmail.com.
Fig. 1: The schematic representation of our experimental setup for
the DEM’s state and input estimation using a quadrotor.
2) Provide the ﬁrst experimental conﬁrmation for the ad-
vantage of generalized coordinates in handling colored
noise during state and input estimation on robots.
3) Demonstrate the inﬂuence of prior beliefs in shaping
the accuracy-complexity trade-off during estimation.
II. RELATED WORK
This section introduces the interdisciplinary nature of FEP,
connecting neuroscience and robotics.
A. Neuroscience
FEP emerges from neuroscience as a uniﬁed theory of
the brain which posits that all biological systems resist their
natural tendency to disorder by minimizing their free energy
[7], where free energy is an information theoretic measure
that bounds sensory surprisal. FEP provides a mathematical
formalism for the brain related functions [8], uniﬁes action
and perception [9], connects memory and attention [8] and
explains Freudian ideas [10]. The brain inspired nature of
FEP has already attracted roboticists to apply it to build in-
telligent agents. A few of them includes the body perception
of humanoid robots [11], control of manipulator robot [12],
system identiﬁcation of a quadrotor [13, 14], SLAM [15]
etc. With this work we aim to assess the performance of
DEM for state and input estimation of a quadrotor under
wind conditions.
B. Robotics and control systems
In control systems literature, numerous approaches are
used to deal with colored noise during state estimation. State
Augmentation (SA) assumes the colored process noise as
an auto-regressive (AR) noise and augments the state space
equation to transform it into an equivalent system inﬂuenced
by white noise [2]. The Measurement Differencing [16]
arXiv:2109.12052v1  [cs.RO]  24 Sep 2021
approach deals with handling colored measurement noise.
SMIKF [17] extends KF for coloured noise by incorporating
the temporal correlations of the AR noise into the prior
covariance calculation of KF. In the fault detection literature,
many observers have been developed for input estimation,
like the Unknown Input Observer (UIO) [18]. However,
none of these methods perform simultaneous state and input
estimation under colored noise other than DEM [6].
In robotics, different approaches are used for state es-
timation of quadrotors under wind conditions. The most
common approach (Dryden wind model) is to treat wind
as a colored noise shaped by a ﬁlter acting on the white
noise. Another approach is to model the wind dynamics
and estimate wind velocity using complex nonlinear models
[19]. Using additional cameras for accurate state estimation
is another solution [20]. Our approach differs from these
methods as we treat the wind noises as colored and use the
information in the noise derivatives for accurate state and
input estimation.
III. PROBLEM STATEMENT
Consider the plant dynamics given in Equation 1, where
A, B and C are constant system matrices, x ∈Rn is the
hidden state, v ∈Rr is the input and y ∈Rm is the output.
˙x = Ax + Bv + w, y = Cx + z. (1)
Here w ∈ Rn and z ∈ Rm are temporally correlated
(colored) and represent the process and measurement noise
respectively. The noises are assumed to be the result of the
convolution of a Gaussian kernel on a white noise signal.
The goal of the DEM observer is to simultaneously estimate
x and v, when the noises are colored (or non-white). The
goal of this paper is to design an experimental setup for a
real robot that can be used to validate the DEM observer and
its usefulness in the presence of colored noise.
IV. PRELIMINARIES
This section introduces the DEM observer fundamentals.
A. Free energy principle
Fundamentally based on Bayesian Inference,
FEP estimates the posterior probability p(ϑ/y) =
p(ϑ,y)/
∫
p(ϑ,y)dϑ, where ϑ is the component to
be estimated and y is the measurement [21]. The
presence of an intractable integral motivates the use
of a variational density q(ϑ), called the recognition density
that approximates the posterior as q(ϑ) ≈ p(ϑ/y). This
approximation is achieved by minimizing the Kullback-
Leibler (KL) divergence of the distributions given by
KL(q(ϑ)||p(ϑ/y)) = ⟨ln q(ϑ)⟩q(ϑ) − ⟨ln p(ϑ/y)⟩q(ϑ),
where ⟨.⟩q(ϑ) represents the expectation over q(ϑ). Upon
simpliﬁcation using p(ϑ/y) = p(ϑ,y)/p(y), it can be
rewritten as [7]:
ln p(y) = F + Dkl(q(ϑ)||p(ϑ|y)), (2)
where F = ⟨ln p(ϑ,y)⟩q(ϑ) −⟨ln q(ϑ)⟩q(ϑ) is the free energy.
Since ln p(y) is independent of ϑ, minimization of the KL
divergence involves the maximization of free energy. This is
the fundamental idea behind using free energy as the proxy
for brain’s inference through the minimization of its sen-
sory surprisal [7]. DEM uses this mathematical framework,
in conjunction with the use of generalized coordinates to
provide a hierarchical brain model [22]. We will be using a
reformulated version of DEM given in [6] for this work.
B. Generative model
The key concept that differentiates DEM from other
methods is its use of generalized coordinates for noise color
handling. This is done by keeping track of the trajectory
of all time-varying quantities (instead of only its point
estimates) through a vector of derivatives. The state vector
in generalized coordinates are written using a tilde operator
as ˜x = [ x x′ x′′ ....]T where the dash operator represents
the derivatives. Since the noises are colored, the higher
derivatives of the system model can be written as [5]:
x′= Ax+ Bv+ w
x′′= Ax′+ Bv′+ w′
...
y= Cx+ z
y′= Cx′+ z′
...
(3)
which can be compactly written as:
˙˜x= Dx˜x= ˜A˜x+ ˜B˜v+ ˜w ˜y= ˜C˜x+ ˜z (4)
where Dx =
[0 1
0 1
. .
0 1
0
]
(p+1)×(p+1)
⊗In×n.
Here, Dx represents the shift matrix, which performs the
derivative operation on the generalized state vector. Similarly,
Dv performs the same operation on inputs and has size
r(d+1)×r(d+1). pand drepresent the embedding order for
the hidden states and the inputs respectively, indicating the
number of derivatives used. The generalized system matrices
are given by ˜A= Ip+1 ⊗A, ˜B = Ip+1 ⊗B, ˜C = Ip+1 ⊗
C, where I denotes the identity matrix and ⊗the Kronecker
tensor product. The generalized output ˜y is calculated from
the discrete measurements ˆy =
[ ...
y(t−dt)
y(t)
y(t+dt)
...
]
m(p+1)
using the
methodology in [5], resulting in a latency of p
2 dt during
online estimation, which is negligible for the large sampling
rate (120Hz) used in this paper.
C. Noise modeling
The use of generalized coordinates helps to model the
noise color through the temporal precision matrix of the
noise derivatives. In DEM, the noise is assumed to be the
result of a white noise signal that has been convoluted using
a Gaussian ﬁlter of the form: K(t) = 1√
2πσexp(−1
2 ( t
σ)2).
This provides an easy computation of the covariance of the
noise derivatives using the temporal precision matrix S [5]:
S(σ2) =


1 0 − 1
2σ2 ..
0 1
2σ2 0 ..
− 1
2σ2 0 3
4σ4 ..
.. .. .. ..


−1
(p+1)×(p+1)
(5)
σ is close to zero for white noise, while σ >0 for colored
noise. The generalized noise precision matrix can be written
using S as ˜Π = diag(˜Πz,P ˜v,˜Πw), where ˜Πz = S ⊗Πz,
˜Πw = S ⊗Πw, and P˜v = S ⊗Pv. Here Πw and Πz are
the noise precisions (inverse covariance), and Pv is the prior
precision on inputs.
D. State and Input Observer
The DEM observer in [6] simultaneously estimates the
generalized state and input vector X =
[˜x
˜v
]
through the
gradient ascend over its variational free energy V(t):
˙X = kV(t)X + DX, (6)
where k is the learning rate, V(t)X is the gradient of
V(t) with respect to X and DX =
[Dx O
O D v
]
. Using the
Laplace approximation [23], simpliﬁes V(t) as the precision
weighted prediction error, V(t) = −1
2 ˜ϵT ˜Π˜ϵ, where ˜ϵ is the
prediction error given by:
˜ϵ=


˜y−˜C˜x
˜v−η˜v
Dx˜x−˜A˜x−˜B˜v

 (7)
Here η˜v denotes the prior on the input. Therefore, V(t)X =
−˜ϵT
X˜Π˜ϵ, where ˜ϵX is given by:
˜ϵX =


−˜C O
O I
Dx −˜A −˜B

. (8)
Substituting these results to Equation 6 upon simpliﬁcation
yields the DEM state and input observer of [6]:
˙X =
[˙˜x
˙˜v
]
= A1
[˜x
˜v
]
+ B1
[ ˜y
−˜η
]
and Y= X, (9)
where Y is the output of the observer, A1 = DX −kA2,
A2 =
[˜CT ˜Πz ˜C+ (DA)T ˜ΠwDA −(DA)T ˜Πw ˜B
−˜BT ˜ΠwDA ˜Pv + ˜BT ˜Πw ˜B
]
, (10)
B1 = −
[−˜CT ˜Πz O
O ˜Pv
]
and DA = Dx −˜A.
This observer was proved to outperform the KF for state
estimation on LTI systems with colored noise in simulation
[6]. We will use this observer design throughout the paper
to provide the experimental validation on a real robot.
E. Uncertainty in state and input estimation
DEM provides a means to compute the uncertainty in
estimation through the precision of estimates given by the
negative curvature of variational free energy [24]:
ΠX = −V(t)XX = ˜ϵT
X˜Π˜ϵX = A2, (11)
where A2 is given in Equation 10. Therefore, the precision
of DEM’s state and input estimates is independent of time,
and is given by Π˜x˜x = ˜CT ˜Πz ˜C+ (DA)T ˜ΠwDA and Π˜v˜v =
˜Pv + ˜BT ˜Πw ˜B respectively.
V. EXPERIMENTAL DESIGN
The distinctive feature of DEM that enables it to handle
colored noise (to outperform a KF for state estimation) is
its use of generalized coordinates [5, 6]. This section aims
at designing an experimental setup (as simple as possible)
for real robots that can leverage this property and provide a
proof of concept for our DEM-based state and input observer
design for LTI systems with colored noise [6].
A. Experimental setup
Our experimental setup consist of a quadrotor (Parrot
AR.drone 2.0) hovering in wind produced by a blower in
a controlled lab, as shown in Figure 2. The blower induces
wind in the negative y direction, against the hovering quad-
copter. The PID controller tries to resist the wind to hover the
quadrotor at the given position (0m,0m,1m) and orientation
(0◦,0◦,0◦). We use an OptiTrack motion capture system to
record the position and orientation of the quadcopter. A total
of 9 hovering experiments were performed - 4 experiments
without wind (blower off) and 4 experiments with wind
(blower on). The ﬁnal experiment was used to tune all the
benchmark observers and will not be used for benchmarking.
Each experiment lasted 10s with dt= 0.0083s.
Fig. 2: The controlled lab environment for the experimental setup
with the quadrotor and the blower.
Since wind is the result of another (unmodelled) dynamic
system, we hypothesize that the introduction of wind in-
ﬂuences the quadrotor dynamics and acts as the source of
colored noise to the system. The experimental design enables
us to control the level of noise color entering the system
by controlling the blower for its wind speed and direction.
We hypothesize that our DEM observer can leverage on the
information contained in the colored noise by keeping track
of the higher derivatives of states and inputs through the
generalized coordinates.
B. Quadrotor model selection
The quadrotor model selection was performed to accom-
modate the inﬂuence of wind using minimum number of
states, resulting in a controllable and observable LTI system.
Since the wind ﬂows in negative ydirection, it inﬂuences the
roll angle (φaround x-axis) and the roll angular velocity ( ˙φ)
the most. Therefore, we only consider states x=
[
φ
˙φ
]
. The
model involving these states is based on the one provided in
[25]. By assuming small angles, φ and ˙φ can be decoupled
(a) Histograms of the process noise wφ and w˙φ
with a Gaussian ﬁt for no wind conditions.
(b) Histograms of the process noise wφ and w˙φ
with a Gaussian ﬁt under wind conditions.
(c) The auto-correlations for the process noises
wφ and w˙φ under wind conditions.
Fig. 3: The properties of process noise of our experiment. The wind introduces a colored Gaussian distributed disturbance to the system.
from the other system dynamics. Linearizing these states
around hovering conditions gives:
[˙φ
¨φ
]
=
[0 1
0 0
][φ
˙φ
]
+
[ 0 0 0 0
cBφ
Ixx
−cBφ
Ixx
−cBφ
Ixx
cBφ
Ixx
][
pwm1
pwm2
pwm3
pwm4
]
y=
[1 0 ][φ
˙φ
]
(12)
Here pwmi is the Pulse Width Modulation signal provided to
the ith motor by the controller for stable hovering. Ixx is the
quadcopter’s moment of inertia around the x-axis. It’s value
is identiﬁed using the biﬁlar pendulum experiment and equals
3.4 ·10−3kgm2. cBφ is the thrust coefﬁcient that models the
relation between the PWM values and the thrust generated
by the quadcopter rotors. It’s value is obtained by averaging
the results of several static thrust tests and equals 1.274 ·
10−3Nm. We normalize the input pwm signals using v =
v−mean(v)
max(v)−min(v) and use the same factor to multiply the B
matrix, such that the system dynamics are unaltered. See [26]
for more details regarding the model derivation and system
identiﬁcation procedure.
Since we use an accurate measurement system, Πz is
very high for all experiments. However, the presence of
colored process noise w through wind makes Πw << Πz.
Πw is further inﬂuenced by the modelling errors during
linearization as the wind aggressively drives the quadrotor
away from its equilibrium.
VI. RESULTS AND ANALYSIS
This section aims to investigate the validity of the as-
sumptions in our experimental design and to compare the
performance of DEM observer against other benchmarks.
A. Validity of Laplace Approximation
The DEM framework approximates the probability densi-
ties of p(˜y) and p(˜x/˜v) to be Gaussian in nature, centred
around their mean predictions ( ˜C˜x and ˜A˜x+ ˜B˜v, respec-
tively) with the same precision as that of the noises ( ˜Πz and
˜Πw):
p(˜y) = 1√
(2π)m(p+1)|˜Σz|
e−1
2 (˜y−˜C˜x)T ˜Πz(˜y−˜C˜x),
p(˜x/˜v) = 1√
(2π)n(p+1)|˜Σw|
e−1
2 ˜ϵxT˜Πw˜ϵx
,
(13)
where ˜ϵx = Dx˜x−˜A˜x−˜B˜v. The validity of this approxima-
tion on our experimental design was investigated by plotting
the process noise histograms for both without wind and with
wind conditions (for 400 data points each) and is shown
in Figure 3a and 3b respectively. Similar trend holds for
measurement noise as well. The strong Gaussian ﬁt indicates
the validity of Laplace approximation for our experimental
design.
B. Inﬂuence of wind on states and process noise
In this section we validate the direct inﬂuence of wind
on the states and process noise. Table I demonstrates a
higher standard deviation for windy conditions than for non-
windy conditions. A similar trend can be observed from the
width of histograms in Figure 3a and 3b, indicating that our
experimental design can control the noise generation.
φ (rad) ˙φ (rad/s) wφ (rad) w˙φ (rad/s)
Without wind 0.00855 0.0544 0.000416 0.0284
With wind 0.0460 0.260 0.000937 0.0607
TABLE I: The standard deviations of the states, φ and ˙φ, and the
process noises, wφ and w˙φ, for experiments with and without wind.
C. Conﬁrmation of noise color
In this section we conﬁrm that our experimental design
generates colored process noise. Figure 3c shows the sample
auto-correlation of the process noise of all experiments (with
wind). There is stronger autocorrelation for w˙φ than for
wφ, because φ is observed. The auto-correlation is different
from that expected from a white noise signal where the
auto-correlation immediately drops to 0 after zero lag. This
conﬁrms the presence of strong noise color (time-correlated
noise) in data.
(a) State estimation benchmarks (with wind).
 (b) Average SSE of all ﬂights.
 (c) Average SSE drops exponentially with p.
Fig. 4: DEM outperforms other benchmarks with minimal SSE in state estimation for a quadrotor ﬂying under windy conditions. The
performance of DEM improves exponentially with higher orders of generalized motion p, for a quadrotor ﬂying under windy conditions,
highlighting the importance of generalized coordinates in the presence of colored noise.
D. Estimator settings for benchmarking
We aim to benchmark the state estimation against KF,
SMIKF and SA, and the input estimation against UIO, for a
total of 8 experiments (4 with and 4 without wind). DEM was
set with the order of generalized motion of states and inputs
to p= 6 and d= 2 respectively. The SMIKF implementation
could only accommodate a ﬁrst order AR model, while the
SA implementation uses a 6th order AR model, similar to the
6th order derivatives ( p) of DEM. The noise precision Πw
was calculated for each experiment, while Πz = 8.1 ·10−9
was calculated from static drone data. The 9 th experiment
was used to tune the noise smoothness to σ= 0.006, which
was used for all experiments.
E. State estimation - benchmarking
In this section, we compare the performance of DEM with
the aforementioned benchmarks for state estimation with
known inputs. Figure 4a shows the state estimates of all
benchmarks for an experiment with wind. Although most
benchmarks follow the general trend of the measured states
(in blue), DEM performs the best. KF shows an inferior
performance due to its incapability of dealing with colored
noise. We use the sum of squared errors (SSE) between
the estimate of ˙φ and its measurement as the metric to
denote the quality of state estimation. The average SSE of
all 4 experiments (with and without wind separately) for all
benchmarks are shown in Figure 4b. DEM outperforms other
benchmarks in state estimation under wind conditions with
minimal SSE, demonstrating that it is a competitive state
estimator.
F . Role of Generalized Coordinates
One of the main strengths of DEM - the capability to
deal with colored noise - comes from the use of generalized
coordinates. In this section, we demonstrate the usefulness of
generalized coordinates in state estimation on experimental
data. The mean (and standard deviations of) SSE of state
estimation for all experiments (with wind) for varying orders
of generalized motion p is shown in Figure 4c. The expo-
nential decrease in SSE is consistent with the results from
[6] on large simulated data, and indicates the importance of
generalized coordinates in accurate state estimation in the
presence of colored noise.
G. State estimation as free energy maximization
The fundamental idea behind state estimation using DEM
is the gradient ascent over the variational free energy man-
ifold. In this section, we visually demonstrate that DEM’s
state estimates for ﬂight experiment maximize the VFE.
Figure 5 shows that the DEM state estimate is on top of
the V(t) curve at each time instance.
Fig. 5: The DEM state estimate (blue curve) lies on top of the
variational free energy surface, indicating that the DEM observer
maximized V(t).
Fig. 6: DEM’s input estimation coinciding with that of UIO.
H. Input Estimation - benchmarking
In this section, we aim to demonstrate our DEM observer’s
capability to estimate inputs in real robot application and
benchmark it against an input observer (UIO) from control
systems. We use the same settings as given in Section VI-D,
except for providing the input priors for pwm1 with a wrong
value of ηpwm1 = 0.5 with a low precision of Ppwm1 = 1
to encourage exploration and Πw = e3I2. We use C = I for
this section to meet the observability requirements of our
benchmark (UIO). Both DEM and UIO estimated the ﬁrst
pwm signal and the result is shown in Figure 6. Both DEM
and UIO followed the trend of measured inputs (in blue).
Fig. 7: Similar performance of DEM and UIO for input estimation
indicated by similar SSE in input estimation.
The coinciding input estimates for DEM and UIO demon-
strate that both estimators behave the same. The estimation
was repeated for all experiments and the SSE for input
estimation is shown in Figure 7. This conﬁrms the similarity
in performance of UIO and DEM for input estimation in the
presence of colored noise.
Fig. 8: The input estimates moving from a wrong prior of ηv = 1
to the measured input (in blue), mediated by the prior precision Pv.
I. Accuracy v/s complexity
The inherent capability of DEM to balance between es-
timation accuracy and complexity is mediated by the priors
ηv and Pv. Here, accuracy is the measure of closeness of
estimates to the real measurement, and complexity is the
measure of deviation from the priors. This section aims at
demonstrating this balance for simultaneous state and input
estimation on quadrotor data. This section follows the same
settings as Section VI-D with Πw = e3I2. Simultaneous
state and input estimation was performed using wrong input
prior ηv = 1 for varying prior precisions Pv, and the
resulting input estimation is shown in Figure 8, along with
the measured input (in blue). As Pv is relaxed, the input
estimation moves away from the wrong prior ηv and moves
closer to the correct inputs. The shift from wrong priors
to the correct measurements, mediated by Pv can be seen
as a balance (trade-off) between complexity and accuracy.
Figure 9 demonstrates this balance for all experiments with
windy conditions, both for state and input estimation. The
increasing SSE for higher Pv indicates the shift from high
accuracy with low complexity region to the low accuracy
with high complexity region. This trade-off is useful mainly
in industrial fault detection systems where any major de-
viations from the prior (known) inputs could be detected
and isolated during runtime. DEM’s inherent capability to
balance accuracy and complexity is an added advantage when
compared to other input estimators in literature like UIO.
Fig. 9: The SSE plot of state and input estimation demonstrating
DEM’s accuracy-complexity tradeoff. The SSE moves from a region
of high complexity and low accuracy to a region of low complexity
and high accuracy as the prior precision Pv is relaxed.
VII. CONCLUSIONS AND FUTURE WORK
The FEP based perception scheme called DEM, has re-
cently been reformulated into a simulataneous state and
input observer for LTI systems under colored noise. With
this paper, we propose an experimental design to validate
the DEM observer on real robots. Through a series of
quadrotor experiments under wind conditions, we show that
the DEM based observer outperforms other benchmarks like
KF, SMIKF and SA for state estimation with minimum esti-
mation errors. We show that DEM’s input estimation shows
similar performance compared to classical input observers
like UIO. With this paper, we provide the ﬁrst experimental
validation for the use of generalized coordinates to deal with
colored noise during state and input estimation on real robots.
We further demonstrate the unique capability of DEM to
balance between accuracy and complexity during state and
input estimation. The main challenge of the DEM observer is
the need to know the noise precision and noise smoothness a
priori. We intend to extend this work for simultaneous noise
precision and smoothness estimation in future.
VIII. ACKNOWLEDGEMENT
We would like to thank Prof. Tam ´as Keviczky for letting
us use the lab facilities in the midst of corona crisis.
REFERENCES
[1] A. C. Jalfon and Y . Halevi, “On partially augmented observers for
systems with coloured noises,” International Journal of Control ,
vol. 57, no. 2, pp. 335–349, 1993.
[2] A. Bryson and D. Johansen, “Linear ﬁltering for time-varying systems
using measurements containing colored noise,” IEEE Transactions on
Automatic Control, vol. 10, no. 1, pp. 4–10, 1965.
[3] B. P. Gibbs, Advanced Kalman ﬁltering, least-squares and modeling:
a practical handbook . John Wiley & Sons, 2011.
[4] R. E. Kalman, “A new approach to linear ﬁltering and prediction
problems,” Transactions of the ASME–Journal of Basic Engineering ,
vol. 82, no. Series D, pp. 35–45, 1960.
[5] K. J. Friston, N. Trujillo-Barreto, and J. Daunizeau, “Dem: a varia-
tional treatment of dynamic systems,” Neuroimage, vol. 41, no. 3, pp.
849–885, 2008.
[6] A. A. Meera and M. Wisse, “Free energy principle based state and
input observer design for linear systems with colored noise,” in 2020
American Control Conference (ACC) . IEEE, 2020, pp. 5052–5058.
[7] K. Friston, “The free-energy principle: a uniﬁed brain theory?” Nature
reviews neuroscience, vol. 11, no. 2, pp. 127–138, 2010.
[8] ——, “The free-energy principle: a rough guide to the brain?” Trends
in cognitive sciences , vol. 13, no. 7, pp. 293–301, 2009.
[9] K. J. Friston, J. Daunizeau, J. Kilner, and S. J. Kiebel, “Action and
behavior: a free-energy formulation,” Biological cybernetics, vol. 102,
no. 3, pp. 227–260, 2010.
[10] R. L. Carhart-Harris and K. J. Friston, “The default-mode, ego-
functions and free-energy: a neurobiological account of freudian
ideas,” Brain, vol. 133, no. 4, pp. 1265–1283, 2010.
[11] G. Oliver, P. Lanillos, and G. Cheng, “Active inference body
perception and action for humanoid robots,” arXiv preprint
arXiv:1906.03022, 2019.
[12] C. Pezzato, R. Ferrari, and C. H. Corbato, “A novel adaptive controller
for robot manipulators based on active inference,” IEEE Robotics and
Automation Letters, vol. 5, no. 2, pp. 2973–2980, 2020.
[13] A. Anil Meera and M. Wisse, “A brain inspired learning algorithm for
the perception of a quadrotor in wind, Under review,” 2021.
[14] ——, “On the convergence of dem’s linear parameter estimator,
Accepted,” in International Workshop on Active Inference , 2021.
[15] O. C ¸ atal, T. Verbelen, T. Van de Maele, B. Dhoedt, and A. Safron,
“Robot navigation as hierarchical active inference,” Neural Networks,
vol. 142, pp. 192–204, 2021.
[16] A. Bryson Jr and L. Henrikson, “Estimation using sampled data
containing sequentially correlated noise.” Journal of Spacecraft and
Rockets, vol. 5, no. 6, pp. 662–665, 1968.
[17] Z. Zhou, J. Wu, Y . Li, C. Fu, and H. Fourati, “Critical issues on kalman
ﬁlter with colored and correlated system noises,” Asian Journal of
Control, vol. 19, no. 6, pp. 1905–1919, 2017.
[18] B. A. Charandabi and H. J. Marquez, “Observer design for discrete-
time linear systems with unknown disturbances,” in 2012 IEEE 51st
IEEE Conference on Decision and Control (CDC) . IEEE, 2012, pp.
2563–2568.
[19] S. Waslander and C. Wang, “Wind disturbance estimation and rejection
for quadrotor position control,” in AIAA Infotech@ Aerospace confer-
ence and AIAA unmanned... Unlimited conference , 2009, p. 1983.
[20] D. Abeywardena, Z. Wang, G. Dissanayake, S. L. Waslander, and
S. Kodagoda, “Model-aided state estimation for quadrotor micro air
vehicles amidst wind disturbances,” in 2014 IEEE/RSJ International
Conference on Intelligent Robots and Systems. IEEE, 2014, pp. 4813–
4818.
[21] C. L. Buckley, C. S. Kim, S. McGregor, and A. K. Seth, “The free
energy principle for action and perception: A mathematical review,”
Journal of Mathematical Psychology , vol. 81, pp. 55–79, 2017.
[22] K. Friston, “Hierarchical models in the brain,” PLoS computational
biology, vol. 4, no. 11, p. e1000211, 2008.
[23] K. Friston, J. Mattout, N. Trujillo-Barreto, J. Ashburner, and W. Penny,
“Variational free energy and the laplace approximation,” Neuroimage,
vol. 34, no. 1, pp. 220–234, 2007.
[24] A. Anil Meera and M. Wisse, “Dynamic expectation maximiza-
tion algorithm for estimation of linear systems with colored noise
(Under review),” 2021.
[25] S. Bouabdallah, P. Murrieri, and R. Siegwart, “Design and control
of an indoor micro quadrotor,” in IEEE International Conference on
Robotics and Automation, 2004. Proceedings. ICRA ’04. 2004 , vol. 5,
2004, pp. 4393–4398 V ol.5.
[26] D. Benders, “Ar.drone 2.0 state estimation using dynamic expecta-
tion maximization,” Master’s thesis, 2020, available at http://resolver.
tudelft.nl/uuid:156157c6-d7f0-4dc1-a55a-b2e4ed66f1c2.