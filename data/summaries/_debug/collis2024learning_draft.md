### Learning in Hybrid Active Inference ModelsThe authors state: "An open problem in artificial intelligence is how systems can flexibly learn discrete abstractionsthatareusefulforsolvinginherentlycontinuousproblems.Previousworkincomputationalneurosciencehasconsideredthisfunctionalintegrationofdiscreteandcontinuousvariablesduringdecision-makingundertheformalismofactiveinference[13,29].However,theirfocusisontheexpressivephysicalimplementationofcategoricaldecisionsandthehierarchicalmixedgenerativemodelisassumedto beknown.Asaconsequence,itisunclearhowthisframeworkmightbeextendedtothelearningofappropriatecoarse-grainedvariablesforagiventask.Inlightofthis,wepresentanovelhierarchicalhybridactiveinferenceagentinwhichahigh-leveldiscreteactiveinferenceplanner sitsabovealow-levelcontinuousactiveinferencecontroller.Wemakeuseofrecentworkinrecurrentswitchinglineardynamicalsystems(rSLDS)whichlearnmeaningfuldiscreterepresentationsof complexcontinuousdynamicsviapiecewiselineardecomposition[22].TherepresentationslearntbytherSLDSinformthestructureofthehybriddecision-makingagentandallowusto(1)liftdecision-makingintothediscretedomain enablingustoexploitinformation-theoreticexplorationbonuses (2)specifytemporally-abstractedsub-goalsinareminiscentoftheoptionsframework[34]and(3)‘cache’theapproximatesolutionstolow-levelproblemsintothediscreteplanner.WeapplyourmodeltothessparseContinuousMountainCartask,demonstratingfastsystemidentification viaenhancedexplorationandsuccessfulplanningthroughthedelineationofabstractsub-goals.Keywords: hybridstate-spacemodels,decision-making,piecewiseaffinesystems1 IntroductionInaworldthatisinherentlyhigh-dimensionalandcontinuous,thebrain’scapacitytodistilandreasonaboutdiscreteconceptsrepresentsahighlydesirablefeatureinthedesignofautonomoussystems.Humansareabletoflexiblyspecifyabstractsub-goalsduringplanning,therebyreducingcomplexproblemsinto manageablechunks[26,16].Indeed,translatingproblemsintodiscrete spaceoffersdistinctadvantagesin decision-making systems. For one, discrete states admit the direct implementation of classical techniques from decision theory such as dynamic programming[21].Furthermore,wealsofindthecomputationallyfeasibleapplicationofinformation-theoreticmeasures(e.g.information-gain)indiscretespaces.Suchmeasures(generally)requireapproximationsincontinuoussettingsbutthesehaveclosed-formsolutionsinthediscretecase[12].Whiletheprevailingmethodfortranslatingcontinuousvariablesintodiscreterepresentationsinvolvesthesimplegrid-baseddiscretisationofthestate-space,thisbecomesextremelycostlyasthedimensionalityincreases[7,24].Wethereforeseektodevelopaframeworkwhichisabletosmoothlyhandlethecontinuousvariableswhilstmaintainingthebenefitsofdecision-makinginthediscretedomain.⋆ Correspondingauthor-†Equalcontribution4202peS2]IA.sc[1v66010.9042:viXra2 P.Collis,R.Singh,P.F.KinghornandC.L.BuckleyFig.1:Previous discrete-continuous active inference models have focused on the physical implementation of categorical decisions in continuous space.Here,outcomesfromthehigh-levelactiveinferenceplannerselectfromasetofdiscretemodelsoftcontinuousdynamics,specifiedbyapriorovertheirhiddencauses.Thismixedgenerativemodeleffectivelygeneratesdiscretesequencesofshortcontinuoustrajectoriesdefinedintterms of their generalized coordinates of motion. The discrete planner is formulated as a standard POMDP generativemodel(seeSec.3.3)withdiscretestatess andobservationso .Thefirstactiona oftheselectedpolicy(seeSec.3.2)isthenpasseddowntothecontinuousactiveinferencecontrollerviatheexpectedobservationq(o |a ).Thisdistributionweightsa setoffixedpointmeans{η }M−1 whichmapthediscretelatentstates(cid:80)t+1 t m m=0intocontinuousstatespace.Theresultingweightedaverage,η = η ·q(o |a),servesasthemeanofa prioroverhiddencauses,p(ν)=N(η ,π−1),whichdrivesthedynamicsofthelow-levelcontinuouslatentstatesx˜ ={x,x′,x′′} and observations y˜ ={y,x′,x′′} represented in generalized coordinates. Inherently, there is a separation of timescales in this open-loop control setup: the discrete controller sends an action down to the continuous controller which is then executed in a ballistic manner over several timesteps. After this low-level inner-loopcompletes,aprocessofBayesianmodelselectionisusedtoinferthecurrentdiscretestatedescriptionofthelow-levelsystemgiven the trajectoryofcontinuousobservationsy˜.Thisisthengivenasanobservationforthediscreteplanneratthetop.Forafulltreatmentofthismodel,see[13].1.1 Hybrid Active InferenceHere,wedrawonrecentworkinactiveinference(AIF)whichhasforegroundedtheutilityofdecision- making in discrete state-spaces [8,12]. Additionally, discrete AIF has been successfully combined with low-levelcontinuousrepresentationsandusedtomodelarangeofcomplexbehaviourincluding speech production, oculomotionandtooluse[13,29,14,30,31].Asdetailedin[13],suchmixedgenerativemodelsfocusonthephysicalimplementationofcategoricaldecisions.This treatmentbeginswiththepremise that the world can be described by a set of discrete states evolving autonomously and driving the low-level continuous latent states via this additional dependency, the authors demonstrate improved generative capacity and predictive performance. We propose this richer representation can be useful for decision-making and control. This recurrent transition structure can be exploited such that continuous priors can be flexibly specified for a low-level controller in order to drive the system into a desired region of the statespace. Using statistical methods to fit these models not only liberate us from the need to explicitly specify a mapping between discrete and continuous states a priori, but enable effective online discovery of useful non-grid discretisationsofthestate-space.LearninginHybridActiveInferenceModels3Fig.2:Recurrent switching linear dynamical systems (rSLDS) discover meaningful discrete states and explain how their switching behaviour depends on continuous latent states.Thisclassofhybridstatespacemodelincludesarecurrentdependencyofthediscretelatentstatez onthecontinuouslatentstatext+1 tandcontrolinputu.AsinastandardSLDS,thecontinuouslatentdynamicsareconditionallylinear(dependent on the current discrete state z) and generate observations y. Note that this figure shows the recurrent-only formulation of the rSLDS(seeSec.3.1)inwhich the discrete latent statez have no dependency onz asispresentt t−1initscanonicalform.1.2 Recurrent Switching SystemsPrevious work has demonstrated that models involving autonomous switching systems are often not sufficientlyexpressive to approximate realistic generative processes[22].Theystudythisprobleminthecontext of a class of hybrid state-space model known as switching linear dynamical systems (SLDS). These models have been shown to discover meaningful behavioural modes and their causal states via the piecewise linear decomposition of complex continuous dynamics[15,11].Theauthorsof[22]remedy the problem associated with limited expressivity by introducing recurrent switching linear dynamical systems (rSLDS) (see Fig.2). These models importantly include a dependency from the underlying continuous variables in the high-level discrete transition probabilities. By providing an understanding of the continuous latent causes of switches between the discrete states via this additional dependency, the authors demonstrate improved generative capacity and predictive performance. We propose this richer representation can be useful for decision-making and control. This recurrent transition structure can be exploited such that continuous priors can be flexibly specified for a low-level controller in order to drive the system into a desired region of the statespace. Using statistical methods to fit these models not only liberate us from the need to explicitly specify a mapping between discrete and continuous states a priori, but enable effective online discovery of useful non-grid discretisationsofthestate-space.1.3 Emergent descriptions for planningUnfortunately, the inclusion of recurrent dependencies also destroys the neat separation of discrete planningfromcontinuouscontrol,creatinguniquechallengesinperformingroll-outs.Ourcentralinsightis to re-instate the separation by lifting the dynamical system into the discrete domain only during planning. We do this by approximately integrating out the continuous variables, naturally leading to spatio-temporally abstractedactionsandsub-goals.Ourdiscreteplannerthereforeoperatespurelyatthelevelofare-descriptionofthediscretelatents, modelling nothing of the autonomous transition probabilities but rather reflecting transitions that are possible given the discretisationofthe continuousstate-space.Inshort,we describeanovelhybridhierarchicalactiveinferenceagent[28]inwhichadiscreteMarkov decisionprocess(MDP),informedbytherepresentationof anrSLDS,interfaceswith a continuous active inference controller implementing closed-loopcontrol.We demonstrate the efficacy of this algorithm by applying it to the classic control task of Continuous Mountain Car[27].We show that the exploratory bonuses afforded by the emergent discrete piecewisedescription of the task-space facilitates fast system identification.